var t,e;!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Vue=e()}(this,function(){"use strict";var t=Object.freeze({});function e(t){return null==t}function i(t){return null!=t}function n(t){return!0===t}function r(t){return"string"==typeof t||"number"==typeof t||"symbol"==typeof t||"boolean"==typeof t}function o(t){return null!==t&&"object"==typeof t}var a=Object.prototype.toString;function s(t){return"[object Object]"===a.call(t)}function l(t){var e=parseFloat(t+"");return e>=0&&Math.floor(e)===e&&isFinite(t)}function u(t){return i(t)&&"function"==typeof t.then&&"function"==typeof t.catch}function c(t){return null==t?"":Array.isArray(t)||s(t)&&t.toString===a?JSON.stringify(t,null,2):t+""}function h(t){var e=parseFloat(t);return isNaN(e)?t:e}function p(t,e){for(var i=Object.create(null),n=t.split(","),r=0;r<n.length;r++)i[n[r]]=!0;return e?function(t){return i[t.toLowerCase()]}:function(t){return i[t]}}var d=p("slot,component",!0),f=p("key,ref,slot,slot-scope,is");function m(t,e){if(t.length){var i=t.indexOf(e);if(i>-1)return t.splice(i,1)}}var g=Object.prototype.hasOwnProperty;function y(t,e){return g.call(t,e)}function v(t){var e=Object.create(null);return function(i){return e[i]||(e[i]=t(i))}}var _=/-(\w)/g,x=v(function(t){return t.replace(_,function(t,e){return e?e.toUpperCase():""})}),b=v(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}),w=/\B([A-Z])/g,S=v(function(t){return t.replace(w,"-$1").toLowerCase()}),T=Function.prototype.bind?function(t,e){return t.bind(e)}:function(t,e){function i(i){var n=arguments.length;return n?n>1?t.apply(e,arguments):t.call(e,i):t.call(e)}return i._length=t.length,i};function M(t,e){e=e||0;for(var i=t.length-e,n=Array(i);i--;)n[i]=t[i+e];return n}function I(t,e){for(var i in e)t[i]=e[i];return t}function C(t){for(var e={},i=0;i<t.length;i++)t[i]&&I(e,t[i]);return e}function A(t,e,i){}var k=function(t,e,i){return!1},D=function(t){return t};function E(t,e){if(t===e)return!0;var i=o(t),n=o(e);if(!i||!n)return!i&&!n&&t+""==e+"";try{var r=Array.isArray(t),a=Array.isArray(e);if(r&&a)return t.length===e.length&&t.every(function(t,i){return E(t,e[i])});if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(r||a)return!1;var s=Object.keys(t),l=Object.keys(e);return s.length===l.length&&s.every(function(i){return E(t[i],e[i])})}catch(t){return!1}}function P(t,e){for(var i=0;i<t.length;i++)if(E(t[i],e))return i;return-1}function L(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}var z="data-server-rendered",O=["component","directive","filter"],R=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],B={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:k,isReservedAttr:k,isUnknownElement:k,getTagNamespace:A,parsePlatformTagName:D,mustUseProp:k,async:!0,_lifecycleHooks:R},N=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function F(t,e,i,n){Object.defineProperty(t,e,{value:i,enumerable:!!n,writable:!0,configurable:!0})}var V=RegExp("[^"+N.source+".$_\\d]"),U,G="__proto__"in{},$="undefined"!=typeof window,W="undefined"!=typeof WXEnvironment&&!!WXEnvironment.platform,H=W&&WXEnvironment.platform.toLowerCase(),j=$&&window.navigator.userAgent.toLowerCase(),Z=j&&/msie|trident/.test(j),q=j&&j.indexOf("msie 9.0")>0,X=j&&j.indexOf("edge/")>0,Y=(j&&j.indexOf("android"),j&&/iphone|ipad|ipod|ios/.test(j)||"ios"===H),K=j&&j.match(/firefox\/(\d+)/),J={}.watch,Q=!1;if($)try{var tt={};Object.defineProperty(tt,"passive",{get:function(){Q=!0}}),window.addEventListener("test-passive",null,tt)}catch(t){}var et=function(){return void 0===U&&(U=!$&&!W&&"undefined"!=typeof global&&global.process&&"server"===global.process.env.VUE_ENV),U},it=$&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function nt(t){return"function"==typeof t&&/native code/.test(t.toString())}var rt,ot="undefined"!=typeof Symbol&&nt(Symbol)&&"undefined"!=typeof Reflect&&nt(Reflect.ownKeys);rt="undefined"!=typeof Set&&nt(Set)?Set:function(){function t(){this.set=Object.create(null)}return t.prototype.has=function(t){return!0===this.set[t]},t.prototype.add=function(t){this.set[t]=!0},t.prototype.clear=function(){this.set=Object.create(null)},t}();var at=A,st=0,lt=function(){this.id=st++,this.subs=[]};lt.prototype.addSub=function(t){this.subs.push(t)},lt.prototype.removeSub=function(t){m(this.subs,t)},lt.prototype.depend=function(){lt.target&&lt.target.addDep(this)},lt.prototype.notify=function(){for(var t=this.subs.slice(),e=0,i=t.length;e<i;e++)t[e].update()},lt.target=null;var ut=[];function ct(t){ut.push(t),lt.target=t}function ht(){ut.pop(),lt.target=ut[ut.length-1]}var pt=function(t,e,i,n,r,o,a,s){this.tag=t,this.data=e,this.children=i,this.text=n,this.elm=r,this.ns=void 0,this.context=o,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=a,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=s,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},dt={child:{configurable:!0}};dt.child.get=function(){return this.componentInstance},Object.defineProperties(pt.prototype,dt);var ft=function(t){void 0===t&&(t="");var e=new pt;return e.text=t,e.isComment=!0,e};function mt(t){return new pt(void 0,void 0,void 0,t+"")}function gt(t){var e=new pt(t.tag,t.data,t.children&&t.children.slice(),t.text,t.elm,t.context,t.componentOptions,t.asyncFactory);return e.ns=t.ns,e.isStatic=t.isStatic,e.key=t.key,e.isComment=t.isComment,e.fnContext=t.fnContext,e.fnOptions=t.fnOptions,e.fnScopeId=t.fnScopeId,e.asyncMeta=t.asyncMeta,e.isCloned=!0,e}var yt=Array.prototype,vt=Object.create(yt);["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(t){var e=yt[t];F(vt,t,function(){for(var i=[],n=arguments.length;n--;)i[n]=arguments[n];var r,o=e.apply(this,i),a=this.__ob__;switch(t){case"push":case"unshift":r=i;break;case"splice":r=i.slice(2)}return r&&a.observeArray(r),a.dep.notify(),o})});var _t=Object.getOwnPropertyNames(vt),xt=!0;function bt(t){xt=t}var wt=function(t){var e;this.value=t,this.dep=new lt,this.vmCount=0,F(t,"__ob__",this),Array.isArray(t)?(G?(e=vt,t.__proto__=e):function(t,e,i){for(var n=0,r=i.length;n<r;n++){var o=i[n];F(t,o,e[o])}}(t,vt,_t),this.observeArray(t)):this.walk(t)};function St(t,e){var i;if(o(t)&&!(t instanceof pt))return y(t,"__ob__")&&t.__ob__ instanceof wt?i=t.__ob__:xt&&!et()&&(Array.isArray(t)||s(t))&&Object.isExtensible(t)&&!t._isVue&&(i=new wt(t)),e&&i&&i.vmCount++,i}function Tt(t,e,i,n,r){var o=new lt,a=Object.getOwnPropertyDescriptor(t,e);if(!a||!1!==a.configurable){var s=a&&a.get,l=a&&a.set;s&&!l||2!==arguments.length||(i=t[e]);var u=!r&&St(i);Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){var e=s?s.call(t):i;return lt.target&&(o.depend(),u&&(u.dep.depend(),Array.isArray(e)&&function t(e){for(var i=void 0,n=0,r=e.length;n<r;n++)(i=e[n])&&i.__ob__&&i.__ob__.dep.depend(),Array.isArray(i)&&t(i)}(e))),e},set:function(e){var n=s?s.call(t):i;e===n||e!=e&&n!=n||s&&!l||(l?l.call(t,e):i=e,u=!r&&St(e),o.notify())}})}}function Mt(t,e,i){if(Array.isArray(t)&&l(e))return t.length=Math.max(t.length,e),t.splice(e,1,i),i;if(e in t&&!(e in Object.prototype))return t[e]=i,i;var n=t.__ob__;return t._isVue||n&&n.vmCount?i:n?(Tt(n.value,e,i),n.dep.notify(),i):(t[e]=i,i)}function It(t,e){if(Array.isArray(t)&&l(e))t.splice(e,1);else{var i=t.__ob__;t._isVue||i&&i.vmCount||y(t,e)&&(delete t[e],i&&i.dep.notify())}}wt.prototype.walk=function(t){for(var e=Object.keys(t),i=0;i<e.length;i++)Tt(t,e[i])},wt.prototype.observeArray=function(t){for(var e=0,i=t.length;e<i;e++)St(t[e])};var Ct=B.optionMergeStrategies;function At(t,e){if(!e)return t;for(var i,n,r,o=ot?Reflect.ownKeys(e):Object.keys(e),a=0;a<o.length;a++)"__ob__"!==(i=o[a])&&(n=t[i],r=e[i],y(t,i)?n!==r&&s(n)&&s(r)&&At(n,r):Mt(t,i,r));return t}function kt(t,e,i){return i?function(){var n="function"==typeof e?e.call(i,i):e,r="function"==typeof t?t.call(i,i):t;return n?At(n,r):r}:e?t?function(){return At("function"==typeof e?e.call(this,this):e,"function"==typeof t?t.call(this,this):t)}:e:t}function Dt(t,e){var i=e?t?t.concat(e):Array.isArray(e)?e:[e]:t;return i?function(t){for(var e=[],i=0;i<t.length;i++)-1===e.indexOf(t[i])&&e.push(t[i]);return e}(i):i}function Et(t,e,i,n){var r=Object.create(t||null);return e?I(r,e):r}Ct.data=function(t,e,i){return i?kt(t,e,i):e&&"function"!=typeof e?t:kt(t,e)},R.forEach(function(t){Ct[t]=Dt}),O.forEach(function(t){Ct[t+"s"]=Et}),Ct.watch=function(t,e,i,n){if(t===J&&(t=void 0),e===J&&(e=void 0),!e)return Object.create(t||null);if(!t)return e;var r={};for(var o in I(r,t),e){var a=r[o],s=e[o];a&&!Array.isArray(a)&&(a=[a]),r[o]=a?a.concat(s):Array.isArray(s)?s:[s]}return r},Ct.props=Ct.methods=Ct.inject=Ct.computed=function(t,e,i,n){if(!t)return e;var r=Object.create(null);return I(r,t),e&&I(r,e),r},Ct.provide=kt;var Pt=function(t,e){return void 0===e?t:e};function Lt(t,e,i){if("function"==typeof e&&(e=e.options),function(t,e){var i=t.props;if(i){var n,r,o={};if(Array.isArray(i))for(n=i.length;n--;)"string"==typeof(r=i[n])&&(o[x(r)]={type:null});else if(s(i))for(var a in i)r=i[a],o[x(a)]=s(r)?r:{type:r};t.props=o}}(e),function(t,e){var i=t.inject;if(i){var n=t.inject={};if(Array.isArray(i))for(var r=0;r<i.length;r++)n[i[r]]={from:i[r]};else if(s(i))for(var o in i){var a=i[o];n[o]=s(a)?I({from:o},a):{from:a}}}}(e),function(t){var e=t.directives;if(e)for(var i in e){var n=e[i];"function"==typeof n&&(e[i]={bind:n,update:n})}}(e),!e._base&&(e.extends&&(t=Lt(t,e.extends,i)),e.mixins))for(var n=0,r=e.mixins.length;n<r;n++)t=Lt(t,e.mixins[n],i);var o,a={};for(o in t)l(o);for(o in e)y(t,o)||l(o);function l(n){var r=Ct[n]||Pt;a[n]=r(t[n],e[n],i,n)}return a}function zt(t,e,i,n){if("string"==typeof i){var r=t[e];if(y(r,i))return r[i];var o=x(i);if(y(r,o))return r[o];var a=b(o);return y(r,a)?r[a]:r[i]||r[o]||r[a]}}function Ot(t,e,i,n){var r=e[t],o=!y(i,t),a=i[t],s=Ft(Boolean,r.type);if(s>-1)if(o&&!y(r,"default"))a=!1;else if(""===a||a===S(t)){var l=Ft(String,r.type);(l<0||s<l)&&(a=!0)}if(void 0===a){a=function(t,e,i){if(y(e,"default")){var n=e.default;return t&&t.$options.propsData&&void 0===t.$options.propsData[i]&&void 0!==t._props[i]?t._props[i]:"function"==typeof n&&"Function"!==Bt(e.type)?n.call(t):n}}(n,r,t);var u=xt;bt(!0),St(a),bt(u)}return a}var Rt=/^\s*function (\w+)/;function Bt(t){var e=t&&t.toString().match(Rt);return e?e[1]:""}function Nt(t,e){return Bt(t)===Bt(e)}function Ft(t,e){if(!Array.isArray(e))return Nt(e,t)?0:-1;for(var i=0,n=e.length;i<n;i++)if(Nt(e[i],t))return i;return-1}function Vt(t,e,i){ct();try{if(e)for(var n=e;n=n.$parent;){var r=n.$options.errorCaptured;if(r)for(var o=0;o<r.length;o++)try{if(!1===r[o].call(n,t,e,i))return}catch(t){Gt(t,n,"errorCaptured hook")}}Gt(t,e,i)}finally{ht()}}function Ut(t,e,i,n,r){var o;try{(o=i?t.apply(e,i):t.call(e))&&!o._isVue&&u(o)&&!o._handled&&(o.catch(function(t){return Vt(t,n,r+" (Promise/async)")}),o._handled=!0)}catch(t){Vt(t,n,r)}return o}function Gt(t,e,i){if(B.errorHandler)try{return B.errorHandler.call(null,t,e,i)}catch(e){e!==t&&$t(e,null,"config.errorHandler")}$t(t,e,i)}function $t(t,e,i){if(!$&&!W||void 0===console)throw t;console.error(t)}var Wt,Ht=!1,jt=[],Zt=!1;function qt(){Zt=!1;var t=jt.slice(0);jt.length=0;for(var e=0;e<t.length;e++)t[e]()}if("undefined"!=typeof Promise&&nt(Promise)){var Xt=Promise.resolve();Wt=function(){Xt.then(qt),Y&&setTimeout(A)},Ht=!0}else if(Z||"undefined"==typeof MutationObserver||!nt(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())Wt="undefined"!=typeof setImmediate&&nt(setImmediate)?function(){setImmediate(qt)}:function(){setTimeout(qt,0)};else{var Yt=1,Kt=new MutationObserver(qt),Jt=document.createTextNode(Yt+"");Kt.observe(Jt,{characterData:!0}),Wt=function(){Yt=(Yt+1)%2,Jt.data=Yt+""},Ht=!0}function Qt(t,e){var i;if(jt.push(function(){if(t)try{t.call(e)}catch(t){Vt(t,e,"nextTick")}else i&&i(e)}),Zt||(Zt=!0,Wt()),!t&&"undefined"!=typeof Promise)return new Promise(function(t){i=t})}var te=new rt;function ee(t){!function t(e,i){var n,r,a=Array.isArray(e);if(!(!a&&!o(e)||Object.isFrozen(e)||e instanceof pt)){if(e.__ob__){var s=e.__ob__.dep.id;if(i.has(s))return;i.add(s)}if(a)for(n=e.length;n--;)t(e[n],i);else for(n=(r=Object.keys(e)).length;n--;)t(e[r[n]],i)}}(t,te),te.clear()}var ie=v(function(t){var e="&"===t.charAt(0),i="~"===(t=e?t.slice(1):t).charAt(0),n="!"===(t=i?t.slice(1):t).charAt(0);return{name:t=n?t.slice(1):t,once:i,capture:n,passive:e}});function ne(t,e){function i(){var t=arguments,n=i.fns;if(!Array.isArray(n))return Ut(n,null,arguments,e,"v-on handler");for(var r=n.slice(),o=0;o<r.length;o++)Ut(r[o],null,t,e,"v-on handler")}return i.fns=t,i}function re(t,i,r,o,a,s){var l,u,c,h;for(l in t)u=t[l],c=i[l],h=ie(l),e(u)||(e(c)?(e(u.fns)&&(u=t[l]=ne(u,s)),n(h.once)&&(u=t[l]=a(h.name,u,h.capture)),r(h.name,u,h.capture,h.passive,h.params)):u!==c&&(c.fns=u,t[l]=c));for(l in i)e(t[l])&&o((h=ie(l)).name,i[l],h.capture)}function oe(t,r,o){var a;t instanceof pt&&(t=t.data.hook||(t.data.hook={}));var s=t[r];function l(){o.apply(this,arguments),m(a.fns,l)}e(s)?a=ne([l]):i(s.fns)&&n(s.merged)?(a=s).fns.push(l):a=ne([s,l]),a.merged=!0,t[r]=a}function ae(t,e,n,r,o){if(i(e)){if(y(e,n))return t[n]=e[n],o||delete e[n],!0;if(y(e,r))return t[n]=e[r],o||delete e[r],!0}return!1}function se(t){return r(t)?[mt(t)]:Array.isArray(t)?function t(o,a){var s=[],l,u,c,h;for(l=0;l<o.length;l++)e(u=o[l])||"boolean"==typeof u||(h=s[c=s.length-1],Array.isArray(u)?u.length>0&&(le((u=t(u,(a||"")+"_"+l))[0])&&le(h)&&(s[c]=mt(h.text+u[0].text),u.shift()),s.push.apply(s,u)):r(u)?le(h)?s[c]=mt(h.text+u):""!==u&&s.push(mt(u)):le(u)&&le(h)?s[c]=mt(h.text+u.text):(n(o._isVList)&&i(u.tag)&&e(u.key)&&i(a)&&(u.key="__vlist"+a+"_"+l+"__"),s.push(u)));return s}(t):void 0}function le(t){return i(t)&&i(t.text)&&!1===t.isComment}function ue(t,e){if(t){for(var i=Object.create(null),n=ot?Reflect.ownKeys(t):Object.keys(t),r=0;r<n.length;r++){var o=n[r];if("__ob__"!==o){for(var a=t[o].from,s=e;s;){if(s._provided&&y(s._provided,a)){i[o]=s._provided[a];break}s=s.$parent}if(!s&&"default"in t[o]){var l=t[o].default;i[o]="function"==typeof l?l.call(e):l}}}return i}}function ce(t,e){if(!t||!t.length)return{};for(var i={},n=0,r=t.length;n<r;n++){var o=t[n],a=o.data;if(a&&a.attrs&&a.attrs.slot&&delete a.attrs.slot,o.context!==e&&o.fnContext!==e||!a||null==a.slot)(i.default||(i.default=[])).push(o);else{var s=a.slot,l=i[s]||(i[s]=[]);"template"===o.tag?l.push.apply(l,o.children||[]):l.push(o)}}for(var u in i)i[u].every(he)&&delete i[u];return i}function he(t){return t.isComment&&!t.asyncFactory||" "===t.text}function pe(t){return t.isComment&&t.asyncFactory}function de(e,i,n){var r,o=Object.keys(i).length>0,a=e?!!e.$stable:!o,s=e&&e.$key;if(e){if(e._normalized)return e._normalized;if(a&&n&&n!==t&&s===n.$key&&!o&&!n.$hasNormal)return n;for(var l in r={},e)e[l]&&"$"!==l[0]&&(r[l]=fe(i,l,e[l]))}else r={};for(var u in i)u in r||(r[u]=me(i,u));return e&&Object.isExtensible(e)&&(e._normalized=r),F(r,"$stable",a),F(r,"$key",s),F(r,"$hasNormal",o),r}function fe(t,e,i){var n=function(){var t=arguments.length?i.apply(null,arguments):i({}),e=(t=t&&"object"==typeof t&&!Array.isArray(t)?[t]:se(t))&&t[0];return t&&(!e||1===t.length&&e.isComment&&!pe(e))?void 0:t};return i.proxy&&Object.defineProperty(t,e,{get:n,enumerable:!0,configurable:!0}),n}function me(t,e){return function(){return t[e]}}function ge(t,e){var n,r,a,s,l;if(Array.isArray(t)||"string"==typeof t)for(n=Array(t.length),r=0,a=t.length;r<a;r++)n[r]=e(t[r],r);else if("number"==typeof t)for(n=Array(t),r=0;r<t;r++)n[r]=e(r+1,r);else if(o(t))if(ot&&t[Symbol.iterator]){n=[];for(var u=t[Symbol.iterator](),c=u.next();!c.done;)n.push(e(c.value,n.length)),c=u.next()}else for(n=Array((s=Object.keys(t)).length),r=0,a=s.length;r<a;r++)l=s[r],n[r]=e(t[l],l,r);return i(n)||(n=[]),n._isVList=!0,n}function ye(t,e,i,n){var r,o=this.$scopedSlots[t];o?(i=i||{},n&&(i=I(I({},n),i)),r=o(i)||("function"==typeof e?e():e)):r=this.$slots[t]||("function"==typeof e?e():e);var a=i&&i.slot;return a?this.$createElement("template",{slot:a},r):r}function ve(t){return zt(this.$options,"filters",t)||D}function _e(t,e){return Array.isArray(t)?-1===t.indexOf(e):t!==e}function xe(t,e,i,n,r){var o=B.keyCodes[e]||i;return r&&n&&!B.keyCodes[e]?_e(r,n):o?_e(o,t):n?S(n)!==e:void 0===t}function be(t,e,i,n,r){if(i&&o(i)){var a;Array.isArray(i)&&(i=C(i));var s=function(o){if("class"===o||"style"===o||f(o))a=t;else{var s=t.attrs&&t.attrs.type;a=n||B.mustUseProp(e,s,o)?t.domProps||(t.domProps={}):t.attrs||(t.attrs={})}var l=x(o),u=S(o);l in a||u in a||(a[o]=i[o],r&&((t.on||(t.on={}))["update:"+o]=function(t){i[o]=t}))};for(var l in i)s(l)}return t}function we(t,e){var i=this._staticTrees||(this._staticTrees=[]),n=i[t];return n&&!e?n:(Te(n=i[t]=this.$options.staticRenderFns[t].call(this._renderProxy,null,this),"__static__"+t,!1),n)}function Se(t,e,i){return Te(t,"__once__"+e+(i?"_"+i:""),!0),t}function Te(t,e,i){if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n]&&"string"!=typeof t[n]&&Me(t[n],e+"_"+n,i);else Me(t,e,i)}function Me(t,e,i){t.isStatic=!0,t.key=e,t.isOnce=i}function Ie(t,e){if(e&&s(e)){var i=t.on=t.on?I({},t.on):{};for(var n in e){var r=i[n],o=e[n];i[n]=r?[].concat(r,o):o}}return t}function Ce(t,e,i,n){e=e||{$stable:!i};for(var r=0;r<t.length;r++){var o=t[r];Array.isArray(o)?Ce(o,e,i):o&&(o.proxy&&(o.fn.proxy=!0),e[o.key]=o.fn)}return n&&(e.$key=n),e}function Ae(t,e){for(var i=0;i<e.length;i+=2){var n=e[i];"string"==typeof n&&n&&(t[e[i]]=e[i+1])}return t}function ke(t,e){return"string"==typeof t?e+t:t}function De(t){t._o=Se,t._n=h,t._s=c,t._l=ge,t._t=ye,t._q=E,t._i=P,t._m=we,t._f=ve,t._k=xe,t._b=be,t._v=mt,t._e=ft,t._u=Ce,t._g=Ie,t._d=Ae,t._p=ke}function Ee(e,i,r,o,a){var s,l=this,u=a.options;y(o,"_uid")?(s=Object.create(o))._original=o:(s=o,o=o._original);var c=n(u._compiled),h=!c;this.data=e,this.props=i,this.children=r,this.parent=o,this.listeners=e.on||t,this.injections=ue(u.inject,o),this.slots=function(){return l.$slots||de(e.scopedSlots,l.$slots=ce(r,o)),l.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return de(e.scopedSlots,this.slots())}}),c&&(this.$options=u,this.$slots=this.slots(),this.$scopedSlots=de(e.scopedSlots,this.$slots)),u._scopeId?this._c=function(t,e,i,n){var r=Ve(s,t,e,i,n,h);return r&&!Array.isArray(r)&&(r.fnScopeId=u._scopeId,r.fnContext=o),r}:this._c=function(t,e,i,n){return Ve(s,t,e,i,n,h)}}function Pe(t,e,i,n,r){var o=gt(t);return o.fnContext=i,o.fnOptions=n,e.slot&&((o.data||(o.data={})).slot=e.slot),o}function Le(t,e){for(var i in e)t[x(i)]=e[i]}De(Ee.prototype);var ze={init:function(t,e){if(t.componentInstance&&!t.componentInstance._isDestroyed&&t.data.keepAlive){var n=t;ze.prepatch(n,n)}else(t.componentInstance=function(t,e){var n={_isComponent:!0,_parentVnode:t,parent:e},r=t.data.inlineTemplate;return i(r)&&(n.render=r.render,n.staticRenderFns=r.staticRenderFns),new t.componentOptions.Ctor(n)}(t,Xe)).$mount(e?t.elm:void 0,e)},prepatch:function(e,i){var n=i.componentOptions;!function(e,i,n,r,o){var a=r.data.scopedSlots,s=e.$scopedSlots,l=!!(a&&!a.$stable||s!==t&&!s.$stable||a&&e.$scopedSlots.$key!==a.$key||!a&&e.$scopedSlots.$key),u=!!(o||e.$options._renderChildren||l);if(e.$options._parentVnode=r,e.$vnode=r,e._vnode&&(e._vnode.parent=r),e.$options._renderChildren=o,e.$attrs=r.data.attrs||t,e.$listeners=n||t,i&&e.$options.props){bt(!1);for(var c=e._props,h=e.$options._propKeys||[],p=0;p<h.length;p++){var d=h[p],f=e.$options.props;c[d]=Ot(d,f,i,e)}bt(!0),e.$options.propsData=i}n=n||t;var m=e.$options._parentListeners;e.$options._parentListeners=n,qe(e,n,m),u&&(e.$slots=ce(o,r.context),e.$forceUpdate())}(i.componentInstance=e.componentInstance,n.propsData,n.listeners,i,n.children)},insert:function(t){var e,i=t.context,n=t.componentInstance;n._isMounted||(n._isMounted=!0,Qe(n,"mounted")),t.data.keepAlive&&(i._isMounted?((e=n)._inactive=!1,ei.push(e)):Je(n,!0))},destroy:function(t){var e=t.componentInstance;e._isDestroyed||(t.data.keepAlive?function t(e,i){if(!(i&&(e._directInactive=!0,Ke(e))||e._inactive)){e._inactive=!0;for(var n=0;n<e.$children.length;n++)t(e.$children[n]);Qe(e,"deactivated")}}(e,!0):e.$destroy())}},Oe=Object.keys(ze);function Re(r,a,s,l,c){if(!e(r)){var h=s.$options._base;if(o(r)&&(r=h.extend(r)),"function"==typeof r){var p;if(e(r.cid)&&void 0===(r=function(t,r){if(n(t.error)&&i(t.errorComp))return t.errorComp;if(i(t.resolved))return t.resolved;var a=Ge;if(a&&i(t.owners)&&-1===t.owners.indexOf(a)&&t.owners.push(a),n(t.loading)&&i(t.loadingComp))return t.loadingComp;if(a&&!i(t.owners)){var s=t.owners=[a],l=!0,c=null,h=null;a.$on("hook:destroyed",function(){return m(s,a)});var p=function(t){for(var e=0,i=s.length;e<i;e++)s[e].$forceUpdate();t&&(s.length=0,null!==c&&(clearTimeout(c),c=null),null!==h&&(clearTimeout(h),h=null))},d=L(function(e){t.resolved=$e(e,r),l?s.length=0:p(!0)}),f=L(function(e){i(t.errorComp)&&(t.error=!0,p(!0))}),g=t(d,f);return o(g)&&(u(g)?e(t.resolved)&&g.then(d,f):u(g.component)&&(g.component.then(d,f),i(g.error)&&(t.errorComp=$e(g.error,r)),i(g.loading)&&(t.loadingComp=$e(g.loading,r),0===g.delay?t.loading=!0:c=setTimeout(function(){c=null,e(t.resolved)&&e(t.error)&&(t.loading=!0,p(!1))},g.delay||200)),i(g.timeout)&&(h=setTimeout(function(){h=null,e(t.resolved)&&f(null)},g.timeout)))),l=!1,t.loading?t.loadingComp:t.resolved}}(p=r,h)))return function(t,e,i,n,r){var o=ft();return o.asyncFactory=t,o.asyncMeta={data:e,context:i,children:n,tag:r},o}(p,a,s,l,c);a=a||{},bi(r),i(a.model)&&function(t,e){var n=t.model&&t.model.prop||"value",r=t.model&&t.model.event||"input";(e.attrs||(e.attrs={}))[n]=e.model.value;var o=e.on||(e.on={}),a=o[r],s=e.model.callback;i(a)?(Array.isArray(a)?-1===a.indexOf(s):a!==s)&&(o[r]=[s].concat(a)):o[r]=s}(r.options,a);var d=function(t,n,r){var o=n.options.props;if(!e(o)){var a={},s=t.attrs,l=t.props;if(i(s)||i(l))for(var u in o){var c=S(u);ae(a,l,u,c,!0)||ae(a,s,u,c,!1)}return a}}(a,r);if(n(r.options.functional))return function(e,n,r,o,a){var s=e.options,l={},u=s.props;if(i(u))for(var c in u)l[c]=Ot(c,u,n||t);else i(r.attrs)&&Le(l,r.attrs),i(r.props)&&Le(l,r.props);var h=new Ee(r,l,a,o,e),p=s.render.call(null,h._c,h);if(p instanceof pt)return Pe(p,r,h.parent,s);if(Array.isArray(p)){for(var d=se(p)||[],f=Array(d.length),m=0;m<d.length;m++)f[m]=Pe(d[m],r,h.parent,s);return f}}(r,d,a,s,l);var f=a.on;if(a.on=a.nativeOn,n(r.options.abstract)){var g=a.slot;a={},g&&(a.slot=g)}!function(t){for(var e=t.hook||(t.hook={}),i=0;i<Oe.length;i++){var n=Oe[i],r=e[n],o=ze[n];r===o||r&&r._merged||(e[n]=r?Be(o,r):o)}}(a);var y=r.options.name||c;return new pt("vue-component-"+r.cid+(y?"-"+y:""),a,void 0,void 0,void 0,s,{Ctor:r,propsData:d,listeners:f,tag:c,children:l},p)}}}function Be(t,e){var i=function(i,n){t(i,n),e(i,n)};return i._merged=!0,i}var Ne=1,Fe=2;function Ve(t,a,s,l,u,c){return(Array.isArray(s)||r(s))&&(u=l,l=s,s=void 0),n(c)&&(u=Fe),function(t,r,a,s,l){if(i(a)&&i(a.__ob__))return ft();if(i(a)&&i(a.is)&&(r=a.is),!r)return ft();var u,c,h;(Array.isArray(s)&&"function"==typeof s[0]&&((a=a||{}).scopedSlots={default:s[0]},s.length=0),l===Fe?s=se(s):l===Ne&&(s=function(t){for(var e=0;e<t.length;e++)if(Array.isArray(t[e]))return Array.prototype.concat.apply([],t);return t}(s)),"string"==typeof r)?(c=t.$vnode&&t.$vnode.ns||B.getTagNamespace(r),u=B.isReservedTag(r)?new pt(B.parsePlatformTagName(r),a,s,void 0,void 0,t):a&&a.pre||!i(h=zt(t.$options,"components",r))?new pt(r,a,s,void 0,void 0,t):Re(h,a,t,s,r)):u=Re(r,a,t,s);return Array.isArray(u)?u:i(u)?(i(c)&&function t(r,o,a){if(r.ns=o,"foreignObject"===r.tag&&(o=void 0,a=!0),i(r.children))for(var s=0,l=r.children.length;s<l;s++){var u=r.children[s];i(u.tag)&&(e(u.ns)||n(a)&&"svg"!==u.tag)&&t(u,o,a)}}(u,c),i(a)&&function(t){o(t.style)&&ee(t.style),o(t.class)&&ee(t.class)}(a),u):ft()}(t,a,s,l,u)}var Ue,Ge=null;function $e(t,e){return(t.__esModule||ot&&"Module"===t[Symbol.toStringTag])&&(t=t.default),o(t)?e.extend(t):t}function We(t){if(Array.isArray(t))for(var e=0;e<t.length;e++){var n=t[e];if(i(n)&&(i(n.componentOptions)||pe(n)))return n}}function He(t,e){Ue.$on(t,e)}function je(t,e){Ue.$off(t,e)}function Ze(t,e){var i=Ue;return function n(){null!==e.apply(null,arguments)&&i.$off(t,n)}}function qe(t,e,i){Ue=t,re(e,i||{},He,je,Ze,t),Ue=void 0}var Xe=null;function Ye(t){var e=Xe;return Xe=t,function(){Xe=e}}function Ke(t){for(;t&&(t=t.$parent);)if(t._inactive)return!0;return!1}function Je(t,e){if(e){if(t._directInactive=!1,Ke(t))return}else if(t._directInactive)return;if(t._inactive||null===t._inactive){t._inactive=!1;for(var i=0;i<t.$children.length;i++)Je(t.$children[i]);Qe(t,"activated")}}function Qe(t,e){ct();var i=t.$options[e],n=e+" hook";if(i)for(var r=0,o=i.length;r<o;r++)Ut(i[r],t,null,t,n);t._hasHookEvent&&t.$emit("hook:"+e),ht()}var ti=[],ei=[],ii={},ni=!1,ri=!1,oi=0,ai=0,si=Date.now;if($&&!Z){var li=window.performance;li&&"function"==typeof li.now&&si()>document.createEvent("Event").timeStamp&&(si=function(){return li.now()})}function ui(){var t,e;for(ai=si(),ri=!0,ti.sort(function(t,e){return t.id-e.id}),oi=0;oi<ti.length;oi++)(t=ti[oi]).before&&t.before(),e=t.id,ii[e]=null,t.run();var i=ei.slice(),n=ti.slice();oi=ti.length=ei.length=0,ii={},ni=ri=!1,function(t){for(var e=0;e<t.length;e++)t[e]._inactive=!0,Je(t[e],!0)}(i),function(t){for(var e=t.length;e--;){var i=t[e],n=i.vm;n._watcher===i&&n._isMounted&&!n._isDestroyed&&Qe(n,"updated")}}(n),it&&B.devtools&&it.emit("flush")}var ci=0,hi=function(t,e,i,n,r){this.vm=t,r&&(t._watcher=this),t._watchers.push(this),n?(this.deep=!!n.deep,this.user=!!n.user,this.lazy=!!n.lazy,this.sync=!!n.sync,this.before=n.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=i,this.id=++ci,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new rt,this.newDepIds=new rt,this.expression="","function"==typeof e?this.getter=e:(this.getter=function(t){if(!V.test(t)){var e=t.split(".");return function(t){for(var i=0;i<e.length;i++){if(!t)return;t=t[e[i]]}return t}}}(e),this.getter||(this.getter=A)),this.value=this.lazy?void 0:this.get()};hi.prototype.get=function(){var t;ct(this);var e=this.vm;try{t=this.getter.call(e,e)}catch(t){if(!this.user)throw t;Vt(t,e,'getter for watcher "'+this.expression+'"')}finally{this.deep&&ee(t),ht(),this.cleanupDeps()}return t},hi.prototype.addDep=function(t){var e=t.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(t),this.depIds.has(e)||t.addSub(this))},hi.prototype.cleanupDeps=function(){for(var t=this.deps.length;t--;){var e=this.deps[t];this.newDepIds.has(e.id)||e.removeSub(this)}var i=this.depIds;this.depIds=this.newDepIds,this.newDepIds=i,this.newDepIds.clear(),i=this.deps,this.deps=this.newDeps,this.newDeps=i,this.newDeps.length=0},hi.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():function(t){var e=t.id;if(null==ii[e]){if(ii[e]=!0,ri){for(var i=ti.length-1;i>oi&&ti[i].id>t.id;)i--;ti.splice(i+1,0,t)}else ti.push(t);ni||(ni=!0,Qt(ui))}}(this)},hi.prototype.run=function(){if(this.active){var t=this.get();if(t!==this.value||o(t)||this.deep){var e=this.value;if(this.value=t,this.user){var i='callback for watcher "'+this.expression+'"';Ut(this.cb,this.vm,[t,e],this.vm,i)}else this.cb.call(this.vm,t,e)}}},hi.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},hi.prototype.depend=function(){for(var t=this.deps.length;t--;)this.deps[t].depend()},hi.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||m(this.vm._watchers,this);for(var t=this.deps.length;t--;)this.deps[t].removeSub(this);this.active=!1}};var pi={enumerable:!0,configurable:!0,get:A,set:A};function di(t,e,i){pi.get=function(){return this[e][i]},pi.set=function(t){this[e][i]=t},Object.defineProperty(t,i,pi)}function fi(t){t._watchers=[];var e=t.$options;e.props&&function(t,e){var i=t.$options.propsData||{},n=t._props={},r=t.$options._propKeys=[];t.$parent&&bt(!1);var o=function(o){r.push(o);var a=Ot(o,e,i,t);Tt(n,o,a),o in t||di(t,"_props",o)};for(var a in e)o(a);bt(!0)}(t,e.props),e.methods&&function(t,e){for(var i in t.$options.props,e)t[i]="function"!=typeof e[i]?A:T(e[i],t)}(t,e.methods),e.data?function(t){var e=t.$options.data;s(e=t._data="function"==typeof e?function(t,e){ct();try{return t.call(e,e)}catch(t){return Vt(t,e,"data()"),{}}finally{ht()}}(e,t):e||{})||(e={});for(var i=Object.keys(e),n=t.$options.props,r=(t.$options.methods,i.length),o;r--;){var a=i[r];n&&y(n,a)||(o=void 0,36!==(o=(a+"").charCodeAt(0))&&95!==o&&di(t,"_data",a))}St(e,!0)}(t):St(t._data={},!0),e.computed&&function(t,e){var i=t._computedWatchers=Object.create(null),n=et();for(var r in e){var o=e[r],a="function"==typeof o?o:o.get;n||(i[r]=new hi(t,a||A,A,mi)),r in t||gi(t,r,o)}}(t,e.computed),e.watch&&e.watch!==J&&function(t,e){for(var i in e){var n=e[i];if(Array.isArray(n))for(var r=0;r<n.length;r++)_i(t,i,n[r]);else _i(t,i,n)}}(t,e.watch)}var mi={lazy:!0};function gi(t,e,i){var n=!et();"function"==typeof i?(pi.get=n?yi(e):vi(i),pi.set=A):(pi.get=i.get?n&&!1!==i.cache?yi(e):vi(i.get):A,pi.set=i.set||A),Object.defineProperty(t,e,pi)}function yi(t){return function(){var e=this._computedWatchers&&this._computedWatchers[t];if(e)return e.dirty&&e.evaluate(),lt.target&&e.depend(),e.value}}function vi(t){return function(){return t.call(this,this)}}function _i(t,e,i,n){return s(i)&&(n=i,i=i.handler),"string"==typeof i&&(i=t[i]),t.$watch(e,i,n)}var xi=0;function bi(t){var e=t.options;if(t.super){var i=bi(t.super);if(i!==t.superOptions){t.superOptions=i;var n=function(t){var e,i=t.options,n=t.sealedOptions;for(var r in i)i[r]!==n[r]&&(e||(e={}),e[r]=i[r]);return e}(t);n&&I(t.extendOptions,n),(e=t.options=Lt(i,t.extendOptions)).name&&(e.components[e.name]=t)}}return e}function wi(t){this._init(t)}function Si(t){t.cid=0;var e=1;t.extend=function(t){t=t||{};var i=this,n=i.cid,r=t._Ctor||(t._Ctor={});if(r[n])return r[n];var o=t.name||i.options.name,a=function(t){this._init(t)};return(a.prototype=Object.create(i.prototype)).constructor=a,a.cid=e++,a.options=Lt(i.options,t),a.super=i,a.options.props&&function(t){var e=t.options.props;for(var i in e)di(t.prototype,"_props",i)}(a),a.options.computed&&function(t){var e=t.options.computed;for(var i in e)gi(t.prototype,i,e[i])}(a),a.extend=i.extend,a.mixin=i.mixin,a.use=i.use,O.forEach(function(t){a[t]=i[t]}),o&&(a.options.components[o]=a),a.superOptions=i.options,a.extendOptions=t,a.sealedOptions=I({},a.options),r[n]=a,a}}function Ti(t){return t&&(t.Ctor.options.name||t.tag)}function Mi(t,e){return Array.isArray(t)?t.indexOf(e)>-1:"string"==typeof t?t.split(",").indexOf(e)>-1:(i=t,"[object RegExp]"===a.call(i)&&t.test(e));var i}function Ii(t,e){var i=t.cache,n=t.keys,r=t._vnode;for(var o in i){var a=i[o];if(a){var s=a.name;s&&!e(s)&&Ci(i,o,n,r)}}}function Ci(t,e,i,n){var r=t[e];!r||n&&r.tag===n.tag||r.componentInstance.$destroy(),t[e]=null,m(i,e)}!function(e){e.prototype._init=function(e){var i=this;i._uid=xi++,i._isVue=!0,e&&e._isComponent?function(t,e){var i=t.$options=Object.create(t.constructor.options),n=e._parentVnode;i.parent=e.parent,i._parentVnode=n;var r=n.componentOptions;i.propsData=r.propsData,i._parentListeners=r.listeners,i._renderChildren=r.children,i._componentTag=r.tag,e.render&&(i.render=e.render,i.staticRenderFns=e.staticRenderFns)}(i,e):i.$options=Lt(bi(i.constructor),e||{},i),i._renderProxy=i,i._self=i,function(t){var e=t.$options,i=e.parent;if(i&&!e.abstract){for(;i.$options.abstract&&i.$parent;)i=i.$parent;i.$children.push(t)}t.$parent=i,t.$root=i?i.$root:t,t.$children=[],t.$refs={},t._watcher=null,t._inactive=null,t._directInactive=!1,t._isMounted=!1,t._isDestroyed=!1,t._isBeingDestroyed=!1}(i),function(t){t._events=Object.create(null),t._hasHookEvent=!1;var e=t.$options._parentListeners;e&&qe(t,e)}(i),function(e){e._vnode=null,e._staticTrees=null;var i=e.$options,n=e.$vnode=i._parentVnode,r=n&&n.context;e.$slots=ce(i._renderChildren,r),e.$scopedSlots=t,e._c=function(t,i,n,r){return Ve(e,t,i,n,r,!1)},e.$createElement=function(t,i,n,r){return Ve(e,t,i,n,r,!0)};var o=n&&n.data;Tt(e,"$attrs",o&&o.attrs||t,null,!0),Tt(e,"$listeners",i._parentListeners||t,null,!0)}(i),Qe(i,"beforeCreate"),function(t){var e=ue(t.$options.inject,t);e&&(bt(!1),Object.keys(e).forEach(function(i){Tt(t,i,e[i])}),bt(!0))}(i),fi(i),function(t){var e=t.$options.provide;e&&(t._provided="function"==typeof e?e.call(t):e)}(i),Qe(i,"created"),i.$options.el&&i.$mount(i.$options.el)}}(wi),function(t){var e={get:function(){return this._data}},i={get:function(){return this._props}};Object.defineProperty(t.prototype,"$data",e),Object.defineProperty(t.prototype,"$props",i),t.prototype.$set=Mt,t.prototype.$delete=It,t.prototype.$watch=function(t,e,i){if(s(e))return _i(this,t,e,i);(i=i||{}).user=!0;var n=new hi(this,t,e,i);if(i.immediate){var r='callback for immediate watcher "'+n.expression+'"';ct(),Ut(e,this,[n.value],this,r),ht()}return function(){n.teardown()}}}(wi),function(t){var e=/^hook:/;t.prototype.$on=function(t,i){var n=this;if(Array.isArray(t))for(var r=0,o=t.length;r<o;r++)n.$on(t[r],i);else(n._events[t]||(n._events[t]=[])).push(i),e.test(t)&&(n._hasHookEvent=!0);return n},t.prototype.$once=function(t,e){var i=this;function n(){i.$off(t,n),e.apply(i,arguments)}return n.fn=e,i.$on(t,n),i},t.prototype.$off=function(t,e){var i=this;if(!arguments.length)return i._events=Object.create(null),i;if(Array.isArray(t)){for(var n=0,r=t.length;n<r;n++)i.$off(t[n],e);return i}var o,a=i._events[t];if(!a)return i;if(!e)return i._events[t]=null,i;for(var s=a.length;s--;)if((o=a[s])===e||o.fn===e){a.splice(s,1);break}return i},t.prototype.$emit=function(t){var e=this._events[t];if(e){e=e.length>1?M(e):e;for(var i=M(arguments,1),n='event handler for "'+t+'"',r=0,o=e.length;r<o;r++)Ut(e[r],this,i,this,n)}return this}}(wi),function(t){t.prototype._update=function(t,e){var i=this,n=i.$el,r=i._vnode,o=Ye(i);i._vnode=t,i.$el=r?i.__patch__(r,t):i.__patch__(i.$el,t,e,!1),o(),n&&(n.__vue__=null),i.$el&&(i.$el.__vue__=i),i.$vnode&&i.$parent&&i.$vnode===i.$parent._vnode&&(i.$parent.$el=i.$el)},t.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},t.prototype.$destroy=function(){var t=this;if(!t._isBeingDestroyed){Qe(t,"beforeDestroy"),t._isBeingDestroyed=!0;var e=t.$parent;!e||e._isBeingDestroyed||t.$options.abstract||m(e.$children,t),t._watcher&&t._watcher.teardown();for(var i=t._watchers.length;i--;)t._watchers[i].teardown();t._data.__ob__&&t._data.__ob__.vmCount--,t._isDestroyed=!0,t.__patch__(t._vnode,null),Qe(t,"destroyed"),t.$off(),t.$el&&(t.$el.__vue__=null),t.$vnode&&(t.$vnode.parent=null)}}}(wi),function(t){De(t.prototype),t.prototype.$nextTick=function(t){return Qt(t,this)},t.prototype._render=function(){var t,e=this,i=e.$options,n=i.render,r=i._parentVnode;r&&(e.$scopedSlots=de(r.data.scopedSlots,e.$slots,e.$scopedSlots)),e.$vnode=r;try{Ge=e,t=n.call(e._renderProxy,e.$createElement)}catch(i){Vt(i,e,"render"),t=e._vnode}finally{Ge=null}return Array.isArray(t)&&1===t.length&&(t=t[0]),t instanceof pt||(t=ft()),t.parent=r,t}}(wi);var Ai=[String,RegExp,Array],ki={KeepAlive:{name:"keep-alive",abstract:!0,props:{include:Ai,exclude:Ai,max:[String,Number]},methods:{cacheVNode:function(){var t=this.cache,e=this.keys,i=this.vnodeToCache,n=this.keyToCache;if(i){var r=i.tag,o=i.componentInstance,a=i.componentOptions;t[n]={name:Ti(a),tag:r,componentInstance:o},e.push(n),this.max&&e.length>parseInt(this.max)&&Ci(t,e[0],e,this._vnode),this.vnodeToCache=null}}},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var t in this.cache)Ci(this.cache,t,this.keys)},mounted:function(){var t=this;this.cacheVNode(),this.$watch("include",function(e){Ii(t,function(t){return Mi(e,t)})}),this.$watch("exclude",function(e){Ii(t,function(t){return!Mi(e,t)})})},updated:function(){this.cacheVNode()},render:function(){var t=this.$slots.default,e=We(t),i=e&&e.componentOptions;if(i){var n=Ti(i),r=this.include,o=this.exclude;if(r&&(!n||!Mi(r,n))||o&&n&&Mi(o,n))return e;var a=this.cache,s=this.keys,l=null==e.key?i.Ctor.cid+(i.tag?"::"+i.tag:""):e.key;a[l]?(e.componentInstance=a[l].componentInstance,m(s,l),s.push(l)):(this.vnodeToCache=e,this.keyToCache=l),e.data.keepAlive=!0}return e||t&&t[0]}}};!function(t){var e;Object.defineProperty(t,"config",{get:function(){return B}}),t.util={warn:at,extend:I,mergeOptions:Lt,defineReactive:Tt},t.set=Mt,t.delete=It,t.nextTick=Qt,t.observable=function(t){return St(t),t},t.options=Object.create(null),O.forEach(function(e){t.options[e+"s"]=Object.create(null)}),t.options._base=t,I(t.options.components,ki),function(t){t.use=function(t){var e=this._installedPlugins||(this._installedPlugins=[]);if(e.indexOf(t)>-1)return this;var i=M(arguments,1);return i.unshift(this),"function"==typeof t.install?t.install.apply(t,i):"function"==typeof t&&t.apply(null,i),e.push(t),this}}(t),function(t){t.mixin=function(t){return this.options=Lt(this.options,t),this}}(t),Si(t),function(t){O.forEach(function(e){t[e]=function(t,i){return i?("component"===e&&s(i)&&(i.name=i.name||t,i=this.options._base.extend(i)),"directive"===e&&"function"==typeof i&&(i={bind:i,update:i}),this.options[e+"s"][t]=i,i):this.options[e+"s"][t]}})}(t)}(wi),Object.defineProperty(wi.prototype,"$isServer",{get:et}),Object.defineProperty(wi.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(wi,"FunctionalRenderContext",{value:Ee}),wi.version="2.6.14";var Di=p("style,class"),Ei=p("input,textarea,option,select,progress"),Pi=function(t,e,i){return"value"===i&&Ei(t)&&"button"!==e||"selected"===i&&"option"===t||"checked"===i&&"input"===t||"muted"===i&&"video"===t},Li=p("contenteditable,draggable,spellcheck"),zi=p("events,caret,typing,plaintext-only"),Oi=function(t,e){return Vi(e)||"false"===e?"false":"contenteditable"===t&&zi(e)?e:"true"},Ri=p("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),Bi="http://www.w3.org/1999/xlink",Ni=function(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)},Fi=function(t){return Ni(t)?t.slice(6,t.length):""},Vi=function(t){return null==t||!1===t};function Ui(t){for(var e=t.data,n=t,r=t;i(r.componentInstance);)(r=r.componentInstance._vnode)&&r.data&&(e=Gi(r.data,e));for(;i(n=n.parent);)n&&n.data&&(e=Gi(e,n.data));return function(t,e){return i(t)||i(e)?$i(t,Wi(e)):""}(e.staticClass,e.class)}function Gi(t,e){return{staticClass:$i(t.staticClass,e.staticClass),class:i(t.class)?[t.class,e.class]:e.class}}function $i(t,e){return t?e?t+" "+e:t:e||""}function Wi(t){return Array.isArray(t)?function(t){for(var e,n="",r=0,o=t.length;r<o;r++)i(e=Wi(t[r]))&&""!==e&&(n&&(n+=" "),n+=e);return n}(t):o(t)?function(t){var e="";for(var i in t)t[i]&&(e&&(e+=" "),e+=i);return e}(t):"string"==typeof t?t:""}var Hi={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},ji=p("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),Zi=p("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),qi=function(t){return ji(t)||Zi(t)};function Xi(t){return Zi(t)?"svg":"math"===t?"math":void 0}var Yi=Object.create(null),Ki=p("text,number,password,search,email,tel,url");function Ji(t){var e;return"string"==typeof t?document.querySelector(t)||document.createElement("div"):t}var Qi=Object.freeze({createElement:function(t,e){var i=document.createElement(t);return"select"!==t?i:(e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&i.setAttribute("multiple","multiple"),i)},createElementNS:function(t,e){return document.createElementNS(Hi[t],e)},createTextNode:function(t){return document.createTextNode(t)},createComment:function(t){return document.createComment(t)},insertBefore:function(t,e,i){t.insertBefore(e,i)},removeChild:function(t,e){t.removeChild(e)},appendChild:function(t,e){t.appendChild(e)},parentNode:function(t){return t.parentNode},nextSibling:function(t){return t.nextSibling},tagName:function(t){return t.tagName},setTextContent:function(t,e){t.textContent=e},setStyleScope:function(t,e){t.setAttribute(e,"")}}),tn={create:function(t,e){en(e)},update:function(t,e){t.data.ref!==e.data.ref&&(en(t,!0),en(e))},destroy:function(t){en(t,!0)}};function en(t,e){var n=t.data.ref;if(i(n)){var r=t.context,o=t.componentInstance||t.elm,a=r.$refs;e?Array.isArray(a[n])?m(a[n],o):a[n]===o&&(a[n]=void 0):t.data.refInFor?Array.isArray(a[n])?a[n].indexOf(o)<0&&a[n].push(o):a[n]=[o]:a[n]=o}}var nn=new pt("",{},[]),rn=["create","activate","update","remove","destroy"];function on(t,r){return t.key===r.key&&t.asyncFactory===r.asyncFactory&&(t.tag===r.tag&&t.isComment===r.isComment&&i(t.data)===i(r.data)&&function(t,e){if("input"!==t.tag)return!0;var n,r=i(n=t.data)&&i(n=n.attrs)&&n.type,o=i(n=e.data)&&i(n=n.attrs)&&n.type;return r===o||Ki(r)&&Ki(o)}(t,r)||n(t.isAsyncPlaceholder)&&e(r.asyncFactory.error))}function an(t,e,n){var r,o,a={};for(r=e;r<=n;++r)i(o=t[r].key)&&(a[o]=r);return a}var sn={create:ln,update:ln,destroy:function(t){ln(t,nn)}};function ln(t,e){(t.data.directives||e.data.directives)&&function(t,e){var i,n,r,o=t===nn,a=e===nn,s=cn(t.data.directives,t.context),l=cn(e.data.directives,e.context),u=[],c=[];for(i in l)n=s[i],r=l[i],n?(r.oldValue=n.value,r.oldArg=n.arg,pn(r,"update",e,t),r.def&&r.def.componentUpdated&&c.push(r)):(pn(r,"bind",e,t),r.def&&r.def.inserted&&u.push(r));if(u.length){var h=function(){for(var i=0;i<u.length;i++)pn(u[i],"inserted",e,t)};o?oe(e,"insert",h):h()}if(c.length&&oe(e,"postpatch",function(){for(var i=0;i<c.length;i++)pn(c[i],"componentUpdated",e,t)}),!o)for(i in s)l[i]||pn(s[i],"unbind",t,t,a)}(t,e)}var un=Object.create(null);function cn(t,e){var i,n,r=Object.create(null);if(!t)return r;for(i=0;i<t.length;i++)(n=t[i]).modifiers||(n.modifiers=un),r[hn(n)]=n,n.def=zt(e.$options,"directives",n.name);return r}function hn(t){return t.rawName||t.name+"."+Object.keys(t.modifiers||{}).join(".")}function pn(t,e,i,n,r){var o=t.def&&t.def[e];if(o)try{o(i.elm,t,i,n,r)}catch(n){Vt(n,i.context,"directive "+t.name+" "+e+" hook")}}var dn=[tn,sn];function fn(t,n){var r=n.componentOptions;if(!(i(r)&&!1===r.Ctor.options.inheritAttrs||e(t.data.attrs)&&e(n.data.attrs))){var o,a,s=n.elm,l=t.data.attrs||{},u=n.data.attrs||{};for(o in i(u.__ob__)&&(u=n.data.attrs=I({},u)),u)a=u[o],l[o]!==a&&mn(s,o,a,n.data.pre);for(o in(Z||X)&&u.value!==l.value&&mn(s,"value",u.value),l)e(u[o])&&(Ni(o)?s.removeAttributeNS(Bi,Fi(o)):Li(o)||s.removeAttribute(o))}}function mn(t,e,i,n){n||t.tagName.indexOf("-")>-1?gn(t,e,i):Ri(e)?Vi(i)?t.removeAttribute(e):(i="allowfullscreen"===e&&"EMBED"===t.tagName?"true":e,t.setAttribute(e,i)):Li(e)?t.setAttribute(e,Oi(e,i)):Ni(e)?Vi(i)?t.removeAttributeNS(Bi,Fi(e)):t.setAttributeNS(Bi,e,i):gn(t,e,i)}function gn(t,e,i){if(Vi(i))t.removeAttribute(e);else{if(Z&&!q&&"TEXTAREA"===t.tagName&&"placeholder"===e&&""!==i&&!t.__ieph){var n=function(e){e.stopImmediatePropagation(),t.removeEventListener("input",n)};t.addEventListener("input",n),t.__ieph=!0}t.setAttribute(e,i)}}var yn={create:fn,update:fn};function vn(t,n){var r=n.elm,o=n.data,a=t.data;if(!(e(o.staticClass)&&e(o.class)&&(e(a)||e(a.staticClass)&&e(a.class)))){var s=Ui(n),l=r._transitionClasses;i(l)&&(s=$i(s,Wi(l))),s!==r._prevClass&&(r.setAttribute("class",s),r._prevClass=s)}}var _n,xn,bn,wn,Sn,Tn,Mn={create:vn,update:vn},In=/[\w).+\-_$\]]/;function Cn(t){var e,i,n,r,o,a=!1,s=!1,l=!1,u=!1,c=0,h=0,p=0,d=0;for(n=0;n<t.length;n++)if(i=e,e=t.charCodeAt(n),a)39===e&&92!==i&&(a=!1);else if(s)34===e&&92!==i&&(s=!1);else if(l)96===e&&92!==i&&(l=!1);else if(u)47===e&&92!==i&&(u=!1);else if(124!==e||124===t.charCodeAt(n+1)||124===t.charCodeAt(n-1)||c||h||p){switch(e){case 34:s=!0;break;case 39:a=!0;break;case 96:l=!0;break;case 40:p++;break;case 41:p--;break;case 91:h++;break;case 93:h--;break;case 123:c++;break;case 125:c--}if(47===e){for(var f=n-1,m=void 0;f>=0&&" "===(m=t.charAt(f));f--);m&&In.test(m)||(u=!0)}}else void 0===r?(d=n+1,r=t.slice(0,n).trim()):g();function g(){(o||(o=[])).push(t.slice(d,n).trim()),d=n+1}if(void 0===r?r=t.slice(0,n).trim():0!==d&&g(),o)for(n=0;n<o.length;n++)r=An(r,o[n]);return r}function An(t,e){var i=e.indexOf("(");if(i<0)return'_f("'+e+'")('+t+")";var n=e.slice(0,i),r=e.slice(i+1);return'_f("'+n+'")('+t+(")"!==r?","+r:r)}function kn(t,e){console.error("[Vue compiler]: "+t)}function Dn(t,e){return t?t.map(function(t){return t[e]}).filter(function(t){return t}):[]}function En(t,e,i,n,r){(t.props||(t.props=[])).push(Vn({name:e,value:i,dynamic:r},n)),t.plain=!1}function Pn(t,e,i,n,r){(r?t.dynamicAttrs||(t.dynamicAttrs=[]):t.attrs||(t.attrs=[])).push(Vn({name:e,value:i,dynamic:r},n)),t.plain=!1}function Ln(t,e,i,n){t.attrsMap[e]=i,t.attrsList.push(Vn({name:e,value:i},n))}function zn(t,e,i,n,r,o,a,s){(t.directives||(t.directives=[])).push(Vn({name:e,rawName:i,value:n,arg:r,isDynamicArg:o,modifiers:a},s)),t.plain=!1}function On(t,e,i){return i?"_p("+e+',"'+t+'")':t+e}function Rn(e,i,n,r,o,a,s,l){var u;(r=r||t).right?l?i="("+i+")==='click'?'contextmenu':("+i+")":"click"===i&&(i="contextmenu",delete r.right):r.middle&&(l?i="("+i+")==='click'?'mouseup':("+i+")":"click"===i&&(i="mouseup")),r.capture&&(delete r.capture,i=On("!",i,l)),r.once&&(delete r.once,i=On("~",i,l)),r.passive&&(delete r.passive,i=On("&",i,l)),r.native?(delete r.native,u=e.nativeEvents||(e.nativeEvents={})):u=e.events||(e.events={});var c=Vn({value:n.trim(),dynamic:l},s);r!==t&&(c.modifiers=r);var h=u[i];Array.isArray(h)?o?h.unshift(c):h.push(c):u[i]=h?o?[c,h]:[h,c]:c,e.plain=!1}function Bn(t,e,i){var n=Nn(t,":"+e)||Nn(t,"v-bind:"+e);if(null!=n)return Cn(n);if(!1!==i){var r=Nn(t,e);if(null!=r)return JSON.stringify(r)}}function Nn(t,e,i){var n;if(null!=(n=t.attrsMap[e]))for(var r=t.attrsList,o=0,a=r.length;o<a;o++)if(r[o].name===e){r.splice(o,1);break}return i&&delete t.attrsMap[e],n}function Fn(t,e){for(var i=t.attrsList,n=0,r=i.length;n<r;n++){var o=i[n];if(e.test(o.name))return i.splice(n,1),o}}function Vn(t,e){return e&&(null!=e.start&&(t.start=e.start),null!=e.end&&(t.end=e.end)),t}function Un(t,e,i){var n=i||{},r=n.number,o="$$v";n.trim&&(o="(typeof $$v === 'string'? $$v.trim(): $$v)"),r&&(o="_n("+o+")");var a=Gn(e,o);t.model={value:"("+e+")",expression:JSON.stringify(e),callback:"function ($$v) {"+a+"}"}}function Gn(t,e){var i=function(t){if(t=t.trim(),_n=t.length,t.indexOf("[")<0||t.lastIndexOf("]")<_n-1)return(wn=t.lastIndexOf("."))>-1?{exp:t.slice(0,wn),key:'"'+t.slice(wn+1)+'"'}:{exp:t,key:null};for(xn=t,wn=Sn=Tn=0;!Wn();)Hn(bn=$n())?Zn(bn):91===bn&&jn(bn);return{exp:t.slice(0,Sn),key:t.slice(Sn+1,Tn)}}(t);return null===i.key?t+"="+e:"$set("+i.exp+", "+i.key+", "+e+")"}function $n(){return xn.charCodeAt(++wn)}function Wn(){return wn>=_n}function Hn(t){return 34===t||39===t}function jn(t){var e=1;for(Sn=wn;!Wn();)if(Hn(t=$n()))Zn(t);else if(91===t&&e++,93===t&&e--,0===e){Tn=wn;break}}function Zn(t){for(var e=t;!Wn()&&(t=$n())!==e;);}var qn,Xn="__r",Yn="__c";function Kn(t,e,i){var n=qn;return function r(){null!==e.apply(null,arguments)&&tr(t,r,i,n)}}var Jn=Ht&&!(K&&+K[1]<=53);function Qn(t,e,i,n){if(Jn){var r=ai,o=e;e=o._wrapper=function(t){if(t.target===t.currentTarget||t.timeStamp>=r||t.timeStamp<=0||t.target.ownerDocument!==document)return o.apply(this,arguments)}}qn.addEventListener(t,e,Q?{capture:i,passive:n}:i)}function tr(t,e,i,n){(n||qn).removeEventListener(t,e._wrapper||e,i)}function er(t,n){if(!e(t.data.on)||!e(n.data.on)){var r=n.data.on||{},o=t.data.on||{};qn=n.elm,function(t){if(i(t[Xn])){var e=Z?"change":"input";t[e]=[].concat(t[Xn],t[e]||[]),delete t[Xn]}i(t[Yn])&&(t.change=[].concat(t[Yn],t.change||[]),delete t[Yn])}(r),re(r,o,Qn,tr,Kn,n.context),qn=void 0}}var ir,nr={create:er,update:er};function rr(t,n){if(!e(t.data.domProps)||!e(n.data.domProps)){var r,o,a=n.elm,s=t.data.domProps||{},l=n.data.domProps||{};for(r in i(l.__ob__)&&(l=n.data.domProps=I({},l)),s)r in l||(a[r]="");for(r in l){if(o=l[r],"textContent"===r||"innerHTML"===r){if(n.children&&(n.children.length=0),o===s[r])continue;1===a.childNodes.length&&a.removeChild(a.childNodes[0])}if("value"===r&&"PROGRESS"!==a.tagName){a._value=o;var u=e(o)?"":o+"";or(a,u)&&(a.value=u)}else if("innerHTML"===r&&Zi(a.tagName)&&e(a.innerHTML)){(ir=ir||document.createElement("div")).innerHTML="<svg>"+o+"</svg>";for(var c=ir.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;c.firstChild;)a.appendChild(c.firstChild)}else if(o!==s[r])try{a[r]=o}catch(t){}}}}function or(t,e){return!t.composing&&("OPTION"===t.tagName||function(t,e){var i=!0;try{i=document.activeElement!==t}catch(t){}return i&&t.value!==e}(t,e)||function(t,e){var n=t.value,r=t._vModifiers;if(i(r)){if(r.number)return h(n)!==h(e);if(r.trim)return n.trim()!==e.trim()}return n!==e}(t,e))}var ar={create:rr,update:rr},sr=v(function(t){var e={},i=/:(.+)/;return t.split(/;(?![^(]*\))/g).forEach(function(t){if(t){var n=t.split(i);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e});function lr(t){var e=ur(t.style);return t.staticStyle?I(t.staticStyle,e):e}function ur(t){return Array.isArray(t)?C(t):"string"==typeof t?sr(t):t}var cr,hr=/^--/,pr=/\s*!important$/,dr=function(t,e,i){if(hr.test(e))t.style.setProperty(e,i);else if(pr.test(i))t.style.setProperty(S(e),i.replace(pr,""),"important");else{var n=mr(e);if(Array.isArray(i))for(var r=0,o=i.length;r<o;r++)t.style[n]=i[r];else t.style[n]=i}},fr=["Webkit","Moz","ms"],mr=v(function(t){if(cr=cr||document.createElement("div").style,"filter"!==(t=x(t))&&t in cr)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),i=0;i<3;i++){var n=fr[i]+e;if(n in cr)return n}});function gr(t,n){var r=n.data,o=t.data;if(!(e(r.staticStyle)&&e(r.style)&&e(o.staticStyle)&&e(o.style))){var a,s,l=n.elm,u=o.staticStyle,c=o.normalizedStyle||o.style||{},h=u||c,p=ur(n.data.style)||{};n.data.normalizedStyle=i(p.__ob__)?I({},p):p;var d=function(t,e){for(var i,n={},r=t;r.componentInstance;)(r=r.componentInstance._vnode)&&r.data&&(i=lr(r.data))&&I(n,i);(i=lr(t.data))&&I(n,i);for(var o=t;o=o.parent;)o.data&&(i=lr(o.data))&&I(n,i);return n}(n,!0);for(s in h)e(d[s])&&dr(l,s,"");for(s in d)(a=d[s])!==h[s]&&dr(l,s,null==a?"":a)}}var yr={create:gr,update:gr},vr=/\s+/;function _r(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(vr).forEach(function(e){return t.classList.add(e)}):t.classList.add(e);else{var i=" "+(t.getAttribute("class")||"")+" ";i.indexOf(" "+e+" ")<0&&t.setAttribute("class",(i+e).trim())}}function xr(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(vr).forEach(function(e){return t.classList.remove(e)}):t.classList.remove(e),t.classList.length||t.removeAttribute("class");else{for(var i=" "+(t.getAttribute("class")||"")+" ",n=" "+e+" ";i.indexOf(n)>=0;)i=i.replace(n," ");(i=i.trim())?t.setAttribute("class",i):t.removeAttribute("class")}}function br(t){if(t){if("object"==typeof t){var e={};return!1!==t.css&&I(e,wr(t.name||"v")),I(e,t),e}return"string"==typeof t?wr(t):void 0}}var wr=v(function(t){return{enterClass:t+"-enter",enterToClass:t+"-enter-to",enterActiveClass:t+"-enter-active",leaveClass:t+"-leave",leaveToClass:t+"-leave-to",leaveActiveClass:t+"-leave-active"}}),Sr=$&&!q,Tr="transition",Mr="animation",Ir="transition",Cr="transitionend",Ar="animation",kr="animationend";Sr&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(Ir="WebkitTransition",Cr="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(Ar="WebkitAnimation",kr="webkitAnimationEnd"));var Dr=$?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(t){return t()};function Er(t){Dr(function(){Dr(t)})}function Pr(t,e){var i=t._transitionClasses||(t._transitionClasses=[]);i.indexOf(e)<0&&(i.push(e),_r(t,e))}function Lr(t,e){t._transitionClasses&&m(t._transitionClasses,e),xr(t,e)}function zr(t,e,i){var n=Rr(t,e),r=n.type,o=n.timeout,a=n.propCount;if(!r)return i();var s=r===Tr?Cr:kr,l=0,u=function(){t.removeEventListener(s,c),i()},c=function(e){e.target===t&&++l>=a&&u()};setTimeout(function(){l<a&&u()},o+1),t.addEventListener(s,c)}var Or=/\b(transform|all)(,|$)/;function Rr(t,e){var i,n=window.getComputedStyle(t),r=(n[Ir+"Delay"]||"").split(", "),o=(n[Ir+"Duration"]||"").split(", "),a=Br(r,o),s=(n[Ar+"Delay"]||"").split(", "),l=(n[Ar+"Duration"]||"").split(", "),u=Br(s,l),c=0,h=0;return e===Tr?a>0&&(i=Tr,c=a,h=o.length):e===Mr?u>0&&(i=Mr,c=u,h=l.length):h=(i=(c=Math.max(a,u))>0?a>u?Tr:Mr:null)?i===Tr?o.length:l.length:0,{type:i,timeout:c,propCount:h,hasTransform:i===Tr&&Or.test(n[Ir+"Property"])}}function Br(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max.apply(null,e.map(function(e,i){return Nr(e)+Nr(t[i])}))}function Nr(t){return 1e3*+t.slice(0,-1).replace(",",".")}function Fr(t,n){var r=t.elm;i(r._leaveCb)&&(r._leaveCb.cancelled=!0,r._leaveCb());var a=br(t.data.transition);if(!e(a)&&!i(r._enterCb)&&1===r.nodeType){for(var s=a.css,l=a.type,u=a.enterClass,c=a.enterToClass,p=a.enterActiveClass,d=a.appearClass,f=a.appearToClass,m=a.appearActiveClass,g=a.beforeEnter,y=a.enter,v=a.afterEnter,_=a.enterCancelled,x=a.beforeAppear,b=a.appear,w=a.afterAppear,S=a.appearCancelled,T=a.duration,M=Xe,I=Xe.$vnode;I&&I.parent;)M=I.context,I=I.parent;var C=!M._isMounted||!t.isRootInsert;if(!C||b||""===b){var A=C&&d?d:u,k=C&&m?m:p,D=C&&f?f:c,E=C&&x||g,P=C&&"function"==typeof b?b:y,z=C&&w||v,O=C&&S||_,R=h(o(T)?T.enter:T),B=!1!==s&&!q,N=Gr(P),F=r._enterCb=L(function(){B&&(Lr(r,D),Lr(r,k)),F.cancelled?(B&&Lr(r,A),O&&O(r)):z&&z(r),r._enterCb=null});t.data.show||oe(t,"insert",function(){var e=r.parentNode,i=e&&e._pending&&e._pending[t.key];i&&i.tag===t.tag&&i.elm._leaveCb&&i.elm._leaveCb(),P&&P(r,F)}),E&&E(r),B&&(Pr(r,A),Pr(r,k),Er(function(){Lr(r,A),F.cancelled||(Pr(r,D),N||(Ur(R)?setTimeout(F,R):zr(r,l,F)))})),t.data.show&&(n&&n(),P&&P(r,F)),B||N||F()}}}function Vr(t,n){var r=t.elm;i(r._enterCb)&&(r._enterCb.cancelled=!0,r._enterCb());var a=br(t.data.transition);if(e(a)||1!==r.nodeType)return n();if(!i(r._leaveCb)){var s=a.css,l=a.type,u=a.leaveClass,c=a.leaveToClass,p=a.leaveActiveClass,d=a.beforeLeave,f=a.leave,m=a.afterLeave,g=a.leaveCancelled,y=a.delayLeave,v=a.duration,_=!1!==s&&!q,x=Gr(f),b=h(o(v)?v.leave:v),w=r._leaveCb=L(function(){r.parentNode&&r.parentNode._pending&&(r.parentNode._pending[t.key]=null),_&&(Lr(r,c),Lr(r,p)),w.cancelled?(_&&Lr(r,u),g&&g(r)):(n(),m&&m(r)),r._leaveCb=null});y?y(S):S()}function S(){w.cancelled||(!t.data.show&&r.parentNode&&((r.parentNode._pending||(r.parentNode._pending={}))[t.key]=t),d&&d(r),_&&(Pr(r,u),Pr(r,p),Er(function(){Lr(r,u),w.cancelled||(Pr(r,c),x||(Ur(b)?setTimeout(w,b):zr(r,l,w)))})),f&&f(r,w),_||x||w())}}function Ur(t){return"number"==typeof t&&!isNaN(t)}function Gr(t){if(e(t))return!1;var n=t.fns;return i(n)?Gr(Array.isArray(n)?n[0]:n):(t._length||t.length)>1}function $r(t,e){!0!==e.data.show&&Fr(e)}var Wr=function(t){var o,a,s={},l=t.modules,u=t.nodeOps;for(o=0;o<5;++o)for(s[rn[o]]=[],a=0;a<l.length;++a)i(l[a][rn[o]])&&s[rn[o]].push(l[a][rn[o]]);function c(t){var e=u.parentNode(t);i(e)&&u.removeChild(e,t)}function h(t,e,r,o,a,l,c){if(i(t.elm)&&i(l)&&(t=l[c]=gt(t)),t.isRootInsert=!a,!function(t,e,r,o){var a=t.data;if(i(a)){var l=i(t.componentInstance)&&a.keepAlive;if(i(a=a.hook)&&i(a=a.init)&&a(t,!1),i(t.componentInstance))return d(t,e),f(r,t.elm,o),n(l)&&function(t,e,n,r){for(var o,a=t;a.componentInstance;)if(i(o=(a=a.componentInstance._vnode).data)&&i(o=o.transition)){for(o=0;o<s.activate.length;++o)s.activate[o](nn,a);e.push(a);break}f(n,t.elm,r)}(t,e,r,o),!0}}(t,e,r,o)){var h=t.data,p=t.children,g=t.tag;i(g)?(t.elm=t.ns?u.createElementNS(t.ns,g):u.createElement(g,t),v(t),m(t,p,e),i(h)&&y(t,e),f(r,t.elm,o)):n(t.isComment)?(t.elm=u.createComment(t.text),f(r,t.elm,o)):(t.elm=u.createTextNode(t.text),f(r,t.elm,o))}}function d(t,e){i(t.data.pendingInsert)&&(e.push.apply(e,t.data.pendingInsert),t.data.pendingInsert=null),t.elm=t.componentInstance.$el,g(t)?(y(t,e),v(t)):(en(t),e.push(t))}function f(t,e,n){i(t)&&(i(n)?u.parentNode(n)===t&&u.insertBefore(t,e,n):u.appendChild(t,e))}function m(t,e,i){if(Array.isArray(e))for(var n=0;n<e.length;++n)h(e[n],i,t.elm,null,!0,e,n);else r(t.text)&&u.appendChild(t.elm,u.createTextNode(t.text+""))}function g(t){for(;t.componentInstance;)t=t.componentInstance._vnode;return i(t.tag)}function y(t,e){for(var n=0;n<s.create.length;++n)s.create[n](nn,t);i(o=t.data.hook)&&(i(o.create)&&o.create(nn,t),i(o.insert)&&e.push(t))}function v(t){var e;if(i(e=t.fnScopeId))u.setStyleScope(t.elm,e);else for(var n=t;n;)i(e=n.context)&&i(e=e.$options._scopeId)&&u.setStyleScope(t.elm,e),n=n.parent;i(e=Xe)&&e!==t.context&&e!==t.fnContext&&i(e=e.$options._scopeId)&&u.setStyleScope(t.elm,e)}function _(t,e,i,n,r,o){for(;n<=r;++n)h(i[n],o,t,e,!1,i,n)}function x(t){var e,n,r=t.data;if(i(r))for(i(e=r.hook)&&i(e=e.destroy)&&e(t),e=0;e<s.destroy.length;++e)s.destroy[e](t);if(i(e=t.children))for(n=0;n<t.children.length;++n)x(t.children[n])}function b(t,e,n){for(;e<=n;++e){var r=t[e];i(r)&&(i(r.tag)?(w(r),x(r)):c(r.elm))}}function w(t,e){if(i(e)||i(t.data)){var n,r=s.remove.length+1;for(i(e)?e.listeners+=r:e=function(t,e){function i(){0==--i.listeners&&c(t)}return i.listeners=e,i}(t.elm,r),i(n=t.componentInstance)&&i(n=n._vnode)&&i(n.data)&&w(n,e),n=0;n<s.remove.length;++n)s.remove[n](t,e);i(n=t.data.hook)&&i(n=n.remove)?n(t,e):e()}else c(t.elm)}function S(t,e,n,r){for(var o=n;o<r;o++){var a=e[o];if(i(a)&&on(t,a))return o}}function T(t,r,o,a,l,c){if(t!==r){i(r.elm)&&i(a)&&(r=a[l]=gt(r));var p=r.elm=t.elm;if(n(t.isAsyncPlaceholder))i(r.asyncFactory.resolved)?C(t.elm,r,o):r.isAsyncPlaceholder=!0;else if(n(r.isStatic)&&n(t.isStatic)&&r.key===t.key&&(n(r.isCloned)||n(r.isOnce)))r.componentInstance=t.componentInstance;else{var d,f=r.data;i(f)&&i(d=f.hook)&&i(d=d.prepatch)&&d(t,r);var m=t.children,y=r.children;if(i(f)&&g(r)){for(d=0;d<s.update.length;++d)s.update[d](t,r);i(d=f.hook)&&i(d=d.update)&&d(t,r)}e(r.text)?i(m)&&i(y)?m!==y&&function(t,n,r,o,a){for(var s,l,c,p=0,d=0,f=n.length-1,m=n[0],g=n[f],y=r.length-1,v=r[0],x=r[y],w=!a;p<=f&&d<=y;)e(m)?m=n[++p]:e(g)?g=n[--f]:on(m,v)?(T(m,v,o,r,d),m=n[++p],v=r[++d]):on(g,x)?(T(g,x,o,r,y),g=n[--f],x=r[--y]):on(m,x)?(T(m,x,o,r,y),w&&u.insertBefore(t,m.elm,u.nextSibling(g.elm)),m=n[++p],x=r[--y]):on(g,v)?(T(g,v,o,r,d),w&&u.insertBefore(t,g.elm,m.elm),g=n[--f],v=r[++d]):(e(s)&&(s=an(n,p,f)),e(l=i(v.key)?s[v.key]:S(v,n,p,f))?h(v,o,t,m.elm,!1,r,d):on(c=n[l],v)?(T(c,v,o,r,d),n[l]=void 0,w&&u.insertBefore(t,c.elm,m.elm)):h(v,o,t,m.elm,!1,r,d),v=r[++d]);p>f?_(t,e(r[y+1])?null:r[y+1].elm,r,d,y,o):d>y&&b(n,p,f)}(p,m,y,o,c):i(y)?(i(t.text)&&u.setTextContent(p,""),_(p,null,y,0,y.length-1,o)):i(m)?b(m,0,m.length-1):i(t.text)&&u.setTextContent(p,""):t.text!==r.text&&u.setTextContent(p,r.text),i(f)&&i(d=f.hook)&&i(d=d.postpatch)&&d(t,r)}}}function M(t,e,r){if(n(r)&&i(t.parent))t.parent.data.pendingInsert=e;else for(var o=0;o<e.length;++o)e[o].data.hook.insert(e[o])}var I=p("attrs,class,staticClass,staticStyle,key");function C(t,e,r,o){var a,s=e.tag,l=e.data,u=e.children;if(o=o||l&&l.pre,e.elm=t,n(e.isComment)&&i(e.asyncFactory))return e.isAsyncPlaceholder=!0,!0;if(i(l)&&(i(a=l.hook)&&i(a=a.init)&&a(e,!0),i(a=e.componentInstance)))return d(e,r),!0;if(i(s)){if(i(u))if(t.hasChildNodes())if(i(a=l)&&i(a=a.domProps)&&i(a=a.innerHTML)){if(a!==t.innerHTML)return!1}else{for(var c=!0,h=t.firstChild,p=0;p<u.length;p++){if(!h||!C(h,u[p],r,o)){c=!1;break}h=h.nextSibling}if(!c||h)return!1}else m(e,u,r);if(i(l)){var f=!1;for(var g in l)if(!I(g)){f=!0,y(e,r);break}!f&&l.class&&ee(l.class)}}else t.data!==e.text&&(t.data=e.text);return!0}return function(t,r,o,a){if(!e(r)){var l,c=!1,p=[];if(e(t))c=!0,h(r,p);else{var d=i(t.nodeType);if(!d&&on(t,r))T(t,r,p,null,null,a);else{if(d){if(1===t.nodeType&&t.hasAttribute(z)&&(t.removeAttribute(z),o=!0),n(o)&&C(t,r,p))return M(r,p,!0),t;l=t,t=new pt(u.tagName(l).toLowerCase(),{},[],void 0,l)}var f=t.elm,m=u.parentNode(f);if(h(r,p,f._leaveCb?null:m,u.nextSibling(f)),i(r.parent))for(var y=r.parent,v=g(r);y;){for(var _=0;_<s.destroy.length;++_)s.destroy[_](y);if(y.elm=r.elm,v){for(var w=0;w<s.create.length;++w)s.create[w](nn,y);var S=y.data.hook.insert;if(S.merged)for(var I=1;I<S.fns.length;I++)S.fns[I]()}else en(y);y=y.parent}i(m)?b([t],0,0):i(t.tag)&&x(t)}}return M(r,p,c),r.elm}i(t)&&x(t)}}({nodeOps:Qi,modules:[yn,Mn,nr,ar,yr,$?{create:$r,activate:$r,remove:function(t,e){!0!==t.data.show?Vr(t,e):e()}}:{}].concat(dn)});q&&document.addEventListener("selectionchange",function(){var t=document.activeElement;t&&t.vmodel&&Jr(t,"input")});var Hr={inserted:function(t,e,i,n){"select"===i.tag?(n.elm&&!n.elm._vOptions?oe(i,"postpatch",function(){Hr.componentUpdated(t,e,i)}):jr(t,e,i.context),t._vOptions=[].map.call(t.options,Xr)):("textarea"===i.tag||Ki(t.type))&&(t._vModifiers=e.modifiers,e.modifiers.lazy||(t.addEventListener("compositionstart",Yr),t.addEventListener("compositionend",Kr),t.addEventListener("change",Kr),q&&(t.vmodel=!0)))},componentUpdated:function(t,e,i){if("select"===i.tag){jr(t,e,i.context);var n=t._vOptions,r=t._vOptions=[].map.call(t.options,Xr);r.some(function(t,e){return!E(t,n[e])})&&(t.multiple?e.value.some(function(t){return qr(t,r)}):e.value!==e.oldValue&&qr(e.value,r))&&Jr(t,"change")}}};function jr(t,e,i){Zr(t,e,i),(Z||X)&&setTimeout(function(){Zr(t,e,i)},0)}function Zr(t,e,i){var n=e.value,r=t.multiple;if(!r||Array.isArray(n)){for(var o,a,s=0,l=t.options.length;s<l;s++)if(a=t.options[s],r)o=P(n,Xr(a))>-1,a.selected!==o&&(a.selected=o);else if(E(Xr(a),n))return void(t.selectedIndex!==s&&(t.selectedIndex=s));r||(t.selectedIndex=-1)}}function qr(t,e){return e.every(function(e){return!E(e,t)})}function Xr(t){return"_value"in t?t._value:t.value}function Yr(t){t.target.composing=!0}function Kr(t){t.target.composing&&(t.target.composing=!1,Jr(t.target,"input"))}function Jr(t,e){var i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!0),t.dispatchEvent(i)}function Qr(t){return!t.componentInstance||t.data&&t.data.transition?t:Qr(t.componentInstance._vnode)}var to={model:Hr,show:{bind:function(t,e,i){var n=e.value,r=(i=Qr(i)).data&&i.data.transition,o=t.__vOriginalDisplay="none"===t.style.display?"":t.style.display;n&&r?(i.data.show=!0,Fr(i,function(){t.style.display=o})):t.style.display=n?o:"none"},update:function(t,e,i){var n=e.value;!n!=!e.oldValue&&((i=Qr(i)).data&&i.data.transition?(i.data.show=!0,n?Fr(i,function(){t.style.display=t.__vOriginalDisplay}):Vr(i,function(){t.style.display="none"})):t.style.display=n?t.__vOriginalDisplay:"none")},unbind:function(t,e,i,n,r){r||(t.style.display=t.__vOriginalDisplay)}}},eo={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function io(t){var e=t&&t.componentOptions;return e&&e.Ctor.options.abstract?io(We(e.children)):t}function no(t){var e={},i=t.$options;for(var n in i.propsData)e[n]=t[n];var r=i._parentListeners;for(var o in r)e[x(o)]=r[o];return e}function ro(t,e){if(/\d-keep-alive$/.test(e.tag))return t("keep-alive",{props:e.componentOptions.propsData})}var oo=function(t){return t.tag||pe(t)},ao=function(t){return"show"===t.name},so={name:"transition",props:eo,abstract:!0,render:function(t){var e=this,i=this.$slots.default;if(i&&(i=i.filter(oo)).length){var n=this.mode,o=i[0];if(function(t){for(;t=t.parent;)if(t.data.transition)return!0}(this.$vnode))return o;var a=io(o);if(!a)return o;if(this._leaving)return ro(t,o);var s="__transition-"+this._uid+"-";a.key=null==a.key?a.isComment?s+"comment":s+a.tag:r(a.key)?0===(a.key+"").indexOf(s)?a.key:s+a.key:a.key;var l=(a.data||(a.data={})).transition=no(this),u=this._vnode,c=io(u);if(a.data.directives&&a.data.directives.some(ao)&&(a.data.show=!0),c&&c.data&&!function(t,e){return e.key===t.key&&e.tag===t.tag}(a,c)&&!pe(c)&&(!c.componentInstance||!c.componentInstance._vnode.isComment)){var h=c.data.transition=I({},l);if("out-in"===n)return this._leaving=!0,oe(h,"afterLeave",function(){e._leaving=!1,e.$forceUpdate()}),ro(t,o);if("in-out"===n){if(pe(a))return u;var p,d=function(){p()};oe(l,"afterEnter",d),oe(l,"enterCancelled",d),oe(h,"delayLeave",function(t){p=t})}}return o}}},lo=I({tag:String,moveClass:String},eo);function uo(t){t.elm._moveCb&&t.elm._moveCb(),t.elm._enterCb&&t.elm._enterCb()}function co(t){t.data.newPos=t.elm.getBoundingClientRect()}function ho(t){var e=t.data.pos,i=t.data.newPos,n=e.left-i.left,r=e.top-i.top;if(n||r){t.data.moved=!0;var o=t.elm.style;o.transform=o.WebkitTransform="translate("+n+"px,"+r+"px)",o.transitionDuration="0s"}}delete lo.mode;var po={Transition:so,TransitionGroup:{props:lo,beforeMount:function(){var t=this,e=this._update;this._update=function(i,n){var r=Ye(t);t.__patch__(t._vnode,t.kept,!1,!0),t._vnode=t.kept,r(),e.call(t,i,n)}},render:function(t){for(var e=this.tag||this.$vnode.data.tag||"span",i=Object.create(null),n=this.prevChildren=this.children,r=this.$slots.default||[],o=this.children=[],a=no(this),s=0;s<r.length;s++){var l=r[s];l.tag&&null!=l.key&&0!==(l.key+"").indexOf("__vlist")&&(o.push(l),i[l.key]=l,(l.data||(l.data={})).transition=a)}if(n){for(var u=[],c=[],h=0;h<n.length;h++){var p=n[h];p.data.transition=a,p.data.pos=p.elm.getBoundingClientRect(),i[p.key]?u.push(p):c.push(p)}this.kept=t(e,null,u),this.removed=c}return t(e,null,o)},updated:function(){var t=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";t.length&&this.hasMove(t[0].elm,e)&&(t.forEach(uo),t.forEach(co),t.forEach(ho),this._reflow=document.body.offsetHeight,t.forEach(function(t){if(t.data.moved){var i=t.elm,n=i.style;Pr(i,e),n.transform=n.WebkitTransform=n.transitionDuration="",i.addEventListener(Cr,i._moveCb=function t(n){n&&n.target!==i||n&&!/transform$/.test(n.propertyName)||(i.removeEventListener(Cr,t),i._moveCb=null,Lr(i,e))})}}))},methods:{hasMove:function(t,e){if(!Sr)return!1;if(this._hasMove)return this._hasMove;var i=t.cloneNode();t._transitionClasses&&t._transitionClasses.forEach(function(t){xr(i,t)}),_r(i,e),i.style.display="none",this.$el.appendChild(i);var n=Rr(i);return this.$el.removeChild(i),this._hasMove=n.hasTransform}}}};wi.config.mustUseProp=Pi,wi.config.isReservedTag=qi,wi.config.isReservedAttr=Di,wi.config.getTagNamespace=Xi,wi.config.isUnknownElement=function(t){if(!$)return!0;if(qi(t))return!1;if(t=t.toLowerCase(),null!=Yi[t])return Yi[t];var e=document.createElement(t);return t.indexOf("-")>-1?Yi[t]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:Yi[t]=/HTMLUnknownElement/.test(e.toString())},I(wi.options.directives,to),I(wi.options.components,po),wi.prototype.__patch__=$?Wr:A,wi.prototype.$mount=function(t,e){return function(t,e,i){var n;return t.$el=e,t.$options.render||(t.$options.render=ft),Qe(t,"beforeMount"),n=function(){t._update(t._render(),i)},new hi(t,n,A,{before:function(){t._isMounted&&!t._isDestroyed&&Qe(t,"beforeUpdate")}},!0),i=!1,null==t.$vnode&&(t._isMounted=!0,Qe(t,"mounted")),t}(this,t=t&&$?Ji(t):void 0,e)},$&&setTimeout(function(){B.devtools&&it&&it.emit("init",wi)},0);var fo=/\{\{((?:.|\r?\n)+?)\}\}/g,mo=/[-.*+?^${}()|[\]\/\\]/g,go=v(function(t){var e=t[0].replace(mo,"\\$&"),i=t[1].replace(mo,"\\$&");return RegExp(e+"((?:.|\\n)+?)"+i,"g")}),yo={staticKeys:["staticClass"],transformNode:function(t,e){e.warn;var i=Nn(t,"class");i&&(t.staticClass=JSON.stringify(i));var n=Bn(t,"class",!1);n&&(t.classBinding=n)},genData:function(t){var e="";return t.staticClass&&(e+="staticClass:"+t.staticClass+","),t.classBinding&&(e+="class:"+t.classBinding+","),e}},vo,_o={staticKeys:["staticStyle"],transformNode:function(t,e){e.warn;var i=Nn(t,"style");i&&(t.staticStyle=JSON.stringify(sr(i)));var n=Bn(t,"style",!1);n&&(t.styleBinding=n)},genData:function(t){var e="";return t.staticStyle&&(e+="staticStyle:"+t.staticStyle+","),t.styleBinding&&(e+="style:("+t.styleBinding+"),"),e}},xo=function(t){return(vo=vo||document.createElement("div")).innerHTML=t,vo.textContent},bo=p("area,base,br,col,embed,frame,hr,img,input,isindex,keygen,link,meta,param,source,track,wbr"),wo=p("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr,source"),So=p("address,article,aside,base,blockquote,body,caption,col,colgroup,dd,details,dialog,div,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,legend,li,menuitem,meta,optgroup,option,param,rp,rt,source,style,summary,tbody,td,tfoot,th,thead,title,tr,track"),To=/^\s*([^\s"'<>\/=]+)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,Mo=/^\s*((?:v-[\w-]+:|@|:|#)\[[^=]+?\][^\s"'<>\/=]*)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,Io="[a-zA-Z_][\\-\\.0-9_a-zA-Z"+N.source+"]*",Co="((?:"+Io+"\\:)?"+Io+")",Ao=RegExp("^<"+Co),ko=/^\s*(\/?)>/,Do=RegExp("^<\\/"+Co+"[^>]*>"),Eo=/^<!DOCTYPE [^>]+>/i,Po=/^<!\--/,Lo=/^<!\[/,zo=p("script,style,textarea",!0),Oo={},Ro={"&lt;":"<","&gt;":">","&quot;":'"',"&amp;":"&","&#10;":"\n","&#9;":"\t","&#39;":"'"},Bo=/&(?:lt|gt|quot|amp|#39);/g,No=/&(?:lt|gt|quot|amp|#39|#10|#9);/g,Fo=p("pre,textarea",!0),Vo=function(t,e){return t&&Fo(t)&&"\n"===e[0]};function Uo(t,e){var i=e?No:Bo;return t.replace(i,function(t){return Ro[t]})}var Go,$o,Wo,Ho,jo,Zo,qo,Xo,Yo=/^@|^v-on:/,Ko=/^v-|^@|^:|^#/,Jo=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,Qo=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,ta=/^\(|\)$/g,ea=/^\[.*\]$/,ia=/:(.*)$/,na=/^:|^\.|^v-bind:/,ra=/\.[^.\]]+(?=[^\]]*$)/g,oa=/^v-slot(:|$)|^#/,aa=/[\r\n]/,sa=/[ \f\t\r\n]+/g,la=v(xo),ua="_empty_";function ca(t,e,i){return{type:1,tag:t,attrsList:e,attrsMap:ya(e),rawAttrsMap:{},parent:i,children:[]}}function ha(t,e){Go=e.warn||kn,Zo=e.isPreTag||k,qo=e.mustUseProp||k,Xo=e.getTagNamespace||k,e.isReservedTag,Wo=Dn(e.modules,"transformNode"),Ho=Dn(e.modules,"preTransformNode"),jo=Dn(e.modules,"postTransformNode"),$o=e.delimiters;var i,n,r=[],o=!1!==e.preserveWhitespace,a=e.whitespace,s=!1,l=!1;function u(t){if(c(t),s||t.processed||(t=pa(t,e)),r.length||t===i||i.if&&(t.elseif||t.else)&&fa(i,{exp:t.elseif,block:t}),n&&!t.forbidden)if(t.elseif||t.else)a=t,(u=function(t){for(var e=t.length;e--;){if(1===t[e].type)return t[e];t.pop()}}(n.children))&&u.if&&fa(u,{exp:a.elseif,block:a});else{if(t.slotScope){var o=t.slotTarget||'"default"';(n.scopedSlots||(n.scopedSlots={}))[o]=t}n.children.push(t),t.parent=n}var a,u;t.children=t.children.filter(function(t){return!t.slotScope}),c(t),t.pre&&(s=!1),Zo(t.tag)&&(l=!1);for(var h=0;h<jo.length;h++)jo[h](t,e)}function c(t){if(!l)for(var e;(e=t.children[t.children.length-1])&&3===e.type&&" "===e.text;)t.children.pop()}return function(t,e){for(var i,n,r=[],o=e.expectHTML,a=e.isUnaryTag||k,s=e.canBeLeftOpenTag||k,l=0;t;){if(i=t,n&&zo(n)){var u=0,c=n.toLowerCase(),h=Oo[c]||(Oo[c]=RegExp("([\\s\\S]*?)(</"+c+"[^>]*>)","i")),p=t.replace(h,function(t,i,n){return u=n.length,zo(c)||"noscript"===c||(i=i.replace(/<!\--([\s\S]*?)-->/g,"$1").replace(/<!\[CDATA\[([\s\S]*?)]]>/g,"$1")),Vo(c,i)&&(i=i.slice(1)),e.chars&&e.chars(i),""});l+=t.length-p.length,t=p,I(c,l-u,l)}else{var d=t.indexOf("<");if(0===d){if(Po.test(t)){var f=t.indexOf("--\x3e");if(f>=0){e.shouldKeepComment&&e.comment(t.substring(4,f),l,l+f+3),S(f+3);continue}}if(Lo.test(t)){var m=t.indexOf("]>");if(m>=0){S(m+2);continue}}var g=t.match(Eo);if(g){S(g[0].length);continue}var y=t.match(Do);if(y){var v=l;S(y[0].length),I(y[1],v,l);continue}var _=T();if(_){M(_),Vo(_.tagName,t)&&S(1);continue}}var x=void 0,b=void 0,w=void 0;if(d>=0){for(b=t.slice(d);!(Do.test(b)||Ao.test(b)||Po.test(b)||Lo.test(b)||(w=b.indexOf("<",1))<0);)d+=w,b=t.slice(d);x=t.substring(0,d)}d<0&&(x=t),x&&S(x.length),e.chars&&x&&e.chars(x,l-x.length,l)}if(t===i){e.chars&&e.chars(t);break}}function S(e){l+=e,t=t.substring(e)}function T(){var e=t.match(Ao);if(e){var i,n,r={tagName:e[1],attrs:[],start:l};for(S(e[0].length);!(i=t.match(ko))&&(n=t.match(Mo)||t.match(To));)n.start=l,S(n[0].length),n.end=l,r.attrs.push(n);if(i)return r.unarySlash=i[1],S(i[0].length),r.end=l,r}}function M(t){var i=t.tagName,l=t.unarySlash;o&&("p"===n&&So(i)&&I(n),s(i)&&n===i&&I(i));for(var u=a(i)||!!l,c=t.attrs.length,h=Array(c),p=0;p<c;p++){var d=t.attrs[p],f=d[3]||d[4]||d[5]||"",m="a"===i&&"href"===d[1]?e.shouldDecodeNewlinesForHref:e.shouldDecodeNewlines;h[p]={name:d[1],value:Uo(f,m)}}u||(r.push({tag:i,lowerCasedTag:i.toLowerCase(),attrs:h,start:t.start,end:t.end}),n=i),e.start&&e.start(i,h,u,t.start,t.end)}function I(t,i,o){var a,s;if(null==i&&(i=l),null==o&&(o=l),t)for(s=t.toLowerCase(),a=r.length-1;a>=0&&r[a].lowerCasedTag!==s;a--);else a=0;if(a>=0){for(var u=r.length-1;u>=a;u--)e.end&&e.end(r[u].tag,i,o);r.length=a,n=a&&r[a-1].tag}else"br"===s?e.start&&e.start(t,[],!0,i,o):"p"===s&&(e.start&&e.start(t,[],!1,i,o),e.end&&e.end(t,i,o))}I()}(t,{warn:Go,expectHTML:e.expectHTML,isUnaryTag:e.isUnaryTag,canBeLeftOpenTag:e.canBeLeftOpenTag,shouldDecodeNewlines:e.shouldDecodeNewlines,shouldDecodeNewlinesForHref:e.shouldDecodeNewlinesForHref,shouldKeepComment:e.comments,outputSourceRange:e.outputSourceRange,start:function(t,o,a,c,h){var p=n&&n.ns||Xo(t);Z&&"svg"===p&&(o=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];va.test(n.name)||(n.name=n.name.replace(_a,""),e.push(n))}return e}(o));var d,f=ca(t,o,n);p&&(f.ns=p),"style"!==(d=f).tag&&("script"!==d.tag||d.attrsMap.type&&"text/javascript"!==d.attrsMap.type)||et()||(f.forbidden=!0);for(var m=0;m<Ho.length;m++)f=Ho[m](f,e)||f;s||(function(t){null!=Nn(t,"v-pre")&&(t.pre=!0)}(f),f.pre&&(s=!0)),Zo(f.tag)&&(l=!0),s?function(t){var e=t.attrsList,i=e.length;if(i)for(var n=t.attrs=Array(i),r=0;r<i;r++)n[r]={name:e[r].name,value:JSON.stringify(e[r].value)},null!=e[r].start&&(n[r].start=e[r].start,n[r].end=e[r].end);else t.pre||(t.plain=!0)}(f):f.processed||(da(f),function(t){var e=Nn(t,"v-if");if(e)t.if=e,fa(t,{exp:e,block:t});else{null!=Nn(t,"v-else")&&(t.else=!0);var i=Nn(t,"v-else-if");i&&(t.elseif=i)}}(f),function(t){null!=Nn(t,"v-once")&&(t.once=!0)}(f)),i||(i=f),a?u(f):(n=f,r.push(f))},end:function(t,e,i){var o=r[r.length-1];r.length-=1,n=r[r.length-1],u(o)},chars:function(t,e,i){if(n&&(!Z||"textarea"!==n.tag||n.attrsMap.placeholder!==t)){var r,u,c,h=n.children;(t=l||t.trim()?"script"===(r=n).tag||"style"===r.tag?t:la(t):h.length?a?"condense"===a&&aa.test(t)?"":" ":o?" ":"":"")&&(l||"condense"!==a||(t=t.replace(sa," ")),!s&&" "!==t&&(u=function(t,e){var i=e?go(e):fo;if(i.test(t)){for(var n,r,o,a=[],s=[],l=i.lastIndex=0;n=i.exec(t);){(r=n.index)>l&&(s.push(o=t.slice(l,r)),a.push(JSON.stringify(o)));var u=Cn(n[1].trim());a.push("_s("+u+")"),s.push({"@binding":u}),l=r+n[0].length}return l<t.length&&(s.push(o=t.slice(l)),a.push(JSON.stringify(o))),{expression:a.join("+"),tokens:s}}}(t,$o))?c={type:2,expression:u.expression,tokens:u.tokens,text:t}:" "===t&&h.length&&" "===h[h.length-1].text||(c={type:3,text:t}),c&&h.push(c))}},comment:function(t,e,i){if(n){var r={type:3,text:t,isComment:!0};n.children.push(r)}}}),i}function pa(t,e){var i,n;(n=Bn(i=t,"key"))&&(i.key=n),t.plain=!t.key&&!t.scopedSlots&&!t.attrsList.length,function(t){var e=Bn(t,"ref");e&&(t.ref=e,t.refInFor=function(t){for(var e=t;e;){if(void 0!==e.for)return!0;e=e.parent}return!1}(t))}(t),function(t){var e;"template"===t.tag?(e=Nn(t,"scope"),t.slotScope=e||Nn(t,"slot-scope")):(e=Nn(t,"slot-scope"))&&(t.slotScope=e);var i=Bn(t,"slot");if(i&&(t.slotTarget='""'===i?'"default"':i,t.slotTargetDynamic=!(!t.attrsMap[":slot"]&&!t.attrsMap["v-bind:slot"]),"template"===t.tag||t.slotScope||Pn(t,"slot",i,function(t,e){return t.rawAttrsMap[":"+e]||t.rawAttrsMap["v-bind:"+e]||t.rawAttrsMap[e]}(t,"slot"))),"template"===t.tag){var n=Fn(t,oa);if(n){var r=ma(n),o=r.name,a=r.dynamic;t.slotTarget=o,t.slotTargetDynamic=a,t.slotScope=n.value||ua}}else{var s=Fn(t,oa);if(s){var l=t.scopedSlots||(t.scopedSlots={}),u=ma(s),c=u.name,h=u.dynamic,p=l[c]=ca("template",[],t);p.slotTarget=c,p.slotTargetDynamic=h,p.children=t.children.filter(function(t){if(!t.slotScope)return t.parent=p,!0}),p.slotScope=s.value||ua,t.children=[],t.plain=!1}}}(t),function(t){"slot"===t.tag&&(t.slotName=Bn(t,"name"))}(t),function(t){var e;(e=Bn(t,"is"))&&(t.component=e),null!=Nn(t,"inline-template")&&(t.inlineTemplate=!0)}(t);for(var r=0;r<Wo.length;r++)t=Wo[r](t,e)||t;return function(t){var e,i,n,r,o,a,s,l,u=t.attrsList;for(e=0,i=u.length;e<i;e++)if(n=r=u[e].name,o=u[e].value,Ko.test(n))if(t.hasBindings=!0,(a=ga(n.replace(Ko,"")))&&(n=n.replace(ra,"")),na.test(n))n=n.replace(na,""),o=Cn(o),(l=ea.test(n))&&(n=n.slice(1,-1)),a&&(a.prop&&!l&&"innerHtml"===(n=x(n))&&(n="innerHTML"),a.camel&&!l&&(n=x(n)),a.sync&&(s=Gn(o,"$event"),l?Rn(t,'"update:"+('+n+")",s,null,!1,0,u[e],!0):(Rn(t,"update:"+x(n),s,null,!1,0,u[e]),S(n)!==x(n)&&Rn(t,"update:"+S(n),s,null,!1,0,u[e])))),a&&a.prop||!t.component&&qo(t.tag,t.attrsMap.type,n)?En(t,n,o,u[e],l):Pn(t,n,o,u[e],l);else if(Yo.test(n))n=n.replace(Yo,""),(l=ea.test(n))&&(n=n.slice(1,-1)),Rn(t,n,o,a,!1,0,u[e],l);else{var c=(n=n.replace(Ko,"")).match(ia),h=c&&c[1];l=!1,h&&(n=n.slice(0,-(h.length+1)),ea.test(h)&&(h=h.slice(1,-1),l=!0)),zn(t,n,r,o,h,l,a,u[e])}else Pn(t,n,JSON.stringify(o),u[e]),!t.component&&"muted"===n&&qo(t.tag,t.attrsMap.type,n)&&En(t,n,"true",u[e])}(t),t}function da(t){var e;if(e=Nn(t,"v-for")){var i=function(t){var e=t.match(Jo);if(e){var i={};i.for=e[2].trim();var n=e[1].trim().replace(ta,""),r=n.match(Qo);return r?(i.alias=n.replace(Qo,"").trim(),i.iterator1=r[1].trim(),r[2]&&(i.iterator2=r[2].trim())):i.alias=n,i}}(e);i&&I(t,i)}}function fa(t,e){t.ifConditions||(t.ifConditions=[]),t.ifConditions.push(e)}function ma(t){var e=t.name.replace(oa,"");return e||"#"!==t.name[0]&&(e="default"),ea.test(e)?{name:e.slice(1,-1),dynamic:!0}:{name:'"'+e+'"',dynamic:!1}}function ga(t){var e=t.match(ra);if(e){var i={};return e.forEach(function(t){i[t.slice(1)]=!0}),i}}function ya(t){for(var e={},i=0,n=t.length;i<n;i++)e[t[i].name]=t[i].value;return e}var va=/^xmlns:NS\d+/,_a=/^NS\d+:/;function xa(t){return ca(t.tag,t.attrsList.slice(),t.parent)}var ba=[yo,_o,{preTransformNode:function(t,e){if("input"===t.tag){var i,n=t.attrsMap;if(!n["v-model"])return;if((n[":type"]||n["v-bind:type"])&&(i=Bn(t,"type")),n.type||i||!n["v-bind"]||(i="("+n["v-bind"]+").type"),i){var r=Nn(t,"v-if",!0),o=r?"&&("+r+")":"",a=null!=Nn(t,"v-else",!0),s=Nn(t,"v-else-if",!0),l=xa(t);da(l),Ln(l,"type","checkbox"),pa(l,e),l.processed=!0,l.if="("+i+")==='checkbox'"+o,fa(l,{exp:l.if,block:l});var u=xa(t);Nn(u,"v-for",!0),Ln(u,"type","radio"),pa(u,e),fa(l,{exp:"("+i+")==='radio'"+o,block:u});var c=xa(t);return Nn(c,"v-for",!0),Ln(c,":type",i),pa(c,e),fa(l,{exp:r,block:c}),a?l.else=!0:s&&(l.elseif=s),l}}}}],wa,Sa,Ta={expectHTML:!0,modules:ba,directives:{model:function(t,e,i){var n=e.value,r=e.modifiers,o=t.tag,a=t.attrsMap.type;if(t.component)return Un(t,n,r),!1;if("select"===o)!function(t,e,i){var n='var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = "_value" in o ? o._value : o.value;return '+(i&&i.number?"_n(val)":"val")+"});";Rn(t,"change",n=n+" "+Gn(e,"$event.target.multiple ? $$selectedVal : $$selectedVal[0]"),null,!0)}(t,n,r);else if("input"===o&&"checkbox"===a)!function(t,e,i){var n=i&&i.number,r=Bn(t,"value")||"null",o=Bn(t,"true-value")||"true",a=Bn(t,"false-value")||"false";En(t,"checked","Array.isArray("+e+")?_i("+e+","+r+")>-1"+("true"===o?":("+e+")":":_q("+e+","+o+")")),Rn(t,"change","var $$a="+e+",$$el=$event.target,$$c=$$el.checked?("+o+"):("+a+");if(Array.isArray($$a)){var $$v="+(n?"_n("+r+")":r)+",$$i=_i($$a,$$v);if($$el.checked){$$i<0&&("+Gn(e,"$$a.concat([$$v])")+")}else{$$i>-1&&("+Gn(e,"$$a.slice(0,$$i).concat($$a.slice($$i+1))")+")}}else{"+Gn(e,"$$c")+"}",null,!0)}(t,n,r);else if("input"===o&&"radio"===a)!function(t,e,i){var n=i&&i.number,r=Bn(t,"value")||"null";En(t,"checked","_q("+e+","+(r=n?"_n("+r+")":r)+")"),Rn(t,"change",Gn(e,r),null,!0)}(t,n,r);else if("input"===o||"textarea"===o)!function(t,e,i){var n=t.attrsMap.type,r=i||{},o=r.lazy,a=r.number,s=r.trim,l=!o&&"range"!==n,u=o?"change":"range"===n?Xn:"input",c="$event.target.value";s&&(c="$event.target.value.trim()"),a&&(c="_n("+c+")");var h=Gn(e,c);l&&(h="if($event.target.composing)return;"+h),En(t,"value","("+e+")"),Rn(t,u,h,null,!0),(s||a)&&Rn(t,"blur","$forceUpdate()")}(t,n,r);else if(!B.isReservedTag(o))return Un(t,n,r),!1;return!0},text:function(t,e){e.value&&En(t,"textContent","_s("+e.value+")",e)},html:function(t,e){e.value&&En(t,"innerHTML","_s("+e.value+")",e)}},isPreTag:function(t){return"pre"===t},isUnaryTag:bo,mustUseProp:Pi,canBeLeftOpenTag:wo,isReservedTag:qi,getTagNamespace:Xi,staticKeys:function(t){return t.reduce(function(t,e){return t.concat(e.staticKeys||[])},[]).join(",")}(ba)},Ma=v(function(t){return p("type,tag,attrsList,attrsMap,plain,parent,children,attrs,start,end,rawAttrsMap"+(t?","+t:""))});function Ia(t,e){t&&(wa=Ma(e.staticKeys||""),Sa=e.isReservedTag||k,function t(e){if(e.static=function(t){return 2!==t.type&&(3===t.type||!(!t.pre&&(t.hasBindings||t.if||t.for||d(t.tag)||!Sa(t.tag)||function(t){for(;t.parent;){if("template"!==(t=t.parent).tag)return!1;if(t.for)return!0}return!1}(t)||!Object.keys(t).every(wa))))}(e),1===e.type){if(!Sa(e.tag)&&"slot"!==e.tag&&null==e.attrsMap["inline-template"])return;for(var i=0,n=e.children.length;i<n;i++){var r=e.children[i];t(r),r.static||(e.static=!1)}if(e.ifConditions)for(var o=1,a=e.ifConditions.length;o<a;o++){var s=e.ifConditions[o].block;t(s),s.static||(e.static=!1)}}}(t),function t(e,i){if(1===e.type){if((e.static||e.once)&&(e.staticInFor=i),e.static&&e.children.length&&(1!==e.children.length||3!==e.children[0].type))return void(e.staticRoot=!0);if(e.staticRoot=!1,e.children)for(var n=0,r=e.children.length;n<r;n++)t(e.children[n],i||!!e.for);if(e.ifConditions)for(var o=1,a=e.ifConditions.length;o<a;o++)t(e.ifConditions[o].block,i)}}(t,!1))}var Ca=/^([\w$_]+|\([^)]*?\))\s*=>|^function(?:\s+[\w$]+)?\s*\(/,Aa=/\([^)]*?\);*$/,ka=/^[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['[^']*?']|\["[^"]*?"]|\[\d+]|\[[A-Za-z_$][\w$]*])*$/,Da={esc:27,tab:9,enter:13,space:32,up:38,left:37,right:39,down:40,delete:[8,46]},Ea={esc:["Esc","Escape"],tab:"Tab",enter:"Enter",space:[" ","Spacebar"],up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete","Del"]},Pa=function(t){return"if("+t+")return null;"},La={stop:"$event.stopPropagation();",prevent:"$event.preventDefault();",self:Pa("$event.target !== $event.currentTarget"),ctrl:Pa("!$event.ctrlKey"),shift:Pa("!$event.shiftKey"),alt:Pa("!$event.altKey"),meta:Pa("!$event.metaKey"),left:Pa("'button' in $event && $event.button !== 0"),middle:Pa("'button' in $event && $event.button !== 1"),right:Pa("'button' in $event && $event.button !== 2")};function za(t,e){var i=e?"nativeOn:":"on:",n="",r="";for(var o in t){var a=Oa(t[o]);t[o]&&t[o].dynamic?r+=o+","+a+",":n+='"'+o+'":'+a+","}return n="{"+n.slice(0,-1)+"}",r?i+"_d("+n+",["+r.slice(0,-1)+"])":i+n}function Oa(t){if(!t)return"function(){}";if(Array.isArray(t))return"["+t.map(function(t){return Oa(t)}).join(",")+"]";var e=ka.test(t.value),i=Ca.test(t.value),n=ka.test(t.value.replace(Aa,""));if(t.modifiers){var r="",o="",a=[];for(var s in t.modifiers)if(La[s])o+=La[s],Da[s]&&a.push(s);else if("exact"===s){var l=t.modifiers;o+=Pa(["ctrl","shift","alt","meta"].filter(function(t){return!l[t]}).map(function(t){return"$event."+t+"Key"}).join("||"))}else a.push(s);return a.length&&(r+=function(t){return"if(!$event.type.indexOf('key')&&"+t.map(Ra).join("&&")+")return null;"}(a)),o&&(r+=o),"function($event){"+r+(e?"return "+t.value+".apply(null, arguments)":i?"return ("+t.value+").apply(null, arguments)":n?"return "+t.value:t.value)+"}"}return e||i?t.value:"function($event){"+(n?"return "+t.value:t.value)+"}"}function Ra(t){var e=parseInt(t,10);if(e)return"$event.keyCode!=="+e;var i=Da[t],n=Ea[t];return"_k($event.keyCode,"+JSON.stringify(t)+","+JSON.stringify(i)+",$event.key,"+JSON.stringify(n)+")"}var Ba={on:function(t,e){t.wrapListeners=function(t){return"_g("+t+","+e.value+")"}},bind:function(t,e){t.wrapData=function(i){return"_b("+i+",'"+t.tag+"',"+e.value+","+(e.modifiers&&e.modifiers.prop?"true":"false")+(e.modifiers&&e.modifiers.sync?",true":"")+")"}},cloak:A},Na=function(t){this.options=t,this.warn=t.warn||kn,this.transforms=Dn(t.modules,"transformCode"),this.dataGenFns=Dn(t.modules,"genData"),this.directives=I(I({},Ba),t.directives);var e=t.isReservedTag||k;this.maybeComponent=function(t){return!!t.component||!e(t.tag)},this.onceId=0,this.staticRenderFns=[],this.pre=!1};function Fa(t,e){var i=new Na(e);return{render:"with(this){return "+(t?"script"===t.tag?"null":Va(t,i):'_c("div")')+"}",staticRenderFns:i.staticRenderFns}}function Va(t,e){if(t.parent&&(t.pre=t.pre||t.parent.pre),t.staticRoot&&!t.staticProcessed)return Ua(t,e);if(t.once&&!t.onceProcessed)return Ga(t,e);if(t.for&&!t.forProcessed)return Wa(t,e);if(t.if&&!t.ifProcessed)return $a(t,e);if("template"!==t.tag||t.slotTarget||e.pre){if("slot"===t.tag)return function(t,e){var i=t.slotName||'"default"',n=qa(t,e),r="_t("+i+(n?",function(){return "+n+"}":""),o=t.attrs||t.dynamicAttrs?Ka((t.attrs||[]).concat(t.dynamicAttrs||[]).map(function(t){return{name:x(t.name),value:t.value,dynamic:t.dynamic}})):null,a=t.attrsMap["v-bind"];return!o&&!a||n||(r+=",null"),o&&(r+=","+o),a&&(r+=(o?"":",null")+","+a),r+")"}(t,e);var i;if(t.component)i=function(t,e,i){var n=e.inlineTemplate?null:qa(e,i,!0);return"_c("+t+","+Ha(e,i)+(n?","+n:"")+")"}(t.component,t,e);else{var n;(!t.plain||t.pre&&e.maybeComponent(t))&&(n=Ha(t,e));var r=t.inlineTemplate?null:qa(t,e,!0);i="_c('"+t.tag+"'"+(n?","+n:"")+(r?","+r:"")+")"}for(var o=0;o<e.transforms.length;o++)i=e.transforms[o](t,i);return i}return qa(t,e)||"void 0"}function Ua(t,e){t.staticProcessed=!0;var i=e.pre;return t.pre&&(e.pre=t.pre),e.staticRenderFns.push("with(this){return "+Va(t,e)+"}"),e.pre=i,"_m("+(e.staticRenderFns.length-1)+(t.staticInFor?",true":"")+")"}function Ga(t,e){if(t.onceProcessed=!0,t.if&&!t.ifProcessed)return $a(t,e);if(t.staticInFor){for(var i="",n=t.parent;n;){if(n.for){i=n.key;break}n=n.parent}return i?"_o("+Va(t,e)+","+e.onceId+++","+i+")":Va(t,e)}return Ua(t,e)}function $a(t,e,i,n){return t.ifProcessed=!0,function t(e,i,n,r){if(!e.length)return r||"_e()";var o=e.shift();return o.exp?"("+o.exp+")?"+a(o.block)+":"+t(e,i,n,r):""+a(o.block);function a(t){return n?n(t,i):t.once?Ga(t,i):Va(t,i)}}(t.ifConditions.slice(),e,i,n)}function Wa(t,e,i,n){var r=t.for,o=t.alias,a=t.iterator1?","+t.iterator1:"",s=t.iterator2?","+t.iterator2:"";return t.forProcessed=!0,(n||"_l")+"(("+r+"),function("+o+a+s+"){return "+(i||Va)(t,e)+"})"}function Ha(t,e){var i="{",n=function(t,e){var i=t.directives;if(i){var n,r,o,a,s="directives:[",l=!1;for(n=0,r=i.length;n<r;n++){o=i[n],a=!0;var u=e.directives[o.name];u&&(a=!!u(t,o,e.warn)),a&&(l=!0,s+='{name:"'+o.name+'",rawName:"'+o.rawName+'"'+(o.value?",value:("+o.value+"),expression:"+JSON.stringify(o.value):"")+(o.arg?",arg:"+(o.isDynamicArg?o.arg:'"'+o.arg+'"'):"")+(o.modifiers?",modifiers:"+JSON.stringify(o.modifiers):"")+"},")}return l?s.slice(0,-1)+"]":void 0}}(t,e);n&&(i+=n+","),t.key&&(i+="key:"+t.key+","),t.ref&&(i+="ref:"+t.ref+","),t.refInFor&&(i+="refInFor:true,"),t.pre&&(i+="pre:true,"),t.component&&(i+='tag:"'+t.tag+'",');for(var r=0;r<e.dataGenFns.length;r++)i+=e.dataGenFns[r](t);if(t.attrs&&(i+="attrs:"+Ka(t.attrs)+","),t.props&&(i+="domProps:"+Ka(t.props)+","),t.events&&(i+=za(t.events,!1)+","),t.nativeEvents&&(i+=za(t.nativeEvents,!0)+","),t.slotTarget&&!t.slotScope&&(i+="slot:"+t.slotTarget+","),t.scopedSlots&&(i+=function(t,e,i){var n=t.for||Object.keys(e).some(function(t){var i=e[t];return i.slotTargetDynamic||i.if||i.for||ja(i)}),r=!!t.if;if(!n)for(var o=t.parent;o;){if(o.slotScope&&o.slotScope!==ua||o.for){n=!0;break}o.if&&(r=!0),o=o.parent}var a=Object.keys(e).map(function(t){return Za(e[t],i)}).join(",");return"scopedSlots:_u(["+a+"]"+(n?",null,true":"")+(!n&&r?",null,false,"+function(t){for(var e=5381,i=t.length;i;)e=33*e^t.charCodeAt(--i);return e>>>0}(a):"")+")"}(t,t.scopedSlots,e)+","),t.model&&(i+="model:{value:"+t.model.value+",callback:"+t.model.callback+",expression:"+t.model.expression+"},"),t.inlineTemplate){var o=function(t,e){var i=t.children[0];if(i&&1===i.type){var n=Fa(i,e.options);return"inlineTemplate:{render:function(){"+n.render+"},staticRenderFns:["+n.staticRenderFns.map(function(t){return"function(){"+t+"}"}).join(",")+"]}"}}(t,e);o&&(i+=o+",")}return i=i.replace(/,$/,"")+"}",t.dynamicAttrs&&(i="_b("+i+',"'+t.tag+'",'+Ka(t.dynamicAttrs)+")"),t.wrapData&&(i=t.wrapData(i)),t.wrapListeners&&(i=t.wrapListeners(i)),i}function ja(t){return 1===t.type&&("slot"===t.tag||t.children.some(ja))}function Za(t,e){var i=t.attrsMap["slot-scope"];if(t.if&&!t.ifProcessed&&!i)return $a(t,e,Za,"null");if(t.for&&!t.forProcessed)return Wa(t,e,Za);var n=t.slotScope===ua?"":t.slotScope+"",r="function("+n+"){return "+("template"===t.tag?t.if&&i?"("+t.if+")?"+(qa(t,e)||"undefined")+":undefined":qa(t,e)||"undefined":Va(t,e))+"}",o=n?"":",proxy:true";return"{key:"+(t.slotTarget||'"default"')+",fn:"+r+o+"}"}function qa(t,e,i,n,r){var o=t.children;if(o.length){var a=o[0];if(1===o.length&&a.for&&"template"!==a.tag&&"slot"!==a.tag){var s=i?e.maybeComponent(a)?",1":",0":"";return""+(n||Va)(a,e)+s}var l=i?function(t,e){for(var i=0,n=0;n<t.length;n++){var r=t[n];if(1===r.type){if(Xa(r)||r.ifConditions&&r.ifConditions.some(function(t){return Xa(t.block)})){i=2;break}(e(r)||r.ifConditions&&r.ifConditions.some(function(t){return e(t.block)}))&&(i=1)}}return i}(o,e.maybeComponent):0,u=r||Ya;return"["+o.map(function(t){return u(t,e)}).join(",")+"]"+(l?","+l:"")}}function Xa(t){return void 0!==t.for||"template"===t.tag||"slot"===t.tag}function Ya(t,e){return 1===t.type?Va(t,e):3===t.type&&t.isComment?"_e("+JSON.stringify((n=t).text)+")":"_v("+(2===(i=t).type?i.expression:Ja(JSON.stringify(i.text)))+")";var i,n}function Ka(t){for(var e="",i="",n=0;n<t.length;n++){var r=t[n],o=Ja(r.value);r.dynamic?i+=r.name+","+o+",":e+='"'+r.name+'":'+o+","}return e="{"+e.slice(0,-1)+"}",i?"_d("+e+",["+i.slice(0,-1)+"])":e}function Ja(t){return t.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}function Qa(t,e){try{return Function(t)}catch(i){return e.push({err:i,code:t}),A}}function ts(t){var e=Object.create(null);return function(i,n,r){(n=I({},n)).warn,delete n.warn;var o=n.delimiters?n.delimiters+""+i:i;if(e[o])return e[o];var a=t(i,n),s={},l=[];return s.render=Qa(a.render,l),s.staticRenderFns=a.staticRenderFns.map(function(t){return Qa(t,l)}),e[o]=s}}RegExp("\\b"+"do,if,for,let,new,try,var,case,else,with,await,break,catch,class,const,super,throw,while,yield,delete,export,import,return,switch,default,extends,finally,continue,debugger,function,arguments".split(",").join("\\b|\\b")+"\\b");var es,is,ns=(es=function(t,e){var i=ha(t.trim(),e);!1!==e.optimize&&Ia(i,e);var n=Fa(i,e);return{ast:i,render:n.render,staticRenderFns:n.staticRenderFns}},function(t){function e(e,i){var n=Object.create(t),r=[],o=[];if(i)for(var a in i.modules&&(n.modules=(t.modules||[]).concat(i.modules)),i.directives&&(n.directives=I(Object.create(t.directives||null),i.directives)),i)"modules"!==a&&"directives"!==a&&(n[a]=i[a]);n.warn=function(t,e,i){(i?o:r).push(t)};var s=es(e.trim(),n);return s.errors=r,s.tips=o,s}return{compile:e,compileToFunctions:ts(e)}})(Ta),rs=(ns.compile,ns.compileToFunctions);function os(t){return(is=is||document.createElement("div")).innerHTML=t?'<a href="\n"/>':'<div a="\n"/>',is.innerHTML.indexOf("&#10;")>0}var as=!!$&&os(!1),ss=!!$&&os(!0),ls=v(function(t){var e=Ji(t);return e&&e.innerHTML}),us=wi.prototype.$mount;return wi.prototype.$mount=function(t,e){if((t=t&&Ji(t))===document.body||t===document.documentElement)return this;var i=this.$options;if(!i.render){var n=i.template;if(n)if("string"==typeof n)"#"===n.charAt(0)&&(n=ls(n));else{if(!n.nodeType)return this;n=n.innerHTML}else t&&(n=function(t){if(t.outerHTML)return t.outerHTML;var e=document.createElement("div");return e.appendChild(t.cloneNode(!0)),e.innerHTML}(t));if(n){var r=rs(n,{outputSourceRange:!1,shouldDecodeNewlines:as,shouldDecodeNewlinesForHref:ss,delimiters:i.delimiters,comments:i.comments},this),o=r.render,a=r.staticRenderFns;i.render=o,i.staticRenderFns=a}}return us.call(this,t,e)},wi.compile=rs,wi}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).window=t.window||{})}(this,function(t){"use strict";function e(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}function i(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function n(t){return"string"==typeof t}function r(t){return"function"==typeof t}function o(t){return"number"==typeof t}function a(t){return void 0===t}function s(t){return"object"==typeof t}function l(t){return!1!==t}function u(){return"undefined"!=typeof window}function c(t){return r(t)||n(t)}function h(t){return(_t=de(t,re))&&hi}function p(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")}function d(t,e){return!e&&console.warn(t)}function f(t,e){return t&&(re[t]=e)&&_t&&(_t[t]=e)||re}function m(){return 0}function g(t){var e,i,n=t[0];if(s(n)||r(n)||(t=[t]),!(e=(n._gsap||{}).harness)){for(i=he.length;i--&&!he[i].targetTest(n););e=he[i]}for(i=t.length;i--;)t[i]&&(t[i]._gsap||(t[i]._gsap=new Oe(t[i],e)))||t.splice(i,1);return t}function y(t){return t._gsap||g(ve(t))[0]._gsap}function v(t,e,i){return(i=t[e])&&r(i)?t[e]():a(i)&&t.getAttribute&&t.getAttribute(e)||i}function _(t,e){return(t=t.split(",")).forEach(e)||t}function x(t){return Math.round(1e5*t)/1e5||0}function b(t,e){for(var i=e.length,n=0;t.indexOf(e[n])<0&&++n<i;);return n<i}function w(t,e,i){var n,r=o(t[1]),a=(r?2:1)+(e<2?0:1),s=t[a];if(r&&(s.duration=t[1]),s.parent=i,e){for(n=s;i&&!("immediateRender"in n);)n=i.vars.defaults||{},i=l(i.vars.inherit)&&i.parent;s.immediateRender=l(n.immediateRender),e<2?s.runBackwards=1:s.startAt=t[a-1]}return s}function S(){var t,e,i=ae.length,n=ae.slice(0);for(se={},t=ae.length=0;t<i;t++)(e=n[t])&&e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0)._lazy=0)}function T(t,e,i,n){ae.length&&S(),t.render(e,i,n),ae.length&&S()}function M(t){var e=parseFloat(t);return(e||0===e)&&(t+"").match(ne).length<2?e:n(t)?t.trim():t}function I(t){return t}function C(t,e){for(var i in e)i in t||(t[i]=e[i]);return t}function A(t,e){for(var i in e)i in t||"duration"===i||"ease"===i||(t[i]=e[i])}function k(t,e){for(var i in e)t[i]=s(e[i])?k(t[i]||(t[i]={}),e[i]):e[i];return t}function D(t,e){var i,n={};for(i in t)i in e||(n[i]=t[i]);return n}function E(t){var e=t.parent||mt,i=t.keyframes?A:C;if(l(t.inherit))for(;e;)i(t,e.vars.defaults),e=e.parent||e._dp;return t}function P(t,e,i,n){void 0===i&&(i="_first"),void 0===n&&(n="_last");var r=e._prev,o=e._next;r?r._next=o:t[i]===e&&(t[i]=o),o?o._prev=r:t[n]===e&&(t[n]=r),e._next=e._prev=e.parent=null}function L(t,e){!t.parent||e&&!t.parent.autoRemoveChildren||t.parent.remove(t),t._act=0}function z(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var i=t;i;)i._dirty=1,i=i.parent;return t}function O(t){return t._repeat?fe(t._tTime,t=t.duration()+t._rDelay)*t:0}function R(t,e){return(t-e._start)*e._ts+(0<=e._ts?0:e._dirty?e.totalDuration():e._tDur)}function B(t){return t._end=x(t._start+(t._tDur/Math.abs(t._ts||t._rts||$t)||0))}function N(t,e){var i=t._dp;return i&&i.smoothChildTiming&&t._ts&&(t._start=x(t._dp._time-(0<t._ts?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),B(t),i._dirty||z(i,t)),t}function F(t,e){var i;if((e._time||e._initted&&!e._dur)&&(i=R(t.rawTime(),e),(!e._dur||ge(0,e.totalDuration(),i)-e._tTime>$t)&&e.render(i,!0)),z(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(i=t;i._dp;)0<=i.rawTime()&&i.totalTime(i._tTime),i=i._dp;t._zTime=-$t}}function V(t,e,i,n){return e.parent&&L(e),e._start=x(i+e._delay),e._end=x(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),function t(e,i,n,r,o){void 0===n&&(n="_first"),void 0===r&&(r="_last");var a,s=e[r];if(o)for(a=i[o];s&&s[o]>a;)s=s._prev;s?(i._next=s._next,s._next=i):(i._next=e[n],e[n]=i),i._next?i._next._prev=i:e[r]=i,i._prev=s,i.parent=i._dp=e}(t,e,"_first","_last",t._sort?"_start":0),t._recent=e,n||F(t,e),t}function U(t,e){return(re.ScrollTrigger||p("scrollTrigger",e))&&re.ScrollTrigger.create(e,t)}function G(t,e,i,n){return Ge(t,e),t._initted?!i&&t._pt&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&bt!==Me.frame?(ae.push(t),t._lazy=[e,n],1):void 0:1}function $(t,e,i,n){var r=t._repeat,o=x(e)||0,a=t._tTime/t._tDur;return a&&!n&&(t._time*=o/t._dur),t._dur=o,t._tDur=r?r<0?1e10:x(o*(r+1)+t._rDelay*r):o,a&&!n?N(t,t._tTime=t._tDur*a):t.parent&&B(t),i||z(t.parent,t),t}function W(t){return t instanceof Ne?z(t):$(t,t._dur)}function H(t,e){var i,r,o=t.labels,a=t._recent||me,s=t.duration()>=Gt?a.endTime(!1):t._dur;return n(e)&&(isNaN(e)||e in o)?"<"===(i=e.charAt(0))||">"===i?("<"===i?a._start:a.endTime(0<=a._repeat))+(parseFloat(e.substr(1))||0):(i=e.indexOf("="))<0?(e in o||(o[e]=s),o[e]):(r=+(e.charAt(i-1)+e.substr(i+1)),1<i?H(t,e.substr(0,i-1))+r:s+r):null==e?s:+e}function j(t,e){return t||0===t?e(t):e}function Z(t){return(t=(t+"").substr((parseFloat(t)+"").length))&&isNaN(t)?t:""}function q(t,e){return t&&s(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&s(t[0]))&&!t.nodeType&&t!==gt}function X(t){return t.sort(function(){return.5-Math.random()})}function Y(t){if(r(t))return t;var e=s(t)?t:{each:t},i=Ee(e.ease),o=e.from||0,a=parseFloat(e.base)||0,l={},u=0<o&&o<1,c=isNaN(o)||u,h=e.axis,p=o,d=o;return n(o)?p=d={center:.5,edges:.5,end:1}[o]||0:!u&&c&&(p=o[0],d=o[1]),function(t,n,r){var s,u,f,m,g,y,v,_,b,w=(r||e).length,S=l[w];if(!S){if(!(b="auto"===e.grid?0:(e.grid||[1,Gt])[1])){for(v=-Gt;v<(v=r[b++].getBoundingClientRect().left)&&b<w;);b--}for(S=l[w]=[],s=c?Math.min(b,w)*p-.5:o%b,u=c?w*d/b-.5:o/b|0,_=Gt,y=v=0;y<w;y++)f=y%b-s,m=u-(y/b|0),S[y]=g=h?Math.abs("y"===h?m:f):Zt(f*f+m*m),v<g&&(v=g),g<_&&(_=g);"random"===o&&X(S),S.max=v-_,S.min=_,S.v=w=(parseFloat(e.amount)||parseFloat(e.each)*(w<b?w-1:h?"y"===h?w/b:b:Math.max(b,w/b))||0)*("edges"===o?-1:1),S.b=w<0?a-w:a,S.u=Z(e.amount||e.each)||0,i=i&&w<0?De(i):i}return w=(S[t]-S.min)/S.max||0,x(S.b+(i?i(w):w)*S.v)+S.u}}function K(t){var e=t<1?Math.pow(10,(t+"").length-2):1;return function(i){return Math.floor(Math.round(parseFloat(i)/t)*t*e)/e+(o(i)?0:Z(i))}}function J(t,e){var i,n,a=Kt(t);return!a&&s(t)&&(i=a=t.radius||Gt,t.values?(t=ve(t.values),(n=!o(t[0]))&&(i*=i)):t=K(t.increment)),j(e,a?r(t)?function(e){return n=t(e),Math.abs(n-e)<=i?n:e}:function(e){for(var r,a,s=parseFloat(n?e.x:e),l=parseFloat(n?e.y:0),u=Gt,c=0,h=t.length;h--;)(r=n?(r=t[h].x-s)*r+(a=t[h].y-l)*a:Math.abs(t[h]-s))<u&&(u=r,c=h);return c=!i||u<=i?t[c]:e,n||c===e||o(e)?c:c+Z(e)}:K(t))}function Q(t,e,i,n){return j(Kt(t)?!e:!0===i?!!(i=0):!n,function(){return Kt(t)?t[~~(Math.random()*t.length)]:(i=i||1e-5)&&(n=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((t+Math.random()*(e-t))/i)*i*n)/n})}function tt(t,e,i){return j(i,function(i){return t[~~e(i)]})}function et(t){for(var e,i,n,r,o=0,a="";~(e=t.indexOf("random(",o));)n=t.indexOf(")",e),r="["===t.charAt(e+7),i=t.substr(e+7,n-e-7).match(r?ne:Jt),a+=t.substr(o,e-o)+Q(r?i:+i[0],r?0:+i[1],+i[2]||1e-5),o=n+1;return a+t.substr(o,t.length-o)}function it(t,e,i){var n,r,o,a=t.labels,s=Gt;for(n in a)(r=a[n]-e)<0==!!i&&r&&s>(r=Math.abs(r))&&(o=n,s=r);return o}function nt(t){return L(t),t.progress()<1&&xe(t,"onInterrupt"),t}function rt(t,e,i){return(6*(t=t<0?t+1:1<t?t-1:t)<1?e+(i-e)*t*6:t<.5?i:3*t<2?e+(i-e)*(2/3-t)*6:e)*be+.5|0}function ot(t,e,i){var n,r,a,s,l,u,c,h,p,d,f=t?o(t)?[t>>16,t>>8&be,t&be]:0:we.black;if(!f){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),we[t])f=we[t];else if("#"===t.charAt(0))4===t.length&&(t="#"+(n=t.charAt(1))+n+(r=t.charAt(2))+r+(a=t.charAt(3))+a),f=[(t=parseInt(t.substr(1),16))>>16,t>>8&be,t&be];else if("hsl"===t.substr(0,3))if(f=d=t.match(Jt),e){if(~t.indexOf("="))return f=t.match(Qt),i&&f.length<4&&(f[3]=1),f}else s=+f[0]%360/360,l=f[1]/100,n=2*(u=f[2]/100)-(r=u<=.5?u*(l+1):u+l-u*l),3<f.length&&(f[3]*=1),f[0]=rt(s+1/3,n,r),f[1]=rt(s,n,r),f[2]=rt(s-1/3,n,r);else f=t.match(Jt)||we.transparent;f=f.map(Number)}return e&&!d&&(n=f[0]/be,r=f[1]/be,a=f[2]/be,u=((c=Math.max(n,r,a))+(h=Math.min(n,r,a)))/2,c===h?s=l=0:(p=c-h,l=.5<u?p/(2-c-h):p/(c+h),s=c===n?(r-a)/p+(r<a?6:0):c===r?(a-n)/p+2:(n-r)/p+4,s*=60),f[0]=~~(s+.5),f[1]=~~(100*l+.5),f[2]=~~(100*u+.5)),i&&f.length<4&&(f[3]=1),f}function at(t){var e=[],i=[],n=-1;return t.split(Se).forEach(function(t){var r=t.match(te)||[];e.push.apply(e,r),i.push(n+=r.length+1)}),e.c=i,e}function st(t,e,i){var n,r,o,a,s="",l=(t+s).match(Se),u=e?"hsla(":"rgba(",c=0;if(!l)return t;if(l=l.map(function(t){return(t=ot(t,e,1))&&u+(e?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"}),i&&(o=at(t),(n=i.c).join(s)!==o.c.join(s)))for(a=(r=t.replace(Se,"1").split(te)).length-1;c<a;c++)s+=r[c]+(~n.indexOf(c)?l.shift()||u+"0,0,0,0)":(o.length?o:l.length?l:i).shift());if(!r)for(a=(r=t.split(Se)).length-1;c<a;c++)s+=r[c]+l[c];return s+r[a]}function lt(t){var e,i=t.join(" ");if(Se.lastIndex=0,Se.test(i))return e=Te.test(i),t[1]=st(t[1],e),t[0]=st(t[0],e,at(t[1])),!0}function ut(t){var e=(t+"").split("("),i=Ce[e[0]];return i&&1<e.length&&i.config?i.config.apply(null,~t.indexOf("{")?[function t(e){for(var i,n,r,o={},a=e.substr(1,e.length-3).split(":"),s=a[0],l=1,u=a.length;l<u;l++)n=a[l],i=l!==u-1?n.lastIndexOf(","):n.length,r=n.substr(0,i),o[s]=isNaN(r)?r.replace(ke,"").trim():+r,s=n.substr(i+1).trim();return o}(e[1])]:function t(e){var i=e.indexOf("(")+1,n=e.indexOf(")"),r=e.indexOf("(",i);return e.substring(i,~r&&r<n?e.indexOf(")",n+1):n)}(t).split(",").map(M)):Ce._CE&&Ae.test(t)?Ce._CE("",t):i}function ct(t,e){for(var i,n=t._first;n;)n instanceof Ne?ct(n,e):!n.vars.yoyoEase||n._yoyo&&n._repeat||n._yoyo===e||(n.timeline?ct(n.timeline,e):(i=n._ease,n._ease=n._yEase,n._yEase=i,n._yoyo=e)),n=n._next}function ht(t,e,i,n){void 0===i&&(i=function t(i){return 1-e(1-i)}),void 0===n&&(n=function t(i){return i<.5?e(2*i)/2:1-e(2*(1-i))/2});var r,o={easeIn:e,easeOut:i,easeInOut:n};return _(t,function(t){for(var e in Ce[t]=re[t]=o,Ce[r=t.toLowerCase()]=i,o)Ce[r+("easeIn"===e?".in":"easeOut"===e?".out":".inOut")]=Ce[t+"."+e]=o[e]}),o}function pt(t){return function(e){return e<.5?(1-t(1-2*e))/2:.5+t(2*(e-.5))/2}}function dt(t,e,i){function n(t){return 1===t?1:r*Math.pow(2,-10*t)*Xt((t-a)*o)+1}var r=1<=e?e:1,o=(i||(t?.3:.45))/(e<1?e:1),a=o/Wt*(Math.asin(1/r)||0),s="out"===t?n:"in"===t?function(t){return 1-n(1-t)}:pt(n);return o=Wt/o,s.config=function(e,i){return dt(t,e,i)},s}function ft(t,e){function i(t){return t?--t*t*((e+1)*t+e)+1:0}void 0===e&&(e=1.70158);var n="out"===t?i:"in"===t?function(t){return 1-i(1-t)}:pt(i);return n.config=function(e){return ft(t,e)},n}var mt,gt,yt,vt,_t,xt,bt,wt,St,Tt,Mt,It,Ct,At,kt,Dt,Et,Pt,Lt,zt,Ot,Rt,Bt,Nt,Ft,Vt={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Ut={duration:.5,overwrite:!1,delay:0},Gt=1e8,$t=1/Gt,Wt=2*Math.PI,Ht=Wt/4,jt=0,Zt=Math.sqrt,qt=Math.cos,Xt=Math.sin,Yt="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},Kt=Array.isArray,Jt=/(?:-?\.?\d|\.)+/gi,Qt=/[-+=.]*\d+[.e\-+]*\d*[e\-\+]*\d*/g,te=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,ee=/[-+=.]*\d+(?:\.|e-|e)*\d*/gi,ie=/[+-]=-?[\.\d]+/,ne=/[#\-+.]*\b[a-z\d-=+%.]+/gi,re={},oe={},ae=[],se={},le={},ue={},ce=30,he=[],pe="",de=function t(e,i){for(var n in i)e[n]=i[n];return e},fe=function t(e,i){return(e/=i)&&~~e===e?~~e-1:~~e},me={_start:0,endTime:m},ge=function t(e,i,n){return n<e?e:i<n?i:n},ye=[].slice,ve=function t(e,i){return!n(e)||i||!yt&&Ie()?Kt(e)?function t(e,i,r){return void 0===r&&(r=[]),e.forEach(function(t){return n(t)&&!i||q(t,1)?r.push.apply(r,ve(t)):r.push(t)})||r}(e,i):q(e)?ye.call(e,0):e?[e]:[]:ye.call(vt.querySelectorAll(e),0)},_e=function t(e,i,n,r,o){var a=i-e,s=r-n;return j(o,function(t){return n+((t-e)/a*s||0)})},xe=function t(e,i,n){var r,o,a=e.vars,s=a[i];if(s)return r=a[i+"Params"],o=a.callbackScope||e,n&&ae.length&&S(),r?s.apply(o,r):s.call(o)},be=255,we={aqua:[0,be,be],lime:[0,be,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,be],navy:[0,0,128],white:[be,be,be],olive:[128,128,0],yellow:[be,be,0],orange:[be,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[be,0,0],pink:[be,192,203],cyan:[0,be,be],transparent:[be,be,be,0]},Se=function(){var t,e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3}){1,2}\\b";for(t in we)e+="|"+t+"\\b";return RegExp(e+")","gi")}(),Te=/hsl[a]?\(/,Me=(Et=500,Pt=33,Lt=(Dt=Date.now)(),zt=Lt,Rt=Ot=1e3/240,Ct={time:0,frame:0,tick:function t(){Pe(!0)},deltaRatio:function t(e){return At/(1e3/(e||60))},wake:function t(){xt&&(!yt&&u()&&(gt=yt=window,vt=gt.document||{},re.gsap=hi,(gt.gsapVersions||(gt.gsapVersions=[])).push(hi.version),h(_t||gt.GreenSockGlobals||!gt.gsap&&gt||{}),It=gt.requestAnimationFrame),Tt&&Ct.sleep(),Mt=It||function(t){return setTimeout(t,Rt-1e3*Ct.time+1|0)},St=1,Pe(2))},sleep:function t(){(It?gt.cancelAnimationFrame:clearTimeout)(Tt),St=0,Mt=m},lagSmoothing:function t(e,i){Pt=Math.min(i,Et=e||1e8,0)},fps:function t(e){Ot=1e3/(e||240),Rt=1e3*Ct.time+Ot},add:function t(e){Bt.indexOf(e)<0&&Bt.push(e),Ie()},remove:function t(e){var i;~(i=Bt.indexOf(e))&&Bt.splice(i,1)&&i<=kt&&kt--},_listeners:Bt=[]}),Ie=function t(){return!St&&Me.wake()},Ce={},Ae=/^[\d.\-M][\d.\-,\s]/,ke=/["']/g,De=function t(e){return function(t){return 1-e(1-t)}},Ee=function t(e,i){return e&&(r(e)?e:Ce[e]||ut(e))||i};function Pe(t){var e,i,n,r,o=Dt()-zt,a=!0===t;if(Et<o&&(Lt+=o-Pt),(0<(e=(n=(zt+=o)-Lt)-Rt)||a)&&(r=++Ct.frame,At=n-1e3*Ct.time,Ct.time=n/=1e3,Rt+=e+(Ot<=e?4:Ot-e),i=1),a||(Tt=Mt(Pe)),i)for(kt=0;kt<Bt.length;kt++)Bt[kt](n,At,r,t)}function Le(t){return t<Ft?Nt*t*t:t<.7272727272727273?Nt*Math.pow(t-1.5/2.75,2)+.75:t<.9090909090909092?Nt*(t-=2.25/2.75)*t+.9375:Nt*Math.pow(t-2.625/2.75,2)+.984375}_("Linear,Quad,Cubic,Quart,Quint,Strong",function(t,e){var i=e<5?e+1:e;ht(t+",Power"+(i-1),e?function(t){return Math.pow(t,i)}:function(t){return t},function(t){return 1-Math.pow(1-t,i)},function(t){return t<.5?Math.pow(2*t,i)/2:1-Math.pow(2*(1-t),i)/2})}),Ce.Linear.easeNone=Ce.none=Ce.Linear.easeIn,ht("Elastic",dt("in"),dt("out"),dt()),Nt=7.5625,Ft=1/2.75,ht("Bounce",function(t){return 1-Le(1-t)},Le),ht("Expo",function(t){return t?Math.pow(2,10*(t-1)):0}),ht("Circ",function(t){return-(Zt(1-t*t)-1)}),ht("Sine",function(t){return 1===t?1:1-qt(t*Ht)}),ht("Back",ft("in"),ft("out"),ft()),Ce.SteppedEase=Ce.steps=re.SteppedEase={config:function t(e,i){void 0===e&&(e=1);var n=1/e,r=e+(i?0:1),o=i?1:0;return function(t){return((r*ge(0,.99999999,t)|0)+o)*n}}},Ut.ease=Ce["quad.out"],_("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(t){return pe+=t+","+t+"Params,"});var ze,Oe=function t(e,i){this.id=jt++,(e._gsap=this).target=e,this.harness=i,this.get=i?i.get:v,this.set=i?i.getSetter:Je},Re=((ze=Be.prototype).delay=function t(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},ze.duration=function t(e){return arguments.length?this.totalDuration(0<this._repeat?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},ze.totalDuration=function t(e){return arguments.length?(this._dirty=0,$(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},ze.totalTime=function t(e,i){if(Ie(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(N(this,e);n.parent;)n.parent._time!==n._start+(0<=n._ts?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(0<this._ts&&e<this._tDur||this._ts<0&&0<e||!this._tDur&&!e)&&V(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!i||this._initted&&Math.abs(this._zTime)===$t||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),T(this,e,i)),this},ze.time=function t(e,i){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+O(this))%this._dur||(e?this._dur:0),i):this._time},ze.totalProgress=function t(e,i){return arguments.length?this.totalTime(this.totalDuration()*e,i):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},ze.progress=function t(e,i){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?e:1-e)+O(this),i):this.duration()?Math.min(1,this._time/this._dur):this.ratio},ze.iteration=function t(e,i){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*n,i):this._repeat?fe(this._tTime,n)+1:1},ze.timeScale=function t(e){if(!arguments.length)return this._rts===-$t?0:this._rts;if(this._rts===e)return this;var i=this.parent&&this._ts?R(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||e===-$t?0:this._rts,function t(e){for(var i=e.parent;i&&i.parent;)i._dirty=1,i.totalDuration(),i=i.parent;return e}(this.totalTime(ge(-this._delay,this._tDur,i),!0))},ze.paused=function t(e){return arguments.length?(this._ps!==e&&((this._ps=e)?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Ie(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&(this._tTime-=$t)&&Math.abs(this._zTime)!==$t))),this):this._ps},ze.startTime=function t(e){if(arguments.length){this._start=e;var i=this.parent||this._dp;return!i||!i._sort&&this.parent||V(i,this,e-this._delay),this}return this._start},ze.endTime=function t(e){return this._start+(l(e)?this.totalDuration():this.duration())/Math.abs(this._ts)},ze.rawTime=function t(e){var i=this.parent||this._dp;return i?e&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?R(i.rawTime(e),this):this._tTime:this._tTime},ze.globalTime=function t(e){for(var i=this,n=arguments.length?e:i.rawTime();i;)n=i._start+n/(i._ts||1),i=i._dp;return n},ze.repeat=function t(e){return arguments.length?(this._repeat=e,W(this)):this._repeat},ze.repeatDelay=function t(e){return arguments.length?(this._rDelay=e,W(this)):this._rDelay},ze.yoyo=function t(e){return arguments.length?(this._yoyo=e,this):this._yoyo},ze.seek=function t(e,i){return this.totalTime(H(this,e),l(i))},ze.restart=function t(e,i){return this.play().totalTime(e?-this._delay:0,l(i))},ze.play=function t(e,i){return null!=e&&this.seek(e,i),this.reversed(!1).paused(!1)},ze.reverse=function t(e,i){return null!=e&&this.seek(e||this.totalDuration(),i),this.reversed(!0).paused(!1)},ze.pause=function t(e,i){return null!=e&&this.seek(e,i),this.paused(!0)},ze.resume=function t(){return this.paused(!1)},ze.reversed=function t(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-$t:0)),this):this._rts<0},ze.invalidate=function t(){return this._initted=0,this._zTime=-$t,this},ze.isActive=function t(){var e,i=this.parent||this._dp,n=this._start;return!(i&&!(this._ts&&this._initted&&i.isActive()&&(e=i.rawTime(!0))>=n&&e<this.endTime(!0)-$t))},ze.eventCallback=function t(e,i,n){var r=this.vars;return 1<arguments.length?(i?(r[e]=i,n&&(r[e+"Params"]=n),"onUpdate"===e&&(this._onUpdate=i)):delete r[e],this):r[e]},ze.then=function t(e){var i=this;return new Promise(function(t){function n(){var e=i.then;i.then=null,r(o)&&(o=o(i))&&(o.then||o===i)&&(i.then=e),t(o),i.then=e}var o=r(e)?e:I;i._initted&&1===i.totalProgress()&&0<=i._ts||!i._tTime&&i._ts<0?n():i._prom=n})},ze.kill=function t(){nt(this)},Be);function Be(t,e){var i=t.parent||mt;this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,$(this,+t.duration,1,1),this.data=t.data,St||Me.wake(),i&&V(i,this,e||0===e?e:i._time,1),t.reversed&&this.reverse(),t.paused&&this.paused(!0)}C(Re.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-$t,_prom:0,_ps:!1,_rts:1});var Ne=function(t){function a(e,n){var r;return void 0===e&&(e={}),(r=t.call(this,e,n)||this).labels={},r.smoothChildTiming=!!e.smoothChildTiming,r.autoRemoveChildren=!!e.autoRemoveChildren,r._sort=l(e.sortChildren),r.parent&&F(r.parent,i(r)),e.scrollTrigger&&U(i(r),e.scrollTrigger),r}e(a,t);var s=a.prototype;return s.to=function t(e,i,n,r){return new je(e,w(arguments,0,this),H(this,o(i)?r:n)),this},s.from=function t(e,i,n,r){return new je(e,w(arguments,1,this),H(this,o(i)?r:n)),this},s.fromTo=function t(e,i,n,r,a){return new je(e,w(arguments,2,this),H(this,o(i)?a:r)),this},s.set=function t(e,i,n){return i.duration=0,i.parent=this,E(i).repeatDelay||(i.repeat=0),i.immediateRender=!!i.immediateRender,new je(e,i,H(this,n),1),this},s.call=function t(e,i,n){return V(this,je.delayedCall(0,e,i),H(this,n))},s.staggerTo=function t(e,i,n,r,o,a,s){return n.duration=i,n.stagger=n.stagger||r,n.onComplete=a,n.onCompleteParams=s,n.parent=this,new je(e,n,H(this,o)),this},s.staggerFrom=function t(e,i,n,r,o,a,s){return n.runBackwards=1,E(n).immediateRender=l(n.immediateRender),this.staggerTo(e,i,n,r,o,a,s)},s.staggerFromTo=function t(e,i,n,r,o,a,s,u){return r.startAt=n,E(r).immediateRender=l(r.immediateRender),this.staggerTo(e,i,r,o,a,s,u)},s.render=function t(e,i,n){var r,o,a,s,l,u,c,h,p,d,f,m,g=this._time,y=this._dirty?this.totalDuration():this._tDur,v=this._dur,_=this!==mt&&y-$t<e&&0<=e?y:e<$t?0:e,b=this._zTime<0!=e<0&&(this._initted||!v);if(_!==this._tTime||n||b){if(g!==this._time&&v&&(_+=this._time-g,e+=this._time-g),r=_,p=this._start,u=!(h=this._ts),b&&(v||(g=this._zTime),!e&&i||(this._zTime=e)),this._repeat&&(f=this._yoyo,r=x(_%(l=v+this._rDelay)),_===y?(s=this._repeat,r=v):((s=~~(_/l))&&s===_/l&&(r=v,s--),v<r&&(r=v)),d=fe(this._tTime,l),!g&&this._tTime&&d!==s&&(d=s),f&&1&s&&(r=v-r,m=1),s!==d&&!this._lock)){var w=f&&1&d,S=w===(f&&1&s);if(s<d&&(w=!w),g=w?0:v,this._lock=1,this.render(g||(m?0:x(s*l)),i,!v)._lock=0,!i&&this.parent&&xe(this,"onRepeat"),this.vars.repeatRefresh&&!m&&(this.invalidate()._lock=1),g!==this._time||u!=!this._ts)return this;if(v=this._dur,y=this._tDur,S&&(this._lock=2,g=w?v:-1e-4,this.render(g,!0),this.vars.repeatRefresh&&!m&&this.invalidate()),this._lock=0,!this._ts&&!u)return this;ct(this,m)}if(this._hasPause&&!this._forcing&&this._lock<2&&(c=function t(e,i,n){var r;if(i<n)for(r=e._first;r&&r._start<=n;){if(!r._dur&&"isPause"===r.data&&r._start>i)return r;r=r._next}else for(r=e._last;r&&r._start>=n;){if(!r._dur&&"isPause"===r.data&&r._start<i)return r;r=r._prev}}(this,x(g),x(r)))&&(_-=r-(r=c._start)),this._tTime=_,this._time=r,this._act=!h,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e),g||!r||i||xe(this,"onStart"),g<=r&&0<=e)for(o=this._first;o;){if(a=o._next,(o._act||r>=o._start)&&o._ts&&c!==o){if(o.parent!==this)return this.render(e,i,n);if(o.render(0<o._ts?(r-o._start)*o._ts:(o._dirty?o.totalDuration():o._tDur)+(r-o._start)*o._ts,i,n),r!==this._time||!this._ts&&!u){c=0,a&&(_+=this._zTime=-$t);break}}o=a}else{o=this._last;for(var T=e<0?e:r;o;){if(a=o._prev,(o._act||T<=o._end)&&o._ts&&c!==o){if(o.parent!==this)return this.render(e,i,n);if(o.render(0<o._ts?(T-o._start)*o._ts:(o._dirty?o.totalDuration():o._tDur)+(T-o._start)*o._ts,i,n),r!==this._time||!this._ts&&!u){c=0,a&&(_+=this._zTime=T?-$t:$t);break}}o=a}}if(c&&!i&&(this.pause(),c.render(g<=r?0:-$t)._zTime=g<=r?1:-1,this._ts))return this._start=p,B(this),this.render(e,i,n);this._onUpdate&&!i&&xe(this,"onUpdate",!0),(_===y&&y>=this.totalDuration()||!_&&g)&&(p!==this._start&&Math.abs(h)===Math.abs(this._ts)||this._lock||(!e&&v||!(_===y&&0<this._ts||!_&&this._ts<0)||L(this,1),i||e<0&&!g||!_&&!g||(xe(this,_===y?"onComplete":"onReverseComplete",!0),!this._prom||_<y&&0<this.timeScale()||this._prom())))}return this},s.add=function t(e,i){var a=this;if(o(i)||(i=H(this,i)),!(e instanceof Re)){if(Kt(e))return e.forEach(function(t){return a.add(t,i)}),this;if(n(e))return this.addLabel(e,i);if(!r(e))return this;e=je.delayedCall(0,e)}return this!==e?V(this,e,i):this},s.getChildren=function t(e,i,n,r){void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===r&&(r=-Gt);for(var o=[],a=this._first;a;)a._start>=r&&(a instanceof je?i&&o.push(a):(n&&o.push(a),e&&o.push.apply(o,a.getChildren(!0,i,n)))),a=a._next;return o},s.getById=function t(e){for(var i=this.getChildren(1,1,1),n=i.length;n--;)if(i[n].vars.id===e)return i[n]},s.remove=function t(e){return n(e)?this.removeLabel(e):r(e)?this.killTweensOf(e):(P(this,e),e===this._recent&&(this._recent=this._last),z(this))},s.totalTime=function e(i,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=x(Me.time-(0<this._ts?i/this._ts:(this.totalDuration()-i)/-this._ts))),t.prototype.totalTime.call(this,i,n),this._forcing=0,this):this._tTime},s.addLabel=function t(e,i){return this.labels[e]=H(this,i),this},s.removeLabel=function t(e){return delete this.labels[e],this},s.addPause=function t(e,i,n){var r=je.delayedCall(0,i||m,n);return r.data="isPause",this._hasPause=1,V(this,r,H(this,e))},s.removePause=function t(e){var i=this._first;for(e=H(this,e);i;)i._start===e&&"isPause"===i.data&&L(i),i=i._next},s.killTweensOf=function t(e,i,n){for(var r=this.getTweensOf(e,n),o=r.length;o--;)Ve!==r[o]&&r[o].kill(e,i);return this},s.getTweensOf=function t(e,i){for(var n,r=[],a=ve(e),s=this._first,l=o(i);s;)s instanceof je?b(s._targets,a)&&(l?(!Ve||s._initted&&s._ts)&&s.globalTime(0)<=i&&s.globalTime(s.totalDuration())>i:!i||s.isActive())&&r.push(s):(n=s.getTweensOf(a,i)).length&&r.push.apply(r,n),s=s._next;return r},s.tweenTo=function t(e,i){i=i||{};var n=this,r=H(n,e),o=i.startAt,a=i.onStart,s=i.onStartParams,l=je.to(n,C(i,{ease:"none",lazy:!1,time:r,overwrite:"auto",duration:i.duration||Math.abs((r-(o&&"time"in o?o.time:n._time))/n.timeScale())||$t,onStart:function t(){n.pause();var e=i.duration||Math.abs((r-n._time)/n.timeScale());l._dur!==e&&$(l,e,0,1).render(l._time,!0,!0),a&&a.apply(l,s||[])}}));return l},s.tweenFromTo=function t(e,i,n){return this.tweenTo(i,C({startAt:{time:H(this,e)}},n))},s.recent=function t(){return this._recent},s.nextLabel=function t(e){return void 0===e&&(e=this._time),it(this,H(this,e))},s.previousLabel=function t(e){return void 0===e&&(e=this._time),it(this,H(this,e),1)},s.currentLabel=function t(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+$t)},s.shiftChildren=function t(e,i,n){void 0===n&&(n=0);for(var r,o=this._first,a=this.labels;o;)o._start>=n&&(o._start+=e,o._end+=e),o=o._next;if(i)for(r in a)a[r]>=n&&(a[r]+=e);return z(this)},s.invalidate=function e(){var i=this._first;for(this._lock=0;i;)i.invalidate(),i=i._next;return t.prototype.invalidate.call(this)},s.clear=function t(e){void 0===e&&(e=!0);for(var i,n=this._first;n;)i=n._next,this.remove(n),n=i;return this._time=this._tTime=this._pTime=0,e&&(this.labels={}),z(this)},s.totalDuration=function t(e){var i,n,r,o=0,a=this,s=a._last,l=Gt;if(arguments.length)return a.timeScale((a._repeat<0?a.duration():a.totalDuration())/(a.reversed()?-e:e));if(a._dirty){for(r=a.parent;s;)i=s._prev,s._dirty&&s.totalDuration(),l<(n=s._start)&&a._sort&&s._ts&&!a._lock?(a._lock=1,V(a,s,n-s._delay,1)._lock=0):l=n,n<0&&s._ts&&(o-=n,(!r&&!a._dp||r&&r.smoothChildTiming)&&(a._start+=n/a._ts,a._time-=n,a._tTime-=n),a.shiftChildren(-n,!1,-1/0),l=0),s._end>o&&s._ts&&(o=s._end),s=i;$(a,a===mt&&a._time>o?a._time:o,1,1),a._dirty=0}return a._tDur},a.updateRoot=function t(e){if(mt._ts&&(T(mt,R(e,mt)),bt=Me.frame),Me.frame>=ce){ce+=Vt.autoSleep||120;var i=mt._first;if((!i||!i._ts)&&Vt.autoSleep&&Me._listeners.length<2){for(;i&&!i._ts;)i=i._next;i||Me.sleep()}}},a}(Re);function Fe(t,e,i,o,a,l){var u,c,h,p;if(le[t]&&!1!==(u=new le[t]).init(a,u.rawVars?e[t]:function t(e,i,o,a,l){if(r(e)&&(e=$e(e,l,i,o,a)),!s(e)||e.style&&e.nodeType||Kt(e)||Yt(e))return n(e)?$e(e,l,i,o,a):e;var u,c={};for(u in e)c[u]=$e(e[u],l,i,o,a);return c}(e[t],o,a,l,i),i,o,l)&&(i._pt=c=new ai(i._pt,a,t,0,1,u.render,u,0,u.priority),i!==wt))for(h=i._ptLookup[i._targets.indexOf(a)],p=u._props.length;p--;)h[u._props[p]]=c;return u}C(Ne.prototype,{_lock:0,_hasPause:0,_forcing:0});var Ve,Ue=function t(e,i,o,a,s,l,u,c,h){r(a)&&(a=a(s||0,e,l));var d,f=e[i],m="get"!==o?o:r(f)?h?e[i.indexOf("set")||!r(e["get"+i.substr(3)])?i:"get"+i.substr(3)](h):e[i]():f,g=r(f)?h?Ke:Ye:Xe;if(n(a)&&(~a.indexOf("random(")&&(a=et(a)),"="===a.charAt(1)&&(a=parseFloat(m)+parseFloat(a.substr(2))*("-"===a.charAt(0)?-1:1)+(Z(m)||0))),m!==a)return isNaN(m*a)?(f||i in e||p(i,a),function t(e,i,n,r,o,a,s){var l,u,c,h,p,d,f,m,g=new ai(this._pt,e,i,0,1,ei,null,o),y=0,v=0;for(g.b=n,g.e=r,n+="",(f=~(r+="").indexOf("random("))&&(r=et(r)),a&&(a(m=[n,r],e,i),n=m[0],r=m[1]),u=n.match(ee)||[];l=ee.exec(r);)h=l[0],p=r.substring(y,l.index),c?c=(c+1)%5:"rgba("===p.substr(-5)&&(c=1),h!==u[v++]&&(d=parseFloat(u[v-1])||0,g._pt={_next:g._pt,p:p||1===v?p:",",s:d,c:"="===h.charAt(1)?parseFloat(h.substr(2))*("-"===h.charAt(0)?-1:1):parseFloat(h)-d,m:c&&c<4?Math.round:0},y=ee.lastIndex);return g.c=y<r.length?r.substring(y,r.length):"",g.fp=s,(ie.test(r)||f)&&(g.e=0),this._pt=g}.call(this,e,i,m,a,g,c||Vt.stringFilter,h)):(d=new ai(this._pt,e,i,+m||0,a-(m||0),"boolean"==typeof f?ti:Qe,0,g),h&&(d.fp=h),u&&d.modifier(u,this,e),this._pt=d)},Ge=function t(e,i){var n,r,o,a,s,u,c,h,p,d,f,m,v,_=e.vars,x=_.ease,b=_.startAt,w=_.immediateRender,T=_.lazy,M=_.onUpdate,I=_.onUpdateParams,A=_.callbackScope,k=_.runBackwards,E=_.yoyoEase,P=_.keyframes,z=_.autoRevert,O=e._dur,R=e._startAt,B=e._targets,N=e.parent,F=N&&"nested"===N.data?N.parent._targets:B,V="auto"===e._overwrite,U=e.timeline;if(!U||P&&x||(x="none"),e._ease=Ee(x,Ut.ease),e._yEase=E?De(Ee(!0===E?x:E,Ut.ease)):0,E&&e._yoyo&&!e._repeat&&(E=e._yEase,e._yEase=e._ease,e._ease=E),!U){if(m=(h=B[0]?y(B[0]).harness:0)&&_[h.prop],n=D(_,oe),R&&R.render(-1,!0).kill(),b){if(L(e._startAt=je.set(B,C({data:"isStart",overwrite:!1,parent:N,immediateRender:!0,lazy:l(T),startAt:null,delay:0,onUpdate:M,onUpdateParams:I,callbackScope:A,stagger:0},b))),w)if(0<i)z||(e._startAt=0);else if(O&&!(i<0&&R))return void(i&&(e._zTime=i))}else if(k&&O)if(R)z||(e._startAt=0);else if(i&&(w=!1),o=C({overwrite:!1,data:"isFromStart",lazy:w&&l(T),immediateRender:w,stagger:0,parent:N},n),m&&(o[h.prop]=m),L(e._startAt=je.set(B,o)),w){if(!i)return}else t(e._startAt,$t);for(e._pt=0,T=O&&l(T)||T&&!O,r=0;r<B.length;r++){if(c=(s=B[r])._gsap||g(B)[r]._gsap,e._ptLookup[r]=d={},se[c.id]&&ae.length&&S(),f=F===B?r:F.indexOf(s),h&&!1!==(p=new h).init(s,m||n,e,f,F)&&(e._pt=a=new ai(e._pt,s,p.name,0,1,p.render,p,0,p.priority),p._props.forEach(function(t){d[t]=a}),p.priority&&(u=1)),!h||m)for(o in n)le[o]&&(p=Fe(o,n,e,f,s,F))?p.priority&&(u=1):d[o]=a=Ue.call(e,s,o,"get",n[o],f,F,0,_.stringFilter);e._op&&e._op[r]&&e.kill(s,e._op[r]),V&&e._pt&&(Ve=e,mt.killTweensOf(s,d,e.globalTime(0)),v=!e.parent,Ve=0),e._pt&&T&&(se[c.id]=1)}u&&oi(e),e._onInit&&e._onInit(e)}e._from=!U&&!!_.runBackwards,e._onUpdate=M,e._initted=(!e._op||e._pt)&&!v},$e=function t(e,i,o,a,s){return r(e)?e.call(i,o,a,s):n(e)&&~e.indexOf("random(")?et(e):e},We=pe+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",He=(We+",id,stagger,delay,duration,paused,scrollTrigger").split(","),je=function(t){function r(e,n,r,a){var u;"number"==typeof n&&(r.duration=n,n=r,r=null);var h,p,f,y,v,_,b,w,S=(u=t.call(this,a?n:E(n),r)||this).vars,T=S.duration,M=S.delay,I=S.immediateRender,A=S.stagger,k=S.overwrite,D=S.keyframes,P=S.defaults,L=S.scrollTrigger,z=S.yoyoEase,O=u.parent,R=(Kt(e)||Yt(e)?o(e[0]):"length"in n)?[e]:ve(e);if(u._targets=R.length?g(R):d("GSAP target "+e+" not found. https://greensock.com",!Vt.nullTargetWarn)||[],u._ptLookup=[],u._overwrite=k,D||A||c(T)||c(M)){if(n=u.vars,(h=u.timeline=new Ne({data:"nested",defaults:P||{}})).kill(),h.parent=i(u),D)C(h.vars.defaults,{ease:"none"}),D.forEach(function(t){return h.to(R,t,">")});else{if(y=R.length,b=A?Y(A):m,s(A))for(v in A)~We.indexOf(v)&&((w=w||{})[v]=A[v]);for(p=0;p<y;p++){for(v in f={},n)He.indexOf(v)<0&&(f[v]=n[v]);f.stagger=0,z&&(f.yoyoEase=z),w&&de(f,w),_=R[p],f.duration=+$e(T,i(u),p,_,R),f.delay=(+$e(M,i(u),p,_,R)||0)-u._delay,!A&&1===y&&f.delay&&(u._delay=M=f.delay,u._start+=M,f.delay=0),h.to(_,f,b(p,_,R))}h.duration()?T=M=0:u.timeline=0}T||u.duration(T=h.duration())}else u.timeline=0;return!0===k&&(Ve=i(u),mt.killTweensOf(R),Ve=0),O&&F(O,i(u)),(I||!T&&!D&&u._start===x(O._time)&&l(I)&&function t(e){return!e||e._ts&&t(e.parent)}(i(u))&&"nested"!==O.data)&&(u._tTime=-$t,u.render(Math.max(0,-M))),L&&U(i(u),L),u}e(r,t);var a=r.prototype;return a.render=function t(e,i,n){var r,o,a,s,l,u,c,h,p,d=this._time,f=this._tDur,m=this._dur,g=f-$t<e&&0<=e?f:e<$t?0:e;if(m){if(g!==this._tTime||!e||n||this._startAt&&this._zTime<0!=e<0){if(r=g,h=this.timeline,this._repeat){if(r=x(g%(s=m+this._rDelay)),g===f?(a=this._repeat,r=m):((a=~~(g/s))&&a===g/s&&(r=m,a--),m<r&&(r=m)),(u=this._yoyo&&1&a)&&(p=this._yEase,r=m-r),l=fe(this._tTime,s),r===d&&!n&&this._initted)return this;a!==l&&(h&&this._yEase&&ct(h,u),!this.vars.repeatRefresh||u||this._lock||(this._lock=n=1,this.render(x(s*a),!0).invalidate()._lock=0))}if(!this._initted){if(G(this,e<0?e:r,n,i))return this._tTime=0,this;if(m!==this._dur)return this.render(e,i,n)}for(this._tTime=g,this._time=r,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=c=(p||this._ease)(r/m),this._from&&(this.ratio=c=1-c),!r||d||i||xe(this,"onStart"),o=this._pt;o;)o.r(c,o.d),o=o._next;h&&h.render(e<0?e:!r&&u?-$t:h._dur*c,i,n)||this._startAt&&(this._zTime=e),this._onUpdate&&!i&&(e<0&&this._startAt&&this._startAt.render(e,!0,n),xe(this,"onUpdate")),this._repeat&&a!==l&&this.vars.onRepeat&&!i&&this.parent&&xe(this,"onRepeat"),g!==this._tDur&&g||this._tTime!==g||(e<0&&this._startAt&&!this._onUpdate&&this._startAt.render(e,!0,!0),!e&&m||!(g===this._tDur&&0<this._ts||!g&&this._ts<0)||L(this,1),i||e<0&&!d||!g&&!d||(xe(this,g===f?"onComplete":"onReverseComplete",!0),!this._prom||g<f&&0<this.timeScale()||this._prom()))}}else!function t(e,i,n,r){var o,a,s=e.ratio,l=i<0||!i&&s&&!e._start&&e._zTime>$t&&!e._dp._lock||(e._ts<0||e._dp._ts<0)&&"isFromStart"!==e.data&&"isStart"!==e.data?0:1,u=e._rDelay,c=0;if(u&&e._repeat&&(c=ge(0,e._tDur,i),fe(c,u)!==(a=fe(e._tTime,u))&&(s=1-l,e.vars.repeatRefresh&&e._initted&&e.invalidate())),l!==s||r||e._zTime===$t||!i&&e._zTime){if(!e._initted&&G(e,i,r,n))return;for(a=e._zTime,e._zTime=i||(n?$t:0),n=n||i&&!a,e.ratio=l,e._from&&(l=1-l),e._time=0,e._tTime=c,n||xe(e,"onStart"),o=e._pt;o;)o.r(l,o.d),o=o._next;e._startAt&&i<0&&e._startAt.render(i,!0,!0),e._onUpdate&&!n&&xe(e,"onUpdate"),c&&e._repeat&&!n&&e.parent&&xe(e,"onRepeat"),(i>=e._tDur||i<0)&&e.ratio===l&&(l&&L(e,1),n||(xe(e,l?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=i)}(this,e,i,n);return this},a.targets=function t(){return this._targets},a.invalidate=function e(){return this._pt=this._op=this._startAt=this._onUpdate=this._act=this._lazy=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),t.prototype.invalidate.call(this)},a.kill=function t(e,i){if(void 0===i&&(i="all"),!(e||i&&"all"!==i)&&(this._lazy=0,this.parent))return nt(this);if(this.timeline){var r=this.timeline.totalDuration();return this.timeline.killTweensOf(e,i,Ve&&!0!==Ve.vars.overwrite)._first||nt(this),this.parent&&r!==this.timeline.totalDuration()&&$(this,this._dur*this.timeline._tDur/r,0,1),this}var o,a,s,l,u,c,h,p=this._targets,d=e?ve(e):p,f=this._ptLookup,m=this._pt;if((!i||"all"===i)&&function t(e,i){for(var n=e.length,r=n===i.length;r&&n--&&e[n]===i[n];);return n<0}(p,d))return"all"===i&&(this._pt=0),nt(this);for(o=this._op=this._op||[],"all"!==i&&(n(i)&&(u={},_(i,function(t){return u[t]=1}),i=u),i=function t(e,i){var n,r,o,a,s=e[0]?y(e[0]).harness:0,l=s&&s.aliases;if(!l)return i;for(r in n=de({},i),l)if(r in n)for(o=(a=l[r].split(",")).length;o--;)n[a[o]]=n[r];return n}(p,i)),h=p.length;h--;)if(~d.indexOf(p[h]))for(u in a=f[h],"all"===i?(o[h]=i,l=a,s={}):(s=o[h]=o[h]||{},l=i),l)(c=a&&a[u])&&("kill"in c.d&&!0!==c.d.kill(u)||P(this,c,"_pt"),delete a[u]),"all"!==s&&(s[u]=1);return this._initted&&!this._pt&&m&&nt(this),this},r.to=function t(e,i,n){return new r(e,i,n)},r.from=function t(e,i){return new r(e,w(arguments,1))},r.delayedCall=function t(e,i,n,o){return new r(i,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:i,onReverseComplete:i,onCompleteParams:n,onReverseCompleteParams:n,callbackScope:o})},r.fromTo=function t(e,i,n){return new r(e,w(arguments,2))},r.set=function t(e,i){return i.duration=0,i.repeatDelay||(i.repeat=0),new r(e,i)},r.killTweensOf=function t(e,i,n){return mt.killTweensOf(e,i,n)},r}(Re);function Ze(t,e,i){return t.setAttribute(e,i)}function qe(t,e,i,n){n.mSet(t,e,n.m.call(n.tween,i,n.mt),n)}C(je.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),_("staggerTo,staggerFrom,staggerFromTo",function(t){je[t]=function(){var e=new Ne,i=ye.call(arguments,0);return i.splice("staggerFromTo"===t?5:4,0,0),e[t].apply(e,i)}});var Xe=function t(e,i,n){return e[i]=n},Ye=function t(e,i,n){return e[i](n)},Ke=function t(e,i,n,r){return e[i](r.fp,n)},Je=function t(e,i){return r(e[i])?Ye:a(e[i])&&e.setAttribute?Ze:Xe},Qe=function t(e,i){return i.set(i.t,i.p,Math.round(1e4*(i.s+i.c*e))/1e4,i)},ti=function t(e,i){return i.set(i.t,i.p,!!(i.s+i.c*e),i)},ei=function t(e,i){var n=i._pt,r="";if(!e&&i.b)r=i.b;else if(1===e&&i.e)r=i.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*e):Math.round(1e4*(n.s+n.c*e))/1e4)+r,n=n._next;r+=i.c}i.set(i.t,i.p,r,i)},ii=function t(e,i){for(var n=i._pt;n;)n.r(e,n.d),n=n._next},ni=function t(e,i,n,r){for(var o,a=this._pt;a;)o=a._next,a.p===r&&a.modifier(e,i,n),a=o},ri=function t(e){for(var i,n,r=this._pt;r;)n=r._next,r.p===e&&!r.op||r.op===e?P(this,r,"_pt"):r.dep||(i=1),r=n;return!i},oi=function t(e){for(var i,n,r,o,a=e._pt;a;){for(i=a._next,n=r;n&&n.pr>a.pr;)n=n._next;(a._prev=n?n._prev:o)?a._prev._next=a:r=a,(a._next=n)?n._prev=a:o=a,a=i}e._pt=r},ai=(si.prototype.modifier=function t(e,i,n){this.mSet=this.mSet||this.set,this.set=qe,this.m=e,this.mt=n,this.tween=i},si);function si(t,e,i,n,r,o,a,s,l){this.t=e,this.s=n,this.c=r,this.p=i,this.r=o||Qe,this.d=a||this,this.set=s||Xe,this.pr=l||0,(this._next=t)&&(t._prev=this)}_(pe+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(t){return oe[t]=1}),re.TweenMax=re.TweenLite=je,re.TimelineLite=re.TimelineMax=Ne,mt=new Ne({sortChildren:!1,defaults:Ut,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),Vt.stringFilter=lt;var li={registerPlugin:function t(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];i.forEach(function(t){return function t(e){var i=(e=!e.name&&e.default||e).name,n=r(e),o=i&&!n&&e.init?function(){this._props=[]}:e,a={init:m,render:ii,add:Ue,kill:ri,modifier:ni,rawVars:0},s={targetTest:0,get:0,getSetter:Je,aliases:{},register:0};if(Ie(),e!==o){if(le[i])return;C(o,C(D(e,a),s)),de(o.prototype,de(a,D(e,s))),le[o.prop=i]=o,e.targetTest&&(he.push(o),oe[i]=1),i=("css"===i?"CSS":i.charAt(0).toUpperCase()+i.substr(1))+"Plugin"}f(i,o),e.register&&e.register(hi,o,ai)}(t)})},timeline:function t(e){return new Ne(e)},getTweensOf:function t(e,i){return mt.getTweensOf(e,i)},getProperty:function t(e,i,r,o){n(e)&&(e=ve(e)[0]);var a=y(e||{}).get,s=r?I:M;return"native"===r&&(r=""),e?i?s((le[i]&&le[i].get||a)(e,i,r,o)):function(t,i,n){return s((le[t]&&le[t].get||a)(e,t,i,n))}:e},quickSetter:function t(e,i,n){if(1<(e=ve(e)).length){var r=e.map(function(t){return hi.quickSetter(t,i,n)}),o=r.length;return function(t){for(var e=o;e--;)r[e](t)}}e=e[0]||{};var a=le[i],s=y(e),l=s.harness&&(s.harness.aliases||{})[i]||i,u=a?function(t){var i=new a;wt._pt=0,i.init(e,n?t+n:t,wt,0,[e]),i.render(1,i),wt._pt&&ii(1,wt)}:s.set(e,l);return a?u:function(t){return u(e,l,n?t+n:t,s,1)}},isTweening:function t(e){return 0<mt.getTweensOf(e,!0).length},defaults:function t(e){return e&&e.ease&&(e.ease=Ee(e.ease,Ut.ease)),k(Ut,e||{})},config:function t(e){return k(Vt,e||{})},registerEffect:function t(e){var i=e.name,n=e.effect,r=e.plugins,o=e.defaults,a=e.extendTimeline;(r||"").split(",").forEach(function(t){return t&&!le[t]&&!re[t]&&d(i+" effect requires "+t+" plugin.")}),ue[i]=function(t,e,i){return n(ve(t),C(e||{},o),i)},a&&(Ne.prototype[i]=function(t,e,n){return this.add(ue[i](t,s(e)?e:(n=e)&&{},this),n)})},registerEase:function t(e,i){Ce[e]=Ee(i)},parseEase:function t(e,i){return arguments.length?Ee(e,i):Ce},getById:function t(e){return mt.getById(e)},exportRoot:function t(e,i){void 0===e&&(e={});var n,r,o=new Ne(e);for(o.smoothChildTiming=l(e.smoothChildTiming),mt.remove(o),o._dp=0,o._time=o._tTime=mt._time,n=mt._first;n;)r=n._next,!i&&!n._dur&&n instanceof je&&n.vars.onComplete===n._targets[0]||V(o,n,n._start-n._delay),n=r;return V(mt,o,0),o},utils:{wrap:function t(e,i,n){var r=i-e;return Kt(e)?tt(e,t(0,e.length),i):j(n,function(t){return(r+(t-e)%r)%r+e})},wrapYoyo:function t(e,i,n){var r=i-e,o=2*r;return Kt(e)?tt(e,t(0,e.length-1),i):j(n,function(t){return e+(r<(t=(o+(t-e)%o)%o||0)?o-t:t)})},distribute:Y,random:Q,snap:J,normalize:function t(e,i,n){return _e(e,i,0,1,n)},getUnit:Z,clamp:function t(e,i,n){return j(n,function(t){return ge(e,i,t)})},splitColor:ot,toArray:ve,mapRange:_e,pipe:function t(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];return function(t){return i.reduce(function(t,e){return e(t)},t)}},unitize:function t(e,i){return function(t){return e(parseFloat(t))+(i||Z(t))}},interpolate:function t(e,i,r,o){var a=isNaN(e+i)?0:function(t){return(1-t)*e+t*i};if(!a){var s,l,u,c,h,p=n(e),d={};if(!0===r&&(o=1)&&(r=null),p)e={p:e},i={p:i};else if(Kt(e)&&!Kt(i)){for(u=[],c=e.length,h=c-2,l=1;l<c;l++)u.push(t(e[l-1],e[l]));c--,a=function t(e){var i=Math.min(h,~~(e*=c));return u[i](e-i)},r=i}else o||(e=de(Kt(e)?[]:{},e));if(!u){for(s in i)Ue.call(d,e,s,"get",i[s]);a=function t(i){return ii(i,d)||(p?e.p:e)}}}return j(r,a)},shuffle:X},install:h,effects:ue,ticker:Me,updateRoot:Ne.updateRoot,plugins:le,globalTimeline:mt,core:{PropTween:ai,globals:f,Tween:je,Timeline:Ne,Animation:Re,getCache:y,_removeLinkedListItem:P}};function ui(t,e){for(var i=t._pt;i&&i.p!==e&&i.op!==e&&i.fp!==e;)i=i._next;return i}function ci(t,e){return{name:t,rawVars:1,init:function t(i,r,o){o._onInit=function(t){var i,o;if(n(r)&&(i={},_(r,function(t){return i[t]=1}),r=i),e){for(o in i={},r)i[o]=e(r[o]);r=i}!function t(e,i){var n,r,o,a=e._targets;for(n in i)for(r=a.length;r--;)(o=(o=e._ptLookup[r][n])&&o.d)&&(o._pt&&(o=ui(o,n)),o&&o.modifier&&o.modifier(i[n],e,a[r],n))}(t,r)}}}}_("to,from,fromTo,delayedCall,set,killTweensOf",function(t){return li[t]=je[t]}),Me.add(Ne.updateRoot),wt=li.to({},{duration:0});var hi=li.registerPlugin({name:"attr",init:function t(e,i,n,r,o){var a,s;for(a in i)(s=this.add(e,"setAttribute",(e.getAttribute(a)||0)+"",i[a],r,o,0,0,a))&&(s.op=a),this._props.push(a)}},{name:"endArray",init:function t(e,i){for(var n=i.length;n--;)this.add(e,n,e[n]||0,i[n])}},ci("roundProps",K),ci("modifiers"),ci("snap",J))||li;function pi(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)}function di(t,e){return e.set(e.t,e.p,1===t?e.e:Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)}function fi(t,e){return e.set(e.t,e.p,t?Math.round(1e4*(e.s+e.c*t))/1e4+e.u:e.b,e)}function mi(t,e){var i=e.s+e.c*t;e.set(e.t,e.p,~~(i+(i<0?-.5:.5))+e.u,e)}function gi(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)}function yi(t,e){return e.set(e.t,e.p,1!==t?e.b:e.e,e)}function vi(t,e,i){return t.style[e]=i}function _i(t,e,i){return t.style.setProperty(e,i)}function xi(t,e,i){return t._gsap[e]=i}function bi(t,e,i){return t._gsap.scaleX=t._gsap.scaleY=i}function wi(t,e,i,n,r){var o=t._gsap;o.scaleX=o.scaleY=i,o.renderTransform(r,o)}function Si(t,e,i,n,r){var o=t._gsap;o[e]=i,o.renderTransform(r,o)}function Ti(t,e){var i=ji.createElementNS?ji.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):ji.createElement(t);return i.style?i:ji.createElement(t)}function Mi(t,e,i){var n=getComputedStyle(t);return n[e]||n.getPropertyValue(e.replace(wn,"-$1").toLowerCase())||n.getPropertyValue(e)||!i&&Mi(t,kn(e)||e,1)||""}function Ii(){(function t(){return"undefined"!=typeof window})()&&window.document&&(Hi=window,ji=Hi.document,Zi=ji.documentElement,Xi=Ti("div")||{style:{}},Yi=Ti("div"),In=kn(In),Cn=In+"Origin",Xi.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Ji=!!kn("perspective"),qi=1)}function Ci(t){var e,i=Ti("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=this.parentNode,r=this.nextSibling,o=this.style.cssText;if(Zi.appendChild(i),i.appendChild(this),this.style.display="block",t)try{e=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=Ci}catch(t){}else this._gsapBBox&&(e=this._gsapBBox());return n&&(r?n.insertBefore(this,r):n.appendChild(this)),Zi.removeChild(i),this.style.cssText=o,e}function Ai(t,e){for(var i=e.length;i--;)if(t.hasAttribute(e[i]))return t.getAttribute(e[i])}function ki(t){var e;try{e=t.getBBox()}catch(i){e=Ci.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===Ci||(e=Ci.call(t,!0)),!e||e.width||e.x||e.y?e:{x:+Ai(t,["x","cx","x1"])||0,y:+Ai(t,["y","cy","y1"])||0,width:0,height:0}}function Di(t){return!(!t.getCTM||t.parentNode&&!t.ownerSVGElement||!ki(t))}function Ei(t,e){if(e){var i=t.style;e in vn&&e!==Cn&&(e=In),i.removeProperty?("ms"!==e.substr(0,2)&&"webkit"!==e.substr(0,6)||(e="-"+e),i.removeProperty(e.replace(wn,"-$1").toLowerCase())):i.removeAttribute(e)}}function Pi(t,e,i,n,r,o){var a=new ai(t._pt,e,i,0,1,o?yi:gi);return(t._pt=a).b=n,a.e=r,t._props.push(i),a}function Li(t,e,i,n){var r,o,a,s,l=parseFloat(i)||0,u=(i+"").trim().substr((l+"").length)||"px",c=Xi.style,h=Sn.test(e),p="svg"===t.tagName.toLowerCase(),d=(p?"client":"offset")+(h?"Width":"Height"),f="px"===n,m="%"===n;return n===u||!l||Dn[n]||Dn[u]?l:("px"===u||f||(l=Li(t,e,i,"px")),s=t.getCTM&&Di(t),m&&(vn[e]||~e.indexOf("adius"))?x(l/(s?t.getBBox()[h?"width":"height"]:t[d])*100):(c[h?"width":"height"]=100+(f?u:n),o=~e.indexOf("adius")||"em"===n&&t.appendChild&&!p?t:t.parentNode,s&&(o=(t.ownerSVGElement||{}).parentNode),o&&o!==ji&&o.appendChild||(o=ji.body),(a=o._gsap)&&m&&a.width&&h&&a.time===Me.time?x(l/a.width*100):(!m&&"%"!==u||(c.position=Mi(t,"position")),o===t&&(c.position="static"),o.appendChild(Xi),r=Xi[d],o.removeChild(Xi),c.position="absolute",h&&m&&((a=y(o)).time=Me.time,a.width=o[d]),x(f?r*l/100:r&&l?100/r*l:0))))}function zi(t,e,i,n){var r;return qi||Ii(),e in Mn&&"transform"!==e&&~(e=Mn[e]).indexOf(",")&&(e=e.split(",")[0]),vn[e]&&"transform"!==e?(r=On(t,n),r="transformOrigin"!==e?r[e]:Rn(Mi(t,Cn))+" "+r.zOrigin+"px"):(r=t.style[e])&&"auto"!==r&&!n&&!~(r+"").indexOf("calc(")||(r=Pn[e]&&Pn[e](t,e,i)||Mi(t,e)||v(t,e)||("opacity"===e?1:0)),i&&!~(r+"").indexOf(" ")?Li(t,e,r,i)+i:r}function Oi(t,e,i,n){if(!i||"none"===i){var r=kn(e,t,1),o=r&&Mi(t,r,1);o&&o!==i?(e=r,i=o):"borderColor"===e&&(i=Mi(t,"borderTopColor"))}var a,s,l,u,c,h,p,d,f,m,g,y,v=new ai(this._pt,t.style,e,0,1,ei),_=0,x=0;if(v.b=i,v.e=n,i+="","auto"==(n+="")&&(t.style[e]=n,n=Mi(t,e)||n,t.style[e]=i),lt(a=[i,n]),n=a[1],l=(i=a[0]).match(te)||[],(n.match(te)||[]).length){for(;s=te.exec(n);)p=s[0],f=n.substring(_,s.index),c?c=(c+1)%5:"rgba("!==f.substr(-5)&&"hsla("!==f.substr(-5)||(c=1),p!==(h=l[x++]||"")&&(u=parseFloat(h)||0,g=h.substr((u+"").length),(y="="===p.charAt(1)?+(p.charAt(0)+"1"):0)&&(p=p.substr(2)),d=parseFloat(p),m=p.substr((d+"").length),_=te.lastIndex-m.length,m||(m=m||Vt.units[e]||g,_===n.length&&(n+=m,v.e+=m)),g!==m&&(u=Li(t,e,h,m)||0),v._pt={_next:v._pt,p:f||1===x?f:",",s:u,c:y?y*d:d-u,m:c&&c<4?Math.round:0});v.c=_<n.length?n.substring(_,n.length):""}else v.r="display"===e&&"none"===n?yi:gi;return ie.test(n)&&(v.e=0),this._pt=v}function Ri(t){var e=t.split(" "),i=e[0],n=e[1]||"50%";return"top"!==i&&"bottom"!==i&&"left"!==n&&"right"!==n||(t=i,i=n,n=t),e[0]=En[i]||i,e[1]=En[n]||n,e.join(" ")}function Bi(t,e){if(e.tween&&e.tween._time===e.tween._dur){var i,n,r,o=e.t,a=o.style,s=e.u,l=o._gsap;if("all"===s||!0===s)a.cssText="",n=1;else for(r=(s=s.split(",")).length;-1<--r;)i=s[r],vn[i]&&(n=1,i="transformOrigin"===i?Cn:In),Ei(o,i);n&&(Ei(o,In),l&&(l.svg&&o.removeAttribute("transform"),On(o,1),l.uncache=1))}}function Ni(t){return"matrix(1, 0, 0, 1, 0, 0)"===t||"none"===t||!t}function Fi(t){var e=Mi(t,In);return Ni(e)?Ln:e.substr(7).match(Qt).map(x)}function Vi(t,e){var i,n,r,o,a=t._gsap||y(t),s=t.style,l=Fi(t);return a.svg&&t.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(r=t.transform.baseVal.consolidate().matrix).a,r.b,r.c,r.d,r.e,r.f]).join(",")?Ln:l:(l!==Ln||t.offsetParent||t===Zi||a.svg||(r=s.display,s.display="block",(i=t.parentNode)&&t.offsetParent||(o=1,n=t.nextSibling,Zi.appendChild(t)),l=Fi(t),r?s.display=r:Ei(t,"display"),o&&(n?i.insertBefore(t,n):i?i.appendChild(t):Zi.removeChild(t))),e&&6<l.length?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)}function Ui(t,e,i,n,r,o){var a,s,l,u=t._gsap,c=r||Vi(t,!0),h=u.xOrigin||0,p=u.yOrigin||0,d=u.xOffset||0,f=u.yOffset||0,m=c[0],g=c[1],y=c[2],v=c[3],_=c[4],x=c[5],b=e.split(" "),w=parseFloat(b[0])||0,S=parseFloat(b[1])||0;i?c!==Ln&&(s=m*v-g*y)&&(l=w*(-g/s)+S*(m/s)-(m*x-g*_)/s,w=w*(v/s)+S*(-y/s)+(y*x-v*_)/s,S=l):(w=(a=ki(t)).x+(~b[0].indexOf("%")?w/100*a.width:w),S=a.y+(~(b[1]||b[0]).indexOf("%")?S/100*a.height:S)),n||!1!==n&&u.smooth?(_=w-h,x=S-p,u.xOffset=d+(_*m+x*y)-_,u.yOffset=f+(_*g+x*v)-x):u.xOffset=u.yOffset=0,u.xOrigin=w,u.yOrigin=S,u.smooth=!!n,u.origin=e,u.originIsAbsolute=!!i,t.style[Cn]="0px 0px",o&&(Pi(o,u,"xOrigin",h,w),Pi(o,u,"yOrigin",p,S),Pi(o,u,"xOffset",d,u.xOffset),Pi(o,u,"yOffset",f,u.yOffset)),t.setAttribute("data-svg-origin",w+" "+S)}function Gi(t,e,i){var n=Z(e);return x(parseFloat(e)+parseFloat(Li(t,"x",i+"px",n)))+n}function $i(t,e,i,r,o,a){var s,l,u=360,c=n(o),h=parseFloat(o)*(c&&~o.indexOf("rad")?_n:1),p=a?h*a:h-r,d=r+p+"deg";return c&&("short"===(s=o.split("_")[1])&&(p%=u)!=p%180&&(p+=p<0?u:-u),"cw"===s&&p<0?p=(p+36e9)%u-~~(p/u)*u:"ccw"===s&&0<p&&(p=(p-36e9)%u-~~(p/u)*u)),t._pt=l=new ai(t._pt,e,i,r,p,di),l.e=d,l.u="deg",t._props.push(i),l}function Wi(t,e,i){var n,r,o,a,s,l,u,c=Yi.style,h=i._gsap;for(r in c.cssText=getComputedStyle(i).cssText+";position:absolute;display:block;",c[In]=e,ji.body.appendChild(Yi),n=On(Yi,1),vn)(o=h[r])!==(a=n[r])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(r)<0&&(s=Z(o)!==(u=Z(a))?Li(i,r,o,u):parseFloat(o),l=parseFloat(a),t._pt=new ai(t._pt,h,r,s,l-s,pi),t._pt.u=u||0,t._props.push(r));ji.body.removeChild(Yi)}je.version=Ne.version=hi.version="3.5.1",xt=1,u()&&Ie();var Hi,ji,Zi,qi,Xi,Yi,Ki,Ji,Qi=Ce.Power0,tn=Ce.Power1,en=Ce.Power2,nn=Ce.Power3,rn=Ce.Power4,on=Ce.Linear,an=Ce.Quad,sn=Ce.Cubic,ln=Ce.Quart,un=Ce.Quint,cn=Ce.Strong,hn=Ce.Elastic,pn=Ce.Back,dn=Ce.SteppedEase,fn=Ce.Bounce,mn=Ce.Sine,gn=Ce.Expo,yn=Ce.Circ,vn={},_n=180/Math.PI,xn=Math.PI/180,bn=Math.atan2,wn=/([A-Z])/g,Sn=/(?:left|right|width|margin|padding|x)/i,Tn=/[\s,\(]\S/,Mn={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},In="transform",Cn=In+"Origin",An="O,Moz,ms,Ms,Webkit".split(","),kn=function t(e,i,n){var r=(i||Xi).style,o=5;if(e in r&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(An[o]+e in r););return o<0?null:(3===o?"ms":0<=o?An[o]:"")+e},Dn={deg:1,rad:1,turn:1},En={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Pn={clearProps:function t(e,i,n,r,o){if("isFromStart"!==o.data){var a=e._pt=new ai(e._pt,i,n,0,0,Bi);return a.u=r,a.pr=-10,a.tween=o,e._props.push(n),1}}},Ln=[1,0,0,1,0,0],zn={},On=function t(e,i){var n=e._gsap||new Oe(e);if("x"in n&&!i&&!n.uncache)return n;var r,o,a,s,l,u,c,h,p,d,f,m,g,y,v,_,b,w,S,T,M,I,C,A,k,D,E,P,L,z,O,R,B=e.style,N=n.scaleX<0,F="deg",V=Mi(e,Cn)||"0";return r=o=a=u=c=h=p=d=f=0,s=l=1,n.svg=!(!e.getCTM||!Di(e)),y=Vi(e,n.svg),n.svg&&(A=!n.uncache&&e.getAttribute("data-svg-origin"),Ui(e,A||V,!!A||n.originIsAbsolute,!1!==n.smooth,y)),m=n.xOrigin||0,g=n.yOrigin||0,y!==Ln&&(w=y[0],S=y[1],T=y[2],M=y[3],r=I=y[4],o=C=y[5],6===y.length?(s=Math.sqrt(w*w+S*S),l=Math.sqrt(M*M+T*T),u=w||S?bn(S,w)*_n:0,(p=T||M?bn(T,M)*_n+u:0)&&(l*=Math.cos(p*xn)),n.svg&&(r-=m-(m*w+g*T),o-=g-(m*S+g*M))):(R=y[6],z=y[7],E=y[8],P=y[9],L=y[10],O=y[11],r=y[12],o=y[13],a=y[14],c=(v=bn(R,L))*_n,v&&(A=I*(_=Math.cos(-v))+E*(b=Math.sin(-v)),k=C*_+P*b,D=R*_+L*b,E=I*-b+E*_,P=C*-b+P*_,L=R*-b+L*_,O=z*-b+O*_,I=A,C=k,R=D),h=(v=bn(-T,L))*_n,v&&(_=Math.cos(-v),O=M*(b=Math.sin(-v))+O*_,w=A=w*_-E*b,S=k=S*_-P*b,T=D=T*_-L*b),u=(v=bn(S,w))*_n,v&&(A=w*(_=Math.cos(v))+S*(b=Math.sin(v)),k=I*_+C*b,S=S*_-w*b,C=C*_-I*b,w=A,I=k),c&&359.9<Math.abs(c)+Math.abs(u)&&(c=u=0,h=180-h),s=x(Math.sqrt(w*w+S*S+T*T)),l=x(Math.sqrt(C*C+R*R)),v=bn(I,C),p=2e-4<Math.abs(v)?v*_n:0,f=O?1/(O<0?-O:O):0),n.svg&&(A=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!Ni(Mi(e,In)),A&&e.setAttribute("transform",A))),90<Math.abs(p)&&Math.abs(p)<270&&(N?(s*=-1,p+=u<=0?180:-180,u+=u<=0?180:-180):(l*=-1,p+=p<=0?180:-180)),n.x=((n.xPercent=r&&Math.round(e.offsetWidth/2)===Math.round(-r)?-50:0)?0:r)+"px",n.y=((n.yPercent=o&&Math.round(e.offsetHeight/2)===Math.round(-o)?-50:0)?0:o)+"px",n.z=a+"px",n.scaleX=x(s),n.scaleY=x(l),n.rotation=x(u)+F,n.rotationX=x(c)+F,n.rotationY=x(h)+F,n.skewX=p+F,n.skewY=d+F,n.transformPerspective=f+"px",(n.zOrigin=parseFloat(V.split(" ")[2])||0)&&(B[Cn]=Rn(V)),n.xOffset=n.yOffset=0,n.force3D=Vt.force3D,n.renderTransform=n.svg?Gn:Ji?Un:Bn,n.uncache=0,n},Rn=function t(e){return(e=e.split(" "))[0]+" "+e[1]},Bn=function t(e,i){i.z="0px",i.rotationY=i.rotationX="0deg",i.force3D=0,Un(e,i)},Nn="0deg",Fn="0px",Vn=") ",Un=function t(e,i){var n=i||this,r=n.xPercent,o=n.yPercent,a=n.x,s=n.y,l=n.z,u=n.rotation,c=n.rotationY,h=n.rotationX,p=n.skewX,d=n.skewY,f=n.scaleX,m=n.scaleY,g=n.transformPerspective,y=n.force3D,v=n.target,_=n.zOrigin,x="",b="auto"===y&&e&&1!==e||!0===y;if(_&&(h!==Nn||c!==Nn)){var w,S=parseFloat(c)*xn,T=Math.sin(S),M=Math.cos(S);a=Gi(v,a,T*(w=Math.cos(S=parseFloat(h)*xn))*-_),s=Gi(v,s,-Math.sin(S)*-_),l=Gi(v,l,M*w*-_+_)}g!==Fn&&(x+="perspective("+g+Vn),(r||o)&&(x+="translate("+r+"%, "+o+"%) "),!b&&a===Fn&&s===Fn&&l===Fn||(x+=l!==Fn||b?"translate3d("+a+", "+s+", "+l+") ":"translate("+a+", "+s+Vn),u!==Nn&&(x+="rotate("+u+Vn),c!==Nn&&(x+="rotateY("+c+Vn),h!==Nn&&(x+="rotateX("+h+Vn),p===Nn&&d===Nn||(x+="skew("+p+", "+d+Vn),1===f&&1===m||(x+="scale("+f+", "+m+Vn),v.style[In]=x||"translate(0, 0)"},Gn=function t(e,i){var n,r,o,a,s,l=i||this,u=l.xPercent,c=l.yPercent,h=l.x,p=l.y,d=l.rotation,f=l.skewX,m=l.skewY,g=l.scaleX,y=l.scaleY,v=l.target,_=l.xOrigin,b=l.yOrigin,w=l.xOffset,S=l.yOffset,T=l.forceCSS,M=parseFloat(h),I=parseFloat(p);d=parseFloat(d),f=parseFloat(f),(m=parseFloat(m))&&(f+=m=parseFloat(m),d+=m),d||f?(f*=xn,n=Math.cos(d*=xn)*g,r=Math.sin(d)*g,o=Math.sin(d-f)*-y,a=Math.cos(d-f)*y,f&&(o*=s=Math.sqrt(1+(s=Math.tan(f-(m*=xn)))*s),a*=s,m&&(n*=s=Math.sqrt(1+(s=Math.tan(m))*s),r*=s)),n=x(n),r=x(r),o=x(o),a=x(a)):(n=g,a=y,r=o=0),(M&&!~(h+"").indexOf("px")||I&&!~(p+"").indexOf("px"))&&(M=Li(v,"x",h,"px"),I=Li(v,"y",p,"px")),(_||b||w||S)&&(M=x(M+_-(_*n+b*o)+w),I=x(I+b-(_*r+b*a)+S)),(u||c)&&(M=x(M+u/100*(s=v.getBBox()).width),I=x(I+c/100*s.height)),s="matrix("+n+","+r+","+o+","+a+","+M+","+I+")",v.setAttribute("transform",s),T&&(v.style[In]=s)};_("padding,margin,Width,Radius",function(t,e){var i="Right",n="Bottom",r="Left",o=(e<3?["Top",i,n,r]:["Top"+r,"Top"+i,n+i,n+r]).map(function(i){return e<2?t+i:"border"+i+t});Pn[1<e?"border"+t:t]=function(t,e,i,n,r){var a,s;if(arguments.length<4)return a=o.map(function(e){return zi(t,e,i)}),5===(s=a.join(" ")).split(a[0]).length?a[0]:s;a=(n+"").split(" "),s={},o.forEach(function(t,e){return s[t]=a[e]=a[e]||a[(e-1)/2|0]}),t.init(e,s,r)}});var $n,Wn,Hn,jn={name:"css",register:Ii,targetTest:function t(e){return e.style&&e.nodeType},init:function t(e,i,n,r,o){var a,s,l,u,c,h,d,f,m,g,y,v,_,x,b,w=this._props,S=e.style;for(d in qi||Ii(),i)if("autoRound"!==d&&(s=i[d],!le[d]||!Fe(d,i,n,r,e,o)))if(c=typeof s,h=Pn[d],"function"===c&&(c=typeof(s=s.call(n,r,e,o))),"string"===c&&~s.indexOf("random(")&&(s=et(s)),h)h(this,e,d,s,n)&&(b=1);else if("--"===d.substr(0,2))this.add(S,"setProperty",getComputedStyle(e).getPropertyValue(d)+"",s+"",r,o,0,0,d);else if("undefined"!==c){if(a=zi(e,d),u=parseFloat(a),(g="string"===c&&"="===s.charAt(1)?+(s.charAt(0)+"1"):0)&&(s=s.substr(2)),l=parseFloat(s),d in Mn&&("autoAlpha"===d&&(1===u&&"hidden"===zi(e,"visibility")&&l&&(u=0),Pi(this,S,"visibility",u?"inherit":"hidden",l?"inherit":"hidden",!l)),"scale"!==d&&"transform"!==d&&~(d=Mn[d]).indexOf(",")&&(d=d.split(",")[0])),y=d in vn)if(v||((_=e._gsap).renderTransform||On(e),x=!1!==i.smoothOrigin&&_.smooth,(v=this._pt=new ai(this._pt,S,In,0,1,_.renderTransform,_,0,-1)).dep=1),"scale"===d)this._pt=new ai(this._pt,_,"scaleY",_.scaleY,g?g*l:l-_.scaleY),w.push("scaleY",d),d+="X";else{if("transformOrigin"===d){s=Ri(s),_.svg?Ui(e,s,0,x,0,this):((m=parseFloat(s.split(" ")[2])||0)!==_.zOrigin&&Pi(this,_,"zOrigin",_.zOrigin,m),Pi(this,S,d,Rn(a),Rn(s)));continue}if("svgOrigin"===d){Ui(e,s,1,x,0,this);continue}if(d in zn){$i(this,_,d,u,s,g);continue}if("smoothOrigin"===d){Pi(this,_,"smooth",_.smooth,s);continue}if("force3D"===d){_[d]=s;continue}if("transform"===d){Wi(this,s,e);continue}}else d in S||(d=kn(d)||d);if(y||(l||0===l)&&(u||0===u)&&!Tn.test(s)&&d in S)l=l||0,(f=(a+"").substr((u+"").length))!==(m=Z(s)||(d in Vt.units?Vt.units[d]:f))&&(u=Li(e,d,a,m)),this._pt=new ai(this._pt,y?_:S,d,u,g?g*l:l-u,"px"!==m||!1===i.autoRound||y?pi:mi),this._pt.u=m||0,f!==m&&(this._pt.b=a,this._pt.r=fi);else if(d in S)Oi.call(this,e,d,a,s);else{if(!(d in e)){p(d,s);continue}this.add(e,d,e[d],s,r,o)}w.push(d)}b&&oi(this)},get:zi,aliases:Mn,getSetter:function t(e,i,n){var r=Mn[i];return r&&r.indexOf(",")<0&&(i=r),i in vn&&i!==Cn&&(e._gsap.x||zi(e,"x"))?n&&Ki===n?"scale"===i?bi:xi:(Ki=n||{})&&("scale"===i?wi:Si):e.style&&!a(e.style[i])?vi:~i.indexOf("-")?_i:Je(e,i)},core:{_removeProperty:Ei,_getMatrix:Vi}};hi.utils.checkPrefix=kn,Hn=_(($n="x,y,z,scale,scaleX,scaleY,xPercent,yPercent")+","+(Wn="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(t){vn[t]=1}),_(Wn,function(t){Vt.units[t]="deg",zn[t]=1}),Mn[Hn[13]]=$n+","+Wn,_("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",function(t){var e=t.split(":");Mn[e[1]]=Hn[e[0]]}),_("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(t){Vt.units[t]="px"}),hi.registerPlugin(jn);var Zn=hi.registerPlugin(jn)||hi,qn=Zn.core.Tween;t.Back=pn,t.Bounce=fn,t.CSSPlugin=jn,t.Circ=yn,t.Cubic=sn,t.Elastic=hn,t.Expo=gn,t.Linear=on,t.Power0=Qi,t.Power1=tn,t.Power2=en,t.Power3=nn,t.Power4=rn,t.Quad=an,t.Quart=ln,t.Quint=un,t.Sine=mn,t.SteppedEase=dn,t.Strong=cn,t.TimelineLite=Ne,t.TimelineMax=Ne,t.TweenLite=je,t.TweenMax=qn,t.default=Zn,t.gsap=Zn,"undefined"==typeof window||window!==t?Object.defineProperty(t,"__esModule",{value:!0}):delete t.default}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).window=t.window||{})}(this,function(t){"use strict";function e(){return"undefined"!=typeof window}function i(){return u||e()&&(u=window.gsap)&&u.registerPlugin&&u}function n(t){return"string"==typeof t}function r(t,e){var i="x"===e?"Width":"Height",n="scroll"+i,r="client"+i;return t===h||t===p||t===d?Math.max(p[n],d[n])-(h["inner"+i]||p[r]||d[r]):t[n]-t["offset"+i]}function o(t,e){var i="scroll"+("x"===e?"Left":"Top");return t===h&&(null!=t.pageXOffset?i="page"+e.toUpperCase()+"Offset":t=null!=p[i]?p:d),function(){return t[i]}}function a(t,e){var i=f(t)[0].getBoundingClientRect(),n=!e||e===h||e===d,r=n?{top:p.clientTop-(h.pageYOffset||p.scrollTop||d.scrollTop||0),left:p.clientLeft-(h.pageXOffset||p.scrollLeft||d.scrollLeft||0)}:e.getBoundingClientRect(),a={x:i.left-r.left,y:i.top-r.top};return!n&&e&&(a.x+=o(e,"x")(),a.y+=o(e,"y")()),a}function s(t,e,i,o,s){return isNaN(t)||"object"==typeof t?n(t)&&"="===t.charAt(1)?parseFloat(t.substr(2))*("-"===t.charAt(0)?-1:1)+o-s:"max"===t?r(e,i)-s:Math.min(r(e,i),a(t,e)[i]-s):parseFloat(t)-s}function l(){u=i(),e()&&u&&document.body&&(h=window,d=document.body,p=document.documentElement,f=u.utils.toArray,u.config({autoKillThreshold:7}),m=u.config(),c=1)}var u,c,h,p,d,f,m,g={version:"3.5.1",name:"scrollTo",rawVars:1,register:function t(e){u=e,l()},init:function t(e,i,r,a,u){c||l();var p=this;p.isWin=e===h,p.target=e,p.tween=r,"object"!=typeof i?n((i={y:i}).y)&&"max"!==i.y&&"="!==i.y.charAt(1)&&(i.x=i.y):i.nodeType&&(i={y:i,x:i}),p.vars=i,p.autoKill=!!i.autoKill,p.getX=o(e,"x"),p.getY=o(e,"y"),p.x=p.xPrev=p.getX(),p.y=p.yPrev=p.getY(),null!=i.x?(p.add(p,"x",p.x,s(i.x,e,"x",p.x,i.offsetX||0),a,u,Math.round),p._props.push("scrollTo_x")):p.skipX=1,null!=i.y?(p.add(p,"y",p.y,s(i.y,e,"y",p.y,i.offsetY||0),a,u,Math.round),p._props.push("scrollTo_y")):p.skipY=1},render:function t(e,i){for(var n,o,a,s,l,u=i._pt,c=i.target,p=i.tween,d=i.autoKill,f=i.xPrev,g=i.yPrev,y=i.isWin;u;)u.r(e,u.d),u=u._next;n=y||!i.skipX?i.getX():f,a=(o=y||!i.skipY?i.getY():g)-g,s=n-f,l=m.autoKillThreshold,i.x<0&&(i.x=0),i.y<0&&(i.y=0),d&&(!i.skipX&&(l<s||s<-l)&&n<r(c,"x")&&(i.skipX=1),!i.skipY&&(l<a||a<-l)&&o<r(c,"y")&&(i.skipY=1),i.skipX&&i.skipY&&(p.kill(),i.vars.onAutoKill&&i.vars.onAutoKill.apply(p,i.vars.onAutoKillParams||[]))),y?h.scrollTo(i.skipX?n:i.x,i.skipY?o:i.y):(i.skipY||(c.scrollTop=i.y),i.skipX||(c.scrollLeft=i.x)),i.xPrev=i.x,i.yPrev=i.y},kill:function t(e){var i="scrollTo"===e;!i&&"scrollTo_x"!==e||(this.skipX=1),!i&&"scrollTo_y"!==e||(this.skipY=1)}};g.max=r,g.getOffset=a,g.buildGetter=o,i()&&u.registerPlugin(g),t.ScrollToPlugin=g,t.default=g,"undefined"==typeof window||window!==t?Object.defineProperty(t,"__esModule",{value:!0}):delete t.default}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).window=t.window||{})}(this,function(t){"use strict";function e(t){return t}function i(){return"undefined"!=typeof window}function n(){return z||i()&&(z=window.gsap)&&z.registerPlugin&&z}function r(t){return!!~V.indexOf(t)}function o(t,e){return~at.indexOf(t)&&at[at.indexOf(t)+1][e]}function a(t,e){var i=e.s,n=e.sc,a=st.indexOf(t),s=n===Dt.sc?1:2;return~a||(a=st.push(t)-1),st[a+s]||(st[a+s]=o(t,i)||(r(t)?n:function(e){return arguments.length?t[i]=e:t[i]}))}function s(t){return o(t,"getBoundingClientRect")||(r(t)?function(){return Qt.width=R.innerWidth,Qt.height=R.innerHeight,Qt}:function(){return Et(t)})}function l(t,e){var i=e.s,n=e.d2,a=e.d,l=e.a;return(i="scroll"+n)&&(l=o(t,i))?l()-s(t)()[a]:r(t)?Math.max(N[i],F[i])-(R["inner"+n]||N["client"+n]||F["client"+n]):t[i]-t["offset"+n]}function u(t,e){for(var i=0;i<tt.length;i+=3)e&&!~e.indexOf(tt[i+1])||t(tt[i],tt[i+1],tt[i+2])}function c(t){return"string"==typeof t}function h(t){return"function"==typeof t}function p(t){return"number"==typeof t}function d(t){return"object"==typeof t}function f(t){return h(t)&&t()}function m(t,e){return function(){var i=f(t),n=f(e);return function(){f(i),f(n)}}}function g(t){return R.getComputedStyle(t)}function y(t,e){for(var i in e)i in t||(t[i]=e[i]);return t}function v(t,e){var i=e.d2;return t["offset"+i]||t["client"+i]||0}function _(t,e,i,n){return i.split(",").forEach(function(i){return t(e,i,n)})}function x(t,e,i){return t.addEventListener(e,i,{passive:!0})}function b(t,e,i){return t.removeEventListener(e,i)}function w(t,e){if(c(t)){var i=t.indexOf("="),n=~i?(t.charAt(i-1)+1)*parseFloat(t.substr(i+1)):0;n&&(t.indexOf("%")>i&&(n*=e/100),t=t.substr(0,i-1)),t=n+(t in zt?zt[t]*e:~t.indexOf("%")?parseFloat(t)*e/100:parseFloat(t)||0)}return t}function S(t,e,i,n,a,s,l){var u=a.startColor,c=a.endColor,h=a.fontSize,p=a.indent,d=a.fontWeight,f=B.createElement("div"),m=r(i)||"fixed"===o(i,"pinType"),g=-1!==t.indexOf("scroller"),y=m?F:i,v=-1!==t.indexOf("start"),_=v?u:c,x="border-color:"+_+";font-size:"+h+";color:"+_+";font-weight:"+d+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return x+="position:"+(g&&m?"fixed;":"absolute;"),!g&&m||(x+=(n===Dt?gt:yt)+":"+(s+parseFloat(p))+"px;"),l&&(x+="box-sizing:border-box;text-align:left;width:"+l.offsetWidth+"px;"),f._isStart=v,f.setAttribute("class","gsap-marker-"+t),f.style.cssText=x,f.innerText=e||0===e?t+"-"+e:t,y.insertBefore(f,y.children[0]),f._offset=f["offset"+n.op.d2],Ot(f,0,n,v),f}function T(){return $=$||G(qt)}function M(){$||($=G(qt),ct||Ut("scrollStart"),ct=lt())}function I(){return!q&&U.restart(!0)}function C(t){var e,i=z.ticker.frame,n=[],r=0;if(rt!==i||ot){for(Wt();r<Vt.length;r+=4)(e=R.matchMedia(Vt[r]).matches)!==Vt[r+3]&&((Vt[r+3]=e)?n.push(r):Wt(1,Vt[r])||h(Vt[r+2])&&Vt[r+2]());for($t(),r=0;r<n.length;r++)e=n[r],nt=Vt[e],Vt[e+2]=Vt[e+1](t);Ht(nt=0,1),rt=i,Ut("matchMedia")}}function A(){return b(ee,"scrollEnd",A)||Ht(!0)}function k(t,e,i,n){if(t.parentNode!==e){for(var r,o=Xt.length,a=e.style,s=t.style;o--;)a[r=Xt[o]]=i[r];a.position="absolute"===i.position?"absolute":"relative","inline"===i.display&&(a.display="inline-block"),s[yt]=s[gt]="auto",a.overflow="visible",a.boxSizing="border-box",a[vt]=v(t,kt)+At,a[_t]=v(t,Dt)+At,a[Tt]=s[Mt]=s.top=s[mt]="0",Jt(n),s[vt]=s.maxWidth=i[vt],s[_t]=s.maxHeight=i[_t],s[Tt]=i[Tt],t.parentNode.insertBefore(e,t),e.appendChild(t)}}function D(t){for(var e=Yt.length,i=t.style,n=[],r=0;r<e;r++)n.push(Yt[r],i[Yt[r]]);return n.t=t,n}function E(t,e,i,n,r,o,a,s,l,u,d,f){if(h(t)&&(t=t(s)),c(t)&&"max"===t.substr(0,3)&&(t=f+("="===t.charAt(4)?w("0"+t.substr(3),i):0)),p(t))a&&Ot(a,i,n,!0);else{h(e)&&(e=e(s));var m,y,v,_=W(e)[0]||F,x=Et(_)||{},b=t.split(" ");x&&(x.left||x.top)||"none"!==g(_).display||(v=_.style.display,_.style.display="block",x=Et(_),v?_.style.display=v:_.style.removeProperty("display")),m=w(b[0],x[n.d]),y=w(b[1]||"0",i),t=x[n.p]-l[n.p]-u+m+r-y,a&&Ot(a,y,n,i-y<20||a._isStart&&20<y),i-=i-y}if(o){var S=t+i,T=o._isStart;f="scroll"+n.d2,Ot(o,S,n,T&&20<S||!T&&(d?Math.max(F[f],N[f]):o.parentNode[f])<=S+1),d&&(l=Et(a),d&&(o.style[n.op.p]=l[n.op.p]-n.op.m-o._offset+At))}return Math.round(t)}function P(t,e,i,n){if(t.parentNode!==e){var r,o,a=t.style;if(e===F){for(r in t._stOrig=a.cssText,o=g(t))+r||te.test(r)||!o[r]||"string"!=typeof a[r]||"0"===r||(a[r]=o[r]);a.top=i,a.left=n}else a.cssText=t._stOrig;z.core.getCache(t).uncache=1,e.appendChild(t)}}function L(t,e){var i,n,r=a(t,e),o="_scroll"+e.p2;return t[o]=r,function e(a,s,l,u,c){var h=e.tween,p=s.onComplete,d={};return h&&h.kill(),i=Math.round(l),s[o]=a,(s.modifiers=d)[o]=function(t){return(t=Math.round(r()))!==i&&t!==n?(h.kill(),e.tween=0):t=l+u*h.ratio+c*h.ratio*h.ratio,n=i,i=Math.round(t)},s.onComplete=function(){e.tween=0,p&&p.call(h)},h=e.tween=z.to(t,s)}}var z,O,R,B,N,F,V,U,G,$,W,H,j,Z,q,X,Y,K,J,Q,tt,et,it,nt,rt,ot=1,at=[],st=[],lt=Date.now,ut=lt(),ct=0,ht=1,pt=Math.abs,dt="scrollLeft",ft="scrollTop",mt="left",gt="right",yt="bottom",vt="width",_t="height",xt="Right",bt="Left",wt="Top",St="Bottom",Tt="padding",Mt="margin",It="Width",Ct="Height",At="px",kt={s:dt,p:mt,p2:bt,os:gt,os2:xt,d:vt,d2:It,a:"x",sc:function t(e){return arguments.length?R.scrollTo(e,Dt.sc()):R.pageXOffset||B[dt]||N[dt]||F[dt]||0}},Dt={s:ft,p:"top",p2:wt,os:yt,os2:St,d:_t,d2:Ct,a:"y",op:kt,sc:function t(e){return arguments.length?R.scrollTo(kt.sc(),e):R.pageYOffset||B[ft]||N[ft]||F[ft]||0}},Et=function t(e,i){var n=i&&"matrix(1, 0, 0, 1, 0, 0)"!==g(e)[Y]&&z.to(e,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),r=e.getBoundingClientRect();return n&&n.progress(0).kill(),r},Pt={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},Lt={toggleActions:"play",anticipatePin:0},zt={top:0,left:0,center:.5,bottom:1,right:1},Ot=function t(e,i,n,r){var o={display:"block"},a=n[r?"os2":"p2"],s=n[r?"p2":"os2"];e._isFlipped=r,o[n.a+"Percent"]=r?-100:0,o[n.a]=r?1:0,o["border"+a+It]=1,o["border"+s+It]=0,o[n.p]=i,z.set(e,o)},Rt=[],Bt={},Nt={},Ft=[],Vt=[],Ut=function t(e){return Nt[e]&&Nt[e].map(function(t){return t()})||Ft},Gt=[],$t=function t(e){for(var i=0;i<Gt.length;i+=4)e&&Gt[i+3]!==e||(Gt[i].style.cssText=Gt[i+1],Gt[i+2].uncache=1)},Wt=function t(e,i){var n;for(K=0;K<Rt.length;K++)n=Rt[K],i&&n.media!==i||(e?n.kill(1):(n.scroll.rec||(n.scroll.rec=n.scroll()),n.revert()));$t(i),i||Ut("revert")},Ht=function t(e,i){if(!ct||e){var n=Ut("refreshInit");for(et&&ee.sort(),i||Wt(),K=0;K<Rt.length;K++)Rt[K].refresh();for(n.forEach(function(t){return t&&t.render&&t.render(-1)}),K=Rt.length;K--;)Rt[K].scroll.rec=0;U.pause(),Ut("refresh")}else x(ee,"scrollEnd",A)},jt=0,Zt=1,qt=function t(){var e=Rt.length,i=lt(),n=50<=i-ut,r=e&&Rt[0].scroll();if(Zt=r<jt?-1:1,jt=r,n&&(ct&&!X&&200<i-ct&&(ct=0,Ut("scrollEnd")),j=ut,ut=i),Zt<0){for(K=e;K--;)Rt[K]&&Rt[K].update(0,n);Zt=1}else for(K=0;K<e;K++)Rt[K]&&Rt[K].update(0,n);$=0},Xt=[mt,"top",yt,gt,Mt+St,Mt+xt,Mt+wt,Mt+bt,"display","flexShrink","float"],Yt=Xt.concat([vt,_t,"boxSizing","max"+It,"max"+Ct,"position",Mt,Tt,Tt+wt,Tt+xt,Tt+St,Tt+bt]),Kt=/([A-Z])/g,Jt=function t(e){if(e)for(var i,n,r=e.t.style,o=e.length,a=0;a<o;a+=2)n=e[a+1],i=e[a],n?r[i]=n:r[i]&&r.removeProperty(i.replace(Kt,"-$1").toLowerCase())},Qt={left:0,top:0},te=/(?:webkit|moz|length|cssText)/i;kt.op=Dt;var ee=(ie.prototype.init=function t(i,n){if(this.progress=0,this.vars&&this.kill(1),ht){var u,f,m,_,T,C,O,V,U,G,$,Z,Y,J,Q,tt,rt,st,ut,dt,ft,mt,gt,yt,Ct,zt,Ot,Nt,Ft,Vt,Ut,Gt,$t,Wt,Ht,jt,qt,Xt=(i=y(c(i)||p(i)||i.nodeType?{trigger:i}:i,Lt)).horizontal?kt:Dt,Yt=i.onUpdate,Kt=i.toggleClass,te=i.id,ee=i.onToggle,ne=i.onRefresh,re=i.scrub,oe=i.trigger,ae=i.pin,se=i.pinSpacing,le=i.invalidateOnRefresh,ue=i.anticipatePin,ce=i.onScrubComplete,he=i.onSnapComplete,pe=i.once,de=i.snap,fe=i.pinReparent,me=!re&&0!==re,ge=W(i.scroller||R)[0],ye=z.core.getCache(ge),ve=r(ge),_e="pinType"in i?"fixed"===i.pinType:ve||"fixed"===o(ge,"pinType"),xe=[i.onEnter,i.onLeave,i.onEnterBack,i.onLeaveBack],be=me&&i.toggleActions.split(" "),we="markers"in i?i.markers:Lt.markers,Se=ve?0:parseFloat(g(ge)["border"+Xt.p2+It])||0,Te=this,Me=i.onRefreshInit&&function(){return i.onRefreshInit(Te)},Ie=function t(e,i,n){var r=n.d,a=n.d2,s=n.a;return(s=o(e,"getBoundingClientRect"))?function(){return s()[r]}:function(){return(i?R["inner"+a]:e["client"+a])||0}}(ge,ve,Xt),Ce=function t(e,i){return!i||~at.indexOf(e)?s(e):function(){return Qt}}(ge,ve);Te.media=nt,ue*=45,Rt.push(Te),Te.scroller=ge,Te.scroll=a(ge,Xt),T=Te.scroll(),Te.vars=i,n=n||i.animation,"refreshPriority"in i&&(et=1),ye.tweenScroll=ye.tweenScroll||{top:L(ge,Dt),left:L(ge,kt)},Te.tweenTo=u=ye.tweenScroll[Xt.p],n&&(n.vars.lazy=!1,n._initted||!1!==n.vars.immediateRender&&!1!==i.immediateRender&&n.render(0,!0,!0),Te.animation=n.pause(),n.scrollTrigger=Te,(Gt=p(re)&&re)&&(Ut=z.to(n,{ease:"power3",duration:Gt,onComplete:function t(){return ce&&ce(Te)}})),Ft=0,te=te||n.vars.id),de&&(d(de)||(de={snapTo:de}),z.set(ve?[F,N]:ge,{scrollBehavior:"auto"}),m=h(de.snapTo)?de.snapTo:"labels"===de.snapTo?function t(e){return function(t){var i,n=[],r=e.labels,o=e.duration();for(i in r)n.push(r[i]/o);return z.utils.snap(n,t)}}(n):z.utils.snap(de.snapTo),$t=d($t=de.duration||{min:.1,max:2})?H($t.min,$t.max):H($t,$t),Wt=z.delayedCall(de.delay||Gt/2||.1,function(){if(Math.abs(Te.getVelocity())<10&&!X){var t=n&&!me?n.totalProgress():Te.progress,e=(t-Vt)/(lt()-j)*1e3||0,i=pt(e/2)*e/.185,r=t+i,o=H(0,1,m(r,Te)),a=Te.scroll(),s=Math.round(O+o*J),l=u.tween;if(a<=V&&O<=a&&s!==a){if(l&&!l._initted&&l.data<=Math.abs(s-a))return;u(s,{duration:$t(pt(.185*Math.max(pt(r-t),pt(o-t))/e/.05||0)),ease:de.ease||"power3",data:Math.abs(s-a),onComplete:function t(){Ft=Vt=n&&!me?n.totalProgress():Te.progress,he&&he(Te)}},a,i*J,s-a-i*J)}}else Te.isActive&&Wt.restart(!0)}).pause()),te&&(Bt[te]=Te),oe=Te.trigger=W(oe||ae)[0],ae=!0===ae?oe:W(ae)[0],c(Kt)&&(Kt={targets:oe,className:Kt}),ae&&(!1===se||se===Mt||(se=!(!se&&"flex"===g(ae.parentNode).display)&&Tt),Te.pin=ae,!1!==i.force3D&&z.set(ae,{force3D:!0}),(f=z.core.getCache(ae)).spacer?Q=f.pinState:(f.spacer=st=B.createElement("div"),st.setAttribute("class","pin-spacer"+(te?" pin-spacer-"+te:"")),f.pinState=Q=D(ae)),Te.spacer=st=f.spacer,Nt=g(ae),yt=Nt[se+Xt.os2],dt=z.getProperty(ae),ft=z.quickSetter(ae,Xt.a,At),k(ae,st,Nt),rt=D(ae)),we&&(Y=d(we)?y(we,Pt):Pt,$=S("scroller-start",te,ge,Xt,Y,0),Z=S("scroller-end",te,ge,Xt,Y,0,$),ut=$["offset"+Xt.op.d2],U=S("start",te,ge,Xt,Y,ut),G=S("end",te,ge,Xt,Y,ut),_e||(function t(e){e.style.position="absolute"===g(e).position?"absolute":"relative"}(ge),z.set([$,Z],{force3D:!0}),zt=z.quickSetter($,Xt.a,At),Ot=z.quickSetter(Z,Xt.a,At))),Te.revert=function(t){var e=!1!==t||!Te.enabled,i=q;e!==_&&(e&&(jt=Math.max(Te.scroll(),Te.scroll.rec||0),Ht=Te.progress,qt=n&&n.progress()),U&&[U,G,$,Z].forEach(function(t){return t.style.display=e?"none":"block"}),e&&(q=1),Te.update(e),q=i,ae&&(e?function t(e,i,n){if(Jt(n),e.parentNode===i){var r=i.parentNode;r&&(r.insertBefore(e,i),r.removeChild(i))}}(ae,st,Q):fe&&Te.isActive||k(ae,st,g(ae),Ct)),_=e)},Te.refresh=function(t){if(!q&&Te.enabled)if(ae&&t&&ct)x(ie,"scrollEnd",A);else{q=1,Ut&&Ut.kill(),le&&n&&n.progress(0).invalidate(),_||Te.revert();for(var e,r,o,s,u,p,d,f,m=Ie(),y=Ce(),b=l(ge,Xt),S=0,M=0,I=i.end,P=i.endTrigger||oe,L=i.start||(0===i.start?0:ae||!oe?"0 0":"0 100%"),R=oe&&Math.max(0,Rt.indexOf(Te))||0,B=R;B--;)!(d=Rt[B].pin)||d!==oe&&d!==ae||Rt[B].revert();for(O=E(L,oe,m,Xt,Te.scroll(),U,$,Te,y,Se,_e,b)||(ae?-.001:0),h(I)&&(I=I(Te)),c(I)&&!I.indexOf("+=")&&(~I.indexOf(" ")?I=(c(L)?L.split(" ")[0]:"")+I:(S=w(I.substr(2),m),I=c(L)?L:O+S,P=oe)),V=Math.max(O,E(I||(P?"100% 0":b),P,m,Xt,Te.scroll()+S,G,Z,Te,y,Se,_e,b))||-.001,J=V-O||(O-=.01)&&.001,S=0,B=R;B--;)(d=(p=Rt[B]).pin)&&p.start-p._pinPush<O&&(e=p.end-p.start,d===oe&&(S+=e),d===ae&&(M+=e));if(O+=S,V+=S,Te._pinPush=M,U&&S&&((e={})[Xt.a]="+="+S,z.set([U,G],e)),ae)e=g(ae),s=Xt===Dt,o=Te.scroll(),mt=parseFloat(dt(Xt.a))+M,!b&&1<V&&((ve?F:ge).style["overflow-"+Xt.a]="scroll"),k(ae,st,e),rt=D(ae),r=Et(ae,!0),f=_e&&a(ge,s?kt:Dt)(),se&&((Ct=[se+Xt.os2,J+M+At]).t=st,(B=se===Tt?v(ae,Xt)+J+M:0)&&Ct.push(Xt.d,B+At),Jt(Ct),_e&&Te.scroll(jt)),_e&&((u={top:r.top+(s?o-O:f)+At,left:r.left+(s?f:o-O)+At,boxSizing:"border-box",position:"fixed"})[vt]=u.maxWidth=Math.ceil(r.width)+At,u[_t]=u.maxHeight=Math.ceil(r.height)+At,u[Mt]=u[Mt+wt]=u[Mt+xt]=u[Mt+St]=u[Mt+bt]="0",u[Tt]=e[Tt],u[Tt+wt]=e[Tt+wt],u[Tt+xt]=e[Tt+xt],u[Tt+St]=e[Tt+St],u[Tt+bt]=e[Tt+bt],tt=function t(e,i,n){for(var r,o=[],a=e.length,s=n?8:0;s<a;s+=2)r=e[s],o.push(r,r in i?i[r]:e[s+1]);return o.t=e.t,o}(Q,u,fe)),n?(n.progress(1,!0),gt=dt(Xt.a)-mt+J+M,J!==gt&&tt.splice(tt.length-2,2),n.progress(0,!0)):gt=J;else if(oe&&Te.scroll())for(r=oe.parentNode;r&&r!==F;)r._pinOffset&&(O-=r._pinOffset,V-=r._pinOffset),r=r.parentNode;for(B=0;B<R;B++)!(p=Rt[B].pin)||p!==oe&&p!==ae||Rt[B].revert(!1);Te.start=O,Te.end=V,(T=C=Te.scroll())<jt&&Te.scroll(jt),Te.revert(!1),q=0,qt&&me&&n.progress(qt,!0),Ht!==Te.progress&&(Ut&&n.totalProgress(Ht,!0),Te.progress=Ht,Te.update()),ae&&se&&(st._pinOffset=Math.round(Te.progress*gt)),ne&&ne(Te)}},Te.getVelocity=function(){return(Te.scroll()-C)/(lt()-j)*1e3||0},Te.update=function(t,e){var i,r,o,a,s,c=Te.scroll(),h=t?0:(c-O)/J,p=h<0?0:1<h?1:h||0,d=Te.progress;if(e&&(C=T,T=c,de&&(Vt=Ft,Ft=n&&!me?n.totalProgress():p)),ue&&!p&&ae&&!q&&!ot&&ct&&O<c+(c-C)/(lt()-j)*ue&&(p=1e-4),p!==d&&Te.enabled){if(a=(s=(i=Te.isActive=!!p&&p<1)!=(!!d&&d<1))||!!p!=!!d,Te.direction=d<p?1:-1,Te.progress=p,me||(!Ut||q||ot?n&&n.totalProgress(p,!!q):(Ut.vars.totalProgress=p,Ut.invalidate().restart())),ae)if(t&&se&&(st.style[se+Xt.os2]=yt),_e){if(a){if(o=!t&&d<p&&c<V+1&&c+1>=l(ge,Xt),fe)if(t||!i&&!o)P(ae,st);else{var f=Et(ae,!0),m=c-O;P(ae,F,f.top+(Xt===Dt?m:0)+At,f.left+(Xt===Dt?0:m)+At)}Jt(i||o?tt:rt),gt!==J&&p<1&&i||ft(mt+(1!==p||o?0:gt))}}else ft(mt+gt*p);!de||u.tween||q||ot||Wt.restart(!0),Kt&&(s||pe&&p&&(p<1||!it))&&W(Kt.targets).forEach(function(t){return t.classList[i||pe?"add":"remove"](Kt.className)}),!Yt||me||t||Yt(Te),a&&!q?(r=p&&!d?0:1===p?1:1===d?2:3,me&&(o=!s&&"none"!==be[r+1]&&be[r+1]||be[r],n&&("complete"===o||"reset"===o||o in n)&&("complete"===o?n.pause().totalProgress(1):"reset"===o?n.restart(!0).pause():n[o]()),Yt&&Yt(Te)),!s&&it||(ee&&s&&ee(Te),xe[r]&&xe[r](Te),pe&&(1===p?Te.kill(!1,1):xe[r]=0),s||xe[r=1===p?1:3]&&xe[r](Te))):me&&Yt&&!q&&Yt(Te)}Ot&&(zt(c+($._isFlipped?1:0)),Ot(c))},Te.enable=function(){Te.enabled||(Te.enabled=!0,x(ge,"resize",I),x(ge,"scroll",M),Me&&x(ie,"refreshInit",Me),n&&n.add?z.delayedCall(.01,function(){return O||V||Te.refresh()})&&(J=.01)&&(O=V=0):Te.refresh())},Te.disable=function(t,e){if(Te.enabled&&(!1!==t&&Te.revert(),Te.enabled=Te.isActive=!1,e||Ut&&Ut.pause(),jt=0,f&&(f.uncache=1),Me&&b(ie,"refreshInit",Me),Wt&&(Wt.pause(),u.tween&&u.tween.kill()&&(u.tween=0)),!ve)){for(var i=Rt.length;i--;)if(Rt[i].scroller===ge&&Rt[i]!==Te)return;b(ge,"resize",I),b(ge,"scroll",M)}},Te.kill=function(t,e){Te.disable(t,e),te&&delete Bt[te];var i=Rt.indexOf(Te);Rt.splice(i,1),i===K&&0<Zt&&K--,n&&(n.scrollTrigger=null,t&&n.render(-1),e||n.kill()),U&&[U,G,$,Z].forEach(function(t){return t.parentNode.removeChild(t)}),f&&(f.uncache=1)},Te.enable()}else this.update=this.refresh=this.kill=e},ie.register=function t(r){if(!O&&(z=r||n(),i()&&window.document&&(R=window,B=document,N=B.documentElement,F=B.body),z&&(W=z.utils.toArray,H=z.utils.clamp,z.core.globals("ScrollTrigger",ie),F))){G=R.requestAnimationFrame||function(t){return setTimeout(t,16)},x(R,"mousewheel",M),V=[R,B,N,F],x(B,"scroll",M);var o,a=F.style,s=a.borderTop;a.borderTop="1px solid #000",o=Et(F),Dt.m=Math.round(o.top+Dt.sc())||0,kt.m=Math.round(o.left+kt.sc())||0,s?a.borderTop=s:a.removeProperty("border-top"),Z=setInterval(T,200),z.delayedCall(.5,function(){return ot=0}),x(B,"touchcancel",e),x(F,"touchstart",e),_(x,B,"pointerdown,touchstart,mousedown",function(){return X=1}),_(x,B,"pointerup,touchend,mouseup",function(){return X=0}),Y=z.utils.checkPrefix("transform"),Yt.push(Y),O=lt(),U=z.delayedCall(.2,Ht).pause(),tt=[B,"visibilitychange",function(){var t=R.innerWidth,e=R.innerHeight;B.hidden?(J=t,Q=e):J===t&&Q===e||I()},B,"DOMContentLoaded",Ht,R,"load",function(){return ct||Ht()},R,"resize",I],u(x)}return O},ie.defaults=function t(e){for(var i in e)Lt[i]=e[i]},ie.kill=function t(){ht=0,Rt.slice(0).forEach(function(t){return t.kill(1)})},ie.config=function t(e){"limitCallbacks"in e&&(it=!!e.limitCallbacks);var i=e.syncInterval;i&&clearInterval(Z)||(Z=i)&&setInterval(T,i),"autoRefreshEvents"in e&&(u(b)||u(x,e.autoRefreshEvents||"none"))},ie.scrollerProxy=function t(e,i){var n=W(e)[0];r(n)?at.unshift(R,i,F,i,N,i):at.unshift(n,i)},ie.matchMedia=function t(e){var i,n,r,o,a;for(n in e)r=Vt.indexOf(n),o=e[n],"all"===(nt=n)?o():(i=R.matchMedia(n))&&(i.matches&&(a=o()),~r?(Vt[r+1]=m(Vt[r+1],o),Vt[r+2]=m(Vt[r+2],a)):(r=Vt.length,Vt.push(n,o,a),i.addListener?i.addListener(C):i.addEventListener("change",C)),Vt[r+3]=i.matches),nt=0;return Vt},ie.clearMatchMedia=function t(e){e||(Vt.length=0),0<=(e=Vt.indexOf(e))&&Vt.splice(e,4)},ie);function ie(t,e){O||ie.register(z)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),this.init(t,e)}ee.version="3.5.1",ee.saveStyles=function(t){return t?W(t).forEach(function(t){var e=Gt.indexOf(t);0<=e&&Gt.splice(e,4),Gt.push(t,t.style.cssText,z.core.getCache(t),nt)}):Gt},ee.revert=function(t,e){return Wt(!t,e)},ee.create=function(t,e){return new ee(t,e)},ee.refresh=function(t){return t?I():Ht(!0)},ee.update=qt,ee.maxScroll=function(t,e){return l(t,e?kt:Dt)},ee.getScrollFunc=function(t,e){return a(W(t)[0],e?kt:Dt)},ee.getById=function(t){return Bt[t]},ee.getAll=function(){return Rt.slice(0)},ee.isScrolling=function(){return!!ct},ee.addEventListener=function(t,e){var i=Nt[t]||(Nt[t]=[]);~i.indexOf(e)||i.push(e)},ee.removeEventListener=function(t,e){var i=Nt[t],n=i&&i.indexOf(e);0<=n&&i.splice(n,1)},ee.batch=function(t,e){function i(t,e){var i=[],n=[],r=z.delayedCall(a,function(){e(i,n),i=[],n=[]}).pause();return function(t){i.length||r.restart(!0),i.push(t.trigger),n.push(t),s<=i.length&&r.progress(1)}}var n,r=[],o={},a=e.interval||.016,s=e.batchMax||1e9;for(n in e)o[n]="on"===n.substr(0,2)&&h(e[n])&&"onRefreshInit"!==n?i(0,e[n]):e[n];return h(s)&&(s=s(),x(ee,"refresh",function(){return s=e.batchMax()})),W(t).forEach(function(t){var e={};for(n in o)e[n]=o[n];e.trigger=t,r.push(ee.create(e))}),r},ee.sort=function(t){return Rt.sort(t||function(t,e){return-1e6*(t.vars.refreshPriority||0)+t.start-(e.start+-1e6*(e.vars.refreshPriority||0))})},n()&&z.registerPlugin(ee),t.ScrollTrigger=ee,t.default=ee,"undefined"==typeof window||window!==t?Object.defineProperty(t,"__esModule",{value:!0}):delete t.default}),function(t,e){if("function"==typeof define&&define.amd)define(["exports"],e);else if("undefined"!=typeof exports)e(exports);else{var i={};e(i),t.bodyScrollLock=i}}(this,function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=!1;if("undefined"!=typeof window){var i={get passive(){e=!0}};window.addEventListener("testPassive",null,i),window.removeEventListener("testPassive",null,i)}function n(t){return s.some(function(e){return!(!e.options.allowTouchMove||!e.options.allowTouchMove(t))})}function r(t){var e=t||window.event;return!!n(e.target)||1<e.touches.length||(e.preventDefault&&e.preventDefault(),!1)}function o(){void 0!==h&&(document.body.style.paddingRight=h,h=void 0),void 0!==c&&(document.body.style.overflow=c,c=void 0)}var a="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||"MacIntel"===window.navigator.platform&&1<window.navigator.maxTouchPoints),s=[],l=!1,u=-1,c=void 0,h=void 0;t.disableBodyScroll=function(t,i){if(t){if(!s.some(function(e){return e.targetElement===t})){var o={targetElement:t,options:i||{}};s=[].concat(function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}(s),[o]),a?(t.ontouchstart=function(t){1===t.targetTouches.length&&(u=t.targetTouches[0].clientY)},t.ontouchmove=function(e){var i,o,a,s;1===e.targetTouches.length&&(o=t,s=(i=e).targetTouches[0].clientY-u,n(i.target)||(o&&0===o.scrollTop&&0<s||(a=o)&&a.scrollHeight-a.scrollTop<=a.clientHeight&&s<0?r(i):i.stopPropagation()))},l||(document.addEventListener("touchmove",r,e?{passive:!1}:void 0),l=!0)):function(t){if(void 0===h){var e=!!t&&!0===t.reserveScrollBarGap,i=window.innerWidth-document.documentElement.clientWidth;e&&0<i&&(h=document.body.style.paddingRight,document.body.style.paddingRight=i+"px")}void 0===c&&(c=document.body.style.overflow,document.body.style.overflow="hidden")}(i)}}else console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.")},t.clearAllBodyScrollLocks=function(){a?(s.forEach(function(t){t.targetElement.ontouchstart=null,t.targetElement.ontouchmove=null}),l&&(document.removeEventListener("touchmove",r,e?{passive:!1}:void 0),l=!1),u=-1):o(),s=[]},t.enableBodyScroll=function(t){t?(s=s.filter(function(e){return e.targetElement!==t}),a?(t.ontouchstart=null,t.ontouchmove=null,l&&0===s.length&&(document.removeEventListener("touchmove",r,e?{passive:!1}:void 0),l=!1)):s.length||o()):console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.")}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).echarts={})}(this,function(t){"use strict";var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,i)};function i(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+i+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}var n=function(){return(n=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function r(t,e,i){if(i||2===arguments.length)for(var n,r=0,o=e.length;r<o;r++)!n&&r in e||(n||(n=Array.prototype.slice.call(e,0,r)),n[r]=e[r]);return t.concat(n||e)}var o=function(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1},a=new function(){this.browser=new o,this.node=!1,this.wxa=!1,this.worker=!1,this.canvasSupported=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1};"object"==typeof wx&&"function"==typeof wx.getSystemInfoSync?(a.wxa=!0,a.canvasSupported=!0,a.touchEventsSupported=!0):"undefined"==typeof document&&"undefined"!=typeof self?(a.worker=!0,a.canvasSupported=!0):"undefined"==typeof navigator?(a.node=!0,a.canvasSupported=!0,a.svgSupported=!0):function(t,e){var i=e.browser,n=t.match(/Firefox\/([\d.]+)/),r=t.match(/MSIE\s([\d.]+)/)||t.match(/Trident\/.+?rv:(([\d.]+))/),o=t.match(/Edge?\/([\d.]+)/),a=/micromessenger/i.test(t);n&&(i.firefox=!0,i.version=n[1]),r&&(i.ie=!0,i.version=r[1]),o&&(i.edge=!0,i.version=o[1],i.newEdge=+o[1].split(".")[0]>18),a&&(i.weChat=!0),e.canvasSupported=!!document.createElement("canvas").getContext,e.svgSupported="undefined"!=typeof SVGRect,e.touchEventsSupported="ontouchstart"in window&&!i.ie&&!i.edge,e.pointerEventsSupported="onpointerdown"in window&&(i.edge||i.ie&&+i.version>=11),e.domSupported="undefined"!=typeof document;var s=document.documentElement.style;e.transform3dSupported=(i.ie&&"transition"in s||i.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in s)&&!("OTransition"in s),e.transformSupported=e.transform3dSupported||i.ie&&+i.version>=9}(navigator.userAgent,a);var s={"[object Function]":!0,"[object RegExp]":!0,"[object Date]":!0,"[object Error]":!0,"[object CanvasGradient]":!0,"[object CanvasPattern]":!0,"[object Image]":!0,"[object Canvas]":!0},l={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0},u=Object.prototype.toString,c=Array.prototype,h=c.forEach,p=c.filter,d=c.slice,f=c.map,m=function(){}.constructor,g=m?m.prototype:null,y="__proto__",v={};function _(t,e){v[t]=e}var x=2311;function b(){return x++}function w(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];void 0!==console&&console.error.apply(console,t)}function S(t){if(null==t||"object"!=typeof t)return t;var e=t,i=u.call(t);if("[object Array]"===i){if(!ut(t)){e=[];for(var n=0,r=t.length;n<r;n++)e[n]=S(t[n])}}else if(l[i]){if(!ut(t)){var o=t.constructor;if(o.from)e=o.from(t);else for(e=new o(t.length),n=0,r=t.length;n<r;n++)e[n]=S(t[n])}}else if(!s[i]&&!ut(t)&&!X(t))for(var a in e={},t)t.hasOwnProperty(a)&&a!==y&&(e[a]=S(t[a]));return e}function T(t,e,i){if(!j(e)||!j(t))return i?S(e):t;for(var n in e)if(e.hasOwnProperty(n)&&n!==y){var r=t[n],o=e[n];!j(o)||!j(r)||U(o)||U(r)||X(o)||X(r)||Z(o)||Z(r)||ut(o)||ut(r)?!i&&n in t||(t[n]=S(e[n])):T(r,o,i)}return t}function M(t,e){for(var i=t[0],n=1,r=t.length;n<r;n++)i=T(i,t[n],e);return i}function I(t,e){if(Object.assign)Object.assign(t,e);else for(var i in e)e.hasOwnProperty(i)&&i!==y&&(t[i]=e[i]);return t}function C(t,e,i){for(var n=N(e),r=0;r<n.length;r++){var o=n[r];(i?null!=e[o]:null==t[o])&&(t[o]=e[o])}return t}var A=function(){return v.createCanvas()};function k(t,e){if(t){if(t.indexOf)return t.indexOf(e);for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i}return-1}function D(t,e){var i=t.prototype;function n(){}for(var r in n.prototype=e.prototype,t.prototype=new n,i)i.hasOwnProperty(r)&&(t.prototype[r]=i[r]);t.prototype.constructor=t,t.superClass=e}function E(t,e,i){if(t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames)for(var n=Object.getOwnPropertyNames(e),r=0;r<n.length;r++){var o=n[r];"constructor"!==o&&(i?null!=e[o]:null==t[o])&&(t[o]=e[o])}else C(t,e,i)}function P(t){return!!t&&"string"!=typeof t&&"number"==typeof t.length}function L(t,e,i){if(t&&e)if(t.forEach&&t.forEach===h)t.forEach(e,i);else if(t.length===+t.length)for(var n=0,r=t.length;n<r;n++)e.call(i,t[n],n,t);else for(var o in t)t.hasOwnProperty(o)&&e.call(i,t[o],o,t)}function z(t,e,i){if(!t)return[];if(!e)return nt(t);if(t.map&&t.map===f)return t.map(e,i);for(var n=[],r=0,o=t.length;r<o;r++)n.push(e.call(i,t[r],r,t));return n}function O(t,e,i,n){if(t&&e){for(var r=0,o=t.length;r<o;r++)i=e.call(n,i,t[r],r,t);return i}}function R(t,e,i){if(!t)return[];if(!e)return nt(t);if(t.filter&&t.filter===p)return t.filter(e,i);for(var n=[],r=0,o=t.length;r<o;r++)e.call(i,t[r],r,t)&&n.push(t[r]);return n}function B(t,e,i){if(t&&e)for(var n=0,r=t.length;n<r;n++)if(e.call(i,t[n],n,t))return t[n]}function N(t){if(!t)return[];if(Object.keys)return Object.keys(t);var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e}v.createCanvas=function(){return document.createElement("canvas")};var F=g&&G(g.bind)?g.call.bind(g.bind):function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return function(){return t.apply(e,i.concat(d.call(arguments)))}};function V(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return function(){return t.apply(this,e.concat(d.call(arguments)))}}function U(t){return Array.isArray?Array.isArray(t):"[object Array]"===u.call(t)}function G(t){return"function"==typeof t}function $(t){return"string"==typeof t}function W(t){return"[object String]"===u.call(t)}function H(t){return"number"==typeof t}function j(t){var e=typeof t;return"function"===e||!!t&&"object"===e}function Z(t){return!!s[u.call(t)]}function q(t){return!!l[u.call(t)]}function X(t){return"object"==typeof t&&"number"==typeof t.nodeType&&"object"==typeof t.ownerDocument}function Y(t){return null!=t.colorStops}function K(t){return null!=t.image}function J(t){return"[object RegExp]"===u.call(t)}function Q(t){return t!=t}function tt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0,n=t.length;i<n;i++)if(null!=t[i])return t[i]}function et(t,e){return null!=t?t:e}function it(t,e,i){return null!=t?t:null!=e?e:i}function nt(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return d.apply(t,e)}function rt(t){if("number"==typeof t)return[t,t,t,t];var e=t.length;return 2===e?[t[0],t[1],t[0],t[1]]:3===e?[t[0],t[1],t[2],t[1]]:t}function ot(t,e){if(!t)throw Error(e)}function at(t){return null==t?null:"function"==typeof t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var st="__ec_primitive__";function lt(t){t[st]=!0}function ut(t){return t[st]}var ct=function(){function t(e){this.data={};var i=U(e);this.data={};var n=this;function r(t,e){i?n.set(t,e):n.set(e,t)}e instanceof t?e.each(r):e&&L(e,r)}return t.prototype.get=function(t){return this.data.hasOwnProperty(t)?this.data[t]:null},t.prototype.set=function(t,e){return this.data[t]=e},t.prototype.each=function(t,e){for(var i in this.data)this.data.hasOwnProperty(i)&&t.call(e,this.data[i],i)},t.prototype.keys=function(){return N(this.data)},t.prototype.removeKey=function(t){delete this.data[t]},t}();function ht(t){return new ct(t)}function pt(t,e){for(var i=new t.constructor(t.length+e.length),n=0;n<t.length;n++)i[n]=t[n];var r=t.length;for(n=0;n<e.length;n++)i[n+r]=e[n];return i}function dt(t,e){var i;if(Object.create)i=Object.create(t);else{var n=function(){};n.prototype=t,i=new n}return e&&I(i,e),i}function ft(t,e){return t.hasOwnProperty(e)}function mt(){}var gt=Object.freeze({__proto__:null,$override:_,guid:b,logError:w,clone:S,merge:T,mergeAll:M,extend:I,defaults:C,createCanvas:A,indexOf:k,inherits:D,mixin:E,isArrayLike:P,each:L,map:z,reduce:O,filter:R,find:B,keys:N,bind:F,curry:V,isArray:U,isFunction:G,isString:$,isStringSafe:W,isNumber:H,isObject:j,isBuiltInObject:Z,isTypedArray:q,isDom:X,isGradientObject:Y,isImagePatternObject:K,isRegExp:J,eqNaN:Q,retrieve:tt,retrieve2:et,retrieve3:it,slice:nt,normalizeCssArray:rt,assert:ot,trim:at,setAsPrimitive:lt,isPrimitive:ut,HashMap:ct,createHashMap:ht,concatArray:pt,createObject:dt,hasOwn:ft,noop:mt}),yt,vt;function _t(t,e){return null==t&&(t=0),null==e&&(e=0),[t,e]}function xt(t,e){return t[0]=e[0],t[1]=e[1],t}function bt(t){return[t[0],t[1]]}function wt(t,e,i){return t[0]=e,t[1]=i,t}function St(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t}function Tt(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t}function Mt(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t}function It(t){return Math.sqrt(Ct(t))}function Ct(t){return t[0]*t[0]+t[1]*t[1]}function At(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}function kt(t,e){var i=It(e);return 0===i?(t[0]=0,t[1]=0):(t[0]=e[0]/i,t[1]=e[1]/i),t}function Dt(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}var Et=Dt;function Pt(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}var Lt=Pt;function zt(t,e,i,n){return t[0]=e[0]+n*(i[0]-e[0]),t[1]=e[1]+n*(i[1]-e[1]),t}function Ot(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r+i[4],t[1]=i[1]*n+i[3]*r+i[5],t}function Rt(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t}function Bt(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t}var Nt=Object.freeze({__proto__:null,create:_t,copy:xt,clone:bt,set:wt,add:St,scaleAndAdd:Tt,sub:Mt,len:It,length:It,lenSquare:Ct,lengthSquare:Ct,mul:function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t},div:function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t},dot:function(t,e){return t[0]*e[0]+t[1]*e[1]},scale:At,normalize:kt,distance:Dt,dist:Et,distanceSquare:Pt,distSquare:Lt,negate:function(t,e){return t[0]=-e[0],t[1]=-e[1],t},lerp:zt,applyTransform:Ot,min:Rt,max:Bt}),Ft=function(t,e){this.target=t,this.topTarget=e&&e.topTarget},Vt=function(){function t(t){this.handler=t,t.on("mousedown",this._dragStart,this),t.on("mousemove",this._drag,this),t.on("mouseup",this._dragEnd,this)}return t.prototype._dragStart=function(t){for(var e=t.target;e&&!e.draggable;)e=e.parent;e&&(this._draggingTarget=e,e.dragging=!0,this._x=t.offsetX,this._y=t.offsetY,this.handler.dispatchToElement(new Ft(e,t),"dragstart",t.event))},t.prototype._drag=function(t){var e=this._draggingTarget;if(e){var i=t.offsetX,n=t.offsetY,r=i-this._x,o=n-this._y;this._x=i,this._y=n,e.drift(r,o,t),this.handler.dispatchToElement(new Ft(e,t),"drag",t.event);var a=this.handler.findHover(i,n,e).target,s=this._dropTarget;this._dropTarget=a,e!==a&&(s&&a!==s&&this.handler.dispatchToElement(new Ft(s,t),"dragleave",t.event),a&&a!==s&&this.handler.dispatchToElement(new Ft(a,t),"dragenter",t.event))}},t.prototype._dragEnd=function(t){var e=this._draggingTarget;e&&(e.dragging=!1),this.handler.dispatchToElement(new Ft(e,t),"dragend",t.event),this._dropTarget&&this.handler.dispatchToElement(new Ft(this._dropTarget,t),"drop",t.event),this._draggingTarget=null,this._dropTarget=null},t}(),Ut=function(){function t(t){t&&(this._$eventProcessor=t)}return t.prototype.on=function(t,e,i,n){this._$handlers||(this._$handlers={});var r=this._$handlers;if("function"==typeof e&&(n=i,i=e,e=null),!i||!t)return this;var o=this._$eventProcessor;null!=e&&o&&o.normalizeQuery&&(e=o.normalizeQuery(e)),r[t]||(r[t]=[]);for(var a=0;a<r[t].length;a++)if(r[t][a].h===i)return this;var s={h:i,query:e,ctx:n||this,callAtLast:i.zrEventfulCallAtLast},l=r[t].length-1,u=r[t][l];return u&&u.callAtLast?r[t].splice(l,0,s):r[t].push(s),this},t.prototype.isSilent=function(t){var e=this._$handlers;return!e||!e[t]||!e[t].length},t.prototype.off=function(t,e){var i=this._$handlers;if(!i)return this;if(!t)return this._$handlers={},this;if(e){if(i[t]){for(var n=[],r=0,o=i[t].length;r<o;r++)i[t][r].h!==e&&n.push(i[t][r]);i[t]=n}i[t]&&0===i[t].length&&delete i[t]}else delete i[t];return this},t.prototype.trigger=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(!this._$handlers)return this;var n=this._$handlers[t],r=this._$eventProcessor;if(n)for(var o=e.length,a=n.length,s=0;s<a;s++){var l=n[s];if(!r||!r.filter||null==l.query||r.filter(t,l.query))switch(o){case 0:l.h.call(l.ctx);break;case 1:l.h.call(l.ctx,e[0]);break;case 2:l.h.call(l.ctx,e[0],e[1]);break;default:l.h.apply(l.ctx,e)}}return r&&r.afterTrigger&&r.afterTrigger(t),this},t.prototype.triggerWithContext=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(!this._$handlers)return this;var n=this._$handlers[t],r=this._$eventProcessor;if(n)for(var o=e.length,a=e[o-1],s=n.length,l=0;l<s;l++){var u=n[l];if(!r||!r.filter||null==u.query||r.filter(t,u.query))switch(o){case 0:u.h.call(a);break;case 1:u.h.call(a,e[0]);break;case 2:u.h.call(a,e[0],e[1]);break;default:u.h.apply(a,e.slice(1,o-1))}}return r&&r.afterTrigger&&r.afterTrigger(t),this},t}(),Gt=Math.log(2);function $t(t,e,i,n,r,o){var a=n+"-"+r,s=t.length;if(o.hasOwnProperty(a))return o[a];if(1===e){var l=Math.round(Math.log((1<<s)-1&~r)/Gt);return t[i][l]}for(var u=n|1<<i,c=i+1;n&1<<c;)c++;for(var h=0,p=0,d=0;p<s;p++){var f=1<<p;f&r||(h+=(d%2?-1:1)*t[i][p]*$t(t,e-1,c,u,r|f,o),d++)}return o[a]=h,h}function Wt(t,e){var i=[[t[0],t[1],1,0,0,0,-e[0]*t[0],-e[0]*t[1]],[0,0,0,t[0],t[1],1,-e[1]*t[0],-e[1]*t[1]],[t[2],t[3],1,0,0,0,-e[2]*t[2],-e[2]*t[3]],[0,0,0,t[2],t[3],1,-e[3]*t[2],-e[3]*t[3]],[t[4],t[5],1,0,0,0,-e[4]*t[4],-e[4]*t[5]],[0,0,0,t[4],t[5],1,-e[5]*t[4],-e[5]*t[5]],[t[6],t[7],1,0,0,0,-e[6]*t[6],-e[6]*t[7]],[0,0,0,t[6],t[7],1,-e[7]*t[6],-e[7]*t[7]]],n={},r=$t(i,8,0,0,0,n);if(0!==r){for(var o=[],a=0;a<8;a++)for(var s=0;s<8;s++)null==o[s]&&(o[s]=0),o[s]+=((a+s)%2?-1:1)*$t(i,7,0===a?1:0,1<<a,1<<s,n)/r*e[a];return function(t,e,i){var n=e*o[6]+i*o[7]+1;t[0]=(e*o[0]+i*o[1]+o[2])/n,t[1]=(e*o[3]+i*o[4]+o[5])/n}}}var Ht=[];function jt(t,e,i,n,r){if(e.getBoundingClientRect&&a.domSupported&&!Zt(e)){var o=e.___zrEVENTSAVED||(e.___zrEVENTSAVED={}),s=function(t,e,i){for(var n=i?"invTrans":"trans",r=e[n],o=e.srcCoords,a=[],s=[],l=!0,u=0;u<4;u++){var c=t[u].getBoundingClientRect(),h=2*u,p=c.left,d=c.top;a.push(p,d),l=l&&o&&p===o[h]&&d===o[h+1],s.push(t[u].offsetLeft,t[u].offsetTop)}return l&&r?r:(e.srcCoords=a,e[n]=i?Wt(s,a):Wt(a,s))}(function(t,e){var i=e.markers;if(i)return i;i=e.markers=[];for(var n=["left","right"],r=["top","bottom"],o=0;o<4;o++){var a=document.createElement("div"),s=o%2,l=(o>>1)%2;a.style.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",n[s]+":0",r[l]+":0",n[1-s]+":auto",r[1-l]+":auto",""].join("!important;"),t.appendChild(a),i.push(a)}return i}(e,o),o,r);if(s)return s(t,i,n),!0}return!1}function Zt(t){return"CANVAS"===t.nodeName.toUpperCase()}var qt="undefined"!=typeof window&&!!window.addEventListener,Xt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Yt=[];function Kt(t,e,i,n){return i=i||{},n||!a.canvasSupported?Jt(t,e,i):a.browser.firefox&&a.browser.version<"39"&&null!=e.layerX&&e.layerX!==e.offsetX?(i.zrX=e.layerX,i.zrY=e.layerY):null!=e.offsetX?(i.zrX=e.offsetX,i.zrY=e.offsetY):Jt(t,e,i),i}function Jt(t,e,i){if(a.domSupported&&t.getBoundingClientRect){var n=e.clientX,r=e.clientY;if(Zt(t)){var o=t.getBoundingClientRect();return i.zrX=n-o.left,void(i.zrY=r-o.top)}if(jt(Yt,t,n,r))return i.zrX=Yt[0],void(i.zrY=Yt[1])}i.zrX=i.zrY=0}function Qt(t){return t||window.event}function te(t,e,i){if(null!=(e=Qt(e)).zrX)return e;var n=e.type;if(n&&n.indexOf("touch")>=0){var r="touchend"!==n?e.targetTouches[0]:e.changedTouches[0];r&&Kt(t,r,e,i)}else{Kt(t,e,e,i);var o=function(t){var e=t.wheelDelta;if(e)return e;var i=t.deltaX,n=t.deltaY;return null==i||null==n?e:3*Math.abs(0!==n?n:i)*(n>0?-1:n<0?1:i>0?-1:1)}(e);e.zrDelta=o?o/120:-(e.detail||0)/3}var a=e.button;return null==e.which&&void 0!==a&&Xt.test(e.type)&&(e.which=1&a?1:2&a?3:4&a?2:0),e}function ee(t,e,i,n){qt?t.addEventListener(e,i,n):t.attachEvent("on"+e,i)}var ie=qt?function(t){t.preventDefault(),t.stopPropagation(),t.cancelBubble=!0}:function(t){t.returnValue=!1,t.cancelBubble=!0};function ne(t){return 2===t.which||3===t.which}var re=function(){function t(){this._track=[]}return t.prototype.recognize=function(t,e,i){return this._doTrack(t,e,i),this._recognize(t)},t.prototype.clear=function(){return this._track.length=0,this},t.prototype._doTrack=function(t,e,i){var n=t.touches;if(n){for(var r={points:[],touches:[],target:e,event:t},o=0,a=n.length;o<a;o++){var s=n[o],l=Kt(i,s,{});r.points.push([l.zrX,l.zrY]),r.touches.push(s)}this._track.push(r)}},t.prototype._recognize=function(t){for(var e in ae)if(ae.hasOwnProperty(e)){var i=ae[e](this._track,t);if(i)return i}},t}();function oe(t){var e=t[1][0]-t[0][0],i=t[1][1]-t[0][1];return Math.sqrt(e*e+i*i)}var ae={pinch:function(t,e){var i=t.length;if(i){var n,r=(t[i-1]||{}).points,o=(t[i-2]||{}).points||r;if(o&&o.length>1&&r&&r.length>1){var a=oe(r)/oe(o);!isFinite(a)&&(a=1),e.pinchScale=a;var s=[((n=r)[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2];return e.pinchX=s[0],e.pinchY=s[1],{type:"pinch",target:t[0].target,event:e}}}}},se="silent";function le(){ie(this.event)}var ue=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.handler=null,e}return i(e,t),e.prototype.dispose=function(){},e.prototype.setCursor=function(){},e}(Ut),ce=function(t,e){this.x=t,this.y=e},he=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],pe=function(t){function e(e,i,n,r){var o=t.call(this)||this;return o._hovered=new ce(0,0),o.storage=e,o.painter=i,o.painterRoot=r,n=n||new ue,o.proxy=null,o.setHandlerProxy(n),o._draggingMgr=new Vt(o),o}return i(e,t),e.prototype.setHandlerProxy=function(t){this.proxy&&this.proxy.dispose(),t&&(L(he,function(e){t.on&&t.on(e,this[e],this)},this),t.handler=this),this.proxy=t},e.prototype.mousemove=function(t){var e=t.zrX,i=t.zrY,n=fe(this,e,i),r=this._hovered,o=r.target;o&&!o.__zr&&(o=(r=this.findHover(r.x,r.y)).target);var a=this._hovered=n?new ce(e,i):this.findHover(e,i),s=a.target,l=this.proxy;l.setCursor&&l.setCursor(s?s.cursor:"default"),o&&s!==o&&this.dispatchToElement(r,"mouseout",t),this.dispatchToElement(a,"mousemove",t),s&&s!==o&&this.dispatchToElement(a,"mouseover",t)},e.prototype.mouseout=function(t){var e=t.zrEventControl;"only_globalout"!==e&&this.dispatchToElement(this._hovered,"mouseout",t),"no_globalout"!==e&&this.trigger("globalout",{type:"globalout",event:t})},e.prototype.resize=function(){this._hovered=new ce(0,0)},e.prototype.dispatch=function(t,e){var i=this[t];i&&i.call(this,e)},e.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},e.prototype.setCursorStyle=function(t){var e=this.proxy;e.setCursor&&e.setCursor(t)},e.prototype.dispatchToElement=function(t,e,i){var n=(t=t||{}).target;if(!n||!n.silent){for(var r="on"+e,o=function(t,e,i){return{type:t,event:i,target:e.target,topTarget:e.topTarget,cancelBubble:!1,offsetX:i.zrX,offsetY:i.zrY,gestureEvent:i.gestureEvent,pinchX:i.pinchX,pinchY:i.pinchY,pinchScale:i.pinchScale,wheelDelta:i.zrDelta,zrByTouch:i.zrByTouch,which:i.which,stop:le}}(e,t,i);n&&(n[r]&&(o.cancelBubble=!!n[r].call(n,o)),n.trigger(e,o),n=n.__hostTarget?n.__hostTarget:n.parent,!o.cancelBubble););o.cancelBubble||(this.trigger(e,o),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(t){"function"==typeof t[r]&&t[r].call(t,o),t.trigger&&t.trigger(e,o)}))}},e.prototype.findHover=function(t,e,i){for(var n=this.storage.getDisplayList(),r=new ce(t,e),o=n.length-1;o>=0;o--){var a=void 0;if(n[o]!==i&&!n[o].ignore&&(a=de(n[o],t,e))&&(!r.topTarget&&(r.topTarget=n[o]),a!==se)){r.target=n[o];break}}return r},e.prototype.processGesture=function(t,e){this._gestureMgr||(this._gestureMgr=new re);var i=this._gestureMgr;"start"===e&&i.clear();var n=i.recognize(t,this.findHover(t.zrX,t.zrY,null).target,this.proxy.dom);if("end"===e&&i.clear(),n){var r=n.type;t.gestureEvent=r;var o=new ce;o.target=n.target,this.dispatchToElement(o,r,n.event)}},e}(Ut);function de(t,e,i){if(t[t.rectHover?"rectContain":"contain"](e,i)){for(var n=t,r=void 0,o=!1;n;){if(n.ignoreClip&&(o=!0),!o){var a=n.getClipPath();if(a&&!a.contain(e,i))return!1;n.silent&&(r=!0)}var s;n=n.__hostTarget||n.parent}return!r||se}return!1}function fe(t,e,i){var n=t.painter;return e<0||e>n.getWidth()||i<0||i>n.getHeight()}function me(t,e,i,n){var r=e+1;if(r===i)return 1;if(n(t[r++],t[e])<0){for(;r<i&&n(t[r],t[r-1])<0;)r++;!function(t,e,i){for(i--;e<i;){var n=t[e];t[e++]=t[i],t[i--]=n}}(t,e,r)}else for(;r<i&&n(t[r],t[r-1])>=0;)r++;return r-e}function ge(t,e,i,n,r){for(n===e&&n++;n<i;n++){for(var o,a=t[n],s=e,l=n;s<l;)r(a,t[o=s+l>>>1])<0?l=o:s=o+1;var u=n-s;switch(u){case 3:t[s+3]=t[s+2];case 2:t[s+2]=t[s+1];case 1:t[s+1]=t[s];break;default:for(;u>0;)t[s+u]=t[s+u-1],u--}t[s]=a}}function ye(t,e,i,n,r,o){var a=0,s=0,l=1;if(o(t,e[i+r])>0){for(s=n-r;l<s&&o(t,e[i+r+l])>0;)a=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s),a+=r,l+=r}else{for(s=r+1;l<s&&o(t,e[i+r-l])<=0;)a=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s);var u=a;a=r-l,l=r-u}for(a++;a<l;){var c=a+(l-a>>>1);o(t,e[i+c])>0?a=c+1:l=c}return l}function ve(t,e,i,n,r,o){var a=0,s=0,l=1;if(o(t,e[i+r])<0){for(s=r+1;l<s&&o(t,e[i+r-l])<0;)a=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s);var u=a;a=r-l,l=r-u}else{for(s=n-r;l<s&&o(t,e[i+r+l])>=0;)a=l,(l=1+(l<<1))<=0&&(l=s);l>s&&(l=s),a+=r,l+=r}for(a++;a<l;){var c=a+(l-a>>>1);o(t,e[i+c])<0?l=c:a=c+1}return l}function _e(t,e){var i,n,r=7,o=0;t.length;var a=[];function s(s){var l=i[s],u=n[s],c=i[s+1],h=n[s+1];n[s]=u+h,s===o-3&&(i[s+1]=i[s+2],n[s+1]=n[s+2]),o--;var p=ve(t[c],t,l,u,0,e);l+=p,0!=(u-=p)&&0!==(h=ye(t[l+u-1],t,c,h,h-1,e))&&(u<=h?function(i,n,o,s){var l=0;for(l=0;l<n;l++)a[l]=t[i+l];var u=0,c=o,h=i;if(t[h++]=t[c++],0!=--s)if(1!==n){for(var p,d,f,m=r;;){p=0,d=0,f=!1;do{if(e(t[c],a[u])<0){if(t[h++]=t[c++],d++,p=0,0==--s){f=!0;break}}else if(t[h++]=a[u++],p++,d=0,1==--n){f=!0;break}}while((p|d)<m);if(f)break;do{if(0!==(p=ve(t[c],a,u,n,0,e))){for(l=0;l<p;l++)t[h+l]=a[u+l];if(h+=p,u+=p,(n-=p)<=1){f=!0;break}}if(t[h++]=t[c++],0==--s){f=!0;break}if(0!==(d=ye(a[u],t,c,s,0,e))){for(l=0;l<d;l++)t[h+l]=t[c+l];if(h+=d,c+=d,0==(s-=d)){f=!0;break}}if(t[h++]=a[u++],1==--n){f=!0;break}m--}while(p>=7||d>=7);if(f)break;m<0&&(m=0),m+=2}if((r=m)<1&&(r=1),1===n){for(l=0;l<s;l++)t[h+l]=t[c+l];t[h+s]=a[u]}else{if(0===n)throw Error();for(l=0;l<n;l++)t[h+l]=a[u+l]}}else{for(l=0;l<s;l++)t[h+l]=t[c+l];t[h+s]=a[u]}else for(l=0;l<n;l++)t[h+l]=a[u+l]}(l,u,c,h):function(i,n,o,s){var l=0;for(l=0;l<s;l++)a[l]=t[o+l];var u=i+n-1,c=s-1,h=o+s-1,p=0,d=0;if(t[h--]=t[u--],0!=--n)if(1!==s){for(var f=r;;){var m=0,g=0,y=!1;do{if(e(a[c],t[u])<0){if(t[h--]=t[u--],m++,g=0,0==--n){y=!0;break}}else if(t[h--]=a[c--],g++,m=0,1==--s){y=!0;break}}while((m|g)<f);if(y)break;do{if(0!=(m=n-ve(a[c],t,i,n,n-1,e))){for(n-=m,d=1+(h-=m),p=1+(u-=m),l=m-1;l>=0;l--)t[d+l]=t[p+l];if(0===n){y=!0;break}}if(t[h--]=a[c--],1==--s){y=!0;break}if(0!=(g=s-ye(t[u],a,0,s,s-1,e))){for(s-=g,d=1+(h-=g),p=1+(c-=g),l=0;l<g;l++)t[d+l]=a[p+l];if(s<=1){y=!0;break}}if(t[h--]=t[u--],0==--n){y=!0;break}f--}while(m>=7||g>=7);if(y)break;f<0&&(f=0),f+=2}if((r=f)<1&&(r=1),1===s){for(d=1+(h-=n),p=1+(u-=n),l=n-1;l>=0;l--)t[d+l]=t[p+l];t[h]=a[c]}else{if(0===s)throw Error();for(p=h-(s-1),l=0;l<s;l++)t[p+l]=a[l]}}else{for(d=1+(h-=n),p=1+(u-=n),l=n-1;l>=0;l--)t[d+l]=t[p+l];t[h]=a[c]}else for(p=h-(s-1),l=0;l<s;l++)t[p+l]=a[l]}(l,u,c,h))}return i=[],n=[],{mergeRuns:function(){for(;o>1;){var t=o-2;if(t>=1&&n[t-1]<=n[t]+n[t+1]||t>=2&&n[t-2]<=n[t]+n[t-1])n[t-1]<n[t+1]&&t--;else if(n[t]>n[t+1])break;s(t)}},forceMergeRuns:function(){for(;o>1;){var t=o-2;t>0&&n[t-1]<n[t+1]&&t--,s(t)}},pushRun:function(t,e){i[o]=t,n[o]=e,o+=1}}}function xe(t,e,i,n){i||(i=0),n||(n=t.length);var r=n-i;if(!(r<2)){var o=0;if(r<32)ge(t,i,n,i+(o=me(t,i,n,e)),e);else{var a=_e(t,e),s=function(t){for(var e=0;t>=32;)e|=1&t,t>>=1;return t+e}(r);do{if((o=me(t,i,n,e))<s){var l=r;l>s&&(l=s),ge(t,i,i+l,i+o,e),o=l}a.pushRun(i,o),a.mergeRuns(),r-=o,i+=o}while(0!==r);a.forceMergeRuns()}}}L(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(t){pe.prototype[t]=function(e){var i,n,r=e.zrX,o=e.zrY,a=fe(this,r,o);if("mouseup"===t&&a||(n=(i=this.findHover(r,o)).target),"mousedown"===t)this._downEl=n,this._downPoint=[e.zrX,e.zrY],this._upEl=n;else if("mouseup"===t)this._upEl=n;else if("click"===t){if(this._downEl!==this._upEl||!this._downPoint||Et(this._downPoint,[e.zrX,e.zrY])>4)return;this._downPoint=null}this.dispatchToElement(i,t,e)}});var be=!1;function we(){be||(be=!0,console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"))}function Se(t,e){return t.zlevel===e.zlevel?t.z===e.z?t.z2-e.z2:t.z-e.z:t.zlevel-e.zlevel}var Te=function(){function t(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=Se}return t.prototype.traverse=function(t,e){for(var i=0;i<this._roots.length;i++)this._roots[i].traverse(t,e)},t.prototype.getDisplayList=function(t,e){e=e||!1;var i=this._displayList;return!t&&i.length||this.updateDisplayList(e),i},t.prototype.updateDisplayList=function(t){this._displayListLen=0;for(var e=this._roots,i=this._displayList,n=0,r=e.length;n<r;n++)this._updateAndAddDisplayable(e[n],null,t);i.length=this._displayListLen,a.canvasSupported&&xe(i,Se)},t.prototype._updateAndAddDisplayable=function(t,e,i){if(!t.ignore||i){t.beforeUpdate(),t.update(),t.afterUpdate();var n=t.getClipPath();if(t.ignoreClip)e=null;else if(n){e=e?e.slice():[];for(var r=n,o=t;r;)r.parent=o,r.updateTransform(),e.push(r),o=r,r=r.getClipPath()}if(t.childrenRef){for(var a=t.childrenRef(),s=0;s<a.length;s++){var l=a[s];t.__dirty&&(l.__dirty|=1),this._updateAndAddDisplayable(l,e,i)}t.__dirty=0}else{var u=t;e&&e.length?u.__clipPaths=e:u.__clipPaths&&u.__clipPaths.length>0&&(u.__clipPaths=[]),isNaN(u.z)&&(we(),u.z=0),isNaN(u.z2)&&(we(),u.z2=0),isNaN(u.zlevel)&&(we(),u.zlevel=0),this._displayList[this._displayListLen++]=u}var c=t.getDecalElement&&t.getDecalElement();c&&this._updateAndAddDisplayable(c,e,i);var h=t.getTextGuideLine();h&&this._updateAndAddDisplayable(h,e,i);var p=t.getTextContent();p&&this._updateAndAddDisplayable(p,e,i)}},t.prototype.addRoot=function(t){t.__zr&&t.__zr.storage===this||this._roots.push(t)},t.prototype.delRoot=function(t){if(t instanceof Array)for(var e=0,i=t.length;e<i;e++)this.delRoot(t[e]);else{var n=k(this._roots,t);n>=0&&this._roots.splice(n,1)}},t.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},t.prototype.getRoots=function(){return this._roots},t.prototype.dispose=function(){this._displayList=null,this._roots=null},t}(),Me="undefined"!=typeof window&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(t){return setTimeout(t,16)},Ie={linear:function(t){return t},quadraticIn:function(t){return t*t},quadraticOut:function(t){return t*(2-t)},quadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},quarticIn:function(t){return t*t*t*t},quarticOut:function(t){return 1- --t*t*t*t},quarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},quinticIn:function(t){return t*t*t*t*t},quinticOut:function(t){return--t*t*t*t*t+1},quinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},sinusoidalIn:function(t){return 1-Math.cos(t*Math.PI/2)},sinusoidalOut:function(t){return Math.sin(t*Math.PI/2)},sinusoidalInOut:function(t){return.5*(1-Math.cos(Math.PI*t))},exponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},exponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},exponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},circularIn:function(t){return 1-Math.sqrt(1-t*t)},circularOut:function(t){return Math.sqrt(1- --t*t)},circularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*(t-=1))*Math.sin(2*Math.PI*(t-e)/.4))},elasticOut:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin(2*Math.PI*(t-e)/.4)+1)},elasticInOut:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=n*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?i*Math.pow(2,10*(t-=1))*Math.sin(2*Math.PI*(t-e)/n)*-.5:i*Math.pow(2,-10*(t-=1))*Math.sin(2*Math.PI*(t-e)/n)*.5+1)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},backInOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)},bounceIn:function(t){return 1-Ie.bounceOut(1-t)},bounceOut:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bounceInOut:function(t){return t<.5?.5*Ie.bounceIn(2*t):.5*Ie.bounceOut(2*t-1)+.5}},Ce=function(){function t(t){this._initialized=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=t.life||1e3,this._delay=t.delay||0,this.loop=null!=t.loop&&t.loop,this.gap=t.gap||0,this.easing=t.easing||"linear",this.onframe=t.onframe,this.ondestroy=t.ondestroy,this.onrestart=t.onrestart}return t.prototype.step=function(t,e){if(this._initialized||(this._startTime=t+this._delay,this._initialized=!0),!this._paused){var i=(t-this._startTime-this._pausedTime)/this._life;i<0&&(i=0),i=Math.min(i,1);var n=this.easing,r="string"==typeof n?Ie[n]:n,o="function"==typeof r?r(i):i;if(this.onframe&&this.onframe(o),1===i){if(!this.loop)return!0;this._restart(t),this.onrestart&&this.onrestart()}return!1}this._pausedTime+=e},t.prototype._restart=function(t){var e=(t-this._startTime-this._pausedTime)%this._life;this._startTime=t-e+this.gap,this._pausedTime=0},t.prototype.pause=function(){this._paused=!0},t.prototype.resume=function(){this._paused=!1},t}(),Ae=function(t){this.value=t},ke=function(){function t(){this._len=0}return t.prototype.insert=function(t){var e=new Ae(t);return this.insertEntry(e),e},t.prototype.insertEntry=function(t){this.head?(this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++},t.prototype.remove=function(t){var e=t.prev,i=t.next;e?e.next=i:this.head=i,i?i.prev=e:this.tail=e,t.next=t.prev=null,this._len--},t.prototype.len=function(){return this._len},t.prototype.clear=function(){this.head=this.tail=null,this._len=0},t}(),De=function(){function t(t){this._list=new ke,this._maxSize=10,this._map={},this._maxSize=t}return t.prototype.put=function(t,e){var i=this._list,n=this._map,r=null;if(null==n[t]){var o=i.len(),a=this._lastRemovedEntry;if(o>=this._maxSize&&o>0){var s=i.head;i.remove(s),delete n[s.key],r=s.value,this._lastRemovedEntry=s}a?a.value=e:a=new Ae(e),a.key=t,i.insertEntry(a),n[t]=a}return r},t.prototype.get=function(t){var e=this._map[t],i=this._list;if(null!=e)return e!==i.tail&&(i.remove(e),i.insertEntry(e)),e.value},t.prototype.clear=function(){this._list.clear(),this._map={}},t.prototype.len=function(){return this._list.len()},t}(),Ee={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Pe(t){return(t=Math.round(t))<0?0:t>255?255:t}function Le(t){return t<0?0:t>1?1:t}function ze(t){var e=t;return e.length&&"%"===e.charAt(e.length-1)?Pe(parseFloat(e)/100*255):Pe(parseInt(e,10))}function Oe(t){var e=t;return e.length&&"%"===e.charAt(e.length-1)?Le(parseFloat(e)/100):Le(parseFloat(e))}function Re(t,e,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}function Be(t,e,i){return t+(e-t)*i}function Ne(t,e,i,n,r){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t}function Fe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}var Ve=new De(20),Ue=null,Ge,$e;function We(t,e){Ue&&Fe(Ue,e),Ue=Ve.put(t,Ue||e.slice())}function He(t,e){if(t){e=e||[];var i=Ve.get(t);if(i)return Fe(e,i);var n=(t+="").replace(/ /g,"").toLowerCase();if(n in Ee)return Fe(e,Ee[n]),We(t,e),e;var r,o=n.length;if("#"===n.charAt(0))return 4===o||5===o?(r=parseInt(n.slice(1,4),16))>=0&&r<=4095?(Ne(e,(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,5===o?parseInt(n.slice(4),16)/15:1),We(t,e),e):void Ne(e,0,0,0,1):7===o||9===o?(r=parseInt(n.slice(1,7),16))>=0&&r<=16777215?(Ne(e,(16711680&r)>>16,(65280&r)>>8,255&r,9===o?parseInt(n.slice(7),16)/255:1),We(t,e),e):void Ne(e,0,0,0,1):void 0;var a=n.indexOf("("),s=n.indexOf(")");if(-1!==a&&s+1===o){var l=n.substr(0,a),u=n.substr(a+1,s-(a+1)).split(","),c=1;switch(l){case"rgba":if(4!==u.length)return 3===u.length?Ne(e,+u[0],+u[1],+u[2],1):Ne(e,0,0,0,1);c=Oe(u.pop());case"rgb":return 3!==u.length?void Ne(e,0,0,0,1):(Ne(e,ze(u[0]),ze(u[1]),ze(u[2]),c),We(t,e),e);case"hsla":return 4!==u.length?void Ne(e,0,0,0,1):(u[3]=Oe(u[3]),je(u,e),We(t,e),e);case"hsl":return 3!==u.length?void Ne(e,0,0,0,1):(je(u,e),We(t,e),e);default:return}}Ne(e,0,0,0,1)}}function je(t,e){var i=(parseFloat(t[0])%360+360)%360/360,n=Oe(t[1]),r=Oe(t[2]),o=r<=.5?r*(n+1):r+n-r*n,a=2*r-o;return Ne(e=e||[],Pe(255*Re(a,o,i+1/3)),Pe(255*Re(a,o,i)),Pe(255*Re(a,o,i-1/3)),1),4===t.length&&(e[3]=t[3]),e}function Ze(t,e){var i=He(t);if(i){for(var n=0;n<3;n++)i[n]=e<0?i[n]*(1-e)|0:(255-i[n])*e+i[n]|0,i[n]>255?i[n]=255:i[n]<0&&(i[n]=0);return Qe(i,4===i.length?"rgba":"rgb")}}function qe(t){var e=He(t);if(e)return((1<<24)+(e[0]<<16)+(e[1]<<8)+ +e[2]).toString(16).slice(1)}function Xe(t,e,i){if(e&&e.length&&t>=0&&t<=1){i=i||[];var n=t*(e.length-1),r=Math.floor(n),o=Math.ceil(n),a=e[r],s=e[o],l=n-r;return i[0]=Pe(Be(a[0],s[0],l)),i[1]=Pe(Be(a[1],s[1],l)),i[2]=Pe(Be(a[2],s[2],l)),i[3]=Le(Be(a[3],s[3],l)),i}}function Ye(t,e,i){if(e&&e.length&&t>=0&&t<=1){var n=t*(e.length-1),r=Math.floor(n),o=Math.ceil(n),a=He(e[r]),s=He(e[o]),l=n-r,u=Qe([Pe(Be(a[0],s[0],l)),Pe(Be(a[1],s[1],l)),Pe(Be(a[2],s[2],l)),Le(Be(a[3],s[3],l))],"rgba");return i?{color:u,leftIndex:r,rightIndex:o,value:n}:u}}function Ke(t,e,i,n){var r=He(t);if(t)return r=function(t){if(t){var e,i,n=t[0]/255,r=t[1]/255,o=t[2]/255,a=Math.min(n,r,o),s=Math.max(n,r,o),l=s-a,u=(s+a)/2;if(0===l)e=0,i=0;else{i=u<.5?l/(s+a):l/(2-s-a);var c=((s-n)/6+l/2)/l,h=((s-r)/6+l/2)/l,p=((s-o)/6+l/2)/l;n===s?e=p-h:r===s?e=1/3+c-p:o===s&&(e=2/3+h-c),e<0&&(e+=1),e>1&&(e-=1)}var d=[360*e,i,u];return null!=t[3]&&d.push(t[3]),d}}(r),null!=e&&(r[0]=function(t){return(t=Math.round(t))<0?0:t>360?360:t}(e)),null!=i&&(r[1]=Oe(i)),null!=n&&(r[2]=Oe(n)),Qe(je(r),"rgba")}function Je(t,e){var i=He(t);if(i&&null!=e)return i[3]=Le(e),Qe(i,"rgba")}function Qe(t,e){if(t&&t.length){var i=t[0]+","+t[1]+","+t[2];return"rgba"!==e&&"hsva"!==e&&"hsla"!==e||(i+=","+t[3]),e+"("+i+")"}}function ti(t,e){var i=He(t);return i?(.299*i[0]+.587*i[1]+.114*i[2])*i[3]/255+(1-i[3])*e:0}var ei=Object.freeze({__proto__:null,parse:He,lift:Ze,toHex:qe,fastLerp:Xe,fastMapToColor:Xe,lerp:Ye,mapToColor:Ye,modifyHSL:Ke,modifyAlpha:Je,stringify:Qe,lum:ti,random:function(){return"rgb("+Math.round(255*Math.random())+","+Math.round(255*Math.random())+","+Math.round(255*Math.random())+")"}}),ii=Array.prototype.slice;function ni(t,e,i){return(e-t)*i+t}function ri(t,e,i,n){for(var r=e.length,o=0;o<r;o++)t[o]=ni(e[o],i[o],n)}function oi(t,e,i,n){for(var r=e.length,o=0;o<r;o++)t[o]=e[o]+i[o]*n;return t}function ai(t,e,i,n){for(var r=e.length,o=r&&e[0].length,a=0;a<r;a++){t[a]||(t[a]=[]);for(var s=0;s<o;s++)t[a][s]=e[a][s]+i[a][s]*n}return t}function si(t,e,i){var n=t,r=e;if(n.push&&r.push){var o=n.length,a=r.length;if(o!==a)if(o>a)n.length=a;else for(var s=o;s<a;s++)n.push(1===i?r[s]:ii.call(r[s]));var l=n[0]&&n[0].length;for(s=0;s<n.length;s++)if(1===i)isNaN(n[s])&&(n[s]=r[s]);else for(var u=0;u<l;u++)isNaN(n[s][u])&&(n[s][u]=r[s][u])}}function li(t,e){var i=t.length;if(i!==e.length)return!1;for(var n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function ui(t,e,i,n,r,o,a){var s=.5*(i-t),l=.5*(n-e);return(2*(e-i)+s+l)*a+(-3*(e-i)-2*s-l)*o+s*r+e}function ci(t,e,i,n,r,o,a,s){for(var l=e.length,u=0;u<l;u++)t[u]=ui(e[u],i[u],n[u],r[u],o,a,s)}function hi(t){if(P(t)){var e=t.length;if(P(t[0])){for(var i=[],n=0;n<e;n++)i.push(ii.call(t[n]));return i}return ii.call(t)}return t}function pi(t){return t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.floor(t[2]),"rgba("+t.join(",")+")"}var di,fi,mi=[0,0,0,0],gi=function(){function t(t){this.keyframes=[],this.maxTime=0,this.arrDim=0,this.interpolable=!0,this._needsSort=!1,this._isAllValueEqual=!0,this._lastFrame=0,this._lastFramePercent=0,this.propName=t}return t.prototype.isFinished=function(){return this._finished},t.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},t.prototype.needsAnimate=function(){return!this._isAllValueEqual&&this.keyframes.length>=2&&this.interpolable&&this.maxTime>0},t.prototype.getAdditiveTrack=function(){return this._additiveTrack},t.prototype.addKeyframe=function(t,e){t>=this.maxTime?this.maxTime=t:this._needsSort=!0;var i=this.keyframes,n=i.length;if(this.interpolable)if(P(e)){var r=function(t){return P(t&&t[0])?2:1}(e);if(n>0&&this.arrDim!==r)return void(this.interpolable=!1);if(1===r&&"number"!=typeof e[0]||2===r&&"number"!=typeof e[0][0])return void(this.interpolable=!1);if(n>0){var o=i[n-1];this._isAllValueEqual&&(1===r&&li(e,o.value)||(this._isAllValueEqual=!1))}this.arrDim=r}else{if(this.arrDim>0)return void(this.interpolable=!1);if("string"==typeof e){var a=He(e);a?(e=a,this.isValueColor=!0):this.interpolable=!1}else if("number"!=typeof e||isNaN(e))return void(this.interpolable=!1);this._isAllValueEqual&&n>0&&(o=i[n-1],(this.isValueColor&&!li(o.value,e)||o.value!==e)&&(this._isAllValueEqual=!1))}var s={time:t,value:e,percent:0};return this.keyframes.push(s),s},t.prototype.prepare=function(t){var e=this.keyframes;this._needsSort&&e.sort(function(t,e){return t.time-e.time});for(var i=this.arrDim,n=e.length,r=e[n-1],o=0;o<n;o++)e[o].percent=e[o].time/this.maxTime,i>0&&o!==n-1&&si(e[o].value,r.value,i);if(t&&this.needsAnimate()&&t.needsAnimate()&&i===t.arrDim&&this.isValueColor===t.isValueColor&&!t._finished){this._additiveTrack=t;var a=e[0].value;for(o=0;o<n;o++)0===i?this.isValueColor?e[o].additiveValue=oi([],e[o].value,a,-1):e[o].additiveValue=e[o].value-a:1===i?e[o].additiveValue=oi([],e[o].value,a,-1):2===i&&(e[o].additiveValue=ai([],e[o].value,a,-1))}},t.prototype.step=function(t,e){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var i,n=null!=this._additiveTrack,r=n?"additiveValue":"value",o=this.keyframes,a=this.keyframes.length,s=this.propName,l=this.arrDim,u=this.isValueColor;if(e<0)i=0;else if(e<this._lastFramePercent){for(i=Math.min(this._lastFrame+1,a-1);i>=0&&!(o[i].percent<=e);i--);i=Math.min(i,a-2)}else{for(i=this._lastFrame;i<a&&!(o[i].percent>e);i++);i=Math.min(i-1,a-2)}var c=o[i+1],h=o[i];if(h&&c){this._lastFrame=i,this._lastFramePercent=e;var p=c.percent-h.percent;if(0!==p){var d=(e-h.percent)/p,f=n?this._additiveValue:u?mi:t[s];if((l>0||u)&&!f&&(f=this._additiveValue=[]),this.useSpline){var m=o[i][r],g=o[0===i?i:i-1][r],y=o[i>a-2?a-1:i+1][r],v=o[i>a-3?a-1:i+2][r];if(l>0)1===l?ci(f,g,m,y,v,d,d*d,d*d*d):function(t,e,i,n,r,o,a,s){for(var l=e.length,u=e[0].length,c=0;c<l;c++){t[c]||(t[1]=[]);for(var h=0;h<u;h++)t[c][h]=ui(e[c][h],i[c][h],n[c][h],r[c][h],o,a,s)}}(f,g,m,y,v,d,d*d,d*d*d);else if(u)ci(f,g,m,y,v,d,d*d,d*d*d),n||(t[s]=pi(f));else{var _=void 0;_=this.interpolable?ui(g,m,y,v,d,d*d,d*d*d):y,n?this._additiveValue=_:t[s]=_}}else l>0?1===l?ri(f,h[r],c[r],d):function(t,e,i,n){for(var r=e.length,o=r&&e[0].length,a=0;a<r;a++){t[a]||(t[a]=[]);for(var s=0;s<o;s++)t[a][s]=ni(e[a][s],i[a][s],n)}}(f,h[r],c[r],d):u?(ri(f,h[r],c[r],d),n||(t[s]=pi(f))):(_=void 0,_=this.interpolable?ni(h[r],c[r],d):function(t,e,i){return i>.5?e:t}(h[r],c[r],d),n?this._additiveValue=_:t[s]=_);n&&this._addToTarget(t)}}}},t.prototype._addToTarget=function(t){var e=this.arrDim,i=this.propName,n=this._additiveValue;0===e?this.isValueColor?(He(t[i],mi),oi(mi,mi,n,1),t[i]=pi(mi)):t[i]=t[i]+n:1===e?oi(t[i],t[i],n,1):2===e&&ai(t[i],t[i],n,1)},t}(),yi=function(){function t(t,e,i){this._tracks={},this._trackKeys=[],this._delay=0,this._maxTime=0,this._paused=!1,this._started=0,this._clip=null,this._target=t,this._loop=e,e&&i?w("Can' use additive animation on looped animation."):this._additiveAnimators=i}return t.prototype.getTarget=function(){return this._target},t.prototype.changeTarget=function(t){this._target=t},t.prototype.when=function(t,e){return this.whenWithKeys(t,e,N(e))},t.prototype.whenWithKeys=function(t,e,i){for(var n=this._tracks,r=0;r<i.length;r++){var o=i[r],a=n[o];if(!a){a=n[o]=new gi(o);var s=void 0,l=this._getAdditiveTrack(o);if(l){var u=l.keyframes[l.keyframes.length-1];s=u&&u.value,l.isValueColor&&s&&(s=pi(s))}else s=this._target[o];if(null==s)continue;0!==t&&a.addKeyframe(0,hi(s)),this._trackKeys.push(o)}a.addKeyframe(t,hi(e[o]))}return this._maxTime=Math.max(this._maxTime,t),this},t.prototype.pause=function(){this._clip.pause(),this._paused=!0},t.prototype.resume=function(){this._clip.resume(),this._paused=!1},t.prototype.isPaused=function(){return!!this._paused},t.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var t=this._doneCbs;if(t)for(var e=t.length,i=0;i<e;i++)t[i].call(this)},t.prototype._abortedCallback=function(){this._setTracksFinished();var t=this.animation,e=this._abortedCbs;if(t&&t.removeClip(this._clip),this._clip=null,e)for(var i=0;i<e.length;i++)e[i].call(this)},t.prototype._setTracksFinished=function(){for(var t=this._tracks,e=this._trackKeys,i=0;i<e.length;i++)t[e[i]].setFinished()},t.prototype._getAdditiveTrack=function(t){var e,i=this._additiveAnimators;if(i)for(var n=0;n<i.length;n++){var r=i[n].getTrack(t);r&&(e=r)}return e},t.prototype.start=function(t,e){if(!(this._started>0)){this._started=1;for(var i=this,n=[],r=0;r<this._trackKeys.length;r++){var o=this._trackKeys[r],a=this._tracks[o],s=this._getAdditiveTrack(o),l=a.keyframes;if(a.prepare(s),a.needsAnimate())n.push(a);else if(!a.interpolable){var u=l[l.length-1];u&&(i._target[a.propName]=u.value)}}if(n.length||e){var c=new Ce({life:this._maxTime,loop:this._loop,delay:this._delay,onframe:function(t){i._started=2;var e=i._additiveAnimators;if(e){for(var r=!1,o=0;o<e.length;o++)if(e[o]._clip){r=!0;break}r||(i._additiveAnimators=null)}for(o=0;o<n.length;o++)n[o].step(i._target,t);var a=i._onframeCbs;if(a)for(o=0;o<a.length;o++)a[o](i._target,t)},ondestroy:function(){i._doneCallback()}});this._clip=c,this.animation&&this.animation.addClip(c),t&&"spline"!==t&&(c.easing=t)}else this._doneCallback();return this}},t.prototype.stop=function(t){if(this._clip){var e=this._clip;t&&e.onframe(1),this._abortedCallback()}},t.prototype.delay=function(t){return this._delay=t,this},t.prototype.during=function(t){return t&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(t)),this},t.prototype.done=function(t){return t&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(t)),this},t.prototype.aborted=function(t){return t&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(t)),this},t.prototype.getClip=function(){return this._clip},t.prototype.getTrack=function(t){return this._tracks[t]},t.prototype.stopTracks=function(t,e){if(!t.length||!this._clip)return!0;for(var i=this._tracks,n=this._trackKeys,r=0;r<t.length;r++){var o=i[t[r]];o&&(e?o.step(this._target,1):1===this._started&&o.step(this._target,0),o.setFinished())}var a=!0;for(r=0;r<n.length;r++)if(!i[n[r]].isFinished()){a=!1;break}return a&&this._abortedCallback(),a},t.prototype.saveFinalToTarget=function(t,e){if(t){e=e||this._trackKeys;for(var i=0;i<e.length;i++){var n=e[i],r=this._tracks[n];if(r&&!r.isFinished()){var o=r.keyframes,a=o[o.length-1];if(a){var s=hi(a.value);r.isValueColor&&(s=pi(s)),t[n]=s}}}}},t.prototype.__changeFinalValue=function(t,e){e=e||N(t);for(var i=0;i<e.length;i++){var n=e[i],r=this._tracks[n];if(r){var o=r.keyframes;if(o.length>1){var a=o.pop();r.addKeyframe(a.time,t[n]),r.prepare(r.getAdditiveTrack())}}}},t}(),vi=function(t){function e(e){var i=t.call(this)||this;return i._running=!1,i._time=0,i._pausedTime=0,i._pauseStart=0,i._paused=!1,e=e||{},i.stage=e.stage||{},i.onframe=e.onframe||function(){},i}return i(e,t),e.prototype.addClip=function(t){t.animation&&this.removeClip(t),this._clipsHead?(this._clipsTail.next=t,t.prev=this._clipsTail,t.next=null,this._clipsTail=t):this._clipsHead=this._clipsTail=t,t.animation=this},e.prototype.addAnimator=function(t){t.animation=this;var e=t.getClip();e&&this.addClip(e)},e.prototype.removeClip=function(t){if(t.animation){var e=t.prev,i=t.next;e?e.next=i:this._clipsHead=i,i?i.prev=e:this._clipsTail=e,t.next=t.prev=t.animation=null}},e.prototype.removeAnimator=function(t){var e=t.getClip();e&&this.removeClip(e),t.animation=null},e.prototype.update=function(t){for(var e=(new Date).getTime()-this._pausedTime,i=e-this._time,n=this._clipsHead;n;){var r=n.next;n.step(e,i)?(n.ondestroy&&n.ondestroy(),this.removeClip(n),n=r):n=r}this._time=e,t||(this.onframe(i),this.trigger("frame",i),this.stage.update&&this.stage.update())},e.prototype._startLoop=function(){var t=this;this._running=!0,Me(function e(){t._running&&(Me(e),!t._paused&&t.update())})},e.prototype.start=function(){this._running||(this._time=(new Date).getTime(),this._pausedTime=0,this._startLoop())},e.prototype.stop=function(){this._running=!1},e.prototype.pause=function(){this._paused||(this._pauseStart=(new Date).getTime(),this._paused=!0)},e.prototype.resume=function(){this._paused&&(this._pausedTime+=(new Date).getTime()-this._pauseStart,this._paused=!1)},e.prototype.clear=function(){for(var t=this._clipsHead;t;){var e=t.next;t.prev=t.next=t.animation=null,t=e}this._clipsHead=this._clipsTail=null},e.prototype.isFinished=function(){return null==this._clipsHead},e.prototype.animate=function(t,e){e=e||{},this.start();var i=new yi(t,e.loop);return this.addAnimator(i),i},e}(Ut),_i=a.domSupported,xi=(fi={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},{mouse:di=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],touch:["touchstart","touchend","touchmove"],pointer:z(di,function(t){var e=t.replace("mouse","pointer");return fi.hasOwnProperty(e)?e:t})}),bi=["mousemove","mouseup"],wi=["pointermove","pointerup"],Si=!1;function Ti(t){var e=t.pointerType;return"pen"===e||"touch"===e}function Mi(t){t&&(t.zrByTouch=!0)}function Ii(t,e){for(var i=e,n=!1;i&&9!==i.nodeType&&!(n=i.domBelongToZr||i!==e&&i===t.painterRoot);)i=i.parentNode;return n}var Ci=function(t,e){this.stopPropagation=mt,this.stopImmediatePropagation=mt,this.preventDefault=mt,this.type=e.type,this.target=this.currentTarget=t.dom,this.pointerType=e.pointerType,this.clientX=e.clientX,this.clientY=e.clientY},Ai={mousedown:function(t){t=te(this.dom,t),this.__mayPointerCapture=[t.zrX,t.zrY],this.trigger("mousedown",t)},mousemove:function(t){t=te(this.dom,t);var e=this.__mayPointerCapture;!e||t.zrX===e[0]&&t.zrY===e[1]||this.__togglePointerCapture(!0),this.trigger("mousemove",t)},mouseup:function(t){t=te(this.dom,t),this.__togglePointerCapture(!1),this.trigger("mouseup",t)},mouseout:function(t){Ii(this,(t=te(this.dom,t)).toElement||t.relatedTarget)||(this.__pointerCapturing&&(t.zrEventControl="no_globalout"),this.trigger("mouseout",t))},wheel:function(t){Si=!0,t=te(this.dom,t),this.trigger("mousewheel",t)},mousewheel:function(t){Si||(t=te(this.dom,t),this.trigger("mousewheel",t))},touchstart:function(t){Mi(t=te(this.dom,t)),this.__lastTouchMoment=new Date,this.handler.processGesture(t,"start"),Ai.mousemove.call(this,t),Ai.mousedown.call(this,t)},touchmove:function(t){Mi(t=te(this.dom,t)),this.handler.processGesture(t,"change"),Ai.mousemove.call(this,t)},touchend:function(t){Mi(t=te(this.dom,t)),this.handler.processGesture(t,"end"),Ai.mouseup.call(this,t),+new Date-+this.__lastTouchMoment<300&&Ai.click.call(this,t)},pointerdown:function(t){Ai.mousedown.call(this,t)},pointermove:function(t){Ti(t)||Ai.mousemove.call(this,t)},pointerup:function(t){Ai.mouseup.call(this,t)},pointerout:function(t){Ti(t)||Ai.mouseout.call(this,t)}};L(["click","dblclick","contextmenu"],function(t){Ai[t]=function(e){e=te(this.dom,e),this.trigger(t,e)}});var ki={pointermove:function(t){Ti(t)||ki.mousemove.call(this,t)},pointerup:function(t){ki.mouseup.call(this,t)},mousemove:function(t){this.trigger("mousemove",t)},mouseup:function(t){var e=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",t),e&&(t.zrEventControl="only_globalout",this.trigger("mouseout",t))}};function Di(t,e){var i=e.domHandlers;a.pointerEventsSupported?L(xi.pointer,function(n){Pi(e,n,function(e){i[n].call(t,e)})}):(a.touchEventsSupported&&L(xi.touch,function(n){Pi(e,n,function(r){i[n].call(t,r),function(t){t.touching=!0,null!=t.touchTimer&&(clearTimeout(t.touchTimer),t.touchTimer=null),t.touchTimer=setTimeout(function(){t.touching=!1,t.touchTimer=null},700)}(e)})}),L(xi.mouse,function(n){Pi(e,n,function(r){r=Qt(r),e.touching||i[n].call(t,r)})}))}function Ei(t,e){function i(i){Pi(e,i,function(n){n=Qt(n),Ii(t,n.target)||(n=function(t,e){return te(t.dom,new Ci(t,e),!0)}(t,n),e.domHandlers[i].call(t,n))},{capture:!0})}a.pointerEventsSupported?L(wi,i):a.touchEventsSupported||L(bi,i)}function Pi(t,e,i,n){t.mounted[e]=i,t.listenerOpts[e]=n,ee(t.domTarget,e,i,n)}function Li(t){var e,i,n,r,o=t.mounted;for(var a in o)o.hasOwnProperty(a)&&(e=t.domTarget,i=a,n=o[a],r=t.listenerOpts[a],qt?e.removeEventListener(i,n,r):e.detachEvent("on"+i,n));t.mounted={}}var zi=function(t,e){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=t,this.domHandlers=e},Oi=function(t){function e(e,i){var n=t.call(this)||this;return n.__pointerCapturing=!1,n.dom=e,n.painterRoot=i,n._localHandlerScope=new zi(e,Ai),_i&&(n._globalHandlerScope=new zi(document,ki)),Di(n,n._localHandlerScope),n}return i(e,t),e.prototype.dispose=function(){Li(this._localHandlerScope),_i&&Li(this._globalHandlerScope)},e.prototype.setCursor=function(t){this.dom.style&&(this.dom.style.cursor=t||"default")},e.prototype.__togglePointerCapture=function(t){if(this.__mayPointerCapture=null,_i&&+this.__pointerCapturing^+t){this.__pointerCapturing=t;var e=this._globalHandlerScope;t?Ei(this,e):Li(e)}},e}(Ut),Ri=1;"undefined"!=typeof window&&(Ri=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var Bi=Ri,Ni="#333",Fi="#ccc";function Vi(){return[1,0,0,1,0,0]}function Ui(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Gi(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function $i(t,e,i){var n=e[0]*i[0]+e[2]*i[1],r=e[1]*i[0]+e[3]*i[1],o=e[0]*i[2]+e[2]*i[3],a=e[1]*i[2]+e[3]*i[3],s=e[0]*i[4]+e[2]*i[5]+e[4],l=e[1]*i[4]+e[3]*i[5]+e[5];return t[0]=n,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t}function Wi(t,e,i){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4]+i[0],t[5]=e[5]+i[1],t}function Hi(t,e,i){var n=e[0],r=e[2],o=e[4],a=e[1],s=e[3],l=e[5],u=Math.sin(i),c=Math.cos(i);return t[0]=n*c+a*u,t[1]=-n*u+a*c,t[2]=r*c+s*u,t[3]=-r*u+c*s,t[4]=c*o+u*l,t[5]=c*l-u*o,t}function ji(t,e,i){var n=i[0],r=i[1];return t[0]=e[0]*n,t[1]=e[1]*r,t[2]=e[2]*n,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*r,t}function Zi(t,e){var i=e[0],n=e[2],r=e[4],o=e[1],a=e[3],s=e[5],l=i*a-o*n;return l?(l=1/l,t[0]=a*l,t[1]=-o*l,t[2]=-n*l,t[3]=i*l,t[4]=(n*s-a*r)*l,t[5]=(o*r-i*s)*l,t):null}function qi(t){var e=[1,0,0,1,0,0];return Gi(e,t),e}var Xi=Object.freeze({__proto__:null,create:Vi,identity:Ui,copy:Gi,mul:$i,translate:Wi,rotate:Hi,scale:ji,invert:Zi,clone:qi}),Yi=Ui,Ki=5e-5;function Ji(t){return t>Ki||t<-5e-5}var Qi,tn,en=[],nn=[],rn=[1,0,0,1,0,0],on=Math.abs,an=function(){function t(){}return t.prototype.getLocalTransform=function(e){return t.getLocalTransform(this,e)},t.prototype.setPosition=function(t){this.x=t[0],this.y=t[1]},t.prototype.setScale=function(t){this.scaleX=t[0],this.scaleY=t[1]},t.prototype.setSkew=function(t){this.skewX=t[0],this.skewY=t[1]},t.prototype.setOrigin=function(t){this.originX=t[0],this.originY=t[1]},t.prototype.needLocalTransform=function(){return Ji(this.rotation)||Ji(this.x)||Ji(this.y)||Ji(this.scaleX-1)||Ji(this.scaleY-1)},t.prototype.updateTransform=function(){var t=this.parent&&this.parent.transform,e=this.needLocalTransform(),i=this.transform;e||t?(i=i||[1,0,0,1,0,0],e?this.getLocalTransform(i):Yi(i),t&&(e?$i(i,t,i):Gi(i,t)),this.transform=i,this._resolveGlobalScaleRatio(i)):i&&Yi(i)},t.prototype._resolveGlobalScaleRatio=function(t){var e=this.globalScaleRatio;if(null!=e&&1!==e){this.getGlobalScale(en);var i=en[0]<0?-1:1,n=en[1]<0?-1:1,r=((en[0]-i)*e+i)/en[0]||0,o=((en[1]-n)*e+n)/en[1]||0;t[0]*=r,t[1]*=r,t[2]*=o,t[3]*=o}this.invTransform=this.invTransform||[1,0,0,1,0,0],Zi(this.invTransform,t)},t.prototype.getComputedTransform=function(){for(var t=this,e=[];t;)e.push(t),t=t.parent;for(;t=e.pop();)t.updateTransform();return this.transform},t.prototype.setLocalTransform=function(t){if(t){var e=t[0]*t[0]+t[1]*t[1],i=t[2]*t[2]+t[3]*t[3],n=Math.atan2(t[1],t[0]),r=Math.PI/2+n-Math.atan2(t[3],t[2]);i=Math.sqrt(i)*Math.cos(r),e=Math.sqrt(e),this.skewX=r,this.skewY=0,this.rotation=-n,this.x=+t[4],this.y=+t[5],this.scaleX=e,this.scaleY=i,this.originX=0,this.originY=0}},t.prototype.decomposeTransform=function(){if(this.transform){var t=this.parent,e=this.transform;t&&t.transform&&($i(nn,t.invTransform,e),e=nn);var i=this.originX,n=this.originY;(i||n)&&(rn[4]=i,rn[5]=n,$i(nn,e,rn),nn[4]-=i,nn[5]-=n,e=nn),this.setLocalTransform(e)}},t.prototype.getGlobalScale=function(t){var e=this.transform;return t=t||[],e?(t[0]=Math.sqrt(e[0]*e[0]+e[1]*e[1]),t[1]=Math.sqrt(e[2]*e[2]+e[3]*e[3]),e[0]<0&&(t[0]=-t[0]),e[3]<0&&(t[1]=-t[1]),t):(t[0]=1,t[1]=1,t)},t.prototype.transformCoordToLocal=function(t,e){var i=[t,e],n=this.invTransform;return n&&Ot(i,i,n),i},t.prototype.transformCoordToGlobal=function(t,e){var i=[t,e],n=this.transform;return n&&Ot(i,i,n),i},t.prototype.getLineScale=function(){var t=this.transform;return t&&on(t[0]-1)>1e-10&&on(t[3]-1)>1e-10?Math.sqrt(on(t[0]*t[3]-t[2]*t[1])):1},t.prototype.copyTransform=function(t){for(var e=0;e<sn.length;e++){var i=sn[e];this[i]=t[i]}},t.getLocalTransform=function(t,e){e=e||[];var i=t.originX||0,n=t.originY||0,r=t.scaleX,o=t.scaleY,a=t.rotation||0,s=t.x,l=t.y,u=t.skewX?Math.tan(t.skewX):0,c=t.skewY?Math.tan(-t.skewY):0;return i||n?(e[4]=-i*r-u*n*o,e[5]=-n*o-c*i*r):e[4]=e[5]=0,e[0]=r,e[3]=o,e[1]=c*r,e[2]=u*o,a&&Hi(e,e,a),e[4]+=i+s,e[5]+=n+l,e},t.initDefaultProps=((e=t.prototype).x=0,e.y=0,e.scaleX=1,e.scaleY=1,e.originX=0,e.originY=0,e.skewX=0,e.skewY=0,e.rotation=0,void(e.globalScaleRatio=1)),t;var e}(),sn=["x","y","originX","originY","rotation","scaleX","scaleY","skewX","skewY"],ln=function(){function t(t,e){this.x=t||0,this.y=e||0}return t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.set=function(t,e){return this.x=t,this.y=e,this},t.prototype.equal=function(t){return t.x===this.x&&t.y===this.y},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.scale=function(t){this.x*=t,this.y*=t},t.prototype.scaleAndAdd=function(t,e){this.x+=t.x*e,this.y+=t.y*e},t.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y},t.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},t.prototype.normalize=function(){var t=this.len();return this.x/=t,this.y/=t,this},t.prototype.distance=function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},t.prototype.distanceSquare=function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},t.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},t.prototype.transform=function(t){if(t){var e=this.x,i=this.y;return this.x=t[0]*e+t[2]*i+t[4],this.y=t[1]*e+t[3]*i+t[5],this}},t.prototype.toArray=function(t){return t[0]=this.x,t[1]=this.y,t},t.prototype.fromArray=function(t){this.x=t[0],this.y=t[1]},t.set=function(t,e,i){t.x=e,t.y=i},t.copy=function(t,e){t.x=e.x,t.y=e.y},t.len=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},t.lenSquare=function(t){return t.x*t.x+t.y*t.y},t.dot=function(t,e){return t.x*e.x+t.y*e.y},t.add=function(t,e,i){t.x=e.x+i.x,t.y=e.y+i.y},t.sub=function(t,e,i){t.x=e.x-i.x,t.y=e.y-i.y},t.scale=function(t,e,i){t.x=e.x*i,t.y=e.y*i},t.scaleAndAdd=function(t,e,i,n){t.x=e.x+i.x*n,t.y=e.y+i.y*n},t.lerp=function(t,e,i,n){var r=1-n;t.x=r*e.x+n*i.x,t.y=r*e.y+n*i.y},t}(),un=Math.min,cn=Math.max,hn=new ln,pn=new ln,dn=new ln,fn=new ln,mn=new ln,gn=new ln,yn=function(){function t(t,e,i,n){i<0&&(t+=i,i=-i),n<0&&(e+=n,n=-n),this.x=t,this.y=e,this.width=i,this.height=n}return t.prototype.union=function(t){var e=un(t.x,this.x),i=un(t.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=cn(t.x+t.width,this.x+this.width)-e:this.width=t.width,isFinite(this.y)&&isFinite(this.height)?this.height=cn(t.y+t.height,this.y+this.height)-i:this.height=t.height,this.x=e,this.y=i},t.prototype.applyTransform=function(e){t.applyTransform(this,this,e)},t.prototype.calculateTransform=function(t){var e=this,i=t.width/e.width,n=t.height/e.height,r=[1,0,0,1,0,0];return Wi(r,r,[-e.x,-e.y]),ji(r,r,[i,n]),Wi(r,r,[t.x,t.y]),r},t.prototype.intersect=function(e,i){if(!e)return!1;e instanceof t||(e=t.create(e));var n=this,r=n.x,o=n.x+n.width,a=n.y,s=n.y+n.height,l=e.x,u=e.x+e.width,c=e.y,h=e.y+e.height,p=!(o<l||u<r||s<c||h<a);if(i){var d=1/0,f=0,m=Math.abs(o-l),g=Math.abs(u-r),y=Math.abs(s-c),v=Math.abs(h-a),_=Math.min(m,g),x=Math.min(y,v);o<l||u<r?_>f&&(f=_,m<g?ln.set(gn,-m,0):ln.set(gn,g,0)):_<d&&(d=_,m<g?ln.set(mn,m,0):ln.set(mn,-g,0)),s<c||h<a?x>f&&(f=x,y<v?ln.set(gn,0,-y):ln.set(gn,0,v)):_<d&&(d=_,y<v?ln.set(mn,0,y):ln.set(mn,0,-v))}return i&&ln.copy(i,p?mn:gn),p},t.prototype.contain=function(t,e){var i=this;return t>=i.x&&t<=i.x+i.width&&e>=i.y&&e<=i.y+i.height},t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copy=function(e){t.copy(this,e)},t.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},t.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},t.prototype.isZero=function(){return 0===this.width||0===this.height},t.create=function(e){return new t(e.x,e.y,e.width,e.height)},t.copy=function(t,e){t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height},t.applyTransform=function(e,i,n){if(n){if(n[1]<1e-5&&n[1]>-1e-5&&n[2]<1e-5&&n[2]>-1e-5){var r=n[0],o=n[3],a=n[4],s=n[5];return e.x=i.x*r+a,e.y=i.y*o+s,e.width=i.width*r,e.height=i.height*o,e.width<0&&(e.x+=e.width,e.width=-e.width),void(e.height<0&&(e.y+=e.height,e.height=-e.height))}hn.x=dn.x=i.x,hn.y=fn.y=i.y,pn.x=fn.x=i.x+i.width,pn.y=dn.y=i.y+i.height,hn.transform(n),fn.transform(n),pn.transform(n),dn.transform(n),e.x=un(hn.x,pn.x,dn.x,fn.x),e.y=un(hn.y,pn.y,dn.y,fn.y);var l=cn(hn.x,pn.x,dn.x,fn.x),u=cn(hn.y,pn.y,dn.y,fn.y);e.width=l-e.x,e.height=u-e.y}else e!==i&&t.copy(e,i)},t}(),vn={},_n="12px sans-serif",xn={measureText:function(t,e){return Qi||(Qi=A().getContext("2d")),tn!==e&&(tn=Qi.font=e||_n),Qi.measureText(t)}};function bn(t,e){var i=vn[e=e||_n];i||(i=vn[e]=new De(500));var n=i.get(t);return null==n&&(n=xn.measureText(t,e).width,i.put(t,n)),n}function wn(t,e,i,n){var r=bn(t,e),o=In(e),a=Tn(0,r,i),s=Mn(0,o,n);return new yn(a,s,r,o)}function Sn(t,e,i,n){var r=((t||"")+"").split("\n");if(1===r.length)return wn(r[0],e,i,n);for(var o=new yn(0,0,0,0),a=0;a<r.length;a++){var s=wn(r[a],e,i,n);0===a?o.copy(s):o.union(s)}return o}function Tn(t,e,i){return"right"===i?t-=e:"center"===i&&(t-=e/2),t}function Mn(t,e,i){return"middle"===i?t-=e/2:"bottom"===i&&(t-=e),t}function In(t){return bn("国",t)}function Cn(t,e){return"string"==typeof t?t.lastIndexOf("%")>=0?parseFloat(t)/100*e:parseFloat(t):t}function An(t,e,i){var n=e.position||"inside",r=null!=e.distance?e.distance:5,o=i.height,a=i.width,s=o/2,l=i.x,u=i.y,c="left",h="top";if(n instanceof Array)l+=Cn(n[0],i.width),u+=Cn(n[1],i.height),c=null,h=null;else switch(n){case"left":l-=r,u+=s,c="right",h="middle";break;case"right":l+=r+a,u+=s,h="middle";break;case"top":l+=a/2,u-=r,c="center",h="bottom";break;case"bottom":l+=a/2,u+=o+r,c="center";break;case"inside":l+=a/2,u+=s,c="center",h="middle";break;case"insideLeft":l+=r,u+=s,h="middle";break;case"insideRight":l+=a-r,u+=s,c="right",h="middle";break;case"insideTop":l+=a/2,u+=r,c="center";break;case"insideBottom":l+=a/2,u+=o-r,c="center",h="bottom";break;case"insideTopLeft":l+=r,u+=r;break;case"insideTopRight":l+=a-r,u+=r,c="right";break;case"insideBottomLeft":l+=r,u+=o-r,h="bottom";break;case"insideBottomRight":l+=a-r,u+=o-r,c="right",h="bottom"}return(t=t||{}).x=l,t.y=u,t.align=c,t.verticalAlign=h,t}var kn="__zr_normal__",Dn=["x","y","scaleX","scaleY","originX","originY","rotation","ignore"],En={x:!0,y:!0,scaleX:!0,scaleY:!0,originX:!0,originY:!0,rotation:!0,ignore:!1},Pn={},Ln=new yn(0,0,0,0),zn=function(){function t(t){this.id=b(),this.animators=[],this.currentStates=[],this.states={},this._init(t)}return t.prototype._init=function(t){this.attr(t)},t.prototype.drift=function(t,e,i){switch(this.draggable){case"horizontal":e=0;break;case"vertical":t=0}var n=this.transform;n||(n=this.transform=[1,0,0,1,0,0]),n[4]+=t,n[5]+=e,this.decomposeTransform(),this.markRedraw()},t.prototype.beforeUpdate=function(){},t.prototype.afterUpdate=function(){},t.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},t.prototype.updateInnerText=function(t){var e=this._textContent;if(e&&(!e.ignore||t)){this.textConfig||(this.textConfig={});var i=this.textConfig,n=i.local,r=e.innerTransformable,o=void 0,a=void 0,s=!1;r.parent=n?this:null;var l=!1;if(r.copyTransform(e),null!=i.position){var u=Ln;i.layoutRect?u.copy(i.layoutRect):u.copy(this.getBoundingRect()),n||u.applyTransform(this.transform),this.calculateTextPosition?this.calculateTextPosition(Pn,i,u):An(Pn,i,u),r.x=Pn.x,r.y=Pn.y,o=Pn.align,a=Pn.verticalAlign;var c=i.origin;if(c&&null!=i.rotation){var h=void 0,p=void 0;"center"===c?(h=.5*u.width,p=.5*u.height):(h=Cn(c[0],u.width),p=Cn(c[1],u.height)),l=!0,r.originX=-r.x+h+(n?0:u.x),r.originY=-r.y+p+(n?0:u.y)}}null!=i.rotation&&(r.rotation=i.rotation);var d=i.offset;d&&(r.x+=d[0],r.y+=d[1],l||(r.originX=-d[0],r.originY=-d[1]));var f=null==i.inside?"string"==typeof i.position&&i.position.indexOf("inside")>=0:i.inside,m=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={}),g=void 0,y=void 0,v=void 0;f&&this.canBeInsideText()?(g=i.insideFill,y=i.insideStroke,null!=g&&"auto"!==g||(g=this.getInsideTextFill()),null!=y&&"auto"!==y||(y=this.getInsideTextStroke(g),v=!0)):(g=i.outsideFill,y=i.outsideStroke,null!=g&&"auto"!==g||(g=this.getOutsideFill()),null!=y&&"auto"!==y||(y=this.getOutsideStroke(g),v=!0)),(g=g||"#000")===m.fill&&y===m.stroke&&v===m.autoStroke&&o===m.align&&a===m.verticalAlign||(s=!0,m.fill=g,m.stroke=y,m.autoStroke=v,m.align=o,m.verticalAlign=a,e.setDefaultTextStyle(m)),e.__dirty|=1,s&&e.dirtyStyle(!0)}},t.prototype.canBeInsideText=function(){return!0},t.prototype.getInsideTextFill=function(){return"#fff"},t.prototype.getInsideTextStroke=function(t){return"#000"},t.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?Fi:Ni},t.prototype.getOutsideStroke=function(t){var e=this.__zr&&this.__zr.getBackgroundColor(),i="string"==typeof e&&He(e);i||(i=[255,255,255,1]);for(var n=i[3],r=this.__zr.isDarkMode(),o=0;o<3;o++)i[o]=i[o]*n+(r?0:255)*(1-n);return i[3]=1,Qe(i,"rgba")},t.prototype.traverse=function(t,e){},t.prototype.attrKV=function(t,e){"textConfig"===t?this.setTextConfig(e):"textContent"===t?this.setTextContent(e):"clipPath"===t?this.setClipPath(e):"extra"===t?(this.extra=this.extra||{},I(this.extra,e)):this[t]=e},t.prototype.hide=function(){this.ignore=!0,this.markRedraw()},t.prototype.show=function(){this.ignore=!1,this.markRedraw()},t.prototype.attr=function(t,e){if("string"==typeof t)this.attrKV(t,e);else if(j(t))for(var i=N(t),n=0;n<i.length;n++){var r=i[n];this.attrKV(r,t[r])}return this.markRedraw(),this},t.prototype.saveCurrentToNormalState=function(t){this._innerSaveToNormal(t);for(var e=this._normalState,i=0;i<this.animators.length;i++){var n=this.animators[i],r=n.__fromStateTransition;if(!r||r===kn){var o=n.targetName,a=o?e[o]:e;n.saveFinalToTarget(a)}}},t.prototype._innerSaveToNormal=function(t){var e=this._normalState;e||(e=this._normalState={}),t.textConfig&&!e.textConfig&&(e.textConfig=this.textConfig),this._savePrimaryToNormal(t,e,Dn)},t.prototype._savePrimaryToNormal=function(t,e,i){for(var n=0;n<i.length;n++){var r=i[n];null==t[r]||r in e||(e[r]=this[r])}},t.prototype.hasState=function(){return this.currentStates.length>0},t.prototype.getState=function(t){return this.states[t]},t.prototype.ensureState=function(t){var e=this.states;return e[t]||(e[t]={}),e[t]},t.prototype.clearStates=function(t){this.useState(kn,!1,t)},t.prototype.useState=function(t,e,i,n){var r=t===kn;if(this.hasState()||!r){var o=this.currentStates,a=this.stateTransition;if(!(k(o,t)>=0)||!e&&1!==o.length){var s;if(this.stateProxy&&!r&&(s=this.stateProxy(t)),s||(s=this.states&&this.states[t]),s||r){r||this.saveCurrentToNormalState(s);var l=!!(s&&s.hoverLayer||n);l&&this._toggleHoverLayerFlag(!0),this._applyStateObj(t,s,this._normalState,e,!i&&!this.__inHover&&a&&a.duration>0,a);var u=this._textContent,c=this._textGuide;return u&&u.useState(t,e,i,l),c&&c.useState(t,e,i,l),r?(this.currentStates=[],this._normalState={}):e?this.currentStates.push(t):this.currentStates=[t],this._updateAnimationTargets(),this.markRedraw(),!l&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=-2),s}w("State "+t+" not exists.")}}},t.prototype.useStates=function(t,e,i){if(t.length){var n=[],r=this.currentStates,o=t.length,a=o===r.length;if(a)for(var s=0;s<o;s++)if(t[s]!==r[s]){a=!1;break}if(a)return;for(s=0;s<o;s++){var l=t[s],u=void 0;this.stateProxy&&(u=this.stateProxy(l,t)),u||(u=this.states[l]),u&&n.push(u)}var c=n[o-1],h=!!(c&&c.hoverLayer||i);h&&this._toggleHoverLayerFlag(!0);var p=this._mergeStates(n),d=this.stateTransition;this.saveCurrentToNormalState(p),this._applyStateObj(t.join(","),p,this._normalState,!1,!e&&!this.__inHover&&d&&d.duration>0,d);var f=this._textContent,m=this._textGuide;f&&f.useStates(t,e,h),m&&m.useStates(t,e,h),this._updateAnimationTargets(),this.currentStates=t.slice(),this.markRedraw(),!h&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=-2)}else this.clearStates()},t.prototype._updateAnimationTargets=function(){for(var t=0;t<this.animators.length;t++){var e=this.animators[t];e.targetName&&e.changeTarget(this[e.targetName])}},t.prototype.removeState=function(t){var e=k(this.currentStates,t);if(e>=0){var i=this.currentStates.slice();i.splice(e,1),this.useStates(i)}},t.prototype.replaceState=function(t,e,i){var n=this.currentStates.slice(),r=k(n,t),o=k(n,e)>=0;r>=0?o?n.splice(r,1):n[r]=e:i&&!o&&n.push(e),this.useStates(n)},t.prototype.toggleState=function(t,e){e?this.useState(t,!0):this.removeState(t)},t.prototype._mergeStates=function(t){for(var e,i={},n=0;n<t.length;n++){var r=t[n];I(i,r),r.textConfig&&I(e=e||{},r.textConfig)}return e&&(i.textConfig=e),i},t.prototype._applyStateObj=function(t,e,i,n,r,o){var a=!(e&&n);e&&e.textConfig?(this.textConfig=I({},n?this.textConfig:i.textConfig),I(this.textConfig,e.textConfig)):a&&i.textConfig&&(this.textConfig=i.textConfig);for(var s={},l=!1,u=0;u<Dn.length;u++){var c=Dn[u],h=r&&En[c];e&&null!=e[c]?h?(l=!0,s[c]=e[c]):this[c]=e[c]:a&&null!=i[c]&&(h?(l=!0,s[c]=i[c]):this[c]=i[c])}if(!r)for(u=0;u<this.animators.length;u++){var p=this.animators[u],d=p.targetName;p.__changeFinalValue(d?(e||i)[d]:e||i)}l&&this._transitionState(t,s,o)},t.prototype._attachComponent=function(t){if(t.__zr&&!t.__hostTarget)throw Error("Text element has been added to zrender.");if(t===this)throw Error("Recursive component attachment.");var e=this.__zr;e&&t.addSelfToZr(e),t.__zr=e,t.__hostTarget=this},t.prototype._detachComponent=function(t){t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__hostTarget=null},t.prototype.getClipPath=function(){return this._clipPath},t.prototype.setClipPath=function(t){this._clipPath&&this._clipPath!==t&&this.removeClipPath(),this._attachComponent(t),this._clipPath=t,this.markRedraw()},t.prototype.removeClipPath=function(){var t=this._clipPath;t&&(this._detachComponent(t),this._clipPath=null,this.markRedraw())},t.prototype.getTextContent=function(){return this._textContent},t.prototype.setTextContent=function(t){var e=this._textContent;if(e!==t){if(e&&e!==t&&this.removeTextContent(),t.__zr&&!t.__hostTarget)throw Error("Text element has been added to zrender.");t.innerTransformable=new an,this._attachComponent(t),this._textContent=t,this.markRedraw()}},t.prototype.setTextConfig=function(t){this.textConfig||(this.textConfig={}),I(this.textConfig,t),this.markRedraw()},t.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},t.prototype.removeTextContent=function(){var t=this._textContent;t&&(t.innerTransformable=null,this._detachComponent(t),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},t.prototype.getTextGuideLine=function(){return this._textGuide},t.prototype.setTextGuideLine=function(t){this._textGuide&&this._textGuide!==t&&this.removeTextGuideLine(),this._attachComponent(t),this._textGuide=t,this.markRedraw()},t.prototype.removeTextGuideLine=function(){var t=this._textGuide;t&&(this._detachComponent(t),this._textGuide=null,this.markRedraw())},t.prototype.markRedraw=function(){this.__dirty|=1;var t=this.__zr;t&&(this.__inHover?t.refreshHover():t.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},t.prototype.dirty=function(){this.markRedraw()},t.prototype._toggleHoverLayerFlag=function(t){this.__inHover=t;var e=this._textContent,i=this._textGuide;e&&(e.__inHover=t),i&&(i.__inHover=t)},t.prototype.addSelfToZr=function(t){if(this.__zr!==t){this.__zr=t;var e=this.animators;if(e)for(var i=0;i<e.length;i++)t.animation.addAnimator(e[i]);this._clipPath&&this._clipPath.addSelfToZr(t),this._textContent&&this._textContent.addSelfToZr(t),this._textGuide&&this._textGuide.addSelfToZr(t)}},t.prototype.removeSelfFromZr=function(t){if(this.__zr){this.__zr=null;var e=this.animators;if(e)for(var i=0;i<e.length;i++)t.animation.removeAnimator(e[i]);this._clipPath&&this._clipPath.removeSelfFromZr(t),this._textContent&&this._textContent.removeSelfFromZr(t),this._textGuide&&this._textGuide.removeSelfFromZr(t)}},t.prototype.animate=function(t,e){var i=t?this[t]:this;if(i){var n=new yi(i,e);return this.addAnimator(n,t),n}w('Property "'+t+'" is not existed in element '+this.id)},t.prototype.addAnimator=function(t,e){var i=this.__zr,n=this;t.during(function(){n.updateDuringAnimation(e)}).done(function(){var e=n.animators,i=k(e,t);i>=0&&e.splice(i,1)}),this.animators.push(t),i&&i.animation.addAnimator(t),i&&i.wakeUp()},t.prototype.updateDuringAnimation=function(t){this.markRedraw()},t.prototype.stopAnimation=function(t,e){for(var i=this.animators,n=i.length,r=[],o=0;o<n;o++){var a=i[o];t&&t!==a.scope?r.push(a):a.stop(e)}return this.animators=r,this},t.prototype.animateTo=function(t,e,i){On(this,t,e,i)},t.prototype.animateFrom=function(t,e,i){On(this,t,e,i,!0)},t.prototype._transitionState=function(t,e,i,n){for(var r=On(this,e,i,n),o=0;o<r.length;o++)r[o].__fromStateTransition=t},t.prototype.getBoundingRect=function(){return null},t.prototype.getPaintRect=function(){return null},t.initDefaultProps=function(){var e=t.prototype;e.type="element",e.name="",e.ignore=!1,e.silent=!1,e.isGroup=!1,e.draggable=!1,e.dragging=!1,e.ignoreClip=!1,e.__inHover=!1,e.__dirty=1;var i={};function n(t,e,n){i[t+e+n]||(console.warn("DEPRECATED: '"+t+"' has been deprecated. use '"+e+"', '"+n+"' instead"),i[t+e+n]=!0)}function r(t,i,r,o){function a(t,e){Object.defineProperty(e,0,{get:function(){return t[r]},set:function(e){t[r]=e}}),Object.defineProperty(e,1,{get:function(){return t[o]},set:function(e){t[o]=e}})}Object.defineProperty(e,t,{get:function(){return n(t,r,o),this[i]||a(this,this[i]=[]),this[i]},set:function(e){n(t,r,o),this[r]=e[0],this[o]=e[1],this[i]=e,a(this,e)}})}Object.defineProperty&&(!a.browser.ie||a.browser.version>8)&&(r("position","_legacyPos","x","y"),r("scale","_legacyScale","scaleX","scaleY"),r("origin","_legacyOrigin","originX","originY"))}(),t}();function On(t,e,i,n,r){var o=[];Nn(t,"",t,e,i=i||{},n,o,r);var a=o.length,s=!1,l=i.done,u=i.aborted,c=function(){s=!0,--a<=0&&(s?l&&l():u&&u())},h=function(){--a<=0&&(s?l&&l():u&&u())};a||l&&l(),o.length>0&&i.during&&o[0].during(function(t,e){i.during(e)});for(var p=0;p<o.length;p++){var d=o[p];c&&d.done(c),h&&d.aborted(h),d.start(i.easing,i.force)}return o}function Rn(t,e,i){for(var n=0;n<i;n++)t[n]=e[n]}function Bn(t,e,i){if(P(e[i]))if(P(t[i])||(t[i]=[]),q(e[i])){var n=e[i].length;t[i].length!==n&&(t[i]=new e[i].constructor(n),Rn(t[i],e[i],n))}else{var r=e[i],o=t[i],a=r.length;if(P(r[0]))for(var s=r[0].length,l=0;l<a;l++)o[l]?Rn(o[l],r[l],s):o[l]=Array.prototype.slice.call(r[l]);else Rn(o,r,a);o.length=r.length}else t[i]=e[i]}function Nn(t,e,i,n,r,o,a,s){for(var l=[],u=[],c=N(n),h=r.duration,p=r.delay,d=r.additive,f=r.setToFinal,m=!j(o),g=0;g<c.length;g++)if(null!=i[M=c[g]]&&null!=n[M]&&(m||o[M]))if(j(n[M])&&!P(n[M])){if(e){s||(i[M]=n[M],t.updateDuringAnimation(e));continue}Nn(t,M,i[M],n[M],r,o&&o[M],a,s)}else l.push(M),u.push(M);else s||(i[M]=n[M],t.updateDuringAnimation(e),u.push(M));var y=l.length;if(y>0||r.force&&!a.length){for(var v=t.animators,_=[],x=0;x<v.length;x++)v[x].targetName===e&&_.push(v[x]);if(!d&&_.length)for(x=0;x<_.length;x++)if(_[x].stopTracks(u)){var b=k(v,_[x]);v.splice(b,1)}var w=void 0,S=void 0,T=void 0;if(s)for(S={},f&&(w={}),x=0;x<y;x++)S[M=l[x]]=i[M],f?w[M]=n[M]:i[M]=n[M];else if(f)for(T={},x=0;x<y;x++){var M;T[M=l[x]]=hi(i[M]),Bn(i,n,M)}var I=new yi(i,!1,d?_:null);I.targetName=e,r.scope&&(I.scope=r.scope),f&&w&&I.whenWithKeys(0,w,l),T&&I.whenWithKeys(0,T,l),I.whenWithKeys(null==h?500:h,s?S:n,l).delay(p||0),t.addAnimator(I,e),a.push(I)}}E(zn,Ut),E(zn,an);var Fn=function(t){function e(e){var i=t.call(this)||this;return i.isGroup=!0,i._children=[],i.attr(e),i}return i(e,t),e.prototype.childrenRef=function(){return this._children},e.prototype.children=function(){return this._children.slice()},e.prototype.childAt=function(t){return this._children[t]},e.prototype.childOfName=function(t){for(var e=this._children,i=0;i<e.length;i++)if(e[i].name===t)return e[i]},e.prototype.childCount=function(){return this._children.length},e.prototype.add=function(t){if(t&&(t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),t.__hostTarget))throw"This elemenet has been used as an attachment";return this},e.prototype.addBefore=function(t,e){if(t&&t!==this&&t.parent!==this&&e&&e.parent===this){var i=this._children,n=i.indexOf(e);n>=0&&(i.splice(n,0,t),this._doAdd(t))}return this},e.prototype.replace=function(t,e){var i=k(this._children,t);return i>=0&&this.replaceAt(e,i),this},e.prototype.replaceAt=function(t,e){var i=this._children,n=i[e];if(t&&t!==this&&t.parent!==this&&t!==n){i[e]=t,n.parent=null;var r=this.__zr;r&&n.removeSelfFromZr(r),this._doAdd(t)}return this},e.prototype._doAdd=function(t){t.parent&&t.parent.remove(t),t.parent=this;var e=this.__zr;e&&e!==t.__zr&&t.addSelfToZr(e),e&&e.refresh()},e.prototype.remove=function(t){var e=this.__zr,i=this._children,n=k(i,t);return n<0||(i.splice(n,1),t.parent=null,e&&t.removeSelfFromZr(e),e&&e.refresh()),this},e.prototype.removeAll=function(){for(var t=this._children,e=this.__zr,i=0;i<t.length;i++){var n=t[i];e&&n.removeSelfFromZr(e),n.parent=null}return t.length=0,this},e.prototype.eachChild=function(t,e){for(var i=this._children,n=0;n<i.length;n++){var r=i[n];t.call(e,r,n)}return this},e.prototype.traverse=function(t,e){for(var i=0;i<this._children.length;i++){var n=this._children[i],r=t.call(e,n);n.isGroup&&!r&&n.traverse(t,e)}return this},e.prototype.addSelfToZr=function(e){t.prototype.addSelfToZr.call(this,e);for(var i=0;i<this._children.length;i++)this._children[i].addSelfToZr(e)},e.prototype.removeSelfFromZr=function(e){t.prototype.removeSelfFromZr.call(this,e);for(var i=0;i<this._children.length;i++)this._children[i].removeSelfFromZr(e)},e.prototype.getBoundingRect=function(t){for(var e=new yn(0,0,0,0),i=t||this._children,n=[],r=null,o=0;o<i.length;o++){var a=i[o];if(!a.ignore&&!a.invisible){var s=a.getBoundingRect(),l=a.getLocalTransform(n);l?(yn.applyTransform(e,s,l),(r=r||e.clone()).union(e)):(r=r||s.clone()).union(s)}}return r||e},e}(zn);Fn.prototype.type="group";var Vn=!a.canvasSupported,Un={},Gn={},$n=function(){function t(t,e,i){var n=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,i=i||{},this.dom=e,this.id=t;var r=new Te,o=i.renderer||"canvas";if(Vn)throw Error("IE8 support has been dropped since 5.0");if(Un[o]||(o=N(Un)[0]),!Un[o])throw Error("Renderer '"+o+"' is not imported. Please import it first.");i.useDirtyRect=null!=i.useDirtyRect&&i.useDirtyRect;var s=new Un[o](e,r,i,t);this.storage=r,this.painter=s;var l=a.node||a.worker?null:new Oi(s.getViewportRoot(),s.root);this.handler=new pe(r,s,l,s.root),this.animation=new vi({stage:{update:function(){return n._flush(!0)}}}),this.animation.start()}return t.prototype.add=function(t){t&&(this.storage.addRoot(t),t.addSelfToZr(this),this.refresh())},t.prototype.remove=function(t){t&&(this.storage.delRoot(t),t.removeSelfFromZr(this),this.refresh())},t.prototype.configLayer=function(t,e){this.painter.configLayer&&this.painter.configLayer(t,e),this.refresh()},t.prototype.setBackgroundColor=function(t){this.painter.setBackgroundColor&&this.painter.setBackgroundColor(t),this.refresh(),this._backgroundColor=t,this._darkMode=function(t){if(!t)return!1;if("string"==typeof t)return ti(t,1)<.4;if(t.colorStops){for(var e=t.colorStops,i=0,n=e.length,r=0;r<n;r++)i+=ti(e[r].color,1);return(i/=n)<.4}return!1}(t)},t.prototype.getBackgroundColor=function(){return this._backgroundColor},t.prototype.setDarkMode=function(t){this._darkMode=t},t.prototype.isDarkMode=function(){return this._darkMode},t.prototype.refreshImmediately=function(t){t||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1},t.prototype.refresh=function(){this._needsRefresh=!0,this.animation.start()},t.prototype.flush=function(){this._flush(!1)},t.prototype._flush=function(t){var e,i=(new Date).getTime();this._needsRefresh&&(e=!0,this.refreshImmediately(t)),this._needsRefreshHover&&(e=!0,this.refreshHoverImmediately());var n=(new Date).getTime();e?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:n-i})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},t.prototype.setSleepAfterStill=function(t){this._sleepAfterStill=t},t.prototype.wakeUp=function(){this.animation.start(),this._stillFrameAccum=0},t.prototype.addHover=function(t){},t.prototype.removeHover=function(t){},t.prototype.clearHover=function(){},t.prototype.refreshHover=function(){this._needsRefreshHover=!0},t.prototype.refreshHoverImmediately=function(){this._needsRefreshHover=!1,this.painter.refreshHover&&"canvas"===this.painter.getType()&&this.painter.refreshHover()},t.prototype.resize=function(t){t=t||{},this.painter.resize(t.width,t.height),this.handler.resize()},t.prototype.clearAnimation=function(){this.animation.clear()},t.prototype.getWidth=function(){return this.painter.getWidth()},t.prototype.getHeight=function(){return this.painter.getHeight()},t.prototype.pathToImage=function(t,e){if(this.painter.pathToImage)return this.painter.pathToImage(t,e)},t.prototype.setCursorStyle=function(t){this.handler.setCursorStyle(t)},t.prototype.findHover=function(t,e){return this.handler.findHover(t,e)},t.prototype.on=function(t,e,i){return this.handler.on(t,e,i),this},t.prototype.off=function(t,e){this.handler.off(t,e)},t.prototype.trigger=function(t,e){this.handler.trigger(t,e)},t.prototype.clear=function(){for(var t=this.storage.getRoots(),e=0;e<t.length;e++)t[e]instanceof Fn&&t[e].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()},t.prototype.dispose=function(){var t;this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,t=this.id,delete Gn[t]},t}();function Wn(t,e){var i=new $n(b(),t,e);return Gn[i.id]=i,i}function Hn(t,e){Un[t]=e}var jn=Object.freeze({__proto__:null,init:Wn,dispose:function(t){t.dispose()},disposeAll:function(){for(var t in Gn)Gn.hasOwnProperty(t)&&Gn[t].dispose();Gn={}},getInstance:function(t){return Gn[t]},registerPainter:Hn,version:"5.2.1"}),Zn=1e-4;function qn(t,e,i,n){var r=e[0],o=e[1],a=i[0],s=i[1],l=o-r,u=s-a;if(0===l)return 0===u?a:(a+s)/2;if(n)if(l>0){if(t<=r)return a;if(t>=o)return s}else{if(t>=r)return a;if(t<=o)return s}else{if(t===r)return a;if(t===o)return s}return(t-r)/l*u+a}function Xn(t,e){switch(t){case"center":case"middle":t="50%";break;case"left":case"top":t="0%";break;case"right":case"bottom":t="100%"}return"string"==typeof t?(i=t,i.replace(/^\s+|\s+$/g,"")).match(/%$/)?parseFloat(t)/100*e:parseFloat(t):null==t?NaN:+t;var i}function Yn(t,e,i){return null==e&&(e=10),t=(+t).toFixed(e=Math.min(Math.max(0,e),20)),i?t:+t}function Kn(t){return t.sort(function(t,e){return t-e}),t}function Jn(t){if(isNaN(t=+t))return 0;if(t>1e-14)for(var e=1,i=0;i<15;i++,e*=10)if(Math.round(t*e)/e===t)return i;return Qn(t)}function Qn(t){var e=t.toString().toLowerCase(),i=e.indexOf("e"),n=i>0?+e.slice(i+1):0,r=i>0?i:e.length,o=e.indexOf("."),a;return Math.max(0,(o<0?0:r-1-o)-n)}function tr(t,e){var i=Math.log,n=Math.LN10,r=Math.floor(i(t[1]-t[0])/n),o=Math.round(i(Math.abs(e[1]-e[0]))/n),a=Math.min(Math.max(-r+o,0),20);return isFinite(a)?a:20}function er(t,e,i){if(!t[e])return 0;var n=O(t,function(t,e){return t+(isNaN(e)?0:e)},0);if(0===n)return 0;for(var r=Math.pow(10,i),o=z(t,function(t){return(isNaN(t)?0:t)/n*r*100}),a=100*r,s=z(o,function(t){return Math.floor(t)}),l=O(s,function(t,e){return t+e},0),u=z(o,function(t,e){return t-s[e]});l<a;){for(var c=-1/0,h=null,p=0,d=u.length;p<d;++p)u[p]>c&&(c=u[p],h=p);++s[h],u[h]=0,++l}return s[e]/r}function ir(t,e){var i=Math.max(Jn(t),Jn(e)),n=t+e;return i>20?n:Yn(n,i)}var nr=9007199254740991;function rr(t){var e=2*Math.PI;return(t%e+e)%e}function or(t){return t>-1e-4&&t<Zn}var ar=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function sr(t){if(t instanceof Date)return t;if("string"==typeof t){var e=ar.exec(t);if(!e)return new Date(NaN);if(e[8]){var i=+e[4]||0;return"Z"!==e[8].toUpperCase()&&(i-=+e[8].slice(0,3)),new Date(Date.UTC(+e[1],+(e[2]||1)-1,+e[3]||1,i,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0))}return new Date(+e[1],+(e[2]||1)-1,+e[3]||1,+e[4]||0,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0)}return new Date(null==t?NaN:Math.round(t))}function lr(t){return Math.pow(10,ur(t))}function ur(t){if(0===t)return 0;var e=Math.floor(Math.log(t)/Math.LN10);return t/Math.pow(10,e)>=10&&e++,e}function cr(t,e){var i=ur(t),n=Math.pow(10,i),r=t/n;return t=(e?r<1.5?1:r<2.5?2:r<4?3:r<7?5:10:r<1?1:r<2?2:r<3?3:r<5?5:10)*n,i>=-20?+t.toFixed(i<0?-i:0):t}function hr(t,e){var i=(t.length-1)*e+1,n=Math.floor(i),r=+t[n-1],o=i-n;return o?r+o*(t[n]-r):r}function pr(t){t.sort(function(t,e){return s(t,e,0)?-1:1});for(var e=-1/0,i=1,n=0;n<t.length;){for(var r=t[n].interval,o=t[n].close,a=0;a<2;a++)r[a]<=e&&(r[a]=e,o[a]=a?1:1-i),e=r[a],i=o[a];r[0]===r[1]&&o[0]*o[1]!=1?t.splice(n,1):n++}return t;function s(t,e,i){return t.interval[i]<e.interval[i]||t.interval[i]===e.interval[i]&&(t.close[i]-e.close[i]==(i?-1:1)||!i&&s(t,e,1))}}function dr(t){var e=parseFloat(t);return e==t&&(0!==e||"string"!=typeof t||t.indexOf("x")<=0)?e:NaN}function fr(t){return!isNaN(dr(t))}function mr(){return Math.round(9*Math.random())}function gr(t,e){return 0===e?t:gr(e,t%e)}function yr(t,e){return null==t?e:null==e?t:t*e/gr(t,e)}function vr(t){}function _r(t){throw Error(t)}var xr="series\0",br="\0_ec_\0";function wr(t){return t instanceof Array?t:null==t?[]:[t]}function Sr(t,e,i){if(t){t[e]=t[e]||{},t.emphasis=t.emphasis||{},t.emphasis[e]=t.emphasis[e]||{};for(var n=0,r=i.length;n<r;n++){var o=i[n];!t.emphasis[e].hasOwnProperty(o)&&t[e].hasOwnProperty(o)&&(t.emphasis[e][o]=t[e][o])}}}var Tr=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function Mr(t){return!j(t)||U(t)||t instanceof Date?t:t.value}function Ir(t){return j(t)&&!(t instanceof Array)}function Cr(t,e,i){var n="normalMerge"===i,r="replaceMerge"===i,o="replaceAll"===i;t=t||[],e=(e||[]).slice();var a=ht();L(e,function(t,i){j(t)||(e[i]=null)});var s,l,u=function(t,e,i){var n=[];if("replaceAll"===i)return n;for(var r=0;r<t.length;r++){var o=t[r];o&&null!=o.id&&e.set(o.id,r),n.push({existing:"replaceMerge"===i||Pr(o)?null:o,newOption:null,keyInfo:null,brandNew:null})}return n}(t,a,i);return(n||r)&&function(t,e,i,n){L(n,function(r,o){if(r&&null!=r.id){var a=kr(r.id),s=i.get(a);if(null!=s){var l=t[s];ot(!l.newOption,'Duplicated option on id "'+a+'".'),l.newOption=r,l.existing=e[s],n[o]=null}}})}(u,t,a,e),n&&function(t,e){L(e,function(i,n){if(i&&null!=i.name)for(var r=0;r<t.length;r++){var o=t[r].existing;if(!t[r].newOption&&o&&(null==o.id||null==i.id)&&!Pr(i)&&!Pr(o)&&Ar("name",o,i))return t[r].newOption=i,void(e[n]=null)}})}(u,e),n||r?function(t,e,i){L(e,function(e){if(e){for(var n,r=0;(n=t[r])&&(n.newOption||Pr(n.existing)||n.existing&&null!=e.id&&!Ar("id",e,n.existing));)r++;n?(n.newOption=e,n.brandNew=i):t.push({newOption:e,brandNew:i,existing:null,keyInfo:null}),r++}})}(u,e,r):o&&function(t,e){L(e,function(e){t.push({newOption:e,brandNew:!0,existing:null,keyInfo:null})})}(u,e),s=u,l=ht(),L(s,function(t){var e=t.existing;e&&l.set(e.id,t)}),L(s,function(t){var e=t.newOption;ot(!e||null==e.id||!l.get(e.id)||l.get(e.id)===t,"id duplicates: "+(e&&e.id)),e&&null!=e.id&&l.set(e.id,t),!t.keyInfo&&(t.keyInfo={})}),L(s,function(t,e){var i=t.existing,n=t.newOption,r=t.keyInfo;if(j(n)){if(r.name=null!=n.name?kr(n.name):i?i.name:xr+e,i)r.id=kr(i.id);else if(null!=n.id)r.id=kr(n.id);else{var o=0;do{r.id="\0"+r.name+"\0"+o++}while(l.get(r.id))}l.set(r.id,t)}}),u}function Ar(t,e,i){var n=Dr(e[t],null),r=Dr(i[t],null);return null!=n&&null!=r&&n===r}function kr(t){return Dr(t,"")}function Dr(t,e){if(null==t)return e;var i=typeof t;return"string"===i?t:"number"===i||W(t)?t+"":e}function Er(t){var e=t.name;return!(!e||!e.indexOf(xr))}function Pr(t){return t&&null!=t.id&&0===kr(t.id).indexOf(br)}function Lr(t,e){return null!=e.dataIndexInside?e.dataIndexInside:null!=e.dataIndex?U(e.dataIndex)?z(e.dataIndex,function(e){return t.indexOfRawIndex(e)}):t.indexOfRawIndex(e.dataIndex):null!=e.name?U(e.name)?z(e.name,function(e){return t.indexOfName(e)}):t.indexOfName(e.name):void 0}function zr(){var t="__ec_inner_"+Or++;return function(e){return e[t]||(e[t]={})}}var Or=mr();function Rr(t,e,i){var n=Br(e,i),r=n.mainTypeSpecified,o=n.queryOptionMap,a=n.others,s=i?i.defaultMainType:null;return!r&&s&&o.set(s,{}),o.each(function(e,n){var r=Vr(t,n,e,{useDefault:s===n,enableAll:!i||null==i.enableAll||i.enableAll,enableNone:!i||null==i.enableNone||i.enableNone});a[n+"Models"]=r.models,a[n+"Model"]=r.models[0]}),a}function Br(t,e){var i;if($(t)){var n={};n[t+"Index"]=0,i=n}else i=t;var r=ht(),o={},a=!1;return L(i,function(t,i){if("dataIndex"!==i&&"dataIndexInside"!==i){var n=i.match(/^(\w+)(Index|Id|Name)$/)||[],s=n[1],l=(n[2]||"").toLowerCase();!s||!l||e&&e.includeMainTypes&&k(e.includeMainTypes,s)<0||(a=a||!!s,(r.get(s)||r.set(s,{}))[l]=t)}else o[i]=t}),{mainTypeSpecified:a,queryOptionMap:r,others:o}}var Nr={useDefault:!0,enableAll:!1,enableNone:!1},Fr={useDefault:!1,enableAll:!0,enableNone:!0};function Vr(t,e,i,n){n=n||Nr;var r=i.index,o=i.id,a=i.name,s={models:null,specified:null!=r||null!=o||null!=a};if(!s.specified){var l=void 0;return s.models=n.useDefault&&(l=t.getComponent(e))?[l]:[],s}return"none"===r||!1===r?(ot(n.enableNone,'`"none"` or `false` is not a valid value on index option.'),s.models=[],s):("all"===r&&(ot(n.enableAll,'`"all"` is not a valid value on index option.'),r=o=a=null),s.models=t.queryComponents({mainType:e,index:r,id:o,name:a}),s)}function Ur(t,e,i){t.setAttribute?t.setAttribute(e,i):t[e]=i}function Gr(t,e){var i=ht(),n=[];return L(t,function(t){var r=e(t);(i.get(r)||(n.push(r),i.set(r,[]))).push(t)}),{keys:n,buckets:i}}function $r(t,e,i,n,r){var o=null==e||"auto"===e;if(null==n)return n;if("number"==typeof n)return Yn(f=ni(i||0,n,r),o?Math.max(Jn(i||0),Jn(n)):e);if("string"==typeof n)return r<1?i:n;for(var a=[],s=i,l=n,u=Math.max(s?s.length:0,l.length),c=0;c<u;++c){var h=t.getDimensionInfo(c);if(h&&"ordinal"===h.type)a[c]=(r<1&&s?s:l)[c];else{var p=s&&s[c]?s[c]:0,d=l[c],f=ni(p,d,r);a[c]=Yn(f,o?Math.max(Jn(p),Jn(d)):e)}}return a}var Wr="___EC__COMPONENT__CONTAINER___",Hr="___EC__EXTENDED_CLASS___";function jr(t){var e={main:"",sub:""};if(t){var i=t.split(".");e.main=i[0]||"",e.sub=i[1]||""}return e}function Zr(t,e){t.$constructor=t,t.extend=function(t){var e=this;function i(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(t.$constructor)t.$constructor.apply(this,arguments);else{var a;if(qr(e))return dt(i.prototype,new(e.bind.apply(e,r([void 0],n))));e.apply(this,arguments)}}return i[Hr]=!0,I(i.prototype,t),i.extend=this.extend,i.superCall=Kr,i.superApply=Jr,D(i,this),i.superClass=e,i}}function qr(t){return"function"==typeof t&&/^class\s/.test(Function.prototype.toString.call(t))}function Xr(t,e){t.extend=e.extend}var Yr=Math.round(10*Math.random());function Kr(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return this.superClass.prototype[e].apply(t,i)}function Jr(t,e,i){return this.superClass.prototype[e].apply(t,i)}function Qr(t){var e={};t.registerClass=function(t){var i,n=t.type||t.prototype.type;if(n){ot(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(i=n),'componentType "'+i+'" illegal'),t.prototype.type=n;var r=jr(n);r.sub?r.sub!==Wr&&((function(t){var i=e[t.main];return i&&i[Wr]||((i=e[t.main]={})[Wr]=!0),i}(r))[r.sub]=t):e[r.main]=t}return t},t.getClass=function(t,i,n){var r=e[t];if(r&&r[Wr]&&(r=i?r[i]:null),n&&!r)throw Error(i?"Component "+t+"."+(i||"")+" is used but not imported.":t+".type should be specified.");return r},t.getClassesByMainType=function(t){var i=jr(t),n=[],r=e[i.main];return r&&r[Wr]?L(r,function(t,e){e!==Wr&&n.push(t)}):n.push(r),n},t.hasClass=function(t){var i=jr(t);return!!e[i.main]},t.getAllClassMainTypes=function(){var t=[];return L(e,function(e,i){t.push(i)}),t},t.hasSubTypes=function(t){var i=jr(t),n=e[i.main];return n&&n[Wr]}}function to(t,e){for(var i=0;i<t.length;i++)t[i][1]||(t[i][1]=t[i][0]);return e=e||!1,function(i,n,r){for(var o={},a=0;a<t.length;a++){var s=t[a][1];if(!(n&&k(n,s)>=0||r&&k(r,s)<0)){var l=i.getShallow(s,e);null!=l&&(o[t[a][0]]=l)}}return o}}var eo=to([["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]]),io=function(){function t(){}return t.prototype.getAreaStyle=function(t,e){return eo(this,t,e)},t}(),no=new De(50);function ro(t){if("string"==typeof t){var e=no.get(t);return e&&e.image}return t}function oo(t,e,i,n,r){if(t){if("string"==typeof t){if(e&&e.__zrImageSrc===t||!i)return e;var o=no.get(t),a={hostEl:i,cb:n,cbPayload:r};return o?!so(e=o.image)&&o.pending.push(a):((e=new Image).onload=e.onerror=ao,no.put(t,e.__cachedImgObj={image:e,pending:[a]}),e.src=e.__zrImageSrc=t),e}return t}return e}function ao(){var t=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var e=0;e<t.pending.length;e++){var i=t.pending[e],n=i.cb;n&&n(this,i.cbPayload),i.hostEl.dirty()}t.pending.length=0}function so(t){return t&&t.width&&t.height}var lo=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function uo(t,e,i,n,r){if(!e)return"";var o=(t+"").split("\n");r=co(e,i,n,r);for(var a=0,s=o.length;a<s;a++)o[a]=ho(o[a],r);return o.join("\n")}function co(t,e,i,n){var r=I({},n=n||{});r.font=e,i=et(i,"..."),r.maxIterations=et(n.maxIterations,2);var o=r.minChar=et(n.minChar,0);r.cnCharWidth=bn("国",e);var a=r.ascCharWidth=bn("a",e);r.placeholder=et(n.placeholder,"");for(var s=t=Math.max(0,t-1),l=0;l<o&&s>=a;l++)s-=a;var u=bn(i,e);return u>s&&(i="",u=0),s=t-u,r.ellipsis=i,r.ellipsisWidth=u,r.contentWidth=s,r.containerWidth=t,r}function ho(t,e){var i=e.containerWidth,n=e.font,r=e.contentWidth;if(!i)return"";var o=bn(t,n);if(o<=i)return t;for(var a=0;;a++){if(o<=r||a>=e.maxIterations){t+=e.ellipsis;break}var s=0===a?po(t,r,e.ascCharWidth,e.cnCharWidth):o>0?Math.floor(t.length*r/o):0;o=bn(t=t.substr(0,s),n)}return""===t&&(t=e.placeholder),t}function po(t,e,i,n){for(var r=0,o=0,a=t.length;o<a&&r<e;o++){var s=t.charCodeAt(o);r+=0<=s&&s<=127?i:n}return o}var fo=function(){},mo=function(t){this.tokens=[],t&&(this.tokens=t)},go=function(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[]};function yo(t,e,i,n,r){var o,a,s=""===e,l=r&&i.rich[r]||{},u=t.lines,c=l.font||i.font,h=!1;if(n){var p=l.padding,d=p?p[1]+p[3]:0;if(null!=l.width&&"auto"!==l.width){var f=Cn(l.width,n.width)+d;u.length>0&&f+n.accumWidth>n.width&&(o=e.split("\n"),h=!0),n.accumWidth=f}else{var m=xo(e,c,n.width,n.breakAll,n.accumWidth);n.accumWidth=m.accumWidth+d,a=m.linesWidths,o=m.lines}}else o=e.split("\n");for(var g=0;g<o.length;g++){var y=o[g],v=new fo;if(v.styleName=r,v.text=y,v.isLineHolder=!y&&!s,"number"==typeof l.width?v.width=l.width:v.width=a?a[g]:bn(y,c),g||h)u.push(new mo([v]));else{var _=(u[u.length-1]||(u[0]=new mo)).tokens,x=_.length;1===x&&_[0].isLineHolder?_[0]=v:(y||!x||s)&&_.push(v)}}}var vo=O(",&?/;] ".split(""),function(t,e){return t[e]=!0,t},{});function _o(t){return!function(t){var e=t.charCodeAt(0);return e>=33&&e<=255}(t)||!!vo[t]}function xo(t,e,i,n,r){for(var o=[],a=[],s="",l="",u=0,c=0,h=0;h<t.length;h++){var p=t.charAt(h);if("\n"!==p){var d=bn(p,e),f=!n&&!_o(p);(o.length?c+d>i:r+c+d>i)?c?(s||l)&&(f?(s||(s=l,l="",c=u=0),o.push(s),a.push(c-u),l+=p,s="",c=u+=d):(l&&(s+=l,c+=u,l="",u=0),o.push(s),a.push(c),s=p,c=d)):f?(o.push(l),a.push(u),l=p,u=d):(o.push(p),a.push(d)):(c+=d,f?(l+=p,u+=d):(l&&(s+=l,l="",u=0),s+=p))}else l&&(s+=l,c+=u),o.push(s),a.push(c),s="",l="",u=0,c=0}return o.length||s||(s=t,l="",u=0),l&&(s+=l),s&&(o.push(s),a.push(c)),1===o.length&&(c+=r),{accumWidth:c,lines:o,linesWidths:a}}var bo="__zr_style_"+Math.round(10*Math.random()),wo={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},So={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};wo[bo]=!0;var To=["z","z2","invisible"],Mo=["invisible"],Io=function(t){function e(e){return t.call(this,e)||this}var n;return i(e,t),e.prototype._init=function(e){for(var i=N(e),n=0;n<i.length;n++){var r=i[n];"style"===r?this.useStyle(e[r]):t.prototype.attrKV.call(this,r,e[r])}this.style||this.useStyle({})},e.prototype.beforeBrush=function(){},e.prototype.afterBrush=function(){},e.prototype.innerBeforeBrush=function(){},e.prototype.innerAfterBrush=function(){},e.prototype.shouldBePainted=function(t,e,i,n){var r=this.transform;if(this.ignore||this.invisible||0===this.style.opacity||this.culling&&function(t,e,i){return Co.copy(t.getBoundingRect()),t.transform&&Co.applyTransform(t.transform),Ao.width=e,Ao.height=i,!Co.intersect(Ao)}(this,t,e)||r&&!r[0]&&!r[3])return!1;if(i&&this.__clipPaths)for(var o=0;o<this.__clipPaths.length;++o)if(this.__clipPaths[o].isZeroArea())return!1;if(n&&this.parent)for(var a=this.parent;a;){if(a.ignore)return!1;a=a.parent}return!0},e.prototype.contain=function(t,e){return this.rectContain(t,e)},e.prototype.traverse=function(t,e){t.call(e,this)},e.prototype.rectContain=function(t,e){var i=this.transformCoordToLocal(t,e);return this.getBoundingRect().contain(i[0],i[1])},e.prototype.getPaintRect=function(){var t=this._paintRect;if(!this._paintRect||this.__dirty){var e=this.transform,i=this.getBoundingRect(),n=this.style,r=n.shadowBlur||0,o=n.shadowOffsetX||0,a=n.shadowOffsetY||0;t=this._paintRect||(this._paintRect=new yn(0,0,0,0)),e?yn.applyTransform(t,i,e):t.copy(i),(r||o||a)&&(t.width+=2*r+Math.abs(o),t.height+=2*r+Math.abs(a),t.x=Math.min(t.x,t.x+o-r),t.y=Math.min(t.y,t.y+a-r));var s=this.dirtyRectTolerance;t.isZero()||(t.x=Math.floor(t.x-s),t.y=Math.floor(t.y-s),t.width=Math.ceil(t.width+1+2*s),t.height=Math.ceil(t.height+1+2*s))}return t},e.prototype.setPrevPaintRect=function(t){t?(this._prevPaintRect=this._prevPaintRect||new yn(0,0,0,0),this._prevPaintRect.copy(t)):this._prevPaintRect=null},e.prototype.getPrevPaintRect=function(){return this._prevPaintRect},e.prototype.animateStyle=function(t){return this.animate("style",t)},e.prototype.updateDuringAnimation=function(t){"style"===t?this.dirtyStyle():this.markRedraw()},e.prototype.attrKV=function(e,i){"style"!==e?t.prototype.attrKV.call(this,e,i):this.style?this.setStyle(i):this.useStyle(i)},e.prototype.setStyle=function(t,e){return"string"==typeof t?this.style[t]=e:I(this.style,t),this.dirtyStyle(),this},e.prototype.dirtyStyle=function(t){t||this.markRedraw(),this.__dirty|=2,this._rect&&(this._rect=null)},e.prototype.dirty=function(){this.dirtyStyle()},e.prototype.styleChanged=function(){return!!(2&this.__dirty)},e.prototype.styleUpdated=function(){this.__dirty&=-3},e.prototype.createStyle=function(t){return dt(wo,t)},e.prototype.useStyle=function(t){t[bo]||(t=this.createStyle(t)),this.__inHover?this.__hoverStyle=t:this.style=t,this.dirtyStyle()},e.prototype.isStyleObject=function(t){return t[bo]},e.prototype._innerSaveToNormal=function(e){t.prototype._innerSaveToNormal.call(this,e);var i=this._normalState;e.style&&!i.style&&(i.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(e,i,To)},e.prototype._applyStateObj=function(e,i,n,r,o,a){t.prototype._applyStateObj.call(this,e,i,n,r,o,a);var s,l=!(i&&r);if(i&&i.style?o?r?s=i.style:(s=this._mergeStyle(this.createStyle(),n.style),this._mergeStyle(s,i.style)):(s=this._mergeStyle(this.createStyle(),r?this.style:n.style),this._mergeStyle(s,i.style)):l&&(s=n.style),s)if(o){var u=this.style;if(this.style=this.createStyle(l?{}:u),l)for(var c=N(u),h=0;h<c.length;h++)(d=c[h])in s&&(s[d]=s[d],this.style[d]=u[d]);var p=N(s);for(h=0;h<p.length;h++){var d=p[h];this.style[d]=this.style[d]}this._transitionState(e,{style:s},a,this.getAnimationStyleProps())}else this.useStyle(s);var f=this.__inHover?Mo:To;for(h=0;h<f.length;h++)d=f[h],i&&null!=i[d]?this[d]=i[d]:l&&null!=n[d]&&(this[d]=n[d])},e.prototype._mergeStates=function(e){for(var i,n=t.prototype._mergeStates.call(this,e),r=0;r<e.length;r++){var o=e[r];o.style&&(i=i||{},this._mergeStyle(i,o.style))}return i&&(n.style=i),n},e.prototype._mergeStyle=function(t,e){return I(t,e),t},e.prototype.getAnimationStyleProps=function(){return So},e.initDefaultProps=((n=e.prototype).type="displayable",n.invisible=!1,n.z=0,n.z2=0,n.zlevel=0,n.culling=!1,n.cursor="pointer",n.rectHover=!1,n.incremental=!1,n._rect=null,n.dirtyRectTolerance=0,void(n.__dirty=3)),e}(zn),Co=new yn(0,0,0,0),Ao=new yn(0,0,0,0),ko=Math.pow,Do=Math.sqrt,Eo=1e-8,Po=1e-4,Lo=Do(3),zo=1/3,Oo=_t(),Ro=_t(),Bo=_t();function No(t){return t>-1e-8&&t<Eo}function Fo(t){return t>Eo||t<-1e-8}function Vo(t,e,i,n,r){var o=1-r;return o*o*(o*t+3*r*e)+r*r*(r*n+3*o*i)}function Uo(t,e,i,n,r){var o=1-r;return 3*(((e-t)*o+2*(i-e)*r)*o+(n-i)*r*r)}function Go(t,e,i,n,r,o){var a=n+3*(e-i)-t,s=3*(i-2*e+t),l=3*(e-t),u=t-r,c=s*s-3*a*l,h=s*l-9*a*u,p=l*l-3*s*u,d=0;if(No(c)&&No(h))No(s)?o[0]=0:(T=-l/s)>=0&&T<=1&&(o[d++]=T);else{var f=h*h-4*c*p;if(No(f)){var m=h/c,g=-m/2;(T=-s/a+m)>=0&&T<=1&&(o[d++]=T),g>=0&&g<=1&&(o[d++]=g)}else if(f>0){var y=Do(f),v=c*s+1.5*a*(-h+y),_=c*s+1.5*a*(-h-y);(T=(-s-((v=v<0?-ko(-v,zo):ko(v,zo))+(_=_<0?-ko(-_,zo):ko(_,zo))))/(3*a))>=0&&T<=1&&(o[d++]=T)}else{var x=(2*c*s-3*a*h)/(2*Do(c*c*c)),b=Math.acos(x)/3,w=Do(c),S=Math.cos(b),T=(-s-2*w*S)/(3*a),M=(g=(w*(S+Lo*Math.sin(b))-s)/(3*a),(w*(S-Lo*Math.sin(b))-s)/(3*a));T>=0&&T<=1&&(o[d++]=T),g>=0&&g<=1&&(o[d++]=g),M>=0&&M<=1&&(o[d++]=M)}}return d}function $o(t,e,i,n,r){var o=6*i-12*e+6*t,a=9*e+3*n-3*t-9*i,s=3*e-3*t,l=0;if(No(a))Fo(o)&&(c=-s/o)>=0&&c<=1&&(r[l++]=c);else{var u=o*o-4*a*s;if(No(u))r[0]=-o/(2*a);else if(u>0){var c,h=Do(u),p=(-o-h)/(2*a);(c=(-o+h)/(2*a))>=0&&c<=1&&(r[l++]=c),p>=0&&p<=1&&(r[l++]=p)}}return l}function Wo(t,e,i,n,r,o){var a=(e-t)*r+t,s=(i-e)*r+e,l=(n-i)*r+i,u=(s-a)*r+a,c=(l-s)*r+s,h=(c-u)*r+u;o[0]=t,o[1]=a,o[2]=u,o[3]=h,o[4]=h,o[5]=c,o[6]=l,o[7]=n}function Ho(t,e,i,n,r,o,a,s,l,u,c){var h,p,d,f,m,g=.005,y=1/0;Oo[0]=l,Oo[1]=u;for(var v=0;v<1;v+=.05)Ro[0]=Vo(t,i,r,a,v),Ro[1]=Vo(e,n,o,s,v),(f=Lt(Oo,Ro))<y&&(h=v,y=f);y=1/0;for(var _=0;_<32&&!(g<Po);_++)p=h-g,d=h+g,Ro[0]=Vo(t,i,r,a,p),Ro[1]=Vo(e,n,o,s,p),f=Lt(Ro,Oo),p>=0&&f<y?(h=p,y=f):(Bo[0]=Vo(t,i,r,a,d),Bo[1]=Vo(e,n,o,s,d),m=Lt(Bo,Oo),d<=1&&m<y?(h=d,y=m):g*=.5);return c&&(c[0]=Vo(t,i,r,a,h),c[1]=Vo(e,n,o,s,h)),Do(y)}function jo(t,e,i,n,r,o,a,s,l){for(var u=t,c=e,h=0,p=1/l,d=1;d<=l;d++){var f=d*p,m=Vo(t,i,r,a,f),g=Vo(e,n,o,s,f),y=m-u,v=g-c;h+=Math.sqrt(y*y+v*v),u=m,c=g}return h}function Zo(t,e,i,n){var r=1-n;return r*(r*t+2*n*e)+n*n*i}function qo(t,e,i,n){return 2*((1-n)*(e-t)+n*(i-e))}function Xo(t,e,i){var n=t+i-2*e;return 0===n?.5:(t-e)/n}function Yo(t,e,i,n,r){var o=(e-t)*n+t,a=(i-e)*n+e,s=(a-o)*n+o;r[0]=t,r[1]=o,r[2]=s,r[3]=s,r[4]=a,r[5]=i}function Ko(t,e,i,n,r,o,a,s,l){var u,c=.005,h=1/0;Oo[0]=a,Oo[1]=s;for(var p=0;p<1;p+=.05)Ro[0]=Zo(t,i,r,p),Ro[1]=Zo(e,n,o,p),(g=Lt(Oo,Ro))<h&&(u=p,h=g);h=1/0;for(var d=0;d<32&&!(c<Po);d++){var f=u-c,m=u+c;Ro[0]=Zo(t,i,r,f),Ro[1]=Zo(e,n,o,f);var g=Lt(Ro,Oo);if(f>=0&&g<h)u=f,h=g;else{Bo[0]=Zo(t,i,r,m),Bo[1]=Zo(e,n,o,m);var y=Lt(Bo,Oo);m<=1&&y<h?(u=m,h=y):c*=.5}}return l&&(l[0]=Zo(t,i,r,u),l[1]=Zo(e,n,o,u)),Do(h)}function Jo(t,e,i,n,r,o,a){for(var s=t,l=e,u=0,c=1/a,h=1;h<=a;h++){var p=h*c,d=Zo(t,i,r,p),f=Zo(e,n,o,p),m=d-s,g=f-l;u+=Math.sqrt(m*m+g*g),s=d,l=f}return u}var Qo=Math.min,ta=Math.max,ea=Math.sin,ia=Math.cos,na=2*Math.PI,ra=_t(),oa=_t(),aa=_t();function sa(t,e,i){if(0!==t.length){for(var n=t[0],r=n[0],o=n[0],a=n[1],s=n[1],l=1;l<t.length;l++)n=t[l],r=Qo(r,n[0]),o=ta(o,n[0]),a=Qo(a,n[1]),s=ta(s,n[1]);e[0]=r,e[1]=a,i[0]=o,i[1]=s}}function la(t,e,i,n,r,o){r[0]=Qo(t,i),r[1]=Qo(e,n),o[0]=ta(t,i),o[1]=ta(e,n)}var ua=[],ca=[];function ha(t,e,i,n,r,o,a,s,l,u){var c=$o,h=Vo,p=c(t,i,r,a,ua);l[0]=1/0,l[1]=1/0,u[0]=-1/0,u[1]=-1/0;for(var d=0;d<p;d++){var f=h(t,i,r,a,ua[d]);l[0]=Qo(f,l[0]),u[0]=ta(f,u[0])}for(p=c(e,n,o,s,ca),d=0;d<p;d++){var m=h(e,n,o,s,ca[d]);l[1]=Qo(m,l[1]),u[1]=ta(m,u[1])}l[0]=Qo(t,l[0]),u[0]=ta(t,u[0]),l[0]=Qo(a,l[0]),u[0]=ta(a,u[0]),l[1]=Qo(e,l[1]),u[1]=ta(e,u[1]),l[1]=Qo(s,l[1]),u[1]=ta(s,u[1])}function pa(t,e,i,n,r,o,a,s){var l=Xo,u=Zo,c=ta(Qo(l(t,i,r),1),0),h=ta(Qo(l(e,n,o),1),0),p=u(t,i,r,c),d=u(e,n,o,h);a[0]=Qo(t,r,p),a[1]=Qo(e,o,d),s[0]=ta(t,r,p),s[1]=ta(e,o,d)}function da(t,e,i,n,r,o,a,s,l){var u=Rt,c=Bt,h=Math.abs(r-o);if(h%na<1e-4&&h>1e-4)return s[0]=t-i,s[1]=e-n,l[0]=t+i,void(l[1]=e+n);if(ra[0]=ia(r)*i+t,ra[1]=ea(r)*n+e,oa[0]=ia(o)*i+t,oa[1]=ea(o)*n+e,u(s,ra,oa),c(l,ra,oa),(r%=na)<0&&(r+=na),(o%=na)<0&&(o+=na),r>o&&!a?o+=na:r<o&&a&&(r+=na),a){var p=o;o=r,r=p}for(var d=0;d<o;d+=Math.PI/2)d>r&&(aa[0]=ia(d)*i+t,aa[1]=ea(d)*n+e,u(s,aa,s),c(l,aa,l))}var fa={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},ma=[],ga=[],ya=[],va=[],_a=[],xa=[],ba=Math.min,wa=Math.max,Sa=Math.cos,Ta=Math.sin,Ma=Math.sqrt,Ia=Math.abs,Ca=Math.PI,Aa=2*Ca,ka="undefined"!=typeof Float32Array,Da=[];function Ea(t){return Math.round(t/Ca*1e8)/1e8%2*Ca}function Pa(t,e){var i=Ea(t[0]);i<0&&(i+=Aa);var n=i-t[0],r=t[1];r+=n,!e&&r-i>=Aa?r=i+Aa:e&&i-r>=Aa?r=i-Aa:!e&&i>r?r=i+(Aa-Ea(i-r)):e&&i<r&&(r=i-(Aa-Ea(r-i))),t[0]=i,t[1]=r}var La=function(){function t(t){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,t&&(this._saveData=!1),this._saveData&&(this.data=[])}return t.prototype.increaseVersion=function(){this._version++},t.prototype.getVersion=function(){return this._version},t.prototype.setScale=function(t,e,i){(i=i||0)>0&&(this._ux=Ia(i/Bi/t)||0,this._uy=Ia(i/Bi/e)||0)},t.prototype.setDPR=function(t){this.dpr=t},t.prototype.setContext=function(t){this._ctx=t},t.prototype.getContext=function(){return this._ctx},t.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},t.prototype.reset=function(){this._saveData&&(this._len=0),this._lineDash&&(this._lineDash=null,this._dashOffset=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},t.prototype.moveTo=function(t,e){return this._drawPendingPt(),this.addData(fa.M,t,e),this._ctx&&this._ctx.moveTo(t,e),this._x0=t,this._y0=e,this._xi=t,this._yi=e,this},t.prototype.lineTo=function(t,e){var i=Ia(t-this._xi),n=Ia(e-this._yi),r=i>this._ux||n>this._uy;if(this.addData(fa.L,t,e),this._ctx&&r&&(this._needsDash?this._dashedLineTo(t,e):this._ctx.lineTo(t,e)),r)this._xi=t,this._yi=e,this._pendingPtDist=0;else{var o=i*i+n*n;o>this._pendingPtDist&&(this._pendingPtX=t,this._pendingPtY=e,this._pendingPtDist=o)}return this},t.prototype.bezierCurveTo=function(t,e,i,n,r,o){return this._drawPendingPt(),this.addData(fa.C,t,e,i,n,r,o),this._ctx&&(this._needsDash?this._dashedBezierTo(t,e,i,n,r,o):this._ctx.bezierCurveTo(t,e,i,n,r,o)),this._xi=r,this._yi=o,this},t.prototype.quadraticCurveTo=function(t,e,i,n){return this._drawPendingPt(),this.addData(fa.Q,t,e,i,n),this._ctx&&(this._needsDash?this._dashedQuadraticTo(t,e,i,n):this._ctx.quadraticCurveTo(t,e,i,n)),this._xi=i,this._yi=n,this},t.prototype.arc=function(t,e,i,n,r,o){this._drawPendingPt(),Da[0]=n,Da[1]=r,Pa(Da,o),n=Da[0];var a=(r=Da[1])-n;return this.addData(fa.A,t,e,i,i,n,a,0,o?0:1),this._ctx&&this._ctx.arc(t,e,i,n,r,o),this._xi=Sa(r)*i+t,this._yi=Ta(r)*i+e,this},t.prototype.arcTo=function(t,e,i,n,r){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(t,e,i,n,r),this},t.prototype.rect=function(t,e,i,n){return this._drawPendingPt(),this._ctx&&this._ctx.rect(t,e,i,n),this.addData(fa.R,t,e,i,n),this},t.prototype.closePath=function(){this._drawPendingPt(),this.addData(fa.Z);var t=this._ctx,e=this._x0,i=this._y0;return t&&(this._needsDash&&this._dashedLineTo(e,i),t.closePath()),this._xi=e,this._yi=i,this},t.prototype.fill=function(t){t&&t.fill(),this.toStatic()},t.prototype.stroke=function(t){t&&t.stroke(),this.toStatic()},t.prototype.setLineDash=function(t){if(t instanceof Array){this._lineDash=t,this._dashIdx=0;for(var e=0,i=0;i<t.length;i++)e+=t[i];this._dashSum=e,this._needsDash=!0}else this._lineDash=null,this._needsDash=!1;return this},t.prototype.setLineDashOffset=function(t){return this._dashOffset=t,this},t.prototype.len=function(){return this._len},t.prototype.setData=function(t){var e=t.length;this.data&&this.data.length===e||!ka||(this.data=new Float32Array(e));for(var i=0;i<e;i++)this.data[i]=t[i];this._len=e},t.prototype.appendPath=function(t){t instanceof Array||(t=[t]);for(var e=t.length,i=0,n=this._len,r=0;r<e;r++)i+=t[r].len();for(ka&&this.data instanceof Float32Array&&(this.data=new Float32Array(n+i)),r=0;r<e;r++)for(var o=t[r].data,a=0;a<o.length;a++)this.data[n++]=o[a];this._len=n},t.prototype.addData=function(t,e,i,n,r,o,a,s,l){if(this._saveData){var u=this.data;this._len+arguments.length>u.length&&(this._expandData(),u=this.data);for(var c=0;c<arguments.length;c++)u[this._len++]=arguments[c]}},t.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},t.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var t=[],e=0;e<this._len;e++)t[e]=this.data[e];this.data=t}},t.prototype._dashedLineTo=function(t,e){var i,n,r=this._dashSum,o=this._lineDash,a=this._ctx,s=this._dashOffset,l=this._xi,u=this._yi,c=t-l,h=e-u,p=Ma(c*c+h*h),d=l,f=u,m=o.length;for(s<0&&(s=r+s),d-=(s%=r)*(c/=p),f-=s*(h/=p);c>0&&d<=t||c<0&&d>=t||0===c&&(h>0&&f<=e||h<0&&f>=e);)d+=c*(i=o[n=this._dashIdx]),f+=h*i,this._dashIdx=(n+1)%m,c>0&&d<l||c<0&&d>l||h>0&&f<u||h<0&&f>u||a[n%2?"moveTo":"lineTo"](c>=0?ba(d,t):wa(d,t),h>=0?ba(f,e):wa(f,e));c=d-t,h=f-e,this._dashOffset=-Ma(c*c+h*h)},t.prototype._dashedBezierTo=function(t,e,i,n,r,o){var a,s,l,u,c,h=this._ctx,p=this._dashSum,d=this._dashOffset,f=this._lineDash,m=this._xi,g=this._yi,y=0,v=this._dashIdx,_=f.length,x=0;for(d<0&&(d=p+d),d%=p,a=0;a<1;a+=.1)s=Vo(m,t,i,r,a+.1)-Vo(m,t,i,r,a),l=Vo(g,e,n,o,a+.1)-Vo(g,e,n,o,a),y+=Ma(s*s+l*l);for(;v<_&&!((x+=f[v])>d);v++);for(a=(x-d)/y;a<=1;)u=Vo(m,t,i,r,a),c=Vo(g,e,n,o,a),v%2?h.moveTo(u,c):h.lineTo(u,c),a+=f[v]/y,v=(v+1)%_;v%2!=0&&h.lineTo(r,o),s=r-u,l=o-c,this._dashOffset=-Ma(s*s+l*l)},t.prototype._dashedQuadraticTo=function(t,e,i,n){var r=i,o=n;i=(i+2*t)/3,n=(n+2*e)/3,t=(this._xi+2*t)/3,e=(this._yi+2*e)/3,this._dashedBezierTo(t,e,i,n,r,o)},t.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var t=this.data;t instanceof Array&&(t.length=this._len,ka&&this._len>11&&(this.data=new Float32Array(t)))}},t.prototype.getBoundingRect=function(){ya[0]=ya[1]=_a[0]=_a[1]=Number.MAX_VALUE,va[0]=va[1]=xa[0]=xa[1]=-Number.MAX_VALUE;var t,e=this.data,i=0,n=0,r=0,o=0;for(t=0;t<this._len;){var a=e[t++],s=1===t;switch(s&&(r=i=e[t],o=n=e[t+1]),a){case fa.M:i=r=e[t++],n=o=e[t++],_a[0]=r,_a[1]=o,xa[0]=r,xa[1]=o;break;case fa.L:la(i,n,e[t],e[t+1],_a,xa),i=e[t++],n=e[t++];break;case fa.C:ha(i,n,e[t++],e[t++],e[t++],e[t++],e[t],e[t+1],_a,xa),i=e[t++],n=e[t++];break;case fa.Q:pa(i,n,e[t++],e[t++],e[t],e[t+1],_a,xa),i=e[t++],n=e[t++];break;case fa.A:var l=e[t++],u=e[t++],c=e[t++],h=e[t++],p=e[t++],d=e[t++]+p;t+=1;var f=!e[t++];s&&(r=Sa(p)*c+l,o=Ta(p)*h+u),da(l,u,c,h,p,d,f,_a,xa),i=Sa(d)*c+l,n=Ta(d)*h+u;break;case fa.R:la(r=i=e[t++],o=n=e[t++],r+e[t++],o+e[t++],_a,xa);break;case fa.Z:i=r,n=o}Rt(ya,ya,_a),Bt(va,va,xa)}return 0===t&&(ya[0]=ya[1]=va[0]=va[1]=0),new yn(ya[0],ya[1],va[0]-ya[0],va[1]-ya[1])},t.prototype._calculateLength=function(){var t=this.data,e=this._len,i=this._ux,n=this._uy,r=0,o=0,a=0,s=0;this._pathSegLen||(this._pathSegLen=[]);for(var l=this._pathSegLen,u=0,c=0,h=0;h<e;){var p=t[h++],d=1===h;d&&(a=r=t[h],s=o=t[h+1]);var f=-1;switch(p){case fa.M:r=a=t[h++],o=s=t[h++];break;case fa.L:var m=t[h++],g=(_=t[h++])-o;(Ia(k=m-r)>i||Ia(g)>n||h===e-1)&&(f=Math.sqrt(k*k+g*g),r=m,o=_);break;case fa.C:var y=t[h++],v=t[h++],_=(m=t[h++],t[h++]),x=t[h++],b=t[h++];f=jo(r,o,y,v,m,_,x,b,10),r=x,o=b;break;case fa.Q:f=Jo(r,o,y=t[h++],v=t[h++],m=t[h++],_=t[h++],10),r=m,o=_;break;case fa.A:var w=t[h++],S=t[h++],T=t[h++],M=t[h++],I=t[h++],C=t[h++],A=C+I;h+=1,t[h++],d&&(a=Sa(I)*T+w,s=Ta(I)*M+S),f=wa(T,M)*ba(Aa,Math.abs(C)),r=Sa(A)*T+w,o=Ta(A)*M+S;break;case fa.R:a=r=t[h++],s=o=t[h++],f=2*t[h++]+2*t[h++];break;case fa.Z:var k=a-r;f=Math.sqrt(k*k+(g=s-o)*g),r=a,o=s}f>=0&&(l[c++]=f,u+=f)}return this._pathLen=u,u},t.prototype.rebuildPath=function(t,e){var i,n,r,o,a,s,l,u,c,h,p=this.data,d=this._ux,f=this._uy,m=this._len,g=e<1,y=0,v=0,_=0;if(!g||(this._pathSegLen||this._calculateLength(),l=this._pathSegLen,u=e*this._pathLen))t:for(var x=0;x<m;){var b=p[x++],w=1===x;switch(w&&(i=r=p[x],n=o=p[x+1]),b!==fa.L&&_>0&&(t.lineTo(c,h),_=0),b){case fa.M:i=r=p[x++],n=o=p[x++],t.moveTo(r,o);break;case fa.L:a=p[x++],s=p[x++];var S=Ia(a-r),T=Ia(s-o);if(S>d||T>f){if(g){if(y+(q=l[v++])>u){var M=(u-y)/q;t.lineTo(r*(1-M)+a*M,o*(1-M)+s*M);break t}y+=q}t.lineTo(a,s),r=a,o=s,_=0}else{var I=S*S+T*T;I>_&&(c=a,h=s,_=I)}break;case fa.C:var C=p[x++],A=p[x++],k=p[x++],D=p[x++],E=p[x++],P=p[x++];if(g){if(y+(q=l[v++])>u){Wo(r,C,k,E,M=(u-y)/q,ma),Wo(o,A,D,P,M,ga),t.bezierCurveTo(ma[1],ga[1],ma[2],ga[2],ma[3],ga[3]);break t}y+=q}t.bezierCurveTo(C,A,k,D,E,P),r=E,o=P;break;case fa.Q:if(C=p[x++],A=p[x++],k=p[x++],D=p[x++],g){if(y+(q=l[v++])>u){Yo(r,C,k,M=(u-y)/q,ma),Yo(o,A,D,M,ga),t.quadraticCurveTo(ma[1],ga[1],ma[2],ga[2]);break t}y+=q}t.quadraticCurveTo(C,A,k,D),r=k,o=D;break;case fa.A:var L=p[x++],z=p[x++],O=p[x++],R=p[x++],B=p[x++],N=p[x++],F=p[x++],V=!p[x++],U=O>R?O:R,G=Ia(O-R)>.001,$=B+N,W=!1;if(g&&(y+(q=l[v++])>u&&($=B+N*(u-y)/q,W=!0),y+=q),G&&t.ellipse?t.ellipse(L,z,O,R,F,B,$,V):t.arc(L,z,U,B,$,V),W)break t;w&&(i=Sa(B)*O+L,n=Ta(B)*R+z),r=Sa($)*O+L,o=Ta($)*R+z;break;case fa.R:i=r=p[x],n=o=p[x+1],a=p[x++],s=p[x++];var H=p[x++],j=p[x++];if(g){if(y+(q=l[v++])>u){var Z=u-y;t.moveTo(a,s),t.lineTo(a+ba(Z,H),s),(Z-=H)>0&&t.lineTo(a+H,s+ba(Z,j)),(Z-=j)>0&&t.lineTo(a+wa(H-Z,0),s+j),(Z-=H)>0&&t.lineTo(a,s+wa(j-Z,0));break t}y+=q}t.rect(a,s,H,j);break;case fa.Z:if(g){var q;if(y+(q=l[v++])>u){M=(u-y)/q,t.lineTo(r*(1-M)+i*M,o*(1-M)+n*M);break t}y+=q}t.closePath(),r=i,o=n}}},t.prototype.clone=function(){var e=new t,i=this.data;return e.data=i.slice?i.slice():Array.prototype.slice.call(i),e._len=this._len,e},t.CMD=fa,t.initDefaultProps=((e=t.prototype)._saveData=!0,e._needsDash=!1,e._dashOffset=0,e._dashIdx=0,e._dashSum=0,e._ux=0,e._uy=0,e._pendingPtDist=0,void(e._version=0)),t;var e}();function za(t,e,i,n,r,o,a){if(0===r)return!1;var s=r,l=0;if(a>e+s&&a>n+s||a<e-s&&a<n-s||o>t+s&&o>i+s||o<t-s&&o<i-s)return!1;if(t===i)return Math.abs(o-t)<=s/2;var u=(l=(e-n)/(t-i))*o-a+(t*n-i*e)/(t-i);return u*u/(l*l+1)<=s/2*s/2}function Oa(t,e,i,n,r,o,a,s,l,u,c){if(0===l)return!1;var h=l;return!(c>e+h&&c>n+h&&c>o+h&&c>s+h||c<e-h&&c<n-h&&c<o-h&&c<s-h||u>t+h&&u>i+h&&u>r+h&&u>a+h||u<t-h&&u<i-h&&u<r-h&&u<a-h)&&Ho(t,e,i,n,r,o,a,s,u,c,null)<=h/2}function Ra(t,e,i,n,r,o,a,s,l){if(0===a)return!1;var u=a;return!(l>e+u&&l>n+u&&l>o+u||l<e-u&&l<n-u&&l<o-u||s>t+u&&s>i+u&&s>r+u||s<t-u&&s<i-u&&s<r-u)&&Ko(t,e,i,n,r,o,s,l,null)<=u/2}var Ba=2*Math.PI;function Na(t){return(t%=Ba)<0&&(t+=Ba),t}var Fa=2*Math.PI;function Va(t,e,i,n,r,o,a,s,l){if(0===a)return!1;var u=a,c=Math.sqrt((s-=t)*s+(l-=e)*l);if(c-u>i||c+u<i)return!1;if(Math.abs(n-r)%Fa<1e-4)return!0;if(o){var h=n;n=Na(r),r=Na(h)}else n=Na(n),r=Na(r);n>r&&(r+=Fa);var p=Math.atan2(l,s);return p<0&&(p+=Fa),p>=n&&p<=r||p+Fa>=n&&p+Fa<=r}function Ua(t,e,i,n,r,o){if(o>e&&o>n||o<e&&o<n)return 0;if(n===e)return 0;var a=(o-e)/(n-e),s=n<e?1:-1;1!==a&&0!==a||(s=n<e?.5:-.5);var l=a*(i-t)+t;return l===r?1/0:l>r?s:0}var Ga=La.CMD,$a=2*Math.PI,Wa=[-1,-1,-1],Ha=[-1,-1];function ja(t,e,i,n,r,o,a,s,l,u){if(u>e&&u>n&&u>o&&u>s||u<e&&u<n&&u<o&&u<s)return 0;var c,h=Go(e,n,o,s,u,Wa);if(0===h)return 0;for(var p=0,d=-1,f=void 0,m=void 0,g=0;g<h;g++){var y=Wa[g],v=0===y||1===y?.5:1;Vo(t,i,r,a,y)<l||(d<0&&(d=$o(e,n,o,s,Ha),Ha[1]<Ha[0]&&d>1&&(c=void 0,c=Ha[0],Ha[0]=Ha[1],Ha[1]=c),f=Vo(e,n,o,s,Ha[0]),d>1&&(m=Vo(e,n,o,s,Ha[1]))),2===d?y<Ha[0]?p+=f<e?v:-v:y<Ha[1]?p+=m<f?v:-v:p+=s<m?v:-v:y<Ha[0]?p+=f<e?v:-v:p+=s<f?v:-v)}return p}function Za(t,e,i,n,r,o,a,s){if(s>e&&s>n&&s>o||s<e&&s<n&&s<o)return 0;var l=function(t,e,i,n,r){var o=t-2*e+i,a=2*(e-t),s=t-n,l=0;if(No(o))Fo(a)&&(c=-s/a)>=0&&c<=1&&(r[l++]=c);else{var u=a*a-4*o*s;if(No(u))(c=-a/(2*o))>=0&&c<=1&&(r[l++]=c);else if(u>0){var c,h=Do(u),p=(-a-h)/(2*o);(c=(-a+h)/(2*o))>=0&&c<=1&&(r[l++]=c),p>=0&&p<=1&&(r[l++]=p)}}return l}(e,n,o,s,Wa);if(0===l)return 0;var u=Xo(e,n,o);if(u>=0&&u<=1){for(var c=0,h=Zo(e,n,o,u),p=0;p<l;p++){var d=0===Wa[p]||1===Wa[p]?.5:1;Zo(t,i,r,Wa[p])<a||(Wa[p]<u?c+=h<e?d:-d:c+=o<h?d:-d)}return c}return d=0===Wa[0]||1===Wa[0]?.5:1,Zo(t,i,r,Wa[0])<a?0:o<e?d:-d}function qa(t,e,i,n,r,o,a,s){if((s-=e)>i||s<-i)return 0;var l=Math.sqrt(i*i-s*s);Wa[0]=-l,Wa[1]=l;var u=Math.abs(n-r);if(u<1e-4)return 0;if(u>=$a-1e-4){n=0,r=$a;var c=o?1:-1;return a>=Wa[0]+t&&a<=Wa[1]+t?c:0}if(n>r){var h=n;n=r,r=h}n<0&&(n+=$a,r+=$a);for(var p=0,d=0;d<2;d++){var f=Wa[d];if(f+t>a){var m=Math.atan2(s,f);c=o?1:-1,m<0&&(m=$a+m),(m>=n&&m<=r||m+$a>=n&&m+$a<=r)&&(m>Math.PI/2&&m<1.5*Math.PI&&(c=-c),p+=c)}}return p}function Xa(t,e,i,n,r){for(var o,a,s,l,u=t.data,c=t.len(),h=0,p=0,d=0,f=0,m=0,g=0;g<c;){var y=u[g++],v=1===g;switch(y===Ga.M&&g>1&&(i||(h+=Ua(p,d,f,m,n,r))),v&&(f=p=u[g],m=d=u[g+1]),y){case Ga.M:p=f=u[g++],d=m=u[g++];break;case Ga.L:if(i){if(za(p,d,u[g],u[g+1],e,n,r))return!0}else h+=Ua(p,d,u[g],u[g+1],n,r)||0;p=u[g++],d=u[g++];break;case Ga.C:if(i){if(Oa(p,d,u[g++],u[g++],u[g++],u[g++],u[g],u[g+1],e,n,r))return!0}else h+=ja(p,d,u[g++],u[g++],u[g++],u[g++],u[g],u[g+1],n,r)||0;p=u[g++],d=u[g++];break;case Ga.Q:if(i){if(Ra(p,d,u[g++],u[g++],u[g],u[g+1],e,n,r))return!0}else h+=Za(p,d,u[g++],u[g++],u[g],u[g+1],n,r)||0;p=u[g++],d=u[g++];break;case Ga.A:var _=u[g++],x=u[g++],b=u[g++],w=u[g++],S=u[g++],T=u[g++];g+=1;var M=!!(1-u[g++]);o=Math.cos(S)*b+_,a=Math.sin(S)*w+x,v?(f=o,m=a):h+=Ua(p,d,o,a,n,r);var I=(n-_)*w/b+_;if(i){if(Va(_,x,w,S,S+T,M,e,I,r))return!0}else h+=qa(_,x,w,S,S+T,M,I,r);p=Math.cos(S+T)*b+_,d=Math.sin(S+T)*w+x;break;case Ga.R:if(f=p=u[g++],m=d=u[g++],o=f+u[g++],a=m+u[g++],i){if(za(f,m,o,m,e,n,r)||za(o,m,o,a,e,n,r)||za(o,a,f,a,e,n,r)||za(f,a,f,m,e,n,r))return!0}else h+=Ua(o,m,o,a,n,r),h+=Ua(f,a,f,m,n,r);break;case Ga.Z:if(i){if(za(p,d,f,m,e,n,r))return!0}else h+=Ua(p,d,f,m,n,r);p=f,d=m}}return i||Math.abs((s=d)-(l=m))<1e-4||(h+=Ua(p,d,f,m,n,r)||0),0!==h}var Ya=C({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},wo),Ka={style:C({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},So.style)},Ja=["x","y","rotation","scaleX","scaleY","originX","originY","invisible","culling","z","z2","zlevel","parent"],Qa=function(t){function e(e){return t.call(this,e)||this}var n;return i(e,t),e.prototype.update=function(){var i=this;t.prototype.update.call(this);var n=this.style;if(n.decal){var r=this._decalEl=this._decalEl||new e;r.buildPath===e.prototype.buildPath&&(r.buildPath=function(t){i.buildPath(t,i.shape)}),r.silent=!0;var o=r.style;for(var a in n)o[a]!==n[a]&&(o[a]=n[a]);o.fill=n.fill?n.decal:null,o.decal=null,o.shadowColor=null,n.strokeFirst&&(o.stroke=null);for(var s=0;s<13;++s)r[Ja[s]]=this[Ja[s]];r.__dirty|=1}else this._decalEl&&(this._decalEl=null)},e.prototype.getDecalElement=function(){return this._decalEl},e.prototype._init=function(e){var i=N(e);this.shape=this.getDefaultShape();var n=this.getDefaultStyle();n&&this.useStyle(n);for(var r=0;r<i.length;r++){var o=i[r],a=e[o];"style"===o?this.style?I(this.style,a):this.useStyle(a):"shape"===o?I(this.shape,a):t.prototype.attrKV.call(this,o,a)}this.style||this.useStyle({})},e.prototype.getDefaultStyle=function(){return null},e.prototype.getDefaultShape=function(){return{}},e.prototype.canBeInsideText=function(){return this.hasFill()},e.prototype.getInsideTextFill=function(){var t=this.style.fill;if("none"!==t){if($(t)){var e=ti(t,0);return e>.5?Ni:e>.2?"#eee":Fi}if(t)return Fi}return Ni},e.prototype.getInsideTextStroke=function(t){var e=this.style.fill;if($(e)){var i=this.__zr;if(!(!i||!i.isDarkMode())==ti(t,0)<.4)return e}},e.prototype.buildPath=function(t,e,i){},e.prototype.pathUpdated=function(){this.__dirty&=-5},e.prototype.getUpdatedPathProxy=function(t){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,t),this.path},e.prototype.createPathProxy=function(){this.path=new La(!1)},e.prototype.hasStroke=function(){var t=this.style,e=t.stroke;return!(null==e||"none"===e||!(t.lineWidth>0))},e.prototype.hasFill=function(){var t=this.style.fill;return null!=t&&"none"!==t},e.prototype.getBoundingRect=function(){var t=this._rect,e=this.style,i=!t;if(i){var n=!1;this.path||(n=!0,this.createPathProxy());var r=this.path;(n||4&this.__dirty)&&(r.beginPath(),this.buildPath(r,this.shape,!1),this.pathUpdated()),t=r.getBoundingRect()}if(this._rect=t,this.hasStroke()&&this.path&&this.path.len()>0){var o=this._rectWithStroke||(this._rectWithStroke=t.clone());if(this.__dirty||i){o.copy(t);var a=e.strokeNoScale?this.getLineScale():1,s=e.lineWidth;if(!this.hasFill()){var l=this.strokeContainThreshold;s=Math.max(s,null==l?4:l)}a>1e-10&&(o.width+=s/a,o.height+=s/a,o.x-=s/a/2,o.y-=s/a/2)}return o}return t},e.prototype.contain=function(t,e){var i=this.transformCoordToLocal(t,e),n=this.getBoundingRect(),r=this.style;if(t=i[0],e=i[1],n.contain(t,e)){var o=this.path;if(this.hasStroke()){var a=r.lineWidth,s=r.strokeNoScale?this.getLineScale():1;if(s>1e-10&&(this.hasFill()||(a=Math.max(a,this.strokeContainThreshold)),function(t,e,i,n){return Xa(t,e,!0,i,n)}(o,a/s,t,e)))return!0}if(this.hasFill())return function(t,e,i){return Xa(t,0,!1,e,i)}(o,t,e)}return!1},e.prototype.dirtyShape=function(){this.__dirty|=4,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},e.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},e.prototype.animateShape=function(t){return this.animate("shape",t)},e.prototype.updateDuringAnimation=function(t){"style"===t?this.dirtyStyle():"shape"===t?this.dirtyShape():this.markRedraw()},e.prototype.attrKV=function(e,i){"shape"===e?this.setShape(i):t.prototype.attrKV.call(this,e,i)},e.prototype.setShape=function(t,e){var i=this.shape;return i||(i=this.shape={}),"string"==typeof t?i[t]=e:I(i,t),this.dirtyShape(),this},e.prototype.shapeChanged=function(){return!!(4&this.__dirty)},e.prototype.createStyle=function(t){return dt(Ya,t)},e.prototype._innerSaveToNormal=function(e){t.prototype._innerSaveToNormal.call(this,e);var i=this._normalState;e.shape&&!i.shape&&(i.shape=I({},this.shape))},e.prototype._applyStateObj=function(e,i,n,r,o,a){t.prototype._applyStateObj.call(this,e,i,n,r,o,a);var s,l=!(i&&r);if(i&&i.shape?o?r?s=i.shape:(s=I({},n.shape),I(s,i.shape)):(s=I({},r?this.shape:n.shape),I(s,i.shape)):l&&(s=n.shape),s)if(o){this.shape=I({},this.shape);for(var u={},c=N(s),h=0;h<c.length;h++){var p=c[h];"object"==typeof s[p]?this.shape[p]=s[p]:u[p]=s[p]}this._transitionState(e,{shape:u},a)}else this.shape=s,this.dirtyShape()},e.prototype._mergeStates=function(e){for(var i,n=t.prototype._mergeStates.call(this,e),r=0;r<e.length;r++){var o=e[r];o.shape&&(i=i||{},this._mergeStyle(i,o.shape))}return i&&(n.shape=i),n},e.prototype.getAnimationStyleProps=function(){return Ka},e.prototype.isZeroArea=function(){return!1},e.extend=function(t){var n=function(e){function n(i){var n=e.call(this,i)||this;return t.init&&t.init.call(n,i),n}return i(n,e),n.prototype.getDefaultStyle=function(){return S(t.style)},n.prototype.getDefaultShape=function(){return S(t.shape)},n}(e);for(var r in t)"function"==typeof t[r]&&(n.prototype[r]=t[r]);return n},e.initDefaultProps=((n=e.prototype).type="path",n.strokeContainThreshold=5,n.segmentIgnoreThreshold=0,n.subPixelOptimize=!1,n.autoBatch=!1,void(n.__dirty=7)),e}(Io),ts=C({strokeFirst:!0,font:_n,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},Ya),es=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.hasStroke=function(){var t=this.style,e=t.stroke;return null!=e&&"none"!==e&&t.lineWidth>0},e.prototype.hasFill=function(){var t=this.style.fill;return null!=t&&"none"!==t},e.prototype.createStyle=function(t){return dt(ts,t)},e.prototype.setBoundingRect=function(t){this._rect=t},e.prototype.getBoundingRect=function(){var t=this.style;if(!this._rect){var e=t.text;null!=e?e+="":e="";var i=Sn(e,t.font,t.textAlign,t.textBaseline);if(i.x+=t.x||0,i.y+=t.y||0,this.hasStroke()){var n=t.lineWidth;i.x-=n/2,i.y-=n/2,i.width+=n,i.height+=n}this._rect=i}return this._rect},e.initDefaultProps=void(e.prototype.dirtyRectTolerance=10),e}(Io);es.prototype.type="tspan";var is=C({x:0,y:0},wo),ns={style:C({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},So.style)},rs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.createStyle=function(t){return dt(is,t)},e.prototype._getSize=function(t){var e=this.style,i=e[t];if(null!=i)return i;var n,r=(n=e.image)&&"string"!=typeof n&&n.width&&n.height?e.image:this.__image;if(!r)return 0;var o="width"===t?"height":"width",a=e[o];return null==a?r[t]:r[t]/r[o]*a},e.prototype.getWidth=function(){return this._getSize("width")},e.prototype.getHeight=function(){return this._getSize("height")},e.prototype.getAnimationStyleProps=function(){return ns},e.prototype.getBoundingRect=function(){var t=this.style;return this._rect||(this._rect=new yn(t.x||0,t.y||0,this.getWidth(),this.getHeight())),this._rect},e}(Io);rs.prototype.type="image";var os=Math.round;function as(t,e,i){if(e){var n=e.x1,r=e.x2,o=e.y1,a=e.y2;t.x1=n,t.x2=r,t.y1=o,t.y2=a;var s=i&&i.lineWidth;return s?(os(2*n)===os(2*r)&&(t.x1=t.x2=ls(n,s,!0)),os(2*o)===os(2*a)&&(t.y1=t.y2=ls(o,s,!0)),t):t}}function ss(t,e,i){if(e){var n=e.x,r=e.y,o=e.width,a=e.height;t.x=n,t.y=r,t.width=o,t.height=a;var s=i&&i.lineWidth;return s?(t.x=ls(n,s,!0),t.y=ls(r,s,!0),t.width=Math.max(ls(n+o,s,!1)-t.x,0===o?0:1),t.height=Math.max(ls(r+a,s,!1)-t.y,0===a?0:1),t):t}}function ls(t,e,i){if(!e)return t;var n=os(2*t);return(n+os(e))%2==0?n/2:(n+(i?1:-1))/2}var us=function(){this.x=0,this.y=0,this.width=0,this.height=0},cs={},hs=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getDefaultShape=function(){return new us},e.prototype.buildPath=function(t,e){var i,n,r,o;if(this.subPixelOptimize){var a=ss(cs,e,this.style);i=a.x,n=a.y,r=a.width,o=a.height,a.r=e.r,e=a}else i=e.x,n=e.y,r=e.width,o=e.height;e.r?function(t,e){var i,n,r,o,a,s=e.x,l=e.y,u=e.width,c=e.height,h=e.r;u<0&&(s+=u,u=-u),c<0&&(l+=c,c=-c),"number"==typeof h?i=n=r=o=h:h instanceof Array?1===h.length?i=n=r=o=h[0]:2===h.length?(i=r=h[0],n=o=h[1]):3===h.length?(i=h[0],n=o=h[1],r=h[2]):(i=h[0],n=h[1],r=h[2],o=h[3]):i=n=r=o=0,i+n>u&&(i*=u/(a=i+n),n*=u/a),r+o>u&&(r*=u/(a=r+o),o*=u/a),n+r>c&&(n*=c/(a=n+r),r*=c/a),i+o>c&&(i*=c/(a=i+o),o*=c/a),t.moveTo(s+i,l),t.lineTo(s+u-n,l),0!==n&&t.arc(s+u-n,l+n,n,-Math.PI/2,0),t.lineTo(s+u,l+c-r),0!==r&&t.arc(s+u-r,l+c-r,r,0,Math.PI/2),t.lineTo(s+o,l+c),0!==o&&t.arc(s+o,l+c-o,o,Math.PI/2,Math.PI),t.lineTo(s,l+i),0!==i&&t.arc(s+i,l+i,i,Math.PI,1.5*Math.PI)}(t,e):t.rect(i,n,r,o)},e.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},e}(Qa);hs.prototype.type="rect";var ps={fill:"#000"},ds={style:C({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},So.style)},fs=function(t){function e(e){var i=t.call(this)||this;return i.type="text",i._children=[],i._defaultStyle=ps,i.attr(e),i}return i(e,t),e.prototype.childrenRef=function(){return this._children},e.prototype.update=function(){t.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var e=0;e<this._children.length;e++){var i=this._children[e];i.zlevel=this.zlevel,i.z=this.z,i.z2=this.z2,i.culling=this.culling,i.cursor=this.cursor,i.invisible=this.invisible}},e.prototype.updateTransform=function(){var e=this.innerTransformable;e?(e.updateTransform(),e.transform&&(this.transform=e.transform)):t.prototype.updateTransform.call(this)},e.prototype.getLocalTransform=function(e){var i=this.innerTransformable;return i?i.getLocalTransform(e):t.prototype.getLocalTransform.call(this,e)},e.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),t.prototype.getComputedTransform.call(this)},e.prototype._updateSubTexts=function(){var t;this._childCursor=0,ys(t=this.style),L(t.rich,ys),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},e.prototype.addSelfToZr=function(e){t.prototype.addSelfToZr.call(this,e);for(var i=0;i<this._children.length;i++)this._children[i].__zr=e},e.prototype.removeSelfFromZr=function(e){t.prototype.removeSelfFromZr.call(this,e);for(var i=0;i<this._children.length;i++)this._children[i].__zr=null},e.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var t=new yn(0,0,0,0),e=this._children,i=[],n=null,r=0;r<e.length;r++){var o=e[r],a=o.getBoundingRect(),s=o.getLocalTransform(i);s?(t.copy(a),t.applyTransform(s),(n=n||t.clone()).union(t)):(n=n||a.clone()).union(a)}this._rect=n||t}return this._rect},e.prototype.setDefaultTextStyle=function(t){this._defaultStyle=t||ps},e.prototype.setTextContent=function(t){throw Error("Can't attach text on another text")},e.prototype._mergeStyle=function(t,e){if(!e)return t;var i=e.rich,n=t.rich||i&&{};return I(t,e),i&&n?(this._mergeRich(n,i),t.rich=n):n&&(t.rich=n),t},e.prototype._mergeRich=function(t,e){for(var i=N(e),n=0;n<i.length;n++){var r=i[n];t[r]=t[r]||{},I(t[r],e[r])}},e.prototype.getAnimationStyleProps=function(){return ds},e.prototype._getOrCreateChild=function(t){var e=this._children[this._childCursor];return e&&e instanceof t||(e=new t),this._children[this._childCursor++]=e,e.__zr=this.__zr,e.parent=this,e},e.prototype._updatePlainTexts=function(){var t=this.style,e=t.font||_n,i=t.padding,n=function(t,e){null!=t&&(t+="");var i,n=e.overflow,r=e.padding,o=e.font,a="truncate"===n,s=In(o),l=et(e.lineHeight,s),u="truncate"===e.lineOverflow,c=e.width,h=(i=null!=c&&"break"===n||"breakAll"===n?t?xo(t,e.font,c,"breakAll"===n,0).lines:[]:t?t.split("\n"):[]).length*l,p=et(e.height,h);if(h>p&&u){var d=Math.floor(p/l);i=i.slice(0,d)}var f=p,m=c;if(r&&(f+=r[0]+r[2],null!=m&&(m+=r[1]+r[3])),t&&a&&null!=m)for(var g=co(c,o,e.ellipsis,{minChar:e.truncateMinChar,placeholder:e.placeholder}),y=0;y<i.length;y++)i[y]=ho(i[y],g);if(null==c){var v=0;for(y=0;y<i.length;y++)v=Math.max(bn(i[y],o),v);c=v}return{lines:i,height:p,outerHeight:f,lineHeight:l,calculatedLineHeight:s,contentHeight:h,width:c}}(bs(t),t),r=ws(t),o=!!t.backgroundColor,a=n.outerHeight,s=n.lines,l=n.lineHeight,u=this._defaultStyle,c=t.x||0,h=t.y||0,p=t.align||u.align||"left",d=t.verticalAlign||u.verticalAlign||"top",f=c,m=Mn(h,n.contentHeight,d);if(r||i){var g=n.width;i&&(g+=i[1]+i[3]);var y=Tn(c,g,p),v=Mn(h,a,d);r&&this._renderBackground(t,t,y,v,g,a)}m+=l/2,i&&(f=xs(c,p,i),"top"===d?m+=i[0]:"bottom"===d&&(m-=i[2]));for(var _=0,x=!1,b=(_s("fill"in t?t.fill:(x=!0,u.fill))),w=(vs("stroke"in t?t.stroke:o||u.autoStroke&&!x?null:(_=2,u.stroke))),S=t.textShadowBlur>0,T=null!=t.width&&("truncate"===t.overflow||"break"===t.overflow||"breakAll"===t.overflow),M=n.calculatedLineHeight,I=0;I<s.length;I++){var C=this._getOrCreateChild(es),A=C.createStyle();C.useStyle(A),A.text=s[I],A.x=f,A.y=m,p&&(A.textAlign=p),A.textBaseline="middle",A.opacity=t.opacity,A.strokeFirst=!0,S&&(A.shadowBlur=t.textShadowBlur||0,A.shadowColor=t.textShadowColor||"transparent",A.shadowOffsetX=t.textShadowOffsetX||0,A.shadowOffsetY=t.textShadowOffsetY||0),w&&(A.stroke=w,A.lineWidth=t.lineWidth||_,A.lineDash=t.lineDash,A.lineDashOffset=t.lineDashOffset||0),b&&(A.fill=b),A.font=e,m+=l,T&&C.setBoundingRect(new yn(Tn(A.x,t.width,A.textAlign),Mn(A.y,M,A.textBaseline),t.width,M))}},e.prototype._updateRichTexts=function(){var t=this.style,e=function(t,e){var i=new go;if(null!=t&&(t+=""),!t)return i;for(var n,r=e.width,o=e.height,a=e.overflow,s="break"!==a&&"breakAll"!==a||null==r?null:{width:r,accumWidth:0,breakAll:"breakAll"===a},l=lo.lastIndex=0;null!=(n=lo.exec(t));){var u=n.index;u>l&&yo(i,t.substring(l,u),e,s),yo(i,n[2],e,s,n[1]),l=lo.lastIndex}l<t.length&&yo(i,t.substring(l,t.length),e,s);var c=[],h=0,p=0,d=e.padding,f="truncate"===a,m="truncate"===e.lineOverflow;function g(t,e,i){t.width=e,t.lineHeight=i,h+=i,p=Math.max(p,e)}t:for(var y=0;y<i.lines.length;y++){for(var v=i.lines[y],_=0,x=0,b=0;b<v.tokens.length;b++){var w=(P=v.tokens[b]).styleName&&e.rich[P.styleName]||{},S=P.textPadding=w.padding,T=S?S[1]+S[3]:0,M=P.font=w.font||e.font;P.contentHeight=In(M);var I=et(w.height,P.contentHeight);if(P.innerHeight=I,S&&(I+=S[0]+S[2]),P.height=I,P.lineHeight=it(w.lineHeight,e.lineHeight,I),P.align=w&&w.align||e.align,P.verticalAlign=w&&w.verticalAlign||"middle",m&&null!=o&&h+P.lineHeight>o){b>0?(v.tokens=v.tokens.slice(0,b),g(v,x,_),i.lines=i.lines.slice(0,y+1)):i.lines=i.lines.slice(0,y);break t}var C=w.width,A=null==C||"auto"===C;if("string"==typeof C&&"%"===C.charAt(C.length-1))P.percentWidth=C,c.push(P),P.contentWidth=bn(P.text,M);else{if(A){var k=w.backgroundColor,D=k&&k.image;D&&so(D=ro(D))&&(P.width=Math.max(P.width,D.width*I/D.height))}var E=f&&null!=r?r-x:null;null!=E&&E<P.width?!A||E<T?(P.text="",P.width=P.contentWidth=0):(P.text=uo(P.text,E-T,M,e.ellipsis,{minChar:e.truncateMinChar}),P.width=P.contentWidth=bn(P.text,M)):P.contentWidth=bn(P.text,M)}P.width+=T,x+=P.width,w&&(_=Math.max(_,P.lineHeight))}g(v,x,_)}for(i.outerWidth=i.width=et(r,p),i.outerHeight=i.height=et(o,h),i.contentHeight=h,i.contentWidth=p,d&&(i.outerWidth+=d[1]+d[3],i.outerHeight+=d[0]+d[2]),y=0;y<c.length;y++){var P,L=(P=c[y]).percentWidth;P.width=parseInt(L,10)/100*i.width}return i}(bs(t),t),i=e.width,n=e.outerWidth,r=e.outerHeight,o=t.padding,a=t.x||0,s=t.y||0,l=this._defaultStyle,u=t.align||l.align,c=t.verticalAlign||l.verticalAlign,h=Tn(a,n,u),p=Mn(s,r,c),d=h,f=p;o&&(d+=o[3],f+=o[0]);var m=d+i;ws(t)&&this._renderBackground(t,t,h,p,n,r);for(var g=!!t.backgroundColor,y=0;y<e.lines.length;y++){for(var v=e.lines[y],_=v.tokens,x=_.length,b=v.lineHeight,w=v.width,S=0,T=d,M=m,I=x-1,C=void 0;S<x&&(!(C=_[S]).align||"left"===C.align);)this._placeToken(C,t,b,f,T,"left",g),w-=C.width,T+=C.width,S++;for(;I>=0&&"right"===(C=_[I]).align;)this._placeToken(C,t,b,f,M,"right",g),w-=C.width,M-=C.width,I--;for(T+=(i-(T-d)-(m-M)-w)/2;S<=I;)C=_[S],this._placeToken(C,t,b,f,T+C.width/2,"center",g),T+=C.width,S++;f+=b}},e.prototype._placeToken=function(t,e,i,n,r,o,a){var s=e.rich[t.styleName]||{};s.text=t.text;var l=t.verticalAlign,u=n+i/2;"top"===l?u=n+t.height/2:"bottom"===l&&(u=n+i-t.height/2),!t.isLineHolder&&ws(s)&&this._renderBackground(s,e,"right"===o?r-t.width:"center"===o?r-t.width/2:r,u-t.height/2,t.width,t.height);var c=!!s.backgroundColor,h=t.textPadding;h&&(r=xs(r,o,h),u-=t.height/2-h[0]-t.innerHeight/2);var p=this._getOrCreateChild(es),d=p.createStyle();p.useStyle(d);var f=this._defaultStyle,m=!1,g=0,y=_s("fill"in s?s.fill:"fill"in e?e.fill:(m=!0,f.fill)),v=vs("stroke"in s?s.stroke:"stroke"in e?e.stroke:c||a||f.autoStroke&&!m?null:(g=2,f.stroke)),_=s.textShadowBlur>0||e.textShadowBlur>0;d.text=t.text,d.x=r,d.y=u,_&&(d.shadowBlur=s.textShadowBlur||e.textShadowBlur||0,d.shadowColor=s.textShadowColor||e.textShadowColor||"transparent",d.shadowOffsetX=s.textShadowOffsetX||e.textShadowOffsetX||0,d.shadowOffsetY=s.textShadowOffsetY||e.textShadowOffsetY||0),d.textAlign=o,d.textBaseline="middle",d.font=t.font||_n,d.opacity=it(s.opacity,e.opacity,1),v&&(d.lineWidth=it(s.lineWidth,e.lineWidth,g),d.lineDash=et(s.lineDash,e.lineDash),d.lineDashOffset=e.lineDashOffset||0,d.stroke=v),y&&(d.fill=y);var x=t.contentWidth,b=t.contentHeight;p.setBoundingRect(new yn(Tn(d.x,x,d.textAlign),Mn(d.y,b,d.textBaseline),x,b))},e.prototype._renderBackground=function(t,e,i,n,r,o){var a,s,l,u=t.backgroundColor,c=t.borderWidth,h=t.borderColor,p=u&&u.image,d=u&&!p,f=t.borderRadius,m=this;if(d||t.lineHeight||c&&h){(a=this._getOrCreateChild(hs)).useStyle(a.createStyle()),a.style.fill=null;var g=a.shape;g.x=i,g.y=n,g.width=r,g.height=o,g.r=f,a.dirtyShape()}if(d)(l=a.style).fill=u||null,l.fillOpacity=et(t.fillOpacity,1);else if(p){(s=this._getOrCreateChild(rs)).onload=function(){m.dirtyStyle()};var y=s.style;y.image=u.image,y.x=i,y.y=n,y.width=r,y.height=o}c&&h&&((l=a.style).lineWidth=c,l.stroke=h,l.strokeOpacity=et(t.strokeOpacity,1),l.lineDash=t.borderDash,l.lineDashOffset=t.borderDashOffset||0,a.strokeContainThreshold=0,a.hasFill()&&a.hasStroke()&&(l.strokeFirst=!0,l.lineWidth*=2));var v=(a||s).style;v.shadowBlur=t.shadowBlur||0,v.shadowColor=t.shadowColor||"transparent",v.shadowOffsetX=t.shadowOffsetX||0,v.shadowOffsetY=t.shadowOffsetY||0,v.opacity=it(t.opacity,e.opacity,1)},e.makeFont=function(t){var e="";if(t.fontSize||t.fontFamily||t.fontWeight){var i="";i="string"!=typeof t.fontSize||-1===t.fontSize.indexOf("px")&&-1===t.fontSize.indexOf("rem")&&-1===t.fontSize.indexOf("em")?isNaN(+t.fontSize)?"12px":t.fontSize+"px":t.fontSize,e=[t.fontStyle,t.fontWeight,i,t.fontFamily||"sans-serif"].join(" ")}return e&&at(e)||t.textFont||t.font},e}(Io),ms={left:!0,right:1,center:1},gs={top:1,bottom:1,middle:1};function ys(t){if(t){t.font=fs.makeFont(t);var e=t.align;"middle"===e&&(e="center"),t.align=null==e||ms[e]?e:"left";var i=t.verticalAlign;"center"===i&&(i="middle"),t.verticalAlign=null==i||gs[i]?i:"top",t.padding&&(t.padding=rt(t.padding))}}function vs(t,e){return null==t||e<=0||"transparent"===t||"none"===t?null:t.image||t.colorStops?"#000":t}function _s(t){return null==t||"none"===t?null:t.image||t.colorStops?"#000":t}function xs(t,e,i){return"right"===e?t-i[1]:"center"===e?t+i[3]/2-i[1]/2:t+i[3]}function bs(t){var e=t.text;return null!=e&&(e+=""),e}function ws(t){return!!(t.backgroundColor||t.lineHeight||t.borderWidth&&t.borderColor)}var Ss=zr(),Ts=function(t,e,i,n){if(n){var r=Ss(n);r.dataIndex=i,r.dataType=e,r.seriesIndex=t,"group"===n.type&&n.traverse(function(n){var r=Ss(n);r.seriesIndex=t,r.dataIndex=i,r.dataType=e})}},Ms=1,Is={},Cs=zr(),As=["emphasis","blur","select"],ks=["normal","emphasis","blur","select"],Ds=10,Es="highlight",Ps="downplay",Ls="select",zs="unselect",Os="toggleSelect";function Rs(t){return null!=t&&"none"!==t}var Bs=new De(100);function Ns(t){if("string"!=typeof t)return t;var e=Bs.get(t);return e||(e=Ze(t,-.1),Bs.put(t,e)),e}function Fs(t,e,i){t.onHoverStateChange&&(t.hoverState||0)!==i&&t.onHoverStateChange(e),t.hoverState=i}function Vs(t){Fs(t,"emphasis",2)}function Us(t){2===t.hoverState&&Fs(t,"normal",0)}function Gs(t){Fs(t,"blur",1)}function $s(t){1===t.hoverState&&Fs(t,"normal",0)}function Ws(t){t.selected=!0}function Hs(t){t.selected=!1}function js(t,e,i){e(t,i)}function Zs(t,e,i){js(t,e,i),t.isGroup&&t.traverse(function(t){js(t,e,i)})}function qs(t,e){switch(e){case"emphasis":t.hoverState=2;break;case"normal":t.hoverState=0;break;case"blur":t.hoverState=1;break;case"select":t.selected=!0}}function Xs(t,e){var i=this.states[t];if(this.style){if("emphasis"===t)return function(t,e,i,n){var r=i&&k(i,"select")>=0,o=!1;if(t instanceof Qa){var a=Cs(t),s=r&&a.selectFill||a.normalFill,l=r&&a.selectStroke||a.normalStroke;if(Rs(s)||Rs(l)){var u=(n=n||{}).style||{};"inherit"===u.fill?(o=!0,n=I({},n),(u=I({},u)).fill=s):!Rs(u.fill)&&Rs(s)?(o=!0,n=I({},n),(u=I({},u)).fill=Ns(s)):!Rs(u.stroke)&&Rs(l)&&(o||(n=I({},n),u=I({},u)),u.stroke=Ns(l)),n.style=u}}if(n&&null==n.z2){o||(n=I({},n));var c=t.z2EmphasisLift;n.z2=t.z2+(null!=c?c:Ds)}return n}(this,0,e,i);if("blur"===t)return function(t,e,i){var n=k(t.currentStates,e)>=0,r=t.style.opacity,o=n?null:function(t,e,i,n){for(var r=t.style,o={},a=0;a<e.length;a++){var s=e[a],l=r[s];o[s]=null==l?n&&n[s]:l}for(a=0;a<t.animators.length;a++){var u=t.animators[a];u.__fromStateTransition&&u.__fromStateTransition.indexOf(i)<0&&"style"===u.targetName&&u.saveFinalToTarget(o,e)}return o}(t,["opacity"],e,{opacity:1}),a=(i=i||{}).style||{};return null==a.opacity&&(i=I({},i),a=I({opacity:n?r:.1*o.opacity},a),i.style=a),i}(this,t,i);if("select"===t)return function(t,e,i){if(i&&null==i.z2){i=I({},i);var n=t.z2SelectLift;i.z2=t.z2+(null!=n?n:9)}return i}(this,0,i)}return i}function Ys(t){t.stateProxy=Xs;var e=t.getTextContent(),i=t.getTextGuideLine();e&&(e.stateProxy=Xs),i&&(i.stateProxy=Xs)}function Ks(t,e){!ol(t,e)&&!t.__highByOuter&&Zs(t,Vs)}function Js(t,e){!ol(t,e)&&!t.__highByOuter&&Zs(t,Us)}function Qs(t,e){t.__highByOuter|=1<<(e||0),Zs(t,Vs)}function tl(t,e){!(t.__highByOuter&=~(1<<(e||0)))&&Zs(t,Us)}function el(t){Zs(t,Gs)}function il(t){Zs(t,$s)}function nl(t){Zs(t,Ws)}function rl(t){Zs(t,Hs)}function ol(t,e){return t.__highDownSilentOnTouch&&e.zrByTouch}function al(t){t.getModel().eachComponent(function(e,i){("series"===e?t.getViewOfSeriesModel(i):t.getViewOfComponentModel(i)).group.traverse(function(t){$s(t)})})}function sl(t,e,i,n){var r=n.getModel();function o(t,e){for(var i=0;i<e.length;i++){var n=t.getItemGraphicEl(e[i]);n&&il(n)}}if(i=i||"coordinateSystem",null!=t&&e&&"none"!==e){var a=r.getSeriesByIndex(t),s=a.coordinateSystem;s&&s.master&&(s=s.master);var l=[];r.eachSeries(function(t){var r=a===t,u=t.coordinateSystem;if(u&&u.master&&(u=u.master),!("series"===i&&!r||"coordinateSystem"===i&&!(u&&s?u===s:r)||"series"===e&&r)){if(n.getViewOfSeriesModel(t).group.traverse(function(t){Gs(t)}),P(e))o(t.getData(),e);else if(j(e))for(var c=N(e),h=0;h<c.length;h++)o(t.getData(c[h]),e[c[h]]);l.push(t)}}),r.eachComponent(function(t,e){if("series"!==t){var i=n.getViewOfComponentModel(e);i&&i.blurSeries&&i.blurSeries(l,r)}})}}function ll(t,e,i){if(null!=t&&null!=e){var n=i.getModel().getComponent(t,e);if(n){var r=i.getViewOfComponentModel(n);r&&r.focusBlurEnabled&&r.group.traverse(function(t){Gs(t)})}}}function ul(t,e,i,n){var r={focusSelf:!1,dispatchers:null};if(null==t||"series"===t||null==e||null==i)return r;var o=n.getModel().getComponent(t,e);if(!o)return r;var a=n.getViewOfComponentModel(o);if(!a||!a.findHighDownDispatchers)return r;for(var s,l=a.findHighDownDispatchers(i),u=0;u<l.length;u++)if("self"===Ss(l[u]).focus){s=!0;break}return{focusSelf:s,dispatchers:l}}function cl(t){L(t.getAllData(),function(e){var i=e.data,n=e.type;i.eachItemGraphicEl(function(e,i){t.isSelected(i,n)?nl(e):rl(e)})})}function hl(t){var e=[];return t.eachSeries(function(t){L(t.getAllData(),function(i){i.data;var n=i.type,r=t.getSelectedDataIndices();if(r.length>0){var o={dataIndex:r,seriesIndex:t.seriesIndex};null!=n&&(o.dataType=n),e.push(o)}})}),e}function pl(t,e,i){yl(t,!0),Zs(t,Ys),dl(t,e,i)}function dl(t,e,i){var n=Ss(t);null!=e?(n.focus=e,n.blurScope=i):n.focus&&(n.focus=null)}var fl=["emphasis","blur","select"],ml={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function gl(t,e,i,n){i=i||"itemStyle";for(var r=0;r<fl.length;r++){var o=fl[r],a=e.getModel([o,i]);t.ensureState(o).style=n?n(a):a[ml[i]]()}}function yl(t,e){var i=!1===e,n=t;t.highDownSilentOnTouch&&(n.__highDownSilentOnTouch=t.highDownSilentOnTouch),i&&!n.__highDownDispatcher||(n.__highByOuter=n.__highByOuter||0,n.__highDownDispatcher=!i)}function vl(t){return!(!t||!t.__highDownDispatcher)}function _l(t){var e=t.type;return e===Ls||e===zs||e===Os}function xl(t){var e=t.type;return e===Es||e===Ps}var bl=La.CMD,wl=[[],[],[]],Sl=Math.sqrt,Tl=Math.atan2;function Ml(t,e){if(e){var i,n,r,o,a,s,l=t.data,u=t.len(),c=bl.M,h=bl.C,p=bl.L,d=bl.R,f=bl.A,m=bl.Q;for(r=0,o=0;r<u;){switch(i=l[r++],o=r,n=0,i){case c:case p:n=1;break;case h:n=3;break;case m:n=2;break;case f:var g=e[4],y=e[5],v=Sl(e[0]*e[0]+e[1]*e[1]),_=Sl(e[2]*e[2]+e[3]*e[3]),x=Tl(-e[1]/_,e[0]/v);l[r]*=v,l[r++]+=g,l[r]*=_,l[r++]+=y,l[r++]*=v,l[r++]*=_,l[r++]+=x,l[r++]+=x,o=r+=2;break;case d:s[0]=l[r++],s[1]=l[r++],Ot(s,s,e),l[o++]=s[0],l[o++]=s[1],s[0]+=l[r++],s[1]+=l[r++],Ot(s,s,e),l[o++]=s[0],l[o++]=s[1]}for(a=0;a<n;a++){var b=wl[a];b[0]=l[r++],b[1]=l[r++],Ot(b,b,e),l[o++]=b[0],l[o++]=b[1]}}t.increaseVersion()}}var Il=Math.sqrt,Cl=Math.sin,Al=Math.cos,kl=Math.PI;function Dl(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function El(t,e){return(t[0]*e[0]+t[1]*e[1])/(Dl(t)*Dl(e))}function Pl(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(El(t,e))}function Ll(t,e,i,n,r,o,a,s,l,u,c){var h=l*(kl/180),p=Al(h)*(t-i)/2+Cl(h)*(e-n)/2,d=-1*Cl(h)*(t-i)/2+Al(h)*(e-n)/2,f=p*p/(a*a)+d*d/(s*s);f>1&&(a*=Il(f),s*=Il(f));var m=(r===o?-1:1)*Il((a*a*(s*s)-a*a*(d*d)-s*s*(p*p))/(a*a*(d*d)+s*s*(p*p)))||0,g=m*a*d/s,y=m*-s*p/a,v=(t+i)/2+Al(h)*g-Cl(h)*y,_=(e+n)/2+Cl(h)*g+Al(h)*y,x=Pl([1,0],[(p-g)/a,(d-y)/s]),b=[(p-g)/a,(d-y)/s],w=[(-1*p-g)/a,(-1*d-y)/s],S=Pl(b,w),T;(El(b,w)<=-1&&(S=kl),El(b,w)>=1&&(S=0),S<0)&&(S=2*kl+Math.round(S/kl*1e6)/1e6%2*kl);c.addData(u,v,_,a,s,x,S,h,o)}var zl=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/gi,Ol=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g,Rl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.applyTransform=function(t){},e}(Qa);function Bl(t){return null!=t.setData}function Nl(t,e){var i=function(t){var e=new La;if(!t)return e;var i,n=0,r=0,o=n,a=r,s=La.CMD,l=t.match(zl);if(!l)return e;for(var u=0;u<l.length;u++){for(var c=l[u],h=c.charAt(0),p=void 0,d=c.match(Ol)||[],f=d.length,m=0;m<f;m++)d[m]=parseFloat(d[m]);for(var g=0;g<f;){var y=void 0,v=void 0,_=void 0,x=void 0,b=void 0,w=void 0,S=void 0,T=n,M=r,I=void 0,C=void 0;switch(h){case"l":n+=d[g++],r+=d[g++],p=s.L,e.addData(p,n,r);break;case"L":n=d[g++],r=d[g++],p=s.L,e.addData(p,n,r);break;case"m":n+=d[g++],r+=d[g++],p=s.M,e.addData(p,n,r),o=n,a=r,h="l";break;case"M":n=d[g++],r=d[g++],p=s.M,e.addData(p,n,r),o=n,a=r,h="L";break;case"h":n+=d[g++],p=s.L,e.addData(p,n,r);break;case"H":n=d[g++],p=s.L,e.addData(p,n,r);break;case"v":r+=d[g++],p=s.L,e.addData(p,n,r);break;case"V":r=d[g++],p=s.L,e.addData(p,n,r);break;case"C":p=s.C,e.addData(p,d[g++],d[g++],d[g++],d[g++],d[g++],d[g++]),n=d[g-2],r=d[g-1];break;case"c":p=s.C,e.addData(p,d[g++]+n,d[g++]+r,d[g++]+n,d[g++]+r,d[g++]+n,d[g++]+r),n+=d[g-2],r+=d[g-1];break;case"S":y=n,v=r,I=e.len(),C=e.data,i===s.C&&(y+=n-C[I-4],v+=r-C[I-3]),p=s.C,T=d[g++],M=d[g++],n=d[g++],r=d[g++],e.addData(p,y,v,T,M,n,r);break;case"s":y=n,v=r,I=e.len(),C=e.data,i===s.C&&(y+=n-C[I-4],v+=r-C[I-3]),p=s.C,T=n+d[g++],M=r+d[g++],n+=d[g++],r+=d[g++],e.addData(p,y,v,T,M,n,r);break;case"Q":T=d[g++],M=d[g++],n=d[g++],r=d[g++],p=s.Q,e.addData(p,T,M,n,r);break;case"q":T=d[g++]+n,M=d[g++]+r,n+=d[g++],r+=d[g++],p=s.Q,e.addData(p,T,M,n,r);break;case"T":y=n,v=r,I=e.len(),C=e.data,i===s.Q&&(y+=n-C[I-4],v+=r-C[I-3]),n=d[g++],r=d[g++],p=s.Q,e.addData(p,y,v,n,r);break;case"t":y=n,v=r,I=e.len(),C=e.data,i===s.Q&&(y+=n-C[I-4],v+=r-C[I-3]),n+=d[g++],r+=d[g++],p=s.Q,e.addData(p,y,v,n,r);break;case"A":_=d[g++],x=d[g++],b=d[g++],w=d[g++],S=d[g++],Ll(T=n,M=r,n=d[g++],r=d[g++],w,S,_,x,b,p=s.A,e);break;case"a":_=d[g++],x=d[g++],b=d[g++],w=d[g++],S=d[g++],Ll(T=n,M=r,n+=d[g++],r+=d[g++],w,S,_,x,b,p=s.A,e)}}"z"!==h&&"Z"!==h||(p=s.Z,e.addData(p),n=o,r=a),i=p}return e.toStatic(),e}(t),n=I({},e);return n.buildPath=function(t){if(Bl(t))t.setData(i.data),(e=t.getContext())&&t.rebuildPath(e,1);else{var e=t;i.rebuildPath(e,1)}},n.applyTransform=function(t){Ml(i,t),this.dirtyShape()},n}function Fl(t,e){return new Rl(Nl(t,e))}function Vl(t,e){e=e||{};var i=new Qa;return t.shape&&i.setShape(t.shape),i.setStyle(t.style),e.bakeTransform?Ml(i.path,t.getComputedTransform()):e.toLocal?i.setLocalTransform(t.getComputedTransform()):i.copyTransform(t),i.buildPath=t.buildPath,i.applyTransform=i.applyTransform,i.z=t.z,i.z2=t.z2,i.zlevel=t.zlevel,i}var Ul=function(){this.cx=0,this.cy=0,this.r=0},Gl=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getDefaultShape=function(){return new Ul},e.prototype.buildPath=function(t,e,i){i&&t.moveTo(e.cx+e.r,e.cy),t.arc(e.cx,e.cy,e.r,0,2*Math.PI)},e}(Qa);Gl.prototype.type="circle";var $l=function(){this.cx=0,this.cy=0,this.rx=0,this.ry=0},Wl=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getDefaultShape=function(){return new $l},e.prototype.buildPath=function(t,e){var i=.5522848,n=e.cx,r=e.cy,o=e.rx,a=e.ry,s=o*i,l=a*i;t.moveTo(n-o,r),t.bezierCurveTo(n-o,r-l,n-s,r-a,n,r-a),t.bezierCurveTo(n+s,r-a,n+o,r-l,n+o,r),t.bezierCurveTo(n+o,r+l,n+s,r+a,n,r+a),t.bezierCurveTo(n-s,r+a,n-o,r+l,n-o,r),t.closePath()},e}(Qa);Wl.prototype.type="ellipse";var Hl=Math.PI,jl=2*Hl,Zl=Math.sin,ql=Math.cos,Xl=Math.acos,Yl=Math.atan2,Kl=Math.abs,Jl=Math.sqrt,Ql=Math.max,tu=Math.min,eu=1e-4;function iu(t,e,i,n,r,o,a){var s=t-i,l=e-n,u=(a?o:-o)/Jl(s*s+l*l),c=u*l,h=-u*s,p=t+c,d=e+h,f=i+c,m=n+h,g=(p+f)/2,y=(d+m)/2,v=f-p,_=m-d,x=v*v+_*_,b=r-o,w=p*m-f*d,S=(_<0?-1:1)*Jl(Ql(0,b*b*x-w*w)),T=(w*_-v*S)/x,M=(-w*v-_*S)/x,I=(w*_+v*S)/x,C=(-w*v+_*S)/x,A=T-g,k=M-y,D=I-g,E=C-y;return A*A+k*k>D*D+E*E&&(T=I,M=C),{cx:T,cy:M,x01:-c,y01:-h,x11:T*(r/b-1),y11:M*(r/b-1)}}function nu(t,e){var i=Ql(e.r,0),n=Ql(e.r0||0,0),r=i>0;if(r||n>0){if(r||(i=n,n=0),n>i){var o=i;i=n,n=o}var a,s=!!e.clockwise,l=e.startAngle,u=e.endAngle;if(l===u)a=0;else{var c=[l,u];Pa(c,!s),a=Kl(c[0]-c[1])}var h=e.cx,p=e.cy,d=e.cornerRadius||0,f=e.innerCornerRadius||0;if(i>eu)if(a>jl-eu)t.moveTo(h+i*ql(l),p+i*Zl(l)),t.arc(h,p,i,l,u,!s),n>eu&&(t.moveTo(h+n*ql(u),p+n*Zl(u)),t.arc(h,p,n,u,l,s));else{var m=Kl(i-n)/2,g=tu(m,d),y=tu(m,f),v=y,_=g,x=i*ql(l),b=i*Zl(l),w=n*ql(u),S=n*Zl(u),T=void 0,M=void 0,I=void 0,C=void 0;if((g>eu||y>eu)&&(T=i*ql(u),M=i*Zl(u),I=n*ql(l),C=n*Zl(l),a<Hl)){var A=function(t,e,i,n,r,o,a,s){var l=i-t,u=n-e,c=a-r,h=s-o,p=h*l-c*u;if(!(p*p<eu))return[t+(p=(c*(e-o)-h*(t-r))/p)*l,e+p*u]}(x,b,I,C,T,M,w,S);if(A){var k=x-A[0],D=b-A[1],E=T-A[0],P=M-A[1],L=1/Zl(Xl((k*E+D*P)/(Jl(k*k+D*D)*Jl(E*E+P*P)))/2),z=Jl(A[0]*A[0]+A[1]*A[1]);v=tu(y,(n-z)/(L-1)),_=tu(g,(i-z)/(L+1))}}if(a>eu)if(_>eu){var O=iu(I,C,x,b,i,_,s),R=iu(T,M,w,S,i,_,s);t.moveTo(h+O.cx+O.x01,p+O.cy+O.y01),_<g?t.arc(h+O.cx,p+O.cy,_,Yl(O.y01,O.x01),Yl(R.y01,R.x01),!s):(t.arc(h+O.cx,p+O.cy,_,Yl(O.y01,O.x01),Yl(O.y11,O.x11),!s),t.arc(h,p,i,Yl(O.cy+O.y11,O.cx+O.x11),Yl(R.cy+R.y11,R.cx+R.x11),!s),t.arc(h+R.cx,p+R.cy,_,Yl(R.y11,R.x11),Yl(R.y01,R.x01),!s))}else t.moveTo(h+x,p+b),t.arc(h,p,i,l,u,!s);else t.moveTo(h+x,p+b);n>eu&&a>eu?v>eu?(O=iu(w,S,T,M,n,-v,s),R=iu(x,b,I,C,n,-v,s),t.lineTo(h+O.cx+O.x01,p+O.cy+O.y01),v<y?t.arc(h+O.cx,p+O.cy,v,Yl(O.y01,O.x01),Yl(R.y01,R.x01),!s):(t.arc(h+O.cx,p+O.cy,v,Yl(O.y01,O.x01),Yl(O.y11,O.x11),!s),t.arc(h,p,n,Yl(O.cy+O.y11,O.cx+O.x11),Yl(R.cy+R.y11,R.cx+R.x11),s),t.arc(h+R.cx,p+R.cy,v,Yl(R.y11,R.x11),Yl(R.y01,R.x01),!s))):(t.lineTo(h+w,p+S),t.arc(h,p,n,u,l,s)):t.lineTo(h+w,p+S)}else t.moveTo(h,p);t.closePath()}}var ru=function(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.cornerRadius=0,this.innerCornerRadius=0},ou=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getDefaultShape=function(){return new ru},e.prototype.buildPath=function(t,e){nu(t,e)},e.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},e}(Qa);ou.prototype.type="sector";var au=function(){this.cx=0,this.cy=0,this.r=0,this.r0=0},su=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getDefaultShape=function(){return new au},e.prototype.buildPath=function(t,e){var i=e.cx,n=e.cy,r=2*Math.PI;t.moveTo(i+e.r,n),t.arc(i,n,e.r,0,r,!1),t.moveTo(i+e.r0,n),t.arc(i,n,e.r0,0,r,!0)},e}(Qa);function lu(t,e,i,n,r,o,a){var s=.5*(i-t),l=.5*(n-e);return(2*(e-i)+s+l)*a+(-3*(e-i)-2*s-l)*o+s*r+e}function uu(t,e,i){var n=e.smooth,r=e.points;if(r&&r.length>=2){if(n&&"spline"!==n){var o=function(t,e,i,n){var r,o,a,s,l=[],u=[],c=[],h=[];if(n){a=[1/0,1/0],s=[-1/0,-1/0];for(var p=0,d=t.length;p<d;p++)Rt(a,a,t[p]),Bt(s,s,t[p]);Rt(a,a,n[0]),Bt(s,s,n[1])}for(p=0,d=t.length;p<d;p++){var f=t[p];if(i)r=t[p?p-1:d-1],o=t[(p+1)%d];else{if(0===p||p===d-1){l.push(bt(t[p]));continue}r=t[p-1],o=t[p+1]}Mt(u,o,r),At(u,u,e);var m=Dt(f,r),g=Dt(f,o),y=m+g;0!==y&&(m/=y,g/=y),At(c,u,-m),At(h,u,g);var v=St([],f,c),_=St([],f,h);n&&(Bt(v,v,a),Rt(v,v,s),Bt(_,_,a),Rt(_,_,s)),l.push(v),l.push(_)}return i&&l.push(l.shift()),l}(r,n,i,e.smoothConstraint);t.moveTo(r[0][0],r[0][1]);for(var a=r.length,s=0;s<(i?a:a-1);s++){var l=o[2*s],u=o[2*s+1],c=r[(s+1)%a];t.bezierCurveTo(l[0],l[1],u[0],u[1],c[0],c[1])}}else{"spline"===n&&(r=function(t,e){for(var i=t.length,n=[],r=0,o=1;o<i;o++)r+=Dt(t[o-1],t[o]);var a=r/2;for(a=a<i?i:a,o=0;o<a;o++){var s=o/(a-1)*(e?i:i-1),l=Math.floor(s),u=s-l,c=void 0,h=t[l%i],p=void 0,d=void 0;e?(c=t[(l-1+i)%i],p=t[(l+1)%i],d=t[(l+2)%i]):(c=t[0===l?l:l-1],p=t[l>i-2?i-1:l+1],d=t[l>i-3?i-1:l+2]);var f=u*u,m=u*f;n.push([lu(c[0],h[0],p[0],d[0],u,f,m),lu(c[1],h[1],p[1],d[1],u,f,m)])}return n}(r,i)),t.moveTo(r[0][0],r[0][1]),s=1;for(var h=r.length;s<h;s++)t.lineTo(r[s][0],r[s][1])}i&&t.closePath()}}su.prototype.type="ring";var cu=function(){this.points=null,this.smooth=0,this.smoothConstraint=null},hu=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getDefaultShape=function(){return new cu},e.prototype.buildPath=function(t,e){uu(t,e,!0)},e}(Qa);hu.prototype.type="polygon";var pu=function(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null},du=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new pu},e.prototype.buildPath=function(t,e){uu(t,e,!1)},e}(Qa);du.prototype.type="polyline";var fu={},mu=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1},gu=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new mu},e.prototype.buildPath=function(t,e){var i,n,r,o;if(this.subPixelOptimize){var a=as(fu,e,this.style);i=a.x1,n=a.y1,r=a.x2,o=a.y2}else i=e.x1,n=e.y1,r=e.x2,o=e.y2;var s=e.percent;0!==s&&(t.moveTo(i,n),s<1&&(r=i*(1-s)+r*s,o=n*(1-s)+o*s),t.lineTo(r,o))},e.prototype.pointAt=function(t){var e=this.shape;return[e.x1*(1-t)+e.x2*t,e.y1*(1-t)+e.y2*t]},e}(Qa);gu.prototype.type="line";var yu=[],vu=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1};function _u(t,e,i){var n=t.cpx2,r=t.cpy2;return null===n||null===r?[(i?Uo:Vo)(t.x1,t.cpx1,t.cpx2,t.x2,e),(i?Uo:Vo)(t.y1,t.cpy1,t.cpy2,t.y2,e)]:[(i?qo:Zo)(t.x1,t.cpx1,t.x2,e),(i?qo:Zo)(t.y1,t.cpy1,t.y2,e)]}var xu=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new vu},e.prototype.buildPath=function(t,e){var i=e.x1,n=e.y1,r=e.x2,o=e.y2,a=e.cpx1,s=e.cpy1,l=e.cpx2,u=e.cpy2,c=e.percent;0!==c&&(t.moveTo(i,n),null==l||null==u?(c<1&&(Yo(i,a,r,c,yu),a=yu[1],r=yu[2],Yo(n,s,o,c,yu),s=yu[1],o=yu[2]),t.quadraticCurveTo(a,s,r,o)):(c<1&&(Wo(i,a,l,r,c,yu),a=yu[1],l=yu[2],r=yu[3],Wo(n,s,u,o,c,yu),s=yu[1],u=yu[2],o=yu[3]),t.bezierCurveTo(a,s,l,u,r,o)))},e.prototype.pointAt=function(t){return _u(this.shape,t,!1)},e.prototype.tangentAt=function(t){var e=_u(this.shape,t,!0);return kt(e,e)},e}(Qa);xu.prototype.type="bezier-curve";var bu=function(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0},wu=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new bu},e.prototype.buildPath=function(t,e){var i=e.cx,n=e.cy,r=Math.max(e.r,0),o=e.startAngle,a=e.endAngle,s=e.clockwise,l=Math.cos(o),u=Math.sin(o);t.moveTo(l*r+i,u*r+n),t.arc(i,n,r,o,a,!s)},e}(Qa);wu.prototype.type="arc";var Su=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="compound",e}return i(e,t),e.prototype._updatePathDirty=function(){for(var t=this.shape.paths,e=this.shapeChanged(),i=0;i<t.length;i++)e=e||t[i].shapeChanged();e&&this.dirtyShape()},e.prototype.beforeBrush=function(){this._updatePathDirty();for(var t=this.shape.paths||[],e=this.getGlobalScale(),i=0;i<t.length;i++)t[i].path||t[i].createPathProxy(),t[i].path.setScale(e[0],e[1],t[i].segmentIgnoreThreshold)},e.prototype.buildPath=function(t,e){for(var i=e.paths||[],n=0;n<i.length;n++)i[n].buildPath(t,i[n].shape,!0)},e.prototype.afterBrush=function(){for(var t=this.shape.paths||[],e=0;e<t.length;e++)t[e].pathUpdated()},e.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),Qa.prototype.getBoundingRect.call(this)},e}(Qa),Tu=function(){function t(t){this.colorStops=t||[]}return t.prototype.addColorStop=function(t,e){this.colorStops.push({offset:t,color:e})},t}(),Mu=function(t){function e(e,i,n,r,o,a){var s=t.call(this,o)||this;return s.x=null==e?0:e,s.y=null==i?0:i,s.x2=null==n?1:n,s.y2=null==r?0:r,s.type="linear",s.global=a||!1,s}return i(e,t),e}(Tu),Iu=function(t){function e(e,i,n,r,o){var a=t.call(this,r)||this;return a.x=null==e?.5:e,a.y=null==i?.5:i,a.r=null==n?.5:n,a.type="radial",a.global=o||!1,a}return i(e,t),e}(Tu),Cu=[0,0],Au=[0,0],ku=new ln,Du=new ln,Eu=function(){function t(t,e){this._corners=[],this._axes=[],this._origin=[0,0];for(var i=0;i<4;i++)this._corners[i]=new ln;for(i=0;i<2;i++)this._axes[i]=new ln;t&&this.fromBoundingRect(t,e)}return t.prototype.fromBoundingRect=function(t,e){var i=this._corners,n=this._axes,r=t.x,o=t.y,a=r+t.width,s=o+t.height;if(i[0].set(r,o),i[1].set(a,o),i[2].set(a,s),i[3].set(r,s),e)for(var l=0;l<4;l++)i[l].transform(e);for(ln.sub(n[0],i[1],i[0]),ln.sub(n[1],i[3],i[0]),n[0].normalize(),n[1].normalize(),l=0;l<2;l++)this._origin[l]=n[l].dot(i[0])},t.prototype.intersect=function(t,e){var i=!0,n=!e;return ku.set(1/0,1/0),Du.set(0,0),!this._intersectCheckOneSide(this,t,ku,Du,n,1)&&(i=!1,n)||!this._intersectCheckOneSide(t,this,ku,Du,n,-1)&&(i=!1,n)||n||ln.copy(e,i?ku:Du),i},t.prototype._intersectCheckOneSide=function(t,e,i,n,r,o){for(var a=!0,s=0;s<2;s++){var l=this._axes[s];if(this._getProjMinMaxOnAxis(s,t._corners,Cu),this._getProjMinMaxOnAxis(s,e._corners,Au),Cu[1]<Au[0]||Cu[0]>Au[1]){if(a=!1,r)return a;var u=Math.abs(Au[0]-Cu[1]),c=Math.abs(Cu[0]-Au[1]);Math.min(u,c)>n.len()&&(u<c?ln.scale(n,l,-u*o):ln.scale(n,l,c*o))}else i&&Math.min(u=Math.abs(Au[0]-Cu[1]),c=Math.abs(Cu[0]-Au[1]))<i.len()&&(u<c?ln.scale(i,l,u*o):ln.scale(i,l,-c*o))}return a},t.prototype._getProjMinMaxOnAxis=function(t,e,i){for(var n=this._axes[t],r=this._origin,o=e[0].dot(n)+r[t],a=o,s=o,l=1;l<e.length;l++){var u=e[l].dot(n)+r[t];a=Math.min(u,a),s=Math.max(u,s)}i[0]=a,i[1]=s},t}(),Pu=[],Lu=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.notClear=!0,e.incremental=!0,e._displayables=[],e._temporaryDisplayables=[],e._cursor=0,e}return i(e,t),e.prototype.traverse=function(t,e){t.call(e,this)},e.prototype.useStyle=function(){this.style={}},e.prototype.getCursor=function(){return this._cursor},e.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},e.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},e.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},e.prototype.addDisplayable=function(t,e){e?this._temporaryDisplayables.push(t):this._displayables.push(t),this.markRedraw()},e.prototype.addDisplayables=function(t,e){e=e||!1;for(var i=0;i<t.length;i++)this.addDisplayable(t[i],e)},e.prototype.getDisplayables=function(){return this._displayables},e.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},e.prototype.eachPendingDisplayable=function(t){for(var e=this._cursor;e<this._displayables.length;e++)t&&t(this._displayables[e]);for(e=0;e<this._temporaryDisplayables.length;e++)t&&t(this._temporaryDisplayables[e])},e.prototype.update=function(){this.updateTransform();for(var t=this._cursor;t<this._displayables.length;t++)(e=this._displayables[t]).parent=this,e.update(),e.parent=null;for(t=0;t<this._temporaryDisplayables.length;t++){var e;(e=this._temporaryDisplayables[t]).parent=this,e.update(),e.parent=null}},e.prototype.getBoundingRect=function(){if(!this._rect){for(var t=new yn(1/0,1/0,-1/0,-1/0),e=0;e<this._displayables.length;e++){var i=this._displayables[e],n=i.getBoundingRect().clone();i.needLocalTransform()&&n.applyTransform(i.getLocalTransform(Pu)),t.union(n)}this._rect=t}return this._rect},e.prototype.contain=function(t,e){var i=this.transformCoordToLocal(t,e);if(this.getBoundingRect().contain(i[0],i[1]))for(var n=0;n<this._displayables.length;n++)if(this._displayables[n].contain(t,e))return!0;return!1},e}(Io),zu=zr();function Ou(t,e,i,n,r){var o;if(e&&e.ecModel){var a=e.ecModel.getUpdatePayload();o=a&&a.animation}var s="update"===t;if(e&&e.isAnimationEnabled()){var l=void 0,u=void 0,c=void 0;return n?(l=et(n.duration,200),u=et(n.easing,"cubicOut"),c=0):(l=e.getShallow(s?"animationDurationUpdate":"animationDuration"),u=e.getShallow(s?"animationEasingUpdate":"animationEasing"),c=e.getShallow(s?"animationDelayUpdate":"animationDelay")),o&&(null!=o.duration&&(l=o.duration),null!=o.easing&&(u=o.easing),null!=o.delay&&(c=o.delay)),"function"==typeof c&&(c=c(i,r)),"function"==typeof l&&(l=l(i)),{duration:l||0,delay:c,easing:u}}return null}function Ru(t,e,i,n,r,o,a){var s,l=!1;"function"==typeof r?(a=o,o=r,r=null):j(r)&&(o=r.cb,a=r.during,l=r.isFrom,s=r.removeOpt,r=r.dataIndex);var u="remove"===t;u||e.stopAnimation("remove");var c=Ou(t,n,r,u?s||{}:null,n&&n.getAnimationDelayParams?n.getAnimationDelayParams(e,r):null);if(c&&c.duration>0){var h={duration:c.duration,delay:c.delay||0,easing:c.easing,done:o,force:!!o||!!a,setToFinal:!u,scope:t,during:a};l?e.animateFrom(i,h):e.animateTo(i,h)}else e.stopAnimation(),!l&&e.attr(i),a&&a(1),o&&o()}function Bu(t,e,i,n,r,o){Ru("update",t,e,i,n,r,o)}function Nu(t,e,i,n,r,o){Ru("init",t,e,i,n,r,o)}function Fu(t){if(!t.__zr)return!0;for(var e=0;e<t.animators.length;e++)if("remove"===t.animators[e].scope)return!0;return!1}function Vu(t,e,i,n,r,o){Fu(t)||Ru("remove",t,e,i,n,r,o)}function Uu(t,e,i,n){t.removeTextContent(),t.removeTextGuideLine(),Vu(t,{style:{opacity:0}},e,i,n)}function Gu(t,e,i){function n(){t.parent&&t.parent.remove(t)}t.isGroup?t.traverse(function(t){t.isGroup||Uu(t,e,i,n)}):Uu(t,e,i,n)}function $u(t){zu(t).oldStyle=t.style}var Wu=Math.max,Hu=Math.min,ju={};function Zu(t){return Qa.extend(t)}var qu=function(t,e){var n=Nl(t,e);return function(t){function e(e){var i=t.call(this,e)||this;return i.applyTransform=n.applyTransform,i.buildPath=n.buildPath,i}return i(e,t),e}(Rl)};function Xu(t,e){return qu(t,e)}function Yu(t,e){ju[t]=e}function Ku(t){if(ju.hasOwnProperty(t))return ju[t]}function Ju(t,e,i,n){var r=Fl(t,e);return i&&("center"===n&&(i=tc(i,r.getBoundingRect())),ic(r,i)),r}function Qu(t,e,i){var n=new rs({style:{image:t,x:e.x,y:e.y,width:e.width,height:e.height},onload:function(t){if("center"===i){var r={width:t.width,height:t.height};n.setStyle(tc(e,r))}}});return n}function tc(t,e){var i,n=e.width/e.height,r=t.height*n;return i=r<=t.width?t.height:(r=t.width)/n,{x:t.x+t.width/2-r/2,y:t.y+t.height/2-i/2,width:r,height:i}}var ec=function(t,e){for(var i=[],n=t.length,r=0;r<n;r++){var o=t[r];i.push(o.getUpdatedPathProxy(!0))}var a=new Qa(e);return a.createPathProxy(),a.buildPath=function(t){if(Bl(t)){t.appendPath(i);var e=t.getContext();e&&t.rebuildPath(e,1)}},a};function ic(t,e){if(t.applyTransform){var i=t.getBoundingRect().calculateTransform(e);t.applyTransform(i)}}var nc=ls;function rc(t,e){for(var i=Ui([]);t&&t!==e;)$i(i,t.getLocalTransform(),i),t=t.parent;return i}function oc(t,e,i){return e&&!P(e)&&(e=an.getLocalTransform(e)),i&&(e=Zi([],e)),Ot([],t,e)}function ac(t,e,i){var n=0===e[4]||0===e[5]||0===e[0]?1:Math.abs(2*e[4]/e[0]),r=0===e[4]||0===e[5]||0===e[2]?1:Math.abs(2*e[4]/e[2]),o=["left"===t?-n:"right"===t?n:0,"top"===t?-r:"bottom"===t?r:0];return o=oc(o,e,i),Math.abs(o[0])>Math.abs(o[1])?o[0]>0?"right":"left":o[1]>0?"bottom":"top"}function sc(t){return!t.isGroup}function lc(t,e,i){if(t&&e){var n,r=(n={},t.traverse(function(t){sc(t)&&t.anid&&(n[t.anid]=t)}),n);e.traverse(function(t){if(sc(t)&&t.anid){var e=r[t.anid];if(e){var n=o(t);t.attr(o(e)),Bu(t,n,i,Ss(t).dataIndex)}}})}function o(t){var e={x:t.x,y:t.y,rotation:t.rotation};return function(t){return null!=t.shape}(t)&&(e.shape=I({},t.shape)),e}}function uc(t,e){return z(t,function(t){var i=t[0];i=Wu(i,e.x),i=Hu(i,e.x+e.width);var n=t[1];return n=Wu(n,e.y),[i,n=Hu(n,e.y+e.height)]})}function cc(t,e){var i=Wu(t.x,e.x),n=Hu(t.x+t.width,e.x+e.width),r=Wu(t.y,e.y),o=Hu(t.y+t.height,e.y+e.height);if(n>=i&&o>=r)return{x:i,y:r,width:n-i,height:o-r}}function hc(t,e,i){var n=I({rectHover:!0},e),r=n.style={strokeNoScale:!0};if(i=i||{x:-1,y:-1,width:2,height:2},t)return 0===t.indexOf("image://")?(r.image=t.slice(8),C(r,i),new rs(n)):Ju(t.replace("path://",""),n,i,"center")}function pc(t,e,i,n,r){for(var o=0,a=r[r.length-1];o<r.length;o++){var s=r[o];if(dc(t,e,i,n,s[0],s[1],a[0],a[1]))return!0;a=s}}function dc(t,e,i,n,r,o,a,s){var l,u=i-t,c=n-e,h=a-r,p=s-o,d=fc(h,p,u,c);if((l=d)<=1e-6&&l>=-1e-6)return!1;var f=t-r,m=e-o,g=fc(f,m,u,c)/d;if(g<0||g>1)return!1;var y=fc(f,m,h,p)/d;return!(y<0||y>1)}function fc(t,e,i,n){return t*n-i*e}function mc(t){var e=t.itemTooltipOption,i=t.componentModel,n=t.itemName,r=$(e)?{formatter:e}:e,o=i.mainType,a=i.componentIndex,s={componentType:o,name:n,$vars:["name"]};s[o+"Index"]=a;var l=t.formatterParamsExtra;l&&L(N(l),function(t){ft(s,t)||(s[t]=l[t],s.$vars.push(t))});var u=Ss(t.el);u.componentMainType=o,u.componentIndex=a,u.tooltipConfig={name:n,option:C({content:n,formatterParams:s},r)}}Yu("circle",Gl),Yu("ellipse",Wl),Yu("sector",ou),Yu("ring",su),Yu("polygon",hu),Yu("polyline",du),Yu("rect",hs),Yu("line",gu),Yu("bezierCurve",xu),Yu("arc",wu);var gc=Object.freeze({__proto__:null,updateProps:Bu,initProps:Nu,removeElement:Vu,removeElementWithFadeOut:Gu,isElementRemoved:Fu,extendShape:Zu,extendPath:Xu,registerShape:Yu,getShapeClass:Ku,makePath:Ju,makeImage:Qu,mergePath:ec,resizePath:ic,subPixelOptimizeLine:function(t){return as(t.shape,t.shape,t.style),t},subPixelOptimizeRect:function(t){return ss(t.shape,t.shape,t.style),t},subPixelOptimize:nc,getTransform:rc,applyTransform:oc,transformDirection:ac,groupTransition:lc,clipPointsByRect:uc,clipRectByRect:cc,createIcon:hc,linePolygonIntersect:pc,lineLineIntersect:dc,setTooltipConfig:mc,Group:Fn,Image:rs,Text:fs,Circle:Gl,Ellipse:Wl,Sector:ou,Ring:su,Polygon:hu,Polyline:du,Rect:hs,Line:gu,BezierCurve:xu,Arc:wu,IncrementalDisplayable:Lu,CompoundPath:Su,LinearGradient:Mu,RadialGradient:Iu,BoundingRect:yn,OrientedBoundingRect:Eu,Point:ln,Path:Qa}),yc={};function vc(t,e){for(var i=0;i<As.length;i++){var n=As[i],r=e[n],o=t.ensureState(n);o.style=o.style||{},o.style.text=r}var a=t.currentStates.slice();t.clearStates(!0),t.setStyle({text:e.normal}),t.useStates(a,!0)}function _c(t,e,i){var n,r=t.labelFetcher,o=t.labelDataIndex,a=t.labelDimIndex,s=e.normal;r&&(n=r.getFormattedLabel(o,"normal",null,a,s&&s.get("formatter"),null!=i?{interpolatedValue:i}:null)),null==n&&(n=G(t.defaultText)?t.defaultText(o,t,i):t.defaultText);for(var l={normal:n},u=0;u<As.length;u++){var c=As[u],h=e[c];l[c]=et(r?r.getFormattedLabel(o,c,null,a,h&&h.get("formatter")):null,n)}return l}function xc(t,e,i,n){i=i||yc;for(var r=t instanceof fs,o=!1,a=0;a<ks.length;a++)if((p=e[ks[a]])&&p.getShallow("show")){o=!0;break}var s=r?t:t.getTextContent();if(o){r||(s||(s=new fs,t.setTextContent(s)),t.stateProxy&&(s.stateProxy=t.stateProxy));var l=_c(i,e),u=e.normal,c=!!u.getShallow("show"),h=wc(u,n&&n.normal,i,!1,!r);for(h.text=l.normal,r||t.setTextConfig(Sc(u,i,!1)),a=0;a<As.length;a++){var p,d=As[a];if(p=e[d]){var f=s.ensureState(d),m=!!et(p.getShallow("show"),c);m!==c&&(f.ignore=!m),f.style=wc(p,n&&n[d],i,!0,!r),f.style.text=l[d],r||(t.ensureState(d).textConfig=Sc(p,i,!0))}}s.silent=!!u.getShallow("silent"),null!=s.style.x&&(h.x=s.style.x),null!=s.style.y&&(h.y=s.style.y),s.ignore=!c,s.useStyle(h),s.dirty(),i.enableTextSetter&&(kc(s).setLabelText=function(t){var n=_c(i,e,t);vc(s,n)})}else s&&(s.ignore=!0);t.dirty()}function bc(t,e){e=e||"label";for(var i={normal:t.getModel(e)},n=0;n<As.length;n++){var r=As[n];i[r]=t.getModel([r,e])}return i}function wc(t,e,i,n,r){var o={};return function(t,e,i,n,r){i=i||yc;var o,a=e.ecModel,s=a&&a.option.textStyle,l=function(t){for(var e;t&&t!==t.ecModel;){var i=(t.option||yc).rich;if(i){e=e||{};for(var n=N(i),r=0;r<n.length;r++)e[n[r]]=1}t=t.parentModel}return e}(e);if(l)for(var u in o={},l)if(l.hasOwnProperty(u)){var c=e.getModel(["rich",u]);Cc(o[u]={},c,s,i,n,r,!1,!0)}o&&(t.rich=o);var h=e.get("overflow");h&&(t.overflow=h);var p=e.get("minMargin");null!=p&&(t.margin=p),Cc(t,e,s,i,n,r,!0,!1)}(o,t,i,n,r),e&&I(o,e),o}function Sc(t,e,i){e=e||{};var n,r={},o=t.getShallow("rotate"),a=et(t.getShallow("distance"),i?null:5),s=t.getShallow("offset");return"outside"===(n=t.getShallow("position")||(i?null:"inside"))&&(n=e.defaultOutsidePosition||"top"),null!=n&&(r.position=n),null!=s&&(r.offset=s),null!=o&&(o*=Math.PI/180,r.rotation=o),null!=a&&(r.distance=a),r.outsideFill="inherit"===t.get("color")?e.inheritColor||null:"auto",r}var Tc=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],Mc=["align","lineHeight","width","height","tag","verticalAlign"],Ic=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function Cc(t,e,i,n,r,o,a,s){i=!r&&i||yc;var l=n&&n.inheritColor,u=e.getShallow("color"),c=e.getShallow("textBorderColor"),h=et(e.getShallow("opacity"),i.opacity);"inherit"!==u&&"auto"!==u||(u=l||null),"inherit"!==c&&"auto"!==c||(c=l||null),o||(u=u||i.color,c=c||i.textBorderColor),null!=u&&(t.fill=u),null!=c&&(t.stroke=c);var p=et(e.getShallow("textBorderWidth"),i.textBorderWidth);null!=p&&(t.lineWidth=p);var d=et(e.getShallow("textBorderType"),i.textBorderType);null!=d&&(t.lineDash=d);var f=et(e.getShallow("textBorderDashOffset"),i.textBorderDashOffset);null!=f&&(t.lineDashOffset=f),r||null!=h||s||(h=n&&n.defaultOpacity),null!=h&&(t.opacity=h),r||o||null==t.fill&&n.inheritColor&&(t.fill=n.inheritColor);for(var m=0;m<Tc.length;m++){var g=Tc[m];null!=(v=et(e.getShallow(g),i[g]))&&(t[g]=v)}for(m=0;m<Mc.length;m++)g=Mc[m],null!=(v=e.getShallow(g))&&(t[g]=v);if(null==t.verticalAlign){var y=e.getShallow("baseline");null!=y&&(t.verticalAlign=y)}if(!a||!n.disableBox){for(m=0;m<Ic.length;m++){var v;g=Ic[m],null!=(v=e.getShallow(g))&&(t[g]=v)}var _=e.getShallow("borderType");null!=_&&(t.borderDash=_),"auto"!==t.backgroundColor&&"inherit"!==t.backgroundColor||!l||(t.backgroundColor=l),"auto"!==t.borderColor&&"inherit"!==t.borderColor||!l||(t.borderColor=l)}}function Ac(t,e){var i=e&&e.getModel("textStyle");return at([t.fontStyle||i&&i.getShallow("fontStyle")||"",t.fontWeight||i&&i.getShallow("fontWeight")||"",(t.fontSize||i&&i.getShallow("fontSize")||12)+"px",t.fontFamily||i&&i.getShallow("fontFamily")||"sans-serif"].join(" "))}var kc=zr();function Dc(t,e,i,n){if(t){var r=kc(t);r.prevValue=r.value,r.value=i;var o=e.normal;r.valueAnimation=o.get("valueAnimation"),r.valueAnimation&&(r.precision=o.get("precision"),r.defaultInterpolatedText=n,r.statesModels=e)}}function Ec(t,e,i,n,r){var o=kc(t);if(o.valueAnimation&&o.prevValue!==o.value){var a=o.defaultInterpolatedText,s=et(o.interpolatedValue,o.prevValue),l=o.value;t.percent=0,(null==o.prevValue?Nu:Bu)(t,{percent:1},n,e,null,function(n){var u=$r(i,o.precision,s,l,n);o.interpolatedValue=1===n?null:u;var c=_c({labelDataIndex:e,labelFetcher:r,defaultText:a?a(u):u+""},o.statesModels,u);vc(t,c)})}}var Pc,Lc,zc=["textStyle","color"],Oc=new fs,Rc=function(){function t(){}return t.prototype.getTextColor=function(t){var e=this.ecModel;return this.getShallow("color")||(!t&&e?e.get(zc):null)},t.prototype.getFont=function(){return Ac({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},t.prototype.getTextRect=function(t){return Oc.useStyle({text:t,fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily"),verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline"),padding:this.getShallow("padding"),lineHeight:this.getShallow("lineHeight"),rich:this.getShallow("rich")}),Oc.update(),Oc.getBoundingRect()},t}(),Bc=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],Nc=to(Bc),Fc=function(){function t(){}return t.prototype.getLineStyle=function(t){return Nc(this,t)},t}(),Vc=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],Uc=to(Vc),Gc=function(){function t(){}return t.prototype.getItemStyle=function(t,e){return Uc(this,t,e)},t}(),$c=function(){function t(t,e,i){this.parentModel=e,this.ecModel=i,this.option=t}return t.prototype.init=function(t,e,i){for(var n=[],r=3;r<arguments.length;r++)n[r-3]=arguments[r]},t.prototype.mergeOption=function(t,e){T(this.option,t,!0)},t.prototype.get=function(t,e){return null==t?this.option:this._doGet(this.parsePath(t),!e&&this.parentModel)},t.prototype.getShallow=function(t,e){var i=this.option,n=null==i?i:i[t];if(null==n&&!e){var r=this.parentModel;r&&(n=r.getShallow(t))}return n},t.prototype.getModel=function(e,i){var n=null!=e,r=n?this.parsePath(e):null;return new t(n?this._doGet(r):this.option,i=i||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(r)),this.ecModel)},t.prototype.isEmpty=function(){return null==this.option},t.prototype.restoreData=function(){},t.prototype.clone=function(){return new(0,this.constructor)(S(this.option))},t.prototype.parsePath=function(t){return"string"==typeof t?t.split("."):t},t.prototype.resolveParentPath=function(t){return t},t.prototype.isAnimationEnabled=function(){if(!a.node&&this.option){if(null!=this.option.animation)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},t.prototype._doGet=function(t,e){var i=this.option;if(!t)return i;for(var n=0;n<t.length&&(!t[n]||null!=(i=i&&"object"==typeof i?i[t[n]]:null));n++);return null==i&&e&&(i=e._doGet(this.resolveParentPath(t),e.parentModel)),i},t}();Zr($c),Pc=$c,Lc=["__\0is_clz",Yr++].join("_"),Pc.prototype[Lc]=!0,Pc.isInstance=function(t){return!(!t||!t[Lc])},E($c,Fc),E($c,Gc),E($c,io),E($c,Rc);var Wc=Math.round(10*Math.random());function Hc(t){return[t||"",Wc++].join("_")}function jc(t,e){return T(T({},t,!0),e,!0)}var Zc="ZH",qc="EN",Xc=qc,Yc={},Kc={},Jc=a.domSupported&&(document.documentElement.lang||navigator.language||navigator.browserLanguage).toUpperCase().indexOf(Zc)>-1?Zc:Xc;function Qc(t,e){t=t.toUpperCase(),Kc[t]=new $c(e),Yc[t]=e}function th(t){return Kc[t]}Qc(qc,{time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}}),Qc(Zc,{time:{month:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthAbbr:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayOfWeek:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayOfWeekAbbr:["日","一","二","三","四","五","六"]},legend:{selector:{all:"全选",inverse:"反选"}},toolbox:{brush:{title:{rect:"矩形选择",polygon:"圈选",lineX:"横向选择",lineY:"纵向选择",keep:"保持选择",clear:"清除选择"}},dataView:{title:"数据视图",lang:["数据视图","关闭","刷新"]},dataZoom:{title:{zoom:"区域缩放",back:"区域缩放还原"}},magicType:{title:{line:"切换为折线图",bar:"切换为柱状图",stack:"切换为堆叠",tiled:"切换为平铺"}},restore:{title:"还原"},saveAsImage:{title:"保存为图片",lang:["右键另存为图片"]}},series:{typeNames:{pie:"饼图",bar:"柱状图",line:"折线图",scatter:"散点图",effectScatter:"涟漪散点图",radar:"雷达图",tree:"树图",treemap:"矩形树图",boxplot:"箱型图",candlestick:"K线图",k:"K线图",heatmap:"热力图",map:"地图",parallel:"平行坐标图",lines:"线图",graph:"关系图",sankey:"桑基图",funnel:"漏斗图",gauge:"仪表盘图",pictorialBar:"象形柱图",themeRiver:"主题河流图",sunburst:"旭日图"}},aria:{general:{withTitle:"这是一个关于“{title}”的图表。",withoutTitle:"这是一个图表，"},series:{single:{prefix:"",withName:"图表类型是{seriesType}，表示{seriesName}。",withoutName:"图表类型是{seriesType}。"},multiple:{prefix:"它由{seriesCount}个图表系列组成。",withName:"第{seriesId}个系列是一个表示{seriesName}的{seriesType}，",withoutName:"第{seriesId}个系列是一个{seriesType}，",separator:{middle:"；",end:"。"}}},data:{allData:"其数据是——",partialData:"其中，前{displayCnt}项是——",withName:"{name}的数据是{value}",withoutName:"{value}",separator:{middle:"，",end:""}}}});var eh=1e3,ih=6e4,nh=36e5,rh=864e5,oh=31536e6,ah={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}",none:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},sh,lh={year:"{yyyy}",month:"{yyyy}-{MM}",day:"{yyyy}-{MM}-{dd}",hour:"{yyyy}-{MM}-{dd} "+ah.hour,minute:"{yyyy}-{MM}-{dd} "+ah.minute,second:"{yyyy}-{MM}-{dd} "+ah.second,millisecond:ah.none},uh=["year","month","day","hour","minute","second","millisecond"],ch=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function hh(t,e){return"0000".substr(0,e-(t+="").length)+t}function ph(t){switch(t){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return t}}function dh(t){return t===ph(t)}function fh(t,e,i,n){var r=sr(t),o=r[yh(i)](),a=r[vh(i)]()+1,s=Math.floor((a-1)/4)+1,l=r[_h(i)](),u=r["get"+(i?"UTC":"")+"Day"](),c=r[xh(i)](),h=(c-1)%12+1,p=r[bh(i)](),d=r[wh(i)](),f=r[Sh(i)](),m=(n instanceof $c?n:th(n||Jc)||Kc.EN).getModel("time"),g=m.get("month"),y=m.get("monthAbbr"),v=m.get("dayOfWeek"),_=m.get("dayOfWeekAbbr");return(e||"").replace(/{yyyy}/g,o+"").replace(/{yy}/g,o%100+"").replace(/{Q}/g,s+"").replace(/{MMMM}/g,g[a-1]).replace(/{MMM}/g,y[a-1]).replace(/{MM}/g,hh(a,2)).replace(/{M}/g,a+"").replace(/{dd}/g,hh(l,2)).replace(/{d}/g,l+"").replace(/{eeee}/g,v[u]).replace(/{ee}/g,_[u]).replace(/{e}/g,u+"").replace(/{HH}/g,hh(c,2)).replace(/{H}/g,c+"").replace(/{hh}/g,hh(h+"",2)).replace(/{h}/g,h+"").replace(/{mm}/g,hh(p,2)).replace(/{m}/g,p+"").replace(/{ss}/g,hh(d,2)).replace(/{s}/g,d+"").replace(/{SSS}/g,hh(f,3)).replace(/{S}/g,f+"")}function mh(t,e){var i=sr(t),n=i[vh(e)]()+1,r=i[_h(e)](),o=i[xh(e)](),a=i[bh(e)](),s=i[wh(e)](),l=0===i[Sh(e)](),u=l&&0===s,c=u&&0===a,h=c&&0===o,p=h&&1===r;return p&&1===n?"year":p?"month":h?"day":c?"hour":u?"minute":l?"second":"millisecond"}function gh(t,e,i){var n="number"==typeof t?sr(t):t;switch(e=e||mh(t,i)){case"year":return n[yh(i)]();case"half-year":return n[vh(i)]()>=6?1:0;case"quarter":return Math.floor((n[vh(i)]()+1)/4);case"month":return n[vh(i)]();case"day":return n[_h(i)]();case"half-day":return n[xh(i)]()/24;case"hour":return n[xh(i)]();case"minute":return n[bh(i)]();case"second":return n[wh(i)]();case"millisecond":return n[Sh(i)]()}}function yh(t){return t?"getUTCFullYear":"getFullYear"}function vh(t){return t?"getUTCMonth":"getMonth"}function _h(t){return t?"getUTCDate":"getDate"}function xh(t){return t?"getUTCHours":"getHours"}function bh(t){return t?"getUTCMinutes":"getMinutes"}function wh(t){return t?"getUTCSeconds":"getSeconds"}function Sh(t){return t?"getUTCMilliseconds":"getMilliseconds"}function Th(t){return t?"setUTCFullYear":"setFullYear"}function Mh(t){return t?"setUTCMonth":"setMonth"}function Ih(t){return t?"setUTCDate":"setDate"}function Ch(t){return t?"setUTCHours":"setHours"}function Ah(t){return t?"setUTCMinutes":"setMinutes"}function kh(t){return t?"setUTCSeconds":"setSeconds"}function Dh(t){return t?"setUTCMilliseconds":"setMilliseconds"}function Eh(t){if(!fr(t))return $(t)?t:"-";var e=(t+"").split(".");return e[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(e.length>1?"."+e[1]:"")}function Ph(t,e){return t=(t||"").toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()}),e&&t&&(t=t.charAt(0).toUpperCase()+t.slice(1)),t}var Lh=rt,zh=/([&<>"'])/g,Oh={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Rh(t){return null==t?"":(t+"").replace(zh,function(t,e){return Oh[e]})}function Bh(t,e,i){function n(t){return t&&at(t)?t:"-"}function r(t){return!(null==t||isNaN(t)||!isFinite(t))}var o="time"===e,a=t instanceof Date;if(o||a){var s=o?sr(t):t;if(!isNaN(+s))return fh(s,"{yyyy}-{MM}-{dd} {hh}:{mm}:{ss}",i);if(a)return"-"}if("ordinal"===e)return W(t)?n(t):H(t)&&r(t)?t+"":"-";var l=dr(t);return r(l)?Eh(l):W(t)?n(t):"boolean"==typeof t?t+"":"-"}var Nh=["a","b","c","d","e","f","g"],Fh=function(t,e){return"{"+t+(null==e?"":e)+"}"};function Vh(t,e,i){U(e)||(e=[e]);var n=e.length;if(!n)return"";for(var r=e[0].$vars||[],o=0;o<r.length;o++){var a=Nh[o];t=t.replace(Fh(a),Fh(a,0))}for(var s=0;s<n;s++)for(var l=0;l<r.length;l++){var u=e[s][r[l]];t=t.replace(Fh(Nh[l],s),i?Rh(u):u)}return t}function Uh(t,e){var i=$(t)?{color:t,extraCssText:e}:t||{},n=i.color,r=i.type;e=i.extraCssText;var o=i.renderMode||"html";return n?"html"===o?"subItem"===r?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+Rh(n)+";"+(e||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+Rh(n)+";"+(e||"")+'"></span>':{renderMode:o,content:"{"+(i.markerId||"markerX")+"|}  ",style:"subItem"===r?{width:4,height:4,borderRadius:2,backgroundColor:n}:{width:10,height:10,borderRadius:5,backgroundColor:n}}:""}function Gh(t,e){return e=e||"transparent",$(t)?t:j(t)&&t.colorStops&&(t.colorStops[0]||{}).color||e}function $h(t,e){if("_blank"===e||"blank"===e){var i=window.open();i.opener=null,i.location.href=t}else window.open(t,e)}var Wh=L,Hh=["left","right","top","bottom","width","height"],jh=[["width","left","right"],["height","top","bottom"]];function Zh(t,e,i,n,r){var o=0,a=0;null==n&&(n=1/0),null==r&&(r=1/0);var s=0;e.eachChild(function(l,u){var c,h,p=l.getBoundingRect(),d=e.childAt(u+1),f=d&&d.getBoundingRect();if("horizontal"===t){var m=p.width+(f?-f.x+p.x:0);(c=o+m)>n||l.newline?(o=0,c=m,a+=s+i,s=p.height):s=Math.max(s,p.height)}else{var g=p.height+(f?-f.y+p.y:0);(h=a+g)>r||l.newline?(o+=s+i,a=0,h=g,s=p.width):s=Math.max(s,p.width)}l.newline||(l.x=o,l.y=a,l.markRedraw(),"horizontal"===t?o=c+i:a=h+i)})}var qh=Zh;function Xh(t,e,i){i=Lh(i||0);var n=e.width,r=e.height,o=Xn(t.left,n),a=Xn(t.top,r),s=Xn(t.right,n),l=Xn(t.bottom,r),u=Xn(t.width,n),c=Xn(t.height,r),h=i[2]+i[0],p=i[1]+i[3],d=t.aspect;switch(isNaN(u)&&(u=n-s-p-o),isNaN(c)&&(c=r-l-h-a),null!=d&&(isNaN(u)&&isNaN(c)&&(d>n/r?u=.8*n:c=.8*r),isNaN(u)&&(u=d*c),isNaN(c)&&(c=u/d)),isNaN(o)&&(o=n-s-u-p),isNaN(a)&&(a=r-l-c-h),t.left||t.right){case"center":o=n/2-u/2-i[3];break;case"right":o=n-u-p}switch(t.top||t.bottom){case"middle":case"center":a=r/2-c/2-i[0];break;case"bottom":a=r-c-h}o=o||0,a=a||0,isNaN(u)&&(u=n-p-o-(s||0)),isNaN(c)&&(c=r-h-a-(l||0));var f=new yn(o+i[3],a+i[0],u,c);return f.margin=i,f}function Yh(t,e,i,n,r){var o=!r||!r.hv||r.hv[0],a=!r||!r.hv||r.hv[1],s=r&&r.boundingMode||"all";if(o||a){var l;if("raw"===s)l="group"===t.type?new yn(0,0,+e.width||0,+e.height||0):t.getBoundingRect();else if(l=t.getBoundingRect(),t.needLocalTransform()){var u=t.getLocalTransform();(l=l.clone()).applyTransform(u)}var c=Xh(C({width:l.width,height:l.height},e),i,n),h=o?c.x-l.x:0,p=a?c.y-l.y:0;"raw"===s?(t.x=h,t.y=p):(t.x+=h,t.y+=p),t.markRedraw()}}function Kh(t){var e=t.layoutMode||t.constructor.layoutMode;return j(e)?e:e?{type:e}:null}function Jh(t,e,i){var n=i&&i.ignoreSize;!U(n)&&(n=[n,n]);var r=a(jh[0],0),o=a(jh[1],1);function a(i,r){var o={},a=0,u={},c=0;if(Wh(i,function(e){u[e]=t[e]}),Wh(i,function(t){s(e,t)&&(o[t]=u[t]=e[t]),l(o,t)&&a++,l(u,t)&&c++}),n[r])return l(e,i[1])?u[i[2]]=null:l(e,i[2])&&(u[i[1]]=null),u;if(2!==c&&a){if(a>=2)return o;for(var h=0;h<i.length;h++){var p=i[h];if(!s(o,p)&&s(t,p)){o[p]=t[p];break}}return o}return u}function s(t,e){return t.hasOwnProperty(e)}function l(t,e){return null!=t[e]&&"auto"!==t[e]}function u(t,e,i){Wh(t,function(t){e[t]=i[t]})}u(jh[0],t,r),u(jh[1],t,o)}function Qh(t){return tp({},t)}function tp(t,e){return e&&t&&Wh(Hh,function(i){e.hasOwnProperty(i)&&(t[i]=e[i])}),t}V(Zh,"vertical"),V(Zh,"horizontal");var ep=zr(),ip=function(t){function e(e,i,n){var r=t.call(this,e,i,n)||this;return r.uid=Hc("ec_cpt_model"),r}return i(e,t),e.prototype.init=function(t,e,i){this.mergeDefaultAndTheme(t,i)},e.prototype.mergeDefaultAndTheme=function(t,e){var i=Kh(this),n=i?Qh(t):{};T(t,e.getTheme().get(this.mainType)),T(t,this.getDefaultOption()),i&&Jh(t,n,i)},e.prototype.mergeOption=function(t,e){T(this.option,t,!0);var i=Kh(this);i&&Jh(this.option,t,i)},e.prototype.optionUpdated=function(t,e){},e.prototype.getDefaultOption=function(){var t=this.constructor;if(!function(t){return!(!t||!t[Hr])}(t))return t.defaultOption;var e=ep(this);if(!e.defaultOption){for(var i=[],n=t;n;){var r=n.prototype.defaultOption;r&&i.push(r),n=n.superClass}for(var o={},a=i.length-1;a>=0;a--)o=T(o,i[a],!0);e.defaultOption=o}return e.defaultOption},e.prototype.getReferringComponents=function(t,e){var i=t+"Index",n=t+"Id";return Vr(this.ecModel,t,{index:this.get(i,!0),id:this.get(n,!0)},e)},e.prototype.getBoxLayoutParams=function(){var t=this;return{left:t.get("left"),top:t.get("top"),right:t.get("right"),bottom:t.get("bottom"),width:t.get("width"),height:t.get("height")}},e.protoInitialize=function(){var t=e.prototype;t.type="component",t.id="",t.name="",t.mainType="",t.subType="",t.componentIndex=0}(),e}($c);Xr(ip,$c),Qr(ip),function(t){var e={};t.registerSubTypeDefaulter=function(t,i){var n=jr(t);e[n.main]=i},t.determineSubType=function(i,n){var r=n.type;if(!r){var o=jr(i).main;t.hasSubTypes(i)&&e[o]&&(r=e[o](n))}return r}}(ip),function(t,e){function i(t,e){return t[e]||(t[e]={predecessor:[],successor:[]}),t[e]}t.topologicalTravel=function(t,n,r,o){if(t.length){var a=function(t){var n={},r=[];return L(t,function(o){var a=i(n,o),s=function(t,e){var i=[];return L(t,function(t){k(e,t)>=0&&i.push(t)}),i}(a.originalDeps=e(o),t);a.entryCount=s.length,0===a.entryCount&&r.push(o),L(s,function(t){k(a.predecessor,t)<0&&a.predecessor.push(t);var e=i(n,t);k(e.successor,t)<0&&e.successor.push(o)})}),{graph:n,noEntryList:r}}(n),s=a.graph,l=a.noEntryList,u={};for(L(t,function(t){u[t]=!0});l.length;){var c=l.pop(),h=s[c],p=!!u[c];p&&(r.call(o,c,h.originalDeps.slice()),delete u[c]),L(h.successor,p?f:d)}L(u,function(){var t;throw Error("")})}function d(t){s[t].entryCount--,0===s[t].entryCount&&l.push(t)}function f(t){u[t]=!0,d(t)}}}(ip,function(t){var e=[];return L(ip.getClassesByMainType(t),function(t){e=e.concat(t.dependencies||t.prototype.dependencies||[])}),e=z(e,function(t){return jr(t).main}),"dataset"!==t&&k(e,"dataset")<=0&&e.unshift("dataset"),e});var np="";"undefined"!=typeof navigator&&(np=navigator.platform||"");var rp="rgba(0, 0, 0, 0.2)",op={darkMode:"auto",colorBy:"series",color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gradientColor:["#f6efa6","#d88273","#bf444c"],aria:{decal:{decals:[{color:rp,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:rp,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:rp,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:rp,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:rp,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:rp,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:np.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1},ap=ht(["tooltip","label","itemName","itemId","itemGroupId","seriesName"]),sp="original",lp="arrayRows",up="objectRows",cp="keyedColumns",hp="typedArray",pp="unknown",dp="column",fp="row",mp=1,gp=2,yp=3,vp=zr();function _p(t,e,i){var n={},r=bp(e);if(!r||!t)return n;var o,a,s=[],l=[],u=e.ecModel,c=vp(u).datasetMap,h=r.uid+"_"+i.seriesLayoutBy;L(t=t.slice(),function(e,i){var r=j(e)?e:t[i]={name:e};"ordinal"===r.type&&null==o&&(o=i,a=f(r)),n[r.name]=[]});var p=c.get(h)||c.set(h,{categoryWayDim:a,valueWayDim:0});function d(t,e,i){for(var n=0;n<i;n++)t.push(e+n)}function f(t){var e=t.dimsDef;return e?e.length:1}return L(t,function(t,e){var i=t.name,r=f(t);if(null==o){var a=p.valueWayDim;d(n[i],a,r),d(l,a,r),p.valueWayDim+=r}else o===e?(d(n[i],0,r),d(s,0,r)):(a=p.categoryWayDim,d(n[i],a,r),d(l,a,r),p.categoryWayDim+=r)}),s.length&&(n.itemName=s),l.length&&(n.seriesName=l),n}function xp(t,e,i){var n={};if(!bp(t))return n;var r,o=e.sourceFormat,a=e.dimensionsDefine;o!==up&&o!==cp||L(a,function(t,e){"name"===(j(t)?t.name:t)&&(r=e)});var s=function(){for(var t={},n={},s=[],l=0,u=Math.min(5,i);l<u;l++){var c=Sp(e.data,o,e.seriesLayoutBy,a,e.startIndex,l);s.push(c);var h=c===yp;if(h&&null==t.v&&l!==r&&(t.v=l),(null==t.n||t.n===t.v||!h&&s[t.n]===yp)&&(t.n=l),p(t)&&s[t.n]!==yp)return t;h||(c===gp&&null==n.v&&l!==r&&(n.v=l),null!=n.n&&n.n!==n.v||(n.n=l))}function p(t){return null!=t.v&&null!=t.n}return p(t)?t:p(n)?n:null}();if(s){n.value=[s.v];var l=null!=r?r:s.n;n.itemName=[l],n.seriesName=[l]}return n}function bp(t){if(!t.get("data",!0))return Vr(t.ecModel,"dataset",{index:t.get("datasetIndex",!0),id:t.get("datasetId",!0)},Nr).models[0]}function wp(t,e){return Sp(t.data,t.sourceFormat,t.seriesLayoutBy,t.dimensionsDefine,t.startIndex,e)}function Sp(t,e,i,n,r,o){var a,s,l;if(q(t))return yp;if(n){var u=n[o];j(u)?(s=u.name,l=u.type):$(u)&&(s=u)}if(null!=l)return"ordinal"===l?mp:yp;if(e===lp){var c=t;if(i===fp){for(var h=c[o],p=0;p<(h||[]).length&&p<5;p++)if(null!=(a=v(h[r+p])))return a}else for(p=0;p<c.length&&p<5;p++){var d=c[r+p];if(d&&null!=(a=v(d[o])))return a}}else if(e===up){var f=t;if(!s)return yp;for(p=0;p<f.length&&p<5;p++)if((g=f[p])&&null!=(a=v(g[s])))return a}else if(e===cp){if(!s)return yp;if(!(h=t[s])||q(h))return yp;for(p=0;p<h.length&&p<5;p++)if(null!=(a=v(h[p])))return a}else if(e===sp){var m=t;for(p=0;p<m.length&&p<5;p++){var g,y=Mr(g=m[p]);if(!U(y))return yp;if(null!=(a=v(y[o])))return a}}function v(t){var e=$(t);return null!=t&&isFinite(t)&&""!==t?e?gp:yp:e&&"-"!==t?mp:void 0}return yp}var Tp=ht(),Mp,Ip,Cp,Ap=zr(),kp=zr(),Dp=function(){function t(){}return t.prototype.getColorFromPalette=function(t,e,i){var n=wr(this.get("color",!0)),r=this.get("colorLayer",!0);return Pp(this,Ap,n,r,t,e,i)},t.prototype.clearColorPalette=function(){var t,e;(e=Ap)(t=this).paletteIdx=0,e(t).paletteNameMap={}},t}();function Ep(t,e,i,n){var r=wr(t.get(["aria","decal","decals"]));return Pp(t,kp,r,null,e,i,n)}function Pp(t,e,i,n,r,o,a){var s=e(o=o||t),l=s.paletteIdx||0,u=s.paletteNameMap=s.paletteNameMap||{};if(u.hasOwnProperty(r))return u[r];var c=null!=a&&n?function(t,e){for(var i=t.length,n=0;n<i;n++)if(t[n].length>e)return t[n];return t[i-1]}(n,a):i;if((c=c||i)&&c.length){var h=c[l];return r&&(u[r]=h),s.paletteIdx=(l+1)%c.length,h}}var Lp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.init=function(t,e,i,n,r,o){n=n||{},this.option=null,this._theme=new $c(n),this._locale=new $c(r),this._optionManager=o},e.prototype.setOption=function(t,e,i){var n=Rp(e);this._optionManager.setOption(t,i,n),this._resetOption(null,n)},e.prototype.resetOption=function(t,e){return this._resetOption(t,Rp(e))},e.prototype._resetOption=function(t,e){var i=!1,n=this._optionManager;if(!t||"recreate"===t){var r=n.mountOption("recreate"===t);this.option&&"recreate"!==t?(this.restoreData(),this._mergeOption(r,e)):Cp(this,r),i=!0}if("timeline"!==t&&"media"!==t||this.restoreData(),!t||"recreate"===t||"timeline"===t){var o=n.getTimelineOption(this);o&&(i=!0,this._mergeOption(o,e))}if(!t||"recreate"===t||"media"===t){var a=n.getMediaOption(this);a.length&&L(a,function(t){i=!0,this._mergeOption(t,e)},this)}return i},e.prototype.mergeOption=function(t){this._mergeOption(t,null)},e.prototype._mergeOption=function(t,e){var i=this.option,n=this._componentsMap,r=this._componentsCount,o=[],a=ht(),s=e&&e.replaceMergeMainTypeMap;vp(this).datasetMap=ht(),L(t,function(t,e){null!=t&&(ip.hasClass(e)?e&&(o.push(e),a.set(e,!0)):i[e]=null==i[e]?S(t):T(i[e],t,!0))}),s&&s.each(function(t,e){ip.hasClass(e)&&!a.get(e)&&(o.push(e),a.set(e,!0))}),ip.topologicalTravel(o,ip.getAllClassMainTypes(),function(e){var o=function(t,e,i){var n=Tp.get(e);if(!n)return i;var r=n(t);return r?i.concat(r):i}(this,e,wr(t[e])),a=n.get(e),l,u=Cr(a,o,a?s&&s.get(e)?"replaceMerge":"normalMerge":"replaceAll");(function(t,e,i){L(t,function(t){var n=t.newOption;j(n)&&(t.keyInfo.mainType=e,t.keyInfo.subType=function(t,e,i,n){return e.type?e.type:i?i.subType:n.determineSubType(t,e)}(e,n,t.existing,i))})})(u,e,ip),i[e]=null,n.set(e,null),r.set(e,0);var c=[],h=[],p=0;L(u,function(t,i){var n=t.existing,r=t.newOption;if(r){var o="series"===e,a=ip.getClass(e,t.keyInfo.subType,!o);if(!a)return;if(n&&n.constructor===a)n.name=t.keyInfo.name,n.mergeOption(r,this),n.optionUpdated(r,!1);else{var s=I({componentIndex:i},t.keyInfo);I(n=new a(r,this,this,s),s),t.brandNew&&(n.__requireNewView=!0),n.init(r,this,this),n.optionUpdated(null,!0)}}else n&&(n.mergeOption({},this),n.optionUpdated({},!1));n?(c.push(n.option),h.push(n),p++):(c.push(void 0),h.push(void 0))},this),i[e]=c,n.set(e,h),r.set(e,p),"series"===e&&Mp(this)},this),this._seriesIndices||Mp(this)},e.prototype.getOption=function(){var t=S(this.option);return L(t,function(e,i){if(ip.hasClass(i)){for(var n=wr(e),r=n.length,o=!1,a=r-1;a>=0;a--)n[a]&&!Pr(n[a])?o=!0:(n[a]=null,!o&&r--);n.length=r,t[i]=n}}),delete t["\0_ec_inner"],t},e.prototype.getTheme=function(){return this._theme},e.prototype.getLocaleModel=function(){return this._locale},e.prototype.setUpdatePayload=function(t){this._payload=t},e.prototype.getUpdatePayload=function(){return this._payload},e.prototype.getComponent=function(t,e){var i=this._componentsMap.get(t);if(i){var n=i[e||0];if(n)return n;if(null==e)for(var r=0;r<i.length;r++)if(i[r])return i[r]}},e.prototype.queryComponents=function(t){var e=t.mainType;if(!e)return[];var i,n=t.index,r=t.id,o=t.name,a=this._componentsMap.get(e);return a&&a.length?(null!=n?(i=[],L(wr(n),function(t){a[t]&&i.push(a[t])})):i=null!=r?zp("id",r,a):null!=o?zp("name",o,a):R(a,function(t){return!!t}),Op(i,t)):[]},e.prototype.findComponents=function(t){var e,i,n,r,o,a=t.query,s=t.mainType,l=(i=s+"Index",n=s+"Id",r=s+"Name",!(e=a)||null==e[i]&&null==e[n]&&null==e[r]?null:{mainType:s,index:e[i],id:e[n],name:e[r]}),u;return o=Op(l?this.queryComponents(l):R(this._componentsMap.get(s),function(t){return!!t}),t),t.filter?R(o,t.filter):o},e.prototype.eachComponent=function(t,e,i){var n=this._componentsMap;if(G(t)){var r=e,o=t;n.each(function(t,e){for(var i=0;t&&i<t.length;i++){var n=t[i];n&&o.call(r,e,n,n.componentIndex)}})}else for(var a=$(t)?n.get(t):j(t)?this.findComponents(t):null,s=0;a&&s<a.length;s++){var l=a[s];l&&e.call(i,l,l.componentIndex)}},e.prototype.getSeriesByName=function(t){var e=Dr(t,null);return R(this._componentsMap.get("series"),function(t){return!!t&&null!=e&&t.name===e})},e.prototype.getSeriesByIndex=function(t){return this._componentsMap.get("series")[t]},e.prototype.getSeriesByType=function(t){return R(this._componentsMap.get("series"),function(e){return!!e&&e.subType===t})},e.prototype.getSeries=function(){return R(this._componentsMap.get("series"),function(t){return!!t})},e.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},e.prototype.eachSeries=function(t,e){Ip(this),L(this._seriesIndices,function(i){var n=this._componentsMap.get("series")[i];t.call(e,n,i)},this)},e.prototype.eachRawSeries=function(t,e){L(this._componentsMap.get("series"),function(i){i&&t.call(e,i,i.componentIndex)})},e.prototype.eachSeriesByType=function(t,e,i){Ip(this),L(this._seriesIndices,function(n){var r=this._componentsMap.get("series")[n];r.subType===t&&e.call(i,r,n)},this)},e.prototype.eachRawSeriesByType=function(t,e,i){return L(this.getSeriesByType(t),e,i)},e.prototype.isSeriesFiltered=function(t){return Ip(this),null==this._seriesIndicesMap.get(t.componentIndex)},e.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},e.prototype.filterSeries=function(t,e){Ip(this);var i=[];L(this._seriesIndices,function(n){var r=this._componentsMap.get("series")[n];t.call(e,r,n)&&i.push(n)},this),this._seriesIndices=i,this._seriesIndicesMap=ht(i)},e.prototype.restoreData=function(t){Mp(this);var e=this._componentsMap,i=[];e.each(function(t,e){ip.hasClass(e)&&i.push(e)}),ip.topologicalTravel(i,ip.getAllClassMainTypes(),function(i){L(e.get(i),function(e){!e||"series"===i&&function(t,e){if(e){var i=e.seriesIndex,n=e.seriesId,r=e.seriesName;return null!=i&&t.componentIndex!==i||null!=n&&t.id!==n||null!=r&&t.name!==r}}(e,t)||e.restoreData()})})},e.internalField=(Mp=function(t){var e=t._seriesIndices=[];L(t._componentsMap.get("series"),function(t){t&&e.push(t.componentIndex)}),t._seriesIndicesMap=ht(e)},Ip=function(t){},void(Cp=function(t,e){t.option={},t.option["\0_ec_inner"]=1,t._componentsMap=ht({series:[]}),t._componentsCount=ht();var i=e.aria;j(i)&&null==i.enabled&&(i.enabled=!0),function(t,e){var i=t.color&&!t.colorLayer;L(e,function(e,n){"colorLayer"===n&&i||ip.hasClass(n)||("object"==typeof e?t[n]=t[n]?T(t[n],e,!1):S(e):null==t[n]&&(t[n]=e))})}(e,t._theme.option),T(e,op,!1),t._mergeOption(e,null)})),e}($c);function zp(t,e,i){if(U(e)){var n=ht();return L(e,function(t){null!=t&&null!=Dr(t,null)&&n.set(t,!0)}),R(i,function(e){return e&&n.get(e[t])})}var r=Dr(e,null);return R(i,function(e){return e&&null!=r&&e[t]===r})}function Op(t,e){return e.hasOwnProperty("subType")?R(t,function(t){return t&&t.subType===e.subType}):t}function Rp(t){var e=ht();return t&&L(wr(t.replaceMerge),function(t){e.set(t,!0)}),{replaceMergeMainTypeMap:e}}E(Lp,Dp);var Bp=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],Np=function(t){L(Bp,function(e){this[e]=F(t[e],t)},this)},Fp={},Vp=function(){function t(){this._coordinateSystems=[]}return t.prototype.create=function(t,e){var i=[];L(Fp,function(n,r){var o=n.create(t,e);i=i.concat(o||[])}),this._coordinateSystems=i},t.prototype.update=function(t,e){L(this._coordinateSystems,function(i){i.update&&i.update(t,e)})},t.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},t.register=function(t,e){Fp[t]=e},t.get=function(t){return Fp[t]},t}(),Up=/^(min|max)?(.+)$/,Gp=function(){function t(t){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=t}return t.prototype.setOption=function(t,e,i){t&&(L(wr(t.series),function(t){t&&t.data&&q(t.data)&&lt(t.data)}),L(wr(t.dataset),function(t){t&&t.source&&q(t.source)&&lt(t.source)})),t=S(t);var n=this._optionBackup,r=function(t,e,i){var n,r,o=[],a=t.baseOption,s=t.timeline,l=t.options,u=t.media,c=!!t.media,h=!!(l||s||a&&a.timeline);function p(t){L(e,function(e){e(t,i)})}return a?(r=a).timeline||(r.timeline=s):((h||c)&&(t.options=t.media=null),r=t),c&&U(u)&&L(u,function(t){t&&t.option&&(t.query?o.push(t):n||(n=t))}),p(r),L(l,function(t){return p(t)}),L(o,function(t){return p(t.option)}),{baseOption:r,timelineOptions:l||[],mediaDefault:n,mediaList:o}}(t,e,!n);this._newBaseOption=r.baseOption,n?(r.timelineOptions.length&&(n.timelineOptions=r.timelineOptions),r.mediaList.length&&(n.mediaList=r.mediaList),r.mediaDefault&&(n.mediaDefault=r.mediaDefault)):this._optionBackup=r},t.prototype.mountOption=function(t){var e=this._optionBackup;return this._timelineOptions=e.timelineOptions,this._mediaList=e.mediaList,this._mediaDefault=e.mediaDefault,this._currentMediaIndices=[],S(t?e.baseOption:this._newBaseOption)},t.prototype.getTimelineOption=function(t){var e,i=this._timelineOptions;if(i.length){var n=t.getComponent("timeline");n&&(e=S(i[n.getCurrentIndex()]))}return e},t.prototype.getMediaOption=function(t){var e,i,n=this._api.getWidth(),r=this._api.getHeight(),o=this._mediaList,a=this._mediaDefault,s=[],l=[];if(!o.length&&!a)return l;for(var u=0,c=o.length;u<c;u++)$p(o[u].query,n,r)&&s.push(u);return!s.length&&a&&(s=[-1]),s.length&&(e=s,i=this._currentMediaIndices,e.join(",")!==i.join(","))&&(l=z(s,function(t){return S(-1===t?a.option:o[t].option)})),this._currentMediaIndices=s,l},t}();function $p(t,e,i){var n={width:e,height:i,aspectratio:e/i},r=!0;return L(t,function(t,e){var i=e.match(Up);if(i&&i[1]&&i[2]){var o=i[1],a=i[2].toLowerCase();(function(t,e,i){return"min"===i?t>=e:"max"===i?t<=e:t===e})(n[a],t,o)||(r=!1)}}),r}var Wp=L,Hp=j,jp=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function Zp(t){var e=t&&t.itemStyle;if(e)for(var i=0,n=jp.length;i<n;i++){var r=jp[i],o=e.normal,a=e.emphasis;o&&o[r]&&(t[r]=t[r]||{},t[r].normal?T(t[r].normal,o[r]):t[r].normal=o[r],o[r]=null),a&&a[r]&&(t[r]=t[r]||{},t[r].emphasis?T(t[r].emphasis,a[r]):t[r].emphasis=a[r],a[r]=null)}}function qp(t,e,i){if(t&&t[e]&&(t[e].normal||t[e].emphasis)){var n=t[e].normal,r=t[e].emphasis;n&&(i?(t[e].normal=t[e].emphasis=null,C(t[e],n)):t[e]=n),r&&(t.emphasis=t.emphasis||{},t.emphasis[e]=r,r.focus&&(t.emphasis.focus=r.focus),r.blurScope&&(t.emphasis.blurScope=r.blurScope))}}function Xp(t){qp(t,"itemStyle"),qp(t,"lineStyle"),qp(t,"areaStyle"),qp(t,"label"),qp(t,"labelLine"),qp(t,"upperLabel"),qp(t,"edgeLabel")}function Yp(t,e){var i=Hp(t)&&t[e],n=Hp(i)&&i.textStyle;if(n)for(var r=0,o=Tr.length;r<o;r++){var a=Tr[r];n.hasOwnProperty(a)&&(i[a]=n[a])}}function Kp(t){t&&(Xp(t),Yp(t,"label"),t.emphasis&&Yp(t.emphasis,"label"))}function Jp(t){return U(t)?t:t?[t]:[]}function Qp(t){return(U(t)?t[0]:t)||{}}function td(t,e){Wp(Jp(t.series),function(t){Hp(t)&&function(t){if(Hp(t)){Zp(t),Xp(t),Yp(t,"label"),Yp(t,"upperLabel"),Yp(t,"edgeLabel"),t.emphasis&&(Yp(t.emphasis,"label"),Yp(t.emphasis,"upperLabel"),Yp(t.emphasis,"edgeLabel"));var e=t.markPoint;e&&(Zp(e),Kp(e));var i=t.markLine;i&&(Zp(i),Kp(i));var n=t.markArea;n&&Kp(n);var r=t.data;if("graph"===t.type){r=r||t.nodes;var o=t.links||t.edges;if(o&&!q(o))for(var a=0;a<o.length;a++)Kp(o[a]);L(t.categories,function(t){Xp(t)})}if(r&&!q(r))for(a=0;a<r.length;a++)Kp(r[a]);if((e=t.markPoint)&&e.data){var s=e.data;for(a=0;a<s.length;a++)Kp(s[a])}if((i=t.markLine)&&i.data){var l=i.data;for(a=0;a<l.length;a++)U(l[a])?(Kp(l[a][0]),Kp(l[a][1])):Kp(l[a])}"gauge"===t.type?(Yp(t,"axisLabel"),Yp(t,"title"),Yp(t,"detail")):"treemap"===t.type?(qp(t.breadcrumb,"itemStyle"),L(t.levels,function(t){Xp(t)})):"tree"===t.type&&Xp(t.leaves)}}(t)});var i=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];e&&i.push("valueAxis","categoryAxis","logAxis","timeAxis"),Wp(i,function(e){Wp(Jp(t[e]),function(t){t&&(Yp(t,"axisLabel"),Yp(t.axisPointer,"label"))})}),Wp(Jp(t.parallel),function(t){var e=t&&t.parallelAxisDefault;Yp(e,"axisLabel"),Yp(e&&e.axisPointer,"label")}),Wp(Jp(t.calendar),function(t){qp(t,"itemStyle"),Yp(t,"dayLabel"),Yp(t,"monthLabel"),Yp(t,"yearLabel")}),Wp(Jp(t.radar),function(t){Yp(t,"name"),t.name&&null==t.axisName&&(t.axisName=t.name,delete t.name),null!=t.nameGap&&null==t.axisNameGap&&(t.axisNameGap=t.nameGap,delete t.nameGap)}),Wp(Jp(t.geo),function(t){Hp(t)&&(Kp(t),Wp(Jp(t.regions),function(t){Kp(t)}))}),Wp(Jp(t.timeline),function(t){Kp(t),qp(t,"label"),qp(t,"itemStyle"),qp(t,"controlStyle",!0);var e=t.data;U(e)&&L(e,function(t){j(t)&&(qp(t,"label"),qp(t,"itemStyle"))})}),Wp(Jp(t.toolbox),function(t){qp(t,"iconStyle"),Wp(t.feature,function(t){qp(t,"iconStyle")})}),Yp(Qp(t.axisPointer),"label"),Yp(Qp(t.tooltip).axisPointer,"label")}function ed(t){t&&L(id,function(e){e[0]in t&&!(e[1]in t)&&(t[e[1]]=t[e[0]])})}var id=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],nd=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],rd=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function od(t){var e=t&&t.itemStyle;if(e)for(var i=0;i<rd.length;i++){var n=rd[i][1],r=rd[i][0];null!=e[n]&&(e[r]=e[n])}}function ad(t){t&&"edge"===t.alignTo&&null!=t.margin&&null==t.edgeDistance&&(t.edgeDistance=t.margin)}function sd(t){t&&t.downplay&&!t.blur&&(t.blur=t.downplay)}function ld(t,e){if(t)for(var i=0;i<t.length;i++)e(t[i]),t[i]&&ld(t[i].children,e)}function ud(t,e){td(t,e),t.series=wr(t.series),L(t.series,function(t){if(j(t)){var e=t.type;if("line"===e)null!=t.clipOverflow&&(t.clip=t.clipOverflow);else if("pie"===e||"gauge"===e){if(null!=t.clockWise&&(t.clockwise=t.clockWise),ad(t.label),(r=t.data)&&!q(r))for(var i=0;i<r.length;i++)ad(r[i]);null!=t.hoverOffset&&(t.emphasis=t.emphasis||{},(t.emphasis.scaleSize=null)&&(t.emphasis.scaleSize=t.hoverOffset))}else if("gauge"===e){var n=function(t,e){for(var i=e.split(","),n=t,r=0;r<1&&null!=(n=n&&n[i[r]]);r++);return n}(t,"pointer.color");null!=n&&function(t,e,i,n){for(var r,o=e.split(","),a=t,s=0;s<o.length-1;s++)null==a[r=o[s]]&&(a[r]={}),a=a[r];null==a[o[s]]&&(a[o[s]]=i)}(t,"itemStyle.color",n)}else if("bar"===e){var r;if(od(t),od(t.backgroundStyle),od(t.emphasis),(r=t.data)&&!q(r))for(i=0;i<r.length;i++)"object"==typeof r[i]&&(od(r[i]),od(r[i]&&r[i].emphasis))}else if("sunburst"===e){var o=t.highlightPolicy;o&&(t.emphasis=t.emphasis||{},t.emphasis.focus||(t.emphasis.focus=o)),sd(t),ld(t.data,sd)}else"graph"===e||"sankey"===e?function(t){t&&null!=t.focusNodeAdjacency&&(t.emphasis=t.emphasis||{},null==t.emphasis.focus&&(t.emphasis.focus="adjacency"))}(t):"map"===e&&(t.mapType&&!t.map&&(t.map=t.mapType),t.mapLocation&&C(t,t.mapLocation));null!=t.hoverAnimation&&(t.emphasis=t.emphasis||{},t.emphasis&&null==t.emphasis.scale&&(t.emphasis.scale=t.hoverAnimation)),ed(t)}}),t.dataRange&&(t.visualMap=t.dataRange),L(nd,function(e){var i=t[e];i&&(U(i)||(i=[i]),L(i,function(t){ed(t)}))})}function cd(t){L(t,function(e,i){var n=[],r=[NaN,NaN],o=[e.stackResultDimension,e.stackedOverDimension],a=e.data,s=e.isStackedByIndex;a.modify(o,function(o,l,u){var c,h,p=a.get(e.stackedDimension,u);if(isNaN(p))return r;s?h=a.getRawIndex(u):c=a.get(e.stackedByDimension,u);for(var d=NaN,f=i-1;f>=0;f--){var m=t[f];if(s||(h=m.data.rawIndexOf(m.stackedByDimension,c)),h>=0){var g=m.data.getByRawIndex(m.stackResultDimension,h);if(p>=0&&g>0||p<=0&&g<0){p=ir(p,g),d=g;break}}}return n[0]=p,n[1]=d,n})})}var hd,pd,dd,fd,md,gd=function(t){this.data=t.data||(t.sourceFormat===cp?{}:[]),this.sourceFormat=t.sourceFormat||pp,this.seriesLayoutBy=t.seriesLayoutBy||dp,this.startIndex=t.startIndex||0,this.dimensionsDetectedCount=t.dimensionsDetectedCount,this.metaRawOption=t.metaRawOption;var e=this.dimensionsDefine=t.dimensionsDefine;if(e)for(var i=0;i<e.length;i++){var n=e[i];null==n.type&&wp(this,i)===mp&&(n.type="ordinal")}};function yd(t){return t instanceof gd}function vd(t,e,i){i=i||xd(t);var n=e.seriesLayoutBy,r=function(t,e,i,n,r){var o,a;if(!t)return{dimensionsDefine:bd(r),startIndex:a,dimensionsDetectedCount:o};if(e===lp){var s=t;"auto"===n||null==n?wd(function(t){null!=t&&"-"!==t&&($(t)?null==a&&(a=1):a=0)},i,s,10):a=H(n)?n:n?1:0,r||1!==a||(r=[],wd(function(t,e){r[e]=null!=t?t+"":""},i,s,1/0)),o=r?r.length:i===fp?s.length:s[0]?s[0].length:null}else if(e===up)r||(r=function(t){for(var e,i=0;i<t.length&&!(e=t[i++]););if(e){var n=[];return L(e,function(t,e){n.push(e)}),n}}(t));else if(e===cp)r||(r=[],L(t,function(t,e){r.push(e)}));else if(e===sp){var l=Mr(t[0]);o=U(l)&&l.length||1}return{startIndex:a,dimensionsDefine:bd(r),dimensionsDetectedCount:o}}(t,i,n,e.sourceHeader,e.dimensions);return new gd({data:t,sourceFormat:i,seriesLayoutBy:n,dimensionsDefine:r.dimensionsDefine,startIndex:r.startIndex,dimensionsDetectedCount:r.dimensionsDetectedCount,metaRawOption:S(e)})}function _d(t){return new gd({data:t,sourceFormat:q(t)?hp:sp})}function xd(t){var e=pp;if(q(t))e=hp;else if(U(t)){0===t.length&&(e=lp);for(var i=0,n=t.length;i<n;i++){var r=t[i];if(null!=r){if(U(r)){e=lp;break}if(j(r)){e=up;break}}}}else if(j(t))for(var o in t)if(ft(t,o)&&P(t[o])){e=cp;break}return e}function bd(t){if(t){var e=ht();return z(t,function(t,i){var n={name:(t=j(t)?t:{name:t}).name,displayName:t.displayName,type:t.type};if(null==n.name)return n;n.name+="",null==n.displayName&&(n.displayName=n.name);var r=e.get(n.name);return r?n.name+="-"+r.count++:e.set(n.name,{count:1}),n})}}function wd(t,e,i,n){if(e===fp)for(var r=0;r<i.length&&r<n;r++)t(i[r]?i[r][0]:null,r);else{var o=i[0]||[];for(r=0;r<o.length&&r<n;r++)t(o[r],r)}}function Sd(t){var e=t.sourceFormat;return e===up||e===cp}var Td=function(){function t(t,e){var i=yd(t)?t:_d(t);this._source=i;var n=this._data=i.data;i.sourceFormat===hp&&(this._offset=0,this._dimSize=e,this._data=n),md(this,n,i)}return t.prototype.getSource=function(){return this._source},t.prototype.count=function(){return 0},t.prototype.getItem=function(t,e){},t.prototype.appendData=function(t){},t.prototype.clean=function(){},t.protoInitialize=((e=t.prototype).pure=!1,void(e.persistent=!0)),t.internalField=function(){var t;md=function(t,r,o){var a=o.sourceFormat,s=o.seriesLayoutBy,l=o.startIndex,u=o.dimensionsDefine,c;if(I(t,fd[zd(a,s)]),a===hp)t.getItem=e,t.count=n,t.fillStorage=i;else{var h=Cd(a,s);t.getItem=F(h,null,r,l,u);var p=Dd(a,s);t.count=F(p,null,r,l,u)}};var e=function(t,e){t-=this._offset,e=e||[];for(var i=this._data,n=this._dimSize,r=n*t,o=0;o<n;o++)e[o]=i[r+o];return e},i=function(t,e,i,n){for(var r=this._data,o=this._dimSize,a=0;a<o;a++){for(var s=n[a],l=null==s[0]?1/0:s[0],u=null==s[1]?-1/0:s[1],c=e-t,h=i[a],p=0;p<c;p++){var d=r[p*o+a];h[t+p]=d,d<l&&(l=d),d>u&&(u=d)}s[0]=l,s[1]=u}},n=function(){return this._data?this._data.length/this._dimSize:0};function r(t){for(var e=0;e<t.length;e++)this._data.push(t[e])}(t={}).arrayRows_column={pure:!0,appendData:r},t.arrayRows_row={pure:!0,appendData:function(){throw Error('Do not support appendData when set seriesLayoutBy: "row".')}},t.objectRows={pure:!0,appendData:r},t.keyedColumns={pure:!0,appendData:function(t){var e=this._data;L(t,function(t,i){for(var n=e[i]||(e[i]=[]),r=0;r<(t||[]).length;r++)n.push(t[r])})}},t.original={appendData:r},t.typedArray={persistent:!1,pure:!0,appendData:function(t){this._data=t},clean:function(){this._offset+=this.count(),this._data=null}},fd=t}(),t;var e}(),Md=function(t,e,i,n){return t[n]},Id=((hd={}).arrayRows_column=function(t,e,i,n){return t[n+e]},hd.arrayRows_row=function(t,e,i,n,r){n+=e;for(var o=r||[],a=t,s=0;s<a.length;s++){var l=a[s];o[s]=l?l[n]:null}return o},hd.objectRows=Md,hd.keyedColumns=function(t,e,i,n,r){for(var o=r||[],a=0;a<i.length;a++){var s,l=t[i[a].name];o[a]=l?l[n]:null}return o},hd.original=Md,hd);function Cd(t,e){var i;return Id[zd(t,e)]}var Ad=function(t,e,i){return t.length},kd=((pd={}).arrayRows_column=function(t,e,i){return Math.max(0,t.length-e)},pd.arrayRows_row=function(t,e,i){var n=t[0];return n?Math.max(0,n.length-e):0},pd.objectRows=Ad,pd.keyedColumns=function(t,e,i){var n,r=t[i[0].name];return r?r.length:0},pd.original=Ad,pd);function Dd(t,e){var i;return kd[zd(t,e)]}var Ed=function(t,e,i){return t[e]},Pd=((dd={}).arrayRows=Ed,dd.objectRows=function(t,e,i){return t[i]},dd.keyedColumns=Ed,dd.original=function(t,e,i){var n=Mr(t);return n instanceof Array?n[e]:n},dd.typedArray=Ed,dd);function Ld(t){var e;return Pd[t]}function zd(t,e){return t===lp?t+"_"+e:t}function Od(t,e,i){if(t){var n=t.getRawDataItem(e);if(null!=n){var r=t.getStore(),o=r.getSource().sourceFormat;if(null!=i){var a=t.getDimensionIndex(i),s=r.getDimensionProperty(a);return Ld(o)(n,a,s)}var l=n;return o===sp&&(l=Mr(n)),l}}}var Rd=/\{@(.+?)\}/g,Bd=function(){function t(){}return t.prototype.getDataParams=function(t,e){var i=this.getData(e),n=this.getRawValue(t,e),r=i.getRawIndex(t),o=i.getName(t),a=i.getRawDataItem(t),s=i.getItemVisual(t,"style"),l=s&&s[i.getItemVisual(t,"drawType")||"fill"],u=s&&s.stroke,c=this.mainType,h="series"===c,p=i.userOutput&&i.userOutput.get();return{componentType:c,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:h?this.subType:null,seriesIndex:this.seriesIndex,seriesId:h?this.id:null,seriesName:h?this.name:null,name:o,dataIndex:r,data:a,dataType:e,value:n,color:l,borderColor:u,dimensionNames:p?p.fullDimensions:null,encode:p?p.encode:null,$vars:["seriesName","name","value"]}},t.prototype.getFormattedLabel=function(t,e,i,n,r,o){e=e||"normal";var a=this.getData(i),s=this.getDataParams(t,i);return o&&(s.value=o.interpolatedValue),null!=n&&U(s.value)&&(s.value=s.value[n]),r||(r=a.getItemModel(t).get("normal"===e?["label","formatter"]:[e,"label","formatter"])),"function"==typeof r?(s.status=e,s.dimensionIndex=n,r(s)):"string"==typeof r?Vh(r,s).replace(Rd,function(e,i){var n=i.length,r=i;"["===r.charAt(0)&&"]"===r.charAt(n-1)&&(r=+r.slice(1,n-1));var s=Od(a,t,r);if(o&&U(o.interpolatedValue)){var l=a.getDimensionIndex(r);l>=0&&(s=o.interpolatedValue[l])}return null!=s?s+"":""}):void 0},t.prototype.getRawValue=function(t,e){return Od(this.getData(e),t)},t.prototype.formatTooltip=function(t,e,i){},t}();function Nd(t){var e,i;return j(t)?t.type&&(i=t):e=t,{markupText:e,markupFragment:i}}function Fd(t){return new Vd(t)}var Vd=function(){function t(t){t=t||{},this._reset=t.reset,this._plan=t.plan,this._count=t.count,this._onDirty=t.onDirty,this._dirty=!0}return t.prototype.perform=function(t){var e,i=this._upstream,n=t&&t.skip;if(this._dirty&&i){var r=this.context;r.data=r.outputData=i.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this),this._plan&&!n&&(e=this._plan(this.context));var o,a=c(this._modBy),s=this._modDataCount||0,l=c(t&&t.modBy),u=t&&t.modDataCount||0;function c(t){return!(t>=1)&&(t=1),t}a===l&&s===u||(e="reset"),(this._dirty||"reset"===e)&&(this._dirty=!1,o=this._doReset(n)),this._modBy=l,this._modDataCount=u;var h=t&&t.step;if(this._dueEnd=i?i._outputDueEnd:this._count?this._count(this.context):1/0,this._progress){var p=this._dueIndex,d=Math.min(null!=h?this._dueIndex+h:1/0,this._dueEnd);if(!n&&(o||p<d)){var f=this._progress;if(U(f))for(var m=0;m<f.length;m++)this._doProgress(f[m],p,d,l,u);else this._doProgress(f,p,d,l,u)}this._dueIndex=d;var g=null!=this._settedOutputEnd?this._settedOutputEnd:d;this._outputDueEnd=g}else this._dueIndex=this._outputDueEnd=null!=this._settedOutputEnd?this._settedOutputEnd:this._dueEnd;return this.unfinished()},t.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},t.prototype._doProgress=function(t,e,i,n,r){Ud.reset(e,i,n,r),this._callingProgress=t,this._callingProgress({start:e,end:i,count:i-e,next:Ud.next},this.context)},t.prototype._doReset=function(t){var e,i;this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null,!t&&this._reset&&((e=this._reset(this.context))&&e.progress&&(i=e.forceFirstProgress,e=e.progress),U(e)&&!e.length&&(e=null)),this._progress=e,this._modBy=this._modDataCount=null;var n=this._downstream;return n&&n.dirty(),i},t.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},t.prototype.pipe=function(t){(this._downstream!==t||this._dirty)&&(this._downstream=t,t._upstream=this,t.dirty())},t.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},t.prototype.getUpstream=function(){return this._upstream},t.prototype.getDownstream=function(){return this._downstream},t.prototype.setOutputEnd=function(t){this._outputDueEnd=this._settedOutputEnd=t},t}(),Ud=function(){var t,e,i,n,r,o={reset:function(l,u,c,h){e=l,t=u,r=Math.ceil((n=h)/(i=c)),o.next=i>1&&n>0?s:a}};return o;function a(){return e<t?e++:null}function s(){var o=e%r*i+Math.ceil(e/r),a=e>=t?null:o<n?o:e;return e++,a}}();function Gd(t,e){var i=e&&e.type;return"ordinal"===i?t:("time"===i&&"number"!=typeof t&&null!=t&&"-"!==t&&(t=+sr(t)),null==t||""===t?NaN:+t)}var $d=ht({number:function(t){return parseFloat(t)},time:function(t){return+sr(t)},trim:function(t){return"string"==typeof t?at(t):t}});function Wd(t){return $d.get(t)}var Hd={lt:function(t,e){return t<e},lte:function(t,e){return t<=e},gt:function(t,e){return t>e},gte:function(t,e){return t>=e}},jd=function(){function t(t,e){var i;"number"!=typeof e&&_r("");this._opFn=Hd[t],this._rvalFloat=dr(e)}return t.prototype.evaluate=function(t){return"number"==typeof t?this._opFn(t,this._rvalFloat):this._opFn(dr(t),this._rvalFloat)},t}(),Zd=function(){function t(t,e){var i="desc"===t;this._resultLT=i?1:-1,null==e&&(e=i?"min":"max"),this._incomparable="min"===e?-1/0:1/0}return t.prototype.evaluate=function(t,e){var i=typeof t,n=typeof e,r="number"===i?t:dr(t),o="number"===n?e:dr(e),a=isNaN(r),s=isNaN(o);if(a&&(r=this._incomparable),s&&(o=this._incomparable),a&&s){var l="string"===i,u="string"===n;l&&(r=u?t:0),u&&(o=l?e:0)}return r<o?this._resultLT:r>o?-this._resultLT:0},t}(),qd=function(){function t(t,e){this._rval=e,this._isEQ=t,this._rvalTypeof=typeof e,this._rvalFloat=dr(e)}return t.prototype.evaluate=function(t){var e=t===this._rval;if(!e){var i=typeof t;i===this._rvalTypeof||"number"!==i&&"number"!==this._rvalTypeof||(e=dr(t)===this._rvalFloat)}return this._isEQ?e:!e},t}();function Xd(t,e){return"eq"===t||"ne"===t?new qd("eq"===t,e):ft(Hd,t)?new jd(t,e):null}var Yd=function(){function t(){}return t.prototype.getRawData=function(){throw Error("not supported")},t.prototype.getRawDataItem=function(t){throw Error("not supported")},t.prototype.cloneRawData=function(){},t.prototype.getDimensionInfo=function(t){},t.prototype.cloneAllDimensionInfo=function(){},t.prototype.count=function(){},t.prototype.retrieveValue=function(t,e){},t.prototype.retrieveValueFromItem=function(t,e){},t.prototype.convertValue=function(t,e){return Gd(t,e)},t}();function Kd(t){var e,i;rf(t.sourceFormat)||_r("");return t.data}function Jd(t){var e=t.sourceFormat,i=t.data,n;rf(e)||_r("");if(e===lp){for(var r=[],o=0,a=i.length;o<a;o++)r.push(i[o].slice());return r}if(e===up){for(r=[],o=0,a=i.length;o<a;o++)r.push(I({},i[o]));return r}}function Qd(t,e,i){if(null!=i)return"number"==typeof i||!isNaN(i)&&!ft(e,i)?t[i]:ft(e,i)?e[i]:void 0}function tf(t){return S(t)}var ef=ht();function nf(t,e,i,n){var r="";e.length||_r(r),j(t)||_r(r);var o=t.type,a=ef.get(o);a||_r(r);var s=z(e,function(t){return function(t,e){var i=new Yd,n=t.data,r=i.sourceFormat=t.sourceFormat,o=t.startIndex,a="";t.seriesLayoutBy!==dp&&_r(a);var s=[],l={},u=t.dimensionsDefine;if(u)L(u,function(t,e){var i=t.name,n={index:e,name:i,displayName:t.displayName};if(s.push(n),null!=i){var r="";ft(l,i)&&_r(r),l[i]=n}});else for(var c=0;c<t.dimensionsDetectedCount;c++)s.push({index:c});var h=Cd(r,dp);e.__isBuiltIn&&(i.getRawDataItem=function(t){return h(n,o,s,t)},i.getRawData=F(Kd,null,t)),i.cloneRawData=F(Jd,null,t);var p=Dd(r,dp);i.count=F(p,null,n,o,s);var d=Ld(r);i.retrieveValue=function(t,e){var i=h(n,o,s,t);return f(i,e)};var f=i.retrieveValueFromItem=function(t,e){if(null!=t){var i=s[e];return i?d(t,e,i.name):void 0}};return i.getDimensionInfo=F(Qd,null,s,l),i.cloneAllDimensionInfo=F(tf,null,s),i}(t,a)}),l;return z(wr(a.transform({upstream:s[0],upstreamList:s,config:S(t.config)})),function(t,i){var n,r="";j(t)||_r(r),t.data||_r(r),rf(xd(t.data))||_r(r);var o=e[0];if(o&&0===i&&!t.dimensions){var a=o.startIndex;a&&(t.data=o.data.slice(0,a).concat(t.data)),n={seriesLayoutBy:dp,sourceHeader:a,dimensions:o.metaRawOption.dimensions}}else n={seriesLayoutBy:dp,sourceHeader:0,dimensions:t.dimensions};return vd(t.data,n,null)})}function rf(t){return t===lp||t===up}var of,af="undefined",sf=typeof Uint32Array===af?Array:Uint32Array,lf=typeof Uint16Array===af?Array:Uint16Array,uf=typeof Int32Array===af?Array:Int32Array,cf=typeof Float64Array===af?Array:Float64Array,hf={float:cf,int:uf,ordinal:Array,number:Array,time:cf};function pf(t){return t>65535?sf:lf}function df(t,e,i,n,r){var o=hf[i||"float"];if(r){var a=t[e],s=a&&a.length;if(s!==n){for(var l=new o(n),u=0;u<s;u++)l[u]=a[u];t[e]=l}}else t[e]=new o(n)}var ff=function(){function t(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=ht()}return t.prototype.initData=function(t,e,i){this._provider=t,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var n=t.getSource(),r=this.defaultDimValueGetter=of[n.sourceFormat];this._dimValueGetter=i||r,this._rawExtent=[],Sd(n),this._dimensions=z(e,function(t){return{type:t.type,property:t.property}}),this._initDataFromProvider(0,t.count())},t.prototype.getProvider=function(){return this._provider},t.prototype.getSource=function(){return this._provider.getSource()},t.prototype.ensureCalculationDimension=function(t,e){var i=this._calcDimNameToIdx,n=this._dimensions,r=i.get(t);if(null!=r){if(n[r].type===e)return r}else r=n.length;return n[r]={type:e},i.set(t,r),this._chunks[r]=new hf[e||"float"](this._rawCount),this._rawExtent[r]=[1/0,-1/0],r},t.prototype.collectOrdinalMeta=function(t,e){var i=this._chunks[t],n=this._dimensions[t],r=this._rawExtent,o=n.ordinalOffset||0,a=i.length;0===o&&(r[t]=[1/0,-1/0]);for(var s=r[t],l=o;l<a;l++){var u=i[l]=e.parseAndCollect(i[l]);s[0]=Math.min(u,s[0]),s[1]=Math.max(u,s[1])}n.ordinalMeta=e,n.ordinalOffset=a,n.type="ordinal"},t.prototype.getOrdinalMeta=function(t){return this._dimensions[t].ordinalMeta},t.prototype.getDimensionProperty=function(t){var e=this._dimensions[t];return e&&e.property},t.prototype.appendData=function(t){var e=this._provider,i=this.count();e.appendData(t);var n=e.count();return e.persistent||(n+=i),i<n&&this._initDataFromProvider(i,n,!0),[i,n]},t.prototype.appendValues=function(t,e){for(var i=this._chunks,n=this._dimensions,r=n.length,o=this._rawExtent,a=this.count(),s=a+Math.max(t.length,e||0),l=0;l<r;l++)df(i,l,(d=n[l]).type,s,!0);for(var u=[],c=a;c<s;c++)for(var h=c-a,p=0;p<r;p++){var d=n[p],f=of.arrayRows.call(this,t[h]||u,d.property,h,p);i[p][c]=f;var m=o[p];f<m[0]&&(m[0]=f),f>m[1]&&(m[1]=f)}return this._rawCount=this._count=s,{start:a,end:s}},t.prototype._initDataFromProvider=function(t,e,i){for(var n=this._provider,r=this._chunks,o=this._dimensions,a=o.length,s=this._rawExtent,l=z(o,function(t){return t.property}),u=0;u<a;u++){var c=o[u];s[u]||(s[u]=[1/0,-1/0]),df(r,u,c.type,e,i)}if(n.fillStorage)n.fillStorage(t,e,r,s);else for(var h=[],p=t;p<e;p++){h=n.getItem(p,h);for(var d=0;d<a;d++){var f=r[d],m=this._dimValueGetter(h,l[d],p,d);f[p]=m;var g=s[d];m<g[0]&&(g[0]=m),m>g[1]&&(g[1]=m)}}!n.persistent&&n.clean&&n.clean(),this._rawCount=this._count=e,this._extent=[]},t.prototype.count=function(){return this._count},t.prototype.get=function(t,e){if(!(e>=0&&e<this._count))return NaN;var i=this._chunks[t];return i?i[this.getRawIndex(e)]:NaN},t.prototype.getValues=function(t,e){var i=[],n=[];if(null==e){e=t,t=[];for(var r=0;r<this._dimensions.length;r++)n.push(r)}else n=t;r=0;for(var o=n.length;r<o;r++)i.push(this.get(n[r],e));return i},t.prototype.getByRawIndex=function(t,e){if(!(e>=0&&e<this._rawCount))return NaN;var i=this._chunks[t];return i?i[e]:NaN},t.prototype.getSum=function(t){var e=0;if(this._chunks[t])for(var i=0,n=this.count();i<n;i++){var r=this.get(t,i);isNaN(r)||(e+=r)}return e},t.prototype.getMedian=function(t){var e=[];this.each([t],function(t){isNaN(t)||e.push(t)});var i=e.sort(function(t,e){return t-e}),n=this.count();return 0===n?0:n%2==1?i[(n-1)/2]:(i[n/2]+i[n/2-1])/2},t.prototype.indexOfRawIndex=function(t){if(t>=this._rawCount||t<0)return-1;if(!this._indices)return t;var e=this._indices,i=e[t];if(null!=i&&i<this._count&&i===t)return t;for(var n=0,r=this._count-1;n<=r;){var o=(n+r)/2|0;if(e[o]<t)n=o+1;else{if(!(e[o]>t))return o;r=o-1}}return-1},t.prototype.indicesOfNearest=function(t,e,i){var n=this._chunks[t],r=[];if(!n)return r;null==i&&(i=1/0);for(var o=1/0,a=-1,s=0,l=0,u=this.count();l<u;l++){var c=e-n[this.getRawIndex(l)],h=Math.abs(c);h<=i&&((h<o||h===o&&c>=0&&a<0)&&(o=h,a=c,s=0),c===a&&(r[s++]=l))}return r.length=s,r},t.prototype.getIndices=function(){var t,e=this._indices;if(e){var i=e.constructor,n=this._count;if(i===Array){t=new i(n);for(var r=0;r<n;r++)t[r]=e[r]}else t=new i(e.buffer,0,n)}else for(t=new(i=pf(this._rawCount))(this.count()),r=0;r<t.length;r++)t[r]=r;return t},t.prototype.filter=function(t,e){if(!this._count)return this;for(var i=this.clone(),n=i.count(),r=new(pf(i._rawCount))(n),o=[],a=t.length,s=0,l=t[0],u=i._chunks,c=0;c<n;c++){var h=void 0,p=i.getRawIndex(c);if(0===a)h=e(c);else if(1===a)h=e(u[l][p],c);else{for(var d=0;d<a;d++)o[d]=u[t[d]][p];o[d]=c,h=e.apply(null,o)}h&&(r[s++]=p)}return s<n&&(i._indices=r),i._count=s,i._extent=[],i._updateGetRawIdx(),i},t.prototype.selectRange=function(t){var e=this.clone(),i=e._count;if(!i)return this;var n=N(t),r=n.length;if(!r)return this;var o=e.count(),a=new(pf(e._rawCount))(o),s=0,l=n[0],u=t[l][0],c=t[l][1],h=e._chunks,p=!1;if(!e._indices){var d=0;if(1===r){for(var f=h[n[0]],m=0;m<i;m++)((_=f[m])>=u&&_<=c||isNaN(_))&&(a[s++]=d),d++;p=!0}else if(2===r){f=h[n[0]];var g=h[n[1]],y=t[n[1]][0],v=t[n[1]][1];for(m=0;m<i;m++){var _=f[m],x=g[m];(_>=u&&_<=c||isNaN(_))&&(x>=y&&x<=v||isNaN(x))&&(a[s++]=d),d++}p=!0}}if(!p)if(1===r)for(m=0;m<o;m++){var b=e.getRawIndex(m);((_=h[n[0]][b])>=u&&_<=c||isNaN(_))&&(a[s++]=b)}else for(m=0;m<o;m++){for(var w=!0,S=(b=e.getRawIndex(m),0);S<r;S++){var T=n[S];((_=h[T][b])<t[T][0]||_>t[T][1])&&(w=!1)}w&&(a[s++]=e.getRawIndex(m))}return s<o&&(e._indices=a),e._count=s,e._extent=[],e._updateGetRawIdx(),e},t.prototype.map=function(t,e){var i=this.clone(t);return this._updateDims(i,t,e),i},t.prototype.modify=function(t,e){this._updateDims(this,t,e)},t.prototype._updateDims=function(t,e,i){for(var n=t._chunks,r=[],o=e.length,a=t.count(),s=[],l=t._rawExtent,u=0;u<e.length;u++)l[e[u]]=[1/0,-1/0];for(var c=0;c<a;c++){for(var h=t.getRawIndex(c),p=0;p<o;p++)s[p]=n[e[p]][h];s[o]=c;var d=i&&i.apply(null,s);if(null!=d)for("object"!=typeof d&&(r[0]=d,d=r),u=0;u<d.length;u++){var f=e[u],m=d[u],g=l[f],y=n[f];y&&(y[h]=m),m<g[0]&&(g[0]=m),m>g[1]&&(g[1]=m)}}},t.prototype.lttbDownSample=function(t,e){var i,n,r,o=this.clone([t],!0),a=o._chunks[t],s=this.count(),l=0,u=Math.floor(1/e),c=this.getRawIndex(0),h=new(pf(this._rawCount))(Math.ceil(s/u)+2);h[l++]=c;for(var p=1;p<s-1;p+=u){for(var d=Math.min(p+u,s-1),f=Math.min(p+2*u,s),m=(f+d)/2,g=0,y=d;y<f;y++){var v=a[S=this.getRawIndex(y)];isNaN(v)||(g+=v)}g/=f-d;var _=p,x=Math.min(p+u,s),b=p-1,w=a[c];for(i=-1,r=_,y=_;y<x;y++){var S;v=a[S=this.getRawIndex(y)],isNaN(v)||(n=Math.abs((b-m)*(v-w)-(b-y)*(g-w)))>i&&(i=n,r=S)}h[l++]=r,c=r}return h[l++]=this.getRawIndex(s-1),o._count=l,o._indices=h,o.getRawIndex=this._getRawIdx,o},t.prototype.downSample=function(t,e,i,n){for(var r=this.clone([t],!0),o=r._chunks,a=[],s=Math.floor(1/e),l=o[t],u=this.count(),c=r._rawExtent[t]=[1/0,-1/0],h=new(pf(this._rawCount))(Math.ceil(u/s)),p=0,d=0;d<u;d+=s){s>u-d&&(s=u-d,a.length=s);for(var f=0;f<s;f++){var m=this.getRawIndex(d+f);a[f]=l[m]}var g=i(a),y=this.getRawIndex(Math.min(d+n(a,g)||0,u-1));l[y]=g,g<c[0]&&(c[0]=g),g>c[1]&&(c[1]=g),h[p++]=y}return r._count=p,r._indices=h,r._updateGetRawIdx(),r},t.prototype.each=function(t,e){if(this._count)for(var i=t.length,n=this._chunks,r=0,o=this.count();r<o;r++){var a=this.getRawIndex(r);switch(i){case 0:e(r);break;case 1:e(n[t[0]][a],r);break;case 2:e(n[t[0]][a],n[t[1]][a],r);break;default:for(var s=0,l=[];s<i;s++)l[s]=n[t[s]][a];l[s]=r,e.apply(null,l)}}},t.prototype.getDataExtent=function(t){var e=this._chunks[t],i=[1/0,-1/0];if(!e)return i;var n,r=this.count();if(!this._indices)return this._rawExtent[t].slice();if(n=this._extent[t])return n.slice();for(var o=(n=i)[0],a=n[1],s=0;s<r;s++){var l=e[this.getRawIndex(s)];l<o&&(o=l),l>a&&(a=l)}return n=[o,a],this._extent[t]=n,n},t.prototype.getRawDataItem=function(t){var e=this.getRawIndex(t);if(this._provider.persistent)return this._provider.getItem(e);for(var i=[],n=this._chunks,r=0;r<n.length;r++)i.push(n[r][e]);return i},t.prototype.clone=function(e,i){var n,r,o=new t,a=this._chunks,s=e&&O(e,function(t,e){return t[e]=!0,t},{});if(s)for(var l=0;l<a.length;l++)o._chunks[l]=s[l]?(r=void 0,(r=(n=a[l]).constructor)===Array?n.slice():new r(n)):a[l];else o._chunks=a;return this._copyCommonProps(o),i||(o._indices=this._cloneIndices()),o._updateGetRawIdx(),o},t.prototype._copyCommonProps=function(t){t._count=this._count,t._rawCount=this._rawCount,t._provider=this._provider,t._dimensions=this._dimensions,t._extent=S(this._extent),t._rawExtent=S(this._rawExtent)},t.prototype._cloneIndices=function(){if(this._indices){var t=this._indices.constructor,e=void 0;if(t===Array){var i=this._indices.length;e=new t(i);for(var n=0;n<i;n++)e[n]=this._indices[n]}else e=new t(this._indices);return e}return null},t.prototype._getRawIdxIdentity=function(t){return t},t.prototype._getRawIdx=function(t){return t<this._count&&t>=0?this._indices[t]:-1},t.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},t.internalField=function(){function t(t,e,i,n){return Gd(t[n],this._dimensions[n])}of={arrayRows:t,objectRows:function(t,e,i,n){return Gd(t[e],this._dimensions[n])},keyedColumns:t,original:function(t,e,i,n){var r=t&&(null==t.value?t:t.value);return Gd(r instanceof Array?r[n]:r,this._dimensions[n])},typedArray:function(t,e,i,n){return t[n]}}}(),t}(),mf=function(){function t(t){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=t}return t.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},t.prototype._setLocalSource=function(t,e){this._sourceList=t,this._upstreamSignList=e,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},t.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},t.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},t.prototype._createSource=function(){this._setLocalSource([],[]);var t,e,i=this._sourceHost,n=this._getUpstreamSourceManagers(),r=!!n.length;if(yf(i)){var o=i,a=void 0,s=void 0,l=void 0;if(r){var u=n[0];u.prepareSource(),a=(l=u.getSource()).data,s=l.sourceFormat,e=[u._getVersionSign()]}else s=q(a=o.get("data",!0))?hp:sp,e=[];var c=this._getSourceMetaRawOption()||{},h=l&&l.metaRawOption||{},p=et(c.seriesLayoutBy,h.seriesLayoutBy)||null,d=et(c.sourceHeader,h.sourceHeader)||null,f=et(c.dimensions,h.dimensions);t=p!==h.seriesLayoutBy||!!d!=!!h.sourceHeader||f?[vd(a,{seriesLayoutBy:p,sourceHeader:d,dimensions:f},s)]:[]}else{var m=i;if(r){var g=this._applyTransform(n);t=g.sourceList,e=g.upstreamSignList}else t=[vd(m.get("source",!0),this._getSourceMetaRawOption(),null)],e=[]}this._setLocalSource(t,e)},t.prototype._applyTransform=function(t){var e,i=this._sourceHost,n=i.get("transform",!0),r=i.get("fromTransformResult",!0);if(null!=r){var o="";1!==t.length&&vf(o)}var a,s=[],l=[];return L(t,function(t){t.prepareSource();var e=t.getSource(r||0),i;null==r||e||vf(""),s.push(e),l.push(t._getVersionSign())}),n?e=function(t,e,i){var n=wr(t),r=n.length,o;r||_r("");for(var a=0,s=r;a<s;a++)e=nf(n[a],e),a!==s-1&&(e.length=Math.max(e.length,1));return e}(n,s,i.componentIndex):null!=r&&(e=[(a=s[0],new gd({data:a.data,sourceFormat:a.sourceFormat,seriesLayoutBy:a.seriesLayoutBy,dimensionsDefine:S(a.dimensionsDefine),startIndex:a.startIndex,dimensionsDetectedCount:a.dimensionsDetectedCount}))]),{sourceList:e,upstreamSignList:l}},t.prototype._isDirty=function(){if(this._dirty)return!0;for(var t=this._getUpstreamSourceManagers(),e=0;e<t.length;e++){var i=t[e];if(i._isDirty()||this._upstreamSignList[e]!==i._getVersionSign())return!0}},t.prototype.getSource=function(t){t=t||0;var e=this._sourceList[t];if(!e){var i=this._getUpstreamSourceManagers();return i[0]&&i[0].getSource(t)}return e},t.prototype.getSharedDataStore=function(t){var e=t.makeStoreSchema();return this._innerGetDataStore(e.dimensions,t.source,e.hash)},t.prototype._innerGetDataStore=function(t,e,i){var n=this._storeList,r=n[0];r||(r=n[0]={});var o=r[i];if(!o){var a=this._getUpstreamSourceManagers()[0];yf(this._sourceHost)&&a?o=a._innerGetDataStore(t,e,i):(o=new ff).initData(new Td(e,t.length),t),r[i]=o}return o},t.prototype._getUpstreamSourceManagers=function(){var t=this._sourceHost;if(yf(t)){var e=bp(t);return e?[e.getSourceManager()]:[]}return z(function(t){return t.get("transform",!0)||t.get("fromTransformResult",!0)?Vr(t.ecModel,"dataset",{index:t.get("fromDatasetIndex",!0),id:t.get("fromDatasetId",!0)},Nr).models:[]}(t),function(t){return t.getSourceManager()})},t.prototype._getSourceMetaRawOption=function(){var t,e,i,n=this._sourceHost;if(yf(n))t=n.get("seriesLayoutBy",!0),e=n.get("sourceHeader",!0),i=n.get("dimensions",!0);else if(!this._getUpstreamSourceManagers().length){var r=n;t=r.get("seriesLayoutBy",!0),e=r.get("sourceHeader",!0),i=r.get("dimensions",!0)}return{seriesLayoutBy:t,sourceHeader:e,dimensions:i}},t}();function gf(t){t.option.transform&&lt(t.option.transform)}function yf(t){return"series"===t.mainType}function vf(t){throw Error(t)}function _f(t,e){var i=t.color||"#6e7079",n=t.fontSize||12,r=t.fontWeight||"400",o=t.color||"#464646",a=t.fontSize||14,s=t.fontWeight||"900";return"html"===e?{nameStyle:"font-size:"+Rh(n+"")+"px;color:"+Rh(i)+";font-weight:"+Rh(r+""),valueStyle:"font-size:"+Rh(a+"")+"px;color:"+Rh(o)+";font-weight:"+Rh(s+"")}:{nameStyle:{fontSize:n,fill:i,fontWeight:r},valueStyle:{fontSize:a,fill:o,fontWeight:s}}}var xf=[0,10,20,30],bf=["","\n","\n\n","\n\n\n"];function wf(t,e){return e.type=t,e}function Sf(t){return ft(Tf,t.type)&&Tf[t.type]}var Tf={section:{planLayout:function(t){var e=t.blocks.length,i=e>1||e>0&&!t.noHeader,n=0;L(t.blocks,function(t){Sf(t).planLayout(t);var e=t.__gapLevelBetweenSubBlocks;e>=n&&(n=e+(!i||e&&("section"!==t.type||t.noHeader)?0:1))}),t.__gapLevelBetweenSubBlocks=n},build:function(t,e,i,n){var r=e.noHeader,o=If(e),a=function(t,e,i,n){var r=[],o=e.blocks||[];ot(!o||U(o)),o=o||[];var a=t.orderMode;if(e.sortBlocks&&a){o=o.slice();var s={valueAsc:"asc",valueDesc:"desc"};if(ft(s,a)){var l=new Zd(s[a],null);o.sort(function(t,e){return l.evaluate(t.sortParam,e.sortParam)})}else"seriesDesc"===a&&o.reverse()}var u=If(e);if(L(o,function(e,i){var o=Sf(e).build(t,e,i>0?u.html:0,n);null!=o&&r.push(o)}),r.length)return"richText"===t.renderMode?r.join(u.richText):Cf(r.join(""),i)}(t,e,r?i:o.html,n);if(r)return a;var s=Bh(e.header,"ordinal",t.useUTC),l=_f(n,t.renderMode).nameStyle;return"richText"===t.renderMode?Af(t,s,l)+o.richText+a:Cf('<div style="'+l+';line-height:1;">'+Rh(s)+"</div>"+a,i)}},nameValue:{planLayout:function(t){t.__gapLevelBetweenSubBlocks=0},build:function(t,e,i,n){var r=t.renderMode,o=e.noName,a=e.noValue,s=!e.markerType,l=e.name,u=e.value,c=t.useUTC;if(!o||!a){var h=s?"":t.markupStyleCreator.makeTooltipMarker(e.markerType,e.markerColor||"#333",r),p=o?"":Bh(l,"ordinal",c),d=e.valueType,f=a?[]:U(u)?z(u,function(t,e){return Bh(t,U(d)?d[e]:d,c)}):[Bh(u,U(d)?d[0]:d,c)],m=!s||!o,g=!s&&o,y=_f(n,r),v=y.nameStyle,_=y.valueStyle;return"richText"===r?(s?"":h)+(o?"":Af(t,p,v))+(a?"":function(t,e,i,n,r){var o=[r],a=n?10:20;return i&&o.push({padding:[0,0,0,a],align:"right"}),t.markupStyleCreator.wrapRichTextStyle(e.join("  "),o)}(t,f,m,g,_)):Cf((s?"":h)+(o?"":function(t,e,i){return'<span style="'+i+";"+(e?"margin-left:2px":"")+'">'+Rh(t)+"</span>"}(p,!s,v))+(a?"":function(t,e,i,n){var r;return'<span style="'+(e?"float:right;margin-left:"+(i?"10px":"20px"):"")+";"+n+'">'+z(t,function(t){return Rh(t)}).join("&nbsp;&nbsp;")+"</span>"}(f,m,g,_)),i)}}}};function Mf(t,e,i,n,r,o){if(t){var a=Sf(t);a.planLayout(t);var s={useUTC:r,renderMode:i,orderMode:n,markupStyleCreator:e};return a.build(s,t,0,o)}}function If(t){var e=t.__gapLevelBetweenSubBlocks;return{html:xf[e],richText:bf[e]}}function Cf(t,e){return'<div style="margin: '+e+'px 0 0;line-height:1;">'+t+'<div style="clear:both"></div></div>'}function Af(t,e,i){return t.markupStyleCreator.wrapRichTextStyle(e,i)}function kf(t,e){return Gh(t.getData().getItemVisual(e,"style")[t.visualDrawType])}function Df(t,e){var i=t.get("padding");return null!=i?i:"richText"===e?[8,10]:10}var Ef=function(){function t(){this.richTextStyles={},this._nextStyleNameId=mr()}return t.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},t.prototype.makeTooltipMarker=function(t,e,i){var n="richText"===i?this._generateStyleName():null,r=Uh({color:e,type:t,renderMode:i,markerId:n});return $(r)?r:(this.richTextStyles[n]=r.style,r.content)},t.prototype.wrapRichTextStyle=function(t,e){var i={};U(e)?L(e,function(t){return I(i,t)}):I(i,e);var n=this._generateStyleName();return this.richTextStyles[n]=i,"{"+n+"|"+t+"}"},t}();function Pf(t){var e,i,n,r,o=t.series,a=t.dataIndex,s=t.multipleSeries,l=o.getData(),u=l.mapDimensionsAll("defaultedTooltip"),c=u.length,h=o.getRawValue(a),p=U(h),d=kf(o,a);if(c>1||p&&!c){var f=function(t,e,i,n,r){var o=e.getData(),a=O(t,function(t,e,i){var n=o.getDimensionInfo(i);return t||n&&!1!==n.tooltip&&null!=n.displayName},!1),s=[],l=[],u=[];function c(t,e){var i=o.getDimensionInfo(e);i&&!1!==i.otherDims.tooltip&&(a?u.push(wf("nameValue",{markerType:"subItem",markerColor:r,name:i.displayName,value:t,valueType:i.type})):(s.push(t),l.push(i.type)))}return n.length?L(n,function(t){c(Od(o,i,t),t)}):L(t,c),{inlineValues:s,inlineValueTypes:l,blocks:u}}(h,o,a,u,d);e=f.inlineValues,i=f.inlineValueTypes,n=f.blocks,r=f.inlineValues[0]}else if(c){var m=l.getDimensionInfo(u[0]);r=e=Od(l,a,u[0]),i=m.type}else r=e=p?h[0]:h;var g=Er(o),y=g&&o.name||"",v=l.getName(a),_=s?y:v;return wf("section",{header:y,noHeader:s||!g,sortParam:r,blocks:[wf("nameValue",{markerType:"item",markerColor:d,name:_,noName:!at(_),value:e,valueType:i})].concat(n||[])})}var Lf=zr();function zf(t,e){return t.getName(e)||t.getId(e)}var Of=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._selectedDataIndicesMap={},e}return i(e,t),e.prototype.init=function(t,e,i){this.seriesIndex=this.componentIndex,this.dataTask=Fd({count:Bf,reset:Nf}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(t,i),(Lf(this).sourceManager=new mf(this)).prepareSource();var n=this.getInitialData(t,i);Vf(n,this),this.dataTask.context.data=n,Lf(this).dataBeforeProcessed=n,Rf(this),this._initSelectedMapFromData(n)},e.prototype.mergeDefaultAndTheme=function(t,e){var i=Kh(this),n=i?Qh(t):{},r=this.subType;ip.hasClass(r)&&(r+="Series"),T(t,e.getTheme().get(this.subType)),T(t,this.getDefaultOption()),Sr(t,"label",["show"]),this.fillDataTextStyle(t.data),i&&Jh(t,n,i)},e.prototype.mergeOption=function(t,e){t=T(this.option,t,!0),this.fillDataTextStyle(t.data);var i=Kh(this);i&&Jh(this.option,t,i);var n=Lf(this).sourceManager;n.dirty(),n.prepareSource();var r=this.getInitialData(t,e);Vf(r,this),this.dataTask.dirty(),this.dataTask.context.data=r,Lf(this).dataBeforeProcessed=r,Rf(this),this._initSelectedMapFromData(r)},e.prototype.fillDataTextStyle=function(t){if(t&&!q(t))for(var e=["show"],i=0;i<t.length;i++)t[i]&&t[i].label&&Sr(t[i],"label",e)},e.prototype.getInitialData=function(t,e){},e.prototype.appendData=function(t){this.getRawData().appendData(t.data)},e.prototype.getData=function(t){var e=Gf(this);if(e){var i=e.context.data;return null==t?i:i.getLinkedData(t)}return Lf(this).data},e.prototype.getAllData=function(){var t=this.getData();return t&&t.getLinkedDataAll?t.getLinkedDataAll():[{data:t}]},e.prototype.setData=function(t){var e=Gf(this);if(e){var i=e.context;i.outputData=t,e!==this.dataTask&&(i.data=t)}Lf(this).data=t},e.prototype.getEncode=function(){var t=this.get("encode",!0);if(t)return ht(t)},e.prototype.getSourceManager=function(){return Lf(this).sourceManager},e.prototype.getSource=function(){return this.getSourceManager().getSource()},e.prototype.getRawData=function(){return Lf(this).dataBeforeProcessed},e.prototype.getColorBy=function(){return this.get("colorBy")||"series"},e.prototype.isColorBySeries=function(){return"series"===this.getColorBy()},e.prototype.getBaseAxis=function(){var t=this.coordinateSystem;return t&&t.getBaseAxis&&t.getBaseAxis()},e.prototype.formatTooltip=function(t,e,i){return Pf({series:this,dataIndex:t,multipleSeries:e})},e.prototype.isAnimationEnabled=function(){if(a.node)return!1;var t=this.getShallow("animation");return t&&this.getData().count()>this.getShallow("animationThreshold")&&(t=!1),!!t},e.prototype.restoreData=function(){this.dataTask.dirty()},e.prototype.getColorFromPalette=function(t,e,i){var n=this.ecModel,r=Dp.prototype.getColorFromPalette.call(this,t,e,i);return r||(r=n.getColorFromPalette(t,e,i)),r},e.prototype.coordDimToDataDim=function(t){return this.getRawData().mapDimensionsAll(t)},e.prototype.getProgressive=function(){return this.get("progressive")},e.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},e.prototype.select=function(t,e){this._innerSelect(this.getData(e),t)},e.prototype.unselect=function(t,e){var i=this.option.selectedMap;if(i)for(var n=this.getData(e),r=0;r<t.length;r++){var o=zf(n,t[r]);i[o]=!1,this._selectedDataIndicesMap[o]=-1}},e.prototype.toggleSelect=function(t,e){for(var i=[],n=0;n<t.length;n++)i[0]=t[n],this.isSelected(t[n],e)?this.unselect(i,e):this.select(i,e)},e.prototype.getSelectedDataIndices=function(){for(var t=this._selectedDataIndicesMap,e=N(t),i=[],n=0;n<e.length;n++){var r=t[e[n]];r>=0&&i.push(r)}return i},e.prototype.isSelected=function(t,e){var i=this.option.selectedMap;return i&&i[zf(this.getData(e),t)]||!1},e.prototype.isUniversalTransitionEnabled=function(){if(this.__universalTransitionEnabled)return!0;var t=this.option.universalTransition;return!!t&&(!0===t||t&&t.enabled)},e.prototype._innerSelect=function(t,e){var i,n,r=this.option.selectedMode,o=e.length;if(r&&o)if("multiple"===r)for(var a=this.option.selectedMap||(this.option.selectedMap={}),s=0;s<o;s++){var l=e[s];a[c=zf(t,l)]=!0,this._selectedDataIndicesMap[c]=t.getRawIndex(l)}else if("single"===r||!0===r){var u=e[o-1],c=zf(t,u);this.option.selectedMap=((i={})[c]=!0,i),this._selectedDataIndicesMap=((n={})[c]=t.getRawIndex(u),n)}},e.prototype._initSelectedMapFromData=function(t){if(!this.option.selectedMap){var e=[];t.hasItemOption&&t.each(function(i){var n=t.getRawDataItem(i);n&&n.selected&&e.push(i)}),e.length>0&&this._innerSelect(t,e)}},e.registerClass=function(t){return ip.registerClass(t)},e.protoInitialize=function(){var t=e.prototype;t.type="series.__base__",t.seriesIndex=0,t.ignoreStyleOnData=!1,t.hasSymbolVisual=!1,t.defaultSymbol="circle",t.visualStyleAccessPath="itemStyle",t.visualDrawType="fill"}(),e}(ip);function Rf(t){var e=t.name;Er(t)||(t.name=function(t){var e=t.getRawData(),i=e.mapDimensionsAll("seriesName"),n=[];return L(i,function(t){var i=e.getDimensionInfo(t);i.displayName&&n.push(i.displayName)}),n.join(" ")}(t)||e)}function Bf(t){return t.model.getRawData().count()}function Nf(t){var e=t.model;return e.setData(e.getRawData().cloneShallow()),Ff}function Ff(t,e){e.outputData&&t.end>e.outputData.count()&&e.model.getRawData().cloneShallow(e.outputData)}function Vf(t,e){L(pt(t.CHANGABLE_METHODS,t.DOWNSAMPLE_METHODS),function(i){t.wrapMethod(i,V(Uf,e))})}function Uf(t,e){var i=Gf(t);return i&&i.setOutputEnd((e||this).count()),e}function Gf(t){var e=(t.ecModel||{}).scheduler,i=e&&e.getPipeline(t.uid);if(i){var n=i.currentTask;if(n){var r=n.agentStubMap;r&&(n=r.get(t.uid))}return n}}E(Of,Bd),E(Of,Dp),Xr(Of,ip);var $f=function(){function t(){this.group=new Fn,this.uid=Hc("viewComponent")}return t.prototype.init=function(t,e){},t.prototype.render=function(t,e,i,n){},t.prototype.dispose=function(t,e){},t.prototype.updateView=function(t,e,i,n){},t.prototype.updateLayout=function(t,e,i,n){},t.prototype.updateVisual=function(t,e,i,n){},t.prototype.blurSeries=function(t,e){},t}();function Wf(){var t=zr();return function(e){var i=t(e),n=e.pipelineContext,r=!!i.large,o=!!i.progressiveRender,a=i.large=!(!n||!n.large),s=i.progressiveRender=!(!n||!n.progressiveRender);return!(r===a&&o===s)&&"reset"}}Zr($f),Qr($f);var Hf=zr(),jf=Wf(),Zf=function(){function t(){this.group=new Fn,this.uid=Hc("viewChart"),this.renderTask=Fd({plan:Yf,reset:Kf}),this.renderTask.context={view:this}}return t.prototype.init=function(t,e){},t.prototype.render=function(t,e,i,n){},t.prototype.highlight=function(t,e,i,n){Xf(t.getData(),n,"emphasis")},t.prototype.downplay=function(t,e,i,n){Xf(t.getData(),n,"normal")},t.prototype.remove=function(t,e){this.group.removeAll()},t.prototype.dispose=function(t,e){},t.prototype.updateView=function(t,e,i,n){this.render(t,e,i,n)},t.prototype.updateLayout=function(t,e,i,n){this.render(t,e,i,n)},t.prototype.updateVisual=function(t,e,i,n){this.render(t,e,i,n)},t.markUpdateMethod=function(t,e){Hf(t).updateMethod=e},t.protoInitialize=void(t.prototype.type="chart"),t}();function qf(t,e,i){t&&("emphasis"===e?Qs:tl)(t,i)}function Xf(t,e,i){var n=Lr(t,e),r=e&&null!=e.highlightKey?function(t){var e=Is[t];return null==e&&Ms<=32&&(e=Is[t]=Ms++),e}(e.highlightKey):null;null!=n?L(wr(n),function(e){qf(t.getItemGraphicEl(e),i,r)}):t.eachItemGraphicEl(function(t){qf(t,i,r)})}function Yf(t){return jf(t.model)}function Kf(t){var e=t.model,i=t.ecModel,n=t.api,r=t.payload,o=e.pipelineContext.progressiveRender,a=t.view,s=r&&Hf(r).updateMethod,l=o?"incrementalPrepareRender":s&&a[s]?s:"render";return"render"!==l&&a[l](e,i,n,r),Jf[l]}Zr(Zf),Qr(Zf);var Jf={incrementalPrepareRender:{progress:function(t,e){e.view.incrementalRender(t,e.model,e.ecModel,e.api,e.payload)}},render:{forceFirstProgress:!0,progress:function(t,e){e.view.render(e.model,e.ecModel,e.api,e.payload)}}},Qf="\0__throttleOriginMethod",tm="\0__throttleRate",em="\0__throttleType";function im(t,e,i){var n,r,o,a,s,l=0,u=0,c=null;function h(){u=(new Date).getTime(),c=null,t.apply(o,a||[])}e=e||0;var p=function(){for(var t=[],p=0;p<arguments.length;p++)t[p]=arguments[p];n=(new Date).getTime(),o=this,a=t;var d=s||e,f=s||i;s=null,r=n-(f?l:u)-d,clearTimeout(c),f?c=setTimeout(h,d):r>=0?h():c=setTimeout(h,-r),l=n};return p.clear=function(){c&&(clearTimeout(c),c=null)},p.debounceNextCall=function(t){s=t},p}function nm(t,e,i,n){var r=t[e];if(r){var o=r[Qf]||r,a=r[em];if(r[tm]!==i||a!==n){if(null==i||!n)return t[e]=o;(r=t[e]=im(o,i,"debounce"===n))[Qf]=o,r[em]=n,r[tm]=i}return r}}var rm=zr(),om={itemStyle:to(Vc,!0),lineStyle:to(Bc,!0)},am={lineStyle:"stroke",itemStyle:"fill"};function sm(t,e){var i;return t.visualStyleMapper||om[e]||(console.warn("Unkown style type '"+e+"'."),om.itemStyle)}function lm(t,e){var i;return t.visualDrawType||am[e]||(console.warn("Unkown style type '"+e+"'."),"fill")}var um={createOnAllSeries:!0,performRawSeries:!0,reset:function(t,e){var i=t.getData(),n=t.visualStyleAccessPath||"itemStyle",r=t.getModel(n),o=sm(t,n)(r),a=r.getShallow("decal");a&&(i.setVisual("decal",a),a.dirty=!0);var s=lm(t,n),l=o[s],u=G(l)?l:null,c="auto"===o.fill||"auto"===o.stroke;if(!o[s]||u||c){var h=t.getColorFromPalette(t.name,null,e.getSeriesCount());o[s]||(o[s]=h,i.setVisual("colorFromPalette",!0)),o.fill="auto"===o.fill||"function"==typeof o.fill?h:o.fill,o.stroke="auto"===o.stroke||"function"==typeof o.stroke?h:o.stroke}if(i.setVisual("style",o),i.setVisual("drawType",s),!e.isSeriesFiltered(t)&&u)return i.setVisual("colorFromPalette",!1),{dataEach:function(e,i){var n=t.getDataParams(i),r=I({},o);r[s]=u(n),e.setItemVisual(i,"style",r)}}}},cm=new $c,hm={createOnAllSeries:!0,performRawSeries:!0,reset:function(t,e){if(!t.ignoreStyleOnData&&!e.isSeriesFiltered(t)){var i=t.getData(),n=t.visualStyleAccessPath||"itemStyle",r=sm(t,n),o=i.getVisual("drawType");return{dataEach:i.hasItemOption?function(t,e){var i=t.getRawDataItem(e);if(i&&i[n]){cm.option=i[n];var a=r(cm);I(t.ensureUniqueItemVisual(e,"style"),a),cm.option.decal&&(t.setItemVisual(e,"decal",cm.option.decal),cm.option.decal.dirty=!0),o in a&&t.setItemVisual(e,"colorFromPalette",!1)}}:null}}}},pm={performRawSeries:!0,overallReset:function(t){var e=ht();t.eachSeries(function(t){var i=t.getColorBy();if(!t.isColorBySeries()){var n=t.type+"-"+i,r=e.get(n);r||(r={},e.set(n,r)),rm(t).scope=r}}),t.eachSeries(function(e){if(!e.isColorBySeries()&&!t.isSeriesFiltered(e)){var i=e.getRawData(),n={},r=e.getData(),o=rm(e).scope,a=e.visualStyleAccessPath||"itemStyle",s=lm(e,a);r.each(function(t){var e=r.getRawIndex(t);n[e]=t}),i.each(function(t){var a=n[t];if(r.getItemVisual(a,"colorFromPalette")){var l=r.ensureUniqueItemVisual(a,"style"),u=i.getName(t)||t+"",c=i.count();l[s]=e.getColorFromPalette(u,o,c)}})}})}},dm=Math.PI,fm=function(){function t(t,e,i,n){this._stageTaskMap=ht(),this.ecInstance=t,this.api=e,i=this._dataProcessorHandlers=i.slice(),n=this._visualHandlers=n.slice(),this._allHandlers=i.concat(n)}return t.prototype.restoreData=function(t,e){t.restoreData(e),this._stageTaskMap.each(function(t){var e=t.overallTask;e&&e.dirty()})},t.prototype.getPerformArgs=function(t,e){if(t.__pipeline){var i=this._pipelineMap.get(t.__pipeline.id),n=i.context,r=!e&&i.progressiveEnabled&&(!n||n.progressiveRender)&&t.__idxInPipeline>i.blockIndex?i.step:null,o=n&&n.modDataCount;return{step:r,modBy:null!=o?Math.ceil(o/r):null,modDataCount:o}}},t.prototype.getPipeline=function(t){return this._pipelineMap.get(t)},t.prototype.updateStreamModes=function(t,e){var i=this._pipelineMap.get(t.uid),n=t.getData().count(),r=i.progressiveEnabled&&e.incrementalPrepareRender&&n>=i.threshold,o=t.get("large")&&n>=t.get("largeThreshold"),a="mod"===t.get("progressiveChunkMode")?n:null;t.pipelineContext=i.context={progressiveRender:r,modDataCount:a,large:o}},t.prototype.restorePipelines=function(t){var e=this,i=e._pipelineMap=ht();t.eachSeries(function(t){var n=t.getProgressive(),r=t.uid;i.set(r,{id:r,head:null,tail:null,threshold:t.getProgressiveThreshold(),progressiveEnabled:n&&!(t.preventIncremental&&t.preventIncremental()),blockIndex:-1,step:Math.round(n||700),count:0}),e._pipe(t,t.dataTask)})},t.prototype.prepareStageTasks=function(){var t=this._stageTaskMap,e=this.api.getModel(),i=this.api;L(this._allHandlers,function(n){var r=t.get(n.uid)||t.set(n.uid,{}),o="";ot(!(n.reset&&n.overallReset),o),n.reset&&this._createSeriesStageTask(n,r,e,i),n.overallReset&&this._createOverallStageTask(n,r,e,i)},this)},t.prototype.prepareView=function(t,e,i,n){var r=t.renderTask,o=r.context;o.model=e,o.ecModel=i,o.api=n,r.__block=!t.incrementalPrepareRender,this._pipe(e,r)},t.prototype.performDataProcessorTasks=function(t,e){this._performStageTasks(this._dataProcessorHandlers,t,e,{block:!0})},t.prototype.performVisualTasks=function(t,e,i){this._performStageTasks(this._visualHandlers,t,e,i)},t.prototype._performStageTasks=function(t,e,i,n){n=n||{};var r=!1,o=this;function a(t,e){return t.setDirty&&(!t.dirtyMap||t.dirtyMap.get(e.__pipeline.id))}L(t,function(t,s){if(!n.visualType||n.visualType===t.visualType){var l=o._stageTaskMap.get(t.uid),u=l.seriesTaskMap,c=l.overallTask;if(c){var h,p=c.agentStubMap;p.each(function(t){a(n,t)&&(t.dirty(),h=!0)}),h&&c.dirty(),o.updatePayload(c,i);var d=o.getPerformArgs(c,n.block);p.each(function(t){t.perform(d)}),c.perform(d)&&(r=!0)}else u&&u.each(function(s,l){a(n,s)&&s.dirty();var u=o.getPerformArgs(s,n.block);u.skip=!t.performRawSeries&&e.isSeriesFiltered(s.context.model),o.updatePayload(s,i),s.perform(u)&&(r=!0)})}}),this.unfinished=r||this.unfinished},t.prototype.performSeriesTasks=function(t){var e;t.eachSeries(function(t){e=t.dataTask.perform()||e}),this.unfinished=e||this.unfinished},t.prototype.plan=function(){this._pipelineMap.each(function(t){var e=t.tail;do{if(e.__block){t.blockIndex=e.__idxInPipeline;break}e=e.getUpstream()}while(e)})},t.prototype.updatePayload=function(t,e){"remain"!==e&&(t.context.payload=e)},t.prototype._createSeriesStageTask=function(t,e,i,n){var r=this,o=e.seriesTaskMap,a=e.seriesTaskMap=ht(),s=t.seriesType,l=t.getTargetSeries;function u(e){var s=e.uid,l=a.set(s,o&&o.get(s)||Fd({plan:_m,reset:xm,count:Sm}));l.context={model:e,ecModel:i,api:n,useClearVisual:t.isVisual&&!t.isLayout,plan:t.plan,reset:t.reset,scheduler:r},r._pipe(e,l)}t.createOnAllSeries?i.eachRawSeries(u):s?i.eachRawSeriesByType(s,u):l&&l(i,n).each(u)},t.prototype._createOverallStageTask=function(t,e,i,n){var r=this,o=e.overallTask=e.overallTask||Fd({reset:mm});o.context={ecModel:i,api:n,overallReset:t.overallReset,scheduler:r};var a=o.agentStubMap,s=o.agentStubMap=ht(),l=t.seriesType,u=t.getTargetSeries,c=!0,h=!1,p="";function d(t){var e=t.uid,i=s.set(e,a&&a.get(e)||(h=!0,Fd({reset:gm,onDirty:vm})));i.context={model:t,overallProgress:c},i.agent=o,i.__block=c,r._pipe(t,i)}ot(!t.createOnAllSeries,p),l?i.eachRawSeriesByType(l,d):u?u(i,n).each(d):(c=!1,L(i.getSeries(),d)),h&&o.dirty()},t.prototype._pipe=function(t,e){var i=t.uid,n=this._pipelineMap.get(i);!n.head&&(n.head=e),n.tail&&n.tail.pipe(e),n.tail=e,e.__idxInPipeline=n.count++,e.__pipeline=n},t.wrapStageHandler=function(t,e){return G(t)&&(t={overallReset:t,seriesType:Tm(t)}),t.uid=Hc("stageHandler"),e&&(t.visualType=e),t},t}();function mm(t){t.overallReset(t.ecModel,t.api,t.payload)}function gm(t){return t.overallProgress&&ym}function ym(){this.agent.dirty(),this.getDownstream().dirty()}function vm(){this.agent&&this.agent.dirty()}function _m(t){return t.plan?t.plan(t.model,t.ecModel,t.api,t.payload):null}function xm(t){t.useClearVisual&&t.data.clearAllVisual();var e=t.resetDefines=wr(t.reset(t.model,t.ecModel,t.api,t.payload));return e.length>1?z(e,function(t,e){return wm(e)}):bm}var bm=wm(0);function wm(t){return function(e,i){var n=i.data,r=i.resetDefines[t];if(r&&r.dataEach)for(var o=e.start;o<e.end;o++)r.dataEach(n,o);else r&&r.progress&&r.progress(e,n)}}function Sm(t){return t.data.count()}function Tm(t){Mm=null;try{t(Im,Cm)}catch(t){}return Mm}var Mm,Im={},Cm={};function Am(t,e){for(var i in e.prototype)t[i]=mt}Am(Im,Lp),Am(Cm,Np),Im.eachSeriesByType=Im.eachRawSeriesByType=function(t){Mm=t},Im.eachComponent=function(t){"series"===t.mainType&&t.subType&&(Mm=t.subType)};var km=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"],Dm={color:km,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],km]},Em="#B9B8CE",Pm="#100C2A",Lm=function(){return{axisLine:{lineStyle:{color:Em}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}}},zm=["#4992ff","#7cffb2","#fddd60","#ff6e76","#58d9f9","#05c091","#ff8a45","#8d48e3","#dd79ff"],Om={darkMode:!0,color:zm,backgroundColor:Pm,axisPointer:{lineStyle:{color:"#817f91"},crossStyle:{color:"#817f91"},label:{color:"#fff"}},legend:{textStyle:{color:Em}},textStyle:{color:Em},title:{textStyle:{color:"#EEF1FA"},subtextStyle:{color:"#B9B8CE"}},toolbox:{iconStyle:{borderColor:Em}},dataZoom:{borderColor:"#71708A",textStyle:{color:Em},brushStyle:{color:"rgba(135,163,206,0.3)"},handleStyle:{color:"#353450",borderColor:"#C5CBE3"},moveHandleStyle:{color:"#B0B6C3",opacity:.3},fillerColor:"rgba(135,163,206,0.2)",emphasis:{handleStyle:{borderColor:"#91B7F2",color:"#4D587D"},moveHandleStyle:{color:"#636D9A",opacity:.7}},dataBackground:{lineStyle:{color:"#71708A",width:1},areaStyle:{color:"#71708A"}},selectedDataBackground:{lineStyle:{color:"#87A3CE"},areaStyle:{color:"#87A3CE"}}},visualMap:{textStyle:{color:Em}},timeline:{lineStyle:{color:Em},label:{color:Em},controlStyle:{color:Em,borderColor:Em}},calendar:{itemStyle:{color:Pm},dayLabel:{color:Em},monthLabel:{color:Em},yearLabel:{color:Em}},timeAxis:Lm(),logAxis:Lm(),valueAxis:Lm(),categoryAxis:Lm(),line:{symbol:"circle"},graph:{color:zm},gauge:{title:{color:Em},axisLine:{lineStyle:{color:[[1,"rgba(207,212,219,0.2)"]]}},axisLabel:{color:Em},detail:{color:"#EEF1FA"}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}}};Om.categoryAxis.splitLine.show=!1;var Rm=function(){function t(){}return t.prototype.normalizeQuery=function(t){var e={},i={},n={};if($(t)){var r=jr(t);e.mainType=r.main||null,e.subType=r.sub||null}else{var o=["Index","Name","Id"],a={name:1,dataIndex:1,dataType:1};L(t,function(t,r){for(var s=!1,l=0;l<o.length;l++){var u=o[l],c=r.lastIndexOf(u);if(c>0&&c===r.length-u.length){var h=r.slice(0,c);"data"!==h&&(e.mainType=h,e[u.toLowerCase()]=t,s=!0)}}a.hasOwnProperty(r)&&(i[r]=t,s=!0),s||(n[r]=t)})}return{cptQuery:e,dataQuery:i,otherQuery:n}},t.prototype.filter=function(t,e){var i=this.eventInfo;if(!i)return!0;var n=i.targetEl,r=i.packedEvent,o=i.model,a=i.view;if(!o||!a)return!0;var s=e.cptQuery,l=e.dataQuery;return u(s,o,"mainType")&&u(s,o,"subType")&&u(s,o,"index","componentIndex")&&u(s,o,"name")&&u(s,o,"id")&&u(l,r,"name")&&u(l,r,"dataIndex")&&u(l,r,"dataType")&&(!a.filterForExposedEvent||a.filterForExposedEvent(t,e.otherQuery,n,r));function u(t,e,i,n){return null==t[i]||e[n||i]===t[i]}},t.prototype.afterTrigger=function(){this.eventInfo=null},t}(),Bm={createOnAllSeries:!0,performRawSeries:!0,reset:function(t,e){var i=t.getData();if(t.legendIcon&&i.setVisual("legendIcon",t.legendIcon),t.hasSymbolVisual){var n=t.get("symbol"),r=t.get("symbolSize"),o=t.get("symbolKeepAspect"),a=t.get("symbolRotate"),s=t.get("symbolOffset"),l=G(n),u=G(r),c=G(a),h=G(s),p=l||u||c||h,d=!l&&n?n:t.defaultSymbol,f=u?null:r,m=c?null:a,g=h?null:s;if(i.setVisual({legendIcon:t.legendIcon||d,symbol:d,symbolSize:f,symbolKeepAspect:o,symbolRotate:m,symbolOffset:g}),!e.isSeriesFiltered(t))return{dataEach:p?function(e,i){var o=t.getRawValue(i),p=t.getDataParams(i);l&&e.setItemVisual(i,"symbol",n(o,p)),u&&e.setItemVisual(i,"symbolSize",r(o,p)),c&&e.setItemVisual(i,"symbolRotate",a(o,p)),h&&e.setItemVisual(i,"symbolOffset",s(o,p))}:null}}}};function Nm(t,e,i){switch(i){case"color":return t.getItemVisual(e,"style")[t.getVisual("drawType")];case"opacity":return t.getItemVisual(e,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return t.getItemVisual(e,i)}}function Fm(t,e){switch(e){case"color":return t.getVisual("style")[t.getVisual("drawType")];case"opacity":return t.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return t.getVisual(e)}}function Vm(t,e,i,n){switch(i){case"color":t.ensureUniqueItemVisual(e,"style")[t.getVisual("drawType")]=n,t.setItemVisual(e,"colorFromPalette",!1);break;case"opacity":t.ensureUniqueItemVisual(e,"style").opacity=n;break;case"symbol":case"symbolSize":case"liftZ":t.setItemVisual(e,i,n)}}function Um(t,e){function i(e,i){var n=[];return e.eachComponent({mainType:"series",subType:t,query:i},function(t){n.push(t.seriesIndex)}),n}L([[t+"ToggleSelect","toggleSelect"],[t+"Select","select"],[t+"UnSelect","unselect"]],function(t){e(t[0],function(e,n,r){e=I({},e),r.dispatchAction(I(e,{type:t[1],seriesIndex:i(n,e)}))})})}function Gm(t,e,i,n,r){var o=t+e;i.isSilent(o)||n.eachComponent({mainType:"series",subType:"pie"},function(t){for(var e=t.seriesIndex,n=r.selected,a=0;a<n.length;a++)if(n[a].seriesIndex===e){var s=t.getData(),l=Lr(s,r.fromActionPayload);i.trigger(o,{type:o,seriesId:t.id,name:U(l)?s.getName(l[0]):s.getName(l),selected:I({},t.option.selectedMap)})}})}function $m(t,e,i){for(var n;t&&(!e(t)||(n=t,!i));)t=t.__hostTarget||t.parent;return n}var Wm=Math.round(9*Math.random()),Hm="function"==typeof Object.defineProperty,jm=function(){function t(){this._id="__ec_inner_"+Wm++}return t.prototype.get=function(t){return this._guard(t)[this._id]},t.prototype.set=function(t,e){var i=this._guard(t);return Hm?Object.defineProperty(i,this._id,{value:e,enumerable:!1,configurable:!0}):i[this._id]=e,this},t.prototype.delete=function(t){return!!this.has(t)&&(delete this._guard(t)[this._id],!0)},t.prototype.has=function(t){return!!this._guard(t)[this._id]},t.prototype._guard=function(t){if(t!==Object(t))throw TypeError("Value of WeakMap is not a non-null object.");return t},t}(),Zm=Qa.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var i=e.cx,n=e.cy,r=e.width/2,o=e.height/2;t.moveTo(i,n-o),t.lineTo(i+r,n+o),t.lineTo(i-r,n+o),t.closePath()}}),qm=Qa.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var i=e.cx,n=e.cy,r=e.width/2,o=e.height/2;t.moveTo(i,n-o),t.lineTo(i+r,n),t.lineTo(i,n+o),t.lineTo(i-r,n),t.closePath()}}),Xm=Qa.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,n=e.y,r=e.width/5*3,o=Math.max(r,e.height),a=r/2,s=a*a/(o-a),l=n-o+a+s,u=Math.asin(s/a),c=Math.cos(u)*a,h=Math.sin(u),p=Math.cos(u),d=.6*a,f=.7*a;t.moveTo(i-c,l+s),t.arc(i,l,a,Math.PI-u,2*Math.PI+u),t.bezierCurveTo(i+c-h*d,l+s+p*d,i,n-f,i,n),t.bezierCurveTo(i,n-f,i-c+h*d,l+s+p*d,i-c,l+s),t.closePath()}}),Ym=Qa.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.height,n=e.width,r=e.x,o=e.y,a=n/3*2;t.moveTo(r,o),t.lineTo(r+a,o+i),t.lineTo(r,o+i/4*3),t.lineTo(r-a,o+i),t.lineTo(r,o),t.closePath()}}),Km={line:function(t,e,i,n,r){r.x1=t,r.y1=e+n/2,r.x2=t+i,r.y2=e+n/2},rect:function(t,e,i,n,r){r.x=t,r.y=e,r.width=i,r.height=n},roundRect:function(t,e,i,n,r){r.x=t,r.y=e,r.width=i,r.height=n,r.r=Math.min(i,n)/4},square:function(t,e,i,n,r){var o=Math.min(i,n);r.x=t,r.y=e,r.width=o,r.height=o},circle:function(t,e,i,n,r){r.cx=t+i/2,r.cy=e+n/2,r.r=Math.min(i,n)/2},diamond:function(t,e,i,n,r){r.cx=t+i/2,r.cy=e+n/2,r.width=i,r.height=n},pin:function(t,e,i,n,r){r.x=t+i/2,r.y=e+n/2,r.width=i,r.height=n},arrow:function(t,e,i,n,r){r.x=t+i/2,r.y=e+n/2,r.width=i,r.height=n},triangle:function(t,e,i,n,r){r.cx=t+i/2,r.cy=e+n/2,r.width=i,r.height=n}},Jm={};L({line:gu,rect:hs,roundRect:hs,square:hs,circle:Gl,diamond:qm,pin:Xm,arrow:Ym,triangle:Zm},function(t,e){Jm[e]=new t});var Qm=Qa.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(t,e,i){var n=An(t,e,i),r=this.shape;return r&&"pin"===r.symbolType&&"inside"===e.position&&(n.y=i.y+.4*i.height),n},buildPath:function(t,e,i){var n=e.symbolType;if("none"!==n){var r=Jm[n];r||(r=Jm[n="rect"]),Km[n](e.x,e.y,e.width,e.height,r.shape),r.buildPath(t,r.shape,i)}}});function tg(t,e){if("image"!==this.type){var i=this.style;this.__isEmptyBrush?(i.stroke=t,i.fill=e||"#fff",i.lineWidth=2):"line"===this.shape.symbolType?i.stroke=t:i.fill=t,this.markRedraw()}}function eg(t,e,i,n,r,o,a){var s,l=0===t.indexOf("empty");return l&&(t=t.substr(5,1).toLowerCase()+t.substr(6)),(s=0===t.indexOf("image://")?Qu(t.slice(8),new yn(e,i,n,r),a?"center":"cover"):0===t.indexOf("path://")?Ju(t.slice(7),{},new yn(e,i,n,r),a?"center":"cover"):new Qm({shape:{symbolType:t,x:e,y:i,width:n,height:r}})).__isEmptyBrush=l,s.setColor=tg,o&&s.setColor(o),s}function ig(t){return U(t)||(t=[+t,+t]),[t[0]||0,t[1]||0]}function ng(t,e){if(null!=t)return U(t)||(t=[t,t]),[Xn(t[0],e[0])||0,Xn(et(t[1],t[0]),e[1])||0]}function rg(t,e,i){for(var n="radial"===e.type?function(t,e,i){var n=i.width,r=i.height,o=Math.min(n,r),a=null==e.x?.5:e.x,s=null==e.y?.5:e.y,l=null==e.r?.5:e.r;return e.global||(a=a*n+i.x,s=s*r+i.y,l*=o),t.createRadialGradient(a,s,0,a,s,l)}(t,e,i):function(t,e,i){var n=null==e.x?0:e.x,r=null==e.x2?1:e.x2,o=null==e.y?0:e.y,a=null==e.y2?0:e.y2;return e.global||(n=n*i.width+i.x,r=r*i.width+i.x,o=o*i.height+i.y,a=a*i.height+i.y),n=isNaN(n)?0:n,r=isNaN(r)?1:r,o=isNaN(o)?0:o,a=isNaN(a)?0:a,t.createLinearGradient(n,o,r,a)}(t,e,i),r=e.colorStops,o=0;o<r.length;o++)n.addColorStop(r[o].offset,r[o].color);return n}function og(t,e){if(t===e||!t&&!e)return!1;if(!t||!e||t.length!==e.length)return!0;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!0;return!1}function ag(t,e){return t&&"solid"!==t&&e>0?(e=e||1,"dashed"===t?[4*e,2*e]:"dotted"===t?[e]:H(t)?[t]:U(t)?t:null):null}var sg=new La(!0);function lg(t){var e=t.stroke;return!(null==e||"none"===e||!(t.lineWidth>0))}function ug(t){return"string"==typeof t&&"none"!==t}function cg(t){var e=t.fill;return null!=e&&"none"!==e}function hg(t,e){if(null!=e.fillOpacity&&1!==e.fillOpacity){var i=t.globalAlpha;t.globalAlpha=e.fillOpacity*e.opacity,t.fill(),t.globalAlpha=i}else t.fill()}function pg(t,e){if(null!=e.strokeOpacity&&1!==e.strokeOpacity){var i=t.globalAlpha;t.globalAlpha=e.strokeOpacity*e.opacity,t.stroke(),t.globalAlpha=i}else t.stroke()}function dg(t,e,i){var n=oo(e.image,e.__image,i);if(so(n)){var r=t.createPattern(n,e.repeat||"repeat");if("function"==typeof DOMMatrix&&r.setTransform){var o=new DOMMatrix;o.rotateSelf(0,0,(e.rotation||0)/Math.PI*180),o.scaleSelf(e.scaleX||1,e.scaleY||1),o.translateSelf(e.x||0,e.y||0),r.setTransform(o)}return r}}var fg=["shadowBlur","shadowOffsetX","shadowOffsetY"],mg=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function gg(t,e,i,n,r){var o=!1;if(!n&&e===(i=i||{}))return!1;if(n||e.opacity!==i.opacity){o||(_g(t,r),o=!0);var a=Math.max(Math.min(e.opacity,1),0);t.globalAlpha=isNaN(a)?wo.opacity:a}(n||e.blend!==i.blend)&&(o||(_g(t,r),o=!0),t.globalCompositeOperation=e.blend||wo.blend);for(var s=0;s<fg.length;s++){var l=fg[s];(n||e[l]!==i[l])&&(o||(_g(t,r),o=!0),t[l]=t.dpr*(e[l]||0))}return(n||e.shadowColor!==i.shadowColor)&&(o||(_g(t,r),o=!0),t.shadowColor=e.shadowColor||wo.shadowColor),o}function yg(t,e,i,n,r){var o=xg(e,r.inHover),a=n?null:i&&xg(i,r.inHover)||{};if(o===a)return!1;var s=gg(t,o,a,n,r);if((n||o.fill!==a.fill)&&(s||(_g(t,r),s=!0),ug(o.fill)&&(t.fillStyle=o.fill)),(n||o.stroke!==a.stroke)&&(s||(_g(t,r),s=!0),ug(o.stroke)&&(t.strokeStyle=o.stroke)),(n||o.opacity!==a.opacity)&&(s||(_g(t,r),s=!0),t.globalAlpha=null==o.opacity?1:o.opacity),e.hasStroke()){var l=o.lineWidth/(o.strokeNoScale&&e&&e.getLineScale?e.getLineScale():1);t.lineWidth!==l&&(s||(_g(t,r),s=!0),t.lineWidth=l)}for(var u=0;u<mg.length;u++){var c=mg[u],h=c[0];(n||o[h]!==a[h])&&(s||(_g(t,r),s=!0),t[h]=o[h]||c[1])}return s}function vg(t,e){var i=e.transform,n=t.dpr||1;i?t.setTransform(n*i[0],n*i[1],n*i[2],n*i[3],n*i[4],n*i[5]):t.setTransform(n,0,0,n,0,0)}function _g(t,e){e.batchFill&&t.fill(),e.batchStroke&&t.stroke(),e.batchFill="",e.batchStroke=""}function xg(t,e){return e&&t.__hoverStyle||t.style}function bg(t,e){wg(t,e,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function wg(t,e,i,n){var r=e.transform;if(!e.shouldBePainted(i.viewWidth,i.viewHeight,!1,!1))return e.__dirty&=-2,void(e.__isRendered=!1);var o=e.__clipPaths,a=i.prevElClipPaths,s=!1,l=!1;if(a&&!og(o,a)||(a&&a.length&&(_g(t,i),t.restore(),l=s=!0,i.prevElClipPaths=null,i.allClipped=!1,i.prevEl=null),o&&o.length&&(_g(t,i),t.save(),function(t,e,i){for(var n=!1,r=0;r<t.length;r++){var o=t[r];n=n||o.isZeroArea(),vg(e,o),e.beginPath(),o.buildPath(e,o.shape),e.clip()}i.allClipped=n}(o,t,i),s=!0),i.prevElClipPaths=o),i.allClipped)e.__isRendered=!1;else{e.beforeBrush&&e.beforeBrush(),e.innerBeforeBrush();var u=i.prevEl;u||(l=s=!0);var c,h,p=e instanceof Qa&&e.autoBatch&&function(t){var e=cg(t),i=lg(t);return!(t.lineDash||!(+e^+i)||e&&"string"!=typeof t.fill||i&&"string"!=typeof t.stroke||t.strokePercent<1||t.strokeOpacity<1||t.fillOpacity<1)}(e.style);s||(c=r,h=u.transform,c&&h?c[0]!==h[0]||c[1]!==h[1]||c[2]!==h[2]||c[3]!==h[3]||c[4]!==h[4]||c[5]!==h[5]:c||h)?(_g(t,i),vg(t,e)):p||_g(t,i);var d=xg(e,i.inHover);e instanceof Qa?(1!==i.lastDrawType&&(l=!0,i.lastDrawType=1),yg(t,e,u,l,i),p&&(i.batchFill||i.batchStroke)||t.beginPath(),function(t,e,i,n){var r=lg(i),o=cg(i),a=i.strokePercent,s=a<1,l=!e.path;e.silent&&!s||!l||e.createPathProxy();var u=e.path||sg;if(!n){var c=i.fill,h=i.stroke,p=o&&!!c.colorStops,d=r&&!!h.colorStops,f=o&&!!c.image,m=r&&!!h.image,g=void 0,y=void 0,v=void 0,_=void 0,x=void 0;(p||d)&&(x=e.getBoundingRect()),p&&(g=e.__dirty?rg(t,c,x):e.__canvasFillGradient,e.__canvasFillGradient=g),d&&(y=e.__dirty?rg(t,h,x):e.__canvasStrokeGradient,e.__canvasStrokeGradient=y),f&&(v=e.__dirty||!e.__canvasFillPattern?dg(t,c,e):e.__canvasFillPattern,e.__canvasFillPattern=v),m&&(_=e.__dirty||!e.__canvasStrokePattern?dg(t,h,e):e.__canvasStrokePattern,e.__canvasStrokePattern=v),p?t.fillStyle=g:f&&(v?t.fillStyle=v:o=!1),d?t.strokeStyle=y:m&&(_?t.strokeStyle=_:r=!1)}var b=i.lineDash&&i.lineWidth>0&&ag(i.lineDash,i.lineWidth),w=i.lineDashOffset,S=!!t.setLineDash,T=e.getGlobalScale();if(u.setScale(T[0],T[1],e.segmentIgnoreThreshold),b){var M=i.strokeNoScale&&e.getLineScale?e.getLineScale():1;M&&1!==M&&(b=z(b,function(t){return t/M}),w/=M)}var I=!0;(l||4&e.__dirty||b&&!S&&r)&&(u.setDPR(t.dpr),s?u.setContext(null):(u.setContext(t),I=!1),u.reset(),b&&!S&&(u.setLineDash(b),u.setLineDashOffset(w)),e.buildPath(u,e.shape,n),u.toStatic(),e.pathUpdated()),I&&u.rebuildPath(t,s?a:1),b&&S&&(t.setLineDash(b),t.lineDashOffset=w),n||(i.strokeFirst?(r&&pg(t,i),o&&hg(t,i)):(o&&hg(t,i),r&&pg(t,i))),b&&S&&t.setLineDash([])}(t,e,d,p),p&&(i.batchFill=d.fill||"",i.batchStroke=d.stroke||"")):e instanceof es?(3!==i.lastDrawType&&(l=!0,i.lastDrawType=3),yg(t,e,u,l,i),function(t,e,i){var n=i.text;if(null!=n&&(n+=""),n){t.font=i.font||_n,t.textAlign=i.textAlign,t.textBaseline=i.textBaseline;var r=void 0;if(t.setLineDash){var o=i.lineDash&&i.lineWidth>0&&ag(i.lineDash,i.lineWidth),a=i.lineDashOffset;if(o){var s=i.strokeNoScale&&e.getLineScale?e.getLineScale():1;s&&1!==s&&(o=z(o,function(t){return t/s}),a/=s),t.setLineDash(o),t.lineDashOffset=a,r=!0}}i.strokeFirst?(lg(i)&&t.strokeText(n,i.x,i.y),cg(i)&&t.fillText(n,i.x,i.y)):(cg(i)&&t.fillText(n,i.x,i.y),lg(i)&&t.strokeText(n,i.x,i.y)),r&&t.setLineDash([])}}(t,e,d)):e instanceof rs?(2!==i.lastDrawType&&(l=!0,i.lastDrawType=2),function(t,e,i,n,r){gg(t,xg(e,r.inHover),i&&xg(i,r.inHover),n,r)}(t,e,u,l,i),function(t,e,i){var n=e.__image=oo(i.image,e.__image,e,e.onload);if(n&&so(n)){var r=i.x||0,o=i.y||0,a=e.getWidth(),s=e.getHeight(),l=n.width/n.height;if(null==a&&null!=s?a=s*l:null==s&&null!=a?s=a/l:null==a&&null==s&&(a=n.width,s=n.height),i.sWidth&&i.sHeight){var u=i.sx||0,c=i.sy||0;t.drawImage(n,u,c,i.sWidth,i.sHeight,r,o,a,s)}else if(i.sx&&i.sy){var h=a-(u=i.sx),p=s-(c=i.sy);t.drawImage(n,u,c,h,p,r,o,a,s)}else t.drawImage(n,r,o,a,s)}}(t,e,d)):e instanceof Lu&&(4!==i.lastDrawType&&(l=!0,i.lastDrawType=4),function(t,e,i){var n=e.getDisplayables(),r=e.getTemporalDisplayables();t.save();var o,a,s={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:i.viewWidth,viewHeight:i.viewHeight,inHover:i.inHover};for(o=e.getCursor(),a=n.length;o<a;o++)(c=n[o]).beforeBrush&&c.beforeBrush(),c.innerBeforeBrush(),wg(t,c,s,o===a-1),c.innerAfterBrush(),c.afterBrush&&c.afterBrush(),s.prevEl=c;for(var l=0,u=r.length;l<u;l++){var c;(c=r[l]).beforeBrush&&c.beforeBrush(),c.innerBeforeBrush(),wg(t,c,s,l===u-1),c.innerAfterBrush(),c.afterBrush&&c.afterBrush(),s.prevEl=c}e.clearTemporalDisplayables(),e.notClear=!0,t.restore()}(t,e,i)),p&&n&&_g(t,i),e.innerAfterBrush(),e.afterBrush&&e.afterBrush(),i.prevEl=e,e.__dirty=0,e.__isRendered=!0}}var Sg,Tg=new jm,Mg=new De(100),Ig=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function Cg(t,e){if("none"===t)return null;var i=e.getDevicePixelRatio(),n=e.getZr(),r="svg"===n.painter.type;t.dirty&&Tg.delete(t);var o=Tg.get(t);if(o)return o;var a=C(t,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});"none"===a.backgroundColor&&(a.backgroundColor=null);var s={repeat:"repeat"};return function(t){for(var e,o=[i],s=!0,l=0;l<Ig.length;++l){var u=a[Ig[l]],c=typeof u;if(null!=u&&!U(u)&&"string"!==c&&"number"!==c&&"boolean"!==c){s=!1;break}o.push(u)}if(s){e=o.join(",")+(r?"-svg":"");var h=Mg.get(e);h&&(r?t.svgElement=h:t.image=h)}var p,d=kg(a.dashArrayX),f=function(t){if(!t||"object"==typeof t&&0===t.length)return[0,0];if("number"==typeof t){var e=Math.ceil(t);return[e,e]}var i=z(t,function(t){return Math.ceil(t)});return t.length%2?i.concat(i):i}(a.dashArrayY),m=Ag(a.symbol),g=z(b=d,function(t){return Dg(t)}),y=Dg(f),v=!r&&A(),_=r&&n.painter.createSVGElement("g"),x=function(){for(var t=1,e=0,i=g.length;e<i;++e)t=yr(t,g[e]);var n=1;for(e=0,i=m.length;e<i;++e)n=yr(n,m[e].length);t*=n;var r=y*g.length*m.length;return{width:Math.max(1,Math.min(t,a.maxTileWidth)),height:Math.max(1,Math.min(r,a.maxTileHeight))}}(),b;v&&(v.width=x.width*i,v.height=x.height*i,p=v.getContext("2d")),function(){p&&(p.clearRect(0,0,v.width,v.height),a.backgroundColor&&(p.fillStyle=a.backgroundColor,p.fillRect(0,0,v.width,v.height)));for(var t=0,e=0;e<f.length;++e)t+=f[e];if(!(t<=0))for(var o=-y,s=0,l=0,u=0;o<x.height;){if(s%2==0){for(var c=l/2%m.length,h=0,g=0,b=0;h<2*x.width;){var w=0;for(e=0;e<d[u].length;++e)w+=d[u][e];if(w<=0)break;if(g%2==0){var S=.5*(1-a.symbolSize),T=h+d[u][g]*S,M=o+f[s]*S,I=d[u][g]*a.symbolSize,C=f[s]*a.symbolSize,A=b/2%m[c].length;k(T,M,I,C,m[c][A])}h+=d[u][g],++b,++g===d[u].length&&(g=0)}++u===d.length&&(u=0)}o+=f[s],++l,++s===f.length&&(s=0)}function k(t,e,o,s,l){var u=r?1:i,c=eg(l,t*u,e*u,o*u,s*u,a.color,a.symbolKeepAspect);r?_.appendChild(n.painter.paintOne(c)):bg(p,c)}}(),s&&Mg.put(e,v||_),t.image=v,t.svgElement=_,t.svgWidth=x.width,t.svgHeight=x.height}(s),s.rotation=a.rotation,s.scaleX=s.scaleY=r?1:1/i,Tg.set(t,s),t.dirty=!1,s}function Ag(t){if(!t||0===t.length)return[["rect"]];if("string"==typeof t)return[[t]];for(var e=!0,i=0;i<t.length;++i)if("string"!=typeof t[i]){e=!1;break}if(e)return Ag([t]);var n=[];for(i=0;i<t.length;++i)"string"==typeof t[i]?n.push([t[i]]):n.push(t[i]);return n}function kg(t){if(!t||0===t.length)return[[0,0]];if("number"==typeof t)return[[r=Math.ceil(t),r]];for(var e=!0,i=0;i<t.length;++i)if("number"!=typeof t[i]){e=!1;break}if(e)return kg([t]);var n=[];for(i=0;i<t.length;++i)if("number"==typeof t[i]){var r=Math.ceil(t[i]);n.push([r,r])}else(r=z(t[i],function(t){return Math.ceil(t)})).length%2==1?n.push(r.concat(r)):n.push(r);return n}function Dg(t){for(var e=0,i=0;i<t.length;++i)e+=t[i];return t.length%2==1?2*e:e}function Eg(t){$(t)&&(t=(new DOMParser).parseFromString(t,"text/xml"));var e=t;for(9===e.nodeType&&(e=e.firstChild);"svg"!==e.nodeName.toLowerCase()||1!==e.nodeType;)e=e.nextSibling;return e}var Pg={fill:"fill",stroke:"stroke","stroke-width":"lineWidth",opacity:"opacity","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-miterlimit":"miterLimit","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","text-anchor":"textAlign",visibility:"visibility",display:"display"},Lg=N(Pg),zg={"alignment-baseline":"textBaseline","stop-color":"stopColor"},Og=N(zg),Rg=function(){function t(){this._defs={},this._root=null}return t.prototype.parse=function(t,e){e=e||{};var i=Eg(t);if(!i)throw Error("Illegal svg");this._defsUsePending=[];var n=new Fn;this._root=n;var r=[],o=i.getAttribute("viewBox")||"",a=parseFloat(i.getAttribute("width")||e.width),s=parseFloat(i.getAttribute("height")||e.height);isNaN(a)&&(a=null),isNaN(s)&&(s=null),Gg(i,n,null,!0,!1);for(var l,u,c=i.firstChild;c;)this._parseNode(c,n,r,null,!1,!1),c=c.nextSibling;if(function(t,e){for(var i=0;i<e.length;i++){var n=e[i];n[0].style[n[1]]=t[n[2]]}}(this._defs,this._defsUsePending),this._defsUsePending=[],o){var h=jg(o);h.length>=4&&(l={x:parseFloat(h[0]||0),y:parseFloat(h[1]||0),width:parseFloat(h[2]),height:parseFloat(h[3])})}if(l&&null!=a&&null!=s&&(u=Kg(l,{x:0,y:0,width:a,height:s}),!e.ignoreViewBox)){var p=n;(n=new Fn).add(p),p.scaleX=p.scaleY=u.scale,p.x=u.x,p.y=u.y}return e.ignoreRootClip||null==a||null==s||n.setClipPath(new hs({shape:{x:0,y:0,width:a,height:s}})),{root:n,width:a,height:s,viewBoxRect:l,viewBoxTransform:u,named:r}},t.prototype._parseNode=function(t,e,i,n,r,o){var a,s=t.nodeName.toLowerCase(),l=n;if("defs"===s&&(r=!0),"text"===s&&(o=!0),"defs"===s||"switch"===s)a=e;else{if(!r){var u=Sg[s];if(u&&ft(Sg,s)){a=u.call(this,t,e);var c=t.getAttribute("name");if(c){var h={name:c,namedFrom:null,svgNodeTagLower:s,el:a};i.push(h),"g"===s&&(l=h)}else n&&i.push({name:n.name,namedFrom:n,svgNodeTagLower:s,el:a});e.add(a)}}var p=Bg[s];if(p&&ft(Bg,s)){var d=p.call(this,t),f=t.getAttribute("id");f&&(this._defs[f]=d)}}if(a&&a.isGroup)for(var m=t.firstChild;m;)1===m.nodeType?this._parseNode(m,a,i,l,r,o):3===m.nodeType&&o&&this._parseText(m,a),m=m.nextSibling},t.prototype._parseText=function(t,e){var i=new es({style:{text:t.textContent},silent:!0,x:this._textX||0,y:this._textY||0});Vg(e,i),Gg(t,i,this._defsUsePending,!1,!1),function(t,e){var i=e.__selfStyle;if(i){var n=i.textBaseline,r=n;n&&"auto"!==n?"baseline"===n?r="alphabetic":"before-edge"===n||"text-before-edge"===n?r="top":"after-edge"===n||"text-after-edge"===n?r="bottom":"central"!==n&&"mathematical"!==n||(r="middle"):r="alphabetic",t.style.textBaseline=r}var o=e.__inheritedStyle;if(o){var a=o.textAlign,s=a;a&&("middle"===a&&(s="center"),t.style.textAlign=s)}}(i,e);var n=i.style,r=n.fontSize;r&&r<9&&(n.fontSize=9,i.scaleX*=r/9,i.scaleY*=r/9);var o=(n.fontSize||n.fontFamily)&&[n.fontStyle,n.fontWeight,(n.fontSize||12)+"px",n.fontFamily||"sans-serif"].join(" ");n.font=o;var a=i.getBoundingRect();return this._textX+=a.width,e.add(i),i},t.internalField=void(Sg={g:function(t,e){var i=new Fn;return Vg(e,i),Gg(t,i,this._defsUsePending,!1,!1),i},rect:function(t,e){var i=new hs;return Vg(e,i),Gg(t,i,this._defsUsePending,!1,!1),i.setShape({x:parseFloat(t.getAttribute("x")||"0"),y:parseFloat(t.getAttribute("y")||"0"),width:parseFloat(t.getAttribute("width")||"0"),height:parseFloat(t.getAttribute("height")||"0")}),i.silent=!0,i},circle:function(t,e){var i=new Gl;return Vg(e,i),Gg(t,i,this._defsUsePending,!1,!1),i.setShape({cx:parseFloat(t.getAttribute("cx")||"0"),cy:parseFloat(t.getAttribute("cy")||"0"),r:parseFloat(t.getAttribute("r")||"0")}),i.silent=!0,i},line:function(t,e){var i=new gu;return Vg(e,i),Gg(t,i,this._defsUsePending,!1,!1),i.setShape({x1:parseFloat(t.getAttribute("x1")||"0"),y1:parseFloat(t.getAttribute("y1")||"0"),x2:parseFloat(t.getAttribute("x2")||"0"),y2:parseFloat(t.getAttribute("y2")||"0")}),i.silent=!0,i},ellipse:function(t,e){var i=new Wl;return Vg(e,i),Gg(t,i,this._defsUsePending,!1,!1),i.setShape({cx:parseFloat(t.getAttribute("cx")||"0"),cy:parseFloat(t.getAttribute("cy")||"0"),rx:parseFloat(t.getAttribute("rx")||"0"),ry:parseFloat(t.getAttribute("ry")||"0")}),i.silent=!0,i},polygon:function(t,e){var i,n=t.getAttribute("points");n&&(i=Ug(n));var r=new hu({shape:{points:i||[]},silent:!0});return Vg(e,r),Gg(t,r,this._defsUsePending,!1,!1),r},polyline:function(t,e){var i,n=t.getAttribute("points");n&&(i=Ug(n));var r=new du({shape:{points:i||[]},silent:!0});return Vg(e,r),Gg(t,r,this._defsUsePending,!1,!1),r},image:function(t,e){var i=new rs;return Vg(e,i),Gg(t,i,this._defsUsePending,!1,!1),i.setStyle({image:t.getAttribute("xlink:href")||t.getAttribute("href"),x:+t.getAttribute("x"),y:+t.getAttribute("y"),width:+t.getAttribute("width"),height:+t.getAttribute("height")}),i.silent=!0,i},text:function(t,e){var i=t.getAttribute("x")||"0",n=t.getAttribute("y")||"0",r=t.getAttribute("dx")||"0",o=t.getAttribute("dy")||"0";this._textX=parseFloat(i)+parseFloat(r),this._textY=parseFloat(n)+parseFloat(o);var a=new Fn;return Vg(e,a),Gg(t,a,this._defsUsePending,!1,!0),a},tspan:function(t,e){var i=t.getAttribute("x"),n=t.getAttribute("y");null!=i&&(this._textX=parseFloat(i)),null!=n&&(this._textY=parseFloat(n));var r=t.getAttribute("dx")||"0",o=t.getAttribute("dy")||"0",a=new Fn;return Vg(e,a),Gg(t,a,this._defsUsePending,!1,!0),this._textX+=parseFloat(r),this._textY+=parseFloat(o),a},path:function(t,e){var i=Fl(t.getAttribute("d")||"");return Vg(e,i),Gg(t,i,this._defsUsePending,!1,!1),i.silent=!0,i}}),t}(),Bg={lineargradient:function(t){var e=parseInt(t.getAttribute("x1")||"0",10),i=parseInt(t.getAttribute("y1")||"0",10),n=parseInt(t.getAttribute("x2")||"10",10),r=parseInt(t.getAttribute("y2")||"0",10),o=new Mu(e,i,n,r);return Ng(t,o),Fg(t,o),o},radialgradient:function(t){var e=parseInt(t.getAttribute("cx")||"0",10),i=parseInt(t.getAttribute("cy")||"0",10),n=parseInt(t.getAttribute("r")||"0",10),r=new Iu(e,i,n);return Ng(t,r),Fg(t,r),r}};function Ng(t,e){"userSpaceOnUse"===t.getAttribute("gradientUnits")&&(e.global=!0)}function Fg(t,e){for(var i=t.firstChild;i;){if(1===i.nodeType&&"stop"===i.nodeName.toLocaleLowerCase()){var n=i.getAttribute("offset"),r=void 0;r=n&&n.indexOf("%")>0?parseInt(n,10)/100:n?parseFloat(n):0;var o={};Yg(i,o,o);var a=o.stopColor||i.getAttribute("stop-color")||"#000000";e.colorStops.push({offset:r,color:a})}i=i.nextSibling}}function Vg(t,e){t&&t.__inheritedStyle&&(e.__inheritedStyle||(e.__inheritedStyle={}),C(e.__inheritedStyle,t.__inheritedStyle))}function Ug(t){for(var e=jg(t),i=[],n=0;n<e.length;n+=2){var r=parseFloat(e[n]),o=parseFloat(e[n+1]);i.push([r,o])}return i}function Gg(t,e,i,n,r){var o=e,a=o.__inheritedStyle=o.__inheritedStyle||{},s={};1===t.nodeType&&(function(t,e){var i=t.getAttribute("transform");if(i){i=i.replace(/,/g," ");var n=[],r=null;i.replace(Zg,function(t,e,i){return n.push(e,i),""});for(var o=n.length-1;o>0;o-=2){var a=n[o],s=n[o-1],l=jg(a);switch(r=r||[1,0,0,1,0,0],s){case"translate":Wi(r,r,[parseFloat(l[0]),parseFloat(l[1]||"0")]);break;case"scale":ji(r,r,[parseFloat(l[0]),parseFloat(l[1]||l[0])]);break;case"rotate":Hi(r,r,-parseFloat(l[0])*qg);break;case"skewX":$i(r,[1,0,Math.tan(parseFloat(l[0])*qg),1,0,0],r);break;case"skewY":$i(r,[1,Math.tan(parseFloat(l[0])*qg),0,1,0,0],r);break;case"matrix":r[0]=parseFloat(l[0]),r[1]=parseFloat(l[1]),r[2]=parseFloat(l[2]),r[3]=parseFloat(l[3]),r[4]=parseFloat(l[4]),r[5]=parseFloat(l[5])}}e.setLocalTransform(r)}}(t,e),Yg(t,a,s),n||function(t,e,i){for(var n=0;n<Lg.length;n++){var r=Lg[n];null!=(o=t.getAttribute(r))&&(e[Pg[r]]=o)}for(n=0;n<Og.length;n++){var o;r=Og[n],null!=(o=t.getAttribute(r))&&(i[zg[r]]=o)}}(t,a,s)),o.style=o.style||{},null!=a.fill&&(o.style.fill=Wg(o,"fill",a.fill,i)),null!=a.stroke&&(o.style.stroke=Wg(o,"stroke",a.stroke,i)),L(["lineWidth","opacity","fillOpacity","strokeOpacity","miterLimit","fontSize"],function(t){null!=a[t]&&(o.style[t]=parseFloat(a[t]))}),L(["lineDashOffset","lineCap","lineJoin","fontWeight","fontFamily","fontStyle","textAlign"],function(t){null!=a[t]&&(o.style[t]=a[t])}),r&&(o.__selfStyle=s),a.lineDash&&(o.style.lineDash=z(jg(a.lineDash),function(t){return parseFloat(t)})),"hidden"!==a.visibility&&"collapse"!==a.visibility||(o.invisible=!0),"none"===a.display&&(o.ignore=!0)}var $g=/^url\(\s*#(.*?)\)/;function Wg(t,e,i,n){var r=i&&i.match($g);if(!r)return"none"===i&&(i=null),i;var o=at(r[1]);n.push([t,e,o])}var Hg=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function jg(t){return t.match(Hg)||[]}var Zg=/(translate|scale|rotate|skewX|skewY|matrix)\(([\-\s0-9\.eE,]*)\)/g,qg=Math.PI/180,Xg=/([^\s:;]+)\s*:\s*([^:;]+)/g;function Yg(t,e,i){var n,r=t.getAttribute("style");if(r)for(Xg.lastIndex=0;null!=(n=Xg.exec(r));){var o=n[1],a=ft(Pg,o)?Pg[o]:null;a&&(e[a]=n[2]);var s=ft(zg,o)?zg[o]:null;s&&(i[s]=n[2])}}function Kg(t,e){var i=e.width/t.width,n=e.height/t.height,r=Math.min(i,n);return{scale:r,x:-(t.x+t.width/2)*r+(e.x+e.width/2),y:-(t.y+t.height/2)*r+(e.y+e.height/2)}}function Jg(t,e){return Math.abs(t-e)<1e-8}function Qg(t,e,i){var n=0,r=t[0];if(!r)return!1;for(var o=1;o<t.length;o++){var a=t[o];n+=Ua(r[0],r[1],a[0],a[1],e,i),r=a}var s=t[0];return Jg(r[0],s[0])&&Jg(r[1],s[1])||(n+=Ua(r[0],r[1],s[0],s[1],e,i)),0!==n}var ty=[],ey=function(){function t(t){this.name=t}return t.prototype.getCenter=function(){},t}(),iy=function(t){function e(e,i,n){var r=t.call(this,e)||this;if(r.type="geoJSON",r.geometries=i,n)n=[n[0],n[1]];else{var o=r.getBoundingRect();n=[o.x+o.width/2,o.y+o.height/2]}return r._center=n,r}return i(e,t),e.prototype.getBoundingRect=function(){var t=this._rect;if(t)return t;for(var e=Number.MAX_VALUE,i=[e,e],n=[-e,-e],r=[],o=[],a=this.geometries,s=0;s<a.length;s++)"polygon"===a[s].type&&(sa(a[s].exterior,r,o),Rt(i,i,r),Bt(n,n,o));return 0===s&&(i[0]=i[1]=n[0]=n[1]=0),this._rect=new yn(i[0],i[1],n[0]-i[0],n[1]-i[1])},e.prototype.contain=function(t){var e=this.getBoundingRect(),i=this.geometries;if(!e.contain(t[0],t[1]))return!1;t:for(var n=0,r=i.length;n<r;n++)if("polygon"===i[n].type){var o=i[n].exterior,a=i[n].interiors;if(Qg(o,t[0],t[1])){for(var s=0;s<(a?a.length:0);s++)if(Qg(a[s],t[0],t[1]))continue t;return!0}}return!1},e.prototype.transformTo=function(t,e,i,n){var r=this.getBoundingRect(),o=r.width/r.height;i?n||(n=i/o):i=o*n;for(var a=new yn(t,e,i,n),s=r.calculateTransform(a),l=this.geometries,u=0;u<l.length;u++)if("polygon"===l[u].type){for(var c=l[u].exterior,h=l[u].interiors,p=0;p<c.length;p++)Ot(c[p],c[p],s);for(var d=0;d<(h?h.length:0);d++)for(p=0;p<h[d].length;p++)Ot(h[d][p],h[d][p],s)}(r=this._rect).copy(a),this._center=[r.x+r.width/2,r.y+r.height/2]},e.prototype.cloneShallow=function(t){null==t&&(t=this.name);var i=new e(t,this.geometries,this._center);return i._rect=this._rect,i.transformTo=null,i},e.prototype.getCenter=function(){return this._center},e.prototype.setCenter=function(t){this._center=t},e}(ey),ny=function(t){function e(e,i){var n=t.call(this,e)||this;return n.type="geoSVG",n._elOnlyForCalculate=i,n}return i(e,t),e.prototype.getCenter=function(){var t=this._center;return t||(t=this._center=this._calculateCenter()),t},e.prototype._calculateCenter=function(){for(var t=this._elOnlyForCalculate,e=t.getBoundingRect(),i=[e.x+e.width/2,e.y+e.height/2],n=Ui(ty),r=t;r&&!r.isGeoSVGGraphicRoot;)$i(n,r.getLocalTransform(),n),r=r.parent;return Zi(n,n),Ot(i,i,n),i},e}(ey),ry=ht(["rect","circle","line","ellipse","polygon","polyline","path","text","tspan","g"]),oy=function(){function t(t,e){this.type="geoSVG",this._usedGraphicMap=ht(),this._freedGraphics=[],this._mapName=t,this._parsedXML=Eg(e)}return t.prototype.load=function(){var t=this._firstGraphic;if(!t){t=this._firstGraphic=this._buildGraphic(this._parsedXML),this._freedGraphics.push(t),this._boundingRect=this._firstGraphic.boundingRect.clone();var e=function(t){var e=[],i=ht();return L(t,function(t){if(null==t.namedFrom){var n=new ny(t.name,t.el);e.push(n),i.set(t.name,n)}}),{regions:e,regionsMap:i}}(t.named),i=e.regions,n=e.regionsMap;this._regions=i,this._regionsMap=n}return{boundingRect:this._boundingRect,regions:this._regions,regionsMap:this._regionsMap}},t.prototype._buildGraphic=function(t){var e,i,n,r;try{ot(null!=(i=(e=t&&(n=t,r={ignoreViewBox:!0,ignoreRootClip:!0},(new Rg).parse(n,r))||{}).root))}catch(t){throw Error("Invalid svg format\n"+t.message)}var o=new Fn;o.add(i),o.isGeoSVGGraphicRoot=!0;var a=e.width,s=e.height,l=e.viewBoxRect,u=this._boundingRect;if(!u){var c=void 0,h=void 0,p=void 0,d=void 0;if(null!=a?(c=0,p=a):l&&(c=l.x,p=l.width),null!=s?(h=0,d=s):l&&(h=l.y,d=l.height),null==c||null==h){var f=i.getBoundingRect();null==c&&(c=f.x,p=f.width),null==h&&(h=f.y,d=f.height)}u=this._boundingRect=new yn(c,h,p,d)}if(l){var m=Kg(l,u);i.scaleX=i.scaleY=m.scale,i.x=m.x,i.y=m.y}o.setClipPath(new hs({shape:u.plain()}));var g=[];return L(e.named,function(t){var e;null!=ry.get(t.svgNodeTagLower)&&(g.push(t),(e=t.el).silent=!1,e.isGroup&&e.traverse(function(t){t.silent=!1}))}),{root:o,boundingRect:u,named:g}},t.prototype.useGraphic=function(t){var e=this._usedGraphicMap,i=e.get(t);return i||(i=this._freedGraphics.pop()||this._buildGraphic(this._parsedXML),e.set(t,i),i)},t.prototype.freeGraphic=function(t){var e=this._usedGraphicMap,i=e.get(t);i&&(e.removeKey(t),this._freedGraphics.push(i))},t}();function ay(t,e,i){for(var n=[],r=e[0],o=e[1],a=0;a<t.length;a+=2){var s=t.charCodeAt(a)-64,l=t.charCodeAt(a+1)-64;s=s>>1^-(1&s),l=l>>1^-(1&l),r=s+=r,o=l+=o,n.push([s/i,l/i])}return n}function sy(t,e){return z(R((t=function(t){if(!t.UTF8Encoding)return t;var e=t,i=e.UTF8Scale;null==i&&(i=1024);for(var n=e.features,r=0;r<n.length;r++){var o=n[r].geometry;if("Polygon"===o.type)for(var a=o.coordinates,s=0;s<a.length;s++)a[s]=ay(a[s],o.encodeOffsets[s],i);else if("MultiPolygon"===o.type)for(a=o.coordinates,s=0;s<a.length;s++)for(var l=a[s],u=0;u<l.length;u++)l[u]=ay(l[u],o.encodeOffsets[s][u],i)}return e.UTF8Encoding=!1,e}(t)).features,function(t){return t.geometry&&t.properties&&t.geometry.coordinates.length>0}),function(t){var i=t.properties,n=t.geometry,r=[];if("Polygon"===n.type){var o=n.coordinates;r.push({type:"polygon",exterior:o[0],interiors:o.slice(1)})}"MultiPolygon"===n.type&&L(o=n.coordinates,function(t){t[0]&&r.push({type:"polygon",exterior:t[0],interiors:t.slice(1)})});var a=new iy(i[e||"name"],r,i.cp);return a.properties=i,a})}for(var ly=[126,25],uy="南海诸岛",cy=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]],hy=0;hy<cy.length;hy++)for(var py=0;py<cy[hy].length;py++)cy[hy][py][0]/=10.5,cy[hy][py][1]/=-14,cy[hy][py][0]+=ly[0],cy[hy][py][1]+=ly[1];var dy={"南海诸岛":[32,80],"广东":[0,-10],"香港":[10,5],"澳门":[-10,10],"天津":[5,5]},fy={Russia:[100,60],"United States":[-99,38],"United States of America":[-99,38]},my=[[[123.45165252685547,25.73527164402261],[123.49731445312499,25.73527164402261],[123.49731445312499,25.750734064600884],[123.45165252685547,25.750734064600884],[123.45165252685547,25.73527164402261]]],gy=function(){function t(t,e,i){var n;this.type="geoJSON",this._parsedMap=ht(),this._mapName=t,this._specialAreas=i,this._geoJSON=$(n=e)?void 0!==JSON&&JSON.parse?JSON.parse(n):Function("return ("+n+");")():n}return t.prototype.load=function(t,e){e=e||"name";var i=this._parsedMap.get(e);if(!i){var n=this._parseToRegions(e);i=this._parsedMap.set(e,{regions:n,boundingRect:yy(n)})}var r=ht(),o=[];return L(i.regions,function(e){var i=e.name;t&&t.hasOwnProperty(i)&&(e=e.cloneShallow(i=t[i])),o.push(e),r.set(i,e)}),{regions:o,boundingRect:i.boundingRect||new yn(0,0,0,0),regionsMap:r}},t.prototype._parseToRegions=function(t){var e,i=this._mapName,n=this._geoJSON;try{e=n?sy(n,t):[]}catch(t){throw Error("Invalid geoJson format\n"+t.message)}return function(t,e){if("china"===t){for(var i=0;i<e.length;i++)if(e[i].name===uy)return;e.push(new iy(uy,z(cy,function(t){return{type:"polygon",exterior:t}}),ly))}}(i,e),L(e,function(t){var e=t.name;!function(t,e){if("china"===t){var i=dy[e.name];if(i){var n=e.getCenter();n[0]+=i[0]/10.5,n[1]+=-i[1]/14,e.setCenter(n)}}}(i,t),function(t,e){if("world"===t){var i=fy[e.name];if(i){var n=[i[0],i[1]];e.setCenter(n)}}}(i,t),function(t,e){"china"===t&&"台湾"===e.name&&e.geometries.push({type:"polygon",exterior:my[0]})}(i,t);var n=this._specialAreas&&this._specialAreas[e];n&&t.transformTo(n.left,n.top,n.width,n.height)},this),e},t.prototype.getMapForUser=function(){return{geoJson:this._geoJSON,geoJSON:this._geoJSON,specialAreas:this._specialAreas}},t}();function yy(t){for(var e,i=0;i<t.length;i++){var n=t[i].getBoundingRect();(e=e||n.clone()).union(n)}return e}var vy=ht(),_y=function(t,e,i){if(e.svg){var n=new oy(t,e.svg);vy.set(t,n)}else{var r=e.geoJson||e.geoJSON;r&&!e.features?i=e.specialAreas:r=e,n=new gy(t,r,i),vy.set(t,n)}},xy=function(t){return vy.get(t)},by=function(t){var e=vy.get(t);return e&&"geoJSON"===e.type&&e.getMapForUser()},wy=function(t,e,i){var n=vy.get(t);if(n)return n.load(e,i)},Sy=new Ut,Ty="undefined"!=typeof window,My=2e3,Iy=4500,Cy={PROCESSOR:{FILTER:1e3,SERIES_FILTER:800,STATISTIC:5e3},VISUAL:{LAYOUT:1e3,PROGRESSIVE_LAYOUT:1100,GLOBAL:My,CHART:3e3,POST_CHART_LAYOUT:4600,COMPONENT:4e3,BRUSH:5e3,CHART_ITEM:Iy,ARIA:6e3,DECAL:7e3}},Ay=/^[a-zA-Z0-9_]+$/,ky="__connectUpdateStatus";function Dy(t){return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];if(!this.isDisposed())return Py(this,t,e);nv(this.id)}}function Ey(t){return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return Py(this,t,e)}}function Py(t,e,i){return i[0]=i[0]&&i[0].toLowerCase(),Ut.prototype[e].apply(t,i)}var Ly,zy,Oy,Ry,By,Ny,Fy,Vy,Uy,Gy,$y,Wy,Hy,jy,Zy,qy,Xy,Yy,Ky,Jy=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(Ut),Qy=Jy.prototype;Qy.on=Ey("on"),Qy.off=Ey("off");var tv=function(t){function e(e,i,n){var r=t.call(this,new Rm)||this;r._chartsViews=[],r._chartsMap={},r._componentsViews=[],r._componentsMap={},r._pendingActions=[],n=n||{},"string"==typeof i&&(i=uv[i]),r._dom=e;var o="canvas",a=!1,s=r._zr=Wn(e,{renderer:n.renderer||o,devicePixelRatio:n.devicePixelRatio,width:n.width,height:n.height,useDirtyRect:null==n.useDirtyRect?a:n.useDirtyRect});r._throttledZrFlush=im(F(s.flush,s),17),(i=S(i))&&ud(i,!0),r._theme=i,r._locale=function(t){if($(t)){var e=Yc[t.toUpperCase()]||{};return t===Zc||t===qc?S(e):T(S(e),S(Yc.EN),!1)}return T(S(t),S(Yc.EN),!1)}(n.locale||Jc),r._coordSysMgr=new Vp;var l=r._api=qy(r);function u(t,e){return t.__prio-e.__prio}return xe(lv,u),xe(av,u),r._scheduler=new fm(r,l,av,lv),r._messageCenter=new Jy,r._initEvents(),r.resize=F(r.resize,r),s.animation.on("frame",r._onframe,r),Gy(s,r),$y(s,r),lt(r),r}return i(e,t),e.prototype._onframe=function(){if(!this._disposed){Ky(this);var t=this._scheduler;if(this.__pendingUpdate){var e=this.__pendingUpdate.silent;this.__flagInMainProcess=!0,Ly(this),Ry.update.call(this,null,this.__pendingUpdate.updateParams),this._zr.flush(),this.__flagInMainProcess=!1,this.__pendingUpdate=null,Vy.call(this,e),Uy.call(this,e)}else if(t.unfinished){var i=1,n=this._model,r=this._api;t.unfinished=!1;do{var o=+new Date;t.performSeriesTasks(n),t.performDataProcessorTasks(n),Ny(this,n),t.performVisualTasks(n),Zy(this,this._model,r,"remain",{}),i-=+new Date-o}while(i>0&&t.unfinished);t.unfinished||this._zr.flush()}}},e.prototype.getDom=function(){return this._dom},e.prototype.getId=function(){return this.id},e.prototype.getZr=function(){return this._zr},e.prototype.setOption=function(t,e,i){if(this._disposed)nv(this.id);else{var n,r,o;if(j(e)&&(i=e.lazyUpdate,n=e.silent,r=e.replaceMerge,o=e.transition,e=e.notMerge),this.__flagInMainProcess=!0,!this._model||e){var a=new Gp(this._api),s=this._theme,l=this._model=new Lp;l.scheduler=this._scheduler,l.init(null,null,null,s,this._locale,a)}this._model.setOption(t,{replaceMerge:r},sv);var u={seriesTransition:o,optionChanged:!0};i?(this.__pendingUpdate={silent:n,updateParams:u},this.__flagInMainProcess=!1,this.getZr().wakeUp()):(Ly(this),Ry.update.call(this,null,u),this._zr.flush(),this.__pendingUpdate=null,this.__flagInMainProcess=!1,Vy.call(this,n),Uy.call(this,n))}},e.prototype.setTheme=function(){console.error("ECharts#setTheme() is DEPRECATED in ECharts 3.0")},e.prototype.getModel=function(){return this._model},e.prototype.getOption=function(){return this._model&&this._model.getOption()},e.prototype.getWidth=function(){return this._zr.getWidth()},e.prototype.getHeight=function(){return this._zr.getHeight()},e.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||Ty&&window.devicePixelRatio||1},e.prototype.getRenderedCanvas=function(t){if(a.canvasSupported)return t=t||{},this._zr.painter.getRenderedCanvas({backgroundColor:t.backgroundColor||this._model.get("backgroundColor"),pixelRatio:t.pixelRatio||this.getDevicePixelRatio()})},e.prototype.getSvgDataURL=function(){if(a.svgSupported){var t=this._zr;return L(t.storage.getDisplayList(),function(t){t.stopAnimation(null,!0)}),t.painter.toDataURL()}},e.prototype.getDataURL=function(t){if(!this._disposed){var e=(t=t||{}).excludeComponents,i=this._model,n=[],r=this;L(e,function(t){i.eachComponent({mainType:t},function(t){var e=r._componentsMap[t.__viewId];e.group.ignore||(n.push(e),e.group.ignore=!0)})});var o="svg"===this._zr.painter.getType()?this.getSvgDataURL():this.getRenderedCanvas(t).toDataURL("image/"+(t&&t.type||"png"));return L(n,function(t){t.group.ignore=!1}),o}nv(this.id)},e.prototype.getConnectedDataURL=function(t){if(this._disposed)nv(this.id);else if(a.canvasSupported){var e="svg"===t.type,i=this.group,n=Math.min,r=Math.max,o=1/0;if(pv[i]){var s=o,l=o,u=-1/0,c=-1/0,h=[],p=t&&t.pixelRatio||this.getDevicePixelRatio();L(hv,function(o,a){if(o.group===i){var p=e?o.getZr().painter.getSvgDom().innerHTML:o.getRenderedCanvas(S(t)),d=o.getDom().getBoundingClientRect();s=n(d.left,s),l=n(d.top,l),u=r(d.right,u),c=r(d.bottom,c),h.push({dom:p,left:d.left,top:d.top})}});var d=(u*=p)-(s*=p),f=(c*=p)-(l*=p),m=A(),g=Wn(m,{renderer:e?"svg":"canvas"});if(g.resize({width:d,height:f}),e){var y="";return L(h,function(t){var e=t.left-s,i=t.top-l;y+='<g transform="translate('+e+","+i+')">'+t.dom+"</g>"}),g.painter.getSvgRoot().innerHTML=y,t.connectedBackgroundColor&&g.painter.setBackgroundColor(t.connectedBackgroundColor),g.refreshImmediately(),g.painter.toDataURL()}return t.connectedBackgroundColor&&g.add(new hs({shape:{x:0,y:0,width:d,height:f},style:{fill:t.connectedBackgroundColor}})),L(h,function(t){var e=new rs({style:{x:t.left*p-s,y:t.top*p-l,image:t.dom}});g.add(e)}),g.refreshImmediately(),m.toDataURL("image/"+(t&&t.type||"png"))}return this.getDataURL(t)}},e.prototype.convertToPixel=function(t,e){return By(this,"convertToPixel",t,e)},e.prototype.convertFromPixel=function(t,e){return By(this,"convertFromPixel",t,e)},e.prototype.containPixel=function(t,e){var i;if(!this._disposed)return L(Rr(this._model,t),function(t,n){n.indexOf("Models")>=0&&L(t,function(t){var r=t.coordinateSystem;if(r&&r.containPoint)i=i||!!r.containPoint(e);else if("seriesModels"===n){var o=this._chartsMap[t.__viewId];o&&o.containPoint&&(i=i||o.containPoint(e,t))}},this)},this),!!i;nv(this.id)},e.prototype.getVisual=function(t,e){var i=Rr(this._model,t,{defaultMainType:"series"}),n,r=i.seriesModel.getData(),o=i.hasOwnProperty("dataIndexInside")?i.dataIndexInside:i.hasOwnProperty("dataIndex")?r.indexOfRawIndex(i.dataIndex):null;return null!=o?Nm(r,o,e):Fm(r,e)},e.prototype.getViewOfComponentModel=function(t){return this._componentsMap[t.__viewId]},e.prototype.getViewOfSeriesModel=function(t){return this._chartsMap[t.__viewId]},e.prototype._initEvents=function(){var t,e,i,n=this;L(iv,function(t){var e=function(e){var i,r=n.getModel(),o=e.target,a;if("globalout"===t?i={}:o&&$m(o,function(t){var e=Ss(t);if(e&&null!=e.dataIndex){var n=e.dataModel||r.getSeriesByIndex(e.seriesIndex);return i=n&&n.getDataParams(e.dataIndex,e.dataType)||{},!0}if(e.eventData)return i=I({},e.eventData),!0},!0),i){var s=i.componentType,l=i.componentIndex;"markLine"!==s&&"markPoint"!==s&&"markArea"!==s||(s="series",l=i.seriesIndex);var u=s&&null!=l&&r.getComponent(s,l),c=u&&n["series"===u.mainType?"_chartsMap":"_componentsMap"][u.__viewId];i.event=e,i.type=t,n._$eventProcessor.eventInfo={targetEl:o,packedEvent:i,model:u,view:c},n.trigger(t,i)}};e.zrEventfulCallAtLast=!0,n._zr.on(t,e,n)}),L(ov,function(t,e){n._messageCenter.on(e,function(t){this.trigger(e,t)},n)}),L(["selectchanged"],function(t){n._messageCenter.on(t,function(e){this.trigger(t,e)},n)}),t=this._messageCenter,e=this,i=this._api,t.on("selectchanged",function(t){var n=i.getModel();t.isFromClick?(Gm("map","selectchanged",e,n,t),Gm("pie","selectchanged",e,n,t)):"select"===t.fromAction?(Gm("map","selected",e,n,t),Gm("pie","selected",e,n,t)):"unselect"===t.fromAction&&(Gm("map","unselected",e,n,t),Gm("pie","unselected",e,n,t))})},e.prototype.isDisposed=function(){return this._disposed},e.prototype.clear=function(){this._disposed?nv(this.id):this.setOption({series:[]},!0)},e.prototype.dispose=function(){if(this._disposed)nv(this.id);else{this._disposed=!0,Ur(this.getDom(),mv,"");var t=this,e=t._api,i=t._model;L(t._componentsViews,function(t){t.dispose(i,e)}),L(t._chartsViews,function(t){t.dispose(i,e)}),t._zr.dispose(),t._dom=t._model=t._chartsMap=t._componentsMap=t._chartsViews=t._componentsViews=t._scheduler=t._api=t._zr=t._throttledZrFlush=t._theme=t._coordSysMgr=t._messageCenter=null,delete hv[t.id]}},e.prototype.resize=function(t){if(this._disposed)nv(this.id);else{this._zr.resize(t);var e=this._model;if(this._loadingFX&&this._loadingFX.resize(),e){var i=e.resetOption("media"),n=t&&t.silent;this.__pendingUpdate&&(null==n&&(n=this.__pendingUpdate.silent),i=!0,this.__pendingUpdate=null),this.__flagInMainProcess=!0,i&&Ly(this),Ry.update.call(this,{type:"resize",animation:I({duration:0},t&&t.animation)}),this.__flagInMainProcess=!1,Vy.call(this,n),Uy.call(this,n)}}},e.prototype.showLoading=function(t,e){if(this._disposed)nv(this.id);else if(j(t)&&(e=t,t=""),t=t||"default",this.hideLoading(),cv[t]){var i=cv[t](this._api,e),n=this._zr;this._loadingFX=i,n.add(i)}},e.prototype.hideLoading=function(){this._disposed?nv(this.id):(this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null)},e.prototype.makeActionFromEvent=function(t){var e=I({},t);return e.type=ov[t.type],e},e.prototype.dispatchAction=function(t,e){if(this._disposed)nv(this.id);else if(j(e)||(e={silent:!!e}),rv[t.type]&&this._model)if(this.__flagInMainProcess)this._pendingActions.push(t);else{var i=e.silent;Fy.call(this,t,i);var n=e.flush;n?this._zr.flush():!1!==n&&a.browser.weChat&&this._throttledZrFlush(),Vy.call(this,i),Uy.call(this,i)}},e.prototype.updateLabelLayout=function(){Sy.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},e.prototype.appendData=function(t){if(this._disposed)nv(this.id);else{var e=t.seriesIndex,i;this.getModel().getSeriesByIndex(e).appendData(t),this._scheduler.unfinished=!0,this.getZr().wakeUp()}},e.internalField=function(){function t(t){for(var e=[],i=t.currentStates,n=0;n<i.length;n++){var r=i[n];"emphasis"!==r&&"blur"!==r&&"select"!==r&&e.push(r)}t.selected&&t.states.select&&e.push("select"),2===t.hoverState&&t.states.emphasis?e.push("emphasis"):1===t.hoverState&&t.states.blur&&e.push("blur"),t.useStates(e)}function e(t,e){t.preventAutoZ||n(e.group,t.get("z")||0,t.get("zlevel")||0,-1/0)}function n(t,e,i,r){var o=t.getTextContent(),a=t.getTextGuideLine();if(t.isGroup)for(var s=t.childrenRef(),l=0;l<s.length;l++)r=Math.max(n(s[l],e,i,r),r);else t.z=e,t.zlevel=i,r=Math.max(t.z2,r);if(o&&(o.z=e,o.zlevel=i,isFinite(r)&&(o.z2=r+2)),a){var u=t.textGuideLineConfig;a.z=e,a.zlevel=i,isFinite(r)&&(a.z2=r+(u&&u.showAbove?1:-1))}return r}function r(t,e){e.group.traverse(function(t){if(!Fu(t)){var e=t.getTextContent(),i=t.getTextGuideLine();t.stateTransition&&(t.stateTransition=null),e&&e.stateTransition&&(e.stateTransition=null),i&&i.stateTransition&&(i.stateTransition=null),t.hasState()?(t.prevStates=t.currentStates,t.clearStates()):t.prevStates&&(t.prevStates=null)}})}function o(e,i){var n=e.getModel("stateAnimation"),r=e.isAnimationEnabled(),o=n.get("duration"),a=o>0?{duration:o,delay:n.get("delay"),easing:n.get("easing")}:null;i.group.traverse(function(e){if(e.states&&e.states.emphasis){if(Fu(e))return;if(e instanceof Qa&&function(t){var e=Cs(t);e.normalFill=t.style.fill,e.normalStroke=t.style.stroke;var i=t.states.select||{};e.selectFill=i.style&&i.style.fill||null,e.selectStroke=i.style&&i.style.stroke||null}(e),e.__dirty){var i=e.prevStates;i&&e.useStates(i)}if(r){e.stateTransition=a;var n=e.getTextContent(),o=e.getTextGuideLine();n&&(n.stateTransition=a),o&&(o.stateTransition=a)}e.__dirty&&t(e)}})}Ly=function(t){var e=t._scheduler;e.restorePipelines(t._model),e.prepareStageTasks(),zy(t,!0),zy(t,!1),e.plan()},zy=function(t,e){for(var i=t._model,n=t._scheduler,r=e?t._componentsViews:t._chartsViews,o=e?t._componentsMap:t._chartsMap,a=t._zr,s=t._api,l=0;l<r.length;l++)r[l].__alive=!1;function u(t){var l=t.__requireNewView;t.__requireNewView=!1;var u="_ec_"+t.id+"_"+t.type,c=!l&&o[u];if(!c){var h=jr(t.type),p;(c=new(e?$f.getClass(h.main,h.sub):Zf.getClass(h.sub))).init(i,s),o[u]=c,r.push(c),a.add(c.group)}t.__viewId=c.__id=u,c.__alive=!0,c.__model=t,c.group.__ecComponentInfo={mainType:t.mainType,index:t.componentIndex},!e&&n.prepareView(c,t,i,s)}for(e?i.eachComponent(function(t,e){"series"!==t&&u(e)}):i.eachSeries(u),l=0;l<r.length;){var c=r[l];c.__alive?l++:(!e&&c.renderTask.dispose(),a.remove(c.group),c.dispose(i,s),r.splice(l,1),o[c.__id]===c&&delete o[c.__id],c.__id=c.group.__ecComponentInfo=null)}},Oy=function(t,e,i,n,r){var o=t._model;if(o.setUpdatePayload(i),n){var a={};a[n+"Id"]=i[n+"Id"],a[n+"Index"]=i[n+"Index"],a[n+"Name"]=i[n+"Name"];var s={mainType:n,query:a};r&&(s.subType=r);var l,u=i.excludeSeriesId;null!=u&&(l=ht(),L(wr(u),function(t){var e=Dr(t,null);null!=e&&l.set(e,!0)})),xl(i)&&al(t._api),o&&o.eachComponent(s,function(e){if(!l||null===l.get(e.id))if(xl(i))if(e instanceof Of)i.type!==Es||i.notBlur||function(t,e,i){var n=t.seriesIndex,r=t.getData(e.dataType),o=Lr(r,e);o=(U(o)?o[0]:o)||0;var a=r.getItemGraphicEl(o);if(!a)for(var s=r.count(),l=0;!a&&l<s;)a=r.getItemGraphicEl(l++);if(a){var u=Ss(a);sl(n,u.focus,u.blurScope,i)}else{var c=t.get(["emphasis","focus"]),h=t.get(["emphasis","blurScope"]);null!=c&&sl(n,c,h,i)}}(e,i,t._api);else{var n=ul(e.mainType,e.componentIndex,i.name,t._api),r=n.focusSelf,o=n.dispatchers;i.type===Es&&r&&!i.notBlur&&ll(e.mainType,e.componentIndex,t._api),o&&L(o,function(t){i.type===Es?Qs(t):tl(t)})}else _l(i)&&e instanceof Of&&(function(t,e,i){if(_l(e)){var n=e.dataType,r=Lr(t.getData(n),e);U(r)||(r=[r]),t[e.type===Os?"toggleSelect":e.type===Ls?"select":"unselect"](r,n)}}(e,i,t._api),cl(e),Yy(t))},t),o&&o.eachComponent(s,function(e){l&&null!==l.get(e.id)||c(t["series"===n?"_chartsMap":"_componentsMap"][e.__viewId])},t)}else L([].concat(t._componentsViews).concat(t._chartsViews),c);function c(n){n&&n.__alive&&n[e]&&n[e](n.__model,o,t._api,i)}},Ry={prepareAndUpdate:function(t){Ly(this),Ry.update.call(this,t,{optionChanged:null!=t.newOption})},update:function(t,e){var i=this._model,n=this._api,r=this._zr,o=this._coordSysMgr,s=this._scheduler;if(i){i.setUpdatePayload(t),s.restoreData(i,t),s.performSeriesTasks(i),o.create(i,n),s.performDataProcessorTasks(i,t),Ny(this,i),o.update(i,n),Wy(i),s.performVisualTasks(i,t),Hy(this,i,n,t,e);var l=i.get("backgroundColor")||"transparent",u=i.get("darkMode");if(a.canvasSupported)r.setBackgroundColor(l),null!=u&&"auto"!==u&&r.setDarkMode(u);else{var c=He(l);l=Qe(c,"rgb"),0===c[3]&&(l="transparent")}Sy.trigger("afterupdate",i,n)}},updateTransform:function(t){var e=this,i=this._model,n=this._api;if(i){i.setUpdatePayload(t);var r=[];i.eachComponent(function(o,a){if("series"!==o){var s=e.getViewOfComponentModel(a);if(s&&s.__alive)if(s.updateTransform){var l=s.updateTransform(a,i,n,t);l&&l.update&&r.push(s)}else r.push(s)}});var o=ht();i.eachSeries(function(r){var a=e._chartsMap[r.__viewId];if(a.updateTransform){var s=a.updateTransform(r,i,n,t);s&&s.update&&o.set(r.uid,1)}else o.set(r.uid,1)}),Wy(i),this._scheduler.performVisualTasks(i,t,{setDirty:!0,dirtyMap:o}),Zy(this,i,n,t,{},o),Sy.trigger("afterupdate",i,n)}},updateView:function(t){var e=this._model;e&&(e.setUpdatePayload(t),Zf.markUpdateMethod(t,"updateView"),Wy(e),this._scheduler.performVisualTasks(e,t,{setDirty:!0}),Hy(this,e,this._api,t,{}),Sy.trigger("afterupdate",e,this._api))},updateVisual:function(t){var e=this,i=this._model;i&&(i.setUpdatePayload(t),i.eachSeries(function(t){t.getData().clearAllVisual()}),Zf.markUpdateMethod(t,"updateVisual"),Wy(i),this._scheduler.performVisualTasks(i,t,{visualType:"visual",setDirty:!0}),i.eachComponent(function(n,r){if("series"!==n){var o=e.getViewOfComponentModel(r);o&&o.__alive&&o.updateVisual(r,i,e._api,t)}}),i.eachSeries(function(n){e._chartsMap[n.__viewId].updateVisual(n,i,e._api,t)}),Sy.trigger("afterupdate",i,this._api))},updateLayout:function(t){Ry.update.call(this,t)}},By=function(t,e,i,n){if(t._disposed)nv(t.id);else for(var r,o=t._model,a=t._coordSysMgr.getCoordinateSystems(),s=Rr(o,i),l=0;l<a.length;l++){var u=a[l];if(u[e]&&null!=(r=u[e](o,s,n)))return r}},Ny=function(t,e){var i=t._chartsMap,n=t._scheduler;e.eachSeries(function(t){n.updateStreamModes(t,i[t.__viewId])})},Fy=function(t,e){var i=this,n=this.getModel(),r=t.type,o=t.escapeConnect,a=rv[r],s=a.actionInfo,l=(s.update||"update").split(":"),u=l.pop(),c=null!=l[0]&&jr(l[0]);this.__flagInMainProcess=!0;var h=[t],p=!1;t.batch&&(p=!0,h=z(t.batch,function(e){return(e=C(I({},e),t)).batch=null,e}));var d,f=[],m=_l(t),g=xl(t);if(L(h,function(e){if((d=(d=a.action(e,i._model,i._api))||I({},e)).type=s.event||d.type,f.push(d),g){var n=Br(t),r=n.queryOptionMap,o=n.mainTypeSpecified?r.keys()[0]:"series";Oy(i,u,e,o),Yy(i)}else m?(Oy(i,u,e,"series"),Yy(i)):c&&Oy(i,u,e,c.main,c.sub)}),"none"===u||g||m||c||(this.__pendingUpdate?(Ly(this),Ry.update.call(this,t),this.__pendingUpdate=null):Ry[u].call(this,t)),d=p?{type:s.event||r,escapeConnect:o,batch:f}:f[0],this.__flagInMainProcess=!1,!e){var y=this._messageCenter;if(y.trigger(d.type,d),m){var v={type:"selectchanged",escapeConnect:o,selected:hl(n),isFromClick:t.isFromClick||!1,fromAction:t.type,fromActionPayload:t};y.trigger(v.type,v)}}},Vy=function(t){for(var e=this._pendingActions;e.length;){var i=e.shift();Fy.call(this,i,t)}},Uy=function(t){!t&&this.trigger("updated")},Gy=function(t,e){t.on("rendered",function(i){e.trigger("rendered",i),!t.animation.isFinished()||e.__pendingUpdate||e._scheduler.unfinished||e._pendingActions.length||e.trigger("finished")})},$y=function(t,e){t.on("mouseover",function(t){var i=$m(t.target,vl);i&&(function(t,e,i){var n=Ss(t),r=ul(n.componentMainType,n.componentIndex,n.componentHighDownName,i),o=r.dispatchers,a=r.focusSelf;o?(a&&ll(n.componentMainType,n.componentIndex,i),L(o,function(t){return Ks(t,e)})):(sl(n.seriesIndex,n.focus,n.blurScope,i),"self"===n.focus&&ll(n.componentMainType,n.componentIndex,i),Ks(t,e))}(i,t,e._api),Yy(e))}).on("mouseout",function(t){var i=$m(t.target,vl);i&&(function(t,e,i){al(i);var n=Ss(t),r=ul(n.componentMainType,n.componentIndex,n.componentHighDownName,i).dispatchers;r?L(r,function(t){return Js(t,e)}):Js(t,e)}(i,t,e._api),Yy(e))}).on("click",function(t){var i=$m(t.target,function(t){return null!=Ss(t).dataIndex},!0);if(i){var n=i.selected?"unselect":"select",r=Ss(i);e._api.dispatchAction({type:n,dataType:r.dataType,dataIndexInside:r.dataIndex,seriesIndex:r.seriesIndex,isFromClick:!0})}})},Wy=function(t){t.clearColorPalette(),t.eachSeries(function(t){t.clearColorPalette()})},Hy=function(t,e,i,n,r){jy(t,e,i,n,r),L(t._chartsViews,function(t){t.__alive=!1}),Zy(t,e,i,n,r),L(t._chartsViews,function(t){t.__alive||t.remove(e,i)})},jy=function(t,i,n,a,s,l){L(l||t._componentsViews,function(t){var s=t.__model;r(s,t),t.render(s,i,n,a),e(s,t),o(s,t)})},Zy=function(t,i,n,s,l,u){var c=t._scheduler;l=I(l||{},{updatedSeries:i.getSeries()}),Sy.trigger("series:beforeupdate",i,n,l);var h=!1;i.eachSeries(function(e){var i=t._chartsMap[e.__viewId];i.__alive=!0;var n=i.renderTask;c.updatePayload(n,s),r(e,i),u&&u.get(e.uid)&&n.dirty(),n.perform(c.getPerformArgs(n))&&(h=!0),i.group.silent=!!e.get("silent"),function(t,e){var i=t.get("blendMode")||null;e.group.traverse(function(t){t.isGroup||(t.style.blend=i),t.eachPendingDisplayable&&t.eachPendingDisplayable(function(t){t.style.blend=i})})}(e,i),cl(e)}),c.unfinished=h||c.unfinished,Sy.trigger("series:layoutlabels",i,n,l),Sy.trigger("series:transition",i,n,l),i.eachSeries(function(i){var n=t._chartsMap[i.__viewId];e(i,n),o(i,n)}),function(t,e){var i=t._zr.storage,n=0;i.traverse(function(t){t.isGroup||n++}),n>e.get("hoverLayerThreshold")&&!a.node&&!a.worker&&e.eachSeries(function(e){if(!e.preventUsingHoverLayer){var i=t._chartsMap[e.__viewId];i.__alive&&i.group.traverse(function(t){t.states.emphasis&&(t.states.emphasis.hoverLayer=!0)})}})}(t,i),Sy.trigger("series:afterupdate",i,n,l)},Yy=function(t){t.__needsUpdateStatus=!0,t.getZr().wakeUp()},Ky=function(e){e.__needsUpdateStatus&&(e.getZr().storage.traverse(function(e){Fu(e)||t(e)}),e.__needsUpdateStatus=!1)},qy=function(t){return new(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return i(n,e),n.prototype.getCoordinateSystems=function(){return t._coordSysMgr.getCoordinateSystems()},n.prototype.getComponentByElement=function(e){for(;e;){var i=e.__ecComponentInfo;if(null!=i)return t._model.getComponent(i.mainType,i.index);e=e.parent}},n.prototype.enterEmphasis=function(e,i){Qs(e,i),Yy(t)},n.prototype.leaveEmphasis=function(e,i){tl(e,i),Yy(t)},n.prototype.enterBlur=function(e){el(e),Yy(t)},n.prototype.leaveBlur=function(e){il(e),Yy(t)},n.prototype.enterSelect=function(e){nl(e),Yy(t)},n.prototype.leaveSelect=function(e){rl(e),Yy(t)},n.prototype.getModel=function(){return t.getModel()},n.prototype.getViewOfComponentModel=function(e){return t.getViewOfComponentModel(e)},n.prototype.getViewOfSeriesModel=function(e){return t.getViewOfSeriesModel(e)},n}(Np))(t)},Xy=function(t){function e(t,e){for(var i=0;i<t.length;i++)t[i][ky]=e}L(ov,function(i,n){t._messageCenter.on(n,function(i){if(pv[t.group]&&0!==t[ky]){if(i&&i.escapeConnect)return;var n=t.makeActionFromEvent(i),r=[];L(hv,function(e){e!==t&&e.group===t.group&&r.push(e)}),e(r,0),L(r,function(t){1!==t[ky]&&t.dispatchAction(n)}),e(r,2)}})})}}(),e}(Ut),ev=tv.prototype;ev.on=Dy("on"),ev.off=Dy("off"),ev.one=function(t,e,i){var n=this;this.on.call(this,t,function i(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];e&&e.apply&&e.apply(this,r),n.off(t,i)},i)};var iv=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];function nv(t){}var rv={},ov={},av=[],sv=[],lv=[],uv={},cv={},hv={},pv={},dv=+new Date-0,fv=+new Date-0,mv="_echarts_instance_";function gv(t){pv[t]=!1}var yv=gv;function vv(t){return hv[function(t,e){return t.getAttribute?t.getAttribute(e):t[e]}(t,mv)]}function _v(t,e){uv[t]=e}function xv(t){k(sv,t)<0&&sv.push(t)}function bv(t,e){Dv(av,t,e,2e3)}function wv(t){Tv("afterinit",t)}function Sv(t){Tv("afterupdate",t)}function Tv(t,e){Sy.on(t,e)}function Mv(t,e,i){"function"==typeof e&&(i=e,e="");var n=j(t)?t.type:[t,t={event:e}][0];t.event=(t.event||n).toLowerCase(),e=t.event,ov[e]||(ot(Ay.test(n)&&Ay.test(e)),rv[n]||(rv[n]={action:i,actionInfo:t}),ov[e]=n)}function Iv(t,e){Vp.register(t,e)}function Cv(t,e){Dv(lv,t,e,1e3,"layout")}function Av(t,e){Dv(lv,t,e,3e3,"visual")}var kv=[];function Dv(t,e,i,n,r){if((G(e)||j(e))&&(i=e,e=n),!(k(kv,i)>=0)){kv.push(i);var o=fm.wrapStageHandler(i,r);o.__prio=e,o.__raw=i,t.push(o)}}function Ev(t,e){cv[t]=e}function Pv(t,e,i){_y(t,e,i)}var Lv=function(t){var e=(t=S(t)).type,i="";e||_r(i);var n=e.split(":");2!==n.length&&_r(i);var r=!1;"echarts"===n[0]&&(e=n[1],r=!0),t.__isBuiltIn=r,ef.set(e,t)};Av(My,um),Av(Iy,hm),Av(Iy,pm),Av(My,Bm),Av(Iy,{createOnAllSeries:!0,performRawSeries:!0,reset:function(t,e){if(t.hasSymbolVisual&&!e.isSeriesFiltered(t))return{dataEach:t.getData().hasItemOption?function(t,e){var i=t.getItemModel(e),n=i.getShallow("symbol",!0),r=i.getShallow("symbolSize",!0),o=i.getShallow("symbolRotate",!0),a=i.getShallow("symbolOffset",!0),s=i.getShallow("symbolKeepAspect",!0);null!=n&&t.setItemVisual(e,"symbol",n),null!=r&&t.setItemVisual(e,"symbolSize",r),null!=o&&t.setItemVisual(e,"symbolRotate",o),null!=a&&t.setItemVisual(e,"symbolOffset",a),null!=s&&t.setItemVisual(e,"symbolKeepAspect",s)}:null}}}),Av(7e3,function(t,e){t.eachRawSeries(function(i){if(!t.isSeriesFiltered(i)){var n=i.getData();n.hasItemVisual()&&n.each(function(t){var i=n.getItemVisual(t,"decal");i&&(n.ensureUniqueItemVisual(t,"style").decal=Cg(i,e))});var r=n.getVisual("decal");r&&(n.getVisual("style").decal=Cg(r,e))}})}),xv(ud),bv(900,function(t){var e=ht();t.eachSeries(function(t){var i=t.get("stack");if(i){var n=e.get(i)||e.set(i,[]),r=t.getData(),o={stackResultDimension:r.getCalculationInfo("stackResultDimension"),stackedOverDimension:r.getCalculationInfo("stackedOverDimension"),stackedDimension:r.getCalculationInfo("stackedDimension"),stackedByDimension:r.getCalculationInfo("stackedByDimension"),isStackedByIndex:r.getCalculationInfo("isStackedByIndex"),data:r,seriesModel:t};if(!o.stackedDimension||!o.isStackedByIndex&&!o.stackedByDimension)return;n.length&&r.setCalculationInfo("stackedOnSeries",n[n.length-1].seriesModel),n.push(o)}}),e.each(cd)}),Ev("default",function(t,e){C(e=e||{},{text:"loading",textColor:"#000",fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#5470c6",spinnerRadius:10,lineWidth:5,zlevel:0});var i=new Fn,n=new hs({style:{fill:e.maskColor},zlevel:e.zlevel,z:1e4});i.add(n);var r,o=new fs({style:{text:e.text,fill:e.textColor,fontSize:e.fontSize,fontWeight:e.fontWeight,fontStyle:e.fontStyle,fontFamily:e.fontFamily},zlevel:e.zlevel,z:10001}),a=new hs({style:{fill:"none"},textContent:o,textConfig:{position:"right",distance:10},zlevel:e.zlevel,z:10001});return i.add(a),e.showSpinner&&((r=new wu({shape:{startAngle:-dm/2,endAngle:-dm/2+.1,r:e.spinnerRadius},style:{stroke:e.color,lineCap:"round",lineWidth:e.lineWidth},zlevel:e.zlevel,z:10001})).animateShape(!0).when(1e3,{endAngle:3*dm/2}).start("circularInOut"),r.animateShape(!0).when(1e3,{startAngle:3*dm/2}).delay(300).start("circularInOut"),i.add(r)),i.resize=function(){var i=o.getBoundingRect().width,s=e.showSpinner?e.spinnerRadius:0,l=(t.getWidth()-2*s-(e.showSpinner&&i?10:0)-i)/2-(e.showSpinner&&i?0:5+i/2)+(e.showSpinner?0:i/2)+(i?0:s),u=t.getHeight()/2;e.showSpinner&&r.setShape({cx:l,cy:u}),a.setShape({x:l-s,y:u-s,width:2*s,height:2*s}),n.setShape({x:0,y:0,width:t.getWidth(),height:t.getHeight()})},i.resize(),i}),Mv({type:Es,event:Es,update:Es},mt),Mv({type:Ps,event:Ps,update:Ps},mt),Mv({type:Ls,event:Ls,update:Ls},mt),Mv({type:zs,event:zs,update:zs},mt),Mv({type:Os,event:Os,update:Os},mt),_v("light",Dm),_v("dark",Om);var zv=[],Ov={registerPreprocessor:xv,registerProcessor:bv,registerPostInit:wv,registerPostUpdate:Sv,registerUpdateLifecycle:Tv,registerAction:Mv,registerCoordinateSystem:Iv,registerLayout:Cv,registerVisual:Av,registerTransform:Lv,registerLoading:Ev,registerMap:Pv,PRIORITY:Cy,ComponentModel:ip,ComponentView:$f,SeriesModel:Of,ChartView:Zf,registerComponentModel:function(t){ip.registerClass(t)},registerComponentView:function(t){$f.registerClass(t)},registerSeriesModel:function(t){Of.registerClass(t)},registerChartView:function(t){Zf.registerClass(t)},registerSubTypeDefaulter:function(t,e){ip.registerSubTypeDefaulter(t,e)},registerPainter:function(t,e){Hn(t,e)}};function Rv(t){U(t)?L(t,function(t){Rv(t)}):k(zv,t)>=0||(zv.push(t),G(t)&&(t={install:t}),t.install(Ov))}function Bv(t){return null==t?0:t.length||1}function Nv(t){return t}var Fv=function(){function t(t,e,i,n,r,o){this._old=t,this._new=e,this._oldKeyGetter=i||Nv,this._newKeyGetter=n||Nv,this.context=r,this._diffModeMultiple="multiple"===o}return t.prototype.add=function(t){return this._add=t,this},t.prototype.update=function(t){return this._update=t,this},t.prototype.updateManyToOne=function(t){return this._updateManyToOne=t,this},t.prototype.updateOneToMany=function(t){return this._updateOneToMany=t,this},t.prototype.updateManyToMany=function(t){return this._updateManyToMany=t,this},t.prototype.remove=function(t){return this._remove=t,this},t.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},t.prototype._executeOneToOne=function(){var t=this._old,e=this._new,i={},n=Array(t.length),r=Array(e.length);this._initIndexMap(t,null,n,"_oldKeyGetter"),this._initIndexMap(e,i,r,"_newKeyGetter");for(var o=0;o<t.length;o++){var a=n[o],s=i[a],l=Bv(s);if(l>1){var u=s.shift();1===s.length&&(i[a]=s[0]),this._update&&this._update(u,o)}else 1===l?(i[a]=null,this._update&&this._update(s,o)):this._remove&&this._remove(o)}this._performRestAdd(r,i)},t.prototype._executeMultiple=function(){var t=this._old,e=this._new,i={},n={},r=[],o=[];this._initIndexMap(t,i,r,"_oldKeyGetter"),this._initIndexMap(e,n,o,"_newKeyGetter");for(var a=0;a<r.length;a++){var s=r[a],l=i[s],u=n[s],c=Bv(l),h=Bv(u);if(c>1&&1===h)this._updateManyToOne&&this._updateManyToOne(u,l),n[s]=null;else if(1===c&&h>1)this._updateOneToMany&&this._updateOneToMany(u,l),n[s]=null;else if(1===c&&1===h)this._update&&this._update(u,l),n[s]=null;else if(c>1&&h>1)this._updateManyToMany&&this._updateManyToMany(u,l),n[s]=null;else if(c>1)for(var p=0;p<c;p++)this._remove&&this._remove(l[p]);else this._remove&&this._remove(l)}this._performRestAdd(o,n)},t.prototype._performRestAdd=function(t,e){for(var i=0;i<t.length;i++){var n=t[i],r=e[n],o=Bv(r);if(o>1)for(var a=0;a<o;a++)this._add&&this._add(r[a]);else 1===o&&this._add&&this._add(r);e[n]=null}},t.prototype._initIndexMap=function(t,e,i,n){for(var r=this._diffModeMultiple,o=0;o<t.length;o++){var a="_ec_"+this[n](t[o],o);if(r||(i[o]=a),e){var s=e[a],l=Bv(s);0===l?(e[a]=o,r&&i.push(a)):1===l?e[a]=[s,o]:s.push(o)}}},t}(),Vv=function(){function t(t,e){this._encode=t,this._schema=e}return t.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},t.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},t}();function Uv(t,e){return t.hasOwnProperty(e)||(t[e]=[]),t[e]}function Gv(t){return"category"===t?"ordinal":"time"===t?"time":"float"}var $v=function(t){this.otherDims={},null!=t&&I(this,t)},Wv=zr(),Hv={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},jv=function(){function t(t){this.dimensions=t.dimensions,this._dimOmitted=t.dimensionOmitted,this.source=t.source,this._fullDimCount=t.fullDimensionCount,this._updateDimOmitted(t.dimensionOmitted)}return t.prototype.isDimensionOmitted=function(){return this._dimOmitted},t.prototype._updateDimOmitted=function(t){this._dimOmitted=t,t&&(this._dimNameMap||(this._dimNameMap=Xv(this.source)))},t.prototype.getSourceDimensionIndex=function(t){return et(this._dimNameMap.get(t),-1)},t.prototype.getSourceDimension=function(t){var e=this.source.dimensionsDefine;if(e)return e[t]},t.prototype.makeStoreSchema=function(){for(var t=this._fullDimCount,e=Sd(this.source),i=!Yv(t),n="",r=[],o=0,a=0;o<t;o++){var s=void 0,l=void 0,u=void 0,c=this.dimensions[a];if(c&&c.storeDimIndex===o)s=e?c.name:null,l=c.type,u=c.ordinalMeta,a++;else{var h=this.getSourceDimension(o);h&&(s=e?h.name:null,l=h.type)}r.push({property:s,type:l,ordinalMeta:u}),!e||null==s||c&&c.isCalculationCoord||(n+=i?s.replace(/\`/g,"`1").replace(/\$/g,"`2"):s),n+="$",n+=Hv[l]||"f",u&&(n+=u.uid),n+="$"}var p=this.source;return{dimensions:r,hash:[p.seriesLayoutBy,p.startIndex,n].join("$$")}},t.prototype.makeOutputDimensionNames=function(){for(var t=[],e=0,i=0;e<this._fullDimCount;e++){var n=void 0,r=this.dimensions[i];if(r&&r.storeDimIndex===e)r.isCalculationCoord||(n=r.name),i++;else{var o=this.getSourceDimension(e);o&&(n=o.name)}t.push(n)}return t},t.prototype.appendCalculationDimension=function(t){this.dimensions.push(t),t.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},t}();function Zv(t){return t instanceof jv}function qv(t){for(var e=ht(),i=0;i<(t||[]).length;i++){var n=t[i],r=j(n)?n.name:n;null!=r&&null==e.get(r)&&e.set(r,i)}return e}function Xv(t){var e=Wv(t);return e.dimNameMap||(e.dimNameMap=qv(t.dimensionsDefine))}function Yv(t){return t>30}var Kv,Jv,Qv,t_,e_,i_,n_,r_=j,o_=z,a_="undefined"==typeof Int32Array?Array:Int32Array,s_=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],l_=["_approximateExtent"],u_=function(){function t(t,e){var i;this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","lttbDownSample"];var n=!1;Zv(t)?(i=t.dimensions,this._dimOmitted=t.isDimensionOmitted(),this._schema=t):(n=!0,i=t),i=i||["x","y"];for(var r={},o=[],a={},s=!1,l={},u=0;u<i.length;u++){var c=i[u],h=$(c)?new $v({name:c}):c instanceof $v?c:new $v(c),p=h.name;h.type=h.type||"float",h.coordDim||(h.coordDim=p,h.coordDimIndex=0);var d=h.otherDims=h.otherDims||{};o.push(p),r[p]=h,null!=l[p]&&(s=!0),h.createInvertedIndices&&(a[p]=[]),0===d.itemName&&(this._nameDimIdx=u),0===d.itemId&&(this._idDimIdx=u),n&&(h.storeDimIndex=u)}if(this.dimensions=o,this._dimInfos=r,this._initGetDimensionInfo(s),this.hostModel=e,this._invertedIndicesMap=a,this._dimOmitted){var f=this._dimIdxToName=ht();L(o,function(t){f.set(r[t].storeDimIndex,t)})}}return t.prototype.getDimension=function(t){var e=this._recognizeDimIndex(t);if(null==e)return t;if(e=t,!this._dimOmitted)return this.dimensions[e];var i=this._dimIdxToName.get(e);if(null!=i)return i;var n=this._schema.getSourceDimension(e);return n?n.name:void 0},t.prototype.getDimensionIndex=function(t){var e=this._recognizeDimIndex(t);if(null!=e)return e;if(null==t)return-1;var i=this._getDimInfo(t);return i?i.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(t):-1},t.prototype._recognizeDimIndex=function(t){if("number"==typeof t||null!=t&&!isNaN(t)&&!this._getDimInfo(t)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(t)<0))return+t},t.prototype._getStoreDimIndex=function(t){var e;return this.getDimensionIndex(t)},t.prototype.getDimensionInfo=function(t){return this._getDimInfo(this.getDimension(t))},t.prototype._initGetDimensionInfo=function(t){var e=this._dimInfos;this._getDimInfo=t?function(t){return e.hasOwnProperty(t)?e[t]:void 0}:function(t){return e[t]}},t.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},t.prototype.mapDimension=function(t,e){var i=this._dimSummary;if(null==e)return i.encodeFirstDimNotExtra[t];var n=i.encode[t];return n?n[e]:null},t.prototype.mapDimensionsAll=function(t){return(this._dimSummary.encode[t]||[]).slice()},t.prototype.getStore=function(){return this._store},t.prototype.initData=function(t,e,i){var n,r=this;if(t instanceof ff&&(n=t),!n){var o=this.dimensions,a=yd(t)||P(t)?new Td(t,o.length):t;n=new ff;var s=o_(o,function(t){return{type:r._dimInfos[t].type,property:t}});n.initData(a,s,i)}this._store=n,this._nameList=(e||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,n.count()),this._dimSummary=function(t,e){var i={},n=i.encode={},r=ht(),o=[],a=[],s={};L(t.dimensions,function(e){var i,l=t.getDimensionInfo(e),u=l.coordDim;if(u){var c=l.coordDimIndex;Uv(n,u)[c]=e,l.isExtraCoord||(r.set(u,1),"ordinal"!==(i=l.type)&&"time"!==i&&(o[0]=e),Uv(s,u)[c]=t.getDimensionIndex(l.name)),l.defaultTooltip&&a.push(e)}ap.each(function(t,e){var i=Uv(n,e),r=l.otherDims[e];null!=r&&!1!==r&&(i[r]=l.name)})});var l=[],u={};r.each(function(t,e){var i=n[e];u[e]=i[0],l=l.concat(i)}),i.dataDimsOnCoord=l,i.dataDimIndicesOnCoord=z(l,function(e){return t.getDimensionInfo(e).storeDimIndex}),i.encodeFirstDimNotExtra=u;var c=n.label;c&&c.length&&(o=c.slice());var h=n.tooltip;return h&&h.length?a=h.slice():a.length||(a=o.slice()),n.defaultedLabel=o,n.defaultedTooltip=a,i.userOutput=new Vv(s,e),i}(this,this._schema),this.userOutput=this._dimSummary.userOutput},t.prototype.appendData=function(t){var e=this._store.appendData(t);this._doInit(e[0],e[1])},t.prototype.appendValues=function(t,e){var i=this._store.appendValues(t,e.length),n=i.start,r=i.end,o=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),e)for(var a=n;a<r;a++){var s=a-n;this._nameList[a]=e[s],o&&n_(this,a)}},t.prototype._updateOrdinalMeta=function(){for(var t=this._store,e=this.dimensions,i=0;i<e.length;i++){var n=this._dimInfos[e[i]];n.ordinalMeta&&t.collectOrdinalMeta(n.storeDimIndex,n.ordinalMeta)}},t.prototype._shouldMakeIdFromName=function(){var t=this._store.getProvider();return null==this._idDimIdx&&t.getSource().sourceFormat!==hp&&!t.fillStorage},t.prototype._doInit=function(t,e){if(!(t>=e)){var i=this._store.getProvider();this._updateOrdinalMeta();var n=this._nameList,r=this._idList;if(i.getSource().sourceFormat===sp&&!i.pure)for(var o=[],a=t;a<e;a++){var s=i.getItem(a,o);if(!this.hasItemOption&&Ir(s)&&(this.hasItemOption=!0),s){var l=s.name;null==n[a]&&null!=l&&(n[a]=Dr(l,null));var u=s.id;null==r[a]&&null!=u&&(r[a]=Dr(u,null))}}if(this._shouldMakeIdFromName())for(a=t;a<e;a++)n_(this,a);Kv(this)}},t.prototype.getApproximateExtent=function(t){return this._approximateExtent[t]||this._store.getDataExtent(this._getStoreDimIndex(t))},t.prototype.setApproximateExtent=function(t,e){e=this.getDimension(e),this._approximateExtent[e]=t.slice()},t.prototype.getCalculationInfo=function(t){return this._calculationInfo[t]},t.prototype.setCalculationInfo=function(t,e){r_(t)?I(this._calculationInfo,t):this._calculationInfo[t]=e},t.prototype.getName=function(t){var e=this.getRawIndex(t),i=this._nameList[e];return null==i&&null!=this._nameDimIdx&&(i=Qv(this,this._nameDimIdx,e)),null==i&&(i=""),i},t.prototype._getCategory=function(t,e){var i=this._store.get(t,e),n=this._store.getOrdinalMeta(t);return n?n.categories[i]:i},t.prototype.getId=function(t){return Jv(this,this.getRawIndex(t))},t.prototype.count=function(){return this._store.count()},t.prototype.get=function(t,e){var i=this._store,n=this._dimInfos[t];if(n)return i.get(n.storeDimIndex,e)},t.prototype.getByRawIndex=function(t,e){var i=this._store,n=this._dimInfos[t];if(n)return i.getByRawIndex(n.storeDimIndex,e)},t.prototype.getIndices=function(){return this._store.getIndices()},t.prototype.getDataExtent=function(t){return this._store.getDataExtent(this._getStoreDimIndex(t))},t.prototype.getSum=function(t){return this._store.getSum(this._getStoreDimIndex(t))},t.prototype.getMedian=function(t){return this._store.getMedian(this._getStoreDimIndex(t))},t.prototype.getValues=function(t,e){var i=this,n=this._store;return U(t)?n.getValues(o_(t,function(t){return i._getStoreDimIndex(t)}),e):n.getValues(t)},t.prototype.hasValue=function(t){for(var e=this._dimSummary.dataDimIndicesOnCoord,i=0,n=e.length;i<n;i++)if(isNaN(this._store.get(e[i],t)))return!1;return!0},t.prototype.indexOfName=function(t){for(var e=0,i=this._store.count();e<i;e++)if(this.getName(e)===t)return e;return-1},t.prototype.getRawIndex=function(t){return this._store.getRawIndex(t)},t.prototype.indexOfRawIndex=function(t){return this._store.indexOfRawIndex(t)},t.prototype.rawIndexOf=function(t,e){var i,n=(t&&this._invertedIndicesMap[t])[e];return null==n||isNaN(n)?-1:n},t.prototype.indicesOfNearest=function(t,e,i){return this._store.indicesOfNearest(this._getStoreDimIndex(t),e,i)},t.prototype.each=function(t,e,i){"function"==typeof t&&(i=e,e=t,t=[]);var n=i||this,r=o_(t_(t),this._getStoreDimIndex,this);this._store.each(r,n?F(e,n):e)},t.prototype.filterSelf=function(t,e,i){"function"==typeof t&&(i=e,e=t,t=[]);var n=i||this,r=o_(t_(t),this._getStoreDimIndex,this);return this._store=this._store.filter(r,n?F(e,n):e),this},t.prototype.selectRange=function(t){var e=this,i={};return L(N(t),function(n){var r=e._getStoreDimIndex(n);i[r]=t[n]}),this._store=this._store.selectRange(i),this},t.prototype.mapArray=function(t,e,i){"function"==typeof t&&(i=e,e=t,t=[]),i=i||this;var n=[];return this.each(t,function(){n.push(e&&e.apply(this,arguments))},i),n},t.prototype.map=function(t,e,i,n){var r=i||n||this,o=o_(t_(t),this._getStoreDimIndex,this),a=i_(this);return a._store=this._store.map(o,r?F(e,r):e),a},t.prototype.modify=function(t,e,i,n){var r=i||n||this,o=o_(t_(t),this._getStoreDimIndex,this);this._store.modify(o,r?F(e,r):e)},t.prototype.downSample=function(t,e,i,n){var r=i_(this);return r._store=this._store.downSample(this._getStoreDimIndex(t),e,i,n),r},t.prototype.lttbDownSample=function(t,e){var i=i_(this);return i._store=this._store.lttbDownSample(this._getStoreDimIndex(t),e),i},t.prototype.getRawDataItem=function(t){return this._store.getRawDataItem(t)},t.prototype.getItemModel=function(t){var e=this.hostModel,i=this.getRawDataItem(t);return new $c(i,e,e&&e.ecModel)},t.prototype.diff=function(t){var e=this;return new Fv(t?t.getStore().getIndices():[],this.getStore().getIndices(),function(e){return Jv(t,e)},function(t){return Jv(e,t)})},t.prototype.getVisual=function(t){var e=this._visual;return e&&e[t]},t.prototype.setVisual=function(t,e){this._visual=this._visual||{},r_(t)?I(this._visual,t):this._visual[t]=e},t.prototype.getItemVisual=function(t,e){var i=this._itemVisuals[t],n=i&&i[e];return null==n?this.getVisual(e):n},t.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},t.prototype.ensureUniqueItemVisual=function(t,e){var i=this._itemVisuals,n=i[t];n||(n=i[t]={});var r=n[e];return null==r&&(U(r=this.getVisual(e))?r=r.slice():r_(r)&&(r=I({},r)),n[e]=r),r},t.prototype.setItemVisual=function(t,e,i){var n=this._itemVisuals[t]||{};this._itemVisuals[t]=n,r_(e)?I(n,e):n[e]=i},t.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},t.prototype.setLayout=function(t,e){if(r_(t))for(var i in t)t.hasOwnProperty(i)&&this.setLayout(i,t[i]);else this._layout[t]=e},t.prototype.getLayout=function(t){return this._layout[t]},t.prototype.getItemLayout=function(t){return this._itemLayouts[t]},t.prototype.setItemLayout=function(t,e,i){this._itemLayouts[t]=i?I(this._itemLayouts[t]||{},e):e},t.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},t.prototype.setItemGraphicEl=function(t,e){var i=this.hostModel&&this.hostModel.seriesIndex;Ts(i,this.dataType,t,e),this._graphicEls[t]=e},t.prototype.getItemGraphicEl=function(t){return this._graphicEls[t]},t.prototype.eachItemGraphicEl=function(t,e){L(this._graphicEls,function(i,n){i&&t&&t.call(e,i,n)})},t.prototype.cloneShallow=function(e){return e||(e=new t(this._schema?this._schema:o_(this.dimensions,this._getDimInfo,this),this.hostModel)),e_(e,this),e._store=this._store,e},t.prototype.wrapMethod=function(t,e){var i=this[t];"function"==typeof i&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(t),this[t]=function(){var t=i.apply(this,arguments);return e.apply(this,[t].concat(nt(arguments)))})},t.internalField=(Kv=function(t){var e=t._invertedIndicesMap;L(e,function(i,n){var r=t._dimInfos[n],o=r.ordinalMeta,a=t._store;if(o){i=e[n]=new a_(o.categories.length);for(var s=0;s<i.length;s++)i[s]=-1;for(s=0;s<a.count();s++)i[a.get(r.storeDimIndex,s)]=s}})},Qv=function(t,e,i){return Dr(t._getCategory(e,i),null)},Jv=function(t,e){var i=t._idList[e];return null==i&&null!=t._idDimIdx&&(i=Qv(t,t._idDimIdx,e)),null==i&&(i="e\0\0"+e),i},t_=function(t){return U(t)||(t=null!=t?[t]:[]),t},i_=function(e){var i=new t(e._schema?e._schema:o_(e.dimensions,e._getDimInfo,e),e.hostModel);return e_(i,e),i},e_=function(t,e){L(s_.concat(e.__wrappedMethods||[]),function(i){e.hasOwnProperty(i)&&(t[i]=e[i])}),t.__wrappedMethods=e.__wrappedMethods,L(l_,function(i){t[i]=S(e[i])}),t._calculationInfo=I({},e._calculationInfo)},void(n_=function(t,e){var i=t._nameList,n=t._idList,r=t._nameDimIdx,o=t._idDimIdx,a=i[e],s=n[e];if(null==a&&null!=r&&(i[e]=a=Qv(t,r,e)),null==s&&null!=o&&(n[e]=s=Qv(t,o,e)),null==s&&null!=a){var l=t._nameRepeatCount,u=l[a]=(l[a]||0)+1;s=a,u>1&&(s+="__ec__"+u),n[e]=s}})),t}();function c_(t,e){yd(t)||(t=_d(t));var i=(e=e||{}).coordDimensions||[],n=e.dimensionsDefine||t.dimensionsDefine||[],r=ht(),o=[],a=function(t,e,i,n){var r=Math.max(t.dimensionsDetectedCount||1,e.length,i.length,n||0);return L(e,function(t){var e;j(t)&&(e=t.dimsDef)&&(r=Math.max(r,e.length))}),r}(t,i,n,e.dimensionsCount),s=e.canOmitUnusedDimensions&&Yv(a),l=n===t.dimensionsDefine,u=l?Xv(t):qv(n),c=e.encodeDefine;!c&&e.encodeDefaulter&&(c=e.encodeDefaulter(t,a));for(var h=ht(c),p=new uf(a),d=0;d<p.length;d++)p[d]=-1;function f(t){var e=p[t];if(e<0){var i=n[t],r=j(i)?i:{name:i},a=new $v,s=r.name;null!=s&&null!=u.get(s)&&(a.name=a.displayName=s),null!=r.type&&(a.type=r.type),null!=r.displayName&&(a.displayName=r.displayName);var l=o.length;return p[t]=l,a.storeDimIndex=t,o.push(a),a}return o[e]}if(!s)for(d=0;d<a;d++)f(d);h.each(function(t,e){var i=wr(t).slice();if(1===i.length&&!$(i[0])&&i[0]<0)h.set(e,!1);else{var n=h.set(e,[]);L(i,function(t,i){var r=$(t)?u.get(t):t;null!=r&&r<a&&(n[i]=r,g(f(r),e,i))})}});var m=0;function g(t,e,i){null!=ap.get(e)?t.otherDims[e]=i:(t.coordDim=e,t.coordDimIndex=i,r.set(e,!0))}L(i,function(t){var e,i,n,r;if($(t))e=t,r={};else{e=(r=t).name;var o=r.ordinalMeta;r.ordinalMeta=null,(r=I({},r)).ordinalMeta=o,i=r.dimsDef,n=r.otherDims,r.name=r.coordDim=r.coordDimIndex=r.dimsDef=r.otherDims=null}var s=h.get(e);if(!1!==s){if(!(s=wr(s)).length)for(var u=0;u<(i&&i.length||1);u++){for(;m<a&&null!=f(m).coordDim;)m++;m<a&&s.push(m++)}L(s,function(t,o){var a=f(t);if(l&&null!=r.type&&(a.type=r.type),g(C(a,r),e,o),null==a.name&&i){var s=i[o];!j(s)&&(s={name:s}),a.name=a.displayName=s.name,a.defaultTooltip=s.defaultTooltip}n&&C(a.otherDims,n)})}});var y=e.generateCoord,v=e.generateCoordCount,_=null!=v;v=y?v||1:0;var x=y||"value";function b(t){null==t.name&&(t.name=t.coordDim)}if(s)L(o,function(t){b(t)}),o.sort(function(t,e){return t.storeDimIndex-e.storeDimIndex});else for(var w=0;w<a;w++){var S=f(w);null==S.coordDim&&(S.coordDim=h_(x,r,_),S.coordDimIndex=0,(!y||v<=0)&&(S.isExtraCoord=!0),v--),b(S),null!=S.type||wp(t,w)!==mp&&(!S.isExtraCoord||null==S.otherDims.itemName&&null==S.otherDims.seriesName)||(S.type="ordinal")}return function(t){for(var e=ht(),i=0;i<t.length;i++){var n=t[i],r=n.name,o=e.get(r)||0;o>0&&(n.name=r+(o-1)),o++,e.set(r,o)}}(o),new jv({source:t,dimensions:o,fullDimensionCount:a,dimensionOmitted:s})}function h_(t,e,i){var n=e.data;if(i||n.hasOwnProperty(t)){for(var r=0;n.hasOwnProperty(t+r);)r++;t+=r}return e.set(t,!0),t}var p_=function(t){this.coordSysDims=[],this.axisMap=ht(),this.categoryAxisMap=ht(),this.coordSysName=t},d_={cartesian2d:function(t,e,i,n){var r=t.getReferringComponents("xAxis",Nr).models[0],o=t.getReferringComponents("yAxis",Nr).models[0];e.coordSysDims=["x","y"],i.set("x",r),i.set("y",o),f_(r)&&(n.set("x",r),e.firstCategoryDimIndex=0),f_(o)&&(n.set("y",o),null==e.firstCategoryDimIndex&&(e.firstCategoryDimIndex=1))},singleAxis:function(t,e,i,n){var r=t.getReferringComponents("singleAxis",Nr).models[0];e.coordSysDims=["single"],i.set("single",r),f_(r)&&(n.set("single",r),e.firstCategoryDimIndex=0)},polar:function(t,e,i,n){var r=t.getReferringComponents("polar",Nr).models[0],o=r.findAxisModel("radiusAxis"),a=r.findAxisModel("angleAxis");e.coordSysDims=["radius","angle"],i.set("radius",o),i.set("angle",a),f_(o)&&(n.set("radius",o),e.firstCategoryDimIndex=0),f_(a)&&(n.set("angle",a),null==e.firstCategoryDimIndex&&(e.firstCategoryDimIndex=1))},geo:function(t,e,i,n){e.coordSysDims=["lng","lat"]},parallel:function(t,e,i,n){var r=t.ecModel,o=r.getComponent("parallel",t.get("parallelIndex")),a=e.coordSysDims=o.dimensions.slice();L(o.parallelAxisIndex,function(t,o){var s=r.getComponent("parallelAxis",t),l=a[o];i.set(l,s),f_(s)&&(n.set(l,s),null==e.firstCategoryDimIndex&&(e.firstCategoryDimIndex=o))})}};function f_(t){return"category"===t.get("type")}function m_(t,e,i){var n,r,o,a=(i=i||{}).byIndex,s=i.stackedCoordDimension;!function(t){return!Zv(t.schema)}(e)?(r=e.schema,n=r.dimensions,o=e.store):n=e;var l,u,c,h,p=!(!t||!t.get("stack"));if(L(n,function(t,e){$(t)&&(n[e]=t={name:t}),p&&!t.isExtraCoord&&(a||l||!t.ordinalMeta||(l=t),u||"ordinal"===t.type||"time"===t.type||s&&s!==t.coordDim||(u=t))}),!u||a||l||(a=!0),u){c="__\0ecstackresult_"+t.id,h="__\0ecstackedover_"+t.id,l&&(l.createInvertedIndices=!0);var d=u.coordDim,f=u.type,m=0;L(n,function(t){t.coordDim===d&&m++});var g={name:c,coordDim:d,coordDimIndex:m,type:f,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:n.length},y={name:h,coordDim:h,coordDimIndex:m+1,type:f,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:n.length+1};r?(o&&(g.storeDimIndex=o.ensureCalculationDimension(h,f),y.storeDimIndex=o.ensureCalculationDimension(c,f)),r.appendCalculationDimension(g),r.appendCalculationDimension(y)):(n.push(g),n.push(y))}return{stackedDimension:u&&u.name,stackedByDimension:l&&l.name,isStackedByIndex:a,stackedOverDimension:h,stackResultDimension:c}}function g_(t,e){return!!e&&e===t.getCalculationInfo("stackedDimension")}function y_(t,e){return g_(t,e)?t.getCalculationInfo("stackResultDimension"):e}function v_(t,e,i){i=i||{};var n,r=e.getSourceManager(),o=!1;t?(o=!0,n=_d(t)):o=(n=r.getSource()).sourceFormat===sp;var a=function(t){var e=t.get("coordinateSystem"),i=new p_(e),n=d_[e];if(n)return n(t,i,i.axisMap,i.categoryAxisMap),i}(e),s=function(t,e){var i,n=t.get("coordinateSystem"),r=Vp.get(n);return e&&e.coordSysDims&&(i=z(e.coordSysDims,function(t){var i={name:t},n=e.axisMap.get(t);if(n){var r=n.get("type");i.type=Gv(r)}return i})),i||(i=r&&(r.getDimensionsInfo?r.getDimensionsInfo():r.dimensions.slice())||["x","y"]),i}(e,a),l=i.useEncodeDefaulter,u=G(l)?l:l?V(_p,s,e):null,c=c_(n,{coordDimensions:s,generateCoord:i.generateCoord,encodeDefine:e.getEncode(),encodeDefaulter:u,canOmitUnusedDimensions:!o}),h=function(t,e,i){var n,r;return i&&L(t,function(t,o){var a=t.coordDim,s=i.categoryAxisMap.get(a);s&&(null==n&&(n=o),t.ordinalMeta=s.getOrdinalMeta(),e&&(t.createInvertedIndices=!0)),null!=t.otherDims.itemName&&(r=!0)}),r||null==n||(t[n].otherDims.itemName=0),n}(c.dimensions,i.createInvertedIndices,a),p=o?null:r.getSharedDataStore(c),d=m_(e,{schema:c,store:p}),f=new u_(c,e);f.setCalculationInfo(d);var m=null!=h&&function(t){if(t.sourceFormat===sp){var e=function(t){for(var e=0;e<t.length&&null==t[e];)e++;return t[e]}(t.data||[]);return null!=e&&!U(Mr(e))}}(n)?function(t,e,i,n){return n===h?i:this.defaultDimValueGetter(t,e,i,n)}:null;return f.hasItemOption=!1,f.initData(o?n:p,null,m),f}var __=function(){function t(t){this._setting=t||{},this._extent=[1/0,-1/0]}return t.prototype.getSetting=function(t){return this._setting[t]},t.prototype.unionExtent=function(t){var e=this._extent;t[0]<e[0]&&(e[0]=t[0]),t[1]>e[1]&&(e[1]=t[1])},t.prototype.unionExtentFromData=function(t,e){this.unionExtent(t.getApproximateExtent(e))},t.prototype.getExtent=function(){return this._extent.slice()},t.prototype.setExtent=function(t,e){var i=this._extent;isNaN(t)||(i[0]=t),isNaN(e)||(i[1]=e)},t.prototype.isInExtentRange=function(t){return this._extent[0]<=t&&this._extent[1]>=t},t.prototype.isBlank=function(){return this._isBlank},t.prototype.setBlank=function(t){this._isBlank=t},t}();Qr(__);var x_=0,b_=function(){function t(t){this.categories=t.categories||[],this._needCollect=t.needCollect,this._deduplication=t.deduplication,this.uid=++x_}return t.createByAxisModel=function(e){var i=e.option,n=i.data,r=n&&z(n,w_);return new t({categories:r,needCollect:!r,deduplication:!1!==i.dedplication})},t.prototype.getOrdinal=function(t){return this._getOrCreateMap().get(t)},t.prototype.parseAndCollect=function(t){var e,i=this._needCollect;if("string"!=typeof t&&!i)return t;if(i&&!this._deduplication)return e=this.categories.length,this.categories[e]=t,e;var n=this._getOrCreateMap();return null==(e=n.get(t))&&(i?(e=this.categories.length,this.categories[e]=t,n.set(t,e)):e=NaN),e},t.prototype._getOrCreateMap=function(){return this._map||(this._map=ht(this.categories))},t}();function w_(t){return j(t)&&null!=t.value?t.value:t+""}var S_=Yn;function T_(t,e,i,n){var r={},o=t[1]-t[0],a=r.interval=cr(o/e,!0);null!=i&&a<i&&(a=r.interval=i),null!=n&&a>n&&(a=r.interval=n);var s=r.intervalPrecision=M_(a);return function(t,e){!isFinite(t[0])&&(t[0]=e[0]),!isFinite(t[1])&&(t[1]=e[1]),I_(t,0,e),I_(t,1,e),t[0]>t[1]&&(t[0]=t[1])}(r.niceTickExtent=[S_(Math.ceil(t[0]/a)*a,s),S_(Math.floor(t[1]/a)*a,s)],t),r}function M_(t){return Jn(t)+2}function I_(t,e,i){t[e]=Math.max(Math.min(t[e],i[1]),i[0])}function C_(t,e){return t>=e[0]&&t<=e[1]}function A_(t,e){return e[1]===e[0]?.5:(t-e[0])/(e[1]-e[0])}function k_(t,e){return t*(e[1]-e[0])+e[0]}var D_=function(t){function e(e){var i=t.call(this,e)||this;i.type="ordinal";var n=i.getSetting("ordinalMeta");return n||(n=new b_({})),U(n)&&(n=new b_({categories:z(n,function(t){return j(t)?t.value:t})})),i._ordinalMeta=n,i._extent=i.getSetting("extent")||[0,n.categories.length-1],i}return i(e,t),e.prototype.parse=function(t){return"string"==typeof t?this._ordinalMeta.getOrdinal(t):Math.round(t)},e.prototype.contain=function(t){return C_(t=this.parse(t),this._extent)&&null!=this._ordinalMeta.categories[t]},e.prototype.normalize=function(t){return A_(t=this._getTickNumber(this.parse(t)),this._extent)},e.prototype.scale=function(t){return t=Math.round(k_(t,this._extent)),this.getRawOrdinalNumber(t)},e.prototype.getTicks=function(){for(var t=[],e=this._extent,i=e[0];i<=e[1];)t.push({value:i}),i++;return t},e.prototype.getMinorTicks=function(t){},e.prototype.setSortInfo=function(t){if(null!=t){for(var e=t.ordinalNumbers,i=this._ordinalNumbersByTick=[],n=this._ticksByOrdinalNumber=[],r=0,o=this._ordinalMeta.categories.length,a=Math.min(o,e.length);r<a;++r){var s=e[r];i[r]=s,n[s]=r}for(var l=0;r<o;++r){for(;null!=n[l];)l++;i.push(l),n[l]=r}}else this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null},e.prototype._getTickNumber=function(t){var e=this._ticksByOrdinalNumber;return e&&t>=0&&t<e.length?e[t]:t},e.prototype.getRawOrdinalNumber=function(t){var e=this._ordinalNumbersByTick;return e&&t>=0&&t<e.length?e[t]:t},e.prototype.getLabel=function(t){if(!this.isBlank()){var e=this.getRawOrdinalNumber(t.value),i=this._ordinalMeta.categories[e];return null==i?"":i+""}},e.prototype.count=function(){return this._extent[1]-this._extent[0]+1},e.prototype.unionExtentFromData=function(t,e){this.unionExtent(t.getApproximateExtent(e))},e.prototype.isInExtentRange=function(t){return t=this._getTickNumber(t),this._extent[0]<=t&&this._extent[1]>=t},e.prototype.getOrdinalMeta=function(){return this._ordinalMeta},e.prototype.niceTicks=function(){},e.prototype.niceExtent=function(){},e.type="ordinal",e}(__);__.registerClass(D_);var E_=Yn,P_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="interval",e._interval=0,e._intervalPrecision=2,e}return i(e,t),e.prototype.parse=function(t){return t},e.prototype.contain=function(t){return C_(t,this._extent)},e.prototype.normalize=function(t){return A_(t,this._extent)},e.prototype.scale=function(t){return k_(t,this._extent)},e.prototype.setExtent=function(t,e){var i=this._extent;isNaN(t)||(i[0]=parseFloat(t)),isNaN(e)||(i[1]=parseFloat(e))},e.prototype.unionExtent=function(t){var e=this._extent;t[0]<e[0]&&(e[0]=t[0]),t[1]>e[1]&&(e[1]=t[1]),this.setExtent(e[0],e[1])},e.prototype.getInterval=function(){return this._interval},e.prototype.setInterval=function(t){this._interval=t,this._niceExtent=this._extent.slice(),this._intervalPrecision=M_(t)},e.prototype.getTicks=function(t){var e=this._interval,i=this._extent,n=this._niceExtent,r=this._intervalPrecision,o=[];if(!e)return o;i[0]<n[0]&&(t?o.push({value:E_(n[0]-e,r)}):o.push({value:i[0]}));for(var a=n[0];a<=n[1]&&(o.push({value:a}),(a=E_(a+e,r))!==o[o.length-1].value);)if(o.length>1e4)return[];var s=o.length?o[o.length-1].value:n[1];return i[1]>s&&(t?o.push({value:E_(s+e,r)}):o.push({value:i[1]})),o},e.prototype.getMinorTicks=function(t){for(var e=this.getTicks(!0),i=[],n=this.getExtent(),r=1;r<e.length;r++){for(var o=e[r],a=e[r-1],s=0,l=[],u=(o.value-a.value)/t;s<t-1;){var c=E_(a.value+(s+1)*u);c>n[0]&&c<n[1]&&l.push(c),s++}i.push(l)}return i},e.prototype.getLabel=function(t,e){if(null==t)return"";var i=e&&e.precision;return null==i?i=Jn(t.value)||0:"auto"===i&&(i=this._intervalPrecision),Eh(E_(t.value,i,!0))},e.prototype.niceTicks=function(t,e,i){t=t||5;var n=this._extent,r=n[1]-n[0];if(isFinite(r)){r<0&&(r=-r,n.reverse());var o=T_(n,t,e,i);this._intervalPrecision=o.intervalPrecision,this._interval=o.interval,this._niceExtent=o.niceTickExtent}},e.prototype.niceExtent=function(t){var e=this._extent;if(e[0]===e[1])if(0!==e[0]){var i=e[0];t.fixMax||(e[1]+=i/2),e[0]-=i/2}else e[1]=1;var n=e[1]-e[0];isFinite(n)||(e[0]=0,e[1]=1),this.niceTicks(t.splitNumber,t.minInterval,t.maxInterval);var r=this._interval;t.fixMin||(e[0]=E_(Math.floor(e[0]/r)*r)),t.fixMax||(e[1]=E_(Math.ceil(e[1]/r)*r))},e.type="interval",e}(__);__.registerClass(P_);var L_="__ec_stack_",z_="undefined"!=typeof Float32Array?Float32Array:Array;function O_(t){return t.get("stack")||L_+t.seriesIndex}function R_(t){return t.dim+t.index}function B_(t,e){var i=[];return e.eachSeriesByType(t,function(t){$_(t)&&!W_(t)&&i.push(t)}),i}function N_(t){var e=function(t){var e={};L(t,function(t){var i=t.coordinateSystem.getBaseAxis();if("time"===i.type||"value"===i.type)for(var n=t.getData(),r=i.dim+"_"+i.index,o=n.getDimensionIndex(n.mapDimension(i.dim)),a=n.getStore(),s=0,l=a.count();s<l;++s){var u=a.get(o,s);e[r]?e[r].push(u):e[r]=[u]}});var i={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];if(r){r.sort(function(t,e){return t-e});for(var o=null,a=1;a<r.length;++a){var s=r[a]-r[a-1];s>0&&(o=null===o?s:Math.min(o,s))}i[n]=o}}return i}(t),i=[];return L(t,function(t){var n,r=t.coordinateSystem.getBaseAxis(),o=r.getExtent();if("category"===r.type)n=r.getBandWidth();else if("value"===r.type||"time"===r.type){var a=r.dim+"_"+r.index,s=e[a],l=Math.abs(o[1]-o[0]),u=r.scale.getExtent(),c=Math.abs(u[1]-u[0]);n=s?l/c*s:l}else{var h=t.getData();n=Math.abs(o[1]-o[0])/h.count()}var p=Xn(t.get("barWidth"),n),d=Xn(t.get("barMaxWidth"),n),f=Xn(t.get("barMinWidth")||1,n),m=t.get("barGap"),g=t.get("barCategoryGap");i.push({bandWidth:n,barWidth:p,barMaxWidth:d,barMinWidth:f,barGap:m,barCategoryGap:g,axisKey:R_(r),stackId:O_(t)})}),F_(i)}function F_(t){var e={};L(t,function(t,i){var n=t.axisKey,r=t.bandWidth,o=e[n]||{bandWidth:r,remainedWidth:r,autoWidthCount:0,categoryGap:null,gap:"20%",stacks:{}},a=o.stacks;e[n]=o;var s=t.stackId;a[s]||o.autoWidthCount++,a[s]=a[s]||{width:0,maxWidth:0};var l=t.barWidth;l&&!a[s].width&&(a[s].width=l,l=Math.min(o.remainedWidth,l),o.remainedWidth-=l);var u=t.barMaxWidth;u&&(a[s].maxWidth=u);var c=t.barMinWidth;c&&(a[s].minWidth=c);var h=t.barGap;null!=h&&(o.gap=h);var p=t.barCategoryGap;null!=p&&(o.categoryGap=p)});var i={};return L(e,function(t,e){i[e]={};var n=t.stacks,r=t.bandWidth,o=t.categoryGap;if(null==o){var a=N(n).length;o=Math.max(35-4*a,15)+"%"}var s=Xn(o,r),l=Xn(t.gap,1),u=t.remainedWidth,c=t.autoWidthCount,h=(u-s)/(c+(c-1)*l);h=Math.max(h,0),L(n,function(t){var e=t.maxWidth,i=t.minWidth;if(t.width)n=t.width,e&&(n=Math.min(n,e)),i&&(n=Math.max(n,i)),t.width=n,u-=n+l*n,c--;else{var n=h;e&&e<n&&(n=Math.min(e,u)),i&&i>n&&(n=i),n!==h&&(t.width=n,u-=n+l*n,c--)}}),h=Math.max(h=(u-s)/(c+(c-1)*l),0);var p,d=0;L(n,function(t,e){t.width||(t.width=h),p=t,d+=t.width*(1+l)}),p&&(d-=p.width*l);var f=-d/2;L(n,function(t,n){i[e][n]=i[e][n]||{bandWidth:r,offset:f,width:t.width},f+=t.width*(1+l)})}),i}function V_(t,e,i){if(t&&e){var n=t[R_(e)];return null!=n&&null!=i?n[O_(i)]:n}}function U_(t,e){var i=B_(t,e),n=N_(i),r={};L(i,function(t){var e=t.getData(),i=t.coordinateSystem,o=i.getBaseAxis(),a=O_(t),s=n[R_(o)][a],l=s.offset,u=s.width,c=i.getOtherAxis(o),h=t.get("barMinHeight")||0;r[a]=r[a]||[],e.setLayout({bandWidth:s.bandWidth,offset:l,size:u});for(var p=e.mapDimension(c.dim),d=e.mapDimension(o.dim),f=g_(e,p),m=c.isHorizontal(),g=H_(o,c),y=e.getStore(),v=e.getDimensionIndex(p),_=e.getDimensionIndex(d),x=0,b=y.count();x<b;x++){var w=y.get(v,x),S=y.get(_,x),T=w>=0?"p":"n",M=g;f&&(r[a][S]||(r[a][S]={p:g,n:g}),M=r[a][S][T]);var I,C=void 0,A=void 0,k=void 0,D=void 0;m?(C=M,A=(I=i.dataToPoint([w,S]))[1]+l,k=I[0]-g,D=u,Math.abs(k)<h&&(k=(k<0?-1:1)*h),isNaN(k)||f&&(r[a][S][T]+=k)):(C=(I=i.dataToPoint([S,w]))[0]+l,A=M,k=u,D=I[1]-g,Math.abs(D)<h&&(D=(D<=0?-1:1)*h),isNaN(D)||f&&(r[a][S][T]+=D)),e.setItemLayout(x,{x:C,y:A,width:k,height:D})}})}var G_={seriesType:"bar",plan:Wf(),reset:function(t){if($_(t)&&W_(t)){var e=t.getData(),i=t.coordinateSystem,n=i.master.getRect(),r=i.getBaseAxis(),o=i.getOtherAxis(r),a=e.getDimensionIndex(e.mapDimension(o.dim)),s=e.getDimensionIndex(e.mapDimension(r.dim)),l=o.isHorizontal(),u=l?0:1,c=V_(N_([t]),r,t).width;return c>.5||(c=.5),{progress:function(t,e){for(var h,p=t.count,d=new z_(2*p),f=new z_(2*p),m=new z_(p),g=[],y=[],v=0,_=0,x=e.getStore();null!=(h=t.next());)y[u]=x.get(a,h),y[1-u]=x.get(s,h),g=i.dataToPoint(y,null),f[v]=l?n.x+n.width:g[0],d[v++]=g[0],f[v]=l?g[1]:n.y+n.height,d[v++]=g[1],m[_++]=h;e.setLayout({largePoints:d,largeDataIndices:m,largeBackgroundPoints:f,barWidth:c,valueAxisStart:H_(r,o),backgroundStart:l?n.x:n.y,valueAxisHorizontal:l})}}}}};function $_(t){return t.coordinateSystem&&"cartesian2d"===t.coordinateSystem.type}function W_(t){return t.pipelineContext&&t.pipelineContext.large}function H_(t,e,i){return e.toGlobalCoord(e.dataToCoord("log"===e.type?1:0))}var j_=function(t){function e(e){var i=t.call(this,e)||this;return i.type="time",i}return i(e,t),e.prototype.getLabel=function(t){var e=this.getSetting("useUTC");return fh(t.value,lh[function(t){switch(t){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}(ph(this._minLevelUnit))]||lh.second,e,this.getSetting("locale"))},e.prototype.getFormattedLabel=function(t,e,i){var n=this.getSetting("useUTC");return function(t,e,i,n,r){var o=null;if("string"==typeof i)o=i;else if("function"==typeof i)o=i(t.value,e,{level:t.level});else{var a=I({},ah);if(t.level>0)for(var s=0;s<7;++s)a[uh[s]]="{primary|"+a[uh[s]]+"}";var l=i?!1===i.inherit?i:C(i,a):a,u=mh(t.value,r);if(l[u])o=l[u];else if(l.inherit){for(s=ch.indexOf(u)-1;s>=0;--s)if(l[u]){o=l[u];break}o=o||a.none}if(U(o)){var c=null==t.level?0:t.level>=0?t.level:o.length+t.level;o=o[c=Math.min(c,o.length-1)]}}return fh(new Date(t.value),o,r,n)}(t,e,i,this.getSetting("locale"),n)},e.prototype.getTicks=function(t){var e=this._interval,i=this._extent,n=[];if(!e)return n;n.push({value:i[0],level:0});var r=this.getSetting("useUTC"),o=function(t,e,i,n){var r=1e4,o=ch,a=0;function s(t,e,i,r,o,a,s){for(var l=new Date(e),u=e,c=l[r]();u<i&&u<=n[1];)s.push({value:u}),c+=t,l[o](c),u=l.getTime();s.push({value:u,notAdd:!0})}function l(t,r,o){var a=[],l=!r.length;if(!function(t,e,i,n){var r=sr(e),o=sr(i),a=function(t){return gh(r,t,n)===gh(o,t,n)},s=function(){return a("year")},l=function(){return s()&&a("month")},u=function(){return l()&&a("day")},c=function(){return u()&&a("hour")},h=function(){return c()&&a("minute")},p=function(){return h()&&a("second")},d=function(){return p()&&a("millisecond")};switch(t){case"year":return s();case"month":return l();case"day":return u();case"hour":return c();case"minute":return h();case"second":return p();case"millisecond":return d()}}(ph(t),n[0],n[1],i)){l&&(r=[{value:Q_(new Date(n[0]),t,i)},{value:n[1]}]);for(var u=0;u<r.length-1;u++){var c=r[u].value,h=r[u+1].value;if(c!==h){var p=void 0,d=void 0,f=void 0,m=!1;switch(t){case"year":p=Math.max(1,Math.round(e/rh/365)),d=yh(i),f=Th(i);break;case"half-year":case"quarter":case"month":p=X_(e),d=vh(i),f=Mh(i);break;case"week":case"half-week":case"day":p=q_(e),d=_h(i),f=Ih(i),m=!0;break;case"half-day":case"quarter-day":case"hour":p=Y_(e),d=xh(i),f=Ch(i);break;case"minute":p=K_(e,!0),d=bh(i),f=Ah(i);break;case"second":p=K_(e,!1),d=wh(i),f=kh(i);break;case"millisecond":p=J_(e),d=Sh(i),f=Dh(i)}s(p,c,h,d,f,m,a),"year"===t&&o.length>1&&0===u&&o.unshift({value:o[0].value-p})}}for(u=0;u<a.length;u++)o.push(a[u]);return a}}for(var u=[],c=[],h=0,p=0,d=0;d<o.length&&a++<r;++d){var f=ph(o[d]);if(dh(o[d])&&(l(o[d],u[u.length-1]||[],c),f!==(o[d+1]?ph(o[d+1]):null))){if(c.length){p=h,c.sort(function(t,e){return t.value-e.value});for(var m=[],g=0;g<c.length;++g){var y=c[g].value;0!==g&&c[g-1].value===y||(m.push(c[g]),y>=n[0]&&y<=n[1]&&h++)}var v=(n[1]-n[0])/e;if(h>1.5*v&&p>v/1.5)break;if(u.push(m),h>v||t===o[d])break}c=[]}}var _=R(z(u,function(t){return R(t,function(t){return t.value>=n[0]&&t.value<=n[1]&&!t.notAdd})}),function(t){return t.length>0}),x=[],b=_.length-1;for(d=0;d<_.length;++d)for(var w=_[d],S=0;S<w.length;++S)x.push({value:w[S].value,level:b-d});x.sort(function(t,e){return t.value-e.value});var T=[];for(d=0;d<x.length;++d)0!==d&&x[d].value===x[d-1].value||T.push(x[d]);return T}(this._minLevelUnit,this._approxInterval,r,i);return(n=n.concat(o)).push({value:i[1],level:0}),n},e.prototype.niceExtent=function(t){var e=this._extent;if(e[0]===e[1]&&(e[0]-=rh,e[1]+=rh),e[1]===-1/0&&e[0]===1/0){var i=new Date;e[1]=+new Date(i.getFullYear(),i.getMonth(),i.getDate()),e[0]=e[1]-rh}this.niceTicks(t.splitNumber,t.minInterval,t.maxInterval)},e.prototype.niceTicks=function(t,e,i){t=t||10;var n=this._extent,r=n[1]-n[0];this._approxInterval=r/t,null!=e&&this._approxInterval<e&&(this._approxInterval=e),null!=i&&this._approxInterval>i&&(this._approxInterval=i);var o=Z_.length,a=Math.min(function(t,e,i,n){for(;i<n;){var r=i+n>>>1;t[r][1]<e?i=r+1:n=r}return i}(Z_,this._approxInterval,0,o),o-1);this._interval=Z_[a][1],this._minLevelUnit=Z_[Math.max(a-1,0)][0]},e.prototype.parse=function(t){return"number"==typeof t?t:+sr(t)},e.prototype.contain=function(t){return C_(this.parse(t),this._extent)},e.prototype.normalize=function(t){return A_(this.parse(t),this._extent)},e.prototype.scale=function(t){return k_(t,this._extent)},e.type="time",e}(P_),Z_=[["second",eh],["minute",ih],["hour",nh],["quarter-day",216e5],["half-day",432e5],["day",10368e4],["half-week",3024e5],["week",6048e5],["month",26784e5],["quarter",8208e6],["half-year",oh/2],["year",oh]];function q_(t,e){return(t/=rh)>16?16:t>7.5?7:t>3.5?4:t>1.5?2:1}function X_(t){return(t/=2592e6)>6?6:t>3?3:t>2?2:1}function Y_(t){return(t/=nh)>12?12:t>6?6:t>3.5?4:t>2?2:1}function K_(t,e){return(t/=e?ih:eh)>30?30:t>20?20:t>15?15:t>10?10:t>5?5:t>2?2:1}function J_(t){return cr(t,!0)}function Q_(t,e,i){var n=new Date(t);switch(ph(e)){case"year":case"month":n[Mh(i)](0);case"day":n[Ih(i)](1);case"hour":n[Ch(i)](0);case"minute":n[Ah(i)](0);case"second":n[kh(i)](0),n[Dh(i)](0)}return n.getTime()}__.registerClass(j_);var tx=__.prototype,ex=P_.prototype,ix=Yn,nx=Math.floor,rx=Math.ceil,ox=Math.pow,ax=Math.log,sx=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="log",e.base=10,e._originalScale=new P_,e._interval=0,e}return i(e,t),e.prototype.getTicks=function(t){var e=this._originalScale,i=this._extent,n=e.getExtent();return z(ex.getTicks.call(this,t),function(t){var e=t.value,r=Yn(ox(this.base,e));return r=e===i[0]&&this._fixMin?ux(r,n[0]):r,{value:r=e===i[1]&&this._fixMax?ux(r,n[1]):r}},this)},e.prototype.setExtent=function(t,e){var i=this.base;t=ax(t)/ax(i),e=ax(e)/ax(i),ex.setExtent.call(this,t,e)},e.prototype.getExtent=function(){var t=this.base,e=tx.getExtent.call(this);e[0]=ox(t,e[0]),e[1]=ox(t,e[1]);var i=this._originalScale.getExtent();return this._fixMin&&(e[0]=ux(e[0],i[0])),this._fixMax&&(e[1]=ux(e[1],i[1])),e},e.prototype.unionExtent=function(t){this._originalScale.unionExtent(t);var e=this.base;t[0]=ax(t[0])/ax(e),t[1]=ax(t[1])/ax(e),tx.unionExtent.call(this,t)},e.prototype.unionExtentFromData=function(t,e){this.unionExtent(t.getApproximateExtent(e))},e.prototype.niceTicks=function(t){t=t||10;var e=this._extent,i=e[1]-e[0];if(!(i===1/0||i<=0)){var n=lr(i);for(t/i*n<=.5&&(n*=10);!isNaN(n)&&Math.abs(n)<1&&Math.abs(n)>0;)n*=10;var r=[Yn(rx(e[0]/n)*n),Yn(nx(e[1]/n)*n)];this._interval=n,this._niceExtent=r}},e.prototype.niceExtent=function(t){ex.niceExtent.call(this,t),this._fixMin=t.fixMin,this._fixMax=t.fixMax},e.prototype.parse=function(t){return t},e.prototype.contain=function(t){return C_(t=ax(t)/ax(this.base),this._extent)},e.prototype.normalize=function(t){return A_(t=ax(t)/ax(this.base),this._extent)},e.prototype.scale=function(t){return t=k_(t,this._extent),ox(this.base,t)},e.type="log",e}(__),lx=sx.prototype;function ux(t,e){return ix(t,Jn(e))}lx.getMinorTicks=ex.getMinorTicks,lx.getLabel=ex.getLabel,__.registerClass(sx);var cx=function(){function t(t,e,i){this._prepareParams(t,e,i)}return t.prototype._prepareParams=function(t,e,i){i[1]<i[0]&&(i=[NaN,NaN]),this._dataMin=i[0],this._dataMax=i[1];var n=this._isOrdinal="ordinal"===t.type;this._needCrossZero=e.getNeedCrossZero&&e.getNeedCrossZero();var r=this._modelMinRaw=e.get("min",!0);G(r)?this._modelMinNum=fx(t,r({min:i[0],max:i[1]})):"dataMin"!==r&&(this._modelMinNum=fx(t,r));var o=this._modelMaxRaw=e.get("max",!0);if(G(o)?this._modelMaxNum=fx(t,o({min:i[0],max:i[1]})):"dataMax"!==o&&(this._modelMaxNum=fx(t,o)),n)this._axisDataLen=e.getCategories().length;else{var a=e.get("boundaryGap"),s=U(a)?a:[a||0,a||0];"boolean"==typeof s[0]||"boolean"==typeof s[1]?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[Cn(s[0],1),Cn(s[1],1)]}},t.prototype.calculate=function(){var t=this._isOrdinal,e=this._dataMin,i=this._dataMax,n=this._axisDataLen,r=this._boundaryGapInner,o=t?null:i-e||Math.abs(e),a="dataMin"===this._modelMinRaw?e:this._modelMinNum,s="dataMax"===this._modelMaxRaw?i:this._modelMaxNum,l=null!=a,u=null!=s;null==a&&(a=t?n?0:NaN:e-r[0]*o),null==s&&(s=t?n?n-1:NaN:i+r[1]*o),(null==a||!isFinite(a))&&(a=NaN),(null==s||!isFinite(s))&&(s=NaN);var c=Q(a)||Q(s)||t&&!n;this._needCrossZero&&(a>0&&s>0&&!l&&(a=0),a<0&&s<0&&!u&&(s=0));var h=this._determinedMin,p=this._determinedMax;return null!=h&&(a=h,l=!0),null!=p&&(s=p,u=!0),{min:a,max:s,minFixed:l,maxFixed:u,isBlank:c}},t.prototype.modifyDataMinMax=function(t,e){this[px[t]]=e},t.prototype.setDeterminedMinMax=function(t,e){var i;this[hx[t]]=e},t.prototype.freeze=function(){this.frozen=!0},t}(),hx={min:"_determinedMin",max:"_determinedMax"},px={min:"_dataMin",max:"_dataMax"};function dx(t,e,i){var n=t.rawExtentInfo;return n||(n=new cx(t,e,i),t.rawExtentInfo=n,n)}function fx(t,e){return null==e?null:Q(e)?NaN:t.parse(e)}function mx(t,e){var i=t.type,n=dx(t,e,t.getExtent()).calculate();t.setBlank(n.isBlank);var r=n.min,o=n.max,a=e.ecModel;if(a&&"time"===i){var s=B_("bar",a),l=!1;if(L(s,function(t){l=l||t.getBaseAxis()===e.axis}),l){var u=N_(s),c=function(t,e,i,n){var r=i.axis.getExtent(),o=r[1]-r[0],a=V_(n,i.axis);if(void 0===a)return{min:t,max:e};var s=1/0;L(a,function(t){s=Math.min(t.offset,s)});var l=-1/0;L(a,function(t){l=Math.max(t.offset+t.width,l)});var u=(s=Math.abs(s))+(l=Math.abs(l)),c=e-t,h=c/(1-(s+l)/o)-c;return{min:t-=h*(s/u),max:e+=h*(l/u)}}(r,o,e,u);r=c.min,o=c.max}}return{extent:[r,o],fixMin:n.minFixed,fixMax:n.maxFixed}}function gx(t,e){var i=e,n=mx(t,i),r=n.extent,o=i.get("splitNumber");t instanceof sx&&(t.base=i.get("logBase"));var a=t.type;t.setExtent(r[0],r[1]),t.niceExtent({splitNumber:o,fixMin:n.fixMin,fixMax:n.fixMax,minInterval:"interval"===a||"time"===a?i.get("minInterval"):null,maxInterval:"interval"===a||"time"===a?i.get("maxInterval"):null});var s=i.get("interval");null!=s&&t.setInterval&&t.setInterval(s)}function yx(t,e){if(e=e||t.get("type"))switch(e){case"category":return new D_({ordinalMeta:t.getOrdinalMeta?t.getOrdinalMeta():t.getCategories(),extent:[1/0,-1/0]});case"time":return new j_({locale:t.ecModel.getLocaleModel(),useUTC:t.ecModel.get("useUTC")});default:return new(__.getClass(e)||P_)}}function vx(t){var e,i,n=t.getLabelModel().get("formatter"),r="category"===t.type?t.scale.getExtent()[0]:null;return"time"===t.scale.type?(i=n,function(e,n){return t.scale.getFormattedLabel(e,n,i)}):"string"==typeof n?function(e){return function(i){var n=t.scale.getLabel(i);return e.replace("{value}",null!=n?n:"")}}(n):"function"==typeof n?(e=n,function(i,n){return null!=r&&(n=i.value-r),e(_x(t,i),n,null!=i.level?{level:i.level}:null)}):function(e){return t.scale.getLabel(e)}}function _x(t,e){return"category"===t.type?t.scale.getLabel(e):e.value}function xx(t,e){var i=e*Math.PI/180,n=t.width,r=t.height,o=n*Math.abs(Math.cos(i))+Math.abs(r*Math.sin(i)),a=n*Math.abs(Math.sin(i))+Math.abs(r*Math.cos(i));return new yn(t.x,t.y,o,a)}function bx(t){var e=t.get("interval");return null==e?"auto":e}function Sx(t){return"category"===t.type&&0===bx(t.getLabelModel())}function Tx(t,e){var i={};return L(t.mapDimensionsAll(e),function(e){i[y_(t,e)]=!0}),N(i)}var Mx=function(){function t(){}return t.prototype.getNeedCrossZero=function(){return!this.option.scale},t.prototype.getCoordSysModel=function(){},t}(),Ix,Cx=Object.freeze({__proto__:null,createList:function(t){return v_(null,t)},getLayoutRect:Xh,dataStack:{isDimensionStacked:g_,enableDataStack:m_,getStackedDimension:y_},createScale:function(t,e){var i=e;e instanceof $c||(i=new $c(e));var n=yx(i);return n.setExtent(t[0],t[1]),gx(n,i),n},mixinAxisModelCommonMethods:function(t){E(t,Mx)},getECData:Ss,createTextStyle:function(t,e){return wc(t,null,null,"normal"!==(e=e||{}).state)},createDimensions:function(t,e){return c_(t,e).dimensions},createSymbol:eg,enableHoverEmphasis:pl}),Ax=Object.freeze({__proto__:null,linearMap:qn,round:Yn,asc:Kn,getPrecision:Jn,getPrecisionSafe:Qn,getPixelPrecision:tr,getPercentWithPrecision:er,MAX_SAFE_INTEGER:nr,remRadian:rr,isRadianAroundZero:or,parseDate:sr,quantity:lr,quantityExponent:ur,nice:cr,quantile:hr,reformIntervals:pr,isNumeric:fr,numericToNumber:dr}),kx=Object.freeze({__proto__:null,parse:sr,format:fh}),Dx=Object.freeze({__proto__:null,extendShape:Zu,extendPath:Xu,makePath:Ju,makeImage:Qu,mergePath:ec,resizePath:ic,createIcon:hc,updateProps:Bu,initProps:Nu,getTransform:rc,clipPointsByRect:uc,clipRectByRect:cc,registerShape:Yu,getShapeClass:Ku,Group:Fn,Image:rs,Text:fs,Circle:Gl,Ellipse:Wl,Sector:ou,Ring:su,Polygon:hu,Polyline:du,Rect:hs,Line:gu,BezierCurve:xu,Arc:wu,IncrementalDisplayable:Lu,CompoundPath:Su,LinearGradient:Mu,RadialGradient:Iu,BoundingRect:yn}),Ex=Object.freeze({__proto__:null,addCommas:Eh,toCamelCase:Ph,normalizeCssArray:Lh,encodeHTML:Rh,formatTpl:Vh,getTooltipMarker:Uh,formatTime:function(t,e,i){"week"!==t&&"month"!==t&&"quarter"!==t&&"half-year"!==t&&"year"!==t||(t="MM-dd\nyyyy");var n=sr(e),r=i?"UTC":"",o=n["get"+r+"FullYear"](),a=n["get"+r+"Month"]()+1,s=n["get"+r+"Date"](),l=n["get"+r+"Hours"](),u=n["get"+r+"Minutes"](),c=n["get"+r+"Seconds"](),h=n["get"+r+"Milliseconds"]();return t.replace("MM",hh(a,2)).replace("M",a).replace("yyyy",o).replace("yy",o%100+"").replace("dd",hh(s,2)).replace("d",s).replace("hh",hh(l,2)).replace("h",l).replace("mm",hh(u,2)).replace("m",u).replace("ss",hh(c,2)).replace("s",c).replace("SSS",hh(h,3))},capitalFirst:function(t){return t?t.charAt(0).toUpperCase()+t.substr(1):t},truncateText:uo,getTextRect:function(t,e,i,n,r,o,a,s){return new fs({style:{text:t,font:e,align:i,verticalAlign:n,padding:r,rich:o,overflow:a?"truncate":null,lineHeight:s}}).getBoundingRect()}}),Px=Object.freeze({__proto__:null,map:z,each:L,indexOf:k,inherits:D,reduce:O,filter:R,bind:F,curry:V,isArray:U,isString:$,isObject:j,isFunction:G,extend:I,defaults:C,clone:S,merge:T}),Lx=zr();function zx(t){return"category"===t.type?function(t){var e=t.getLabelModel(),i=Rx(t,e);return!e.get("show")||t.scale.isBlank()?{labels:[],labelCategoryInterval:i.labelCategoryInterval}:i}(t):function(t){var e=t.scale.getTicks(),i=vx(t);return{labels:z(e,function(e,n){return{level:e.level,formattedLabel:i(e,n),rawLabel:t.scale.getLabel(e),tickValue:e.value}})}}(t)}function Ox(t,e){return"category"===t.type?function(t,e){var i,n,r=Bx(t,"ticks"),o=bx(e),a=Nx(r,o);if(a)return a;if(e.get("show")&&!t.scale.isBlank()||(i=[]),G(o))i=Ux(t,o,!0);else if("auto"===o){var s=Rx(t,t.getLabelModel());n=s.labelCategoryInterval,i=z(s.labels,function(t){return t.tickValue})}else i=Vx(t,n=o,!0);return Fx(r,o,{ticks:i,tickCategoryInterval:n})}(t,e):{ticks:z(t.scale.getTicks(),function(t){return t.value})}}function Rx(t,e){var i,n,r=Bx(t,"labels"),o=bx(e),a;return Nx(r,o)||(G(o)?i=Ux(t,o):(n="auto"===o?function(t){var e=Lx(t).autoInterval;return null!=e?e:Lx(t).autoInterval=t.calculateCategoryInterval()}(t):o,i=Vx(t,n)),Fx(r,o,{labels:i,labelCategoryInterval:n}))}function Bx(t,e){return Lx(t)[e]||(Lx(t)[e]=[])}function Nx(t,e){for(var i=0;i<t.length;i++)if(t[i].key===e)return t[i].value}function Fx(t,e,i){return t.push({key:e,value:i}),i}function Vx(t,e,i){var n=vx(t),r=t.scale,o=r.getExtent(),a=t.getLabelModel(),s=[],l=Math.max((e||0)+1,1),u=o[0],c=r.count();0!==u&&l>1&&c/l>2&&(u=Math.round(Math.ceil(u/l)*l));var h=Sx(t),p=a.get("showMinLabel")||h,d=a.get("showMaxLabel")||h;p&&u!==o[0]&&m(o[0]);for(var f=u;f<=o[1];f+=l)m(f);function m(t){var e={value:t};s.push(i?t:{formattedLabel:n(e),rawLabel:r.getLabel(e),tickValue:t})}return d&&f-l!==o[1]&&m(o[1]),s}function Ux(t,e,i){var n=t.scale,r=vx(t),o=[];return L(n.getTicks(),function(t){var a=n.getLabel(t),s=t.value;e(t.value,a)&&o.push(i?s:{formattedLabel:r(t),rawLabel:a,tickValue:s})}),o}var Gx=[0,1],$x=function(){function t(t,e,i){this.onBand=!1,this.inverse=!1,this.dim=t,this.scale=e,this._extent=i||[0,0]}return t.prototype.contain=function(t){var e=this._extent,i=Math.min(e[0],e[1]),n=Math.max(e[0],e[1]);return t>=i&&t<=n},t.prototype.containData=function(t){return this.scale.contain(t)},t.prototype.getExtent=function(){return this._extent.slice()},t.prototype.getPixelPrecision=function(t){return tr(t||this.scale.getExtent(),this._extent)},t.prototype.setExtent=function(t,e){var i=this._extent;i[0]=t,i[1]=e},t.prototype.dataToCoord=function(t,e){var i=this._extent,n=this.scale;return t=n.normalize(t),this.onBand&&"ordinal"===n.type&&Wx(i=i.slice(),n.count()),qn(t,Gx,i,e)},t.prototype.coordToData=function(t,e){var i=this._extent,n=this.scale;this.onBand&&"ordinal"===n.type&&Wx(i=i.slice(),n.count());var r=qn(t,i,Gx,e);return this.scale.scale(r)},t.prototype.pointToData=function(t,e){},t.prototype.getTicksCoords=function(t){var e=(t=t||{}).tickModel||this.getTickModel(),i=z(Ox(this,e).ticks,function(t){return{coord:this.dataToCoord("ordinal"===this.scale.type?this.scale.getRawOrdinalNumber(t):t),tickValue:t}},this);return function(t,e,i,n){var r=e.length;if(t.onBand&&!i&&r){var o,a,s=t.getExtent();if(1===r)e[0].coord=s[0],o=e[1]={coord:s[0]};else{var l=e[r-1].tickValue-e[0].tickValue,u=(e[r-1].coord-e[0].coord)/l;L(e,function(t){t.coord-=u/2}),a=1+t.scale.getExtent()[1]-e[r-1].tickValue,o={coord:e[r-1].coord+u*a},e.push(o)}var c=s[0]>s[1];h(e[0].coord,s[0])&&(n?e[0].coord=s[0]:e.shift()),n&&h(s[0],e[0].coord)&&e.unshift({coord:s[0]}),h(s[1],o.coord)&&(n?o.coord=s[1]:e.pop()),n&&h(o.coord,s[1])&&e.push({coord:s[1]})}function h(t,e){return t=Yn(t),e=Yn(e),c?t>e:t<e}}(this,i,e.get("alignWithLabel"),t.clamp),i},t.prototype.getMinorTicksCoords=function(){if("ordinal"===this.scale.type)return[];var t=this.model.getModel("minorTick").get("splitNumber");return t>0&&t<100||(t=5),z(this.scale.getMinorTicks(t),function(t){return z(t,function(t){return{coord:this.dataToCoord(t),tickValue:t}},this)},this)},t.prototype.getViewLabels=function(){return zx(this).labels},t.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},t.prototype.getTickModel=function(){return this.model.getModel("axisTick")},t.prototype.getBandWidth=function(){var t=this._extent,e=this.scale.getExtent(),i=e[1]-e[0]+(this.onBand?1:0);0===i&&(i=1);var n=Math.abs(t[1]-t[0]);return Math.abs(n)/i},t.prototype.calculateCategoryInterval=function(){return function(t){var e=function(t){var e=t.getLabelModel();return{axisRotate:t.getRotate?t.getRotate():t.isHorizontal&&!t.isHorizontal()?90:0,labelRotate:e.get("rotate")||0,font:e.getFont()}}(t),i=vx(t),n=(e.axisRotate-e.labelRotate)/180*Math.PI,r=t.scale,o=r.getExtent(),a=r.count();if(o[1]-o[0]<1)return 0;var s=1;a>40&&(s=Math.max(1,Math.floor(a/40)));for(var l=o[0],u=t.dataToCoord(l+1)-t.dataToCoord(l),c=Math.abs(u*Math.cos(n)),h=Math.abs(u*Math.sin(n)),p=0,d=0;l<=o[1];l+=s){var f,m,g=Sn(i({value:l}),e.font,"center","top");f=1.3*g.width,m=1.3*g.height,p=Math.max(p,f,7),d=Math.max(d,m,7)}var y=p/c,v=d/h;isNaN(y)&&(y=1/0),isNaN(v)&&(v=1/0);var _=Math.max(0,Math.floor(Math.min(y,v))),x=Lx(t.model),b=t.getExtent(),w=x.lastAutoInterval,S=x.lastTickCount;return null!=w&&null!=S&&Math.abs(w-_)<=1&&Math.abs(S-a)<=1&&w>_&&x.axisExtent0===b[0]&&x.axisExtent1===b[1]?_=w:(x.lastTickCount=a,x.lastAutoInterval=_,x.axisExtent0=b[0],x.axisExtent1=b[1]),_}(this)},t}();function Wx(t,e){var i=(t[1]-t[0])/e/2;t[0]+=i,t[1]-=i}var Hx=2*Math.PI,jx=La.CMD,Zx=["top","right","bottom","left"];function qx(t,e,i,n,r){var o=i.width,a=i.height;switch(t){case"top":n.set(i.x+o/2,i.y-e),r.set(0,-1);break;case"bottom":n.set(i.x+o/2,i.y+a+e),r.set(0,1);break;case"left":n.set(i.x-e,i.y+a/2),r.set(-1,0);break;case"right":n.set(i.x+o+e,i.y+a/2),r.set(1,0)}}function Xx(t,e,i,n,r,o,a,s,l){var u=Math.sqrt((a-=t)*a+(s-=e)*s),c=(a/=u)*i+t,h=(s/=u)*i+e;if(Math.abs(n-r)%Hx<1e-4)return l[0]=c,l[1]=h,u-i;if(o){var p=n;n=Na(r),r=Na(p)}else n=Na(n),r=Na(r);n>r&&(r+=Hx);var d=Math.atan2(s,a);if(d<0&&(d+=Hx),d>=n&&d<=r||d+Hx>=n&&d+Hx<=r)return l[0]=c,l[1]=h,u-i;var f=i*Math.cos(n)+t,m=i*Math.sin(n)+e,g=i*Math.cos(r)+t,y=i*Math.sin(r)+e,v=(f-a)*(f-a)+(m-s)*(m-s),_=(g-a)*(g-a)+(y-s)*(y-s);return v<_?(l[0]=f,l[1]=m,Math.sqrt(v)):(l[0]=g,l[1]=y,Math.sqrt(_))}function Yx(t,e,i,n,r,o,a,s){var l=r-t,u=o-e,c=i-t,h=n-e,p=Math.sqrt(c*c+h*h),d=(l*(c/=p)+u*(h/=p))/p;s&&(d=Math.min(Math.max(d,0),1)),d*=p;var f=a[0]=t+d*c,m=a[1]=e+d*h;return Math.sqrt((f-r)*(f-r)+(m-o)*(m-o))}function Kx(t,e,i,n,r,o,a){i<0&&(t+=i,i=-i),n<0&&(e+=n,n=-n);var s=t+i,l=e+n,u=a[0]=Math.min(Math.max(r,t),s),c=a[1]=Math.min(Math.max(o,e),l);return Math.sqrt((u-r)*(u-r)+(c-o)*(c-o))}var Jx=[];function Qx(t,e,i){var n=Kx(e.x,e.y,e.width,e.height,t.x,t.y,Jx);return i.set(Jx[0],Jx[1]),n}function tb(t,e,i){for(var n,r,o=0,a=0,s=0,l=0,u=1/0,c=e.data,h=t.x,p=t.y,d=0;d<c.length;){var f=c[d++];1===d&&(s=o=c[d],l=a=c[d+1]);var m=u;switch(f){case jx.M:o=s=c[d++],a=l=c[d++];break;case jx.L:m=Yx(o,a,c[d],c[d+1],h,p,Jx,!0),o=c[d++],a=c[d++];break;case jx.C:m=Ho(o,a,c[d++],c[d++],c[d++],c[d++],c[d],c[d+1],h,p,Jx),o=c[d++],a=c[d++];break;case jx.Q:m=Ko(o,a,c[d++],c[d++],c[d],c[d+1],h,p,Jx),o=c[d++],a=c[d++];break;case jx.A:var g=c[d++],y=c[d++],v=c[d++],_=c[d++],x=c[d++],b=c[d++];d+=1;var w=!!(1-c[d++]);d<=1&&(s=n=Math.cos(x)*v+g,l=r=Math.sin(x)*_+y),m=Xx(g,y,_,x,x+b,w,(h-g)*_/v+g,p,Jx),o=Math.cos(x+b)*v+g,a=Math.sin(x+b)*_+y;break;case jx.R:m=Kx(s=o=c[d++],l=a=c[d++],c[d++],c[d++],h,p,Jx);break;case jx.Z:m=Yx(o,a,s,l,h,p,Jx,!0),o=s,a=l}m<u&&(u=m,i.set(Jx[0],Jx[1]))}return u}var eb=new ln,ib=new ln,nb=new ln,rb=new ln,ob=new ln;function ab(t,e){if(t){var i=t.getTextGuideLine(),n=t.getTextContent();if(n&&i){var r=t.textGuideLineConfig||{},o=[[0,0],[0,0],[0,0]],a=r.candidates||Zx,s=n.getBoundingRect().clone();s.applyTransform(n.getComputedTransform());var l=1/0,u=r.anchor,c=t.getComputedTransform(),h=c&&Zi([],c),p=e.get("length2")||0;u&&nb.copy(u);for(var d=0;d<a.length;d++){qx(a[d],0,s,eb,rb),ln.scaleAndAdd(ib,eb,rb,p),ib.transform(h);var f=t.getBoundingRect(),m=u?u.distance(ib):t instanceof Qa?tb(ib,t.path,nb):Qx(ib,f,nb);m<l&&(l=m,ib.transform(c),nb.transform(c),nb.toArray(o[0]),ib.toArray(o[1]),eb.toArray(o[2]))}ub(o,e.get("minTurnAngle")),i.setShape({points:o})}}}var sb=[],lb=new ln;function ub(t,e){if(e<=180&&e>0){e=e/180*Math.PI,eb.fromArray(t[0]),ib.fromArray(t[1]),nb.fromArray(t[2]),ln.sub(rb,eb,ib),ln.sub(ob,nb,ib);var i=rb.len(),n=ob.len();if(!(i<.001||n<.001)){rb.scale(1/i),ob.scale(1/n);var r=rb.dot(ob);if(Math.cos(e)<r){var o=Yx(ib.x,ib.y,nb.x,nb.y,eb.x,eb.y,sb,!1);lb.fromArray(sb),lb.scaleAndAdd(ob,o/Math.tan(Math.PI-e));var a=nb.x!==ib.x?(lb.x-ib.x)/(nb.x-ib.x):(lb.y-ib.y)/(nb.y-ib.y);if(isNaN(a))return;a<0?ln.copy(lb,ib):a>1&&ln.copy(lb,nb),lb.toArray(t[1])}}}}function cb(t,e,i){if(i<=180&&i>0){i=i/180*Math.PI,eb.fromArray(t[0]),ib.fromArray(t[1]),nb.fromArray(t[2]),ln.sub(rb,ib,eb),ln.sub(ob,nb,ib);var n=rb.len(),r=ob.len();if(!(n<.001||r<.001)&&(rb.scale(1/n),ob.scale(1/r),rb.dot(e)<Math.cos(i))){var o=Yx(ib.x,ib.y,nb.x,nb.y,eb.x,eb.y,sb,!1);lb.fromArray(sb);var a=Math.PI/2,s=a+Math.acos(ob.dot(e))-i;if(s>=a)ln.copy(lb,nb);else{lb.scaleAndAdd(ob,o/Math.tan(Math.PI/2-s));var l=nb.x!==ib.x?(lb.x-ib.x)/(nb.x-ib.x):(lb.y-ib.y)/(nb.y-ib.y);if(isNaN(l))return;l<0?ln.copy(lb,ib):l>1&&ln.copy(lb,nb)}lb.toArray(t[1])}}}function hb(t,e,i,n){var r="normal"===i,o=r?t:t.ensureState(i);o.ignore=e;var a=n.get("smooth");a&&!0===a&&(a=.3),o.shape=o.shape||{},a>0&&(o.shape.smooth=a);var s=n.getModel("lineStyle").getLineStyle();r?t.useStyle(s):o.style=s}function pb(t,e){var i=e.smooth,n=e.points;if(n)if(t.moveTo(n[0][0],n[0][1]),i>0&&n.length>=3){var r=Et(n[0],n[1]),o=Et(n[1],n[2]);if(!r||!o)return t.lineTo(n[1][0],n[1][1]),void t.lineTo(n[2][0],n[2][1]);var a=Math.min(r,o)*i,s=zt([],n[1],n[0],a/r),l=zt([],n[1],n[2],a/o),u=zt([],s,l,.5);t.bezierCurveTo(s[0],s[1],s[0],s[1],u[0],u[1]),t.bezierCurveTo(l[0],l[1],l[0],l[1],n[2][0],n[2][1])}else for(var c=1;c<n.length;c++)t.lineTo(n[c][0],n[c][1])}function db(t,e,i){var n=t.getTextGuideLine(),r=t.getTextContent();if(r){for(var o=e.normal,a=o.get("show"),s=r.ignore,l=0;l<ks.length;l++){var u=ks[l],c=e[u],h="normal"===u;if(c){var p=c.get("show");if((h?s:et(r.states[u]&&r.states[u].ignore,s))||!et(p,a)){var d=h?n:n&&n.states.normal;d&&(d.ignore=!0);continue}n||(n=new du,t.setTextGuideLine(n),h||!s&&a||hb(n,!0,"normal",e.normal),t.stateProxy&&(n.stateProxy=t.stateProxy)),hb(n,!1,u,c)}}if(n){C(n.style,i),n.style.fill=null;var f=o.get("showAbove");(t.textGuideLineConfig=t.textGuideLineConfig||{}).showAbove=f||!1,n.buildPath=pb}}else n&&t.removeTextGuideLine()}function fb(t,e){e=e||"labelLine";for(var i={normal:t.getModel(e)},n=0;n<As.length;n++){var r=As[n];i[r]=t.getModel([r,e])}return i}function mb(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];if(!n.defaultAttr.ignore){var r=n.label,o=r.getComputedTransform(),a=r.getBoundingRect(),s=!o||o[1]<1e-5&&o[2]<1e-5,l=r.style.margin||0,u=a.clone();u.applyTransform(o),u.x-=l/2,u.y-=l/2,u.width+=l,u.height+=l;var c=s?new Eu(a,o):null;e.push({label:r,labelLine:n.labelLine,rect:u,localRect:a,obb:c,priority:n.priority,defaultAttr:n.defaultAttr,layoutOption:n.computedLayoutOption,axisAligned:s,transform:o})}}return e}function gb(t,e,i,n,r,o){var a=t.length;if(!(a<2)){t.sort(function(t,i){return t.rect[e]-i.rect[e]});for(var s,l=0,u=!1,c=0,h=0;h<a;h++){var p=t[h],d=p.rect;(s=d[e]-l)<0&&(d[e]-=s,p.label[e]-=s,u=!0),c+=Math.max(-s,0),l=d[e]+d[i]}c>0&&o&&x(-c/a,0,a);var f,m,g=t[0],y=t[a-1];return v(),f<0&&b(-f,.8),m<0&&b(m,.8),v(),_(f,m,1),_(m,f,-1),v(),f<0&&w(-f),m<0&&w(m),u}function v(){f=g.rect[e]-n,m=r-y.rect[e]-y.rect[i]}function _(t,e,i){if(t<0){var n=Math.min(e,-t);if(n>0){x(n*i,0,a);var r=n+t;r<0&&b(-r*i,1)}else b(-t*i,1)}}function x(i,n,r){0!==i&&(u=!0);for(var o=n;o<r;o++){var a=t[o];a.rect[e]+=i,a.label[e]+=i}}function b(n,r){for(var o=[],s=0,l=1;l<a;l++){var u=t[l-1].rect,c=Math.max(t[l].rect[e]-u[e]-u[i],0);o.push(c),s+=c}if(s){var h=Math.min(Math.abs(n)/s,r);if(n>0)for(l=0;l<a-1;l++)x(o[l]*h,0,l+1);else for(l=a-1;l>0;l--)x(-o[l-1]*h,l,a)}}function w(t){for(var e=t<0?-1:1,i=Math.ceil((t=Math.abs(t))/(a-1)),n=0;n<a-1;n++)if(e>0?x(i,0,n+1):x(-i,a-n-1,a),(t-=i)<=0)return}}function yb(t,e,i,n){return gb(t,"y","height",e,i,n)}function vb(t){var e=[];t.sort(function(t,e){return e.priority-t.priority});var i=new yn(0,0,0,0);function n(t){if(!t.ignore){var e=t.ensureState("emphasis");null==e.ignore&&(e.ignore=!1)}t.ignore=!0}for(var r=0;r<t.length;r++){var o=t[r],a=o.axisAligned,s=o.localRect,l=o.transform,u=o.label,c=o.labelLine;i.copy(o.rect),i.width-=.1,i.height-=.1,i.x+=.05,i.y+=.05;for(var h=o.obb,p=!1,d=0;d<e.length;d++){var f=e[d];if(i.intersect(f.rect)){if(a&&f.axisAligned){p=!0;break}if(f.obb||(f.obb=new Eu(f.localRect,f.transform)),h||(h=new Eu(s,l)),h.intersect(f.obb)){p=!0;break}}}p?(n(u),c&&n(c)):(u.attr("ignore",o.defaultAttr.ignore),c&&c.attr("ignore",o.defaultAttr.labelGuideIgnore),e.push(o))}}function _b(t){if(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].slice());return e}}function xb(t,e){var i=t.label,n=e&&e.getTextGuideLine();return{dataIndex:t.dataIndex,dataType:t.dataType,seriesIndex:t.seriesModel.seriesIndex,text:t.label.style.text,rect:t.hostRect,labelRect:t.rect,align:i.style.align,verticalAlign:i.style.verticalAlign,labelLinePoints:_b(n&&n.shape.points)}}var bb=["align","verticalAlign","width","height","fontSize"],wb=new an,Sb=zr(),Tb=zr();function Mb(t,e,i){for(var n=0;n<i.length;n++){var r=i[n];null!=e[r]&&(t[r]=e[r])}}var Ib=["x","y","rotation"],Cb=function(){function t(){this._labelList=[],this._chartViewList=[]}return t.prototype.clearLabels=function(){this._labelList=[],this._chartViewList=[]},t.prototype._addLabel=function(t,e,i,n,r){var o=n.style,a=n.__hostTarget.textConfig||{},s=n.getComputedTransform(),l=n.getBoundingRect().plain();yn.applyTransform(l,l,s),s?wb.setLocalTransform(s):(wb.x=wb.y=wb.rotation=wb.originX=wb.originY=0,wb.scaleX=wb.scaleY=1);var u,c=n.__hostTarget;if(c){u=c.getBoundingRect().plain();var h=c.getComputedTransform();yn.applyTransform(u,u,h)}var p=u&&c.getTextGuideLine();this._labelList.push({label:n,labelLine:p,seriesModel:i,dataIndex:t,dataType:e,layoutOption:r,computedLayoutOption:null,rect:l,hostRect:u,priority:u?u.width*u.height:0,defaultAttr:{ignore:n.ignore,labelGuideIgnore:p&&p.ignore,x:wb.x,y:wb.y,scaleX:wb.scaleX,scaleY:wb.scaleY,rotation:wb.rotation,style:{x:o.x,y:o.y,align:o.align,verticalAlign:o.verticalAlign,width:o.width,height:o.height,fontSize:o.fontSize},cursor:n.cursor,attachedPos:a.position,attachedRot:a.rotation}})},t.prototype.addLabelsOfSeries=function(t){var e=this;this._chartViewList.push(t);var i=t.__model,n=i.get("labelLayout");(G(n)||N(n).length)&&t.group.traverse(function(t){if(t.ignore)return!0;var r=t.getTextContent(),o=Ss(t);r&&!r.disableLabelLayout&&e._addLabel(o.dataIndex,o.dataType,i,r,n)})},t.prototype.updateLayoutConfig=function(t){var e=t.getWidth(),i=t.getHeight();function n(t,e){return function(){ab(t,e)}}for(var r=0;r<this._labelList.length;r++){var o=this._labelList[r],a=o.label,s=a.__hostTarget,l=o.defaultAttr,u=void 0;u=(u="function"==typeof o.layoutOption?o.layoutOption(xb(o,s)):o.layoutOption)||{},o.computedLayoutOption=u;var c=Math.PI/180;s&&s.setTextConfig({local:!1,position:null!=u.x||null!=u.y?null:l.attachedPos,rotation:null!=u.rotate?u.rotate*c:l.attachedRot,offset:[u.dx||0,u.dy||0]});var h=!1;if(null!=u.x?(a.x=Xn(u.x,e),a.setStyle("x",0),h=!0):(a.x=l.x,a.setStyle("x",l.style.x)),null!=u.y?(a.y=Xn(u.y,i),a.setStyle("y",0),h=!0):(a.y=l.y,a.setStyle("y",l.style.y)),u.labelLinePoints){var p=s.getTextGuideLine();p&&(p.setShape({points:u.labelLinePoints}),h=!1)}Sb(a).needsUpdateLabelLine=h,a.rotation=null!=u.rotate?u.rotate*c:l.rotation,a.scaleX=l.scaleX,a.scaleY=l.scaleY;for(var d=0;d<bb.length;d++){var f=bb[d];a.setStyle(f,null!=u[f]?u[f]:l.style[f])}if(u.draggable){if(a.draggable=!0,a.cursor="move",s){var m=o.seriesModel;null!=o.dataIndex&&(m=o.seriesModel.getData(o.dataType).getItemModel(o.dataIndex)),a.on("drag",n(s,m.getModel("labelLine")))}}else a.off("drag"),a.cursor=l.cursor}},t.prototype.layout=function(t){var e,i=t.getWidth(),n=t.getHeight(),r=mb(this._labelList),o=R(r,function(t){return"shiftX"===t.layoutOption.moveOverlap}),a=R(r,function(t){return"shiftY"===t.layoutOption.moveOverlap});gb(o,"x","width",0,i,e),yb(a,0,n),vb(R(r,function(t){return t.layoutOption.hideOverlap}))},t.prototype.processLabelsOverall=function(){var t=this;L(this._chartViewList,function(e){var i=e.__model,n=e.ignoreLabelLineUpdate,r=i.isAnimationEnabled();e.group.traverse(function(e){if(e.ignore&&!e.forceLabelAnimation)return!0;var o=!n,a=e.getTextContent();!o&&a&&(o=Sb(a).needsUpdateLabelLine),o&&t._updateLabelLine(e,i),r&&t._animateLabels(e,i)})})},t.prototype._updateLabelLine=function(t,e){var i=t.getTextContent(),n=Ss(t),r=n.dataIndex;if(i&&null!=r){var o=e.getData(n.dataType),a=o.getItemModel(r),s={},l=o.getItemVisual(r,"style"),u=o.getVisual("drawType");s.stroke=l[u];var c=a.getModel("labelLine");db(t,fb(a),s),ab(t,c)}},t.prototype._animateLabels=function(t,e){var i=t.getTextContent(),n=t.getTextGuideLine();if(i&&(t.forceLabelAnimation||!i.ignore&&!i.invisible&&!t.disableLabelAnimation&&!Fu(t))){var r=(d=Sb(i)).oldLayout,o=Ss(t),a=o.dataIndex,s={x:i.x,y:i.y,rotation:i.rotation},l=e.getData(o.dataType);if(r){i.attr(r);var u=t.prevStates;u&&(k(u,"select")>=0&&i.attr(d.oldLayoutSelect),k(u,"emphasis")>=0&&i.attr(d.oldLayoutEmphasis)),Bu(i,s,e,a)}else if(i.attr(s),!kc(i).valueAnimation){var c=et(i.style.opacity,1);i.style.opacity=0,Nu(i,{style:{opacity:c}},e,a)}if(d.oldLayout=s,i.states.select){var h=d.oldLayoutSelect={};Mb(h,s,Ib),Mb(h,i.states.select,Ib)}if(i.states.emphasis){var p=d.oldLayoutEmphasis={};Mb(p,s,Ib),Mb(p,i.states.emphasis,Ib)}Ec(i,a,l,e,e)}if(n&&!n.ignore&&!n.invisible){r=(d=Tb(n)).oldLayout;var d,f={points:n.shape.points};r?(n.attr({shape:r}),Bu(n,{shape:f},e)):(n.setShape(f),n.style.strokePercent=0,Nu(n,{style:{strokePercent:1}},e)),d.oldLayout=f}},t}(),Ab=zr();function kb(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Db(t){var e;if(t&&"transparent"!==t){if("string"==typeof t&&t.indexOf("rgba")>-1){var i=He(t);i&&(t="rgb("+i[0]+","+i[1]+","+i[2]+")",e=i[3])}}else t="none";return{color:t,opacity:null==e?1:e}}function Eb(t,e,i,n,r){for(var o=e.length,a=i.length,s=t.newPos,l=s-n,u=0;s+1<o&&l+1<a&&r(e[s+1],i[l+1]);)s++,l++,u++;return u&&t.components.push({count:u,added:!1,removed:!1,indices:[]}),t.newPos=s,l}function Pb(t,e,i){var n=t[t.length-1];n&&n.added===e&&n.removed===i?t[t.length-1]={count:n.count+1,added:e,removed:i,indices:[]}:t.push({count:1,added:e,removed:i,indices:[]})}function Lb(t){for(var e=0,i=t.length,n=0,r=0;e<i;e++){var o=t[e];if(o.removed){for(s=r;s<r+o.count;s++)o.indices.push(s);r+=o.count}else{for(var a=[],s=n;s<n+o.count;s++)a.push(s);o.indices=a,n+=o.count,o.added||(r+=o.count)}}return t}function zb(t,e,i){return function(t,e,i){i||(i=function(t,e){return t===e}),t=t.slice();var n=(e=e.slice()).length,r=t.length,o=1,a=n+r,s=[{newPos:-1,components:[]}],l=Eb(s[0],e,t,0,i);if(s[0].newPos+1>=n&&l+1>=r){for(var u=[],c=0;c<e.length;c++)u.push(c);return[{indices:u,count:e.length,added:!1,removed:!1}]}function h(){for(var a=-1*o;a<=o;a+=2){var l,u=s[a-1],c=s[a+1],h=(c?c.newPos:0)-a;u&&(s[a-1]=void 0);var p=u&&u.newPos+1<n,d=c&&0<=h&&h<r;if(p||d){if(!p||d&&u.newPos<c.newPos?Pb((l={newPos:(f=c).newPos,components:f.components.slice(0)}).components,!1,!0):((l=u).newPos++,Pb(l.components,!0,!1)),h=Eb(l,e,t,a,i),l.newPos+1>=n&&h+1>=r)return Lb(l.components);s[a]=l}else s[a]=void 0}var f;o++}for(;o<=a;){var p=h();if(p)return p}}(t,e,i)}var Ob="none",Rb=Math.round,Bb=Math.sin,Nb=Math.cos,Fb=Math.PI,Vb=2*Math.PI,Ub=180/Fb,Gb=1e-4;function $b(t){return Rb(1e3*t)/1e3}function Wb(t){return Rb(1e4*t)/1e4}function Hb(t){return t<Gb&&t>-1e-4}function jb(t,e){e&&Zb(t,"transform","matrix("+$b(e[0])+","+$b(e[1])+","+$b(e[2])+","+$b(e[3])+","+Wb(e[4])+","+Wb(e[5])+")")}function Zb(t,e,i){(!i||"linear"!==i.type&&"radial"!==i.type)&&t.setAttribute(e,i)}function qb(t,e,i){var n=null==e.opacity?1:e.opacity;if(i instanceof rs)Zb(t,"opacity",n+"");else{if(function(t){var e=t.fill;return null!=e&&e!==Ob}(e)){var r=Db(e.fill);Zb(t,"fill",r.color),Zb(t,"fill-opacity",(null!=e.fillOpacity?e.fillOpacity*r.opacity*n:r.opacity*n)+"")}else Zb(t,"fill",Ob);if(function(t){var e=t.stroke;return null!=e&&e!==Ob}(e)){var o=Db(e.stroke);Zb(t,"stroke",o.color);var a=e.lineWidth,s=e.strokeNoScale?i.getLineScale():1;Zb(t,"stroke-width",(s?a/s:0)+""),Zb(t,"paint-order",e.strokeFirst?"stroke":"fill"),Zb(t,"stroke-opacity",(null!=e.strokeOpacity?e.strokeOpacity*o.opacity*n:o.opacity*n)+"");var l=e.lineDash&&a>0&&ag(e.lineDash,a);if(l){var u=e.lineDashOffset;s&&1!==s&&(l=z(l,function(t){return t/s}),u&&(u=Rb(u/=s))),Zb(t,"stroke-dasharray",l.join(",")),Zb(t,"stroke-dashoffset",(u||0)+"")}else Zb(t,"stroke-dasharray",Ob);e.lineCap&&Zb(t,"stroke-linecap",e.lineCap),e.lineJoin&&Zb(t,"stroke-linejoin",e.lineJoin),e.miterLimit&&Zb(t,"stroke-miterlimit",e.miterLimit+"")}else Zb(t,"stroke",Ob)}}var Xb=function(){function t(){}return t.prototype.reset=function(){this._d=[],this._str=""},t.prototype.moveTo=function(t,e){this._add("M",t,e)},t.prototype.lineTo=function(t,e){this._add("L",t,e)},t.prototype.bezierCurveTo=function(t,e,i,n,r,o){this._add("C",t,e,i,n,r,o)},t.prototype.quadraticCurveTo=function(t,e,i,n){this._add("Q",t,e,i,n)},t.prototype.arc=function(t,e,i,n,r,o){this.ellipse(t,e,i,i,0,n,r,o)},t.prototype.ellipse=function(t,e,i,n,r,o,a,s){var l=0===this._d.length,u=a-o,c=!s,h=Math.abs(u),p=Hb(h-Vb)||(c?u>=Vb:-u>=Vb),d=u>0?u%Vb:u%Vb+Vb,f=!1;f=!!p||!Hb(h)&&d>=Fb==!!c;var m=Wb(t+i*Nb(o)),g=Wb(e+n*Bb(o));p&&(u=c?Vb-1e-4:1e-4-Vb,f=!0,l&&this._d.push("M",m,g));var y=Wb(t+i*Nb(o+u)),v=Wb(e+n*Bb(o+u));if(isNaN(m)||isNaN(g)||isNaN(i)||isNaN(n)||isNaN(r)||isNaN(Ub)||isNaN(y)||isNaN(v))return"";this._d.push("A",Wb(i),Wb(n),Rb(r*Ub),+f,+c,y,v)},t.prototype.rect=function(t,e,i,n){this._add("M",t,e),this._add("L",t+i,e),this._add("L",t+i,e+n),this._add("L",t,e+n),this._add("L",t,e),this._add("Z")},t.prototype.closePath=function(){this._d.length>0&&this._add("Z")},t.prototype._add=function(t,e,i,n,r,o,a,s,l){this._d.push(t);for(var u=1;u<arguments.length;u++){var c=arguments[u];if(isNaN(c))return void(this._invalid=!0);this._d.push(Wb(c))}},t.prototype.generateStr=function(){this._str=this._invalid?"":this._d.join(" "),this._d=[]},t.prototype.getStr=function(){return this._str},t}(),Yb={brush:function(t){var e=t.style,i=t.__svgEl;i||(i=kb("path"),t.__svgEl=i),t.path||t.createPathProxy();var n=t.path;t.shapeChanged()&&(n.beginPath(),t.buildPath(n,t.shape),t.pathUpdated());var r=n.getVersion(),o=t,a=o.__svgPathBuilder;(o.__svgPathVersion!==r||!a||t.style.strokePercent<1)&&(a||(a=o.__svgPathBuilder=new Xb),a.reset(),n.rebuildPath(a,t.style.strokePercent),a.generateStr(),o.__svgPathVersion=r),Zb(i,"d",a.getStr()),qb(i,e,t),jb(i,t.transform)}},Kb={brush:function(t){var e=t.style,i=e.image;if(i instanceof HTMLImageElement?i=i.src:i instanceof HTMLCanvasElement&&(i=i.toDataURL()),i){var n=e.x||0,r=e.y||0,o=e.width,a=e.height,s=t.__svgEl;s||(s=kb("image"),t.__svgEl=s),i!==t.__imageSrc&&(function(t,e,i){t.setAttributeNS("http://www.w3.org/1999/xlink",e,i)}(s,"href",i),t.__imageSrc=i),Zb(s,"width",o+""),Zb(s,"height",a+""),Zb(s,"x",n+""),Zb(s,"y",r+""),qb(s,e,t),jb(s,t.transform)}}},Jb={left:"start",right:"end",center:"middle",middle:"middle"},Qb={brush:function(t){var e=t.style,i=e.text;if(null!=i&&(i+=""),i&&!isNaN(e.x)&&!isNaN(e.y)){var n=t.__svgEl;n||(function(t,e,i){t.setAttributeNS("http://www.w3.org/XML/1998/namespace",e,i)}(n=kb("text"),"xml:space","preserve"),t.__svgEl=n);var r=e.font||_n;n.style.font=r,n.textContent=i,qb(n,e,t),jb(n,t.transform);var o=e.x||0,a=function(t,e,i){return"top"===i?t+=e/2:"bottom"===i&&(t-=e/2),t}(e.y||0,In(r),e.textBaseline),s=Jb[e.textAlign]||e.textAlign;Zb(n,"dominant-baseline","central"),Zb(n,"text-anchor",s),Zb(n,"x",o+""),Zb(n,"y",a+"")}}},tw=function(){function t(t,e,i,n,r){this.nextId=0,this._domName="_dom",this.createElement=kb,this._zrId=t,this._svgRoot=e,this._tagNames="string"==typeof i?[i]:i,this._markLabel=n,r&&(this._domName=r)}return t.prototype.getDefs=function(t){var e=this._svgRoot,i=this._svgRoot.getElementsByTagName("defs");if(0===i.length){if(t){var n=e.insertBefore(this.createElement("defs"),e.firstChild);return n.contains||(n.contains=function(t){var e=n.children;if(!e)return!1;for(var i=e.length-1;i>=0;--i)if(e[i]===t)return!0;return!1}),n}return null}return i[0]},t.prototype.doUpdate=function(t,e){if(t){var i=this.getDefs(!1);if(t[this._domName]&&i.contains(t[this._domName]))"function"==typeof e&&e(t);else{var n=this.add(t);n&&(t[this._domName]=n)}}},t.prototype.add=function(t){return null},t.prototype.addDom=function(t){var e=this.getDefs(!0);t.parentNode!==e&&e.appendChild(t)},t.prototype.removeDom=function(t){var e=this.getDefs(!1);e&&t[this._domName]&&(e.removeChild(t[this._domName]),t[this._domName]=null)},t.prototype.getDoms=function(){var t=this.getDefs(!1);if(!t)return[];var e=[];return L(this._tagNames,function(i){for(var n=t.getElementsByTagName(i),r=0;r<n.length;r++)e.push(n[r])}),e},t.prototype.markAllUnused=function(){var t=this.getDoms(),e=this;L(t,function(t){t[e._markLabel]="0"})},t.prototype.markDomUsed=function(t){t&&(t[this._markLabel]="1")},t.prototype.markDomUnused=function(t){t&&(t[this._markLabel]="0")},t.prototype.isDomUnused=function(t){return t&&"1"!==t[this._markLabel]},t.prototype.removeUnused=function(){var t=this,e=this.getDefs(!1);e&&L(this.getDoms(),function(i){t.isDomUnused(i)&&e.removeChild(i)})},t.prototype.getSvgProxy=function(t){return t instanceof Qa?Yb:t instanceof rs?Kb:t instanceof es?Qb:Yb},t.prototype.getSvgElement=function(t){return t.__svgEl},t}();function ew(t){return"linear"===t.type}function iw(t){return"radial"===t.type}function nw(t){return t&&("linear"===t.type||"radial"===t.type)}var rw=function(t){function e(e,i){return t.call(this,e,i,["linearGradient","radialGradient"],"__gradient_in_use__")||this}return i(e,t),e.prototype.addWithoutUpdate=function(t,e){if(e&&e.style){var i=this;L(["fill","stroke"],function(n){var r=e.style[n];if(nw(r)){var o=r,a=i.getDefs(!0),s=void 0;o.__dom?(s=o.__dom,a.contains(o.__dom)||i.addDom(s)):s=i.add(o),i.markUsed(e);var l=s.getAttribute("id");t.setAttribute(n,"url(#"+l+")")}})}},e.prototype.add=function(t){var e;if(ew(t))e=this.createElement("linearGradient");else{if(!iw(t))return w("Illegal gradient type."),null;e=this.createElement("radialGradient")}return t.id=t.id||this.nextId++,e.setAttribute("id","zr"+this._zrId+"-gradient-"+t.id),this.updateDom(t,e),this.addDom(e),e},e.prototype.update=function(t){if(nw(t)){var e=this;this.doUpdate(t,function(){var i=t.__dom;if(i){var n=i.tagName,r=t.type;"linear"===r&&"linearGradient"===n||"radial"===r&&"radialGradient"===n?e.updateDom(t,t.__dom):(e.removeDom(t),e.add(t))}})}},e.prototype.updateDom=function(t,e){if(ew(t))e.setAttribute("x1",t.x+""),e.setAttribute("y1",t.y+""),e.setAttribute("x2",t.x2+""),e.setAttribute("y2",t.y2+"");else{if(!iw(t))return void w("Illegal gradient type.");e.setAttribute("cx",t.x+""),e.setAttribute("cy",t.y+""),e.setAttribute("r",t.r+"")}t.global?e.setAttribute("gradientUnits","userSpaceOnUse"):e.setAttribute("gradientUnits","objectBoundingBox"),e.innerHTML="";for(var i=t.colorStops,n=0,r=i.length;n<r;++n){var o=this.createElement("stop");o.setAttribute("offset",100*i[n].offset+"%");var a=i[n].color;if(a.indexOf("rgba")>-1){var s=He(a)[3],l=qe(a);o.setAttribute("stop-color","#"+l),o.setAttribute("stop-opacity",s+"")}else o.setAttribute("stop-color",i[n].color);e.appendChild(o)}t.__dom=e},e.prototype.markUsed=function(e){if(e.style){var i=e.style.fill;i&&i.__dom&&t.prototype.markDomUsed.call(this,i.__dom),(i=e.style.stroke)&&i.__dom&&t.prototype.markDomUsed.call(this,i.__dom)}},e}(tw);function ow(t){return t&&(!!t.image||!!t.svgElement)}var aw=new jm,sw=function(t){function e(e,i){return t.call(this,e,i,["pattern"],"__pattern_in_use__")||this}return i(e,t),e.prototype.addWithoutUpdate=function(t,e){if(e&&e.style){var i=this;L(["fill","stroke"],function(n){var r=e.style[n];if(ow(r)){var o=i.getDefs(!0),a=aw.get(r);a?o.contains(a)||i.addDom(a):a=i.add(r),i.markUsed(e);var s=a.getAttribute("id");t.setAttribute(n,"url(#"+s+")")}})}},e.prototype.add=function(t){if(ow(t)){var e=this.createElement("pattern");return t.id=null==t.id?this.nextId++:t.id,e.setAttribute("id","zr"+this._zrId+"-pattern-"+t.id),e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("patternUnits","userSpaceOnUse"),this.updateDom(t,e),this.addDom(e),e}},e.prototype.update=function(t){if(ow(t)){var e=this;this.doUpdate(t,function(){var i=aw.get(t);e.updateDom(t,i)})}},e.prototype.updateDom=function(t,e){var i=t.svgElement;if(i instanceof SVGElement)i.parentNode!==e&&(e.innerHTML="",e.appendChild(i),e.setAttribute("width",t.svgWidth+""),e.setAttribute("height",t.svgHeight+""));else{var n=void 0,r=e.getElementsByTagName("image");if(r.length){if(!t.image)return void e.removeChild(r[0]);n=r[0]}else t.image&&(n=this.createElement("image"));if(n){var o=void 0,a=t.image;if("string"==typeof a?o=a:a instanceof HTMLImageElement?o=a.src:a instanceof HTMLCanvasElement&&(o=a.toDataURL()),o){n.setAttribute("href",o),n.setAttribute("x","0"),n.setAttribute("y","0");var s=oo(o,n,{dirty:function(){}},function(t){e.setAttribute("width",t.width+""),e.setAttribute("height",t.height+"")});s&&s.width&&s.height&&(e.setAttribute("width",s.width+""),e.setAttribute("height",s.height+"")),e.appendChild(n)}}}var l="translate("+(t.x||0)+", "+(t.y||0)+") rotate("+(t.rotation||0)/Math.PI*180+") scale("+(t.scaleX||1)+", "+(t.scaleY||1)+")";e.setAttribute("patternTransform",l),aw.set(t,e)},e.prototype.markUsed=function(e){e.style&&(ow(e.style.fill)&&t.prototype.markDomUsed.call(this,aw.get(e.style.fill)),ow(e.style.stroke)&&t.prototype.markDomUsed.call(this,aw.get(e.style.stroke)))},e}(tw);function lw(t){var e=t.__clipPaths;return e&&e.length>0}var uw=function(t){function e(e,i){var n=t.call(this,e,i,"clipPath","__clippath_in_use__")||this;return n._refGroups={},n._keyDuplicateCount={},n}return i(e,t),e.prototype.markAllUnused=function(){t.prototype.markAllUnused.call(this);var e=this._refGroups;for(var i in e)e.hasOwnProperty(i)&&this.markDomUnused(e[i]);this._keyDuplicateCount={}},e.prototype._getClipPathGroup=function(t,e){if(lw(t)){var i=t.__clipPaths,n=this._keyDuplicateCount,r=function(t){var e=[];if(t)for(var i=0;i<t.length;i++){var n=t[i];e.push(n.id)}return e.join(",")}(i);return og(i,e&&e.__clipPaths)&&(n[r]=n[r]||0,n[r]&&(r+="-"+n[r]),n[r]++),this._refGroups[r]||(this._refGroups[r]=this.createElement("g"))}},e.prototype.update=function(t,e){var i=this._getClipPathGroup(t,e);return i&&(this.markDomUsed(i),this.updateDom(i,t.__clipPaths)),i},e.prototype.updateDom=function(t,e){if(e&&e.length>0){var i=this.getDefs(!0),n=e[0],r=void 0,o=void 0;n._dom?(o=n._dom.getAttribute("id"),r=n._dom,i.contains(r)||i.appendChild(r)):(o="zr"+this._zrId+"-clip-"+this.nextId,++this.nextId,(r=this.createElement("clipPath")).setAttribute("id",o),i.appendChild(r),n._dom=r),this.getSvgProxy(n).brush(n);var a=this.getSvgElement(n);r.innerHTML="",r.appendChild(a),t.setAttribute("clip-path","url(#"+o+")"),e.length>1&&this.updateDom(r,e.slice(1))}else t&&t.setAttribute("clip-path","none")},e.prototype.markUsed=function(e){var i=this;e.__clipPaths&&L(e.__clipPaths,function(e){e._dom&&t.prototype.markDomUsed.call(i,e._dom)})},e.prototype.removeUnused=function(){t.prototype.removeUnused.call(this);var e={},i=this._refGroups;for(var n in i)if(i.hasOwnProperty(n)){var r=i[n];this.isDomUnused(r)?r.parentNode&&r.parentNode.removeChild(r):e[n]=r}this._refGroups=e},e}(tw),cw=function(t){function e(e,i){var n=t.call(this,e,i,["filter"],"__filter_in_use__","_shadowDom")||this;return n._shadowDomMap={},n._shadowDomPool=[],n}return i(e,t),e.prototype._getFromPool=function(){var t=this._shadowDomPool.pop();if(!t){(t=this.createElement("filter")).setAttribute("id","zr"+this._zrId+"-shadow-"+this.nextId++);var e=this.createElement("feDropShadow");t.appendChild(e),this.addDom(t)}return t},e.prototype.update=function(t,e){if(function(t){return t&&(t.shadowBlur||t.shadowOffsetX||t.shadowOffsetY)}(e.style)){var i=function(t){var e=t.style,i=t.getGlobalScale();return[e.shadowColor,(e.shadowBlur||0).toFixed(2),(e.shadowOffsetX||0).toFixed(2),(e.shadowOffsetY||0).toFixed(2),i[0],i[1]].join(",")}(e),n=e._shadowDom=this._shadowDomMap[i];n||(n=this._getFromPool(),this._shadowDomMap[i]=n),this.updateDom(t,e,n)}else this.remove(t,e)},e.prototype.remove=function(t,e){null!=e._shadowDom&&(e._shadowDom=null,t.removeAttribute("filter"))},e.prototype.updateDom=function(t,e,i){var n=i.children[0],r=e.style,o=e.getGlobalScale(),a=o[0],s=o[1];if(a&&s){var l=r.shadowOffsetX||0,u=r.shadowOffsetY||0,c=r.shadowBlur,h=Db(r.shadowColor);n.setAttribute("dx",l/a+""),n.setAttribute("dy",u/s+""),n.setAttribute("flood-color",h.color),n.setAttribute("flood-opacity",h.opacity+"");var p=c/2/a+" "+c/2/s;n.setAttribute("stdDeviation",p),i.setAttribute("x","-100%"),i.setAttribute("y","-100%"),i.setAttribute("width","300%"),i.setAttribute("height","300%"),e._shadowDom=i;var d=i.getAttribute("id");t.setAttribute("filter","url(#"+d+")")}},e.prototype.removeUnused=function(){if(this.getDefs(!1)){var t=this._shadowDomPool,e=this._shadowDomMap;for(var i in e)e.hasOwnProperty(i)&&t.push(e[i]);this._shadowDomMap={}}},e}(tw);function hw(t){return parseInt(t,10)}function pw(t){return t instanceof Qa?Yb:t instanceof rs?Kb:t instanceof es?Qb:Yb}function dw(t,e){return e&&t&&e.parentNode!==t}function fw(t,e,i){if(dw(t,e)&&i){var n=i.nextSibling;n?t.insertBefore(e,n):t.appendChild(e)}}function mw(t,e){if(dw(t,e)){var i=t.firstChild;i?t.insertBefore(e,i):t.appendChild(e)}}function gw(t,e){e&&t&&e.parentNode===t&&t.removeChild(e)}function yw(t){return t.__svgEl}var vw=function(){function t(t,e,i,n){this.type="svg",this.refreshHover=_w("refreshHover"),this.pathToImage=_w("pathToImage"),this.configLayer=_w("configLayer"),this.root=t,this.storage=e,this._opts=i=I({},i||{});var r=kb("svg");r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns","http://www.w3.org/2000/svg"),r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),r.setAttribute("version","1.1"),r.setAttribute("baseProfile","full"),r.style.cssText="user-select:none;position:absolute;left:0;top:0;";var o=kb("g");r.appendChild(o);var a=kb("g");r.appendChild(a),this._gradientManager=new rw(n,a),this._patternManager=new sw(n,a),this._clipPathManager=new uw(n,a),this._shadowManager=new cw(n,a);var s=document.createElement("div");s.style.cssText="overflow:hidden;position:relative",this._svgDom=r,this._svgRoot=a,this._backgroundRoot=o,this._viewport=s,t.appendChild(s),s.appendChild(r),this.resize(i.width,i.height),this._visibleList=[]}return t.prototype.getType=function(){return"svg"},t.prototype.getViewportRoot=function(){return this._viewport},t.prototype.getSvgDom=function(){return this._svgDom},t.prototype.getSvgRoot=function(){return this._svgRoot},t.prototype.getViewportRootOffset=function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},t.prototype.refresh=function(){var t=this.storage.getDisplayList(!0);this._paintList(t)},t.prototype.setBackgroundColor=function(t){this._backgroundRoot&&this._backgroundNode&&this._backgroundRoot.removeChild(this._backgroundNode);var e=kb("rect");e.setAttribute("width",this.getWidth()),e.setAttribute("height",this.getHeight()),e.setAttribute("x",0),e.setAttribute("y",0),e.setAttribute("id",0);var i=Db(t),n=i.color,r=i.opacity;e.setAttribute("fill",n),e.setAttribute("fill-opacity",r),this._backgroundRoot.appendChild(e),this._backgroundNode=e},t.prototype.createSVGElement=function(t){return kb(t)},t.prototype.paintOne=function(t){var e=pw(t);return e&&e.brush(t),yw(t)},t.prototype._paintList=function(t){var e=this._gradientManager,i=this._patternManager,n=this._clipPathManager,r=this._shadowManager;e.markAllUnused(),i.markAllUnused(),n.markAllUnused(),r.markAllUnused();for(var o=this._svgRoot,a=this._visibleList,s=t.length,l=[],u=0;u<s;u++){var c=pw(x=t[u]),h=yw(x);x.invisible||(!x.__dirty&&h||(c&&c.brush(x),(h=yw(x))&&x.style&&(e.update(x.style.fill),e.update(x.style.stroke),i.update(x.style.fill),i.update(x.style.stroke),r.update(h,x)),x.__dirty=0),h&&l.push(x))}var p,d,f,m,g,y=zb(a,l);for(u=0;u<y.length;u++)if((_=y[u]).removed)for(var v=0;v<_.count;v++)h=yw(x=a[_.indices[v]]),lw(x)?(f=h)&&f.parentNode&&f.parentNode.removeChild(f):gw(o,h);for(u=0;u<y.length;u++){var _;if(!(_=y[u]).removed)for(v=0;v<_.count;v++){var x=l[_.indices[v]],b=n.update(x,m);b!==g&&(p=d,b&&(p?fw(o,b,p):mw(o,b),d=b,p=null),g=b),h=yw(x),p?fw(g||o,h,p):mw(g||o,h),p=h||p,g||(d=p),e.markUsed(x),e.addWithoutUpdate(h,x),i.markUsed(x),i.addWithoutUpdate(h,x),n.markUsed(x),m=x}}e.removeUnused(),i.removeUnused(),n.removeUnused(),r.removeUnused(),this._visibleList=l},t.prototype.resize=function(t,e){var i=this._viewport;i.style.display="none";var n=this._opts;if(null!=t&&(n.width=t),null!=e&&(n.height=e),t=this._getSize(0),e=this._getSize(1),i.style.display="",this._width!==t||this._height!==e){this._width=t,this._height=e;var r=i.style;r.width=t+"px",r.height=e+"px";var o=this._svgDom;o.setAttribute("width",t+""),o.setAttribute("height",e+"")}this._backgroundNode&&(this._backgroundNode.setAttribute("width",t),this._backgroundNode.setAttribute("height",e))},t.prototype.getWidth=function(){return this._width},t.prototype.getHeight=function(){return this._height},t.prototype._getSize=function(t){var e=this._opts,i=["width","height"][t],n=["clientWidth","clientHeight"][t],r=["paddingLeft","paddingTop"][t],o=["paddingRight","paddingBottom"][t];if(null!=e[i]&&"auto"!==e[i])return parseFloat(e[i]);var a=this.root,s=document.defaultView.getComputedStyle(a);return(a[n]||hw(s[i])||hw(a.style[i]))-(hw(s[r])||0)-(hw(s[o])||0)|0},t.prototype.dispose=function(){this.root.innerHTML="",this._svgRoot=this._backgroundRoot=this._svgDom=this._backgroundNode=this._viewport=this.storage=null},t.prototype.clear=function(){var t=this._viewport;t&&t.parentNode&&t.parentNode.removeChild(t)},t.prototype.toDataURL=function(){this.refresh();var t=this._svgDom,e=t.outerHTML||(t.parentNode&&t.parentNode).innerHTML;return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(e.replace(/></g,">\n\r<"))},t}();function _w(t){return function(){w('In SVG mode painter not support method "'+t+'"')}}function xw(){return!1}function bw(t,e,i){var n=A(),r=e.getWidth(),o=e.getHeight(),a=n.style;return a&&(a.position="absolute",a.left="0",a.top="0",a.width=r+"px",a.height=o+"px",n.setAttribute("data-zr-dom-id",t)),n.width=r*i,n.height=o*i,n}var ww=function(t){function e(e,i,n){var r,o=t.call(this)||this;o.motionBlur=!1,o.lastFrameAlpha=.7,o.dpr=1,o.virtual=!1,o.config={},o.incremental=!1,o.zlevel=0,o.maxRepaintRectCount=5,o.__dirty=!0,o.__firstTimePaint=!0,o.__used=!1,o.__drawIndex=0,o.__startIndex=0,o.__endIndex=0,o.__prevStartIndex=null,o.__prevEndIndex=null,n=n||Bi,"string"==typeof e?r=bw(e,i,n):j(e)&&(e=(r=e).id),o.id=e,o.dom=r;var a=r.style;return a&&(r.onselectstart=xw,a.webkitUserSelect="none",a.userSelect="none",a.webkitTapHighlightColor="rgba(0,0,0,0)",a["-webkit-touch-callout"]="none",a.padding="0",a.margin="0",a.borderWidth="0"),o.domBack=null,o.ctxBack=null,o.painter=i,o.config=null,o.dpr=n,o}return i(e,t),e.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},e.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},e.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},e.prototype.setUnpainted=function(){this.__firstTimePaint=!0},e.prototype.createBackBuffer=function(){var t=this.dpr;this.domBack=bw("back-"+this.id,this.painter,t),this.ctxBack=this.domBack.getContext("2d"),1!==t&&this.ctxBack.scale(t,t)},e.prototype.createRepaintRects=function(t,e,i,n){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var r,o=[],a=this.maxRepaintRectCount,s=!1,l=new yn(0,0,0,0);function u(t){if(t.isFinite()&&!t.isZero())if(0===o.length)(e=new yn(0,0,0,0)).copy(t),o.push(e);else{for(var e,i=!1,n=1/0,r=0,u=0;u<o.length;++u){var c=o[u];if(c.intersect(t)){var h=new yn(0,0,0,0);h.copy(c),h.union(t),o[u]=h,i=!0;break}if(s){l.copy(t),l.union(c);var p=t.width*t.height,d=c.width*c.height,f=l.width*l.height-p-d;f<n&&(n=f,r=u)}}s&&(o[r].union(t),i=!0),i||((e=new yn(0,0,0,0)).copy(t),o.push(e)),s||(s=o.length>=a)}}for(var c=this.__startIndex;c<this.__endIndex;++c)if(d=t[c]){var h=d.shouldBePainted(i,n,!0,!0);(f=d.__isRendered&&(1&d.__dirty||!h)?d.getPrevPaintRect():null)&&u(f);var p=h&&(1&d.__dirty||!d.__isRendered)?d.getPaintRect():null;p&&u(p)}for(c=this.__prevStartIndex;c<this.__prevEndIndex;++c){var d,f;h=(d=e[c]).shouldBePainted(i,n,!0,!0),!d||h&&d.__zr||!d.__isRendered||(f=d.getPrevPaintRect())&&u(f)}do{for(r=!1,c=0;c<o.length;)if(o[c].isZero())o.splice(c,1);else{for(var m=c+1;m<o.length;)o[c].intersect(o[m])?(r=!0,o[c].union(o[m]),o.splice(m,1)):m++;c++}}while(r);return this._paintRects=o,o},e.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},e.prototype.resize=function(t,e){var i=this.dpr,n=this.dom,r=n.style,o=this.domBack;r&&(r.width=t+"px",r.height=e+"px"),n.width=t*i,n.height=e*i,o&&(o.width=t*i,o.height=e*i,1!==i&&this.ctxBack.scale(i,i))},e.prototype.clear=function(t,e,i){var n=this.dom,r=this.ctx,o=n.width,a=n.height;e=e||this.clearColor;var s=this.motionBlur&&!t,l=this.lastFrameAlpha,u=this.dpr,c=this;s&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(n,0,0,o/u,a/u));var h=this.domBack;function p(t,i,n,o){if(r.clearRect(t,i,n,o),e&&"transparent"!==e){var a=void 0;Y(e)?(a=e.__canvasGradient||rg(r,e,{x:0,y:0,width:n,height:o}),e.__canvasGradient=a):K(e)&&(a=dg(r,e,{dirty:function(){c.setUnpainted(),c.__painter.refresh()}})),r.save(),r.fillStyle=a||e,r.fillRect(t,i,n,o),r.restore()}s&&(r.save(),r.globalAlpha=l,r.drawImage(h,t,i,n,o),r.restore())}!i||s?p(0,0,o,a):i.length&&L(i,function(t){p(t.x*u,t.y*u,t.width*u,t.height*u)})},e}(Ut),Sw=1e5,Tw=314159,Mw=.01;function Iw(t){return parseInt(t,10)}var Cw=function(){function t(t,e,i,n){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var r=!t.nodeName||"CANVAS"===t.nodeName.toUpperCase();this._opts=i=I({},i||{}),this.dpr=i.devicePixelRatio||Bi,this._singleCanvas=r,this.root=t;var o=t.style;o&&(o.webkitTapHighlightColor="transparent",o.webkitUserSelect="none",o.userSelect="none",o["-webkit-touch-callout"]="none",t.innerHTML=""),this.storage=e;var a=this._zlevelList;this._prevDisplayList=[];var s=this._layers;if(r){var l=t,u=l.width,c=l.height;null!=i.width&&(u=i.width),null!=i.height&&(c=i.height),this.dpr=i.devicePixelRatio||1,l.width=u*this.dpr,l.height=c*this.dpr,this._width=u,this._height=c;var h=new ww(l,this,this.dpr);h.__builtin__=!0,h.initContext(),s[314159]=h,h.zlevel=Tw,a.push(Tw),this._domRoot=t}else{this._width=this._getSize(0),this._height=this._getSize(1);var p=this._domRoot=function(t,e){var i=document.createElement("div");return i.style.cssText=["position:relative","width:"+t+"px","height:"+e+"px","padding:0;margin:0;border-width:0"].join(";")+";",i}(this._width,this._height);t.appendChild(p)}}return t.prototype.getType=function(){return"canvas"},t.prototype.isSingleCanvas=function(){return this._singleCanvas},t.prototype.getViewportRoot=function(){return this._domRoot},t.prototype.getViewportRootOffset=function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},t.prototype.refresh=function(t){var e=this.storage.getDisplayList(!0),i=this._prevDisplayList,n=this._zlevelList;this._redrawId=Math.random(),this._paintList(e,i,t,this._redrawId);for(var r=0;r<n.length;r++){var o=n[r],a=this._layers[o];if(!a.__builtin__&&a.refresh){var s=0===r?this._backgroundColor:null;a.refresh(s)}}return this._opts.useDirtyRect&&(this._prevDisplayList=e.slice()),this},t.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},t.prototype._paintHoverList=function(t){var e=t.length,i=this._hoverlayer;if(i&&i.clear(),e){for(var n,r={inHover:!0,viewWidth:this._width,viewHeight:this._height},o=0;o<e;o++){var a=t[o];a.__inHover&&(i||(i=this._hoverlayer=this.getLayer(Sw)),n||(n=i.ctx).save(),wg(n,a,r,o===e-1))}n&&n.restore()}},t.prototype.getHoverLayer=function(){return this.getLayer(Sw)},t.prototype.paintOne=function(t,e){bg(t,e)},t.prototype._paintList=function(t,e,i,n){if(this._redrawId===n){i=i||!1,this._updateLayerStatus(t);var r=this._doPaintList(t,e,i),o=r.finished,a=r.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),a&&this._paintHoverList(t),o)this.eachLayer(function(t){t.afterBrush&&t.afterBrush()});else{var s=this;Me(function(){s._paintList(t,e,i,n)})}}},t.prototype._compositeManually=function(){var t=this.getLayer(Tw).ctx,e=this._domRoot.width,i=this._domRoot.height;t.clearRect(0,0,e,i),this.eachBuiltinLayer(function(n){n.virtual&&t.drawImage(n.dom,0,0,e,i)})},t.prototype._doPaintList=function(t,e,i){for(var n=this,r=[],o=this._opts.useDirtyRect,s=0;s<this._zlevelList.length;s++){var l=this._zlevelList[s],u=this._layers[l];u.__builtin__&&u!==this._hoverlayer&&(u.__dirty||i)&&r.push(u)}for(var c=!0,h=!1,p=function(a){var s,l=r[a],u=l.ctx,p=o&&l.createRepaintRects(t,e,d._width,d._height),f=i?l.__startIndex:l.__drawIndex,m=!i&&l.incremental&&Date.now,g=m&&Date.now(),y=l.zlevel===d._zlevelList[0]?d._backgroundColor:null;if(l.__startIndex===l.__endIndex)l.clear(!1,y,p);else if(f===l.__startIndex){var v=t[f];v.incremental&&v.notClear&&!i||l.clear(!1,y,p)}-1===f&&(console.error("For some unknown reason. drawIndex is -1"),f=l.__startIndex);var _=function(e){var i={inHover:!1,allClipped:!1,prevEl:null,viewWidth:n._width,viewHeight:n._height};for(s=f;s<l.__endIndex;s++){var r=t[s];if(r.__inHover&&(h=!0),n._doPaintEl(r,l,o,e,i,s===l.__endIndex-1),m&&Date.now()-g>15)break}i.prevElClipPaths&&u.restore()};if(p)if(0===p.length)s=l.__endIndex;else for(var x=d.dpr,b=0;b<p.length;++b){var w=p[b];u.save(),u.beginPath(),u.rect(w.x*x,w.y*x,w.width*x,w.height*x),u.clip(),_(w),u.restore()}else u.save(),_(),u.restore();l.__drawIndex=s,l.__drawIndex<l.__endIndex&&(c=!1)},d=this,f=0;f<r.length;f++)p(f);return a.wxa&&L(this._layers,function(t){t&&t.ctx&&t.ctx.draw&&t.ctx.draw()}),{finished:c,needsRefreshHover:h}},t.prototype._doPaintEl=function(t,e,i,n,r,o){var a=e.ctx;if(i){var s=t.getPaintRect();(!n||s&&s.intersect(n))&&(wg(a,t,r,o),t.setPrevPaintRect(s))}else wg(a,t,r,o)},t.prototype.getLayer=function(t,e){this._singleCanvas&&!this._needsManuallyCompositing&&(t=Tw);var i=this._layers[t];return i||((i=new ww("zr_"+t,this,this.dpr)).zlevel=t,i.__builtin__=!0,this._layerConfig[t]?T(i,this._layerConfig[t],!0):this._layerConfig[t-Mw]&&T(i,this._layerConfig[t-Mw],!0),e&&(i.virtual=e),this.insertLayer(t,i),i.initContext()),i},t.prototype.insertLayer=function(t,e){var i=this._layers,n=this._zlevelList,r=n.length,o=this._domRoot,a=null,s=-1;if(i[t])w("ZLevel "+t+" has been used already");else if(function(t){return!!t&&(!!t.__builtin__||"function"==typeof t.resize&&"function"==typeof t.refresh)}(e)){if(r>0&&t>n[0]){for(s=0;s<r-1&&!(n[s]<t&&n[s+1]>t);s++);a=i[n[s]]}if(n.splice(s+1,0,t),i[t]=e,!e.virtual)if(a){var l=a.dom;l.nextSibling?o.insertBefore(e.dom,l.nextSibling):o.appendChild(e.dom)}else o.firstChild?o.insertBefore(e.dom,o.firstChild):o.appendChild(e.dom);e.__painter=this}else w("Layer of zlevel "+t+" is not valid")},t.prototype.eachLayer=function(t,e){for(var i=this._zlevelList,n=0;n<i.length;n++){var r=i[n];t.call(e,this._layers[r],r)}},t.prototype.eachBuiltinLayer=function(t,e){for(var i=this._zlevelList,n=0;n<i.length;n++){var r=i[n],o=this._layers[r];o.__builtin__&&t.call(e,o,r)}},t.prototype.eachOtherLayer=function(t,e){for(var i=this._zlevelList,n=0;n<i.length;n++){var r=i[n],o=this._layers[r];o.__builtin__||t.call(e,o,r)}},t.prototype.getLayers=function(){return this._layers},t.prototype._updateLayerStatus=function(t){function e(t){o&&(o.__endIndex!==t&&(o.__dirty=!0),o.__endIndex=t)}if(this.eachBuiltinLayer(function(t,e){t.__dirty=t.__used=!1}),this._singleCanvas)for(var i=1;i<t.length;i++)if((s=t[i]).zlevel!==t[i-1].zlevel||s.incremental){this._needsManuallyCompositing=!0;break}var n,r,o=null,a=0;for(r=0;r<t.length;r++){var s,l=(s=t[r]).zlevel,u=void 0;n!==l&&(n=l,a=0),s.incremental?((u=this.getLayer(l+.001,this._needsManuallyCompositing)).incremental=!0,a=1):u=this.getLayer(l+(a>0?Mw:0),this._needsManuallyCompositing),u.__builtin__||w("ZLevel "+l+" has been used by unkown layer "+u.id),u!==o&&(u.__used=!0,u.__startIndex!==r&&(u.__dirty=!0),u.__startIndex=r,u.incremental?u.__drawIndex=-1:u.__drawIndex=r,e(r),o=u),1&s.__dirty&&!s.__inHover&&(u.__dirty=!0,u.incremental&&u.__drawIndex<0&&(u.__drawIndex=r))}e(r),this.eachBuiltinLayer(function(t,e){!t.__used&&t.getElementCount()>0&&(t.__dirty=!0,t.__startIndex=t.__endIndex=t.__drawIndex=0),t.__dirty&&t.__drawIndex<0&&(t.__drawIndex=t.__startIndex)})},t.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},t.prototype._clearLayer=function(t){t.clear()},t.prototype.setBackgroundColor=function(t){this._backgroundColor=t,L(this._layers,function(t){t.setUnpainted()})},t.prototype.configLayer=function(t,e){if(e){var i=this._layerConfig;i[t]?T(i[t],e,!0):i[t]=e;for(var n=0;n<this._zlevelList.length;n++){var r=this._zlevelList[n];r!==t&&r!==t+Mw||T(this._layers[r],i[t],!0)}}},t.prototype.delLayer=function(t){var e=this._layers,i=this._zlevelList,n=e[t];n&&(n.dom.parentNode.removeChild(n.dom),delete e[t],i.splice(k(i,t),1))},t.prototype.resize=function(t,e){if(this._domRoot.style){var i=this._domRoot;i.style.display="none";var n=this._opts;if(null!=t&&(n.width=t),null!=e&&(n.height=e),t=this._getSize(0),e=this._getSize(1),i.style.display="",this._width!==t||e!==this._height){for(var r in i.style.width=t+"px",i.style.height=e+"px",this._layers)this._layers.hasOwnProperty(r)&&this._layers[r].resize(t,e);this.refresh(!0)}this._width=t,this._height=e}else{if(null==t||null==e)return;this._width=t,this._height=e,this.getLayer(Tw).resize(t,e)}return this},t.prototype.clearLayer=function(t){var e=this._layers[t];e&&e.clear()},t.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},t.prototype.getRenderedCanvas=function(t){if(t=t||{},this._singleCanvas&&!this._compositeManually)return this._layers[314159].dom;var e=new ww("image",this,t.pixelRatio||this.dpr);e.initContext(),e.clear(!1,t.backgroundColor||this._backgroundColor);var i=e.ctx;if(t.pixelRatio<=this.dpr){this.refresh();var n=e.dom.width,r=e.dom.height;this.eachLayer(function(t){t.__builtin__?i.drawImage(t.dom,0,0,n,r):t.renderToCanvas&&(i.save(),t.renderToCanvas(i),i.restore())})}else for(var o={inHover:!1,viewWidth:this._width,viewHeight:this._height},a=this.storage.getDisplayList(!0),s=0,l=a.length;s<l;s++){var u=a[s];wg(i,u,o,s===l-1)}return e.dom},t.prototype.getWidth=function(){return this._width},t.prototype.getHeight=function(){return this._height},t.prototype._getSize=function(t){var e=this._opts,i=["width","height"][t],n=["clientWidth","clientHeight"][t],r=["paddingLeft","paddingTop"][t],o=["paddingRight","paddingBottom"][t];if(null!=e[i]&&"auto"!==e[i])return parseFloat(e[i]);var a=this.root,s=document.defaultView.getComputedStyle(a);return(a[n]||Iw(s[i])||Iw(a.style[i]))-(Iw(s[r])||0)-(Iw(s[o])||0)|0},t.prototype.pathToImage=function(t,e){e=e||this.dpr;var i=document.createElement("canvas"),n=i.getContext("2d"),r=t.getBoundingRect(),o=t.style,a=o.shadowBlur*e,s=o.shadowOffsetX*e,l=o.shadowOffsetY*e,u=t.hasStroke()?o.lineWidth:0,c=Math.max(u/2,-s+a),h=Math.max(u/2,s+a),p=Math.max(u/2,-l+a),d=Math.max(u/2,l+a),f=r.width+c+h,m=r.height+p+d;i.width=f*e,i.height=m*e,n.scale(e,e),n.clearRect(0,0,f,m),n.dpr=e;var g={x:t.x,y:t.y,scaleX:t.scaleX,scaleY:t.scaleY,rotation:t.rotation,originX:t.originX,originY:t.originY};t.x=c-r.x,t.y=p-r.y,t.rotation=0,t.scaleX=1,t.scaleY=1,t.updateTransform(),t&&wg(n,t,{inHover:!1,viewWidth:this._width,viewHeight:this._height},!0);var y=new rs({style:{x:0,y:0,image:i}});return I(t,g),y},t}(),Aw=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.hasSymbolVisual=!0,i}return i(e,t),e.prototype.getInitialData=function(t){return v_(null,this,{useEncodeDefaulter:!0})},e.prototype.getLegendIcon=function(t){var e=new Fn,i=eg("line",0,t.itemHeight/2,t.itemWidth,0,t.lineStyle.stroke,!1);e.add(i),i.setStyle(t.lineStyle);var n=this.getData().getVisual("symbol"),r=this.getData().getVisual("symbolRotate"),o="none"===n?"circle":n,a=.8*t.itemHeight,s=eg(o,(t.itemWidth-a)/2,(t.itemHeight-a)/2,a,a,t.itemStyle.fill);e.add(s),s.setStyle(t.itemStyle);var l="inherit"===t.iconRotate?r:t.iconRotate||0;return s.rotation=l*Math.PI/180,s.setOrigin([t.itemWidth/2,t.itemHeight/2]),o.indexOf("empty")>-1&&(s.style.stroke=s.style.fill,s.style.fill="#fff",s.style.lineWidth=2),e},e.type="series.line",e.dependencies=["grid","polar"],e.defaultOption={zlevel:0,z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0,lineStyle:{width:"bolder"}},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},e}(Of);function kw(t,e){var i=t.mapDimensionsAll("defaultedLabel"),n=i.length;if(1===n){var r=Od(t,e,i[0]);return null!=r?r+"":null}if(n){for(var o=[],a=0;a<i.length;a++)o.push(Od(t,e,i[a]));return o.join(" ")}}function Dw(t,e){var i=t.mapDimensionsAll("defaultedLabel");if(!U(e))return e+"";for(var n=[],r=0;r<i.length;r++){var o=t.getDimensionIndex(i[r]);o>=0&&n.push(e[o])}return n.join(" ")}var Ew=function(t){function e(e,i,n,r){var o=t.call(this)||this;return o.updateData(e,i,n,r),o}return i(e,t),e.prototype._createSymbol=function(t,e,i,n,r){this.removeAll();var o=eg(t,-1,-1,2,2,null,r);o.attr({z2:100,culling:!0,scaleX:n[0]/2,scaleY:n[1]/2}),o.drift=Pw,this._symbolType=t,this.add(o)},e.prototype.stopSymbolAnimation=function(t){this.childAt(0).stopAnimation(null,t)},e.prototype.getSymbolType=function(){return this._symbolType},e.prototype.getSymbolPath=function(){return this.childAt(0)},e.prototype.highlight=function(){Qs(this.childAt(0))},e.prototype.downplay=function(){tl(this.childAt(0))},e.prototype.setZ=function(t,e){var i=this.childAt(0);i.zlevel=t,i.z=e},e.prototype.setDraggable=function(t){var e=this.childAt(0);e.draggable=t,e.cursor=t?"move":e.cursor},e.prototype.updateData=function(t,i,n,r){this.silent=!1;var o=t.getItemVisual(i,"symbol")||"circle",a=t.hostModel,s=e.getSymbolSize(t,i),l=o!==this._symbolType,u=r&&r.disableAnimation;if(l){var c=t.getItemVisual(i,"symbolKeepAspect");this._createSymbol(o,t,i,s,c)}else{(p=this.childAt(0)).silent=!1;var h={scaleX:s[0]/2,scaleY:s[1]/2};u?p.attr(h):Bu(p,h,a,i),$u(p)}if(this._updateCommon(t,i,s,n,r),l){var p=this.childAt(0);u||(h={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:p.style.opacity}},p.scaleX=p.scaleY=0,p.style.opacity=0,Nu(p,h,a,i))}u&&this.childAt(0).stopAnimation("remove"),this._seriesModel=a},e.prototype._updateCommon=function(t,e,i,n,r){var o,a,s,l,u,c,h,p,d=this.childAt(0),f=t.hostModel;if(n&&(o=n.emphasisItemStyle,a=n.blurItemStyle,s=n.selectItemStyle,l=n.focus,u=n.blurScope,c=n.labelStatesModels,h=n.hoverScale,p=n.cursorStyle),!n||t.hasItemOption){var m=n&&n.itemModel?n.itemModel:t.getItemModel(e),g=m.getModel("emphasis");o=g.getModel("itemStyle").getItemStyle(),s=m.getModel(["select","itemStyle"]).getItemStyle(),a=m.getModel(["blur","itemStyle"]).getItemStyle(),l=g.get("focus"),u=g.get("blurScope"),c=bc(m),h=g.getShallow("scale"),p=m.getShallow("cursor")}var y=t.getItemVisual(e,"symbolRotate");d.attr("rotation",(y||0)*Math.PI/180||0);var v=ng(t.getItemVisual(e,"symbolOffset"),i);v&&(d.x=v[0],d.y=v[1]),p&&d.attr("cursor",p);var _=t.getItemVisual(e,"style"),x=_.fill;if(d instanceof rs){var b=d.style;d.useStyle(I({image:b.image,x:b.x,y:b.y,width:b.width,height:b.height},_))}else d.__isEmptyBrush?d.useStyle(I({},_)):d.useStyle(_),d.style.decal=null,d.setColor(x,r&&r.symbolInnerColor),d.style.strokeNoScale=!0;var w=t.getItemVisual(e,"liftZ"),S=this._z2;null!=w?null==S&&(this._z2=d.z2,d.z2+=w):null!=S&&(d.z2=S,this._z2=null);var T=r&&r.useNameLabel;xc(d,c,{labelFetcher:f,labelDataIndex:e,defaultText:function(e){return T?t.getName(e):kw(t,e)},inheritColor:x,defaultOpacity:_.opacity}),this._sizeX=i[0]/2,this._sizeY=i[1]/2;var M=d.ensureState("emphasis");if(M.style=o,d.ensureState("select").style=s,d.ensureState("blur").style=a,h){var C=Math.max(1.1,3/this._sizeY);M.scaleX=this._sizeX*C,M.scaleY=this._sizeY*C}this.setSymbolScale(1),pl(this,l,u)},e.prototype.setSymbolScale=function(t){this.scaleX=this.scaleY=t},e.prototype.fadeOut=function(t,e){var i=this.childAt(0),n=this._seriesModel,r=Ss(this).dataIndex,o=e&&e.animation;if(this.silent=i.silent=!0,e&&e.fadeLabel){var a=i.getTextContent();a&&Vu(a,{style:{opacity:0}},n,{dataIndex:r,removeOpt:o,cb:function(){i.removeTextContent()}})}else i.removeTextContent();Vu(i,{style:{opacity:0},scaleX:0,scaleY:0},n,{dataIndex:r,cb:t,removeOpt:o})},e.getSymbolSize=function(t,e){return ig(t.getItemVisual(e,"symbolSize"))},e}(Fn);function Pw(t,e){this.parent.drift(t,e)}function Lw(t,e,i,n){return e&&!isNaN(e[0])&&!isNaN(e[1])&&!(n.isIgnore&&n.isIgnore(i))&&!(n.clipShape&&!n.clipShape.contain(e[0],e[1]))&&"none"!==t.getItemVisual(i,"symbol")}function zw(t){return null==t||j(t)||(t={isIgnore:t}),t||{}}function Ow(t){var e=t.hostModel,i=e.getModel("emphasis");return{emphasisItemStyle:i.getModel("itemStyle").getItemStyle(),blurItemStyle:e.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:e.getModel(["select","itemStyle"]).getItemStyle(),focus:i.get("focus"),blurScope:i.get("blurScope"),hoverScale:i.get("scale"),labelStatesModels:bc(e),cursorStyle:e.get("cursor")}}var Rw=function(){function t(t){this.group=new Fn,this._SymbolCtor=t||Ew}return t.prototype.updateData=function(t,e){e=zw(e);var i=this.group,n=t.hostModel,r=this._data,o=this._SymbolCtor,a=e.disableAnimation,s=Ow(t),l={disableAnimation:a},u=e.getSymbolPoint||function(e){return t.getItemLayout(e)};r||i.removeAll(),t.diff(r).add(function(n){var r=u(n);if(Lw(t,r,n,e)){var a=new o(t,n,s,l);a.setPosition(r),t.setItemGraphicEl(n,a),i.add(a)}}).update(function(c,h){var p=r.getItemGraphicEl(h),d=u(c);if(Lw(t,d,c,e)){var f=t.getItemVisual(c,"symbol")||"circle",m=p&&p.getSymbolType&&p.getSymbolType();if(!p||m&&m!==f)i.remove(p),(p=new o(t,c,s,l)).setPosition(d);else{p.updateData(t,c,s,l);var g={x:d[0],y:d[1]};a?p.attr(g):Bu(p,g,n)}i.add(p),t.setItemGraphicEl(c,p)}else i.remove(p)}).remove(function(t){var e=r.getItemGraphicEl(t);e&&e.fadeOut(function(){i.remove(e)})}).execute(),this._getSymbolPoint=u,this._data=t},t.prototype.isPersistent=function(){return!0},t.prototype.updateLayout=function(){var t=this,e=this._data;e&&e.eachItemGraphicEl(function(e,i){var n=t._getSymbolPoint(i);e.setPosition(n),e.markRedraw()})},t.prototype.incrementalPrepareUpdate=function(t){this._seriesScope=Ow(t),this._data=null,this.group.removeAll()},t.prototype.incrementalUpdate=function(t,e,i){function n(t){t.isGroup||(t.incremental=!0,t.ensureState("emphasis").hoverLayer=!0)}i=zw(i);for(var r=t.start;r<t.end;r++){var o=e.getItemLayout(r);if(Lw(e,o,r,i)){var a=new this._SymbolCtor(e,r,this._seriesScope);a.traverse(n),a.setPosition(o),this.group.add(a),e.setItemGraphicEl(r,a)}}},t.prototype.remove=function(t){var e=this.group,i=this._data;i&&t?i.eachItemGraphicEl(function(t){t.fadeOut(function(){e.remove(t)})}):e.removeAll()},t}();function Bw(t,e,i){var n=t.getBaseAxis(),r=t.getOtherAxis(n),o=function(t,e){var i=0,n=t.scale.getExtent();return"start"===e?i=n[0]:"end"===e?i=n[1]:n[0]>0?i=n[0]:n[1]<0&&(i=n[1]),i}(r,i),a=n.dim,s=r.dim,l=e.mapDimension(s),u=e.mapDimension(a),c="x"===s||"radius"===s?1:0,h=z(t.dimensions,function(t){return e.mapDimension(t)}),p=!1,d=e.getCalculationInfo("stackResultDimension");return g_(e,h[0])&&(p=!0,h[0]=d),g_(e,h[1])&&(p=!0,h[1]=d),{dataDimsForPoint:h,valueStart:o,valueAxisDim:s,baseAxisDim:a,stacked:!!p,valueDim:l,baseDim:u,baseDataOffset:c,stackedOverDimension:e.getCalculationInfo("stackedOverDimension")}}function Nw(t,e,i,n){var r=NaN;t.stacked&&(r=i.get(i.getCalculationInfo("stackedOverDimension"),n)),isNaN(r)&&(r=t.valueStart);var o=t.baseDataOffset,a=[];return a[o]=i.get(t.baseDim,n),a[1-o]=r,e.dataToPoint(a)}var Fw="undefined"!=typeof Float32Array,Vw=Fw?Float32Array:Array;function Uw(t){return U(t)?Fw?new Float32Array(t):t:new Vw(t)}var Gw=Math.min,$w=Math.max;function Ww(t,e){return isNaN(t)||isNaN(e)}function Hw(t,e,i,n,r,o,a,s,l){for(var u,c,h,p,d,f,m=i,g=0;g<n;g++){var y=e[2*m],v=e[2*m+1];if(m>=r||m<0)break;if(Ww(y,v)){if(l){m+=o;continue}break}if(m===i)t[o>0?"moveTo":"lineTo"](y,v),h=y,p=v;else{var _=y-u,x=v-c;if(_*_+x*x<.5){m+=o;continue}if(a>0){for(var b=m+o,w=e[2*b],S=e[2*b+1];w===y&&S===v&&g<n;)g++,m+=o,w=e[2*(b+=o)],S=e[2*b+1],_=(y=e[2*m])-u,x=(v=e[2*m+1])-c;var T=g+1;if(l)for(;Ww(w,S)&&T<n;)T++,w=e[2*(b+=o)],S=e[2*b+1];var M=.5,I=0,C=0,A=void 0,k=void 0;if(T>=n||Ww(w,S))d=y,f=v;else{I=w-u,C=S-c;var D=y-u,E=w-y,P=v-c,L=S-v,z=void 0,O=void 0;"x"===s?(z=Math.abs(D),O=Math.abs(E),d=y-z*a,f=v,A=y+z*a,k=v):"y"===s?(z=Math.abs(P),O=Math.abs(L),d=y,f=v-z*a,A=y,k=v+z*a):(z=Math.sqrt(D*D+P*P),d=y-I*a*(1-(M=(O=Math.sqrt(E*E+L*L))/(O+z))),f=v-C*a*(1-M),k=v+C*a*M,A=Gw(A=y+I*a*M,$w(w,y)),k=Gw(k,$w(S,v)),A=$w(A,Gw(w,y)),f=v-(C=(k=$w(k,Gw(S,v)))-v)*z/O,d=Gw(d=y-(I=A-y)*z/O,$w(u,y)),f=Gw(f,$w(c,v)),A=y+(I=y-(d=$w(d,Gw(u,y))))*O/z,k=v+(C=v-(f=$w(f,Gw(c,v))))*O/z)}t.bezierCurveTo(h,p,d,f,y,v),h=A,p=k}else t.lineTo(y,v)}u=y,c=v,m+=o}return g}var jw=function(){this.smooth=0,this.smoothConstraint=!0},Zw=function(t){function e(e){var i=t.call(this,e)||this;return i.type="ec-polyline",i}return i(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new jw},e.prototype.buildPath=function(t,e){var i=e.points,n=0,r=i.length/2;if(e.connectNulls){for(;r>0&&Ww(i[2*r-2],i[2*r-1]);r--);for(;n<r&&Ww(i[2*n],i[2*n+1]);n++);}for(;n<r;)n+=Hw(t,i,n,r,r,1,e.smooth,e.smoothMonotone,e.connectNulls)+1},e.prototype.getPointOn=function(t,e){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var i,n,r=this.path.data,o=La.CMD,a="x"===e,s=[],l=0;l<r.length;){var u=void 0,c=void 0,h=void 0,p=void 0,d=void 0,f=void 0,m=void 0;switch(r[l++]){case o.M:i=r[l++],n=r[l++];break;case o.L:if(u=r[l++],c=r[l++],(m=a?(t-i)/(u-i):(t-n)/(c-n))<=1&&m>=0){var g=a?(c-n)*m+n:(u-i)*m+i;return a?[t,g]:[g,t]}i=u,n=c;break;case o.C:u=r[l++],c=r[l++],h=r[l++],p=r[l++],d=r[l++],f=r[l++];var y=a?Go(i,u,h,d,t,s):Go(n,c,p,f,t,s);if(y>0)for(var v=0;v<y;v++){var _=s[v];if(_<=1&&_>=0)return g=a?Vo(n,c,p,f,_):Vo(i,u,h,d,_),a?[t,g]:[g,t]}i=d,n=f}}},e}(Qa),qw=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(jw),Xw=function(t){function e(e){var i=t.call(this,e)||this;return i.type="ec-polygon",i}return i(e,t),e.prototype.getDefaultShape=function(){return new qw},e.prototype.buildPath=function(t,e){var i=e.points,n=e.stackedOnPoints,r=0,o=i.length/2,a=e.smoothMonotone;if(e.connectNulls){for(;o>0&&Ww(i[2*o-2],i[2*o-1]);o--);for(;r<o&&Ww(i[2*r],i[2*r+1]);r++);}for(;r<o;){var s=Hw(t,i,r,o,o,1,e.smooth,a,e.connectNulls);Hw(t,n,r+s-1,s,o,-1,e.stackedOnSmooth,a,e.connectNulls),r+=s+1,t.closePath()}},e}(Qa);function Yw(t,e,i,n,r){var o=t.getArea(),a=o.x,s=o.y,l=o.width,u=o.height,c=i.get(["lineStyle","width"])||2;s-=c/2,l+=c,u+=c;var h=new hs({shape:{x:a=Math.floor(a-=c/2),y:s,width:l=Math.round(l),height:u}});if(e){var p=t.getBaseAxis(),d=p.isHorizontal(),f=p.inverse;d?(f&&(h.shape.x+=l),h.shape.width=0):(f||(h.shape.y+=u),h.shape.height=0),Nu(h,{shape:{width:l,height:u,x:a,y:s}},i,null,n,"function"==typeof r?function(t){r(t,h)}:null)}return h}function Kw(t,e,i){var n=t.getArea(),r=Yn(n.r0,1),o=Yn(n.r,1),a=new ou({shape:{cx:Yn(t.cx,1),cy:Yn(t.cy,1),r0:r,r:o,startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}});return e&&("angle"===t.getBaseAxis().dim?a.shape.endAngle=n.startAngle:a.shape.r=r,Nu(a,{shape:{endAngle:n.endAngle,r:o}},i)),a}function Jw(t,e,i,n,r){return t?"polar"===t.type?Kw(t,e,i):"cartesian2d"===t.type?Yw(t,e,i,n,r):null:null}function Qw(t,e){return t.type===e}function tS(t,e){if(t.length===e.length){for(var i=0;i<t.length;i++)if(t[i]!==e[i])return;return!0}}function eS(t){for(var e=1/0,i=1/0,n=-1/0,r=-1/0,o=0;o<t.length;){var a=t[o++],s=t[o++];isNaN(a)||(e=Math.min(a,e),n=Math.max(a,n)),isNaN(s)||(i=Math.min(s,i),r=Math.max(s,r))}return[[e,i],[n,r]]}function iS(t,e){var i=eS(t),n=i[0],r=i[1],o=eS(e),a=o[0],s=o[1];return Math.max(Math.abs(n[0]-a[0]),Math.abs(n[1]-a[1]),Math.abs(r[0]-s[0]),Math.abs(r[1]-s[1]))}function nS(t){return"number"==typeof t?t:t?.5:0}function rS(t,e,i){for(var n=e.getBaseAxis(),r="x"===n.dim||"radius"===n.dim?0:1,o=[],a=0,s=[],l=[],u=[];a<t.length-2;a+=2)switch(u[0]=t[a+2],u[1]=t[a+3],l[0]=t[a],l[1]=t[a+1],o.push(l[0],l[1]),i){case"end":s[r]=u[r],s[1-r]=l[1-r],o.push(s[0],s[1]);break;case"middle":var c=(l[r]+u[r])/2,h=[];s[r]=h[r]=c,s[1-r]=l[1-r],h[1-r]=u[1-r],o.push(s[0],s[1]),o.push(h[0],h[1]);break;default:s[r]=l[r],s[1-r]=u[1-r],o.push(s[0],s[1])}return o.push(t[a++],t[a++]),o}function oS(t,e,i){var n=t.getVisual("visualMeta");if(n&&n.length&&t.count()&&"cartesian2d"===e.type){for(var r,o,a=n.length-1;a>=0;a--){var s=t.getDimensionInfo(n[a].dimension);if("x"===(r=s&&s.coordDim)||"y"===r){o=n[a];break}}if(o){var l=e.getAxis(r),u=z(o.stops,function(t){return{coord:l.toGlobalCoord(l.dataToCoord(t.value)),color:t.color}}),c=u.length,h=o.outerColors.slice();c&&u[0].coord>u[c-1].coord&&(u.reverse(),h.reverse());var p=function(t,e){var i,n,r=[],o=t.length;function a(t,e,i){var n=t.coord;return{coord:i,color:Ye((i-n)/(e.coord-n),[t.color,e.color])}}for(var s=0;s<o;s++){var l=t[s],u=l.coord;if(u<0)i=l;else{if(u>e){n?r.push(a(n,l,e)):i&&r.push(a(i,l,0),a(i,l,e));break}i&&(r.push(a(i,l,0)),i=null),r.push(l),n=l}}return r}(u,"x"===r?i.getWidth():i.getHeight()),d=p.length;if(!d&&c)return u[0].coord<0?h[1]?h[1]:u[c-1].color:h[0]?h[0]:u[0].color;var f=p[0].coord-10,m=p[d-1].coord+10,g=m-f;if(g<.001)return"transparent";L(p,function(t){t.offset=(t.coord-f)/g}),p.push({offset:d?p[d-1].offset:.5,color:h[1]||"transparent"}),p.unshift({offset:d?p[0].offset:.5,color:h[0]||"transparent"});var y=new Mu(0,0,0,0,p,!0);return y[r]=f,y[r+"2"]=m,y}}}function aS(t,e,i){var n=t.get("showAllSymbol"),r="auto"===n;if(!n||r){var o=i.getAxesByScale("ordinal")[0];if(o&&(!r||!function(t,e){var i=t.getExtent(),n=Math.abs(i[1]-i[0])/t.scale.count();isNaN(n)&&(n=0);for(var r=e.count(),o=Math.max(1,Math.round(r/5)),a=0;a<r;a+=o)if(1.5*Ew.getSymbolSize(e,a)[t.isHorizontal()?1:0]>n)return!1;return!0}(o,e))){var a=e.mapDimension(o.dim),s={};return L(o.getViewLabels(),function(t){var e=o.scale.getRawOrdinalNumber(t.tickValue);s[e]=1}),function(t){return!s.hasOwnProperty(e.get(a,t))}}}}function sS(t,e){return[t[2*e],t[2*e+1]]}function lS(t){if(t.get(["endLabel","show"]))return!0;for(var e=0;e<As.length;e++)if(t.get([As[e],"endLabel","show"]))return!0;return!1}function uS(t,e,i,n){if(Qw(e,"cartesian2d")){var r=n.getModel("endLabel"),o=r.get("valueAnimation"),a=n.getData(),s={lastFrameIndex:0},l=lS(n)?function(i,n){t._endLabelOnDuring(i,n,a,s,o,r,e)}:null,u=e.getBaseAxis().isHorizontal(),c=Yw(e,i,n,function(){var e=t._endLabel;e&&i&&null!=s.originalX&&e.attr({x:s.originalX,y:s.originalY})},l);if(!n.get("clip",!0)){var h=c.shape,p=Math.max(h.width,h.height);u?(h.y-=p,h.height+=2*p):(h.x-=p,h.width+=2*p)}return l&&l(1,c),c}return Kw(e,i,n)}var cS=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.init=function(){var t=new Fn,e=new Rw;this.group.add(e.group),this._symbolDraw=e,this._lineGroup=t},e.prototype.render=function(t,e,i){var n=this,r=t.coordinateSystem,o=this.group,a=t.getData(),s=t.getModel("lineStyle"),l=t.getModel("areaStyle"),u=a.getLayout("points")||[],c="polar"===r.type,h=this._coordSys,p=this._symbolDraw,d=this._polyline,f=this._polygon,m=this._lineGroup,g=t.get("animation"),y=!l.isEmpty(),v=l.get("origin"),_=Bw(r,a,v),x=y&&function(t,e,i){if(!i.valueDim)return[];for(var n=e.count(),r=Uw(2*n),o=0;o<n;o++){var a=Nw(i,t,e,o);r[2*o]=a[0],r[2*o+1]=a[1]}return r}(r,a,_),b=t.get("showSymbol"),w=b&&!c&&aS(t,a,r),S=this._data;S&&S.eachItemGraphicEl(function(t,e){t.__temp&&(o.remove(t),S.setItemGraphicEl(e,null))}),b||p.remove(),o.add(m);var T,M=!c&&t.get("step");r&&r.getArea&&t.get("clip",!0)&&(null!=(T=r.getArea()).width?(T.x-=.1,T.y-=.1,T.width+=.2,T.height+=.2):T.r0&&(T.r0-=.5,T.r+=.5)),this._clipShapeForSymbol=T;var I=oS(a,r,i)||a.getVisual("style")[a.getVisual("drawType")];if(d&&h.type===r.type&&M===this._step){y&&!f?f=this._newPolygon(u,x):f&&!y&&(m.remove(f),f=this._polygon=null),c||this._initOrUpdateEndLabel(t,r,Gh(I));var A=m.getClipPath();A?Nu(A,{shape:uS(this,r,!1,t).shape},t):m.setClipPath(uS(this,r,!0,t)),b&&p.updateData(a,{isIgnore:w,clipShape:T,disableAnimation:!0,getSymbolPoint:function(t){return[u[2*t],u[2*t+1]]}}),tS(this._stackedOnPoints,x)&&tS(this._points,u)||(g?this._doUpdateAnimation(a,x,r,i,M,v):(M&&(u=rS(u,r,M),x&&(x=rS(x,r,M))),d.setShape({points:u}),f&&f.setShape({points:u,stackedOnPoints:x})))}else b&&p.updateData(a,{isIgnore:w,clipShape:T,disableAnimation:!0,getSymbolPoint:function(t){return[u[2*t],u[2*t+1]]}}),g&&this._initSymbolLabelAnimation(a,r,T),M&&(u=rS(u,r,M),x&&(x=rS(x,r,M))),d=this._newPolyline(u),y&&(f=this._newPolygon(u,x)),c||this._initOrUpdateEndLabel(t,r,Gh(I)),m.setClipPath(uS(this,r,!0,t));var k=t.get(["emphasis","focus"]),D=t.get(["emphasis","blurScope"]);d.useStyle(C(s.getLineStyle(),{fill:"none",stroke:I,lineJoin:"bevel"})),gl(d,t,"lineStyle"),d.style.lineWidth>0&&"bolder"===t.get(["emphasis","lineStyle","width"])&&(d.getState("emphasis").style.lineWidth=+d.style.lineWidth+1),Ss(d).seriesIndex=t.seriesIndex,pl(d,k,D);var E=nS(t.get("smooth")),P=t.get("smoothMonotone"),L=t.get("connectNulls");if(d.setShape({smooth:E,smoothMonotone:P,connectNulls:L}),f){var z=a.getCalculationInfo("stackedOnSeries"),O=0;f.useStyle(C(l.getAreaStyle(),{fill:I,opacity:.7,lineJoin:"bevel",decal:a.getVisual("style").decal})),z&&(O=nS(z.get("smooth"))),f.setShape({smooth:E,stackedOnSmooth:O,smoothMonotone:P,connectNulls:L}),gl(f,t,"areaStyle"),Ss(f).seriesIndex=t.seriesIndex,pl(f,k,D)}var R=function(t){n._changePolyState(t)};a.eachItemGraphicEl(function(t){t&&(t.onHoverStateChange=R)}),this._polyline.onHoverStateChange=R,this._data=a,this._coordSys=r,this._stackedOnPoints=x,this._points=u,this._step=M,this._valueOrigin=v,t.get("triggerLineEvent")&&(this.packEventData(t,d),f&&this.packEventData(t,f))},e.prototype.packEventData=function(t,e){Ss(e).eventData={componentType:"series",componentSubType:"line",componentIndex:t.componentIndex,seriesIndex:t.seriesIndex,seriesName:t.name,seriesType:"line"}},e.prototype.highlight=function(t,e,i,n){var r=t.getData(),o=Lr(r,n);if(this._changePolyState("emphasis"),!(o instanceof Array)&&null!=o&&o>=0){var a=r.getLayout("points"),s=r.getItemGraphicEl(o);if(!s){var l=a[2*o],u=a[2*o+1];if(isNaN(l)||isNaN(u))return;if(this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(l,u))return;var c=t.get("zlevel"),h=t.get("z");(s=new Ew(r,o)).x=l,s.y=u,s.setZ(c,h);var p=s.getSymbolPath().getTextContent();p&&(p.zlevel=c,p.z=h,p.z2=this._polyline.z2+1),s.__temp=!0,r.setItemGraphicEl(o,s),s.stopSymbolAnimation(!0),this.group.add(s)}s.highlight()}else Zf.prototype.highlight.call(this,t,e,i,n)},e.prototype.downplay=function(t,e,i,n){var r=t.getData(),o=Lr(r,n);if(this._changePolyState("normal"),null!=o&&o>=0){var a=r.getItemGraphicEl(o);a&&(a.__temp?(r.setItemGraphicEl(o,null),this.group.remove(a)):a.downplay())}else Zf.prototype.downplay.call(this,t,e,i,n)},e.prototype._changePolyState=function(t){var e=this._polygon;qs(this._polyline,t),e&&qs(e,t)},e.prototype._newPolyline=function(t){var e=this._polyline;return e&&this._lineGroup.remove(e),e=new Zw({shape:{points:t},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(e),this._polyline=e,e},e.prototype._newPolygon=function(t,e){var i=this._polygon;return i&&this._lineGroup.remove(i),i=new Xw({shape:{points:t,stackedOnPoints:e},segmentIgnoreThreshold:2}),this._lineGroup.add(i),this._polygon=i,i},e.prototype._initSymbolLabelAnimation=function(t,e,i){var n,r,o=e.getBaseAxis(),a=o.inverse;"cartesian2d"===e.type?(n=o.isHorizontal(),r=!1):"polar"===e.type&&(n="angle"===o.dim,r=!0);var s=t.hostModel,l=s.get("animationDuration");"function"==typeof l&&(l=l(null));var u=s.get("animationDelay")||0,c="function"==typeof u?u(null):u;t.eachItemGraphicEl(function(t,o){var s=t;if(s){var h=[t.x,t.y],p=void 0,d=void 0,f=void 0;if(i)if(r){var m=i,g=e.pointToCoord(h);n?(p=m.startAngle,d=m.endAngle,f=-g[1]/180*Math.PI):(p=m.r0,d=m.r,f=g[0])}else{var y=i;n?(p=y.x,d=y.x+y.width,f=t.x):(p=y.y+y.height,d=y.y,f=t.y)}var v=d===p?0:(f-p)/(d-p);a&&(v=1-v);var _="function"==typeof u?u(o):l*v+c,x=s.getSymbolPath(),b=x.getTextContent();s.attr({scaleX:0,scaleY:0}),s.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:_}),b&&b.animateFrom({style:{opacity:0}},{duration:300,delay:_}),x.disableLabelAnimation=!0}})},e.prototype._initOrUpdateEndLabel=function(t,e,i){var n=t.getModel("endLabel");if(lS(t)){var r=t.getData(),o=this._polyline,a=this._endLabel;a||((a=this._endLabel=new fs({z2:200})).ignoreClip=!0,o.setTextContent(this._endLabel),o.disableLabelAnimation=!0);var s=function(t){for(var e,i,n=t.length/2;n>0&&(e=t[2*n-2],i=t[2*n-1],isNaN(e)||isNaN(i));n--);return n-1}(r.getLayout("points"));s>=0&&(xc(o,bc(t,"endLabel"),{inheritColor:i,labelFetcher:t,labelDataIndex:s,defaultText:function(t,e,i){return null!=i?Dw(r,i):kw(r,t)},enableTextSetter:!0},function(t,e){var i=e.getBaseAxis(),n=i.isHorizontal(),r=i.inverse,o=n?r?"right":"left":"center",a=n?"middle":r?"top":"bottom";return{normal:{align:t.get("align")||o,verticalAlign:t.get("verticalAlign")||a}}}(n,e)),o.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},e.prototype._endLabelOnDuring=function(t,e,i,n,r,o,a){var s=this._endLabel,l=this._polyline;if(s){t<1&&null==n.originalX&&(n.originalX=s.x,n.originalY=s.y);var u=i.getLayout("points"),c=i.hostModel,h=c.get("connectNulls"),p=o.get("precision"),d=o.get("distance")||0,f=a.getBaseAxis(),m=f.isHorizontal(),g=f.inverse,y=e.shape,v=g?m?y.x:y.y+y.height:m?y.x+y.width:y.y,_=(m?d:0)*(g?-1:1),x=(m?0:-d)*(g?-1:1),b=m?"x":"y",w=function(t,e,i){for(var n,r,o=t.length/2,a="x"===i?0:1,s=0,l=-1,u=0;u<o;u++)if(r=t[2*u+a],!isNaN(r)&&!isNaN(t[2*u+1-a]))if(0!==u){if(n<=e&&r>=e||n>=e&&r<=e){l=u;break}s=u,n=r}else n=r;return{range:[s,l],t:(e-n)/(r-n)}}(u,v,b),S=w.range,T=S[1]-S[0],M=void 0;if(T>=1){if(T>1&&!h){var I=sS(u,S[0]);s.attr({x:I[0]+_,y:I[1]+x}),r&&(M=c.getRawValue(S[0]))}else{(I=l.getPointOn(v,b))&&s.attr({x:I[0]+_,y:I[1]+x});var C=c.getRawValue(S[0]),A=c.getRawValue(S[1]);r&&(M=$r(i,p,C,A,w.t))}n.lastFrameIndex=S[0]}else{var k=1===t||n.lastFrameIndex>0?S[0]:0;I=sS(u,k),r&&(M=c.getRawValue(k)),s.attr({x:I[0]+_,y:I[1]+x})}r&&kc(s).setLabelText(M)}},e.prototype._doUpdateAnimation=function(t,e,i,n,r,o){var a=this._polyline,s=this._polygon,l=t.hostModel,u=function(t,e,i,n,r,o,a,s){for(var l=function(t,e){var i=[];return e.diff(t).add(function(t){i.push({cmd:"+",idx:t})}).update(function(t,e){i.push({cmd:"=",idx:e,idx1:t})}).remove(function(t){i.push({cmd:"-",idx:t})}).execute(),i}(t,e),u=[],c=[],h=[],p=[],d=[],f=[],m=[],g=Bw(r,e,a),y=t.getLayout("points")||[],v=e.getLayout("points")||[],_=0;_<l.length;_++){var x=l[_],b=!0,w=void 0,S=void 0;switch(x.cmd){case"=":w=2*x.idx,S=2*x.idx1;var T=y[w],M=y[w+1],I=v[S],C=v[S+1];(isNaN(T)||isNaN(M))&&(T=I,M=C),u.push(T,M),c.push(I,C),h.push(i[w],i[w+1]),p.push(n[S],n[S+1]),m.push(e.getRawIndex(x.idx1));break;case"+":var A=x.idx,k=g.dataDimsForPoint,D=r.dataToPoint([e.get(k[0],A),e.get(k[1],A)]);S=2*A,u.push(D[0],D[1]),c.push(v[S],v[S+1]);var E=Nw(g,r,e,A);h.push(E[0],E[1]),p.push(n[S],n[S+1]),m.push(e.getRawIndex(A));break;case"-":b=!1}b&&(d.push(x),f.push(f.length))}f.sort(function(t,e){return m[t]-m[e]});var P=u.length,L=Uw(P),z=Uw(P),O=Uw(P),R=Uw(P),B=[];for(_=0;_<f.length;_++){var N=f[_],F=2*_,V=2*N;L[F]=u[V],L[F+1]=u[V+1],z[F]=c[V],z[F+1]=c[V+1],O[F]=h[V],O[F+1]=h[V+1],R[F]=p[V],R[F+1]=p[V+1],B[_]=d[N]}return{current:L,next:z,stackedOnCurrent:O,stackedOnNext:R,status:B}}(this._data,t,this._stackedOnPoints,e,this._coordSys,0,this._valueOrigin),c=u.current,h=u.stackedOnCurrent,p=u.next,d=u.stackedOnNext;if(r&&(c=rS(u.current,i,r),h=rS(u.stackedOnCurrent,i,r),p=rS(u.next,i,r),d=rS(u.stackedOnNext,i,r)),iS(c,p)>3e3||s&&iS(h,d)>3e3)return a.stopAnimation(),a.setShape({points:p}),void(s&&(s.stopAnimation(),s.setShape({points:p,stackedOnPoints:d})));a.shape.__points=u.current,a.shape.points=c;var f={shape:{points:p}};u.current!==c&&(f.shape.__points=u.next),a.stopAnimation(),Bu(a,f,l),s&&(s.setShape({points:c,stackedOnPoints:h}),s.stopAnimation(),Bu(s,{shape:{stackedOnPoints:d}},l),a.shape.points!==s.shape.points&&(s.shape.points=a.shape.points));for(var m=[],g=u.status,y=0;y<g.length;y++)if("="===g[y].cmd){var v=t.getItemGraphicEl(g[y].idx1);v&&m.push({el:v,ptIdx:y})}a.animators&&a.animators.length&&a.animators[0].during(function(){s&&s.dirtyShape();for(var t=a.shape.__points,e=0;e<m.length;e++){var i=m[e].el,n=2*m[e].ptIdx;i.x=t[n],i.y=t[n+1],i.markRedraw()}})},e.prototype.remove=function(t){var e=this.group,i=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),i&&i.eachItemGraphicEl(function(t,n){t.__temp&&(e.remove(t),i.setItemGraphicEl(n,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},e.type="line",e}(Zf);function hS(t,e){return{seriesType:t,plan:Wf(),reset:function(t){var i=t.getData(),n=t.coordinateSystem,r=t.pipelineContext,o=e||r.large;if(n){var a=z(n.dimensions,function(t){return i.mapDimension(t)}).slice(0,2),s=a.length,l=i.getCalculationInfo("stackResultDimension");g_(i,a[0])&&(a[0]=l),g_(i,a[1])&&(a[1]=l);var u=i.getStore(),c=i.getDimensionIndex(a[0]),h=i.getDimensionIndex(a[1]);return s&&{progress:function(t,e){for(var i=t.end-t.start,r=o&&Uw(i*s),a=[],l=[],p=t.start,d=0;p<t.end;p++){var f=void 0;if(1===s){var m=u.get(c,p);f=n.dataToPoint(m,null,l)}else a[0]=u.get(c,p),a[1]=u.get(h,p),f=n.dataToPoint(a,null,l);o?(r[d++]=f[0],r[d++]=f[1]):e.setItemLayout(p,f.slice())}o&&e.setLayout("points",r)}}}}}}var pS={average:function(t){for(var e=0,i=0,n=0;n<t.length;n++)isNaN(t[n])||(e+=t[n],i++);return 0===i?NaN:e/i},sum:function(t){for(var e=0,i=0;i<t.length;i++)e+=t[i]||0;return e},max:function(t){for(var e=-1/0,i=0;i<t.length;i++)t[i]>e&&(e=t[i]);return isFinite(e)?e:NaN},min:function(t){for(var e=1/0,i=0;i<t.length;i++)t[i]<e&&(e=t[i]);return isFinite(e)?e:NaN},nearest:function(t){return t[0]}},dS=function(t){return Math.round(t.length/2)};function fS(t){return{seriesType:t,reset:function(t,e,i){var n=t.getData(),r=t.get("sampling"),o=t.coordinateSystem,a=n.count();if(a>10&&"cartesian2d"===o.type&&r){var s=o.getBaseAxis(),l=o.getOtherAxis(s),u=s.getExtent(),c=i.getDevicePixelRatio(),h=Math.abs(u[1]-u[0])*(c||1),p=Math.round(a/h);if(p>1){"lttb"===r&&t.setData(n.lttbDownSample(n.mapDimension(l.dim),1/p));var d=void 0;"string"==typeof r?d=pS[r]:"function"==typeof r&&(d=r),d&&t.setData(n.downSample(n.mapDimension(l.dim),1/p,d,dS))}}}}}var mS=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.getInitialData=function(t,e){return v_(null,this,{useEncodeDefaulter:!0})},e.prototype.getMarkerPosition=function(t){var e=this.coordinateSystem;if(e&&e.clampData){var i=e.dataToPoint(e.clampData(t)),n=this.getData(),r=n.getLayout("offset"),o=n.getLayout("size");return i[e.getBaseAxis().isHorizontal()?0:1]+=r+o/2,i}return[NaN,NaN]},e.type="series.__base_bar__",e.defaultOption={zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},e}(Of);Of.registerClass(mS);var gS=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.getInitialData=function(){return v_(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},e.prototype.getProgressive=function(){return!!this.get("large")&&this.get("progressive")},e.prototype.getProgressiveThreshold=function(){var t=this.get("progressiveThreshold"),e=this.get("largeThreshold");return e>t&&(t=e),t},e.prototype.brushSelector=function(t,e,i){return i.rect(e.getItemLayout(t))},e.type="series.bar",e.dependencies=["grid","polar"],e.defaultOption=jc(mS.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),e}(mS),yS=function(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0},vS=function(t){function e(e){var i=t.call(this,e)||this;return i.type="sausage",i}return i(e,t),e.prototype.getDefaultShape=function(){return new yS},e.prototype.buildPath=function(t,e){var i=e.cx,n=e.cy,r=Math.max(e.r0||0,0),o=Math.max(e.r,0),a=.5*(o-r),s=r+a,l=e.startAngle,u=e.endAngle,c=e.clockwise,h=Math.cos(l),p=Math.sin(l),d=Math.cos(u),f=Math.sin(u);(c?u-l<2*Math.PI:l-u<2*Math.PI)&&(t.moveTo(h*r+i,p*r+n),t.arc(h*s+i,p*s+n,a,-Math.PI+l,l,!c)),t.arc(i,n,o,l,u,!c),t.moveTo(d*o+i,f*o+n),t.arc(d*s+i,f*s+n,a,u-2*Math.PI,u-Math.PI,!c),0!==r&&(t.arc(i,n,r,u,l,c),t.moveTo(h*r+i,f*r+n)),t.closePath()},e}(Qa);function _S(t,e,i){return e*Math.sin(t)*(i?-1:1)}function xS(t,e,i){return e*Math.cos(t)*(i?1:-1)}var bS=[0,0],wS=Math.max,SS=Math.min,TS=function(t){function e(){var i=t.call(this)||this;return i.type=e.type,i._isFirstFrame=!0,i}return i(e,t),e.prototype.render=function(t,e,i,n){this._model=t,this._removeOnRenderedListener(i),this._updateDrawMode(t);var r=t.get("coordinateSystem");("cartesian2d"===r||"polar"===r)&&(this._isLargeDraw?this._renderLarge(t,e,i):this._renderNormal(t,e,i,n))},e.prototype.incrementalPrepareRender=function(t){this._clear(),this._updateDrawMode(t),this._updateLargeClip(t)},e.prototype.incrementalRender=function(t,e){this._incrementalRenderLarge(t,e)},e.prototype._updateDrawMode=function(t){var e=t.pipelineContext.large;null!=this._isLargeDraw&&e===this._isLargeDraw||(this._isLargeDraw=e,this._clear())},e.prototype._renderNormal=function(t,e,i,n){var r,o=this.group,a=t.getData(),s=this._data,l=t.coordinateSystem,u=l.getBaseAxis();"cartesian2d"===l.type?r=u.isHorizontal():"polar"===l.type&&(r="angle"===u.dim);var c=t.isAnimationEnabled()?t:null,h=function(t,e){var i=t.get("realtimeSort",!0),n=e.getBaseAxis();if(i&&"category"===n.type&&"cartesian2d"===e.type)return{baseAxis:n,otherAxis:e.getOtherAxis(n)}}(t,l);h&&this._enableRealtimeSort(h,a,i);var p=t.get("clip",!0)||h,d=function(t,e){var i=t.getArea&&t.getArea();if(Qw(t,"cartesian2d")){var n=t.getBaseAxis();if("category"!==n.type||!n.onBand){var r=e.getLayout("bandWidth");n.isHorizontal()?(i.x-=r,i.width+=2*r):(i.y-=r,i.height+=2*r)}}return i}(l,a);o.removeClipPath();var f=t.get("roundCap",!0),m=t.get("showBackground",!0),g=t.getModel("backgroundStyle"),y=g.get("borderRadius")||0,v=[],_=this._backgroundEls,x=n&&n.isInitSort,b=n&&"changeAxisOrder"===n.type;function w(t){var e=PS[l.type](a,t),i=function(t,e,i){return new("polar"===t.type?ou:hs)({shape:FS(e,i,t),silent:!0,z2:0})}(l,r,e);return i.useStyle(g.getItemStyle()),"cartesian2d"===l.type&&i.setShape("r",y),v[t]=i,i}a.diff(s).add(function(e){var i=a.getItemModel(e),n=PS[l.type](a,e,i);if(m&&w(e),a.hasValue(e)&&ES[l.type](n)){var s=!1;p&&(s=MS[l.type](d,n));var g=IS[l.type](t,a,e,n,r,c,u.model,!1,f);h&&(g.forceLabelAnimation=!0),zS(g,a,e,i,n,t,r,"polar"===l.type),x?g.attr({shape:n}):h?CS(h,c,g,n,e,r,!1,!1):Nu(g,{shape:n},t,e),a.setItemGraphicEl(e,g),o.add(g),g.ignore=s}}).update(function(e,i){var n=a.getItemModel(e),S=PS[l.type](a,e,n);if(m){var T=void 0;0===_.length?T=w(i):((T=_[i]).useStyle(g.getItemStyle()),"cartesian2d"===l.type&&T.setShape("r",y),v[e]=T);var M=PS[l.type](a,e);Bu(T,{shape:FS(r,M,l)},c,e)}var I=s.getItemGraphicEl(i);if(a.hasValue(e)&&ES[l.type](S)){var C=!1;if(p&&(C=MS[l.type](d,S))&&o.remove(I),I?$u(I):I=IS[l.type](t,a,e,S,r,c,u.model,!!I,f),h&&(I.forceLabelAnimation=!0),b){var A=I.getTextContent();if(A){var k=kc(A);null!=k.prevValue&&(k.prevValue=k.value)}}b||zS(I,a,e,n,S,t,r,"polar"===l.type),x?I.attr({shape:S}):h?CS(h,c,I,S,e,r,!0,b):Bu(I,{shape:S},t,e,null),a.setItemGraphicEl(e,I),I.ignore=C,o.add(I)}else o.remove(I)}).remove(function(e){var i=s.getItemGraphicEl(e);i&&Gu(i,t,e)}).execute();var S=this._backgroundGroup||(this._backgroundGroup=new Fn);S.removeAll();for(var T=0;T<v.length;++T)S.add(v[T]);o.add(S),this._backgroundEls=v,this._data=a},e.prototype._renderLarge=function(t,e,i){this._clear(),BS(t,this.group),this._updateLargeClip(t)},e.prototype._incrementalRenderLarge=function(t,e){this._removeBackground(),BS(e,this.group,!0)},e.prototype._updateLargeClip=function(t){var e=t.get("clip",!0)?Jw(t.coordinateSystem,!1,t):null;e?this.group.setClipPath(e):this.group.removeClipPath()},e.prototype._enableRealtimeSort=function(t,e,i){var n=this;if(e.count()){var r=t.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(e,t,i),this._isFirstFrame=!1;else{var o=function(t){var i=e.getItemGraphicEl(t);if(i){var n=i.shape;return(r.isHorizontal()?Math.abs(n.height):Math.abs(n.width))||0}return 0};this._onRendered=function(){n._updateSortWithinSameData(e,o,r,i)},i.getZr().on("rendered",this._onRendered)}}},e.prototype._dataSort=function(t,e,i){var n=[];return t.each(t.mapDimension(e.dim),function(t,e){var r=i(e);r=null==r?NaN:r,n.push({dataIndex:e,mappedValue:r,ordinalNumber:t})}),n.sort(function(t,e){return e.mappedValue-t.mappedValue}),{ordinalNumbers:z(n,function(t){return t.ordinalNumber})}},e.prototype._isOrderChangedWithinSameData=function(t,e,i){for(var n=i.scale,r=t.mapDimension(i.dim),o=Number.MAX_VALUE,a=0,s=n.getOrdinalMeta().categories.length;a<s;++a){var l=t.rawIndexOf(r,n.getRawOrdinalNumber(a)),u=l<0?5e-324:e(t.indexOfRawIndex(l));if(u>o)return!0;o=u}return!1},e.prototype._isOrderDifferentInView=function(t,e){for(var i=e.scale,n=i.getExtent(),r=Math.max(0,n[0]),o=Math.min(n[1],i.getOrdinalMeta().categories.length-1);r<=o;++r)if(t.ordinalNumbers[r]!==i.getRawOrdinalNumber(r))return!0},e.prototype._updateSortWithinSameData=function(t,e,i,n){if(this._isOrderChangedWithinSameData(t,e,i)){var r=this._dataSort(t,i,e);this._isOrderDifferentInView(r,i)&&(this._removeOnRenderedListener(n),n.dispatchAction({type:"changeAxisOrder",componentType:i.dim+"Axis",axisId:i.index,sortInfo:r}))}},e.prototype._dispatchInitSort=function(t,e,i){var n=e.baseAxis,r=this._dataSort(t,n,function(i){return t.get(t.mapDimension(e.otherAxis.dim),i)});i.dispatchAction({type:"changeAxisOrder",componentType:n.dim+"Axis",isInitSort:!0,axisId:n.index,sortInfo:r})},e.prototype.remove=function(t,e){this._clear(this._model),this._removeOnRenderedListener(e)},e.prototype.dispose=function(t,e){this._removeOnRenderedListener(e)},e.prototype._removeOnRenderedListener=function(t){this._onRendered&&(t.getZr().off("rendered",this._onRendered),this._onRendered=null)},e.prototype._clear=function(t){var e=this.group,i=this._data;t&&t.isAnimationEnabled()&&i&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],i.eachItemGraphicEl(function(e){Gu(e,t,Ss(e).dataIndex)})):e.removeAll(),this._data=null,this._isFirstFrame=!0},e.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},e.type="bar",e}(Zf),MS={cartesian2d:function(t,e){var i=e.width<0?-1:1,n=e.height<0?-1:1;i<0&&(e.x+=e.width,e.width=-e.width),n<0&&(e.y+=e.height,e.height=-e.height);var r=t.x+t.width,o=t.y+t.height,a=wS(e.x,t.x),s=SS(e.x+e.width,r),l=wS(e.y,t.y),u=SS(e.y+e.height,o),c=s<a,h=u<l;return e.x=c&&a>r?s:a,e.y=h&&l>o?u:l,e.width=c?0:s-a,e.height=h?0:u-l,i<0&&(e.x+=e.width,e.width=-e.width),n<0&&(e.y+=e.height,e.height=-e.height),c||h},polar:function(t,e){var i=e.r0<=e.r?1:-1;if(i<0){var n=e.r;e.r=e.r0,e.r0=n}var r=SS(e.r,t.r),o=wS(e.r0,t.r0);e.r=r,e.r0=o;var a=r-o<0;return i<0&&(n=e.r,e.r=e.r0,e.r0=n),a}},IS={cartesian2d:function(t,e,i,n,r,o,a,s,l){var u=new hs({shape:I({},n),z2:1});return u.__dataIndex=i,u.name="item",o&&(u.shape[r?"height":"width"]=0),u},polar:function(t,e,i,n,r,o,a,s,l){var u=!r&&l?vS:ou,c=new u({shape:n,z2:1});c.name="item";var h,p,d=LS(r);if(c.calculateTextPosition=(h=d,p=({isRoundCap:u===vS}||{}).isRoundCap,function(t,e,i){var n=e.position;if(!n||n instanceof Array)return An(t,e,i);var r=h(n),o=null!=e.distance?e.distance:5,a=this.shape,s=a.cx,l=a.cy,u=a.r,c=a.r0,d=(u+c)/2,f=a.startAngle,m=a.endAngle,g=(f+m)/2,y=p?Math.abs(u-c)/2:0,v=Math.cos,_=Math.sin,x=s+u*v(f),b=l+u*_(f),w="left",S="top";switch(r){case"startArc":x=s+(c-o)*v(g),b=l+(c-o)*_(g),w="center",S="top";break;case"insideStartArc":x=s+(c+o)*v(g),b=l+(c+o)*_(g),w="center",S="bottom";break;case"startAngle":x=s+d*v(f)+_S(f,o+y,!1),b=l+d*_(f)+xS(f,o+y,!1),w="right",S="middle";break;case"insideStartAngle":x=s+d*v(f)+_S(f,-o+y,!1),b=l+d*_(f)+xS(f,-o+y,!1),w="left",S="middle";break;case"middle":x=s+d*v(g),b=l+d*_(g),w="center",S="middle";break;case"endArc":x=s+(u+o)*v(g),b=l+(u+o)*_(g),w="center",S="bottom";break;case"insideEndArc":x=s+(u-o)*v(g),b=l+(u-o)*_(g),w="center",S="top";break;case"endAngle":x=s+d*v(m)+_S(m,o+y,!0),b=l+d*_(m)+xS(m,o+y,!0),w="left",S="middle";break;case"insideEndAngle":x=s+d*v(m)+_S(m,-o+y,!0),b=l+d*_(m)+xS(m,-o+y,!0),w="right",S="middle";break;default:return An(t,e,i)}return(t=t||{}).x=x,t.y=b,t.align=w,t.verticalAlign=S,t}),o){var f=r?"r":"endAngle",m={};c.shape[f]=r?0:n.startAngle,m[f]=n[f],(s?Bu:Nu)(c,{shape:m},o)}return c}};function CS(t,e,i,n,r,o,a,s){var l,u;o?(u={x:n.x,width:n.width},l={y:n.y,height:n.height}):(u={y:n.y,height:n.height},l={x:n.x,width:n.width}),s||(a?Bu:Nu)(i,{shape:l},e,r,null),(a?Bu:Nu)(i,{shape:u},e?t.baseAxis.model:null,r)}function AS(t,e){for(var i=0;i<e.length;i++)if(!isFinite(t[e[i]]))return!0;return!1}var kS=["x","y","width","height"],DS=["cx","cy","r","startAngle","endAngle"],ES={cartesian2d:function(t){return!AS(t,kS)},polar:function(t){return!AS(t,DS)}},PS={cartesian2d:function(t,e,i){var n=t.getItemLayout(e),r=i?function(t,e){var i=t.get(["itemStyle","borderColor"]);if(!i||"none"===i)return 0;var n=t.get(["itemStyle","borderWidth"])||0,r=isNaN(e.width)?Number.MAX_VALUE:Math.abs(e.width),o=isNaN(e.height)?Number.MAX_VALUE:Math.abs(e.height);return Math.min(n,r,o)}(i,n):0,o=n.width>0?1:-1,a=n.height>0?1:-1;return{x:n.x+o*r/2,y:n.y+a*r/2,width:n.width-o*r,height:n.height-a*r}},polar:function(t,e,i){var n=t.getItemLayout(e);return{cx:n.cx,cy:n.cy,r0:n.r0,r:n.r,startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}}};function LS(t){return function(t){var e=t?"Arc":"Angle";return function(t){switch(t){case"start":case"insideStart":case"end":case"insideEnd":return t+e;default:return t}}}(t)}function zS(t,e,i,n,r,o,a,s){var l=e.getItemVisual(i,"style");s||t.setShape("r",n.get(["itemStyle","borderRadius"])||0),t.useStyle(l);var u=n.getShallow("cursor");u&&t.attr("cursor",u);var c=s?a?r.r>=r.r0?"endArc":"startArc":r.endAngle>=r.startAngle?"endAngle":"startAngle":a?r.height>=0?"bottom":"top":r.width>=0?"right":"left",h=bc(n);xc(t,h,{labelFetcher:o,labelDataIndex:i,defaultText:kw(o.getData(),i),inheritColor:l.fill,defaultOpacity:l.opacity,defaultOutsidePosition:c});var p=t.getTextContent();if(s&&p){var d=n.get(["label","position"]);t.textConfig.inside="middle"===d||null,function(t,e,i,n){if("number"!=typeof n)if(U(e))t.setTextConfig({rotation:0});else{var r,o=t.shape,a=o.clockwise?o.startAngle:o.endAngle,s=o.clockwise?o.endAngle:o.startAngle,l=(a+s)/2,u=i(e);switch(u){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":r=l;break;case"startAngle":case"insideStartAngle":r=a;break;case"endAngle":case"insideEndAngle":r=s;break;default:return void t.setTextConfig({rotation:0})}var c=1.5*Math.PI-r;"middle"===u&&c>Math.PI/2&&c<1.5*Math.PI&&(c-=Math.PI),t.setTextConfig({rotation:c})}else t.setTextConfig({rotation:n})}(t,"outside"===d?c:d,LS(a),n.get(["label","rotate"]))}Dc(p,h,o.getRawValue(i),function(t){return Dw(e,t)});var f=n.getModel(["emphasis"]);pl(t,f.get("focus"),f.get("blurScope")),gl(t,n),function(t){return null!=t.startAngle&&null!=t.endAngle&&t.startAngle===t.endAngle}(r)&&(t.style.fill="none",t.style.stroke="none",L(t.states,function(t){t.style&&(t.style.fill=t.style.stroke="none")}))}var OS=function(){},RS=function(t){function e(e){var i=t.call(this,e)||this;return i.type="largeBar",i}return i(e,t),e.prototype.getDefaultShape=function(){return new OS},e.prototype.buildPath=function(t,e){for(var i=e.points,n=this.__startPoint,r=this.__baseDimIdx,o=0;o<i.length;o+=2)n[r]=i[o+r],t.moveTo(n[0],n[1]),t.lineTo(i[o],i[o+1])},e}(Qa);function BS(t,e,i){var n=t.getData(),r=[],o=n.getLayout("valueAxisHorizontal")?1:0;r[1-o]=n.getLayout("valueAxisStart");var a=n.getLayout("largeDataIndices"),s=n.getLayout("barWidth"),l=t.getModel("backgroundStyle");if(t.get("showBackground",!0)){var u=n.getLayout("largeBackgroundPoints"),c=[];c[1-o]=n.getLayout("backgroundStart");var h=new RS({shape:{points:u},incremental:!!i,silent:!0,z2:0});h.__startPoint=c,h.__baseDimIdx=o,h.__largeDataIndices=a,h.__barWidth=s,function(t,e,i){var n=e.get("borderColor")||e.get("color"),r=e.getItemStyle();t.useStyle(r),t.style.fill=null,t.style.stroke=n,t.style.lineWidth=i.getLayout("barWidth")}(h,l,n),e.add(h)}var p=new RS({shape:{points:n.getLayout("largePoints")},incremental:!!i});p.__startPoint=r,p.__baseDimIdx=o,p.__largeDataIndices=a,p.__barWidth=s,e.add(p),function(t,e,i){var n=i.getVisual("style");t.useStyle(I({},n)),t.style.fill=null,t.style.stroke=n.fill,t.style.lineWidth=i.getLayout("barWidth")}(p,0,n),Ss(p).seriesIndex=t.seriesIndex,t.get("silent")||(p.on("mousedown",NS),p.on("mousemove",NS))}var NS=im(function(t){var e=function(t,e,i){var n=t.__baseDimIdx,r=1-n,o=t.shape.points,a=t.__largeDataIndices,s=Math.abs(t.__barWidth/2),l=t.__startPoint[r];bS[0]=e,bS[1]=i;for(var u=bS[n],c=bS[1-n],h=u-s,p=u+s,d=0,f=o.length/2;d<f;d++){var m=2*d,g=o[m+n],y=o[m+r];if(g>=h&&g<=p&&(l<=y?c>=l&&c<=y:c>=y&&c<=l))return a[d]}return-1}(this,t.offsetX,t.offsetY);Ss(this).dataIndex=e>=0?e:null},30,!1);function FS(t,e,i){if(Qw(i,"cartesian2d")){var n=e,r=i.getArea();return{x:t?n.x:r.x,y:t?r.y:n.y,width:t?n.width:r.width,height:t?r.height:n.height}}var o=e;return{cx:(r=i.getArea()).cx,cy:r.cy,r0:t?r.r0:o.r0,r:t?r.r:o.r,startAngle:t?o.startAngle:0,endAngle:t?o.endAngle:2*Math.PI}}var VS=2*Math.PI,US=Math.PI/180;function GS(t,e){return Xh(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}function $S(t,e){var i=GS(t,e),n=t.get("center"),r=t.get("radius");U(r)||(r=[0,r]),U(n)||(n=[n,n]);var o=Xn(i.width,e.getWidth()),a=Xn(i.height,e.getHeight()),s=Math.min(o,a);return{cx:Xn(n[0],o)+i.x,cy:Xn(n[1],a)+i.y,r0:Xn(r[0],s/2),r:Xn(r[1],s/2)}}function WS(t,e,i){e.eachSeriesByType(t,function(t){var e=t.getData(),n=e.mapDimension("value"),r=GS(t,i),o=$S(t,i),a=o.cx,s=o.cy,l=o.r,u=o.r0,c=-t.get("startAngle")*US,h=t.get("minAngle")*US,p=0;e.each(n,function(t){!isNaN(t)&&p++});var d=e.getSum(n),f=Math.PI/(d||p)*2,m=t.get("clockwise"),g=t.get("roseType"),y=t.get("stillShowZeroSum"),v=e.getDataExtent(n);v[0]=0;var _=VS,x=0,b=c,w=m?1:-1;if(e.setLayout({viewRect:r,r:l}),e.each(n,function(t,i){var n;if(isNaN(t))e.setItemLayout(i,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:m,cx:a,cy:s,r0:u,r:g?NaN:l});else{(n="area"!==g?0===d&&y?f:t*f:VS/p)<h?(n=h,_-=h):x+=t;var r=b+w*n;e.setItemLayout(i,{angle:n,startAngle:b,endAngle:r,clockwise:m,cx:a,cy:s,r0:u,r:g?qn(t,v,[u,l]):l}),b=r}}),_<VS&&p)if(_<=.001){var S=VS/p;e.each(n,function(t,i){if(!isNaN(t)){var n=e.getItemLayout(i);n.angle=S,n.startAngle=c+w*i*S,n.endAngle=c+w*(i+1)*S}})}else f=_/x,b=c,e.each(n,function(t,i){if(!isNaN(t)){var n=e.getItemLayout(i),r=n.angle===h?h:t*f;n.startAngle=b,n.endAngle=b+w*r,b+=w*r}})})}function HS(t){return{seriesType:t,reset:function(t,e){var i=e.findComponents({mainType:"legend"});if(i&&i.length){var n=t.getData();n.filterSelf(function(t){for(var e=n.getName(t),r=0;r<i.length;r++)if(!i[r].isSelected(e))return!1;return!0})}}}}var jS=Math.PI/180;function ZS(t,e,i,n,r,o,a,s,l,u){if(!(t.length<2)){for(var c=t.length,h=0;h<c;h++)if("outer"===t[h].position&&"labelLine"===t[h].labelAlignTo){var p=t[h].label.x-u;t[h].linePoints[1][0]+=p,t[h].label.x=u}yb(t,l,l+a)&&function(t){for(var o={list:[],maxY:0},a={list:[],maxY:0},s=0;s<t.length;s++)if("none"===t[s].labelAlignTo){var l=t[s],u=l.label.y>i?a:o,c=Math.abs(l.label.y-i);if(c>u.maxY){var h=l.label.x-e-l.len2*r,p=n+l.len,f=Math.abs(h)<p?Math.sqrt(c*c/(1-h*h/p/p)):p;u.rB=f,u.maxY=c}u.list.push(l)}d(o),d(a)}(t)}function d(t){for(var o=t.rB,a=o*o,s=0;s<t.list.length;s++){var l=t.list[s],u=Math.abs(l.label.y-i),c=n+l.len,h=c*c,p=Math.sqrt((1-Math.abs(u*u/a))*h);l.label.x=e+(p+l.len2)*r}}}function qS(t){return"center"===t.position}function XS(t){var e,i,n=t.getData(),r=[],o=!1,a=(t.get("minShowLabelAngle")||0)*jS,s=n.getLayout("viewRect"),l=n.getLayout("r"),u=s.width,c=s.x,h=s.y,p=s.height;function d(t){t.ignore=!0}n.each(function(t){var s=n.getItemGraphicEl(t),h=s.shape,p=s.getTextContent(),f=s.getTextGuideLine(),m=n.getItemModel(t),g=m.getModel("label"),y=g.get("position")||m.get(["emphasis","label","position"]),v=g.get("distanceToLabelLine"),_=g.get("alignTo"),x=Xn(g.get("edgeDistance"),u),b=g.get("bleedMargin"),w=m.getModel("labelLine"),S=w.get("length");S=Xn(S,u);var T=w.get("length2");if(T=Xn(T,u),Math.abs(h.endAngle-h.startAngle)<a)return L(p.states,d),void(p.ignore=!0);if(function(t){if(!t.ignore)return!0;for(var e in t.states)if(!1===t.states[e].ignore)return!0;return!1}(p)){var M,I,C,A,k=(h.startAngle+h.endAngle)/2,D=Math.cos(k),E=Math.sin(k);e=h.cx,i=h.cy;var P,z="inside"===y||"inner"===y;if("center"===y)M=h.cx,I=h.cy,A="center";else{var O=(z?(h.r+h.r0)/2*D:h.r*D)+e,R=(z?(h.r+h.r0)/2*E:h.r*E)+i;if(M=O+3*D,I=R+3*E,!z){var B=O+D*(S+l-h.r),N=R+E*(S+l-h.r),F=B+(D<0?-1:1)*T;M="edge"===_?D<0?c+x:c+u-x:F+(D<0?-v:v),I=N,C=[[O,R],[B,N],[F,N]]}A=z?"center":"edge"===_?D>0?"right":"left":D>0?"left":"right"}var V=g.get("rotate");if("number"==typeof V)P=V*(Math.PI/180);else if("center"===y)P=0;else{var U=D<0?-k+Math.PI:-k;"radial"===V||!0===V?P=U:"tangential"===V&&"outside"!==y&&"outer"!==y?(P=U+Math.PI/2)>Math.PI/2&&(P-=Math.PI):P=0}if(o=!!P,p.x=M,p.y=I,p.rotation=P,p.setStyle({verticalAlign:"middle"}),z){p.setStyle({align:A});var G=p.states.select;G&&(G.x+=p.x,G.y+=p.y)}else{var $=p.getBoundingRect().clone();$.applyTransform(p.getComputedTransform());var W=(p.style.margin||0)+2.1;$.y-=W/2,$.height+=W,r.push({label:p,labelLine:f,position:y,len:S,len2:T,minTurnAngle:w.get("minTurnAngle"),maxSurfaceAngle:w.get("maxSurfaceAngle"),surfaceNormal:new ln(D,E),linePoints:C,textAlign:A,labelDistance:v,labelAlignTo:_,edgeDistance:x,bleedMargin:b,rect:$})}s.setTextConfig({inside:z})}}),!o&&t.get("avoidLabelOverlap")&&function(t,e,i,n,r,o,a,s){for(var l=[],u=[],c=Number.MAX_VALUE,h=-Number.MAX_VALUE,p=0;p<t.length;p++){var d=t[p].label;qS(t[p])||(d.x<e?(c=Math.min(c,d.x),l.push(t[p])):(h=Math.max(h,d.x),u.push(t[p])))}for(ZS(u,e,i,n,1,0,o,0,s,h),ZS(l,e,i,n,-1,0,o,0,s,c),p=0;p<t.length;p++){var f=t[p];if(d=f.label,!qS(f)){var m=f.linePoints;if(m){var g="edge"===f.labelAlignTo,y=f.rect.width,v=void 0;(v=g?d.x<e?m[2][0]-f.labelDistance-a-f.edgeDistance:a+r-f.edgeDistance-m[2][0]-f.labelDistance:d.x<e?d.x-a-f.bleedMargin:a+r-d.x-f.bleedMargin)<f.rect.width&&(f.label.style.width=v,"edge"===f.labelAlignTo&&(y=v));var _=m[1][0]-m[2][0];g?d.x<e?m[2][0]=a+f.edgeDistance+y+f.labelDistance:m[2][0]=a+r-f.edgeDistance-y-f.labelDistance:(d.x<e?m[2][0]=d.x+f.labelDistance:m[2][0]=d.x-f.labelDistance,m[1][0]=m[2][0]+_),m[1][1]=m[2][1]=d.y}}}}(r,e,i,l,u,p,c,h);for(var f=0;f<r.length;f++){var m=r[f],g=m.label,y=m.labelLine,v=isNaN(g.x)||isNaN(g.y);if(g){g.setStyle({align:m.textAlign}),v&&(L(g.states,d),g.ignore=!0);var _=g.states.select;_&&(_.x+=g.x,_.y+=g.y)}if(y){var x=m.linePoints;v||!x?(L(y.states,d),y.ignore=!0):(ub(x,m.minTurnAngle),cb(x,m.surfaceNormal,m.maxSurfaceAngle),y.setShape({points:x}),g.__hostTarget.textGuideLineConfig={anchor:new ln(x[0][0],x[0][1])})}}}function YS(t,e,i){var n=t.get("borderRadius");return null==n?i?{innerCornerRadius:0,cornerRadius:0}:null:(U(n)||(n=[n,n]),{innerCornerRadius:Cn(n[0],e.r0),cornerRadius:Cn(n[1],e.r)})}var KS=function(t){function e(e,i,n){var r=t.call(this)||this;r.z2=2;var o=new fs;return r.setTextContent(o),r.updateData(e,i,n,!0),r}return i(e,t),e.prototype.updateData=function(t,e,i,r){var o=this,a=t.hostModel,s=t.getItemModel(e),l=s.getModel("emphasis"),u=t.getItemLayout(e),c=I(YS(s.getModel("itemStyle"),u,!0),u);if(isNaN(c.startAngle))o.setShape(c);else{r?(o.setShape(c),"scale"===a.getShallow("animationType")?(o.shape.r=u.r0,Nu(o,{shape:{r:u.r}},a,e)):null!=i?(o.setShape({startAngle:i,endAngle:i}),Nu(o,{shape:{startAngle:u.startAngle,endAngle:u.endAngle}},a,e)):(o.shape.endAngle=u.startAngle,Bu(o,{shape:{endAngle:u.endAngle}},a,e))):($u(o),Bu(o,{shape:c},a,e)),o.useStyle(t.getItemVisual(e,"style")),gl(o,s);var h=(u.startAngle+u.endAngle)/2,p=a.get("selectedOffset"),d=Math.cos(h)*p,f=Math.sin(h)*p,m=s.getShallow("cursor");m&&o.attr("cursor",m),this._updateLabel(a,t,e),o.ensureState("emphasis").shape=n({r:u.r+(l.get("scale")&&l.get("scaleSize")||0)},YS(l.getModel("itemStyle"),u)),I(o.ensureState("select"),{x:d,y:f,shape:YS(s.getModel(["select","itemStyle"]),u)}),I(o.ensureState("blur"),{shape:YS(s.getModel(["blur","itemStyle"]),u)});var g=o.getTextGuideLine(),y=o.getTextContent();g&&I(g.ensureState("select"),{x:d,y:f}),I(y.ensureState("select"),{x:d,y:f}),pl(this,l.get("focus"),l.get("blurScope"))}},e.prototype._updateLabel=function(t,e,i){var n=this,r=e.getItemModel(i),o=r.getModel("labelLine"),a=e.getItemVisual(i,"style"),s=a&&a.fill,l=a&&a.opacity;xc(n,bc(r),{labelFetcher:e.hostModel,labelDataIndex:i,inheritColor:s,defaultOpacity:l,defaultText:t.getFormattedLabel(i,"normal")||e.getName(i)});var u=n.getTextContent();n.setTextConfig({position:null,rotation:null}),u.attr({z2:10});var c=t.get(["label","position"]);if("outside"!==c&&"outer"!==c)n.removeTextGuideLine();else{var h=this.getTextGuideLine();h||(h=new du,this.setTextGuideLine(h)),db(this,fb(r),{stroke:s,opacity:it(o.get(["lineStyle","opacity"]),l,1)})}},e}(ou),JS=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ignoreLabelLineUpdate=!0,e}return i(e,t),e.prototype.init=function(){var t=new Fn;this._sectorGroup=t},e.prototype.render=function(t,e,i,n){var r,o=t.getData(),a=this._data,s=this.group;if(!a&&o.count()>0){for(var l=o.getItemLayout(0),u=1;isNaN(l&&l.startAngle)&&u<o.count();++u)l=o.getItemLayout(u);l&&(r=l.startAngle)}if(this._emptyCircleSector&&s.remove(this._emptyCircleSector),0===o.count()&&t.get("showEmptyCircle")){var c=new ou({shape:$S(t,i)});c.useStyle(t.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=c,s.add(c)}o.diff(a).add(function(t){var e=new KS(o,t,r);o.setItemGraphicEl(t,e),s.add(e)}).update(function(t,e){var i=a.getItemGraphicEl(e);i.updateData(o,t,r),i.off("click"),s.add(i),o.setItemGraphicEl(t,i)}).remove(function(e){Gu(a.getItemGraphicEl(e),t,e)}).execute(),XS(t),"expansion"!==t.get("animationTypeUpdate")&&(this._data=o)},e.prototype.dispose=function(){},e.prototype.containPoint=function(t,e){var i=e.getData().getItemLayout(0);if(i){var n=t[0]-i.cx,r=t[1]-i.cy,o=Math.sqrt(n*n+r*r);return o<=i.r&&o>=i.r0}},e.type="pie",e}(Zf);function QS(t,e,i){e=U(e)&&{coordDimensions:e}||I({encodeDefine:t.getEncode()},e);var n=t.getSource(),r=c_(n,e).dimensions,o=new u_(r,t);return o.initData(n,i),o}var tT=function(){function t(t,e){this._getDataWithEncodedVisual=t,this._getRawData=e}return t.prototype.getAllNames=function(){var t=this._getRawData();return t.mapArray(t.getName)},t.prototype.containName=function(t){return this._getRawData().indexOfName(t)>=0},t.prototype.indexOfName=function(t){return this._getDataWithEncodedVisual().indexOfName(t)},t.prototype.getItemVisual=function(t,e){return this._getDataWithEncodedVisual().getItemVisual(t,e)},t}(),eT=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.init=function(e){t.prototype.init.apply(this,arguments),this.legendVisualProvider=new tT(F(this.getData,this),F(this.getRawData,this)),this._defaultLabelLine(e)},e.prototype.mergeOption=function(){t.prototype.mergeOption.apply(this,arguments)},e.prototype.getInitialData=function(){return QS(this,{coordDimensions:["value"],encodeDefaulter:V(xp,this)})},e.prototype.getDataParams=function(e){var i=this.getData(),n=t.prototype.getDataParams.call(this,e),r=[];return i.each(i.mapDimension("value"),function(t){r.push(t)}),n.percent=er(r,e,i.hostModel.get("percentPrecision")),n.$vars.push("percent"),n},e.prototype._defaultLabelLine=function(t){Sr(t,"labelLine",["show"]);var e=t.labelLine,i=t.emphasis.labelLine;e.show=e.show&&t.label.show,i.show=i.show&&t.emphasis.label.show},e.type="series.pie",e.defaultOption={zlevel:0,z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},e}(Of),iT=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.hasSymbolVisual=!0,i}return i(e,t),e.prototype.getInitialData=function(t,e){return v_(null,this,{useEncodeDefaulter:!0})},e.prototype.getProgressive=function(){var t=this.option.progressive;return null==t?this.option.large?5e3:this.get("progressive"):t},e.prototype.getProgressiveThreshold=function(){var t=this.option.progressiveThreshold;return null==t?this.option.large?1e4:this.get("progressiveThreshold"):t},e.prototype.brushSelector=function(t,e,i){return i.point(e.getItemLayout(t))},e.type="series.scatter",e.dependencies=["grid","polar","geo","singleAxis","calendar"],e.defaultOption={coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{opacity:.8},emphasis:{scale:!0},clip:!0,select:{itemStyle:{borderColor:"#212121"}},universalTransition:{divideShape:"clone"}},e}(Of),nT=function(){},rT=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getDefaultShape=function(){return new nT},e.prototype.buildPath=function(t,e){var i=e.points,n=e.size,r=this.symbolProxy,o=r.shape,a=t.getContext?t.getContext():t;if(a&&n[0]<4)this._ctx=a;else{this._ctx=null;for(var s=0;s<i.length;){var l=i[s++],u=i[s++];isNaN(l)||isNaN(u)||this.softClipShape&&!this.softClipShape.contain(l,u)||(o.x=l-n[0]/2,o.y=u-n[1]/2,o.width=n[0],o.height=n[1],r.buildPath(t,o,!0))}}},e.prototype.afterBrush=function(){var t=this.shape,e=t.points,i=t.size,n=this._ctx;if(n)for(var r=0;r<e.length;){var o=e[r++],a=e[r++];isNaN(o)||isNaN(a)||this.softClipShape&&!this.softClipShape.contain(o,a)||n.fillRect(o-i[0]/2,a-i[1]/2,i[0],i[1])}},e.prototype.findDataIndex=function(t,e){for(var i=this.shape,n=i.points,r=i.size,o=Math.max(r[0],4),a=Math.max(r[1],4),s=n.length/2-1;s>=0;s--){var l=2*s,u=n[l]-o/2,c=n[l+1]-a/2;if(t>=u&&e>=c&&t<=u+o&&e<=c+a)return s}return-1},e}(Qa),oT=function(){function t(){this.group=new Fn}return t.prototype.isPersistent=function(){return!this._incremental},t.prototype.updateData=function(t,e){this.group.removeAll();var i=new rT({rectHover:!0,cursor:"default"});i.setShape({points:t.getLayout("points")}),this._setCommon(i,t,!1,e),this.group.add(i),this._incremental=null},t.prototype.updateLayout=function(t){if(!this._incremental){var e=t.getLayout("points");this.group.eachChild(function(t){if(null!=t.startIndex){var i=2*(t.endIndex-t.startIndex),n=4*t.startIndex*2;e=new Float32Array(e.buffer,n,i)}t.setShape("points",e)})}},t.prototype.incrementalPrepareUpdate=function(t){this.group.removeAll(),this._clearIncremental(),t.count()>2e6?(this._incremental||(this._incremental=new Lu({silent:!0})),this.group.add(this._incremental)):this._incremental=null},t.prototype.incrementalUpdate=function(t,e,i){var n;this._incremental?(n=new rT,this._incremental.addDisplayable(n,!0)):((n=new rT({rectHover:!0,cursor:"default",startIndex:t.start,endIndex:t.end})).incremental=!0,this.group.add(n)),n.setShape({points:e.getLayout("points")}),this._setCommon(n,e,!!this._incremental,i)},t.prototype._setCommon=function(t,e,i,n){var r=e.hostModel;n=n||{};var o=e.getVisual("symbolSize");t.setShape("size",o instanceof Array?o:[o,o]),t.softClipShape=n.clipShape||null,t.symbolProxy=eg(e.getVisual("symbol"),0,0,0,0),t.setColor=t.symbolProxy.setColor;var a=t.shape.size[0]<4;t.useStyle(r.getModel("itemStyle").getItemStyle(a?["color","shadowBlur","shadowColor"]:["color"]));var s=e.getVisual("style"),l=s&&s.fill;if(l&&t.setColor(l),!i){var u=Ss(t);u.seriesIndex=r.seriesIndex,t.on("mousemove",function(e){u.dataIndex=null;var i=t.findDataIndex(e.offsetX,e.offsetY);i>=0&&(u.dataIndex=i+(t.startIndex||0))})}},t.prototype.remove=function(){this._clearIncremental(),this._incremental=null,this.group.removeAll()},t.prototype._clearIncremental=function(){var t=this._incremental;t&&t.clearDisplaybles()},t}(),aT=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(t,e,i){var n=t.getData();this._updateSymbolDraw(n,t).updateData(n,{clipShape:this._getClipShape(t)}),this._finished=!0},e.prototype.incrementalPrepareRender=function(t,e,i){var n=t.getData();this._updateSymbolDraw(n,t).incrementalPrepareUpdate(n),this._finished=!1},e.prototype.incrementalRender=function(t,e,i){this._symbolDraw.incrementalUpdate(t,e.getData(),{clipShape:this._getClipShape(e)}),this._finished=t.end===e.getData().count()},e.prototype.updateTransform=function(t,e,i){var n=t.getData();if(this.group.dirty(),!this._finished||n.count()>1e4||!this._symbolDraw.isPersistent())return{update:!0};var r=hS("").reset(t,e,i);r.progress&&r.progress({start:0,end:n.count(),count:n.count()},n),this._symbolDraw.updateLayout(n)},e.prototype._getClipShape=function(t){var e=t.coordinateSystem,i=e&&e.getArea&&e.getArea();return t.get("clip",!0)?i:null},e.prototype._updateSymbolDraw=function(t,e){var i=this._symbolDraw,n=e.pipelineContext.large;return i&&n===this._isLargeDraw||(i&&i.remove(),i=this._symbolDraw=n?new oT:new Rw,this._isLargeDraw=n,this.group.removeAll()),this.group.add(i.group),i},e.prototype.remove=function(t,e){this._symbolDraw&&this._symbolDraw.remove(!0),this._symbolDraw=null},e.prototype.dispose=function(){},e.type="scatter",e}(Zf),sT=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.type="grid",e.dependencies=["xAxis","yAxis"],e.layoutMode="box",e.defaultOption={show:!1,zlevel:0,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},e}(ip),lT=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",Nr).models[0]},e.type="cartesian2dAxis",e}(ip);E(lT,Mx);var uT={show:!0,zlevel:0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#6E7079",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#E0E6F1"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"]}}},cT=T({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},uT),hT=T({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#F4F7FD",width:1}}},uT),pT={category:cT,value:hT,time:T({scale:!0,splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},hT),log:C({scale:!0,logBase:10},hT)},dT={value:1,category:1,time:1,log:1};function fT(t,e,n,r){L(dT,function(o,a){var s=T(T({},pT[a],!0),r,!0),l=function(t){function n(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e+"Axis."+a,i}return i(n,t),n.prototype.mergeDefaultAndTheme=function(t,e){var i=Kh(this),n=i?Qh(t):{};T(t,e.getTheme().get(a+"Axis")),T(t,this.getDefaultOption()),t.type=mT(t),i&&Jh(t,n,i)},n.prototype.optionUpdated=function(){"category"===this.option.type&&(this.__ordinalMeta=b_.createByAxisModel(this))},n.prototype.getCategories=function(t){var e=this.option;if("category"===e.type)return t?e.data:this.__ordinalMeta.categories},n.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},n.type=e+"Axis."+a,n.defaultOption=s,n}(n);t.registerComponentModel(l)}),t.registerSubTypeDefaulter(e+"Axis",mT)}function mT(t){return t.type||(t.data?"category":"value")}var gT=function(){function t(t){this.type="cartesian",this._dimList=[],this._axes={},this.name=t||""}return t.prototype.getAxis=function(t){return this._axes[t]},t.prototype.getAxes=function(){return z(this._dimList,function(t){return this._axes[t]},this)},t.prototype.getAxesByScale=function(t){return t=t.toLowerCase(),R(this.getAxes(),function(e){return e.scale.type===t})},t.prototype.addAxis=function(t){var e=t.dim;this._axes[e]=t,this._dimList.push(e)},t}(),yT=["x","y"];function vT(t){return"interval"===t.type||"time"===t.type}var _T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="cartesian2d",e.dimensions=yT,e}return i(e,t),e.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var t=this.getAxis("x").scale,e=this.getAxis("y").scale;if(vT(t)&&vT(e)){var i=t.getExtent(),n=e.getExtent(),r=this.dataToPoint([i[0],n[0]]),o=this.dataToPoint([i[1],n[1]]),a=i[1]-i[0],s=n[1]-n[0];if(a&&s){var l=(o[0]-r[0])/a,u=(o[1]-r[1])/s,c=r[0]-i[0]*l,h=r[1]-n[0]*u,p=this._transform=[l,0,0,u,c,h];this._invTransform=Zi([],p)}}},e.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},e.prototype.containPoint=function(t){var e=this.getAxis("x"),i=this.getAxis("y");return e.contain(e.toLocalCoord(t[0]))&&i.contain(i.toLocalCoord(t[1]))},e.prototype.containData=function(t){return this.getAxis("x").containData(t[0])&&this.getAxis("y").containData(t[1])},e.prototype.dataToPoint=function(t,e,i){i=i||[];var n=t[0],r=t[1];if(this._transform&&null!=n&&isFinite(n)&&null!=r&&isFinite(r))return Ot(i,t,this._transform);var o=this.getAxis("x"),a=this.getAxis("y");return i[0]=o.toGlobalCoord(o.dataToCoord(n,e)),i[1]=a.toGlobalCoord(a.dataToCoord(r,e)),i},e.prototype.clampData=function(t,e){var i=this.getAxis("x").scale,n=this.getAxis("y").scale,r=i.getExtent(),o=n.getExtent(),a=i.parse(t[0]),s=n.parse(t[1]);return(e=e||[])[0]=Math.min(Math.max(Math.min(r[0],r[1]),a),Math.max(r[0],r[1])),e[1]=Math.min(Math.max(Math.min(o[0],o[1]),s),Math.max(o[0],o[1])),e},e.prototype.pointToData=function(t,e){var i=[];if(this._invTransform)return Ot(i,t,this._invTransform);var n=this.getAxis("x"),r=this.getAxis("y");return i[0]=n.coordToData(n.toLocalCoord(t[0]),e),i[1]=r.coordToData(r.toLocalCoord(t[1]),e),i},e.prototype.getOtherAxis=function(t){return this.getAxis("x"===t.dim?"y":"x")},e.prototype.getArea=function(){var t=this.getAxis("x").getGlobalExtent(),e=this.getAxis("y").getGlobalExtent(),i=Math.min(t[0],t[1]),n=Math.min(e[0],e[1]),r=Math.max(t[0],t[1])-i,o=Math.max(e[0],e[1])-n;return new yn(i,n,r,o)},e}(gT),xT=function(t){function e(e,i,n,r,o){var a=t.call(this,e,i,n)||this;return a.index=0,a.type=r||"value",a.position=o||"bottom",a}return i(e,t),e.prototype.isHorizontal=function(){var t=this.position;return"top"===t||"bottom"===t},e.prototype.getGlobalExtent=function(t){var e=this.getExtent();return e[0]=this.toGlobalCoord(e[0]),e[1]=this.toGlobalCoord(e[1]),t&&e[0]>e[1]&&e.reverse(),e},e.prototype.pointToData=function(t,e){return this.coordToData(this.toLocalCoord(t["x"===this.dim?0:1]),e)},e.prototype.setCategorySortInfo=function(t){if("category"!==this.type)return!1;this.model.option.categorySortInfo=t,this.scale.setSortInfo(t)},e}($x);function bT(t,e,i){i=i||{};var n=t.coordinateSystem,r=e.axis,o={},a=r.getAxesOnZeroOf()[0],s=r.position,l=a?"onZero":s,u=r.dim,c=n.getRect(),h=[c.x,c.x+c.width,c.y,c.y+c.height],p={left:0,right:1,top:0,bottom:1,onZero:2},d=e.get("offset")||0,f="x"===u?[h[2]-d,h[3]+d]:[h[0]-d,h[1]+d];if(a){var m=a.toGlobalCoord(a.dataToCoord(0));f[2]=Math.max(Math.min(m,f[1]),f[0])}o.position=["y"===u?f[p[l]]:h[0],"x"===u?f[p[l]]:h[3]],o.rotation=Math.PI/2*("x"===u?0:1),o.labelDirection=o.tickDirection=o.nameDirection={top:-1,bottom:1,left:-1,right:1}[s],o.labelOffset=a?f[p[s]]-f[2]:0,e.get(["axisTick","inside"])&&(o.tickDirection=-o.tickDirection),tt(i.labelInside,e.get(["axisLabel","inside"]))&&(o.labelDirection=-o.labelDirection);var g=e.get(["axisLabel","rotate"]);return o.labelRotate="top"===l?-g:g,o.z2=1,o}function wT(t){return"cartesian2d"===t.get("coordinateSystem")}function ST(t){var e={xAxisModel:null,yAxisModel:null};return L(e,function(i,n){var r=n.replace(/Model$/,""),o=t.getReferringComponents(r,Nr).models[0];e[n]=o}),e}var TT=function(){function t(t,e,i){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=yT,this._initCartesian(t,e,i),this.model=t}return t.prototype.getRect=function(){return this._rect},t.prototype.update=function(t,e){var i=this._axesMap;this._updateScale(t,this.model),L(i.x,function(t){gx(t.scale,t.model)}),L(i.y,function(t){gx(t.scale,t.model)});var n={};L(i.x,function(t){IT(i,"y",t,n)}),L(i.y,function(t){IT(i,"x",t,n)}),this.resize(this.model,e)},t.prototype.resize=function(t,e,i){var n=t.getBoxLayoutParams(),r=!i&&t.get("containLabel"),o=Xh(n,{width:e.getWidth(),height:e.getHeight()});this._rect=o;var a=this._axesList;function s(){L(a,function(t){var e=t.isHorizontal(),i=e?[0,o.width]:[0,o.height],n=t.inverse?1:0;t.setExtent(i[n],i[1-n]),function(t,e){var i=t.getExtent(),n=i[0]+i[1];t.toGlobalCoord="x"===t.dim?function(t){return t+e}:function(t){return n-t+e},t.toLocalCoord="x"===t.dim?function(t){return t-e}:function(t){return n-t+e}}(t,e?o.x:o.y)})}s(),r&&(L(a,function(t){if(!t.model.get(["axisLabel","inside"])){var e=function(t){var e=t.model,i=t.scale;if(e.get(["axisLabel","show"])&&!i.isBlank()){var n,r,o=i.getExtent();r=i instanceof D_?i.count():(n=i.getTicks()).length;var a,s=t.getLabelModel(),l=vx(t),u=1;r>40&&(u=Math.ceil(r/40));for(var c=0;c<r;c+=u){var h=l(n?n[c]:{value:o[0]+c},c),p=xx(s.getTextRect(h),s.get("rotate")||0);a?a.union(p):a=p}return a}}(t);if(e){var i=t.isHorizontal()?"height":"width",n=t.model.get(["axisLabel","margin"]);o[i]-=e[i]+n,"top"===t.position?o.y+=e.height+n:"left"===t.position&&(o.x+=e.width+n)}}}),s()),L(this._coordsList,function(t){t.calcAffineTransform()})},t.prototype.getAxis=function(t,e){var i=this._axesMap[t];if(null!=i)return i[e||0]},t.prototype.getAxes=function(){return this._axesList.slice()},t.prototype.getCartesian=function(t,e){if(null!=t&&null!=e){var i="x"+t+"y"+e;return this._coordsMap[i]}j(t)&&(e=t.yAxisIndex,t=t.xAxisIndex);for(var n=0,r=this._coordsList;n<r.length;n++)if(r[n].getAxis("x").index===t||r[n].getAxis("y").index===e)return r[n]},t.prototype.getCartesians=function(){return this._coordsList.slice()},t.prototype.convertToPixel=function(t,e,i){var n=this._findConvertTarget(e);return n.cartesian?n.cartesian.dataToPoint(i):n.axis?n.axis.toGlobalCoord(n.axis.dataToCoord(i)):null},t.prototype.convertFromPixel=function(t,e,i){var n=this._findConvertTarget(e);return n.cartesian?n.cartesian.pointToData(i):n.axis?n.axis.coordToData(n.axis.toLocalCoord(i)):null},t.prototype._findConvertTarget=function(t){var e,i,n=t.seriesModel,r=t.xAxisModel||n&&n.getReferringComponents("xAxis",Nr).models[0],o=t.yAxisModel||n&&n.getReferringComponents("yAxis",Nr).models[0],a=t.gridModel,s=this._coordsList;return n?k(s,e=n.coordinateSystem)<0&&(e=null):r&&o?e=this.getCartesian(r.componentIndex,o.componentIndex):r?i=this.getAxis("x",r.componentIndex):o?i=this.getAxis("y",o.componentIndex):a&&a.coordinateSystem===this&&(e=this._coordsList[0]),{cartesian:e,axis:i}},t.prototype.containPoint=function(t){var e=this._coordsList[0];if(e)return e.containPoint(t)},t.prototype._initCartesian=function(t,e,i){var n=this,r=this,o={left:!1,right:!1,top:!1,bottom:!1},a={x:{},y:{}},s={x:0,y:0};if(e.eachComponent("xAxis",l("x"),this),e.eachComponent("yAxis",l("y"),this),!s.x||!s.y)return this._axesMap={},void(this._axesList=[]);function l(e){return function(i,n){if(MT(i,t)){var l=i.get("position");"x"===e?"top"!==l&&"bottom"!==l&&(l=o.bottom?"top":"bottom"):"left"!==l&&"right"!==l&&(l=o.left?"right":"left"),o[l]=!0;var u=new xT(e,yx(i),[0,0],i.get("type"),l),c="category"===u.type;u.onBand=c&&i.get("boundaryGap"),u.inverse=i.get("inverse"),i.axis=u,u.model=i,u.grid=r,u.index=n,r._axesList.push(u),a[e][n]=u,s[e]++}}}this._axesMap=a,L(a.x,function(e,i){L(a.y,function(r,o){var a="x"+i+"y"+o,s=new _T(a);s.master=n,s.model=t,n._coordsMap[a]=s,n._coordsList.push(s),s.addAxis(e),s.addAxis(r)})})},t.prototype._updateScale=function(t,e){function i(t,e){L(Tx(t,e.dim),function(i){e.scale.unionExtentFromData(t,i)})}L(this._axesList,function(t){if(t.scale.setExtent(1/0,-1/0),"category"===t.type){var e=t.model.get("categorySortInfo");t.scale.setSortInfo(e)}}),t.eachSeries(function(t){if(wT(t)){var n=ST(t),r=n.xAxisModel,o=n.yAxisModel;if(!MT(r,e)||!MT(o,e))return;var a=this.getCartesian(r.componentIndex,o.componentIndex),s=t.getData(),l=a.getAxis("x"),u=a.getAxis("y");"list"===s.type&&(i(s,l),i(s,u))}},this)},t.prototype.getTooltipAxes=function(t){var e=[],i=[];return L(this.getCartesians(),function(n){var r=null!=t&&"auto"!==t?n.getAxis(t):n.getBaseAxis(),o=n.getOtherAxis(r);k(e,r)<0&&e.push(r),k(i,o)<0&&i.push(o)}),{baseAxes:e,otherAxes:i}},t.create=function(e,i){var n=[];return e.eachComponent("grid",function(r,o){var a=new t(r,e,i);a.name="grid_"+o,a.resize(r,i,!0),r.coordinateSystem=a,n.push(a)}),e.eachSeries(function(t){if(wT(t)){var e=ST(t),i=e.xAxisModel,n=e.yAxisModel,r,o=i.getCoordSysModel().coordinateSystem;t.coordinateSystem=o.getCartesian(i.componentIndex,n.componentIndex)}}),n},t.dimensions=yT,t}();function MT(t,e){return t.getCoordSysModel()===e}function IT(t,e,i,n){i.getAxesOnZeroOf=function(){return r?[r]:[]};var r,o=t[e],a=i.model,s=a.get(["axisLine","onZero"]),l=a.get(["axisLine","onZeroAxisIndex"]);if(s){if(null!=l)CT(o[l])&&(r=o[l]);else for(var u in o)if(o.hasOwnProperty(u)&&CT(o[u])&&!n[c(o[u])]){r=o[u];break}r&&(n[c(r)]=!0)}function c(t){return t.dim+"_"+t.index}}function CT(t){return t&&"category"!==t.type&&"time"!==t.type&&function(t){var e=t.scale.getExtent(),i=e[0],n=e[1];return!(i>0&&n>0||i<0&&n<0)}(t)}var AT=Math.PI,kT=function(){function t(t,e){this.group=new Fn,this.opt=e,this.axisModel=t,C(e,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});var i=new Fn({x:e.position[0],y:e.position[1],rotation:e.rotation});i.updateTransform(),this._transformGroup=i}return t.prototype.hasBuilder=function(t){return!!DT[t]},t.prototype.add=function(t){DT[t](this.opt,this.axisModel,this.group,this._transformGroup)},t.prototype.getGroup=function(){return this.group},t.innerTextLayout=function(t,e,i){var n,r,o=rr(e-t);return or(o)?(r=i>0?"top":"bottom",n="center"):or(o-AT)?(r=i>0?"bottom":"top",n="center"):(r="middle",n=o>0&&o<AT?i>0?"right":"left":i>0?"left":"right"),{rotation:o,textAlign:n,textVerticalAlign:r}},t.makeAxisEventDataBase=function(t){var e={componentType:t.mainType,componentIndex:t.componentIndex};return e[t.mainType+"Index"]=t.componentIndex,e},t.isLabelSilent=function(t){var e=t.get("tooltip");return t.get("silent")||!(t.get("triggerEvent")||e&&e.show)},t}(),DT={axisLine:function(t,e,i,n){var r=e.get(["axisLine","show"]);if("auto"===r&&t.handleAutoShown&&(r=t.handleAutoShown("axisLine")),r){var o=e.axis.getExtent(),a=n.transform,s=[o[0],0],l=[o[1],0];a&&(Ot(s,s,a),Ot(l,l,a));var u=I({lineCap:"round"},e.getModel(["axisLine","lineStyle"]).getLineStyle()),c=new gu({subPixelOptimize:!0,shape:{x1:s[0],y1:s[1],x2:l[0],y2:l[1]},style:u,strokeContainThreshold:t.strokeContainThreshold||5,silent:!0,z2:1});c.anid="line",i.add(c);var h=e.get(["axisLine","symbol"]);if(null!=h){var p=e.get(["axisLine","symbolSize"]);"string"==typeof h&&(h=[h,h]),"string"!=typeof p&&"number"!=typeof p||(p=[p,p]);var d=ng(e.get(["axisLine","symbolOffset"])||0,p),f=p[0],m=p[1];L([{rotate:t.rotation+Math.PI/2,offset:d[0],r:0},{rotate:t.rotation-Math.PI/2,offset:d[1],r:Math.sqrt((s[0]-l[0])*(s[0]-l[0])+(s[1]-l[1])*(s[1]-l[1]))}],function(e,n){if("none"!==h[n]&&null!=h[n]){var r=eg(h[n],-f/2,-m/2,f,m,u.stroke,!0),o=e.r+e.offset;r.attr({rotation:e.rotate,x:s[0]+o*Math.cos(t.rotation),y:s[1]-o*Math.sin(t.rotation),silent:!0,z2:11}),i.add(r)}})}}},axisTickLabel:function(t,e,i,n){var r=function(t,e,i,n){var r=i.axis,o=i.getModel("axisTick"),a=o.get("show");if("auto"===a&&n.handleAutoShown&&(a=n.handleAutoShown("axisTick")),a&&!r.scale.isBlank()){for(var s=o.getModel("lineStyle"),l=n.tickDirection*o.get("length"),u=zT(r.getTicksCoords(),e.transform,l,C(s.getLineStyle(),{stroke:i.get(["axisLine","lineStyle","color"])}),"ticks"),c=0;c<u.length;c++)t.add(u[c]);return u}}(i,n,e,t),o=function(t,e,i,n){var r=i.axis;if(tt(n.axisLabelShow,i.get(["axisLabel","show"]))&&!r.scale.isBlank()){var o=i.getModel("axisLabel"),a=o.get("margin"),s=r.getViewLabels(),l=(tt(n.labelRotate,o.get("rotate"))||0)*AT/180,u=kT.innerTextLayout(n.rotation,l,n.labelDirection),c=i.getCategories&&i.getCategories(!0),h=[],p=kT.isLabelSilent(i),d=i.get("triggerEvent");return L(s,function(s,l){var f="ordinal"===r.scale.type?r.scale.getRawOrdinalNumber(s.tickValue):s.tickValue,m=s.formattedLabel,g=s.rawLabel,y=o;if(c&&c[f]){var v=c[f];j(v)&&v.textStyle&&(y=new $c(v.textStyle,o,i.ecModel))}var _=y.getTextColor()||i.get(["axisLine","lineStyle","color"]),x=r.dataToCoord(f),b=new fs({x:x,y:n.labelOffset+n.labelDirection*a,rotation:u.rotation,silent:p,z2:10+(s.level||0),style:wc(y,{text:m,align:y.getShallow("align",!0)||u.textAlign,verticalAlign:y.getShallow("verticalAlign",!0)||y.getShallow("baseline",!0)||u.textVerticalAlign,fill:"function"==typeof _?_("category"===r.type?g:"value"===r.type?f+"":f,l):_})});if(b.anid="label_"+f,d){var w=kT.makeAxisEventDataBase(i);w.targetType="axisLabel",w.value=g,Ss(b).eventData=w}e.add(b),b.updateTransform(),h.push(b),t.add(b),b.decomposeTransform()}),h}}(i,n,e,t);(function(t,e,i){if(!Sx(t.axis)){var n=t.get(["axisLabel","showMinLabel"]),r=t.get(["axisLabel","showMaxLabel"]);i=i||[];var o=(e=e||[])[0],a=e[1],s=e[e.length-1],l=e[e.length-2],u=i[0],c=i[1],h=i[i.length-1],p=i[i.length-2];!1===n?(ET(o),ET(u)):PT(o,a)&&(n?(ET(a),ET(c)):(ET(o),ET(u))),!1===r?(ET(s),ET(h)):PT(l,s)&&(r?(ET(l),ET(p)):(ET(s),ET(h)))}})(e,o,r),function(t,e,i,n){var r=i.axis,o=i.getModel("minorTick");if(o.get("show")&&!r.scale.isBlank()){var a=r.getMinorTicksCoords();if(a.length)for(var s=o.getModel("lineStyle"),l=n*o.get("length"),u=C(s.getLineStyle(),C(i.getModel("axisTick").getLineStyle(),{stroke:i.get(["axisLine","lineStyle","color"])})),c=0;c<a.length;c++)for(var h=zT(a[c],e.transform,l,u,"minorticks_"+c),p=0;p<h.length;p++)t.add(h[p])}}(i,n,e,t.tickDirection),e.get(["axisLabel","hideOverlap"])&&vb(mb(z(o,function(t){return{label:t,priority:t.z2,defaultAttr:{ignore:t.ignore}}})))},axisName:function(t,e,i,n){var r=tt(t.axisName,e.get("name"));if(r){var o,a,s=e.get("nameLocation"),l=t.nameDirection,u=e.getModel("nameTextStyle"),c=e.get("nameGap")||0,h=e.axis.getExtent(),p=h[0]>h[1]?-1:1,d=["start"===s?h[0]-p*c:"end"===s?h[1]+p*c:(h[0]+h[1])/2,LT(s)?t.labelOffset+l*c:0],f=e.get("nameRotate");null!=f&&(f=f*AT/180),LT(s)?o=kT.innerTextLayout(t.rotation,null!=f?f:t.rotation,l):(o=function(t,e,i,n){var r,o,a=rr(i-t),s=n[0]>n[1],l="start"===e&&!s||"start"!==e&&s;return or(a-AT/2)?(o=l?"bottom":"top",r="center"):or(a-1.5*AT)?(o=l?"top":"bottom",r="center"):(o="middle",r=a<1.5*AT&&a>AT/2?l?"left":"right":l?"right":"left"),{rotation:a,textAlign:r,textVerticalAlign:o}}(t.rotation,s,f||0,h),null!=(a=t.axisNameAvailableWidth)&&(a=Math.abs(a/Math.sin(o.rotation)),!isFinite(a)&&(a=null)));var m=u.getFont(),g=e.get("nameTruncate",!0)||{},y=g.ellipsis,v=tt(t.nameTruncateMaxWidth,g.maxWidth,a),_=new fs({x:d[0],y:d[1],rotation:o.rotation,silent:kT.isLabelSilent(e),style:wc(u,{text:r,font:m,overflow:"truncate",width:v,ellipsis:y,fill:u.getTextColor()||e.get(["axisLine","lineStyle","color"]),align:u.get("align")||o.textAlign,verticalAlign:u.get("verticalAlign")||o.textVerticalAlign}),z2:1});if(mc({el:_,componentModel:e,itemName:r}),_.__fullText=r,_.anid="name",e.get("triggerEvent")){var x=kT.makeAxisEventDataBase(e);x.targetType="axisName",x.name=r,Ss(_).eventData=x}n.add(_),_.updateTransform(),i.add(_),_.decomposeTransform()}}};function ET(t){t&&(t.ignore=!0)}function PT(t,e){var i=t&&t.getBoundingRect().clone(),n=e&&e.getBoundingRect().clone();if(i&&n){var r=Ui([]);return Hi(r,r,-t.rotation),i.applyTransform($i([],r,t.getLocalTransform())),n.applyTransform($i([],r,e.getLocalTransform())),i.intersect(n)}}function LT(t){return"middle"===t||"center"===t}function zT(t,e,i,n,r){for(var o=[],a=[],s=[],l=0;l<t.length;l++){var u=t[l].coord;a[0]=u,a[1]=0,s[0]=u,s[1]=i,e&&(Ot(a,a,e),Ot(s,s,e));var c=new gu({subPixelOptimize:!0,shape:{x1:a[0],y1:a[1],x2:s[0],y2:s[1]},style:n,z2:2,autoBatch:!0,silent:!0});c.anid=r+"_"+t[l].tickValue,o.push(c)}return o}function OT(t,e){var i={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return function(t,e,i){var n=e.getComponent("tooltip"),r=e.getComponent("axisPointer"),o=r.get("link",!0)||[],a=[];L(i.getCoordinateSystems(),function(i){if(i.axisPointerEnabled){var s=VT(i.model),l=t.coordSysAxesInfo[s]={};t.coordSysMap[s]=i;var u=i.model.getModel("tooltip",n);if(L(i.getAxes(),V(d,!1,null)),i.getTooltipAxes&&n&&u.get("show")){var c="axis"===u.get("trigger"),h="cross"===u.get(["axisPointer","type"]),p=i.getTooltipAxes(u.get(["axisPointer","axis"]));(c||h)&&L(p.baseAxes,V(d,!h||"cross",c)),h&&L(p.otherAxes,V(d,"cross",!1))}}function d(n,s,c){var h=c.model.getModel("axisPointer",r),p=h.get("show");if(p&&("auto"!==p||n||FT(h))){null==s&&(s=h.get("triggerTooltip"));var d=(h=n?function(t,e,i,n,r,o){var a=e.getModel("axisPointer"),s={};L(["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],function(t){s[t]=S(a.get(t))}),s.snap="category"!==t.type&&!!o,"cross"===a.get("type")&&(s.type="line");var l=s.label||(s.label={});if(null==l.show&&(l.show=!1),"cross"===r){var u=a.get(["label","show"]);if(l.show=null==u||u,!o){var c=s.lineStyle=a.get("crossStyle");c&&C(l,c.textStyle)}}return t.model.getModel("axisPointer",new $c(s,i,n))}(c,u,r,e,n,s):h).get("snap"),f=VT(c.model),m=s||d||"category"===c.type,g=t.axesInfo[f]={key:f,axis:c,coordSys:i,axisPointerModel:h,triggerTooltip:s,involveSeries:m,snap:d,useHandle:FT(h),seriesModels:[],linkGroup:null};l[f]=g,t.seriesInvolved=t.seriesInvolved||m;var y=function(t,e){for(var i=e.model,n=e.dim,r=0;r<t.length;r++){var o=t[r]||{};if(RT(o[n+"AxisId"],i.id)||RT(o[n+"AxisIndex"],i.componentIndex)||RT(o[n+"AxisName"],i.name))return r}}(o,c);if(null!=y){var v=a[y]||(a[y]={axesInfo:{}});v.axesInfo[f]=g,v.mapper=o[y].mapper,g.linkGroup=v}}}})}(i,t,e),i.seriesInvolved&&function(t,e){e.eachSeries(function(e){var i=e.coordinateSystem,n=e.get(["tooltip","trigger"],!0),r=e.get(["tooltip","show"],!0);i&&"none"!==n&&!1!==n&&"item"!==n&&!1!==r&&!1!==e.get(["axisPointer","show"],!0)&&L(t.coordSysAxesInfo[VT(i.model)],function(t){var n=t.axis;i.getAxis(n.dim)===n&&(t.seriesModels.push(e),null==t.seriesDataCount&&(t.seriesDataCount=0),t.seriesDataCount+=e.getData().count())})})}(i,t),i}function RT(t,e){return"all"===t||U(t)&&k(t,e)>=0||t===e}function BT(t){var e=NT(t);if(e){var i=e.axisPointerModel,n=e.axis.scale,r=i.option,o=i.get("status"),a=i.get("value");null!=a&&(a=n.parse(a));var s=FT(i);null==o&&(r.status=s?"show":"hide");var l=n.getExtent().slice();l[0]>l[1]&&l.reverse(),(null==a||a>l[1])&&(a=l[1]),a<l[0]&&(a=l[0]),r.value=a,s&&(r.status=e.axis.scale.isBlank()?"hide":"show")}}function NT(t){var e=(t.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return e&&e.axesInfo[VT(t)]}function FT(t){return!!t.get(["handle","show"])}function VT(t){return t.type+"||"+t.id}var UT={},GT=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(e,i,n,r){this.axisPointerClass&&BT(e),t.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(e,n,!0)},e.prototype.updateAxisPointer=function(t,e,i,n){this._doUpdateAxisPointerClass(t,i,!1)},e.prototype.remove=function(t,e){var i=this._axisPointer;i&&i.remove(e)},e.prototype.dispose=function(e,i){this._disposeAxisPointer(i),t.prototype.dispose.apply(this,arguments)},e.prototype._doUpdateAxisPointerClass=function(t,i,n){var r=e.getAxisPointerClass(this.axisPointerClass);if(r){var o=function(t){var e=NT(t);return e&&e.axisPointerModel}(t);o?(this._axisPointer||(this._axisPointer=new r)).render(t,o,i,n):this._disposeAxisPointer(i)}},e.prototype._disposeAxisPointer=function(t){this._axisPointer&&this._axisPointer.dispose(t),this._axisPointer=null},e.registerAxisPointerClass=function(t,e){UT[t]=e},e.getAxisPointerClass=function(t){return t&&UT[t]},e.type="axis",e}($f),$T=zr();function WT(t,e,i,n){var r=i.axis;if(!r.scale.isBlank()){var o=i.getModel("splitArea"),a=o.getModel("areaStyle"),s=a.get("color"),l=n.coordinateSystem.getRect(),u=r.getTicksCoords({tickModel:o,clamp:!0});if(u.length){var c=s.length,h=$T(t).splitAreaColors,p=ht(),d=0;if(h)for(var f=0;f<u.length;f++){var m=h.get(u[f].tickValue);if(null!=m){d=(m+(c-1)*f)%c;break}}var g=r.toGlobalCoord(u[0].coord),y=a.getAreaStyle();for(s=U(s)?s:[s],f=1;f<u.length;f++){var v=r.toGlobalCoord(u[f].coord),_=void 0,x=void 0,b=void 0,w=void 0;r.isHorizontal()?(_=g,x=l.y,b=v-_,w=l.height,g=_+b):(_=l.x,x=g,b=l.width,g=x+(w=v-x));var S=u[f-1].tickValue;null!=S&&p.set(S,d),e.add(new hs({anid:null!=S?"area_"+S:null,shape:{x:_,y:x,width:b,height:w},style:C({fill:s[d]},y),autoBatch:!0,silent:!0})),d=(d+1)%c}$T(t).splitAreaColors=p}}}function HT(t){$T(t).splitAreaColors=null}var jT=["axisLine","axisTickLabel","axisName"],ZT=["splitArea","splitLine","minorSplitLine"],qT=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.axisPointerClass="CartesianAxisPointer",i}return i(e,t),e.prototype.render=function(e,i,n,r){this.group.removeAll();var o=this._axisGroup;if(this._axisGroup=new Fn,this.group.add(this._axisGroup),e.get("show")){var a=e.getCoordSysModel(),s=bT(a,e),l=new kT(e,I({handleAutoShown:function(t){for(var i=a.coordinateSystem.getCartesians(),n=0;n<i.length;n++){var r=i[n].getOtherAxis(e.axis).type;if("value"===r||"log"===r)return!0}return!1}},s));L(jT,l.add,l),this._axisGroup.add(l.getGroup()),L(ZT,function(t){e.get([t,"show"])&&XT[t](this,this._axisGroup,e,a)},this),r&&"changeAxisOrder"===r.type&&r.isInitSort||lc(o,this._axisGroup,e),t.prototype.render.call(this,e,i,n,r)}},e.prototype.remove=function(){HT(this)},e.type="cartesianAxis",e}(GT),XT={splitLine:function(t,e,i,n){var r=i.axis;if(!r.scale.isBlank()){var o=i.getModel("splitLine"),a=o.getModel("lineStyle"),s=a.get("color");s=U(s)?s:[s];for(var l=n.coordinateSystem.getRect(),u=r.isHorizontal(),c=0,h=r.getTicksCoords({tickModel:o}),p=[],d=[],f=a.getLineStyle(),m=0;m<h.length;m++){var g=r.toGlobalCoord(h[m].coord);u?(p[0]=g,p[1]=l.y,d[0]=g,d[1]=l.y+l.height):(p[0]=l.x,p[1]=g,d[0]=l.x+l.width,d[1]=g);var y=c++%s.length,v=h[m].tickValue;e.add(new gu({anid:null!=v?"line_"+h[m].tickValue:null,subPixelOptimize:!0,autoBatch:!0,shape:{x1:p[0],y1:p[1],x2:d[0],y2:d[1]},style:C({stroke:s[y]},f),silent:!0}))}}},minorSplitLine:function(t,e,i,n){var r=i.axis,o=i.getModel("minorSplitLine").getModel("lineStyle"),a=n.coordinateSystem.getRect(),s=r.isHorizontal(),l=r.getMinorTicksCoords();if(l.length)for(var u=[],c=[],h=o.getLineStyle(),p=0;p<l.length;p++)for(var d=0;d<l[p].length;d++){var f=r.toGlobalCoord(l[p][d].coord);s?(u[0]=f,u[1]=a.y,c[0]=f,c[1]=a.y+a.height):(u[0]=a.x,u[1]=f,c[0]=a.x+a.width,c[1]=f),e.add(new gu({anid:"minor_line_"+l[p][d].tickValue,subPixelOptimize:!0,autoBatch:!0,shape:{x1:u[0],y1:u[1],x2:c[0],y2:c[1]},style:h,silent:!0}))}},splitArea:function(t,e,i,n){WT(t,e,i,n)}},YT=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.type="xAxis",e}(qT),KT=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=YT.type,e}return i(e,t),e.type="yAxis",e}(qT),JT=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="grid",e}return i(e,t),e.prototype.render=function(t,e){this.group.removeAll(),t.get("show")&&this.group.add(new hs({shape:t.coordinateSystem.getRect(),style:C({fill:t.get("backgroundColor")},t.getItemStyle()),silent:!0,z2:-1}))},e.type="grid",e}($f),QT={offset:0};function tM(t){t.registerComponentView(JT),t.registerComponentModel(sT),t.registerCoordinateSystem("cartesian2d",TT),fT(t,"x",lT,QT),fT(t,"y",lT,QT),t.registerComponentView(YT),t.registerComponentView(KT),t.registerPreprocessor(function(t){t.xAxis&&t.yAxis&&!t.grid&&(t.grid={})})}function eM(t){t.eachSeriesByType("radar",function(t){var e=t.getData(),i=[],n=t.coordinateSystem;if(n){var r=n.getIndicatorAxes();L(r,function(t,o){e.each(e.mapDimension(r[o].dim),function(t,e){i[e]=i[e]||[];var r=n.dataToPoint(t,o);i[e][o]=iM(r)?r:nM(n)})}),e.each(function(t){var r=B(i[t],function(t){return iM(t)})||nM(n);i[t].push(r.slice()),e.setItemLayout(t,i[t])})}})}function iM(t){return!isNaN(t[0])&&!isNaN(t[1])}function nM(t){return[t.cx,t.cy]}function rM(t){var e=t.polar;if(e){U(e)||(e=[e]);var i=[];L(e,function(e,n){e.indicator?(e.type&&!e.shape&&(e.shape=e.type),t.radar=t.radar||[],U(t.radar)||(t.radar=[t.radar]),t.radar.push(e)):i.push(e)}),t.polar=i}L(t.series,function(t){t&&"radar"===t.type&&t.polarIndex&&(t.radarIndex=t.polarIndex)})}var oM=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(t,e,i){var n=t.coordinateSystem,r=this.group,o=t.getData(),a=this._data;function s(t,e){var i=t.getItemVisual(e,"symbol")||"circle";if("none"!==i){var n=ig(t.getItemVisual(e,"symbolSize")),r=eg(i,-1,-1,2,2),o=t.getItemVisual(e,"symbolRotate")||0;return r.attr({style:{strokeNoScale:!0},z2:100,scaleX:n[0]/2,scaleY:n[1]/2,rotation:o*Math.PI/180||0}),r}}function l(e,i,n,r,o,a){n.removeAll();for(var l=0;l<i.length-1;l++){var u=s(r,o);u&&(u.__dimIdx=l,e[l]?(u.setPosition(e[l]),gc[a?"initProps":"updateProps"](u,{x:i[l][0],y:i[l][1]},t,o)):u.setPosition(i[l]),n.add(u))}}function u(t){return z(t,function(t){return[n.cx,n.cy]})}o.diff(a).add(function(e){var i=o.getItemLayout(e);if(i){var n=new hu,r=new du,a={shape:{points:i}};n.shape.points=u(i),r.shape.points=u(i),Nu(n,a,t,e),Nu(r,a,t,e);var s=new Fn,c=new Fn;s.add(r),s.add(n),s.add(c),l(r.shape.points,i,c,o,e,!0),o.setItemGraphicEl(e,s)}}).update(function(e,i){var n=a.getItemGraphicEl(i),r=n.childAt(0),s=n.childAt(1),u=n.childAt(2),c={shape:{points:o.getItemLayout(e)}};c.shape.points&&(l(r.shape.points,c.shape.points,u,o,e,!1),$u(s),$u(r),Bu(r,c,t),Bu(s,c,t),o.setItemGraphicEl(e,n))}).remove(function(t){r.remove(a.getItemGraphicEl(t))}).execute(),o.eachItemGraphicEl(function(t,e){var i=o.getItemModel(e),n=t.childAt(0),a=t.childAt(1),s=t.childAt(2),l=o.getItemVisual(e,"style"),u=l.fill;r.add(t),n.useStyle(C(i.getModel("lineStyle").getLineStyle(),{fill:"none",stroke:u})),gl(n,i,"lineStyle"),gl(a,i,"areaStyle");var c=i.getModel("areaStyle"),h=c.isEmpty()&&c.parentModel.isEmpty();a.ignore=h,L(["emphasis","select","blur"],function(t){var e=i.getModel([t,"areaStyle"]),n=e.isEmpty()&&e.parentModel.isEmpty();a.ensureState(t).ignore=n&&h}),a.useStyle(C(c.getAreaStyle(),{fill:u,opacity:.7,decal:l.decal}));var p=i.getModel("emphasis"),d=p.getModel("itemStyle").getItemStyle();s.eachChild(function(t){if(t instanceof rs){var n=t.style;t.useStyle(I({image:n.image,x:n.x,y:n.y,width:n.width,height:n.height},l))}else t.useStyle(l),t.setColor(u),t.style.strokeNoScale=!0;t.ensureState("emphasis").style=S(d);var r=o.getStore().get(o.getDimensionIndex(t.__dimIdx),e);(null==r||isNaN(r))&&(r=""),xc(t,bc(i),{labelFetcher:o.hostModel,labelDataIndex:e,labelDimIndex:t.__dimIdx,defaultText:r,inheritColor:u,defaultOpacity:l.opacity})}),pl(t,p.get("focus"),p.get("blurScope"))}),this._data=o},e.prototype.remove=function(){this.group.removeAll(),this._data=null},e.type="radar",e}(Zf),aM=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.hasSymbolVisual=!0,i}return i(e,t),e.prototype.init=function(e){t.prototype.init.apply(this,arguments),this.legendVisualProvider=new tT(F(this.getData,this),F(this.getRawData,this))},e.prototype.getInitialData=function(t,e){return QS(this,{generateCoord:"indicator_",generateCoordCount:1/0})},e.prototype.formatTooltip=function(t,e,i){var n=this.getData(),r=this.coordinateSystem.getIndicatorAxes(),o=this.getData().getName(t),a=""===o?this.name:o,s=kf(this,t);return wf("section",{header:a,sortBlocks:!0,blocks:z(r,function(e){var i=n.get(n.mapDimension(e.dim),t);return wf("nameValue",{markerType:"subItem",markerColor:s,name:e.name,value:i,sortParam:i})})})},e.prototype.getTooltipPosition=function(t){if(null!=t)for(var e=this.getData(),i=this.coordinateSystem,n=e.getValues(z(i.dimensions,function(t){return e.mapDimension(t)}),t),r=0,o=n.length;r<o;r++)if(!isNaN(n[r])){var a=i.getIndicatorAxes();return i.coordToPoint(a[r].dataToCoord(n[r]),r)}},e.type="series.radar",e.dependencies=["radar"],e.defaultOption={zlevel:0,z:2,colorBy:"data",coordinateSystem:"radar",legendHoverLink:!0,radarIndex:0,lineStyle:{width:2,type:"solid",join:"round"},label:{position:"top"},symbolSize:8},e}(Of),sM=pT.value;function lM(t,e){return C({show:e},t)}var uM=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.optionUpdated=function(){var t=this.get("boundaryGap"),e=this.get("splitNumber"),i=this.get("scale"),n=this.get("axisLine"),r=this.get("axisTick"),o=this.get("axisLabel"),a=this.get("axisName"),s=this.get(["axisName","show"]),l=this.get(["axisName","formatter"]),u=this.get("axisNameGap"),c=this.get("triggerEvent"),h=z(this.get("indicator")||[],function(h){null!=h.max&&h.max>0&&!h.min?h.min=0:null!=h.min&&h.min<0&&!h.max&&(h.max=0);var p=a;null!=h.color&&(p=C({color:h.color},a));var d=T(S(h),{boundaryGap:t,splitNumber:e,scale:i,axisLine:n,axisTick:r,axisLabel:o,name:h.text,nameLocation:"end",nameGap:u,nameTextStyle:p,triggerEvent:c},!1);if(s||(d.name=""),"string"==typeof l){var f=d.name;d.name=l.replace("{value}",null!=f?f:"")}else"function"==typeof l&&(d.name=l(d.name,d));var m=new $c(d,null,this.ecModel);return E(m,Mx.prototype),m.mainType="radar",m.componentIndex=this.componentIndex,m},this);this._indicatorModels=h},e.prototype.getIndicatorModels=function(){return this._indicatorModels},e.type="radar",e.defaultOption={zlevel:0,z:0,center:["50%","50%"],radius:"75%",startAngle:90,axisName:{show:!0},boundaryGap:[0,0],splitNumber:5,axisNameGap:15,scale:!1,shape:"polygon",axisLine:T({lineStyle:{color:"#bbb"}},sM.axisLine),axisLabel:lM(sM.axisLabel,!1),axisTick:lM(sM.axisTick,!1),splitLine:lM(sM.splitLine,!0),splitArea:lM(sM.splitArea,!0),indicator:[]},e}(ip),cM=["axisLine","axisTickLabel","axisName"],hM=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(t,e,i){this.group.removeAll(),this._buildAxes(t),this._buildSplitLineAndArea(t)},e.prototype._buildAxes=function(t){var e=t.coordinateSystem;L(z(e.getIndicatorAxes(),function(t){return new kT(t.model,{position:[e.cx,e.cy],rotation:t.angle,labelDirection:-1,tickDirection:-1,nameDirection:1})}),function(t){L(cM,t.add,t),this.group.add(t.getGroup())},this)},e.prototype._buildSplitLineAndArea=function(t){var e=t.coordinateSystem,i=e.getIndicatorAxes();if(i.length){var n=t.get("shape"),r=t.getModel("splitLine"),o=t.getModel("splitArea"),a=r.getModel("lineStyle"),s=o.getModel("areaStyle"),l=r.get("show"),u=o.get("show"),c=a.get("color"),h=s.get("color"),p=U(c)?c:[c],d=U(h)?h:[h],f=[],m=[];if("circle"===n)for(var g=i[0].getTicksCoords(),y=e.cx,v=e.cy,_=0;_<g.length;_++)l&&f[A(f,p,_)].push(new Gl({shape:{cx:y,cy:v,r:g[_].coord}})),u&&_<g.length-1&&m[A(m,d,_)].push(new su({shape:{cx:y,cy:v,r0:g[_].coord,r:g[_+1].coord}}));else{var x,b=z(i,function(t,i){var n=t.getTicksCoords();return x=null==x?n.length-1:Math.min(n.length-1,x),z(n,function(t){return e.coordToPoint(t.coord,i)})}),w=[];for(_=0;_<=x;_++){for(var S=[],T=0;T<i.length;T++)S.push(b[T][_]);S[0]&&S.push(S[0].slice()),l&&f[A(f,p,_)].push(new du({shape:{points:S}})),u&&w&&m[A(m,d,_-1)].push(new hu({shape:{points:S.concat(w)}})),w=S.slice().reverse()}}var M=a.getLineStyle(),I=s.getAreaStyle();L(m,function(t,e){this.group.add(ec(t,{style:C({stroke:"none",fill:d[e%d.length]},I),silent:!0}))},this),L(f,function(t,e){this.group.add(ec(t,{style:C({fill:"none",stroke:p[e%p.length]},M),silent:!0}))},this)}function A(t,e,i){var n=i%e.length;return t[n]=t[n]||[],n}},e.type="radar",e}($f),pM=function(t){function e(e,i,n){var r=t.call(this,e,i,n)||this;return r.type="value",r.angle=0,r.name="",r}return i(e,t),e}($x),dM=function(){function t(t,e,i){this.dimensions=[],this._model=t,this._indicatorAxes=z(t.getIndicatorModels(),function(t,e){var i="indicator_"+e,n=new pM(i,new P_);return n.name=t.get("name"),n.model=t,t.axis=n,this.dimensions.push(i),n},this),this.resize(t,i)}return t.prototype.getIndicatorAxes=function(){return this._indicatorAxes},t.prototype.dataToPoint=function(t,e){var i=this._indicatorAxes[e];return this.coordToPoint(i.dataToCoord(t),e)},t.prototype.coordToPoint=function(t,e){var i=this._indicatorAxes[e].angle;return[this.cx+t*Math.cos(i),this.cy-t*Math.sin(i)]},t.prototype.pointToData=function(t){for(var e=t[0]-this.cx,i=t[1]-this.cy,n=Math.sqrt(e*e+i*i),r,o=Math.atan2(-(i/=n),e/=n),a=1/0,s=-1,l=0;l<this._indicatorAxes.length;l++){var u=this._indicatorAxes[l],c=Math.abs(o-u.angle);c<a&&(r=u,s=l,a=c)}return[s,+(r&&r.coordToData(n))]},t.prototype.resize=function(t,e){var i=t.get("center"),n=e.getWidth(),r=e.getHeight(),o=Math.min(n,r)/2;this.cx=Xn(i[0],n),this.cy=Xn(i[1],r),this.startAngle=t.get("startAngle")*Math.PI/180;var a=t.get("radius");"string"!=typeof a&&"number"!=typeof a||(a=[0,a]),this.r0=Xn(a[0],o),this.r=Xn(a[1],o),L(this._indicatorAxes,function(t,e){t.setExtent(this.r0,this.r);var i=this.startAngle+e*Math.PI*2/this._indicatorAxes.length;i=Math.atan2(Math.sin(i),Math.cos(i)),t.angle=i},this)},t.prototype.update=function(t,e){var i=this._indicatorAxes,n=this._model;L(i,function(t){t.scale.setExtent(1/0,-1/0)}),t.eachSeriesByType("radar",function(e,r){if("radar"===e.get("coordinateSystem")&&t.getComponent("radar",e.get("radarIndex"))===n){var o=e.getData();L(i,function(t){t.scale.unionExtentFromData(o,o.mapDimension(t.dim))})}},this);var r=n.get("splitNumber");function o(t){var e=Math.pow(10,Math.floor(Math.log(t)/Math.LN10)),i=t/e;return 2===i?i=5:i*=2,i*e}L(i,function(t,e){var i=mx(t.scale,t.model).extent;gx(t.scale,t.model);var n=t.model,a=t.scale,s=fx(a,n.get("min",!0)),l=fx(a,n.get("max",!0)),u=a.getInterval();if(null!=s&&null!=l)a.setExtent(+s,+l),a.setInterval((l-s)/r);else if(null!=s){var c=void 0;do{c=s+u*r,a.setExtent(+s,c),a.setInterval(u),u=o(u)}while(c<i[1]&&isFinite(c)&&isFinite(i[1]))}else if(null!=l){var h=void 0;do{h=l-u*r,a.setExtent(h,+l),a.setInterval(u),u=o(u)}while(h>i[0]&&isFinite(h)&&isFinite(i[0]))}else a.getTicks().length-1>r&&(u=o(u)),h=Yn((c=Math.ceil(i[1]/u)*u)-u*r),a.setExtent(h,c),a.setInterval(u)})},t.prototype.convertToPixel=function(t,e,i){return console.warn("Not implemented."),null},t.prototype.convertFromPixel=function(t,e,i){return console.warn("Not implemented."),null},t.prototype.containPoint=function(t){return console.warn("Not implemented."),!1},t.create=function(e,i){var n=[];return e.eachComponent("radar",function(r){var o=new t(r,e,i);n.push(o),r.coordinateSystem=o}),e.eachSeriesByType("radar",function(t){"radar"===t.get("coordinateSystem")&&(t.coordinateSystem=n[t.get("radarIndex")||0])}),n},t.dimensions=[],t}();function fM(t){t.registerCoordinateSystem("radar",dM),t.registerComponentModel(uM),t.registerComponentView(hM),t.registerVisual({seriesType:"radar",reset:function(t){var e=t.getData();e.each(function(t){e.setItemVisual(t,"legendIcon","roundRect")}),e.setVisual("legendIcon","roundRect")}})}var mM="\0_ec_interaction_mutex";function gM(t,e){return!!yM(t)[e]}function yM(t){return t[mM]||(t[mM]={})}Mv({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},function(){});var vM=function(t){function e(e){var i=t.call(this)||this;i._zr=e;var n=F(i._mousedownHandler,i),r=F(i._mousemoveHandler,i),o=F(i._mouseupHandler,i),a=F(i._mousewheelHandler,i),s=F(i._pinchHandler,i);return i.enable=function(t,i){this.disable(),this._opt=C(S(i)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),null==t&&(t=!0),!0!==t&&"move"!==t&&"pan"!==t||(e.on("mousedown",n),e.on("mousemove",r),e.on("mouseup",o)),!0!==t&&"scale"!==t&&"zoom"!==t||(e.on("mousewheel",a),e.on("pinch",s))},i.disable=function(){e.off("mousedown",n),e.off("mousemove",r),e.off("mouseup",o),e.off("mousewheel",a),e.off("pinch",s)},i}return i(e,t),e.prototype.isDragging=function(){return this._dragging},e.prototype.isPinching=function(){return this._pinching},e.prototype.setPointerChecker=function(t){this.pointerChecker=t},e.prototype.dispose=function(){this.disable()},e.prototype._mousedownHandler=function(t){if(!(ne(t)||t.target&&t.target.draggable)){var e=t.offsetX,i=t.offsetY;this.pointerChecker&&this.pointerChecker(t,e,i)&&(this._x=e,this._y=i,this._dragging=!0)}},e.prototype._mousemoveHandler=function(t){if(this._dragging&&bM("moveOnMouseMove",t,this._opt)&&"pinch"!==t.gestureEvent&&!gM(this._zr,"globalPan")){var e=t.offsetX,i=t.offsetY,n=this._x,r=this._y,o=e-n,a=i-r;this._x=e,this._y=i,this._opt.preventDefaultMouseMove&&ie(t.event),xM(this,"pan","moveOnMouseMove",t,{dx:o,dy:a,oldX:n,oldY:r,newX:e,newY:i,isAvailableBehavior:null})}},e.prototype._mouseupHandler=function(t){ne(t)||(this._dragging=!1)},e.prototype._mousewheelHandler=function(t){var e=bM("zoomOnMouseWheel",t,this._opt),i=bM("moveOnMouseWheel",t,this._opt),n=t.wheelDelta,r=Math.abs(n),o=t.offsetX,a=t.offsetY;if(0!==n&&(e||i)){if(e){var s=r>3?1.4:r>1?1.2:1.1;_M(this,"zoom","zoomOnMouseWheel",t,{scale:n>0?s:1/s,originX:o,originY:a,isAvailableBehavior:null})}if(i){var l=Math.abs(n);_M(this,"scrollMove","moveOnMouseWheel",t,{scrollDelta:(n>0?1:-1)*(l>3?.4:l>1?.15:.05),originX:o,originY:a,isAvailableBehavior:null})}}},e.prototype._pinchHandler=function(t){gM(this._zr,"globalPan")||_M(this,"zoom",null,t,{scale:t.pinchScale>1?1.1:1/1.1,originX:t.pinchX,originY:t.pinchY,isAvailableBehavior:null})},e}(Ut);function _M(t,e,i,n,r){t.pointerChecker&&t.pointerChecker(n,r.originX,r.originY)&&(ie(n.event),xM(t,e,i,n,r))}function xM(t,e,i,n,r){r.isAvailableBehavior=F(bM,null,i,n),t.trigger(e,r)}function bM(t,e,i){var n=i[t];return!t||n&&(!$(n)||e.event[n+"Key"])}function wM(t,e,i){var n=t.target;n.x+=e,n.y+=i,n.dirty()}function SM(t,e,i,n){var r=t.target,o=t.zoomLimit,a=t.zoom=t.zoom||1;if(a*=e,o){var s=o.min||0,l=o.max||1/0;a=Math.max(Math.min(l,a),s)}var u=a/t.zoom;t.zoom=a,r.x-=(i-r.x)*(u-1),r.y-=(n-r.y)*(u-1),r.scaleX*=u,r.scaleY*=u,r.dirty()}var TM={axisPointer:1,tooltip:1,brush:1};function MM(t,e,i){var n=e.getComponentByElement(t.topTarget),r=n&&n.coordinateSystem;return n&&n!==i&&!TM.hasOwnProperty(n.mainType)&&r&&r.model!==i}var IM=["rect","circle","line","ellipse","polygon","polyline","path"],CM=ht(IM),AM=ht(IM.concat(["g"])),kM=ht(IM.concat(["g"])),DM=zr();function EM(t){var e=t.getItemStyle(),i=t.get("areaColor");return null!=i&&(e.fill=i),e}var PM=function(){function t(t){var e=new Fn;this.uid=Hc("ec_map_draw"),this._controller=new vM(t.getZr()),this._controllerHost={target:e},this.group=e,e.add(this._regionsGroup=new Fn),e.add(this._svgGroup=new Fn)}return t.prototype.draw=function(t,e,i,n,r){var o="geo"===t.mainType,a=t.getData&&t.getData();o&&e.eachComponent({mainType:"series",subType:"map"},function(e){a||e.getHostGeoModel()!==t||(a=e.getData())});var s=t.coordinateSystem,l=this._regionsGroup,u=this.group,c=s.getTransformInfo(),h=c.raw,p=c.roam;!l.childAt(0)||r?(u.x=p.x,u.y=p.y,u.scaleX=p.scaleX,u.scaleY=p.scaleY,u.dirty()):Bu(u,p,t);var d=a&&a.getVisual("visualMeta")&&a.getVisual("visualMeta").length>0,f={api:i,geo:s,mapOrGeoModel:t,data:a,isVisualEncodedByVisualMap:d,isGeo:o,transformInfoRaw:h};"geoJSON"===s.resourceType?this._buildGeoJSON(f):"geoSVG"===s.resourceType&&this._buildSVG(f),this._updateController(t,e,i),this._updateMapSelectHandler(t,l,i,n)},t.prototype._buildGeoJSON=function(t){var e=this._regionsGroupByName=ht(),i=ht(),n=this._regionsGroup,r=t.transformInfoRaw,o=t.mapOrGeoModel,a=t.data,s=function(t){return[t[0]*r.scaleX+r.x,t[1]*r.scaleY+r.y]};n.removeAll(),L(t.geo.regions,function(r){var l=r.name,u=e.get(l),c=i.get(l)||{},h=c.dataIdx,p=c.regionModel;u||(u=e.set(l,new Fn),n.add(u),h=a?a.indexOfName(l):null,p=t.isGeo?o.getRegionModel(l):a?a.getItemModel(h):null,i.set(l,{dataIdx:h,regionModel:p}));var d=new Su({segmentIgnoreThreshold:1,shape:{paths:[]}});u.add(d),L(r.geometries,function(t){if("polygon"===t.type){for(var e=[],i=0;i<t.exterior.length;++i)e.push(s(t.exterior[i]));for(d.shape.paths.push(new hu({segmentIgnoreThreshold:1,shape:{points:e}})),i=0;i<(t.interiors?t.interiors.length:0);++i){for(var n=t.interiors[i],r=[],o=0;o<n.length;++o)r.push(s(n[o]));d.shape.paths.push(new hu({segmentIgnoreThreshold:1,shape:{points:r}}))}}}),LM(t,d,h,p),d instanceof Io&&(d.culling=!0);var f=s(r.getCenter());zM(t,d,l,p,o,h,f)}),e.each(function(e,n){var r=i.get(n),a=r.dataIdx,s=r.regionModel;OM(t,e,n,s,o,a),RM(t,e,n,s,o),BM(t,e,n,s,o)},this)},t.prototype._buildSVG=function(t){var e=t.geo.map,i=t.transformInfoRaw;this._svgGroup.x=i.x,this._svgGroup.y=i.y,this._svgGroup.scaleX=i.scaleX,this._svgGroup.scaleY=i.scaleY,this._svgResourceChanged(e)&&(this._freeSVG(),this._useSVG(e));var n=this._svgDispatcherMap=ht(),r=!1;L(this._svgGraphicRecord.named,function(e){var i=e.name,o=t.mapOrGeoModel,a=t.data,s=e.svgNodeTagLower,l=e.el,u=a?a.indexOfName(i):null,c=o.getRegionModel(i);null!=CM.get(s)&&l instanceof Io&&LM(t,l,u,c),l instanceof Io&&(l.culling=!0),l.z2EmphasisLift=0,e.namedFrom||(null!=kM.get(s)&&zM(t,l,i,c,o,u,null),OM(t,l,i,c,o,u),RM(t,l,i,c,o),null!=AM.get(s)&&("self"===BM(t,l,i,c,o)&&(r=!0),(n.get(i)||n.set(i,[])).push(l)))},this),this._enableBlurEntireSVG(r,t)},t.prototype._enableBlurEntireSVG=function(t,e){if(t&&e.isGeo){var i=e.mapOrGeoModel.getModel(["blur","itemStyle"]).getItemStyle().opacity;this._svgGraphicRecord.root.traverse(function(t){if(!t.isGroup){Ys(t);var e=t.ensureState("blur").style||{};null==e.opacity&&null!=i&&(e.opacity=i),t.ensureState("emphasis")}})}},t.prototype.remove=function(){this._regionsGroup.removeAll(),this._regionsGroupByName=null,this._svgGroup.removeAll(),this._freeSVG(),this._controller.dispose(),this._controllerHost=null},t.prototype.findHighDownDispatchers=function(t,e){if(null==t)return[];var i=e.coordinateSystem;if("geoJSON"===i.resourceType){var n=this._regionsGroupByName;if(n){var r=n.get(t);return r?[r]:[]}}else if("geoSVG"===i.resourceType)return this._svgDispatcherMap&&this._svgDispatcherMap.get(t)||[]},t.prototype._svgResourceChanged=function(t){return this._svgMapName!==t},t.prototype._useSVG=function(t){var e=xy(t);if(e&&"geoSVG"===e.type){var i=e.useGraphic(this.uid);this._svgGroup.add(i.root),this._svgGraphicRecord=i,this._svgMapName=t}},t.prototype._freeSVG=function(){var t=this._svgMapName;if(null!=t){var e=xy(t);e&&"geoSVG"===e.type&&e.freeGraphic(this.uid),this._svgGraphicRecord=null,this._svgDispatcherMap=null,this._svgGroup.removeAll(),this._svgMapName=null}},t.prototype._updateController=function(t,e,i){var n=t.coordinateSystem,r=this._controller,o=this._controllerHost;o.zoomLimit=t.get("scaleLimit"),o.zoom=n.getZoom(),r.enable(t.get("roam")||!1);var a=t.mainType;function s(){var e={type:"geoRoam",componentType:a};return e[a+"Id"]=t.id,e}r.off("pan").on("pan",function(t){this._mouseDownFlag=!1,wM(o,t.dx,t.dy),i.dispatchAction(I(s(),{dx:t.dx,dy:t.dy}))},this),r.off("zoom").on("zoom",function(t){this._mouseDownFlag=!1,SM(o,t.scale,t.originX,t.originY),i.dispatchAction(I(s(),{zoom:t.scale,originX:t.originX,originY:t.originY}))},this),r.setPointerChecker(function(e,r,o){return n.containPoint([r,o])&&!MM(e,i,t)})},t.prototype.resetForLabelLayout=function(){this.group.traverse(function(t){var e=t.getTextContent();e&&(e.ignore=DM(e).ignore)})},t.prototype._updateMapSelectHandler=function(t,e,i,n){var r=this;e.off("mousedown"),e.off("click"),t.get("selectedMode")&&(e.on("mousedown",function(){r._mouseDownFlag=!0}),e.on("click",function(t){r._mouseDownFlag&&(r._mouseDownFlag=!1)}))},t}();function LM(t,e,i,n){var r=n.getModel("itemStyle"),o=n.getModel(["emphasis","itemStyle"]),a=n.getModel(["blur","itemStyle"]),s=n.getModel(["select","itemStyle"]),l=EM(r),u=EM(o),c=EM(s),h=EM(a),p=t.data;if(p){var d=p.getItemVisual(i,"style"),f=p.getItemVisual(i,"decal");t.isVisualEncodedByVisualMap&&d.fill&&(l.fill=d.fill),f&&(l.decal=Cg(f,t.api))}e.setStyle(l),e.style.strokeNoScale=!0,e.ensureState("emphasis").style=u,e.ensureState("select").style=c,e.ensureState("blur").style=h,Ys(e)}function zM(t,e,i,n,r,o,a){var s=t.data,l=t.isGeo,u=s&&isNaN(s.get(s.mapDimension("value"),o)),c=s&&s.getItemLayout(o);if(l||u||c&&c.showLabel){var h=l?i:o,p=void 0;(!s||o>=0)&&(p=r);var d=a?{normal:{align:"center",verticalAlign:"middle"}}:null;xc(e,bc(n),{labelFetcher:p,labelDataIndex:h,defaultText:i},d);var f=e.getTextContent();if(f&&(DM(f).ignore=f.ignore,e.textConfig&&a)){var m=e.getBoundingRect().clone();e.textConfig.layoutRect=m,e.textConfig.position=[(a[0]-m.x)/m.width*100+"%",(a[1]-m.y)/m.height*100+"%"]}e.disableLabelAnimation=!0}else e.removeTextContent(),e.removeTextConfig(),e.disableLabelAnimation=null}function OM(t,e,i,n,r,o){t.data?t.data.setItemGraphicEl(o,e):Ss(e).eventData={componentType:"geo",componentIndex:r.componentIndex,geoIndex:r.componentIndex,name:i,region:n&&n.option||{}}}function RM(t,e,i,n,r){t.data||mc({el:e,componentModel:r,itemName:i,itemTooltipOption:n.get("tooltip")})}function BM(t,e,i,n,r){e.highDownSilentOnTouch=!!r.get("selectedMode");var o=n.getModel("emphasis"),a=o.get("focus");return pl(e,a,o.get("blurScope")),t.isGeo&&function(t,e,i){var n=Ss(t);n.componentMainType=e.mainType,n.componentIndex=e.componentIndex,n.componentHighDownName=i}(e,r,i),a}var NM=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(t,e,i,n){if(!n||"mapToggleSelect"!==n.type||n.from!==this.uid){var r=this.group;if(r.removeAll(),!t.getHostGeoModel()){if(this._mapDraw&&n&&"geoRoam"===n.type&&this._mapDraw.resetForLabelLayout(),n&&"geoRoam"===n.type&&"series"===n.componentType&&n.seriesId===t.id)(o=this._mapDraw)&&r.add(o.group);else if(t.needsDrawMap){var o=this._mapDraw||new PM(i);r.add(o.group),o.draw(t,e,i,this,n),this._mapDraw=o}else this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;t.get("showLegendSymbol")&&e.getComponent("legend")&&this._renderSymbols(t,e,i)}}},e.prototype.remove=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null,this.group.removeAll()},e.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null},e.prototype._renderSymbols=function(t,e,i){var n=t.originalData,r=this.group;n.each(n.mapDimension("value"),function(e,i){if(!isNaN(e)){var o=n.getItemLayout(i);if(o&&o.point){var a=o.point,s=o.offset,l=new Gl({style:{fill:t.getData().getVisual("style").fill},shape:{cx:a[0]+9*s,cy:a[1],r:3},silent:!0,z2:8+(s?0:11)});if(!s){var u=t.mainSeries.getData(),c=n.getName(i),h=u.indexOfName(c),p=n.getItemModel(i),d=p.getModel("label"),f=u.getItemGraphicEl(h);xc(l,bc(p),{labelFetcher:{getFormattedLabel:function(e,i){return t.getFormattedLabel(h,i)}}}),l.disableLabelAnimation=!0,d.get("position")||l.setTextConfig({position:"bottom"}),f.onHoverStateChange=function(t){qs(l,t)}}r.add(l)}}})},e.type="map",e}(Zf),FM=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.needsDrawMap=!1,i.seriesGroup=[],i.getTooltipPosition=function(t){if(null!=t){var e=this.getData().getName(t),i=this.coordinateSystem,n=i.getRegion(e);return n&&i.dataToPoint(n.getCenter())}},i}return i(e,t),e.prototype.getInitialData=function(t){for(var e=QS(this,{coordDimensions:["value"],encodeDefaulter:V(xp,this)}),i=ht(),n=[],r=0,o=e.count();r<o;r++){var a=e.getName(r);i.set(a,!0)}return L(wy(this.getMapType(),this.option.nameMap,this.option.nameProperty).regions,function(t){var e=t.name;i.get(e)||n.push(e)}),e.appendValues([],n),e},e.prototype.getHostGeoModel=function(){var t=this.option.geoIndex;return null!=t?this.ecModel.getComponent("geo",t):null},e.prototype.getMapType=function(){return(this.getHostGeoModel()||this).option.map},e.prototype.getRawValue=function(t){var e=this.getData();return e.get(e.mapDimension("value"),t)},e.prototype.getRegionModel=function(t){var e=this.getData();return e.getItemModel(e.indexOfName(t))},e.prototype.formatTooltip=function(t,e,i){for(var n=this.getData(),r=this.getRawValue(t),o=n.getName(t),a=this.seriesGroup,s=[],l=0;l<a.length;l++){var u=a[l].originalData.indexOfName(o),c=n.mapDimension("value");isNaN(a[l].originalData.get(c,u))||s.push(a[l].name)}return wf("section",{header:s.join(", "),noHeader:!s.length,blocks:[wf("nameValue",{name:o,value:r})]})},e.prototype.setZoom=function(t){this.option.zoom=t},e.prototype.setCenter=function(t){this.option.center=t},e.prototype.getLegendIcon=function(t){var e=t.icon||"roundRect",i=eg(e,0,0,t.itemWidth,t.itemHeight,t.itemStyle.fill);return i.setStyle(t.itemStyle),i.style.stroke="none",e.indexOf("empty")>-1&&(i.style.stroke=i.style.fill,i.style.fill="#fff",i.style.lineWidth=2),i},e.type="series.map",e.dependencies=["geo"],e.layoutMode="box",e.defaultOption={zlevel:0,z:2,coordinateSystem:"geo",map:"",left:"center",top:"center",aspectScale:null,showLegendSymbol:!0,boundingCoords:null,center:null,zoom:1,scaleLimit:null,selectedMode:!0,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444",areaColor:"#eee"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{areaColor:"rgba(255,215,0,0.8)"}},select:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},nameProperty:"name"},e}(Of);function VM(t){var e={};t.eachSeriesByType("map",function(t){var i=t.getHostGeoModel(),n=i?"o"+i.id:"i"+t.getMapType();(e[n]=e[n]||[]).push(t)}),L(e,function(t,e){for(var i,n,r,o=(i=z(t,function(t){return t.getData()}),n=t[0].get("mapValueCalculation"),r={},L(i,function(t){t.each(t.mapDimension("value"),function(e,i){var n="ec-"+t.getName(i);r[n]=r[n]||[],isNaN(e)||r[n].push(e)})}),i[0].map(i[0].mapDimension("value"),function(t,e){for(var o="ec-"+i[0].getName(e),a=0,s=1/0,l=-1/0,u=r[o].length,c=0;c<u;c++)s=Math.min(s,r[o][c]),l=Math.max(l,r[o][c]),a+=r[o][c];return 0===u?NaN:"min"===n?s:"max"===n?l:"average"===n?a/u:a})),a=0;a<t.length;a++)t[a].originalData=t[a].getData();for(a=0;a<t.length;a++)t[a].seriesGroup=t,t[a].needsDrawMap=0===a&&!t[a].getHostGeoModel(),t[a].setData(o.cloneShallow()),t[a].mainSeries=t[0]})}function UM(t){var e={};t.eachSeriesByType("map",function(i){var n=i.getMapType();if(!i.getHostGeoModel()&&!e[n]){var r={};L(i.seriesGroup,function(e){var i=e.coordinateSystem,n=e.originalData;e.get("showLegendSymbol")&&t.getComponent("legend")&&n.each(n.mapDimension("value"),function(t,e){var o=n.getName(e),a=i.getRegion(o);if(a&&!isNaN(t)){var s=r[o]||0,l=i.dataToPoint(a.getCenter());r[o]=s+1,n.setItemLayout(e,{point:l,offset:s})}})});var o=i.getData();o.each(function(t){var e=o.getName(t),i=o.getItemLayout(t)||{};i.showLabel=!r[e],o.setItemLayout(t,i)}),e[n]=!0}})}var GM=Ot,$M=function(t){function e(e){var i=t.call(this)||this;return i.type="view",i.dimensions=["x","y"],i._roamTransformable=new an,i._rawTransformable=new an,i.name=e,i}return i(e,t),e.prototype.setBoundingRect=function(t,e,i,n){return this._rect=new yn(t,e,i,n),this._rect},e.prototype.getBoundingRect=function(){return this._rect},e.prototype.setViewRect=function(t,e,i,n){this._transformTo(t,e,i,n),this._viewRect=new yn(t,e,i,n)},e.prototype._transformTo=function(t,e,i,n){var r=this.getBoundingRect(),o=this._rawTransformable;o.transform=r.calculateTransform(new yn(t,e,i,n));var a=o.parent;o.parent=null,o.decomposeTransform(),o.parent=a,this._updateTransform()},e.prototype.setCenter=function(t){t&&(this._center=t,this._updateCenterAndZoom())},e.prototype.setZoom=function(t){t=t||1;var e=this.zoomLimit;e&&(null!=e.max&&(t=Math.min(e.max,t)),null!=e.min&&(t=Math.max(e.min,t))),this._zoom=t,this._updateCenterAndZoom()},e.prototype.getDefaultCenter=function(){var t=this.getBoundingRect();return[t.x+t.width/2,t.y+t.height/2]},e.prototype.getCenter=function(){return this._center||this.getDefaultCenter()},e.prototype.getZoom=function(){return this._zoom||1},e.prototype.getRoamTransform=function(){return this._roamTransformable.getLocalTransform()},e.prototype._updateCenterAndZoom=function(){var t=this._rawTransformable.getLocalTransform(),e=this._roamTransformable,i=this.getDefaultCenter(),n=this.getCenter(),r=this.getZoom();n=Ot([],n,t),i=Ot([],i,t),e.originX=n[0],e.originY=n[1],e.x=i[0]-n[0],e.y=i[1]-n[1],e.scaleX=e.scaleY=r,this._updateTransform()},e.prototype._updateTransform=function(){var t=this._roamTransformable,e=this._rawTransformable;e.parent=t,t.updateTransform(),e.updateTransform(),Gi(this.transform||(this.transform=[]),e.transform||[1,0,0,1,0,0]),this._rawTransform=e.getLocalTransform(),this.invTransform=this.invTransform||[],Zi(this.invTransform,this.transform),this.decomposeTransform()},e.prototype.getTransformInfo=function(){var t=this._rawTransformable,e=this._roamTransformable,i=new an;return i.transform=e.transform,i.decomposeTransform(),{roam:{x:i.x,y:i.y,scaleX:i.scaleX,scaleY:i.scaleY},raw:{x:t.x,y:t.y,scaleX:t.scaleX,scaleY:t.scaleY}}},e.prototype.getViewRect=function(){return this._viewRect},e.prototype.getViewRectAfterRoam=function(){var t=this.getBoundingRect().clone();return t.applyTransform(this.transform),t},e.prototype.dataToPoint=function(t,e,i){var n=e?this._rawTransform:this.transform;return i=i||[],n?GM(i,t,n):xt(i,t)},e.prototype.pointToData=function(t){var e=this.invTransform;return e?GM([],t,e):[t[0],t[1]]},e.prototype.convertToPixel=function(t,e,i){var n=WM(e);return n===this?n.dataToPoint(i):null},e.prototype.convertFromPixel=function(t,e,i){var n=WM(e);return n===this?n.pointToData(i):null},e.prototype.containPoint=function(t){return this.getViewRectAfterRoam().contain(t[0],t[1])},e.dimensions=["x","y"],e}(an);function WM(t){var e=t.seriesModel;return e?e.coordinateSystem:null}var HM={geoJSON:{aspectScale:.75,invertLongitute:!0},geoSVG:{aspectScale:1,invertLongitute:!1}},jM=["lng","lat"],ZM=function(t){function e(e,i,n){var r=t.call(this,e)||this;r.dimensions=jM,r.type="geo",r._nameCoordMap=ht(),r.map=i;var o=wy(i,n.nameMap,n.nameProperty),a=xy(i);r.resourceType=a?a.type:null;var s=HM[a.type];r._regionsMap=o.regionsMap,r._invertLongitute=s.invertLongitute,r.regions=o.regions,r.aspectScale=et(n.aspectScale,s.aspectScale);var l=o.boundingRect;return r.setBoundingRect(l.x,l.y,l.width,l.height),r}return i(e,t),e.prototype._transformTo=function(t,e,i,n){var r=this.getBoundingRect(),o=this._invertLongitute;r=r.clone(),o&&(r.y=-r.y-r.height);var a=this._rawTransformable;a.transform=r.calculateTransform(new yn(t,e,i,n));var s=a.parent;a.parent=null,a.decomposeTransform(),a.parent=s,o&&(a.scaleY=-a.scaleY),this._updateTransform()},e.prototype.getRegion=function(t){return this._regionsMap.get(t)},e.prototype.getRegionByCoord=function(t){for(var e=this.regions,i=0;i<e.length;i++){var n=e[i];if("geoJSON"===n.type&&n.contain(t))return e[i]}},e.prototype.addGeoCoord=function(t,e){this._nameCoordMap.set(t,e)},e.prototype.getGeoCoord=function(t){var e=this._regionsMap.get(t);return this._nameCoordMap.get(t)||e&&e.getCenter()},e.prototype.dataToPoint=function(t,e,i){if("string"==typeof t&&(t=this.getGeoCoord(t)),t)return $M.prototype.dataToPoint.call(this,t,e,i)},e.prototype.convertToPixel=function(t,e,i){var n=qM(e);return n===this?n.dataToPoint(i):null},e.prototype.convertFromPixel=function(t,e,i){var n=qM(e);return n===this?n.pointToData(i):null},e}($M);function qM(t){var e=t.geoModel,i=t.seriesModel;return e?e.coordinateSystem:i?i.coordinateSystem||(i.getReferringComponents("geo",Nr).models[0]||{}).coordinateSystem:null}function XM(t,e){var i=t.get("boundingCoords");if(null!=i){var n=i[0],r=i[1];isNaN(n[0])||isNaN(n[1])||isNaN(r[0])||isNaN(r[1])||this.setBoundingRect(n[0],n[1],r[0]-n[0],r[1]-n[1])}var o,a,s,l=this.getBoundingRect(),u=t.get("layoutCenter"),c=t.get("layoutSize"),h=e.getWidth(),p=e.getHeight(),d=l.width/l.height*this.aspectScale,f=!1;if(u&&c&&(o=[Xn(u[0],h),Xn(u[1],p)],a=Xn(c,Math.min(h,p)),isNaN(o[0])||isNaN(o[1])||isNaN(a)||(f=!0)),f)s={},d>1?(s.width=a,s.height=a/d):(s.height=a,s.width=a*d),s.y=o[1]-s.height/2,s.x=o[0]-s.width/2;else{var m=t.getBoxLayoutParams();m.aspect=d,s=Xh(m,{width:h,height:p})}this.setViewRect(s.x,s.y,s.width,s.height),this.setCenter(t.get("center")),this.setZoom(t.get("zoom"))}E(ZM,$M);var YM=new(function(){function t(){this.dimensions=jM}return t.prototype.create=function(t,e){var i=[];t.eachComponent("geo",function(t,n){var r=t.get("map"),o=new ZM(r+n,r,{nameMap:t.get("nameMap"),nameProperty:t.get("nameProperty"),aspectScale:t.get("aspectScale")});o.zoomLimit=t.get("scaleLimit"),i.push(o),t.coordinateSystem=o,o.model=t,o.resize=XM,o.resize(t,e)}),t.eachSeries(function(t){if("geo"===t.get("coordinateSystem")){var e=t.get("geoIndex")||0;t.coordinateSystem=i[e]}});var n={};return t.eachSeriesByType("map",function(t){if(!t.getHostGeoModel()){var e=t.getMapType();n[e]=n[e]||[],n[e].push(t)}}),L(n,function(t,n){var r=z(t,function(t){return t.get("nameMap")}),o=new ZM(n,n,{nameMap:M(r),nameProperty:t[0].get("nameProperty"),aspectScale:t[0].get("aspectScale")});o.zoomLimit=tt.apply(null,z(t,function(t){return t.get("scaleLimit")})),i.push(o),o.resize=XM,o.resize(t[0],e),L(t,function(t){t.coordinateSystem=o,function(t,e){L(e.get("geoCoord"),function(e,i){t.addGeoCoord(i,e)})}(o,t)})}),i},t.prototype.getFilledRegions=function(t,e,i,n){for(var r=(t||[]).slice(),o=ht(),a=0;a<r.length;a++)o.set(r[a].name,r[a]);return L(wy(e,i,n).regions,function(t){var e=t.name;!o.get(e)&&r.push({name:e})}),r},t}()),KM=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.init=function(t,e,i){var n=xy(t.map);if(n&&"geoJSON"===n.type){var r=t.itemStyle=t.itemStyle||{};"color"in r||(r.color="#eee")}this.mergeDefaultAndTheme(t,i),Sr(t,"label",["show"])},e.prototype.optionUpdated=function(){var t=this,e=this.option;e.regions=YM.getFilledRegions(e.regions,e.map,e.nameMap,e.nameProperty);var i={};this._optionModelMap=O(e.regions||[],function(e,n){var r=n.name;return r&&(e.set(r,new $c(n,t,t.ecModel)),n.selected&&(i[r]=!0)),e},ht()),e.selectedMap||(e.selectedMap=i)},e.prototype.getRegionModel=function(t){return this._optionModelMap.get(t)||new $c(null,this,this.ecModel)},e.prototype.getFormattedLabel=function(t,e){var i=this.getRegionModel(t),n="normal"===e?i.get(["label","formatter"]):i.get(["emphasis","label","formatter"]),r={name:t};return"function"==typeof n?(r.status=e,n(r)):"string"==typeof n?n.replace("{a}",null!=t?t:""):void 0},e.prototype.setZoom=function(t){this.option.zoom=t},e.prototype.setCenter=function(t){this.option.center=t},e.prototype.select=function(t){var e=this.option,i=e.selectedMode;i&&("multiple"!==i&&(e.selectedMap=null),(e.selectedMap||(e.selectedMap={}))[t]=!0)},e.prototype.unSelect=function(t){var e=this.option.selectedMap;e&&(e[t]=!1)},e.prototype.toggleSelected=function(t){this[this.isSelected(t)?"unSelect":"select"](t)},e.prototype.isSelected=function(t){var e=this.option.selectedMap;return!(!e||!e[t])},e.type="geo",e.layoutMode="box",e.defaultOption={zlevel:0,z:0,show:!0,left:"center",top:"center",aspectScale:null,silent:!1,map:"",boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},select:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},regions:[]},e}(ip);function JM(t,e,i){var n=t.getZoom(),r=t.getCenter(),o=e.zoom,a=t.dataToPoint(r);if(null!=e.dx&&null!=e.dy&&(a[0]-=e.dx,a[1]-=e.dy,t.setCenter(t.pointToData(a))),null!=o){if(i){var s=i.min||0,l=i.max||1/0;o=Math.max(Math.min(n*o,l),s)/n}t.scaleX*=o,t.scaleY*=o;var u=(e.originX-t.x)*(o-1),c=(e.originY-t.y)*(o-1);t.x-=u,t.y-=c,t.updateTransform(),t.setCenter(t.pointToData(a)),t.setZoom(o*n)}return{center:t.getCenter(),zoom:t.getZoom()}}var QM=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.focusBlurEnabled=!0,i}return i(e,t),e.prototype.init=function(t,e){this._api=e},e.prototype.render=function(t,e,i,n){if(this._model=t,!t.get("show"))return this._mapDraw&&this._mapDraw.remove(),void(this._mapDraw=null);this._mapDraw||(this._mapDraw=new PM(i));var r=this._mapDraw;r.draw(t,e,i,this,n),r.group.on("click",this._handleRegionClick,this),r.group.silent=t.get("silent"),this.group.add(r.group),this.updateSelectStatus(t,e,i)},e.prototype._handleRegionClick=function(t){var e;$m(t.target,function(t){return null!=(e=Ss(t).eventData)},!0),e&&this._api.dispatchAction({type:"geoToggleSelect",geoId:this._model.id,name:e.name})},e.prototype.updateSelectStatus=function(t,e,i){var n=this;this._mapDraw.group.traverse(function(t){var e=Ss(t).eventData;if(e)return n._model.isSelected(e.name)?i.enterSelect(t):i.leaveSelect(t),!0})},e.prototype.findHighDownDispatchers=function(t){return this._mapDraw&&this._mapDraw.findHighDownDispatchers(t,this._model)},e.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove()},e.type="geo",e}($f);function tI(t){function e(e,i){i.update="geo:updateSelectStatus",t.registerAction(i,function(t,i){var n={},r=[];return i.eachComponent({mainType:"geo",query:t},function(i){i[e](t.name),L(i.coordinateSystem.regions,function(t){n[t.name]=i.isSelected(t.name)||!1});var o=[];L(n,function(t,e){n[e]&&o.push(e)}),r.push({geoIndex:i.componentIndex,name:o})}),{selected:n,allSelected:r,name:t.name}})}t.registerCoordinateSystem("geo",YM),t.registerComponentModel(KM),t.registerComponentView(QM),e("toggleSelected",{type:"geoToggleSelect",event:"geoselectchanged"}),e("select",{type:"geoSelect",event:"geoselected"}),e("unSelect",{type:"geoUnSelect",event:"geounselected"}),t.registerAction({type:"geoRoam",event:"geoRoam",update:"updateTransform"},function(t,e){var i=t.componentType||"series";e.eachComponent({mainType:i,query:t},function(e){var n=e.coordinateSystem;if("geo"===n.type){var r=JM(n,t,e.get("scaleLimit"));e.setCenter&&e.setCenter(r.center),e.setZoom&&e.setZoom(r.zoom),"series"===i&&L(e.seriesGroup,function(t){t.setCenter(r.center),t.setZoom(r.zoom)})}})})}function eI(t,e){var i=t.isExpand?t.children:[],n=t.parentNode.children,r=t.hierNode.i?n[t.hierNode.i-1]:null;if(i.length){!function(t){for(var e=t.children,i=e.length,n=0,r=0;--i>=0;){var o=e[i];o.hierNode.prelim+=n,o.hierNode.modifier+=n,r+=o.hierNode.change,n+=o.hierNode.shift+r}}(t);var o=(i[0].hierNode.prelim+i[i.length-1].hierNode.prelim)/2;r?(t.hierNode.prelim=r.hierNode.prelim+e(t,r),t.hierNode.modifier=t.hierNode.prelim-o):t.hierNode.prelim=o}else r&&(t.hierNode.prelim=r.hierNode.prelim+e(t,r));t.parentNode.hierNode.defaultAncestor=function(t,e,i,n){if(e){for(var r=t,o=t,a=o.parentNode.children[0],s=e,l=r.hierNode.modifier,u=o.hierNode.modifier,c=a.hierNode.modifier,h=s.hierNode.modifier;s=oI(s),o=aI(o),s&&o;){r=oI(r),a=aI(a),r.hierNode.ancestor=t;var p=s.hierNode.prelim+h-o.hierNode.prelim-u+n(s,o);p>0&&(lI(sI(s,t,i),t,p),u+=p,l+=p),h+=s.hierNode.modifier,u+=o.hierNode.modifier,l+=r.hierNode.modifier,c+=a.hierNode.modifier}s&&!oI(r)&&(r.hierNode.thread=s,r.hierNode.modifier+=h-l),o&&!aI(a)&&(a.hierNode.thread=o,a.hierNode.modifier+=u-c,i=t)}return i}(t,r,t.parentNode.hierNode.defaultAncestor||n[0],e)}function iI(t){var e=t.hierNode.prelim+t.parentNode.hierNode.modifier;t.setLayout({x:e},!0),t.hierNode.modifier+=t.parentNode.hierNode.modifier}function nI(t){return arguments.length?t:uI}function rI(t,e){return{x:e*Math.cos(t-=Math.PI/2),y:e*Math.sin(t)}}function oI(t){var e=t.children;return e.length&&t.isExpand?e[e.length-1]:t.hierNode.thread}function aI(t){var e=t.children;return e.length&&t.isExpand?e[0]:t.hierNode.thread}function sI(t,e,i){return t.hierNode.ancestor.parentNode===e.parentNode?t.hierNode.ancestor:i}function lI(t,e,i){var n=i/(e.hierNode.i-t.hierNode.i);e.hierNode.change-=n,e.hierNode.shift+=i,e.hierNode.modifier+=i,e.hierNode.prelim+=i,t.hierNode.change+=n}function uI(t,e){return t.parentNode===e.parentNode?1:2}var cI=function(){this.parentPoint=[],this.childPoints=[]},hI=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new cI},e.prototype.buildPath=function(t,e){var i=e.childPoints,n=i.length,r=e.parentPoint,o=i[0],a=i[n-1];if(1===n)return t.moveTo(r[0],r[1]),void t.lineTo(o[0],o[1]);var s=e.orient,l="TB"===s||"BT"===s?0:1,u=1-l,c=Xn(e.forkPosition,1),h=[];h[l]=r[l],h[u]=r[u]+(a[u]-r[u])*c,t.moveTo(r[0],r[1]),t.lineTo(h[0],h[1]),t.moveTo(o[0],o[1]),h[l]=o[l],t.lineTo(h[0],h[1]),h[l]=a[l],t.lineTo(h[0],h[1]),t.lineTo(a[0],a[1]);for(var p=1;p<n-1;p++){var d=i[p];t.moveTo(d[0],d[1]),h[l]=d[l],t.lineTo(h[0],h[1])}},e}(Qa),pI=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._mainGroup=new Fn,i}return i(e,t),e.prototype.init=function(t,e){this._controller=new vM(e.getZr()),this._controllerHost={target:this.group},this.group.add(this._mainGroup)},e.prototype.render=function(t,e,i){var n=t.getData(),r=t.layoutInfo,o=this._mainGroup;"radial"===t.get("layout")?(o.x=r.x+r.width/2,o.y=r.y+r.height/2):(o.x=r.x,o.y=r.y),this._updateViewCoordSys(t),this._updateController(t,e,i);var a=this._data;n.diff(a).add(function(e){dI(n,e)&&fI(n,e,null,o,t)}).update(function(e,i){var r=a.getItemGraphicEl(i);dI(n,e)?fI(n,e,r,o,t):r&&yI(a,i,r,o,t)}).remove(function(e){var i=a.getItemGraphicEl(e);i&&yI(a,e,i,o,t)}).execute(),this._nodeScaleRatio=t.get("nodeScaleRatio"),this._updateNodeAndLinkScale(t),!0===t.get("expandAndCollapse")&&n.eachItemGraphicEl(function(e,n){e.off("click").on("click",function(){i.dispatchAction({type:"treeExpandAndCollapse",seriesId:t.id,dataIndex:n})})}),this._data=n},e.prototype._updateViewCoordSys=function(t){var e=t.getData(),i=[];e.each(function(t){var n=e.getItemLayout(t);!n||isNaN(n.x)||isNaN(n.y)||i.push([+n.x,+n.y])});var n=[],r=[];sa(i,n,r);var o=this._min,a=this._max;r[0]-n[0]==0&&(n[0]=o?o[0]:n[0]-1,r[0]=a?a[0]:r[0]+1),r[1]-n[1]==0&&(n[1]=o?o[1]:n[1]-1,r[1]=a?a[1]:r[1]+1);var s=t.coordinateSystem=new $M;s.zoomLimit=t.get("scaleLimit"),s.setBoundingRect(n[0],n[1],r[0]-n[0],r[1]-n[1]),s.setCenter(t.get("center")),s.setZoom(t.get("zoom")),this.group.attr({x:s.x,y:s.y,scaleX:s.scaleX,scaleY:s.scaleY}),this._min=n,this._max=r},e.prototype._updateController=function(t,e,i){var n=this,r=this._controller,o=this._controllerHost,a=this.group;r.setPointerChecker(function(e,n,r){var o=a.getBoundingRect();return o.applyTransform(a.transform),o.contain(n,r)&&!MM(e,i,t)}),r.enable(t.get("roam")),o.zoomLimit=t.get("scaleLimit"),o.zoom=t.coordinateSystem.getZoom(),r.off("pan").off("zoom").on("pan",function(e){wM(o,e.dx,e.dy),i.dispatchAction({seriesId:t.id,type:"treeRoam",dx:e.dx,dy:e.dy})}).on("zoom",function(e){SM(o,e.scale,e.originX,e.originY),i.dispatchAction({seriesId:t.id,type:"treeRoam",zoom:e.scale,originX:e.originX,originY:e.originY}),n._updateNodeAndLinkScale(t),i.updateLabelLayout()})},e.prototype._updateNodeAndLinkScale=function(t){var e=t.getData(),i=this._getNodeGlobalScale(t);e.eachItemGraphicEl(function(t,e){t.setSymbolScale(i)})},e.prototype._getNodeGlobalScale=function(t){var e=t.coordinateSystem;if("view"!==e.type)return 1;var i=this._nodeScaleRatio,n=e.scaleX||1;return((e.getZoom()-1)*i+1)/n},e.prototype.dispose=function(){this._controller&&this._controller.dispose(),this._controllerHost=null},e.prototype.remove=function(){this._mainGroup.removeAll(),this._data=null},e.type="tree",e}(Zf);function dI(t,e){var i=t.getItemLayout(e);return i&&!isNaN(i.x)&&!isNaN(i.y)}function fI(t,e,i,n,r){var o=!i,a=t.tree.getNodeByDataIndex(e),s=a.getModel(),l=a.getVisual("style").fill,u=!1===a.isExpand&&0!==a.children.length?l:"#fff",c=t.tree.root,h=a.parentNode===c?a:a.parentNode||a,p=t.getItemGraphicEl(h.dataIndex),d=h.getLayout(),f=p?{x:p.__oldX,y:p.__oldY,rawX:p.__radialOldRawX,rawY:p.__radialOldRawY}:d,m=a.getLayout();o?((i=new Ew(t,e,null,{symbolInnerColor:u,useNameLabel:!0})).x=f.x,i.y=f.y):i.updateData(t,e,null,{symbolInnerColor:u,useNameLabel:!0}),i.__radialOldRawX=i.__radialRawX,i.__radialOldRawY=i.__radialRawY,i.__radialRawX=m.rawX,i.__radialRawY=m.rawY,n.add(i),t.setItemGraphicEl(e,i),i.__oldX=i.x,i.__oldY=i.y,Bu(i,{x:m.x,y:m.y},r);var g=i.getSymbolPath();if("radial"===r.get("layout")){var y=c.children[0],v=y.getLayout(),_=y.children.length,x=void 0,b=void 0;if(m.x===v.x&&!0===a.isExpand){var w={x:(y.children[0].getLayout().x+y.children[_-1].getLayout().x)/2,y:(y.children[0].getLayout().y+y.children[_-1].getLayout().y)/2};(x=Math.atan2(w.y-v.y,w.x-v.x))<0&&(x=2*Math.PI+x),(b=w.x<v.x)&&(x-=Math.PI)}else(x=Math.atan2(m.y-v.y,m.x-v.x))<0&&(x=2*Math.PI+x),0===a.children.length||0!==a.children.length&&!1===a.isExpand?(b=m.x<v.x)&&(x-=Math.PI):(b=m.x>v.x)||(x-=Math.PI);var S=b?"left":"right",T=s.getModel("label"),M=T.get("rotate"),I=M*(Math.PI/180),A=g.getTextContent();A&&(g.setTextConfig({position:T.get("position")||S,rotation:null==M?-x:I,origin:"center"}),A.setStyle("verticalAlign","middle"))}var k=s.get(["emphasis","focus"]),D="ancestor"===k?a.getAncestorsIndices():"descendant"===k?a.getDescendantIndices():null;D&&(Ss(i).focus=D),function(t,e,i,n,r,o,a,s){var l=e.getModel(),u=t.get("edgeShape"),c=t.get("layout"),h=t.getOrient(),p=t.get(["lineStyle","curveness"]),d=t.get("edgeForkPosition"),f=l.getModel("lineStyle").getLineStyle(),m=n.__edge;if("curve"===u)e.parentNode&&e.parentNode!==i&&(m||(m=n.__edge=new xu({shape:vI(c,h,p,r,r)})),Bu(m,{shape:vI(c,h,p,o,a)},t));else if("polyline"===u&&"orthogonal"===c&&e!==i&&e.children&&0!==e.children.length&&!0===e.isExpand){for(var g=e.children,y=[],v=0;v<g.length;v++){var _=g[v].getLayout();y.push([_.x,_.y])}m||(m=n.__edge=new hI({shape:{parentPoint:[a.x,a.y],childPoints:[[a.x,a.y]],orient:h,forkPosition:d}})),Bu(m,{shape:{parentPoint:[a.x,a.y],childPoints:y}},t)}m&&(m.useStyle(C({strokeNoScale:!0,fill:null},f)),gl(m,l,"lineStyle"),Ys(m),s.add(m))}(r,a,c,i,f,d,m,n),i.__edge&&(i.onHoverStateChange=function(e){if("blur"!==e){var n=a.parentNode&&t.getItemGraphicEl(a.parentNode.dataIndex);n&&1===n.hoverState||qs(i.__edge,e)}})}function mI(t,e,i,n,r){var o=gI(e.tree.root,t),a=o.source,s=o.sourceLayout,l=e.getItemGraphicEl(t.dataIndex);if(l){var u=e.getItemGraphicEl(a.dataIndex).__edge,c=l.__edge||(!1===a.isExpand||1===a.children.length?u:void 0),h=n.get("edgeShape"),p=n.get("layout"),d=n.get("orient"),f=n.get(["lineStyle","curveness"]);c&&("curve"===h?Vu(c,{shape:vI(p,d,f,s,s),style:{opacity:0}},n,{cb:function(){i.remove(c)},removeOpt:r}):"polyline"===h&&"orthogonal"===n.get("layout")&&Vu(c,{shape:{parentPoint:[s.x,s.y],childPoints:[[s.x,s.y]]},style:{opacity:0}},n,{cb:function(){i.remove(c)},removeOpt:r}))}}function gI(t,e){for(var i,n=e.parentNode===t?e:e.parentNode||e;null==(i=n.getLayout());)n=n.parentNode===t?n:n.parentNode||n;return{source:n,sourceLayout:i}}function yI(t,e,i,n,r){var o=t.tree.getNodeByDataIndex(e),a=gI(t.tree.root,o).sourceLayout,s={duration:r.get("animationDurationUpdate"),easing:r.get("animationEasingUpdate")};Vu(i,{x:a.x+1,y:a.y+1},r,{cb:function(){n.remove(i),t.setItemGraphicEl(e,null)},removeOpt:s}),i.fadeOut(null,{fadeLabel:!0,animation:s}),o.children.forEach(function(e){mI(e,t,n,r,s)}),mI(o,t,n,r,s)}function vI(t,e,i,n,r){var o,a,s,l,u,c,h,p;if("radial"===t){u=n.rawX,h=n.rawY,c=r.rawX,p=r.rawY;var d=rI(u,h),f=rI(u,h+(p-h)*i),m=rI(c,p+(h-p)*i),g=rI(c,p);return{x1:d.x||0,y1:d.y||0,x2:g.x||0,y2:g.y||0,cpx1:f.x||0,cpy1:f.y||0,cpx2:m.x||0,cpy2:m.y||0}}return u=n.x,h=n.y,c=r.x,p=r.y,"LR"!==e&&"RL"!==e||(o=u+(c-u)*i,a=h,s=c+(u-c)*i,l=p),"TB"!==e&&"BT"!==e||(o=u,a=h+(p-h)*i,s=c,l=p+(h-p)*i),{x1:u,y1:h,x2:c,y2:p,cpx1:o,cpy1:a,cpx2:s,cpy2:l}}var _I=zr();function xI(t){var e=t.mainData,i=t.datas;i||(i={main:e},t.datasAttr={main:"data"}),t.datas=t.mainData=null,II(e,i,t),L(i,function(i){L(e.TRANSFERABLE_METHODS,function(e){i.wrapMethod(e,V(bI,t))})}),e.wrapMethod("cloneShallow",V(SI,t)),L(e.CHANGABLE_METHODS,function(i){e.wrapMethod(i,V(wI,t))}),ot(i[e.dataType]===e)}function bI(t,e){if(_I(n=this).mainData===n){var i=I({},_I(this).datas);i[this.dataType]=e,II(e,i,t)}else CI(e,this.dataType,_I(this).mainData,t);var n;return e}function wI(t,e){return t.struct&&t.struct.update(),e}function SI(t,e){return L(_I(e).datas,function(i,n){i!==e&&CI(i.cloneShallow(),n,e,t)}),e}function TI(t){var e=_I(this).mainData;return null==t||null==e?e:_I(e).datas[t]}function MI(){var t=_I(this).mainData;return null==t?[{data:t}]:z(N(_I(t).datas),function(e){return{type:e,data:_I(t).datas[e]}})}function II(t,e,i){_I(t).datas={},L(e,function(e,n){CI(e,n,t,i)})}function CI(t,e,i,n){_I(i).datas[e]=t,_I(t).mainData=i,t.dataType=e,n.struct&&(t[n.structAttr]=n.struct,n.struct[n.datasAttr[e]]=t),t.getLinkedData=TI,t.getLinkedDataAll=MI}var AI=function(){function t(t,e){this.depth=0,this.height=0,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.isExpand=!1,this.name=t||"",this.hostTree=e}return t.prototype.isRemoved=function(){return this.dataIndex<0},t.prototype.eachNode=function(t,e,i){"function"==typeof t&&(i=e,e=t,t=null),$(t=t||{})&&(t={order:t});var n,r=t.order||"preorder",o=this[t.attr||"children"];"preorder"===r&&(n=e.call(i,this));for(var a=0;!n&&a<o.length;a++)o[a].eachNode(t,e,i);"postorder"===r&&e.call(i,this)},t.prototype.updateDepthAndHeight=function(t){var e=0;this.depth=t;for(var i=0;i<this.children.length;i++){var n=this.children[i];n.updateDepthAndHeight(t+1),n.height>e&&(e=n.height)}this.height=e+1},t.prototype.getNodeById=function(t){if(this.getId()===t)return this;for(var e=0,i=this.children,n=i.length;e<n;e++){var r=i[e].getNodeById(t);if(r)return r}},t.prototype.contains=function(t){if(t===this)return!0;for(var e=0,i=this.children,n=i.length;e<n;e++){var r=i[e].contains(t);if(r)return r}},t.prototype.getAncestors=function(t){for(var e=[],i=t?this:this.parentNode;i;)e.push(i),i=i.parentNode;return e.reverse(),e},t.prototype.getAncestorsIndices=function(){for(var t=[],e=this;e;)t.push(e.dataIndex),e=e.parentNode;return t.reverse(),t},t.prototype.getDescendantIndices=function(){var t=[];return this.eachNode(function(e){t.push(e.dataIndex)}),t},t.prototype.getValue=function(t){var e=this.hostTree.data;return e.getStore().get(e.getDimensionIndex(t||"value"),this.dataIndex)},t.prototype.setLayout=function(t,e){this.dataIndex>=0&&this.hostTree.data.setItemLayout(this.dataIndex,t,e)},t.prototype.getLayout=function(){return this.hostTree.data.getItemLayout(this.dataIndex)},t.prototype.getModel=function(t){if(!(this.dataIndex<0))return this.hostTree.data.getItemModel(this.dataIndex).getModel(t)},t.prototype.getLevelModel=function(){return(this.hostTree.levelModels||[])[this.depth]},t.prototype.setVisual=function(t,e){this.dataIndex>=0&&this.hostTree.data.setItemVisual(this.dataIndex,t,e)},t.prototype.getVisual=function(t){return this.hostTree.data.getItemVisual(this.dataIndex,t)},t.prototype.getRawIndex=function(){return this.hostTree.data.getRawIndex(this.dataIndex)},t.prototype.getId=function(){return this.hostTree.data.getId(this.dataIndex)},t.prototype.getChildIndex=function(){if(this.parentNode){for(var t=this.parentNode.children,e=0;e<t.length;++e)if(t[e]===this)return e;return-1}return-1},t.prototype.isAncestorOf=function(t){for(var e=t.parentNode;e;){if(e===this)return!0;e=e.parentNode}return!1},t.prototype.isDescendantOf=function(t){return t!==this&&t.isAncestorOf(this)},t}(),kI=function(){function t(t){this.type="tree",this._nodes=[],this.hostModel=t}return t.prototype.eachNode=function(t,e,i){this.root.eachNode(t,e,i)},t.prototype.getNodeByDataIndex=function(t){var e=this.data.getRawIndex(t);return this._nodes[e]},t.prototype.getNodeById=function(t){return this.root.getNodeById(t)},t.prototype.update=function(){for(var t=this.data,e=this._nodes,i=0,n=e.length;i<n;i++)e[i].dataIndex=-1;for(i=0,n=t.count();i<n;i++)e[t.getRawIndex(i)].dataIndex=i},t.prototype.clearLayouts=function(){this.data.clearItemLayouts()},t.createTree=function(e,i,n){var r=new t(i),o=[],a=1;!function t(e,i){var n=e.value;a=Math.max(a,U(n)?n.length:1),o.push(e);var s=new AI(Dr(e.name,""),r);i?function(t,e){var i=e.children;t.parentNode!==e&&(i.push(t),t.parentNode=e)}(s,i):r.root=s,r._nodes.push(s);var l=e.children;if(l)for(var u=0;u<l.length;u++)t(l[u],s)}(e),r.root.updateDepthAndHeight(0);var s=c_(o,{coordDimensions:["value"],dimensionsCount:a}).dimensions,l=new u_(s,i);return l.initData(o),n&&n(l),xI({mainData:l,struct:r,structAttr:"tree"}),r.update(),r},t}();function DI(t,e,i){if(t&&k(e,t.type)>=0){var n=i.getData().tree.root,r=t.targetNode;if("string"==typeof r&&(r=n.getNodeById(r)),r&&n.contains(r))return{node:r};var o=t.targetNodeId;if(null!=o&&(r=n.getNodeById(o)))return{node:r}}}function EI(t){for(var e=[];t;)(t=t.parentNode)&&e.push(t);return e.reverse()}function PI(t,e){return k(EI(t),e)>=0}function LI(t,e){for(var i=[];t;){var n=t.dataIndex;i.push({name:t.name,dataIndex:n,value:e.getRawValue(n)}),t=t.parentNode}return i.reverse(),i}var zI=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasSymbolVisual=!0,e.ignoreStyleOnData=!0,e}return i(e,t),e.prototype.getInitialData=function(t){var e={name:t.name,children:t.data},i=t.leaves||{},n=new $c(i,this,this.ecModel),r=kI.createTree(e,this,function(t){t.wrapMethod("getItemModel",function(t,e){var i=r.getNodeByDataIndex(e);return i&&i.children.length&&i.isExpand||(t.parentModel=n),t})}),o=0;r.eachNode("preorder",function(t){t.depth>o&&(o=t.depth)});var a=t.expandAndCollapse&&t.initialTreeDepth>=0?t.initialTreeDepth:o;return r.root.eachNode("preorder",function(t){var e=t.hostTree.data.getRawDataItem(t.dataIndex);t.isExpand=e&&null!=e.collapsed?!e.collapsed:t.depth<=a}),r.data},e.prototype.getOrient=function(){var t=this.get("orient");return"horizontal"===t?t="LR":"vertical"===t&&(t="TB"),t},e.prototype.setZoom=function(t){this.option.zoom=t},e.prototype.setCenter=function(t){this.option.center=t},e.prototype.formatTooltip=function(t,e,i){for(var n=this.getData().tree,r=n.root.children[0],o=n.getNodeByDataIndex(t),a=o.getValue(),s=o.name;o&&o!==r;)s=o.parentNode.name+"."+s,o=o.parentNode;return wf("nameValue",{name:s,value:a,noValue:isNaN(a)||null==a})},e.prototype.getDataParams=function(e){var i=t.prototype.getDataParams.apply(this,arguments),n=this.getData().tree.getNodeByDataIndex(e);return i.treeAncestors=LI(n,this),i},e.type="series.tree",e.layoutMode="box",e.defaultOption={zlevel:0,z:2,coordinateSystem:"view",left:"12%",top:"12%",right:"12%",bottom:"12%",layout:"orthogonal",edgeShape:"curve",edgeForkPosition:"50%",roam:!1,nodeScaleRatio:.4,center:null,zoom:1,orient:"LR",symbol:"emptyCircle",symbolSize:7,expandAndCollapse:!0,initialTreeDepth:2,lineStyle:{color:"#ccc",width:1.5,curveness:.5},itemStyle:{color:"lightsteelblue",borderWidth:1.5},label:{show:!0},animationEasing:"linear",animationDuration:700,animationDurationUpdate:500},e}(Of);function OI(t,e){for(var i,n=[t];i=n.pop();)if(e(i),i.isExpand){var r=i.children;if(r.length)for(var o=r.length-1;o>=0;o--)n.push(r[o])}}function RI(t,e){t.eachSeriesByType("tree",function(t){!function(t,e){var i=function(t,e){return Xh(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}(t,e);t.layoutInfo=i;var n=t.get("layout"),r=0,o=0,a=null;"radial"===n?(r=2*Math.PI,o=Math.min(i.height,i.width)/2,a=nI(function(t,e){return(t.parentNode===e.parentNode?1:2)/t.depth})):(r=i.width,o=i.height,a=nI());var s=t.getData().tree.root,l=s.children[0];if(l){!function(t){var e=t;e.hierNode={defaultAncestor:null,ancestor:e,prelim:0,modifier:0,change:0,shift:0,i:0,thread:null};for(var i,n,r=[e];i=r.pop();)if(n=i.children,i.isExpand&&n.length)for(var o=n.length-1;o>=0;o--){var a=n[o];a.hierNode={defaultAncestor:null,ancestor:a,prelim:0,modifier:0,change:0,shift:0,i:o,thread:null},r.push(a)}}(s),function(t,e,i){for(var n,r=[t],o=[];n=r.pop();)if(o.push(n),n.isExpand){var a=n.children;if(a.length)for(var s=0;s<a.length;s++)r.push(a[s])}for(;n=o.pop();)e(n,i)}(l,eI,a),s.hierNode.modifier=-l.hierNode.prelim,OI(l,iI);var u=l,c=l,h=l;OI(l,function(t){var e=t.getLayout().x;e<u.getLayout().x&&(u=t),e>c.getLayout().x&&(c=t),t.depth>h.depth&&(h=t)});var p=u===c?1:a(u,c)/2,d=p-u.getLayout().x,f=0,m=0,g=0,y=0;if("radial"===n)f=r/(c.getLayout().x+p+d),m=o/(h.depth-1||1),OI(l,function(t){g=(t.getLayout().x+d)*f,y=(t.depth-1)*m;var e=rI(g,y);t.setLayout({x:e.x,y:e.y,rawX:g,rawY:y},!0)});else{var v=t.getOrient();"RL"===v||"LR"===v?(m=o/(c.getLayout().x+p+d),f=r/(h.depth-1||1),OI(l,function(t){y=(t.getLayout().x+d)*m,g="LR"===v?(t.depth-1)*f:r-(t.depth-1)*f,t.setLayout({x:g,y:y},!0)})):"TB"!==v&&"BT"!==v||(f=r/(c.getLayout().x+p+d),m=o/(h.depth-1||1),OI(l,function(t){g=(t.getLayout().x+d)*f,y="TB"===v?(t.depth-1)*m:o-(t.depth-1)*m,t.setLayout({x:g,y:y},!0)}))}}}(t,e)})}function BI(t){t.eachSeriesByType("tree",function(t){var e=t.getData();e.tree.eachNode(function(t){var i=t.getModel().getModel("itemStyle").getItemStyle();I(e.ensureUniqueItemVisual(t.dataIndex,"style"),i)})})}var NI=function(){},FI=["treemapZoomToNode","treemapRender","treemapMove"];function VI(t){var e=t.getData().tree,i={};e.eachNode(function(e){for(var n=e;n&&n.depth>1;)n=n.parentNode;var r=Ep(t.ecModel,n.name||n.dataIndex+"",i);e.setVisual("decal",r)})}var UI=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.preventUsingHoverLayer=!0,i}return i(e,t),e.prototype.getInitialData=function(t,e){var i={name:t.name,children:t.data};GI(i);var n=t.levels||[],r=this.designatedVisualItemStyle={},o=new $c({itemStyle:r},this,e),a=z((n=t.levels=function(t,e){var i,n,r=wr(e.get("color")),o=wr(e.get(["aria","decal","decals"]));if(r){L(t=t||[],function(t){var e=new $c(t),r=e.get("color"),o=e.get("decal");(e.get(["itemStyle","color"])||r&&"none"!==r)&&(i=!0),(e.get(["itemStyle","decal"])||o&&"none"!==o)&&(n=!0)});var a=t[0]||(t[0]={});return i||(a.color=r.slice()),!n&&o&&(a.decal=o.slice()),t}}(n,e))||[],function(t){return new $c(t,o,e)},this),s=kI.createTree(i,this,function(t){t.wrapMethod("getItemModel",function(t,e){var i=s.getNodeByDataIndex(e),n=i?a[i.depth]:null;return t.parentModel=n||o,t})});return s.data},e.prototype.optionUpdated=function(){this.resetViewRoot()},e.prototype.formatTooltip=function(t,e,i){var n=this.getData(),r=this.getRawValue(t);return wf("nameValue",{name:n.getName(t),value:r})},e.prototype.getDataParams=function(e){var i=t.prototype.getDataParams.apply(this,arguments),n=this.getData().tree.getNodeByDataIndex(e);return i.treeAncestors=LI(n,this),i.treePathInfo=i.treeAncestors,i},e.prototype.setLayoutInfo=function(t){this.layoutInfo=this.layoutInfo||{},I(this.layoutInfo,t)},e.prototype.mapIdToIndex=function(t){var e=this._idIndexMap;e||(e=this._idIndexMap=ht(),this._idIndexMapCount=0);var i=e.get(t);return null==i&&e.set(t,i=this._idIndexMapCount++),i},e.prototype.getViewRoot=function(){return this._viewRoot},e.prototype.resetViewRoot=function(t){t?this._viewRoot=t:t=this._viewRoot;var e=this.getRawData().tree.root;t&&(t===e||e.contains(t))||(this._viewRoot=e)},e.prototype.enableAriaDecal=function(){VI(this)},e.type="series.treemap",e.layoutMode="box",e.defaultOption={progressive:0,left:"center",top:"middle",width:"80%",height:"80%",sort:!0,clipWindow:"origin",squareRatio:1.618033988749895,leafDepth:null,drillDownIcon:"▶",zoomToNodeRatio:.1024,roam:!0,nodeClick:"zoomToNode",animation:!0,animationDurationUpdate:900,animationEasing:"quinticInOut",breadcrumb:{show:!0,height:22,left:"center",top:"bottom",emptyItemWidth:25,itemStyle:{color:"rgba(0,0,0,0.7)",textStyle:{color:"#fff"}}},label:{show:!0,distance:0,padding:5,position:"inside",color:"#fff",overflow:"truncate"},upperLabel:{show:!1,position:[0,"50%"],height:20,overflow:"truncate",verticalAlign:"middle"},itemStyle:{color:null,colorAlpha:null,colorSaturation:null,borderWidth:0,gapWidth:0,borderColor:"#fff",borderColorSaturation:null},emphasis:{upperLabel:{show:!0,position:[0,"50%"],ellipsis:!0,verticalAlign:"middle"}},visualDimension:0,visualMin:null,visualMax:null,color:[],colorAlpha:null,colorSaturation:null,colorMappingBy:"index",visibleMin:10,childrenVisibleMin:null,levels:[]},e}(Of);function GI(t){var e=0;L(t.children,function(t){GI(t);var i=t.value;U(i)&&(i=i[0]),e+=i});var i=t.value;U(i)&&(i=i[0]),(null==i||isNaN(i))&&(i=e),i<0&&(i=0),U(t.value)?t.value[0]=i:t.value=i}var $I=function(){function t(t){this.group=new Fn,t.add(this.group)}return t.prototype.render=function(t,e,i,n){var r=t.getModel("breadcrumb"),o=this.group;if(o.removeAll(),r.get("show")&&i){var a=r.getModel("itemStyle"),s=a.getModel("textStyle"),l={pos:{left:r.get("left"),right:r.get("right"),top:r.get("top"),bottom:r.get("bottom")},box:{width:e.getWidth(),height:e.getHeight()},emptyItemWidth:r.get("emptyItemWidth"),totalWidth:0,renderList:[]};this._prepare(i,l,s),this._renderContent(t,l,a,s,n),Yh(o,l.pos,l.box)}},t.prototype._prepare=function(t,e,i){for(var n=t;n;n=n.parentNode){var r=Dr(n.getModel().get("name"),""),o=i.getTextRect(r),a=Math.max(o.width+16,e.emptyItemWidth);e.totalWidth+=a+8,e.renderList.push({node:n,text:r,width:a})}},t.prototype._renderContent=function(t,e,i,n,r){for(var o,a,s,l,u,c,h,p,d,f=0,m=e.emptyItemWidth,g=t.get(["breadcrumb","height"]),y=(o=e.pos,l=(a=e.box).width,u=a.height,c=Xn(o.left,l),h=Xn(o.top,u),p=Xn(o.right,l),d=Xn(o.bottom,u),(isNaN(c)||isNaN(parseFloat(o.left)))&&(c=0),(isNaN(p)||isNaN(parseFloat(o.right)))&&(p=l),(isNaN(h)||isNaN(parseFloat(o.top)))&&(h=0),(isNaN(d)||isNaN(parseFloat(o.bottom)))&&(d=u),s=Lh(s||0),{width:Math.max(p-c-s[1]-s[3],0),height:Math.max(d-h-s[0]-s[2],0)}),v=e.totalWidth,_=e.renderList,x=_.length-1;x>=0;x--){var b=_[x],w=b.node,S=b.width,T=b.text;v>y.width&&(v-=S-m,S=m,T=null);var M=new hu({shape:{points:WI(f,0,S,g,x===_.length-1,0===x)},style:C(i.getItemStyle(),{lineJoin:"bevel"}),textContent:new fs({style:{text:T,fill:n.getTextColor(),font:n.getFont()}}),textConfig:{position:"inside"},z2:1e5,onclick:V(r,w)});M.disableLabelAnimation=!0,this.group.add(M),HI(M,t,w),f+=S+8}},t.prototype.remove=function(){this.group.removeAll()},t}();function WI(t,e,i,n,r,o){var a=[[r?t:t-5,e],[t+i,e],[t+i,e+n],[r?t:t-5,e+n]];return!o&&a.splice(2,0,[t+i+5,e+n/2]),!r&&a.push([t,e+n/2]),a}function HI(t,e,i){Ss(t).eventData={componentType:"series",componentSubType:"treemap",componentIndex:e.componentIndex,seriesIndex:e.seriesIndex,seriesName:e.name,seriesType:"treemap",selfType:"breadcrumb",nodeData:{dataIndex:i&&i.dataIndex,name:i&&i.name},treePathInfo:i&&LI(i,e)}}var jI=function(){function t(){this._storage=[],this._elExistsMap={}}return t.prototype.add=function(t,e,i,n,r){return!this._elExistsMap[t.id]&&(this._elExistsMap[t.id]=!0,this._storage.push({el:t,target:e,duration:i,delay:n,easing:r}),!0)},t.prototype.finished=function(t){return this._finishedCallback=t,this},t.prototype.start=function(){for(var t=this,e=this._storage.length,i=function(){--e<=0&&(t._storage.length=0,t._elExistsMap={},t._finishedCallback&&t._finishedCallback())},n=0,r=this._storage.length;n<r;n++){var o=this._storage[n];o.el.animateTo(o.target,{duration:o.duration,delay:o.delay,easing:o.easing,setToFinal:!0,done:i,aborted:i})}return this},t}(),ZI=Fn,qI=hs,XI="label",YI="upperLabel",KI=to([["fill","color"],["stroke","strokeColor"],["lineWidth","strokeWidth"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),JI=function(t){var e=KI(t);return e.stroke=e.fill=e.lineWidth=null,e},QI=zr(),tC=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._state="ready",i._storage={nodeGroup:[],background:[],content:[]},i}return i(e,t),e.prototype.render=function(t,e,i,n){if(!(k(e.findComponents({mainType:"series",subType:"treemap",query:n}),t)<0)){this.seriesModel=t,this.api=i,this.ecModel=e;var r=DI(n,["treemapZoomToNode","treemapRootToNode"],t),o=n&&n.type,a=t.layoutInfo,s=!this._oldTree,l=this._storage,u="treemapRootToNode"===o&&r&&l?{rootNodeGroup:l.nodeGroup[r.node.getRawIndex()],direction:n.direction}:null,c=this._giveContainerGroup(a),h=t.get("animation"),p=this._doRender(c,t,u);!h||s||o&&"treemapZoomToNode"!==o&&"treemapRootToNode"!==o?p.renderFinally():this._doAnimation(c,p,t,u),this._resetController(i),this._renderBreadcrumb(t,i,r)}},e.prototype._giveContainerGroup=function(t){var e=this._containerGroup;return e||(e=this._containerGroup=new ZI,this._initEvents(e),this.group.add(e)),e.x=t.x,e.y=t.y,e},e.prototype._doRender=function(t,e,i){var n=e.getData().tree,r=this._oldTree,o={nodeGroup:[],background:[],content:[]},a={nodeGroup:[],background:[],content:[]},s=this._storage,l=[];function u(t,n,r,u){return function(t,e,i,n,r,o,a,s,l,u){if(a){var c=a.getLayout(),h=t.getData(),p=a.getModel();if(h.setItemGraphicEl(a.dataIndex,null),c&&c.isInView){var d=c.width,f=c.height,m=c.borderWidth,g=c.invisible,y=a.getRawIndex(),v=s&&s.getRawIndex(),_=a.viewChildren,x=c.upperHeight,b=_&&_.length,w=p.getModel("itemStyle"),S=p.getModel(["emphasis","itemStyle"]),T=p.getModel(["blur","itemStyle"]),M=p.getModel(["select","itemStyle"]),C=w.get("borderRadius")||0,A=F("nodeGroup",ZI);if(A){if(l.add(A),A.x=c.x||0,A.y=c.y||0,A.markRedraw(),QI(A).nodeWidth=d,QI(A).nodeHeight=f,c.isAboveViewRoot)return A;var k=F("background",qI,u,20);k&&z(A,k,b&&c.upperLabelHeight);var D=p.get(["emphasis","focus"]),E=p.get(["emphasis","blurScope"]),P="ancestor"===D?a.getAncestorsIndices():"descendant"===D?a.getDescendantIndices():D;if(b)vl(A)&&yl(A,!1),k&&(yl(k,!0),h.setItemGraphicEl(a.dataIndex,k),dl(k,P,E));else{var L=F("content",qI,u,30);L&&O(A,L),k.disableMorphing=!0,k&&vl(k)&&yl(k,!1),yl(A,!0),h.setItemGraphicEl(a.dataIndex,A),dl(A,P,E)}return A}}}function z(e,i,n){var r=Ss(i);if(r.dataIndex=a.dataIndex,r.seriesIndex=t.seriesIndex,i.setShape({x:0,y:0,width:d,height:f,r:C}),g)R(i);else{i.invisible=!1;var o=a.getVisual("style"),s=o.stroke,l=JI(w);l.fill=s;var u=KI(S);u.fill=S.get("borderColor");var c=KI(T);c.fill=T.get("borderColor");var h=KI(M);if(h.fill=M.get("borderColor"),n){var p=d-2*m;B(i,s,o.opacity,{x:m,y:0,width:p,height:x})}else i.removeTextContent();i.setStyle(l),i.ensureState("emphasis").style=u,i.ensureState("blur").style=c,i.ensureState("select").style=h,Ys(i)}e.add(i)}function O(e,i){var n=Ss(i);n.dataIndex=a.dataIndex,n.seriesIndex=t.seriesIndex;var r=Math.max(d-2*m,0),o=Math.max(f-2*m,0);if(i.culling=!0,i.setShape({x:m,y:m,width:r,height:o,r:C}),g)R(i);else{i.invisible=!1;var s=a.getVisual("style"),l=s.fill,u=JI(w);u.fill=l,u.decal=s.decal;var c=KI(S),h=KI(T),p=KI(M);B(i,l,s.opacity,null),i.setStyle(u),i.ensureState("emphasis").style=c,i.ensureState("blur").style=h,i.ensureState("select").style=p,Ys(i)}e.add(i)}function R(t){!t.invisible&&o.push(t)}function B(e,i,n,r){var o=p.getModel(r?YI:XI),s=Dr(p.get("name"),null),l=o.getShallow("show");xc(e,bc(p,r?YI:XI),{defaultText:l?s:null,inheritColor:i,defaultOpacity:n,labelFetcher:t,labelDataIndex:a.dataIndex});var u=e.getTextContent();if(u){var h=u.style,d=rt(h.padding||0);r&&(e.setTextConfig({layoutRect:r}),u.disableLabelLayout=!0),u.beforeUpdate=function(){var t=Math.max((r?r.width:e.shape.width)-d[1]-d[3],0),i=Math.max((r?r.height:e.shape.height)-d[0]-d[2],0);h.width===t&&h.height===i||u.setStyle({width:t,height:i})},h.truncateMinChar=2,h.lineOverflow="truncate",N(h,r,c);var f=u.getState("emphasis");N(f?f.style:null,r,c)}}function N(e,i,n){var r=e?e.text:null;if(!i&&n.isLeafRoot&&null!=r){var o=t.get("drillDownIcon",!0);e.text=o?o+" "+r:r}}function F(t,n,o,a){var s=null!=v&&i[t][v],l=r[t];return s?(i[t][v]=null,V(l,s)):g||((s=new n)instanceof Io&&(s.z2=function(t,e){return 100*t+e}(o,a)),U(l,s)),e[t][y]=s}function V(t,e){var i=t[y]={};e instanceof ZI?(i.oldX=e.x,i.oldY=e.y):i.oldShape=I({},e.shape)}function U(t,e){var i=t[y]={},o=a.parentNode,s=e instanceof Fn;if(o&&(!n||"drillDown"===n.direction)){var l=0,u=0,c=r.background[o.getRawIndex()];!n&&c&&c.oldShape&&(l=c.oldShape.width,u=c.oldShape.height),s?(i.oldX=0,i.oldY=u):i.oldShape={x:l,y:u,width:0,height:0}}i.fadein=!s}}(e,a,s,i,o,l,t,n,r,u)}!function t(e,i,n,r,o){function a(t){return t.getId()}function s(a,s){var l=null!=a?e[a]:null,c=null!=s?i[s]:null,h=u(l,c,n,o);h&&t(l&&l.viewChildren||[],c&&c.viewChildren||[],h,r,o+1)}r?(i=e,L(e,function(t,e){!t.isRemoved()&&s(e,e)})):new Fv(i,e,a,a).add(s).update(s).remove(V(s,null)).execute()}(n.root?[n.root]:[],r&&r.root?[r.root]:[],t,n===r||!r,0);var c=function(t){var e={nodeGroup:[],background:[],content:[]};return t&&L(t,function(t,i){var n=e[i];L(t,function(t){t&&(n.push(t),QI(t).willDelete=!0)})}),e}(s);return this._oldTree=n,this._storage=a,{lastsForAnimation:o,willDeleteEls:c,renderFinally:function(){L(c,function(t){L(t,function(t){t.parent&&t.parent.remove(t)})}),L(l,function(t){t.invisible=!0,t.dirty()})}}},e.prototype._doAnimation=function(t,e,i,n){var r=i.get("animationDurationUpdate"),o=i.get("animationEasing"),a=(G(r)?0:r)||0,s=(G(o)?null:o)||"cubicOut",l=new jI;L(e.willDeleteEls,function(t,e){L(t,function(t,i){if(!t.invisible){var r,o=t.parent,u=QI(o);if(n&&"drillDown"===n.direction)r=o===n.rootNodeGroup?{shape:{x:0,y:0,width:u.nodeWidth,height:u.nodeHeight},style:{opacity:0}}:{style:{opacity:0}};else{var c=0,h=0;u.willDelete||(c=u.nodeWidth/2,h=u.nodeHeight/2),r="nodeGroup"===e?{x:c,y:h,style:{opacity:0}}:{shape:{x:c,y:h,width:0,height:0},style:{opacity:0}}}r&&l.add(t,r,a,0,s)}})}),L(this._storage,function(t,i){L(t,function(t,n){var r=e.lastsForAnimation[i][n],o={};r&&(t instanceof Fn?null!=r.oldX&&(o.x=t.x,o.y=t.y,t.x=r.oldX,t.y=r.oldY):(r.oldShape&&(o.shape=I({},t.shape),t.setShape(r.oldShape)),r.fadein?(t.setStyle("opacity",0),o.style={opacity:1}):1!==t.style.opacity&&(o.style={opacity:1})),l.add(t,o,a,0,s))})},this),this._state="animating",l.finished(F(function(){this._state="ready",e.renderFinally()},this)).start()},e.prototype._resetController=function(t){var e=this._controller;e||((e=this._controller=new vM(t.getZr())).enable(this.seriesModel.get("roam")),e.on("pan",F(this._onPan,this)),e.on("zoom",F(this._onZoom,this)));var i=new yn(0,0,t.getWidth(),t.getHeight());e.setPointerChecker(function(t,e,n){return i.contain(e,n)})},e.prototype._clearController=function(){var t=this._controller;t&&(t.dispose(),t=null)},e.prototype._onPan=function(t){if("animating"!==this._state&&(Math.abs(t.dx)>3||Math.abs(t.dy)>3)){var e=this.seriesModel.getData().tree.root;if(!e)return;var i=e.getLayout();if(!i)return;this.api.dispatchAction({type:"treemapMove",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:i.x+t.dx,y:i.y+t.dy,width:i.width,height:i.height}})}},e.prototype._onZoom=function(t){var e=t.originX,i=t.originY;if("animating"!==this._state){var n=this.seriesModel.getData().tree.root;if(!n)return;var r=n.getLayout();if(!r)return;var o=new yn(r.x,r.y,r.width,r.height),a=this.seriesModel.layoutInfo,s=[1,0,0,1,0,0];Wi(s,s,[-(e-=a.x),-(i-=a.y)]),ji(s,s,[t.scale,t.scale]),Wi(s,s,[e,i]),o.applyTransform(s),this.api.dispatchAction({type:"treemapRender",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:o.x,y:o.y,width:o.width,height:o.height}})}},e.prototype._initEvents=function(t){var e=this;t.on("click",function(t){if("ready"===e._state){var i=e.seriesModel.get("nodeClick",!0);if(i){var n=e.findTarget(t.offsetX,t.offsetY);if(n){var r=n.node;if(r.getLayout().isLeafRoot)e._rootToNode(n);else if("zoomToNode"===i)e._zoomToNode(n);else if("link"===i){var o=r.hostTree.data.getItemModel(r.dataIndex),a=o.get("link",!0),s=o.get("target",!0)||"blank";a&&$h(a,s)}}}}},this)},e.prototype._renderBreadcrumb=function(t,e,i){var n=this;i||(i=null!=t.get("leafDepth",!0)?{node:t.getViewRoot()}:this.findTarget(e.getWidth()/2,e.getHeight()/2))||(i={node:t.getData().tree.root}),(this._breadcrumb||(this._breadcrumb=new $I(this.group))).render(t,e,i.node,function(e){"animating"!==n._state&&(PI(t.getViewRoot(),e)?n._rootToNode({node:e}):n._zoomToNode({node:e}))})},e.prototype.remove=function(){this._clearController(),this._containerGroup&&this._containerGroup.removeAll(),this._storage={nodeGroup:[],background:[],content:[]},this._state="ready",this._breadcrumb&&this._breadcrumb.remove()},e.prototype.dispose=function(){this._clearController()},e.prototype._zoomToNode=function(t){this.api.dispatchAction({type:"treemapZoomToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:t.node})},e.prototype._rootToNode=function(t){this.api.dispatchAction({type:"treemapRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:t.node})},e.prototype.findTarget=function(t,e){var i;return this.seriesModel.getViewRoot().eachNode({attr:"viewChildren",order:"preorder"},function(n){var r=this._storage.background[n.getRawIndex()];if(r){var o=r.transformCoordToLocal(t,e),a=r.shape;if(!(a.x<=o[0]&&o[0]<=a.x+a.width&&a.y<=o[1]&&o[1]<=a.y+a.height))return!1;i={node:n,offsetX:o[0],offsetY:o[1]}}},this),i},e.type="treemap",e}(Zf),eC=L,iC=j,nC=-1,rC=function(){function t(e){var i=e.mappingMethod,n=e.type,r=this.option=S(e);this.type=n,this.mappingMethod=i,this._normalizeData=fC[i];var o=t.visualHandlers[n];this.applyVisual=o.applyVisual,this.getColorMapper=o.getColorMapper,this._normalizedToVisual=o._normalizedToVisual[i],"piecewise"===i?(oC(r),function(t){var e=t.pieceList;t.hasSpecialVisual=!1,L(e,function(e,i){e.originIndex=i,null!=e.visual&&(t.hasSpecialVisual=!0)})}(r)):"category"===i?r.categories?function(t){var e=t.categories,i=t.categoryMap={},n=t.visual;if(eC(e,function(t,e){i[t]=e}),!U(n)){var r=[];j(n)?eC(n,function(t,e){var n=i[e];r[null!=n?n:nC]=t}):r[-1]=n,n=dC(t,r)}for(var o=e.length-1;o>=0;o--)null==n[o]&&(delete i[e[o]],e.pop())}(r):oC(r,!0):(ot("linear"!==i||r.dataExtent),oC(r))}return t.prototype.mapValueToVisual=function(t){var e=this._normalizeData(t);return this._normalizedToVisual(e,t)},t.prototype.getNormalizer=function(){return F(this._normalizeData,this)},t.listVisualTypes=function(){return N(t.visualHandlers)},t.isValidType=function(e){return t.visualHandlers.hasOwnProperty(e)},t.eachVisual=function(t,e,i){j(t)?L(t,e,i):e.call(i,t)},t.mapVisual=function(e,i,n){var r,o=U(e)?[]:j(e)?{}:(r=!0,null);return t.eachVisual(e,function(t,e){var a=i.call(n,t,e);r?o=a:o[e]=a}),o},t.retrieveVisuals=function(e){var i,n={};return e&&eC(t.visualHandlers,function(t,r){e.hasOwnProperty(r)&&(n[r]=e[r],i=!0)}),i?n:null},t.prepareVisualTypes=function(t){if(U(t))t=t.slice();else{if(!iC(t))return[];var e=[];eC(t,function(t,i){e.push(i)}),t=e}return t.sort(function(t,e){return"color"===e&&"color"!==t&&0===t.indexOf("color")?1:-1}),t},t.dependsOn=function(t,e){return"color"===e?!(!t||0!==t.indexOf(e)):t===e},t.findPieceIndex=function(t,e,i){for(var n,r=1/0,o=0,a=e.length;o<a;o++){var s=e[o].value;if(null!=s){if(s===t||"string"==typeof s&&s===t+"")return o;i&&h(s,o)}}for(o=0,a=e.length;o<a;o++){var l=e[o],u=l.interval,c=l.close;if(u){if(u[0]===-1/0){if(mC(c[1],t,u[1]))return o}else if(u[1]===1/0){if(mC(c[0],u[0],t))return o}else if(mC(c[0],u[0],t)&&mC(c[1],t,u[1]))return o;i&&h(u[0],o),i&&h(u[1],o)}}if(i)return t===1/0?e.length-1:t===-1/0?0:n;function h(e,i){var o=Math.abs(e-t);o<r&&(r=o,n=i)}},t.visualHandlers={color:{applyVisual:lC("color"),getColorMapper:function(){var t=this.option;return F("category"===t.mappingMethod?function(t,e){return!e&&(t=this._normalizeData(t)),uC.call(this,t)}:function(e,i,n){var r=!!n;return!i&&(e=this._normalizeData(e)),n=Xe(e,t.parsedVisual,n),r?n:Qe(n,"rgba")},this)},_normalizedToVisual:{linear:function(t){return Qe(Xe(t,this.option.parsedVisual),"rgba")},category:uC,piecewise:function(t,e){var i=pC.call(this,e);return null==i&&(i=Qe(Xe(t,this.option.parsedVisual),"rgba")),i},fixed:cC}},colorHue:aC(function(t,e){return Ke(t,e)}),colorSaturation:aC(function(t,e){return Ke(t,null,e)}),colorLightness:aC(function(t,e){return Ke(t,null,null,e)}),colorAlpha:aC(function(t,e){return Je(t,e)}),decal:{applyVisual:lC("decal"),_normalizedToVisual:{linear:null,category:uC,piecewise:null,fixed:null}},opacity:{applyVisual:lC("opacity"),_normalizedToVisual:hC([0,1])},liftZ:{applyVisual:lC("liftZ"),_normalizedToVisual:{linear:cC,category:cC,piecewise:cC,fixed:cC}},symbol:{applyVisual:function(t,e,i){i("symbol",this.mapValueToVisual(t))},_normalizedToVisual:{linear:sC,category:uC,piecewise:function(t,e){var i=pC.call(this,e);return null==i&&(i=sC.call(this,t)),i},fixed:cC}},symbolSize:{applyVisual:lC("symbolSize"),_normalizedToVisual:hC([0,1])}},t}();function oC(t,e){var i=t.visual,n=[];j(i)?eC(i,function(t){n.push(t)}):null!=i&&n.push(i),e||1!==n.length||{color:1,symbol:1}.hasOwnProperty(t.type)||(n[1]=n[0]),dC(t,n)}function aC(t){return{applyVisual:function(e,i,n){var r=this.mapValueToVisual(e);n("color",t(i("color"),r))},_normalizedToVisual:hC([0,1])}}function sC(t){var e=this.option.visual;return e[Math.round(qn(t,[0,1],[0,e.length-1],!0))]||{}}function lC(t){return function(e,i,n){n(t,this.mapValueToVisual(e))}}function uC(t){var e=this.option.visual;return e[this.option.loop&&t!==nC?t%e.length:t]}function cC(){return this.option.visual[0]}function hC(t){return{linear:function(e){return qn(e,t,this.option.visual,!0)},category:uC,piecewise:function(e,i){var n=pC.call(this,i);return null==n&&(n=qn(e,t,this.option.visual,!0)),n},fixed:cC}}function pC(t){var e=this.option,i=e.pieceList;if(e.hasSpecialVisual){var n=i[rC.findPieceIndex(t,i)];if(n&&n.visual)return n.visual[this.type]}}function dC(t,e){return t.visual=e,"color"===t.type&&(t.parsedVisual=z(e,function(t){return He(t)})),e}var fC={linear:function(t){return qn(t,this.option.dataExtent,[0,1],!0)},piecewise:function(t){var e=this.option.pieceList,i=rC.findPieceIndex(t,e,!0);if(null!=i)return qn(i,[0,e.length-1],[0,1],!0)},category:function(t){var e=this.option.categories?this.option.categoryMap[t]:t;return null==e?nC:e},fixed:mt};function mC(t,e,i){return t?e<=i:e<i}var gC=zr(),yC={seriesType:"treemap",reset:function(t){var e=t.getData().tree.root;e.isRemoved()||vC(e,{},t.getViewRoot().getAncestors(),t)}};function vC(t,e,i,n){var r=t.getModel(),o=t.getLayout(),a=t.hostTree.data;if(o&&!o.invisible&&o.isInView){var s,l=r.getModel("itemStyle"),u=function(t,e,i){var n=I({},e),r=i.designatedVisualItemStyle;return L(["color","colorAlpha","colorSaturation"],function(i){r[i]=e[i];var o=t.get(i);r[i]=null,null!=o&&(n[i]=o)}),n}(l,e,n),c=a.ensureUniqueItemVisual(t.dataIndex,"style"),h=l.get("borderColor"),p=l.get("borderColorSaturation");null!=p&&(h=function(t,e){return null!=e?Ke(e,null,null,t):null}(p,s=_C(u))),c.stroke=h;var d=t.viewChildren;if(d&&d.length){var f=function(t,e,i,n,r,o){if(o&&o.length){var a=bC(e,"color")||null!=r.color&&"none"!==r.color&&(bC(e,"colorAlpha")||bC(e,"colorSaturation"));if(a){var s=e.get("visualMin"),l=e.get("visualMax"),u=i.dataExtent.slice();null!=s&&s<u[0]&&(u[0]=s),null!=l&&l>u[1]&&(u[1]=l);var c=e.get("colorMappingBy"),h={type:a.name,dataExtent:u,visual:a.range};"color"!==h.type||"index"!==c&&"id"!==c?h.mappingMethod="linear":(h.mappingMethod="category",h.loop=!0);var p=new rC(h);return gC(p).drColorMappingBy=c,p}}}(0,r,o,0,u,d);L(d,function(t,e){if(t.depth>=i.length||t===i[t.depth]){var o=function(t,e,i,n,r,o){var a=I({},e);if(r){var s=r.type,l="color"===s&&gC(r).drColorMappingBy,u="index"===l?n:"id"===l?o.mapIdToIndex(i.getId()):i.getValue(t.get("visualDimension"));a[s]=r.mapValueToVisual(u)}return a}(r,u,t,e,f,n);vC(t,o,i,n)}})}else s=_C(u),c.fill=s}}function _C(t){var e=xC(t,"color");if(e){var i=xC(t,"colorAlpha"),n=xC(t,"colorSaturation");return n&&(e=Ke(e,null,null,n)),i&&(e=Je(e,i)),e}}function xC(t,e){var i=t[e];if(null!=i&&"none"!==i)return i}function bC(t,e){var i=t.get(e);return U(i)&&i.length?{name:e,range:i}:null}var wC=Math.max,SC=Math.min,TC=tt,MC=L,IC=["itemStyle","borderWidth"],CC=["itemStyle","gapWidth"],AC=["upperLabel","show"],kC=["upperLabel","height"],DC={seriesType:"treemap",reset:function(t,e,i,n){var r=i.getWidth(),o=i.getHeight(),a=t.option,s=Xh(t.getBoxLayoutParams(),{width:i.getWidth(),height:i.getHeight()}),l=a.size||[],u=Xn(TC(s.width,l[0]),r),c=Xn(TC(s.height,l[1]),o),h=n&&n.type,p=DI(n,["treemapZoomToNode","treemapRootToNode"],t),d="treemapRender"===h||"treemapMove"===h?n.rootRect:null,f=t.getViewRoot(),m=EI(f);if("treemapMove"!==h){var g="treemapZoomToNode"===h?function(t,e,i,n,r){var o,a=(e||{}).node,s=[n,r];if(!a||a===i)return s;for(var l=n*r,u=l*t.option.zoomToNodeRatio;o=a.parentNode;){for(var c=0,h=o.children,p=0,d=h.length;p<d;p++)c+=h[p].getValue();var f=a.getValue();if(0===f)return s;u*=c/f;var m=o.getModel(),g=m.get(IC);(u+=4*g*g+(3*g+Math.max(g,OC(m)))*Math.pow(u,.5))>nr&&(u=nr),a=o}u<l&&(u=l);var y=Math.pow(u/l,.5);return[n*y,r*y]}(t,p,f,u,c):d?[d.width,d.height]:[u,c],y=a.sort;y&&"asc"!==y&&"desc"!==y&&(y="desc");var v={squareRatio:a.squareRatio,sort:y,leafDepth:a.leafDepth};f.hostTree.clearLayouts();var _={x:0,y:0,width:g[0],height:g[1],area:g[0]*g[1]};f.setLayout(_),EC(f,v,!1,0),_=f.getLayout(),MC(m,function(t,e){var i=(m[e+1]||f).getValue();t.setLayout(I({dataExtent:[i,i],borderWidth:0,upperHeight:0},_))})}var x=t.getData().tree.root;x.setLayout(function(t,e,i){if(e)return{x:e.x,y:e.y};var n={x:0,y:0};if(!i)return n;var r=i.node,o=r.getLayout();if(!o)return n;for(var a=[o.width/2,o.height/2],s=r;s;){var l=s.getLayout();a[0]+=l.x,a[1]+=l.y,s=s.parentNode}return{x:t.width/2-a[0],y:t.height/2-a[1]}}(s,d,p),!0),t.setLayoutInfo(s),zC(x,new yn(-s.x,-s.y,r,o),m,f,0)}};function EC(t,e,i,n){var r,o;if(!t.isRemoved()){var a=t.getLayout();r=a.width,o=a.height;var s=t.getModel(),l=s.get(IC),u=s.get(CC)/2,c=OC(s),h=Math.max(l,c),p=l-u,d=h-u;t.setLayout({borderWidth:l,upperHeight:h,upperLabelHeight:c},!0);var f=(r=wC(r-2*p,0))*(o=wC(o-p-d,0)),m=function(t,e,i,n,r,o){var a=t.children||[],s=n.sort;"asc"!==s&&"desc"!==s&&(s=null);var l=null!=n.leafDepth&&n.leafDepth<=o;if(r&&!l)return t.viewChildren=[];!function(t,e){e&&t.sort(function(t,i){var n="asc"===e?t.getValue()-i.getValue():i.getValue()-t.getValue();return 0===n?"asc"===e?t.dataIndex-i.dataIndex:i.dataIndex-t.dataIndex:n})}(a=R(a,function(t){return!t.isRemoved()}),s);var u=function(t,e,i){for(var n=0,r=0,o=e.length;r<o;r++)n+=e[r].getValue();var a,s=t.get("visualDimension");return e&&e.length?"value"===s&&i?(a=[e[e.length-1].getValue(),e[0].getValue()],"asc"===i&&a.reverse()):(a=[1/0,-1/0],MC(e,function(t){var e=t.getValue(s);e<a[0]&&(a[0]=e),e>a[1]&&(a[1]=e)})):a=[NaN,NaN],{sum:n,dataExtent:a}}(e,a,s);if(0===u.sum)return t.viewChildren=[];if(u.sum=function(t,e,i,n,r){if(!n)return i;for(var o=t.get("visibleMin"),a=r.length,s=a,l=a-1;l>=0;l--){var u=r["asc"===n?a-l-1:l].getValue();u/i*e<o&&(s=l,i-=u)}return"asc"===n?r.splice(0,a-s):r.splice(s,a-s),i}(e,i,u.sum,s,a),0===u.sum)return t.viewChildren=[];for(var c=0,h=a.length;c<h;c++){var p=a[c].getValue()/u.sum*i;a[c].setLayout({area:p})}return l&&(a.length&&t.setLayout({isLeafRoot:!0},!0),a.length=0),t.viewChildren=a,t.setLayout({dataExtent:u.dataExtent},!0),a}(t,s,f,e,i,n);if(m.length){var g={x:p,y:d,width:r,height:o},y=SC(r,o),v=1/0,_=[];_.area=0;for(var x=0,b=m.length;x<b;){var w=m[x];_.push(w),_.area+=w.getLayout().area;var S=PC(_,y,e.squareRatio);S<=v?(x++,v=S):(_.area-=_.pop().getLayout().area,LC(_,y,g,u,!1),y=SC(g.width,g.height),_.length=_.area=0,v=1/0)}if(_.length&&LC(_,y,g,u,!0),!i){var T=s.get("childrenVisibleMin");null!=T&&f<T&&(i=!0)}for(x=0,b=m.length;x<b;x++)EC(m[x],e,i,n+1)}}}function PC(t,e,i){for(var n=0,r=1/0,o=0,a=void 0,s=t.length;o<s;o++)(a=t[o].getLayout().area)&&(a<r&&(r=a),a>n&&(n=a));var l=t.area*t.area,u=e*e*i;return l?wC(u*n/l,l/(u*r)):1/0}function LC(t,e,i,n,r){var o=e===i.width?0:1,a=1-o,s=["x","y"],l=["width","height"],u=i[s[o]],c=e?t.area/e:0;(r||c>i[l[a]])&&(c=i[l[a]]);for(var h=0,p=t.length;h<p;h++){var d=t[h],f={},m=c?d.getLayout().area/c:0,g=f[l[a]]=wC(c-2*n,0),y=i[s[o]]+i[l[o]]-u,v=h===p-1||y<m?y:m,_=f[l[o]]=wC(v-2*n,0);f[s[a]]=i[s[a]]+SC(n,g/2),f[s[o]]=u+SC(n,_/2),u+=v,d.setLayout(f,!0)}i[s[a]]+=c,i[l[a]]-=c}function zC(t,e,i,n,r){var o=t.getLayout(),a=i[r],s=a&&a===t;if(!(a&&!s||r===i.length&&t!==n)){t.setLayout({isInView:!0,invisible:!s&&!e.intersect(o),isAboveViewRoot:s},!0);var l=new yn(e.x-o.x,e.y-o.y,e.width,e.height);MC(t.viewChildren||[],function(t){zC(t,l,i,n,r+1)})}}function OC(t){return t.get(AC)?t.get(kC):0}function RC(t){var e=t.findComponents({mainType:"legend"});e&&e.length&&t.eachSeriesByType("graph",function(t){var i=t.getCategoriesData(),n=t.getGraph().data,r=i.mapArray(i.getName);n.filterSelf(function(t){var i=n.getItemModel(t).getShallow("category");if(null!=i){"number"==typeof i&&(i=r[i]);for(var o=0;o<e.length;o++)if(!e[o].isSelected(i))return!1}return!0})})}function BC(t){var e={};t.eachSeriesByType("graph",function(t){var i=t.getCategoriesData(),n=t.getData(),r={};i.each(function(n){var o=i.getName(n);r["ec-"+o]=n;var a=i.getItemModel(n),s=a.getModel("itemStyle").getItemStyle();s.fill||(s.fill=t.getColorFromPalette(o,e)),i.setItemVisual(n,"style",s);for(var l=["symbol","symbolSize","symbolKeepAspect"],u=0;u<l.length;u++){var c=a.getShallow(l[u],!0);null!=c&&i.setItemVisual(n,l[u],c)}}),i.count()&&n.each(function(t){var e=n.getItemModel(t).getShallow("category");if(null!=e){"string"==typeof e&&(e=r["ec-"+e]);var o=i.getItemVisual(e,"style");I(n.ensureUniqueItemVisual(t,"style"),o);for(var a=["symbol","symbolSize","symbolKeepAspect"],s=0;s<a.length;s++)n.setItemVisual(t,a[s],i.getItemVisual(e,a[s]))}})})}function NC(t){return t instanceof Array||(t=[t,t]),t}function FC(t){t.eachSeriesByType("graph",function(t){var e=t.getGraph(),i=t.getEdgeData(),n=NC(t.get("edgeSymbol")),r=NC(t.get("edgeSymbolSize"));i.setVisual("fromSymbol",n&&n[0]),i.setVisual("toSymbol",n&&n[1]),i.setVisual("fromSymbolSize",r&&r[0]),i.setVisual("toSymbolSize",r&&r[1]),i.setVisual("style",t.getModel("lineStyle").getLineStyle()),i.each(function(t){var n=i.getItemModel(t),r=e.getEdgeByIndex(t),o=NC(n.getShallow("symbol",!0)),a=NC(n.getShallow("symbolSize",!0)),s=n.getModel("lineStyle").getLineStyle(),l=i.ensureUniqueItemVisual(t,"style");switch(I(l,s),l.stroke){case"source":var u=r.node1.getVisual("style");l.stroke=u&&u.fill;break;case"target":u=r.node2.getVisual("style"),l.stroke=u&&u.fill}o[0]&&r.setVisual("fromSymbol",o[0]),o[1]&&r.setVisual("toSymbol",o[1]),a[0]&&r.setVisual("fromSymbolSize",a[0]),a[1]&&r.setVisual("toSymbolSize",a[1])})})}var VC="--\x3e",UC=function(t){return t.get("autoCurveness")||null},GC=function(t,e){var i=UC(t),n=20,r=[];if("number"==typeof i)n=i;else if(U(i))return void(t.__curvenessList=i);e>n&&(n=e);var o=n%2?n+2:n+3;r=[];for(var a=0;a<o;a++)r.push((a%2?a+1:a)/10*(a%2?-1:1));t.__curvenessList=r},$C=function(t,e,i){var n=[t.id,t.dataIndex].join("."),r=[e.id,e.dataIndex].join(".");return[i.uid,n,r].join(VC)},WC=function(t){var e=t.split(VC);return[e[0],e[2],e[1]].join(VC)},HC=function(t,e){var i=e.__edgeMap;return i[t]?i[t].length:0};function jC(t,e,i,n){var r=UC(e),o=U(r);if(!r)return null;var a=function(t,e){var i=$C(t.node1,t.node2,e);return e.__edgeMap[i]}(t,e);if(!a)return null;for(var s=-1,l=0;l<a.length;l++)if(a[l]===i){s=l;break}var u=function(t,e){return HC($C(t.node1,t.node2,e),e)+HC($C(t.node2,t.node1,e),e)}(t,e);GC(e,u),t.lineStyle=t.lineStyle||{};var c=$C(t.node1,t.node2,e),h=e.__curvenessList,p=o||u%2?0:1;if(a.isForward)return h[p+s];var d=WC(c),f=HC(d,e),m=h[s+f+p];return n?o?r&&0===r[0]?(f+p)%2?m:-m:((f%2?0:1)+p)%2?m:-m:(f+p)%2?m:-m:h[s+f+p]}function ZC(t){var e=t.coordinateSystem;if(!e||"view"===e.type){var i=t.getGraph();i.eachNode(function(t){var e=t.getModel();t.setLayout([+e.get("x"),+e.get("y")])}),qC(i,t)}}function qC(t,e){t.eachEdge(function(t,i){var n=it(t.getModel().get(["lineStyle","curveness"]),-jC(t,e,i,!0),0),r=bt(t.node1.getLayout()),o=bt(t.node2.getLayout()),a=[r,o];+n&&a.push([(r[0]+o[0])/2-(r[1]-o[1])*n,(r[1]+o[1])/2-(o[0]-r[0])*n]),t.setLayout(a)})}function XC(t,e){t.eachSeriesByType("graph",function(t){var e=t.get("layout"),i=t.coordinateSystem;if(i&&"view"!==i.type){var n=t.getData(),r=[];L(i.dimensions,function(t){r=r.concat(n.mapDimensionsAll(t))});for(var o=0;o<n.count();o++){for(var a=[],s=!1,l=0;l<r.length;l++){var u=n.get(r[l],o);isNaN(u)||(s=!0),a.push(u)}s?n.setItemLayout(o,i.dataToPoint(a)):n.setItemLayout(o,[NaN,NaN])}qC(n.graph,t)}else e&&"none"!==e||ZC(t)})}function YC(t){var e=t.coordinateSystem;if("view"!==e.type)return 1;var i=t.option.nodeScaleRatio,n=e.scaleX;return((e.getZoom()-1)*i+1)/n}function KC(t){var e=t.getVisual("symbolSize");return e instanceof Array&&(e=(e[0]+e[1])/2),+e}var JC=Math.PI,QC=[];function tA(t,e){var i=t.coordinateSystem;if(!i||"view"===i.type){var n=i.getBoundingRect(),r=t.getData(),o=r.graph,a=n.width/2+n.x,s=n.height/2+n.y,l=Math.min(n.width,n.height)/2,u=r.count();r.setLayout({cx:a,cy:s}),u&&(eA[e](t,o,r,l,a,s,u),o.eachEdge(function(e,i){var n,r=it(e.getModel().get(["lineStyle","curveness"]),jC(e,t,i),0),o=bt(e.node1.getLayout()),l=bt(e.node2.getLayout()),u=(o[0]+l[0])/2,c=(o[1]+l[1])/2;+r&&(n=[a*(r*=3)+u*(1-r),s*r+c*(1-r)]),e.setLayout([o,l,n])}))}}var eA={value:function(t,e,i,n,r,o,a){var s=0,l=i.getSum("value"),u=2*Math.PI/(l||a);e.eachNode(function(t){var e=t.getValue("value"),i=u*(l?e:1)/2;s+=i,t.setLayout([n*Math.cos(s)+r,n*Math.sin(s)+o]),s+=i})},symbolSize:function(t,e,i,n,r,o,a){var s=0;QC.length=a;var l=YC(t);e.eachNode(function(t){var e=KC(t);isNaN(e)&&(e=2),e<0&&(e=0);var i=Math.asin((e*=l)/2/n);isNaN(i)&&(i=JC/2),QC[t.dataIndex]=i,s+=2*i});var u=(2*JC-s)/a/2,c=0;e.eachNode(function(t){var e=u+QC[t.dataIndex];c+=e,t.setLayout([n*Math.cos(c)+r,n*Math.sin(c)+o]),c+=e})}};function iA(t){t.eachSeriesByType("graph",function(t){"circular"===t.get("layout")&&tA(t,"symbolSize")})}var nA=Tt;function rA(t){t.eachSeriesByType("graph",function(t){var e=t.coordinateSystem;if(!e||"view"===e.type)if("force"===t.get("layout")){var i=t.preservedPoints||{},n=t.getGraph(),r=n.data,o=n.edgeData,a=t.getModel("force"),s=a.get("initLayout");t.preservedPoints?r.each(function(t){var e=r.getId(t);r.setItemLayout(t,i[e]||[NaN,NaN])}):s&&"none"!==s?"circular"===s&&tA(t,"value"):ZC(t);var l=r.getDataExtent("value"),u=o.getDataExtent("value"),c=a.get("repulsion"),h=a.get("edgeLength"),p=U(c)?c:[c,c],d=U(h)?h:[h,h];d=[d[1],d[0]];var f=r.mapArray("value",function(t,e){var i=r.getItemLayout(e),n=qn(t,l,p);return isNaN(n)&&(n=(p[0]+p[1])/2),{w:n,rep:n,fixed:r.getItemModel(e).get("fixed"),p:!i||isNaN(i[0])||isNaN(i[1])?null:i}}),m=o.mapArray("value",function(e,i){var r=n.getEdgeByIndex(i),o=qn(e,u,d);isNaN(o)&&(o=(d[0]+d[1])/2);var a=r.getModel(),s=it(r.getModel().get(["lineStyle","curveness"]),-jC(r,t,i,!0),0);return{n1:f[r.node1.dataIndex],n2:f[r.node2.dataIndex],d:o,curveness:s,ignoreForceLayout:a.get("ignoreForceLayout")}}),g=e.getBoundingRect(),y=function(t,e,i){for(var n=t,r=e,o=i.rect,a=o.width,s=o.height,l=[o.x+a/2,o.y+s/2],u=null==i.gravity?.1:i.gravity,c=0;c<n.length;c++){var h=n[c];h.p||(h.p=_t(a*(Math.random()-.5)+l[0],s*(Math.random()-.5)+l[1])),h.pp=bt(h.p),h.edges=null}var p,d,f=null==i.friction?.6:i.friction,m=f;return{warmUp:function(){m=.8*f},setFixed:function(t){n[t].fixed=!0},setUnfixed:function(t){n[t].fixed=!1},beforeStep:function(t){p=t},afterStep:function(t){d=t},step:function(t){p&&p(n,r);for(var e=[],i=n.length,o=0;o<r.length;o++){var a=r[o];if(!a.ignoreForceLayout){var s=a.n1;Mt(e,(g=a.n2).p,s.p);var c=It(e)-a.d,h=g.w/(s.w+g.w);isNaN(h)&&(h=0),kt(e,e),!s.fixed&&nA(s.p,s.p,e,h*c*m),!g.fixed&&nA(g.p,g.p,e,-(1-h)*c*m)}}for(o=0;o<i;o++)(_=n[o]).fixed||(Mt(e,l,_.p),nA(_.p,_.p,e,u*m));for(o=0;o<i;o++){s=n[o];for(var f=o+1;f<i;f++){var g;Mt(e,(g=n[f]).p,s.p),0===(c=It(e))&&(wt(e,Math.random()-.5,Math.random()-.5),c=1);var y=(s.rep+g.rep)/c/c;!s.fixed&&nA(s.pp,s.pp,e,y),!g.fixed&&nA(g.pp,g.pp,e,-y)}}var v=[];for(o=0;o<i;o++){var _;(_=n[o]).fixed||(Mt(v,_.p,_.pp),nA(_.p,_.p,v,m),xt(_.pp,_.p))}var x=(m*=.992)<.01;d&&d(n,r,x),t&&t(x)}}}(f,m,{rect:g,gravity:a.get("gravity"),friction:a.get("friction")});y.beforeStep(function(t,e){for(var i=0,r=t.length;i<r;i++)t[i].fixed&&xt(t[i].p,n.getNodeByIndex(i).getLayout())}),y.afterStep(function(t,e,o){for(var a=0,s=t.length;a<s;a++)t[a].fixed||n.getNodeByIndex(a).setLayout(t[a].p),i[r.getId(a)]=t[a].p;for(a=0,s=e.length;a<s;a++){var l=e[a],u=n.getEdgeByIndex(a),c=l.n1.p,h=l.n2.p,p=u.getLayout();(p=p?p.slice():[])[0]=p[0]||[],p[1]=p[1]||[],xt(p[0],c),xt(p[1],h),+l.curveness&&(p[2]=[(c[0]+h[0])/2-(c[1]-h[1])*l.curveness,(c[1]+h[1])/2-(h[0]-c[0])*l.curveness]),u.setLayout(p)}}),t.forceLayout=y,t.preservedPoints=i,y.step()}else t.forceLayout=null})}function oA(t,e){var i=[];return t.eachSeriesByType("graph",function(t){var n=t.get("coordinateSystem");if(!n||"view"===n){var r=t.getData(),o=[],a=[];sa(r.mapArray(function(t){var e=r.getItemModel(t);return[+e.get("x"),+e.get("y")]}),o,a),a[0]-o[0]==0&&(a[0]+=1,o[0]-=1),a[1]-o[1]==0&&(a[1]+=1,o[1]-=1);var s=(a[0]-o[0])/(a[1]-o[1]),l=function(t,e,i){return Xh(I(t.getBoxLayoutParams(),{aspect:i}),{width:e.getWidth(),height:e.getHeight()})}(t,e,s);isNaN(s)&&(o=[l.x,l.y],a=[l.x+l.width,l.y+l.height]);var u=a[0]-o[0],c=a[1]-o[1],h=l.width,p=l.height,d=t.coordinateSystem=new $M;d.zoomLimit=t.get("scaleLimit"),d.setBoundingRect(o[0],o[1],u,c),d.setViewRect(l.x,l.y,h,p),d.setCenter(t.get("center")),d.setZoom(t.get("zoom")),i.push(d)}}),i}var aA=gu.prototype,sA=xu.prototype,lA=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1};function uA(t){return isNaN(+t.cpx1)||isNaN(+t.cpy1)}!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}i(e,t)}(lA);var cA=function(t){function e(e){var i=t.call(this,e)||this;return i.type="ec-line",i}return i(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new lA},e.prototype.buildPath=function(t,e){uA(e)?aA.buildPath.call(this,t,e):sA.buildPath.call(this,t,e)},e.prototype.pointAt=function(t){return uA(this.shape)?aA.pointAt.call(this,t):sA.pointAt.call(this,t)},e.prototype.tangentAt=function(t){var e=this.shape,i=uA(e)?[e.x2-e.x1,e.y2-e.y1]:sA.tangentAt.call(this,t);return kt(i,i)},e}(Qa),hA=["fromSymbol","toSymbol"];function pA(t){return"_"+t+"Type"}function dA(t,e,i){var n=e.getItemVisual(i,t);if(n&&"none"!==n){var r=e.getItemVisual(i,t+"Size"),o=e.getItemVisual(i,t+"Rotate"),a=e.getItemVisual(i,t+"Offset"),s=e.getItemVisual(i,t+"KeepAspect"),l=ig(r),u=ng(a||0,l),c=eg(n,-l[0]/2+u[0],-l[1]/2+u[1],l[0],l[1],null,s);return c.__specifiedRotation=null==o||isNaN(o)?void 0:+o*Math.PI/180||0,c.name=t,c}}function fA(t,e){t.x1=e[0][0],t.y1=e[0][1],t.x2=e[1][0],t.y2=e[1][1],t.percent=1;var i=e[2];i?(t.cpx1=i[0],t.cpy1=i[1]):(t.cpx1=NaN,t.cpy1=NaN)}var mA=function(t){function e(e,i,n){var r=t.call(this)||this;return r._createLine(e,i,n),r}return i(e,t),e.prototype._createLine=function(t,e,i){var n=t.hostModel,r=function(t){var e=new cA({name:"line",subPixelOptimize:!0});return fA(e.shape,t),e}(t.getItemLayout(e));r.shape.percent=0,Nu(r,{shape:{percent:1}},n,e),this.add(r),L(hA,function(i){var n=dA(i,t,e);this.add(n),this[pA(i)]=t.getItemVisual(e,i)},this),this._updateCommonStl(t,e,i)},e.prototype.updateData=function(t,e,i){var n=t.hostModel,r=this.childOfName("line"),o=t.getItemLayout(e),a={shape:{}};fA(a.shape,o),Bu(r,a,n,e),L(hA,function(i){var n=t.getItemVisual(e,i),r=pA(i);if(this[r]!==n){this.remove(this.childOfName(i));var o=dA(i,t,e);this.add(o)}this[r]=n},this),this._updateCommonStl(t,e,i)},e.prototype.getLinePath=function(){return this.childAt(0)},e.prototype._updateCommonStl=function(t,e,i){var n=t.hostModel,r=this.childOfName("line"),o=i&&i.emphasisLineStyle,a=i&&i.blurLineStyle,s=i&&i.selectLineStyle,l=i&&i.labelStatesModels;if(!i||t.hasItemOption){var u=t.getItemModel(e);o=u.getModel(["emphasis","lineStyle"]).getLineStyle(),a=u.getModel(["blur","lineStyle"]).getLineStyle(),s=u.getModel(["select","lineStyle"]).getLineStyle(),l=bc(u)}var c=t.getItemVisual(e,"style"),h=c.stroke;r.useStyle(c),r.style.fill=null,r.style.strokeNoScale=!0,r.ensureState("emphasis").style=o,r.ensureState("blur").style=a,r.ensureState("select").style=s,L(hA,function(t){var e=this.childOfName(t);if(e){e.setColor(h),e.style.opacity=c.opacity;for(var i=0;i<As.length;i++){var n=As[i],o=r.getState(n);if(o){var a=o.style||{},s=e.ensureState(n),l=s.style||(s.style={});null!=a.stroke&&(l[e.__isEmptyBrush?"stroke":"fill"]=a.stroke),null!=a.opacity&&(l.opacity=a.opacity)}}e.markRedraw()}},this);var p=n.getRawValue(e);xc(this,l,{labelDataIndex:e,labelFetcher:{getFormattedLabel:function(e,i){return n.getFormattedLabel(e,i,t.dataType)}},inheritColor:h||"#000",defaultOpacity:c.opacity,defaultText:(null==p?t.getName(e):isFinite(p)?Yn(p):p)+""});var d=this.getTextContent();if(d){var f=l.normal;d.__align=d.style.align,d.__verticalAlign=d.style.verticalAlign,d.__position=f.get("position")||"middle";var m=f.get("distance");U(m)||(m=[m,m]),d.__labelDistance=m}this.setTextConfig({position:null,local:!0,inside:!1}),pl(this)},e.prototype.highlight=function(){Qs(this)},e.prototype.downplay=function(){tl(this)},e.prototype.updateLayout=function(t,e){this.setLinePoints(t.getItemLayout(e))},e.prototype.setLinePoints=function(t){var e=this.childOfName("line");fA(e.shape,t),e.dirty()},e.prototype.beforeUpdate=function(){var t=this,e=t.childOfName("fromSymbol"),i=t.childOfName("toSymbol"),n=t.getTextContent();if(e||i||n&&!n.ignore){for(var r=1,o=this.parent;o;)o.scaleX&&(r/=o.scaleX),o=o.parent;var a=t.childOfName("line");if(this.__dirty||a.__dirty){var s=a.shape.percent,l=a.pointAt(0),u=a.pointAt(s),c=Mt([],u,l);if(kt(c,c),e&&(e.setPosition(l),S(e,0),e.scaleX=e.scaleY=r*s,e.markRedraw()),i&&(i.setPosition(u),S(i,1),i.scaleX=i.scaleY=r*s,i.markRedraw()),n&&!n.ignore){n.x=n.y=0,n.originX=n.originY=0;var h=void 0,p=void 0,d=n.__labelDistance,f=d[0]*r,m=d[1]*r,g=s/2,y=a.tangentAt(g),v=[y[1],-y[0]],_=a.pointAt(g);v[1]>0&&(v[0]=-v[0],v[1]=-v[1]);var x=y[0]<0?-1:1;if("start"!==n.__position&&"end"!==n.__position){var b=-Math.atan2(y[1],y[0]);u[0]<l[0]&&(b=Math.PI+b),n.rotation=b}var w=void 0;switch(n.__position){case"insideStartTop":case"insideMiddleTop":case"insideEndTop":case"middle":w=-m,p="bottom";break;case"insideStartBottom":case"insideMiddleBottom":case"insideEndBottom":w=m,p="top";break;default:w=0,p="middle"}switch(n.__position){case"end":n.x=c[0]*f+u[0],n.y=c[1]*m+u[1],h=c[0]>.8?"left":c[0]<-.8?"right":"center",p=c[1]>.8?"top":c[1]<-.8?"bottom":"middle";break;case"start":n.x=-c[0]*f+l[0],n.y=-c[1]*m+l[1],h=c[0]>.8?"right":c[0]<-.8?"left":"center",p=c[1]>.8?"bottom":c[1]<-.8?"top":"middle";break;case"insideStartTop":case"insideStart":case"insideStartBottom":n.x=f*x+l[0],n.y=l[1]+w,h=y[0]<0?"right":"left",n.originX=-f*x,n.originY=-w;break;case"insideMiddleTop":case"insideMiddle":case"insideMiddleBottom":case"middle":n.x=_[0],n.y=_[1]+w,h="center",n.originY=-w;break;case"insideEndTop":case"insideEnd":case"insideEndBottom":n.x=-f*x+u[0],n.y=u[1]+w,h=y[0]>=0?"right":"left",n.originX=f*x,n.originY=-w}n.scaleX=n.scaleY=r,n.setStyle({verticalAlign:n.__verticalAlign||p,align:n.__align||h})}}}function S(t,e){var i=t.__specifiedRotation;if(null==i){var n=a.tangentAt(e);t.attr("rotation",(1===e?-1:1)*Math.PI/2-Math.atan2(n[1],n[0]))}else t.attr("rotation",i)}},e}(Fn),gA=function(){function t(t){this.group=new Fn,this._LineCtor=t||mA}return t.prototype.isPersistent=function(){return!0},t.prototype.updateData=function(t){var e=this,i=this,n=i.group,r=i._lineData;i._lineData=t,r||n.removeAll();var o=yA(t);t.diff(r).add(function(i){e._doAdd(t,i,o)}).update(function(i,n){e._doUpdate(r,t,n,i,o)}).remove(function(t){n.remove(r.getItemGraphicEl(t))}).execute()},t.prototype.updateLayout=function(){var t=this._lineData;t&&t.eachItemGraphicEl(function(e,i){e.updateLayout(t,i)},this)},t.prototype.incrementalPrepareUpdate=function(t){this._seriesScope=yA(t),this._lineData=null,this.group.removeAll()},t.prototype.incrementalUpdate=function(t,e){function i(t){t.isGroup||function(t){return t.animators&&t.animators.length>0}(t)||(t.incremental=!0,t.ensureState("emphasis").hoverLayer=!0)}for(var n=t.start;n<t.end;n++)if(_A(e.getItemLayout(n))){var r=new this._LineCtor(e,n,this._seriesScope);r.traverse(i),this.group.add(r),e.setItemGraphicEl(n,r)}},t.prototype.remove=function(){this.group.removeAll()},t.prototype._doAdd=function(t,e,i){if(_A(t.getItemLayout(e))){var n=new this._LineCtor(t,e,i);t.setItemGraphicEl(e,n),this.group.add(n)}},t.prototype._doUpdate=function(t,e,i,n,r){var o=t.getItemGraphicEl(i);_A(e.getItemLayout(n))?(o?o.updateData(e,n,r):o=new this._LineCtor(e,n,r),e.setItemGraphicEl(n,o),this.group.add(o)):this.group.remove(o)},t}();function yA(t){var e=t.hostModel;return{lineStyle:e.getModel("lineStyle").getLineStyle(),emphasisLineStyle:e.getModel(["emphasis","lineStyle"]).getLineStyle(),blurLineStyle:e.getModel(["blur","lineStyle"]).getLineStyle(),selectLineStyle:e.getModel(["select","lineStyle"]).getLineStyle(),labelStatesModels:bc(e)}}function vA(t){return isNaN(t[0])||isNaN(t[1])}function _A(t){return!vA(t[0])&&!vA(t[1])}var xA=[],bA=[],wA=[],SA=Zo,TA=Lt,MA=Math.abs;function IA(t,e,i){for(var n,r=t[0],o=t[1],a=t[2],s=1/0,l=i*i,u=.1,c=.1;c<=.9;c+=.1)xA[0]=SA(r[0],o[0],a[0],c),xA[1]=SA(r[1],o[1],a[1],c),(d=MA(TA(xA,e)-l))<s&&(s=d,n=c);for(var h=0;h<32;h++){var p=n+u;bA[0]=SA(r[0],o[0],a[0],n),bA[1]=SA(r[1],o[1],a[1],n),wA[0]=SA(r[0],o[0],a[0],p),wA[1]=SA(r[1],o[1],a[1],p);var d=TA(bA,e)-l;if(MA(d)<.01)break;var f=TA(wA,e)-l;u/=2,d<0?f>=0?n+=u:n-=u:f>=0?n-=u:n+=u}return n}function CA(t,e){var i=[],n=Yo,r=[[],[],[]],o=[[],[]],a=[];e/=2,t.eachEdge(function(t,s){var l=t.getLayout(),u=t.getVisual("fromSymbol"),c=t.getVisual("toSymbol");l.__original||(l.__original=[bt(l[0]),bt(l[1])],l[2]&&l.__original.push(bt(l[2])));var h=l.__original;if(null!=l[2]){if(xt(r[0],h[0]),xt(r[1],h[2]),xt(r[2],h[1]),u&&"none"!==u){var p=KC(t.node1),d=IA(r,h[0],p*e);n(r[0][0],r[1][0],r[2][0],d,i),r[0][0]=i[3],r[1][0]=i[4],n(r[0][1],r[1][1],r[2][1],d,i),r[0][1]=i[3],r[1][1]=i[4]}c&&"none"!==c&&(p=KC(t.node2),d=IA(r,h[1],p*e),n(r[0][0],r[1][0],r[2][0],d,i),r[1][0]=i[1],r[2][0]=i[2],n(r[0][1],r[1][1],r[2][1],d,i),r[1][1]=i[1],r[2][1]=i[2]),xt(l[0],r[0]),xt(l[1],r[2]),xt(l[2],r[1])}else xt(o[0],h[0]),xt(o[1],h[1]),Mt(a,o[1],o[0]),kt(a,a),u&&"none"!==u&&(p=KC(t.node1),Tt(o[0],o[0],a,p*e)),c&&"none"!==c&&(p=KC(t.node2),Tt(o[1],o[1],a,-p*e)),xt(l[0],o[0]),xt(l[1],o[1])})}function AA(t){return"view"===t.type}var kA=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.init=function(t,e){var i=new Rw,n=new gA,r=this.group;this._controller=new vM(e.getZr()),this._controllerHost={target:r},r.add(i.group),r.add(n.group),this._symbolDraw=i,this._lineDraw=n,this._firstRender=!0},e.prototype.render=function(t,e,i){var n=this,r=t.coordinateSystem;this._model=t;var o=this._symbolDraw,a=this._lineDraw,s=this.group;if(AA(r)){var l={x:r.x,y:r.y,scaleX:r.scaleX,scaleY:r.scaleY};this._firstRender?s.attr(l):Bu(s,l,t)}CA(t.getGraph(),YC(t));var u=t.getData();o.updateData(u);var c=t.getEdgeData();a.updateData(c),this._updateNodeAndLinkScale(),this._updateController(t,e,i),clearTimeout(this._layoutTimeout);var h=t.forceLayout,p=t.get(["force","layoutAnimation"]);h&&this._startForceLayoutIteration(h,p),u.graph.eachNode(function(t){var e=t.dataIndex,i=t.getGraphicEl(),r=t.getModel();i.off("drag").off("dragend");var o=r.get("draggable");o&&i.on("drag",function(){h&&(h.warmUp(),!n._layouting&&n._startForceLayoutIteration(h,p),h.setFixed(e),u.setItemLayout(e,[i.x,i.y]))}).on("dragend",function(){h&&h.setUnfixed(e)}),i.setDraggable(o&&!!h),"adjacency"===r.get(["emphasis","focus"])&&(Ss(i).focus=t.getAdjacentDataIndices())}),u.graph.eachEdge(function(t){var e=t.getGraphicEl();"adjacency"===t.getModel().get(["emphasis","focus"])&&(Ss(e).focus={edge:[t.dataIndex],node:[t.node1.dataIndex,t.node2.dataIndex]})});var d="circular"===t.get("layout")&&t.get(["circular","rotateLabel"]),f=u.getLayout("cx"),m=u.getLayout("cy");u.eachItemGraphicEl(function(t,e){var i=u.getItemModel(e).get(["label","rotate"])||0,n=t.getSymbolPath();if(d){var r=u.getItemLayout(e),o=Math.atan2(r[1]-m,r[0]-f);o<0&&(o=2*Math.PI+o);var a=r[0]<f;a&&(o-=Math.PI);var s=a?"left":"right";n.setTextConfig({rotation:-o,position:s,origin:"center"});var l=n.ensureState("emphasis");I(l.textConfig||(l.textConfig={}),{position:s})}else n.setTextConfig({rotation:i*=Math.PI/180})}),this._firstRender=!1},e.prototype.dispose=function(){this._controller&&this._controller.dispose(),this._controllerHost=null},e.prototype._startForceLayoutIteration=function(t,e){var i=this;!function n(){t.step(function(t){i.updateLayout(i._model),(i._layouting=!t)&&(e?i._layoutTimeout=setTimeout(n,16):n())})}()},e.prototype._updateController=function(t,e,i){var n=this,r=this._controller,o=this._controllerHost,a=this.group;r.setPointerChecker(function(e,n,r){var o=a.getBoundingRect();return o.applyTransform(a.transform),o.contain(n,r)&&!MM(e,i,t)}),AA(t.coordinateSystem)?(r.enable(t.get("roam")),o.zoomLimit=t.get("scaleLimit"),o.zoom=t.coordinateSystem.getZoom(),r.off("pan").off("zoom").on("pan",function(e){wM(o,e.dx,e.dy),i.dispatchAction({seriesId:t.id,type:"graphRoam",dx:e.dx,dy:e.dy})}).on("zoom",function(e){SM(o,e.scale,e.originX,e.originY),i.dispatchAction({seriesId:t.id,type:"graphRoam",zoom:e.scale,originX:e.originX,originY:e.originY}),n._updateNodeAndLinkScale(),CA(t.getGraph(),YC(t)),n._lineDraw.updateLayout(),i.updateLabelLayout()})):r.disable()},e.prototype._updateNodeAndLinkScale=function(){var t=this._model,e=t.getData(),i=YC(t);e.eachItemGraphicEl(function(t,e){t.setSymbolScale(i)})},e.prototype.updateLayout=function(t){CA(t.getGraph(),YC(t)),this._symbolDraw.updateLayout(),this._lineDraw.updateLayout()},e.prototype.remove=function(t,e){this._symbolDraw&&this._symbolDraw.remove(),this._lineDraw&&this._lineDraw.remove()},e.type="graph",e}(Zf);function DA(t){return"_EC_"+t}var EA=function(){function t(t){this.type="graph",this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this._directed=t||!1}return t.prototype.isDirected=function(){return this._directed},t.prototype.addNode=function(t,e){t=null==t?""+e:""+t;var i=this._nodesMap;if(!i[DA(t)]){var n=new PA(t,e);return n.hostGraph=this,this.nodes.push(n),i[DA(t)]=n,n}},t.prototype.getNodeByIndex=function(t){var e=this.data.getRawIndex(t);return this.nodes[e]},t.prototype.getNodeById=function(t){return this._nodesMap[DA(t)]},t.prototype.addEdge=function(t,e,i){var n=this._nodesMap,r=this._edgesMap;if("number"==typeof t&&(t=this.nodes[t]),"number"==typeof e&&(e=this.nodes[e]),t instanceof PA||(t=n[DA(t)]),e instanceof PA||(e=n[DA(e)]),t&&e){var o=t.id+"-"+e.id,a=new LA(t,e,i);return a.hostGraph=this,this._directed&&(t.outEdges.push(a),e.inEdges.push(a)),t.edges.push(a),t!==e&&e.edges.push(a),this.edges.push(a),r[o]=a,a}},t.prototype.getEdgeByIndex=function(t){var e=this.edgeData.getRawIndex(t);return this.edges[e]},t.prototype.getEdge=function(t,e){t instanceof PA&&(t=t.id),e instanceof PA&&(e=e.id);var i=this._edgesMap;return this._directed?i[t+"-"+e]:i[t+"-"+e]||i[e+"-"+t]},t.prototype.eachNode=function(t,e){for(var i=this.nodes,n=i.length,r=0;r<n;r++)i[r].dataIndex>=0&&t.call(e,i[r],r)},t.prototype.eachEdge=function(t,e){for(var i=this.edges,n=i.length,r=0;r<n;r++)i[r].dataIndex>=0&&i[r].node1.dataIndex>=0&&i[r].node2.dataIndex>=0&&t.call(e,i[r],r)},t.prototype.breadthFirstTraverse=function(t,e,i,n){if(e instanceof PA||(e=this._nodesMap[DA(e)]),e){for(var r="out"===i?"outEdges":"in"===i?"inEdges":"edges",o=0;o<this.nodes.length;o++)this.nodes[o].__visited=!1;if(!t.call(n,e,null))for(var a=[e];a.length;){var s=a.shift(),l=s[r];for(o=0;o<l.length;o++){var u=l[o],c=u.node1===s?u.node2:u.node1;if(!c.__visited){if(t.call(n,c,s))return;a.push(c),c.__visited=!0}}}}},t.prototype.update=function(){for(var t=this.data,e=this.edgeData,i=this.nodes,n=this.edges,r=0,o=i.length;r<o;r++)i[r].dataIndex=-1;for(r=0,o=t.count();r<o;r++)i[t.getRawIndex(r)].dataIndex=r;for(e.filterSelf(function(t){var i=n[e.getRawIndex(t)];return i.node1.dataIndex>=0&&i.node2.dataIndex>=0}),r=0,o=n.length;r<o;r++)n[r].dataIndex=-1;for(r=0,o=e.count();r<o;r++)n[e.getRawIndex(r)].dataIndex=r},t.prototype.clone=function(){for(var e=new t(this._directed),i=this.nodes,n=this.edges,r=0;r<i.length;r++)e.addNode(i[r].id,i[r].dataIndex);for(r=0;r<n.length;r++){var o=n[r];e.addEdge(o.node1.id,o.node2.id,o.dataIndex)}return e},t}(),PA=function(){function t(t,e){this.inEdges=[],this.outEdges=[],this.edges=[],this.dataIndex=-1,this.id=null==t?"":t,this.dataIndex=null==e?-1:e}return t.prototype.degree=function(){return this.edges.length},t.prototype.inDegree=function(){return this.inEdges.length},t.prototype.outDegree=function(){return this.outEdges.length},t.prototype.getModel=function(t){if(!(this.dataIndex<0))return this.hostGraph.data.getItemModel(this.dataIndex).getModel(t)},t.prototype.getAdjacentDataIndices=function(){for(var t={edge:[],node:[]},e=0;e<this.edges.length;e++){var i=this.edges[e];i.dataIndex<0||(t.edge.push(i.dataIndex),t.node.push(i.node1.dataIndex,i.node2.dataIndex))}return t},t}(),LA=function(){function t(t,e,i){this.dataIndex=-1,this.node1=t,this.node2=e,this.dataIndex=null==i?-1:i}return t.prototype.getModel=function(t){if(!(this.dataIndex<0))return this.hostGraph.edgeData.getItemModel(this.dataIndex).getModel(t)},t.prototype.getAdjacentDataIndices=function(){return{edge:[this.dataIndex],node:[this.node1.dataIndex,this.node2.dataIndex]}},t}();function zA(t,e){return{getValue:function(i){var n=this[t][e];return n.getStore().get(n.getDimensionIndex(i||"value"),this.dataIndex)},setVisual:function(i,n){this.dataIndex>=0&&this[t][e].setItemVisual(this.dataIndex,i,n)},getVisual:function(i){return this[t][e].getItemVisual(this.dataIndex,i)},setLayout:function(i,n){this.dataIndex>=0&&this[t][e].setItemLayout(this.dataIndex,i,n)},getLayout:function(){return this[t][e].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[t][e].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[t][e].getRawIndex(this.dataIndex)}}}function OA(t,e,i,n,r){for(var o=new EA(n),a=0;a<t.length;a++)o.addNode(tt(t[a].id,t[a].name,a),a);var s=[],l=[],u=0;for(a=0;a<e.length;a++){var c=e[a],h=c.source,p=c.target;o.addEdge(h,p,u)&&(l.push(c),s.push(tt(Dr(c.id,null),h+" > "+p)),u++)}var d,f=i.get("coordinateSystem");if("cartesian2d"===f||"polar"===f)d=v_(t,i);else{var m=Vp.get(f),g=m&&m.dimensions||[];k(g,"value")<0&&g.concat(["value"]);var y=c_(t,{coordDimensions:g,encodeDefine:i.getEncode()}).dimensions;(d=new u_(y,i)).initData(t)}var v=new u_(["value"],i);return v.initData(l,s),r&&r(d,v),xI({mainData:d,struct:o,structAttr:"graph",datas:{node:d,edge:v},datasAttr:{node:"data",edge:"edgeData"}}),o.update(),o}E(PA,zA("hostGraph","data")),E(LA,zA("hostGraph","edgeData"));var RA=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.hasSymbolVisual=!0,i}return i(e,t),e.prototype.init=function(e){t.prototype.init.apply(this,arguments);var i=this;function n(){return i._categoriesData}this.legendVisualProvider=new tT(n,n),this.fillDataTextStyle(e.edges||e.links),this._updateCategoriesData()},e.prototype.mergeOption=function(e){t.prototype.mergeOption.apply(this,arguments),this.fillDataTextStyle(e.edges||e.links),this._updateCategoriesData()},e.prototype.mergeDefaultAndTheme=function(e){t.prototype.mergeDefaultAndTheme.apply(this,arguments),Sr(e,"edgeLabel",["show"])},e.prototype.getInitialData=function(t,e){var i,n=t.edges||t.links||[],r=t.data||t.nodes||[],o=this;if(r&&n){UC(i=this)&&(i.__curvenessList=[],i.__edgeMap={},GC(i));var a=OA(r,n,this,!0,function(t,e){t.wrapMethod("getItemModel",function(t){var e=o._categoriesModels[t.getShallow("category")];return e&&(e.parentModel=t.parentModel,t.parentModel=e),t});var i=$c.prototype.getModel;function n(t,e){var n=i.call(this,t,e);return n.resolveParentPath=r,n}function r(t){if(t&&("label"===t[0]||"label"===t[1])){var e=t.slice();return"label"===t[0]?e[0]="edgeLabel":"label"===t[1]&&(e[1]="edgeLabel"),e}return t}e.wrapMethod("getItemModel",function(t){return t.resolveParentPath=r,t.getModel=n,t})});return L(a.edges,function(t){!function(t,e,i,n){if(UC(i)){var r=$C(t,e,i),o=i.__edgeMap,a=o[WC(r)];o[r]&&!a?o[r].isForward=!0:a&&o[r]&&(a.isForward=!0,o[r].isForward=!1),o[r]=o[r]||[],o[r].push(n)}}(t.node1,t.node2,this,t.dataIndex)},this),a.data}},e.prototype.getGraph=function(){return this.getData().graph},e.prototype.getEdgeData=function(){return this.getGraph().edgeData},e.prototype.getCategoriesData=function(){return this._categoriesData},e.prototype.formatTooltip=function(t,e,i){if("edge"===i){var n=this.getData(),r=this.getDataParams(t,i),o=n.graph.getEdgeByIndex(t),a=n.getName(o.node1.dataIndex),s=n.getName(o.node2.dataIndex),l=[];return null!=a&&l.push(a),null!=s&&l.push(s),wf("nameValue",{name:l.join(" > "),value:r.value,noValue:null==r.value})}return Pf({series:this,dataIndex:t,multipleSeries:e})},e.prototype._updateCategoriesData=function(){var t=z(this.option.categories||[],function(t){return null!=t.value?t:I({value:0},t)}),e=new u_(["value"],this);e.initData(t),this._categoriesData=e,this._categoriesModels=e.mapArray(function(t){return e.getItemModel(t)})},e.prototype.setZoom=function(t){this.option.zoom=t},e.prototype.setCenter=function(t){this.option.center=t},e.prototype.isAnimationEnabled=function(){return t.prototype.isAnimationEnabled.call(this)&&!("force"===this.get("layout")&&this.get(["force","layoutAnimation"]))},e.type="series.graph",e.dependencies=["grid","polar","geo","singleAxis","calendar"],e.defaultOption={zlevel:0,z:2,coordinateSystem:"view",legendHoverLink:!0,layout:null,circular:{rotateLabel:!1},force:{initLayout:null,repulsion:[0,50],gravity:.1,friction:.6,edgeLength:30,layoutAnimation:!0},left:"center",top:"center",symbol:"circle",symbolSize:10,edgeSymbol:["none","none"],edgeSymbolSize:10,edgeLabel:{position:"middle",distance:5},draggable:!1,roam:!1,center:null,zoom:1,nodeScaleRatio:.6,label:{show:!1,formatter:"{b}"},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{scale:!0,label:{show:!0}},select:{itemStyle:{borderColor:"#212121"}}},e}(Of),BA={type:"graphRoam",event:"graphRoam",update:"none"},NA=function(){this.angle=0,this.width=10,this.r=10,this.x=0,this.y=0},FA=function(t){function e(e){var i=t.call(this,e)||this;return i.type="pointer",i}return i(e,t),e.prototype.getDefaultShape=function(){return new NA},e.prototype.buildPath=function(t,e){var i=Math.cos,n=Math.sin,r=e.r,o=e.width,a=e.angle,s=e.x-i(a)*o*(o>=r/3?1:2),l=e.y-n(a)*o*(o>=r/3?1:2);a=e.angle-Math.PI/2,t.moveTo(s,l),t.lineTo(e.x+i(a)*o,e.y+n(a)*o),t.lineTo(e.x+i(e.angle)*r,e.y+n(e.angle)*r),t.lineTo(e.x-i(a)*o,e.y-n(a)*o),t.lineTo(s,l)},e}(Qa);function VA(t,e){var i=null==t?"":t+"";return e&&("string"==typeof e?i=e.replace("{value}",i):"function"==typeof e&&(i=e(t))),i}var UA=2*Math.PI,GA=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(t,e,i){this.group.removeAll();var n=t.get(["axisLine","lineStyle","color"]),r=function(t,e){var i=t.get("center"),n=e.getWidth(),r=e.getHeight(),o=Math.min(n,r);return{cx:Xn(i[0],e.getWidth()),cy:Xn(i[1],e.getHeight()),r:Xn(t.get("radius"),o/2)}}(t,i);this._renderMain(t,e,i,n,r),this._data=t.getData()},e.prototype.dispose=function(){},e.prototype._renderMain=function(t,e,i,n,r){for(var o=this.group,a=t.get("clockwise"),s=-t.get("startAngle")/180*Math.PI,l=-t.get("endAngle")/180*Math.PI,u=t.getModel("axisLine"),c=u.get("roundCap")?vS:ou,h=u.get("show"),p=u.getModel("lineStyle"),d=p.get("width"),f=(l-s)%UA||l===s?(l-s)%UA:UA,m=s,g=0;h&&g<n.length;g++){var y=new c({shape:{startAngle:m,endAngle:l=s+f*Math.min(Math.max(n[g][0],0),1),cx:r.cx,cy:r.cy,clockwise:a,r0:r.r-d,r:r.r},silent:!0});y.setStyle({fill:n[g][1]}),y.setStyle(p.getLineStyle(["color","width"])),o.add(y),m=l}var v=function(t){if(t<=0)return n[0][1];var e;for(e=0;e<n.length;e++)if(n[e][0]>=t&&(0===e?0:n[e-1][0])<t)return n[e][1];return n[e-1][1]};if(!a){var _=s;s=l,l=_}this._renderTicks(t,e,i,v,r,s,l,a,d),this._renderTitleAndDetail(t,e,i,v,r),this._renderAnchor(t,r),this._renderPointer(t,e,i,v,r,s,l,a,d)},e.prototype._renderTicks=function(t,e,i,n,r,o,a,s,l){for(var u,c,h=this.group,p=r.cx,d=r.cy,f=r.r,m=+t.get("min"),g=+t.get("max"),y=t.getModel("splitLine"),v=t.getModel("axisTick"),_=t.getModel("axisLabel"),x=t.get("splitNumber"),b=v.get("splitNumber"),w=Xn(y.get("length"),f),S=Xn(v.get("length"),f),T=o,M=(a-o)/x,I=M/b,C=y.getModel("lineStyle").getLineStyle(),A=v.getModel("lineStyle").getLineStyle(),k=y.get("distance"),D=0;D<=x;D++){if(u=Math.cos(T),c=Math.sin(T),y.get("show")){var E=new gu({shape:{x1:u*(f-(P=k?k+l:l))+p,y1:c*(f-P)+d,x2:u*(f-w-P)+p,y2:c*(f-w-P)+d},style:C,silent:!0});"auto"===C.stroke&&E.setStyle({stroke:n(D/x)}),h.add(E)}if(_.get("show")){var P=_.get("distance")+k,L=VA(Yn(D/x*(g-m)+m),_.get("formatter")),z=n(D/x);h.add(new fs({style:wc(_,{text:L,x:u*(f-w-P)+p,y:c*(f-w-P)+d,verticalAlign:c<-.8?"top":c>.8?"bottom":"middle",align:u<-.4?"left":u>.4?"right":"center"},{inheritColor:z}),silent:!0}))}if(v.get("show")&&D!==x){P=(P=v.get("distance"))?P+l:l;for(var O=0;O<=b;O++){var R=new gu({shape:{x1:(u=Math.cos(T))*(f-P)+p,y1:(c=Math.sin(T))*(f-P)+d,x2:u*(f-S-P)+p,y2:c*(f-S-P)+d},silent:!0,style:A});"auto"===A.stroke&&R.setStyle({stroke:n((D+O/b)/x)}),h.add(R),T+=I}T-=I}else T+=M}},e.prototype._renderPointer=function(t,e,i,n,r,o,a,s,l){var u=this.group,c=this._data,h=this._progressEls,p=[],d=t.get(["pointer","show"]),f=t.getModel("progress"),m=f.get("show"),g=t.getData(),y=g.mapDimension("value"),v=+t.get("min"),_=+t.get("max"),x=[v,_],b=[o,a];function w(e,i){var n,o=g.getItemModel(e).getModel("pointer"),a=Xn(o.get("width"),r.r),s=Xn(o.get("length"),r.r),l=t.get(["pointer","icon"]),u=o.get("offsetCenter"),c=Xn(u[0],r.r),h=Xn(u[1],r.r),p=o.get("keepAspect");return(n=l?eg(l,c-a/2,h-s,a,s,null,p):new FA({shape:{angle:-Math.PI/2,width:a,r:s,x:c,y:h}})).rotation=-(i+Math.PI/2),n.x=r.cx,n.y=r.cy,n}function S(t,e){var i=f.get("roundCap")?vS:ou,n=f.get("overlap"),a=n?f.get("width"):l/g.count(),u=n?r.r-a:r.r-(t+1)*a,c=n?r.r:r.r-t*a,h=new i({shape:{startAngle:o,endAngle:e,cx:r.cx,cy:r.cy,clockwise:s,r0:u,r:c}});return n&&(h.z2=_-g.get(y,t)%_),h}(m||d)&&(g.diff(c).add(function(e){if(d){var i=w(e,o);Nu(i,{rotation:-(qn(g.get(y,e),x,b,!0)+Math.PI/2)},t),u.add(i),g.setItemGraphicEl(e,i)}if(m){var n=S(e,o),r=f.get("clip");Nu(n,{shape:{endAngle:qn(g.get(y,e),x,b,r)}},t),u.add(n),Ts(t.seriesIndex,g.dataType,e,n),p[e]=n}}).update(function(e,i){if(d){var n=c.getItemGraphicEl(i),r=n?n.rotation:o,a=w(e,r);a.rotation=r,Bu(a,{rotation:-(qn(g.get(y,e),x,b,!0)+Math.PI/2)},t),u.add(a),g.setItemGraphicEl(e,a)}if(m){var s=h[i],l=S(e,s?s.shape.endAngle:o),v=f.get("clip");Bu(l,{shape:{endAngle:qn(g.get(y,e),x,b,v)}},t),u.add(l),Ts(t.seriesIndex,g.dataType,e,l),p[e]=l}}).execute(),g.each(function(t){var e=g.getItemModel(t),i=e.getModel("emphasis");if(d){var r=g.getItemGraphicEl(t),o=g.getItemVisual(t,"style"),a=o.fill;if(r instanceof rs){var s=r.style;r.useStyle(I({image:s.image,x:s.x,y:s.y,width:s.width,height:s.height},o))}else r.useStyle(o),"pointer"!==r.type&&r.setColor(a);r.setStyle(e.getModel(["pointer","itemStyle"]).getItemStyle()),"auto"===r.style.fill&&r.setStyle("fill",n(qn(g.get(y,t),x,[0,1],!0))),r.z2EmphasisLift=0,gl(r,e),pl(r,i.get("focus"),i.get("blurScope"))}if(m){var l=p[t];l.useStyle(g.getItemVisual(t,"style")),l.setStyle(e.getModel(["progress","itemStyle"]).getItemStyle()),l.z2EmphasisLift=0,gl(l,e),pl(l,i.get("focus"),i.get("blurScope"))}}),this._progressEls=p)},e.prototype._renderAnchor=function(t,e){var i=t.getModel("anchor");if(i.get("show")){var n=i.get("size"),r=i.get("icon"),o=i.get("offsetCenter"),a=i.get("keepAspect"),s=eg(r,e.cx-n/2+Xn(o[0],e.r),e.cy-n/2+Xn(o[1],e.r),n,n,null,a);s.z2=i.get("showAbove")?1:0,s.setStyle(i.getModel("itemStyle").getItemStyle()),this.group.add(s)}},e.prototype._renderTitleAndDetail=function(t,e,i,n,r){var o=this,a=t.getData(),s=a.mapDimension("value"),l=+t.get("min"),u=+t.get("max"),c=new Fn,h=[],p=[],d=t.isAnimationEnabled(),f=t.get(["pointer","showAbove"]);a.diff(this._data).add(function(t){h[t]=new fs({silent:!0}),p[t]=new fs({silent:!0})}).update(function(t,e){h[t]=o._titleEls[e],p[t]=o._detailEls[e]}).execute(),a.each(function(e){var i=a.getItemModel(e),o=a.get(s,e),m=new Fn,g=n(qn(o,[l,u],[0,1],!0)),y=i.getModel("title");if(y.get("show")){var v=y.get("offsetCenter"),_=r.cx+Xn(v[0],r.r),x=r.cy+Xn(v[1],r.r);(A=h[e]).attr({z2:f?0:2,style:wc(y,{x:_,y:x,text:a.getName(e),align:"center",verticalAlign:"middle"},{inheritColor:g})}),m.add(A)}var b=i.getModel("detail");if(b.get("show")){var w=b.get("offsetCenter"),S=r.cx+Xn(w[0],r.r),T=r.cy+Xn(w[1],r.r),M=Xn(b.get("width"),r.r),I=Xn(b.get("height"),r.r),C=t.get(["progress","show"])?a.getItemVisual(e,"style").fill:g,A=p[e],k=b.get("formatter");A.attr({z2:f?0:2,style:wc(b,{x:S,y:T,text:VA(o,k),width:isNaN(M)?null:M,height:isNaN(I)?null:I,align:"center",verticalAlign:"middle"},{inheritColor:C})}),Dc(A,{normal:b},o,function(t){return VA(t,k)}),d&&Ec(A,e,a,t,{getFormattedLabel:function(t,e,i,n,r,a){return VA(a?a.interpolatedValue:o,k)}}),m.add(A)}c.add(m)}),this.group.add(c),this._titleEls=h,this._detailEls=p},e.type="gauge",e}(Zf),$A=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.visualStyleAccessPath="itemStyle",i}return i(e,t),e.prototype.getInitialData=function(t,e){return QS(this,["value"])},e.type="series.gauge",e.defaultOption={zlevel:0,z:2,colorBy:"data",center:["50%","50%"],legendHoverLink:!0,radius:"75%",startAngle:225,endAngle:-45,clockwise:!0,min:0,max:100,splitNumber:10,axisLine:{show:!0,roundCap:!1,lineStyle:{color:[[1,"#E6EBF8"]],width:10}},progress:{show:!1,overlap:!0,width:10,roundCap:!1,clip:!0},splitLine:{show:!0,length:10,distance:10,lineStyle:{color:"#63677A",width:3,type:"solid"}},axisTick:{show:!0,splitNumber:5,length:6,distance:10,lineStyle:{color:"#63677A",width:1,type:"solid"}},axisLabel:{show:!0,distance:15,color:"#464646",fontSize:12},pointer:{icon:null,offsetCenter:[0,0],show:!0,showAbove:!0,length:"60%",width:6,keepAspect:!1},anchor:{show:!1,showAbove:!1,size:6,icon:"circle",offsetCenter:[0,0],keepAspect:!1,itemStyle:{color:"#fff",borderWidth:0,borderColor:"#5470c6"}},title:{show:!0,offsetCenter:[0,"20%"],color:"#464646",fontSize:16,valueAnimation:!1},detail:{show:!0,backgroundColor:"rgba(0,0,0,0)",borderWidth:0,borderColor:"#ccc",width:100,height:null,padding:[5,10],offsetCenter:[0,"40%"],color:"#464646",fontSize:30,fontWeight:"bold",lineHeight:30,valueAnimation:!1}},e}(Of),WA=["itemStyle","opacity"],HA=function(t){function e(e,i){var n=t.call(this)||this,r=n,o=new du,a=new fs;return r.setTextContent(a),n.setTextGuideLine(o),n.updateData(e,i,!0),n}return i(e,t),e.prototype.updateData=function(t,e,i){var n=this,r=t.hostModel,o=t.getItemModel(e),a=t.getItemLayout(e),s=o.getModel("emphasis"),l=o.get(WA);l=null==l?1:l,i||$u(n),n.useStyle(t.getItemVisual(e,"style")),n.style.lineJoin="round",i?(n.setShape({points:a.points}),n.style.opacity=0,Nu(n,{style:{opacity:l}},r,e)):Bu(n,{style:{opacity:l},shape:{points:a.points}},r,e),gl(n,o),this._updateLabel(t,e),pl(this,s.get("focus"),s.get("blurScope"))},e.prototype._updateLabel=function(t,e){var i=this,n=this.getTextGuideLine(),r=i.getTextContent(),o=t.hostModel,a=t.getItemModel(e),s=t.getItemLayout(e).label,l=t.getItemVisual(e,"style"),u=l.fill;xc(r,bc(a),{labelFetcher:t.hostModel,labelDataIndex:e,defaultOpacity:l.opacity,defaultText:t.getName(e)},{normal:{align:s.textAlign,verticalAlign:s.verticalAlign}}),i.setTextConfig({local:!0,inside:!!s.inside,insideStroke:u,outsideFill:u});var c=s.linePoints;n.setShape({points:c}),i.textGuideLineConfig={anchor:c?new ln(c[0][0],c[0][1]):null},Bu(r,{style:{x:s.x,y:s.y}},o,e),r.attr({rotation:s.rotation,originX:s.x,originY:s.y,z2:10}),db(i,fb(a),{stroke:u})},e}(hu),jA=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.ignoreLabelLineUpdate=!0,i}return i(e,t),e.prototype.render=function(t,e,i){var n=t.getData(),r=this._data,o=this.group;n.diff(r).add(function(t){var e=new HA(n,t);n.setItemGraphicEl(t,e),o.add(e)}).update(function(t,e){var i=r.getItemGraphicEl(e);i.updateData(n,t),o.add(i),n.setItemGraphicEl(t,i)}).remove(function(e){Gu(r.getItemGraphicEl(e),t,e)}).execute(),this._data=n},e.prototype.remove=function(){this.group.removeAll(),this._data=null},e.prototype.dispose=function(){},e.type="funnel",e}(Zf),ZA=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.init=function(e){t.prototype.init.apply(this,arguments),this.legendVisualProvider=new tT(F(this.getData,this),F(this.getRawData,this)),this._defaultLabelLine(e)},e.prototype.getInitialData=function(t,e){return QS(this,{coordDimensions:["value"],encodeDefaulter:V(xp,this)})},e.prototype._defaultLabelLine=function(t){Sr(t,"labelLine",["show"]);var e=t.labelLine,i=t.emphasis.labelLine;e.show=e.show&&t.label.show,i.show=i.show&&t.emphasis.label.show},e.prototype.getDataParams=function(e){var i=this.getData(),n=t.prototype.getDataParams.call(this,e),r=i.mapDimension("value"),o=i.getSum(r);return n.percent=o?+(i.get(r,e)/o*100).toFixed(2):0,n.$vars.push("percent"),n},e.type="series.funnel",e.defaultOption={zlevel:0,z:2,legendHoverLink:!0,colorBy:"data",left:80,top:60,right:80,bottom:60,minSize:"0%",maxSize:"100%",sort:"descending",orient:"vertical",gap:0,funnelAlign:"center",label:{show:!0,position:"outer"},labelLine:{show:!0,length:20,lineStyle:{width:1}},itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{label:{show:!0}},select:{itemStyle:{borderColor:"#212121"}}},e}(Of);function qA(t,e){t.eachSeriesByType("funnel",function(t){var i=t.getData(),n=i.mapDimension("value"),r=t.get("sort"),o=function(t,e){return Xh(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}(t,e),a=t.get("orient"),s=o.width,l=o.height,u=function(t,e){for(var i=t.mapDimension("value"),n=t.mapArray(i,function(t){return t}),r=[],o="ascending"===e,a=0,s=t.count();a<s;a++)r[a]=a;return"function"==typeof e?r.sort(e):"none"!==e&&r.sort(function(t,e){return o?n[t]-n[e]:n[e]-n[t]}),r}(i,r),c=o.x,h=o.y,p="horizontal"===a?[Xn(t.get("minSize"),l),Xn(t.get("maxSize"),l)]:[Xn(t.get("minSize"),s),Xn(t.get("maxSize"),s)],d=i.getDataExtent(n),f=t.get("min"),m=t.get("max");null==f&&(f=Math.min(d[0],0)),null==m&&(m=d[1]);var g=t.get("funnelAlign"),y=t.get("gap"),v=(("horizontal"===a?s:l)-y*(i.count()-1))/i.count(),_=function(t,e){if("horizontal"===a){var r=qn(i.get(n,t)||0,[f,m],p,!0),o=void 0;switch(g){case"top":o=h;break;case"center":o=h+(l-r)/2;break;case"bottom":o=h+(l-r)}return[[e,o],[e,o+r]]}var u,d=qn(i.get(n,t)||0,[f,m],p,!0);switch(g){case"left":u=c;break;case"center":u=c+(s-d)/2;break;case"right":u=c+s-d}return[[u,e],[u+d,e]]};"ascending"===r&&(v=-v,y=-y,"horizontal"===a?c+=s:h+=l,u=u.reverse());for(var x=0;x<u.length;x++){var b=u[x],w=u[x+1],S=i.getItemModel(b);if("horizontal"===a){var T=S.get(["itemStyle","width"]);null==T?T=v:(T=Xn(T,s),"ascending"===r&&(T=-T));var M=_(b,c),I=_(w,c+T);c+=T+y,i.setItemLayout(b,{points:M.concat(I.slice().reverse())})}else{var C=S.get(["itemStyle","height"]);null==C?C=v:(C=Xn(C,l),"ascending"===r&&(C=-C)),M=_(b,h),I=_(w,h+C),h+=C+y,i.setItemLayout(b,{points:M.concat(I.slice().reverse())})}}!function(t){var e=t.hostModel.get("orient");t.each(function(i){var n,r,o,a,s=t.getItemModel(i),l=s.getModel("label").get("position"),u=s.getModel("labelLine"),c=t.getItemLayout(i),h=c.points,p="inner"===l||"inside"===l||"center"===l||"insideLeft"===l||"insideRight"===l;if(p)"insideLeft"===l?(r=(h[0][0]+h[3][0])/2+5,o=(h[0][1]+h[3][1])/2,n="left"):"insideRight"===l?(r=(h[1][0]+h[2][0])/2-5,o=(h[1][1]+h[2][1])/2,n="right"):(r=(h[0][0]+h[1][0]+h[2][0]+h[3][0])/4,o=(h[0][1]+h[1][1]+h[2][1]+h[3][1])/4,n="center"),a=[[r,o],[r,o]];else{var d=void 0,f=void 0,m=void 0,g=void 0,y=u.get("length");"left"===l?(d=(h[3][0]+h[0][0])/2,f=(h[3][1]+h[0][1])/2,r=(m=d-y)-5,n="right"):"right"===l?(d=(h[1][0]+h[2][0])/2,f=(h[1][1]+h[2][1])/2,r=(m=d+y)+5,n="left"):"top"===l?(d=(h[3][0]+h[0][0])/2,o=(g=(f=(h[3][1]+h[0][1])/2)-y)-5,n="center"):"bottom"===l?(d=(h[1][0]+h[2][0])/2,o=(g=(f=(h[1][1]+h[2][1])/2)+y)+5,n="center"):"rightTop"===l?(d="horizontal"===e?h[3][0]:h[1][0],f="horizontal"===e?h[3][1]:h[1][1],"horizontal"===e?(o=(g=f-y)-5,n="center"):(r=(m=d+y)+5,n="top")):"rightBottom"===l?(d=h[2][0],f=h[2][1],"horizontal"===e?(o=(g=f+y)+5,n="center"):(r=(m=d+y)+5,n="bottom")):"leftTop"===l?(d=h[0][0],f="horizontal"===e?h[0][1]:h[1][1],"horizontal"===e?(o=(g=f-y)-5,n="center"):(r=(m=d-y)-5,n="right")):"leftBottom"===l?(d="horizontal"===e?h[1][0]:h[3][0],f="horizontal"===e?h[1][1]:h[2][1],"horizontal"===e?(o=(g=f+y)+5,n="center"):(r=(m=d-y)-5,n="right")):(d=(h[1][0]+h[2][0])/2,f=(h[1][1]+h[2][1])/2,"horizontal"===e?(o=(g=f+y)+5,n="center"):(r=(m=d+y)+5,n="left")),"horizontal"===e?r=m=d:o=g=f,a=[[d,f],[m,g]]}c.label={linePoints:a,x:r,y:o,verticalAlign:"middle",textAlign:n,inside:p}})}(i)})}var XA=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._dataGroup=new Fn,i._initialized=!1,i}return i(e,t),e.prototype.init=function(){this.group.add(this._dataGroup)},e.prototype.render=function(t,e,i,n){var r=this._dataGroup,o=t.getData(),a=this._data,s=t.coordinateSystem,l=s.dimensions,u=JA(t);if(o.diff(a).add(function(t){QA(KA(o,r,t,l,s),o,t,u)}).update(function(e,i){var n=a.getItemGraphicEl(i),r=YA(o,e,l,s);o.setItemGraphicEl(e,n),Bu(n,{shape:{points:r}},t,e),$u(n),QA(n,o,e,u)}).remove(function(t){var e=a.getItemGraphicEl(t);r.remove(e)}).execute(),!this._initialized){this._initialized=!0;var c=function(t,e,i){var n=t.model,r=t.getRect(),o=new hs({shape:{x:r.x,y:r.y,width:r.width,height:r.height}}),a="horizontal"===n.get("layout")?"width":"height";return o.setShape(a,0),Nu(o,{shape:{width:r.width,height:r.height}},e,i),o}(s,t,function(){setTimeout(function(){r.removeClipPath()})});r.setClipPath(c)}this._data=o},e.prototype.incrementalPrepareRender=function(t,e,i){this._initialized=!0,this._data=null,this._dataGroup.removeAll()},e.prototype.incrementalRender=function(t,e,i){for(var n=e.getData(),r=e.coordinateSystem,o=r.dimensions,a=JA(e),s=t.start;s<t.end;s++){var l=KA(n,this._dataGroup,s,o,r);l.incremental=!0,QA(l,n,s,a)}},e.prototype.remove=function(){this._dataGroup&&this._dataGroup.removeAll(),this._data=null},e.type="parallel",e}(Zf);function YA(t,e,i,n){for(var r,o=[],a=0;a<i.length;a++){var s=i[a],l=t.get(t.mapDimension(s),e);r=l,("category"===n.getAxis(s).type?null==r:null==r||isNaN(r))||o.push(n.dataToPoint(l,s))}return o}function KA(t,e,i,n,r){var o=YA(t,i,n,r),a=new du({shape:{points:o},z2:10});return e.add(a),t.setItemGraphicEl(i,a),a}function JA(t){var e=t.get("smooth",!0);return!0===e&&(e=.3),Q(e=dr(e))&&(e=0),{smooth:e}}function QA(t,e,i,n){t.useStyle(e.getItemVisual(i,"style")),t.style.fill=null,t.setShape("smooth",n.smooth);var r=e.getItemModel(i),o=r.getModel("emphasis");gl(t,r,"lineStyle"),pl(t,o.get("focus"),o.get("blurScope"))}var tk=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.visualStyleAccessPath="lineStyle",i.visualDrawType="stroke",i}return i(e,t),e.prototype.getInitialData=function(t,e){return v_(null,this,{useEncodeDefaulter:F(ek,null,this)})},e.prototype.getRawIndicesByActiveState=function(t){var e=this.coordinateSystem,i=this.getData(),n=[];return e.eachActiveState(i,function(e,r){t===e&&n.push(i.getRawIndex(r))}),n},e.type="series.parallel",e.dependencies=["parallel"],e.defaultOption={zlevel:0,z:2,coordinateSystem:"parallel",parallelIndex:0,label:{show:!1},inactiveOpacity:.05,activeOpacity:1,lineStyle:{width:1,opacity:.45,type:"solid"},emphasis:{label:{show:!1}},progressive:500,smooth:!1,animationEasing:"linear"},e}(Of);function ek(t){var e=t.ecModel.getComponent("parallel",t.get("parallelIndex"));if(e){var i={};return L(e.dimensions,function(t){var e=+t.replace("dim","");i[t]=e}),i}}var ik=["lineStyle","opacity"],nk={seriesType:"parallel",reset:function(t,e){var i=t.coordinateSystem,n={normal:t.get(["lineStyle","opacity"]),active:t.get("activeOpacity"),inactive:t.get("inactiveOpacity")};return{progress:function(t,e){i.eachActiveState(e,function(t,i){var r=n[t];if("normal"===t&&e.hasItemOption){var o=e.getItemModel(i).get(ik,!0);null!=o&&(r=o)}e.ensureUniqueItemVisual(i,"style").opacity=r},t.start,t.end)}}}};function rk(t){!function(t){if(!t.parallel){var e=!1;L(t.series,function(t){t&&"parallel"===t.type&&(e=!0)}),e&&(t.parallel=[{}])}}(t),function(t){L(wr(t.parallelAxis),function(e){if(j(e)){var i=e.parallelIndex||0,n=wr(t.parallel)[i];n&&n.parallelAxisDefault&&T(e,n.parallelAxisDefault,!1)}})}(t)}var ok=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(t,e,i){this._model=t,this._api=i,this._handlers||(this._handlers={},L(ak,function(t,e){i.getZr().on(e,this._handlers[e]=F(t,this))},this)),nm(this,"_throttledDispatchExpand",t.get("axisExpandRate"),"fixRate")},e.prototype.dispose=function(t,e){L(this._handlers,function(t,i){e.getZr().off(i,t)}),this._handlers=null},e.prototype._throttledDispatchExpand=function(t){this._dispatchExpand(t)},e.prototype._dispatchExpand=function(t){t&&this._api.dispatchAction(I({type:"parallelAxisExpand"},t))},e.type="parallel",e}($f),ak={mousedown:function(t){sk(this,"click")&&(this._mouseDownPoint=[t.offsetX,t.offsetY])},mouseup:function(t){var e=this._mouseDownPoint;if(sk(this,"click")&&e){var i=[t.offsetX,t.offsetY];if(Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2)>5)return;var n=this._model.coordinateSystem.getSlidedAxisExpandWindow([t.offsetX,t.offsetY]);"none"!==n.behavior&&this._dispatchExpand({axisExpandWindow:n.axisExpandWindow})}this._mouseDownPoint=null},mousemove:function(t){if(!this._mouseDownPoint&&sk(this,"mousemove")){var e=this._model,i=e.coordinateSystem.getSlidedAxisExpandWindow([t.offsetX,t.offsetY]),n=i.behavior;"jump"===n&&this._throttledDispatchExpand.debounceNextCall(e.get("axisExpandDebounce")),this._throttledDispatchExpand("none"===n?null:{axisExpandWindow:i.axisExpandWindow,animation:"jump"===n?null:{duration:0}})}}};function sk(t,e){var i=t._model;return i.get("axisExpandable")&&i.get("axisExpandTriggerOn")===e}var lk=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.init=function(){t.prototype.init.apply(this,arguments),this.mergeOption({})},e.prototype.mergeOption=function(t){var e=this.option;t&&T(e,t,!0),this._initDimensions()},e.prototype.contains=function(t,e){var i=t.get("parallelIndex");return null!=i&&e.getComponent("parallel",i)===this},e.prototype.setAxisExpand=function(t){L(["axisExpandable","axisExpandCenter","axisExpandCount","axisExpandWidth","axisExpandWindow"],function(e){t.hasOwnProperty(e)&&(this.option[e]=t[e])},this)},e.prototype._initDimensions=function(){var t=this.dimensions=[],e=this.parallelAxisIndex=[];L(R(this.ecModel.queryComponents({mainType:"parallelAxis"}),function(t){return(t.get("parallelIndex")||0)===this.componentIndex},this),function(i){t.push("dim"+i.get("dim")),e.push(i.componentIndex)})},e.type="parallel",e.dependencies=["parallelAxis"],e.layoutMode="box",e.defaultOption={zlevel:0,z:0,left:80,top:60,right:80,bottom:60,layout:"horizontal",axisExpandable:!1,axisExpandCenter:null,axisExpandCount:0,axisExpandWidth:50,axisExpandRate:17,axisExpandDebounce:50,axisExpandSlideTriggerArea:[-.15,.05,.4],axisExpandTriggerOn:"click",parallelAxisDefault:null},e}(ip),uk=function(t){function e(e,i,n,r,o){var a=t.call(this,e,i,n)||this;return a.type=r||"value",a.axisIndex=o,a}return i(e,t),e.prototype.isHorizontal=function(){return"horizontal"!==this.coordinateSystem.getModel().get("layout")},e}($x);function ck(t,e,i,n,r,o){t=t||0;var a=i[1]-i[0];if(null!=r&&(r=pk(r,[0,a])),null!=o&&(o=Math.max(o,null!=r?r:0)),"all"===n){var s=Math.abs(e[1]-e[0]);s=pk(s,[0,a]),r=o=pk(s,[r,o]),n=0}e[0]=pk(e[0],i),e[1]=pk(e[1],i);var l=hk(e,n);e[n]+=t;var u,c=r||0,h=i.slice();return l.sign<0?h[0]+=c:h[1]-=c,e[n]=pk(e[n],h),u=hk(e,n),null!=r&&(u.sign!==l.sign||u.span<r)&&(e[1-n]=e[n]+l.sign*r),u=hk(e,n),null!=o&&u.span>o&&(e[1-n]=e[n]+u.sign*o),e}function hk(t,e){var i=t[e]-t[1-e];return{span:Math.abs(i),sign:i>0?-1:i<0?1:e?-1:1}}function pk(t,e){return Math.min(null!=e[1]?e[1]:1/0,Math.max(null!=e[0]?e[0]:-1/0,t))}var dk=L,fk=Math.min,mk=Math.max,gk=Math.floor,yk=Math.ceil,vk=Yn,_k=Math.PI,xk=function(){function t(t,e,i){this.type="parallel",this._axesMap=ht(),this._axesLayout={},this.dimensions=t.dimensions,this._model=t,this._init(t,e,i)}return t.prototype._init=function(t,e,i){var n=t.dimensions,r=t.parallelAxisIndex;dk(n,function(t,i){var n=r[i],o=e.getComponent("parallelAxis",n),a=this._axesMap.set(t,new uk(t,yx(o),[0,0],o.get("type"),n)),s="category"===a.type;a.onBand=s&&o.get("boundaryGap"),a.inverse=o.get("inverse"),o.axis=a,a.model=o,a.coordinateSystem=o.coordinateSystem=this},this)},t.prototype.update=function(t,e){this._updateAxesFromSeries(this._model,t)},t.prototype.containPoint=function(t){var e=this._makeLayoutInfo(),i=e.axisBase,n=e.layoutBase,r=e.pixelDimIndex,o=t[1-r],a=t[r];return o>=i&&o<=i+e.axisLength&&a>=n&&a<=n+e.layoutLength},t.prototype.getModel=function(){return this._model},t.prototype._updateAxesFromSeries=function(t,e){e.eachSeries(function(i){if(t.contains(i,e)){var n=i.getData();dk(this.dimensions,function(t){var e=this._axesMap.get(t);e.scale.unionExtentFromData(n,n.mapDimension(t)),gx(e.scale,e.model)},this)}},this)},t.prototype.resize=function(t,e){this._rect=Xh(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()}),this._layoutAxes()},t.prototype.getRect=function(){return this._rect},t.prototype._makeLayoutInfo=function(){var t,e=this._model,i=this._rect,n=["x","y"],r=["width","height"],o=e.get("layout"),a="horizontal"===o?0:1,s=i[r[a]],l=[0,s],u=this.dimensions.length,c=bk(e.get("axisExpandWidth"),l),h=bk(e.get("axisExpandCount")||0,[0,u]),p=e.get("axisExpandable")&&u>3&&u>h&&h>1&&c>0&&s>0,d=e.get("axisExpandWindow");d?(t=bk(d[1]-d[0],l),d[1]=d[0]+t):(t=bk(c*(h-1),l),(d=[c*(e.get("axisExpandCenter")||gk(u/2))-t/2])[1]=d[0]+t);var f=(s-t)/(u-h);f<3&&(f=0);var m=[gk(vk(d[0]/c,1))+1,yk(vk(d[1]/c,1))-1],g=f/c*d[0];return{layout:o,pixelDimIndex:a,layoutBase:i[n[a]],layoutLength:s,axisBase:i[n[1-a]],axisLength:i[r[1-a]],axisExpandable:p,axisExpandWidth:c,axisCollapseWidth:f,axisExpandWindow:d,axisCount:u,winInnerIndices:m,axisExpandWindow0Pos:g}},t.prototype._layoutAxes=function(){var t=this._rect,e=this._axesMap,i=this.dimensions,n=this._makeLayoutInfo(),r=n.layout;e.each(function(t){var e=[0,n.axisLength],i=t.inverse?1:0;t.setExtent(e[i],e[1-i])}),dk(i,function(e,i){var o=(n.axisExpandable?Sk:wk)(i,n),a={horizontal:{x:o.position,y:n.axisLength},vertical:{x:0,y:o.position}},s={horizontal:_k/2,vertical:0},l=[a[r].x+t.x,a[r].y+t.y],u=s[r],c=[1,0,0,1,0,0];Hi(c,c,u),Wi(c,c,l),this._axesLayout[e]={position:l,rotation:u,transform:c,axisNameAvailableWidth:o.axisNameAvailableWidth,axisLabelShow:o.axisLabelShow,nameTruncateMaxWidth:o.nameTruncateMaxWidth,tickDirection:1,labelDirection:1}},this)},t.prototype.getAxis=function(t){return this._axesMap.get(t)},t.prototype.dataToPoint=function(t,e){return this.axisCoordToPoint(this._axesMap.get(e).dataToCoord(t),e)},t.prototype.eachActiveState=function(t,e,i,n){null==i&&(i=0),null==n&&(n=t.count());var r=this._axesMap,o=this.dimensions,a=[],s=[];L(o,function(e){a.push(t.mapDimension(e)),s.push(r.get(e).model)});for(var l=this.hasAxisBrushed(),u=i;u<n;u++){var c=void 0;if(l){c="active";for(var h=t.getValues(a,u),p=0,d=o.length;p<d;p++)if("inactive"===s[p].getActiveState(h[p])){c="inactive";break}}else c="normal";e(c,u)}},t.prototype.hasAxisBrushed=function(){for(var t=this.dimensions,e=this._axesMap,i=!1,n=0,r=t.length;n<r;n++)"normal"!==e.get(t[n]).model.getActiveState()&&(i=!0);return i},t.prototype.axisCoordToPoint=function(t,e){return oc([t,0],this._axesLayout[e].transform)},t.prototype.getAxisLayout=function(t){return S(this._axesLayout[t])},t.prototype.getSlidedAxisExpandWindow=function(t){var e=this._makeLayoutInfo(),i=e.pixelDimIndex,n=e.axisExpandWindow.slice(),r=n[1]-n[0],o=[0,e.axisExpandWidth*(e.axisCount-1)];if(!this.containPoint(t))return{behavior:"none",axisExpandWindow:n};var a,s=t[i]-e.layoutBase-e.axisExpandWindow0Pos,l="slide",u=e.axisCollapseWidth,c=this._model.get("axisExpandSlideTriggerArea"),h=null!=c[0];if(u)h&&u&&s<r*c[0]?(l="jump",a=s-r*c[2]):h&&u&&s>r*(1-c[0])?(l="jump",a=s-r*(1-c[2])):(a=s-r*c[1])>=0&&(a=s-r*(1-c[1]))<=0&&(a=0),(a*=e.axisExpandWidth/u)?ck(a,n,o,"all"):l="none";else{var p=n[1]-n[0];(n=[mk(0,o[1]*s/p-p/2)])[1]=fk(o[1],n[0]+p),n[0]=n[1]-p}return{axisExpandWindow:n,behavior:l}},t}();function bk(t,e){return fk(mk(t,e[0]),e[1])}function wk(t,e){var i=e.layoutLength/(e.axisCount-1);return{position:i*t,axisNameAvailableWidth:i,axisLabelShow:!0}}function Sk(t,e){var i,n,r=e.layoutLength,o=e.axisExpandWidth,a=e.axisCount,s=e.axisCollapseWidth,l=e.winInnerIndices,u=s,c=!1;return t<l[0]?(i=t*s,n=s):t<=l[1]?(i=e.axisExpandWindow0Pos+t*o-e.axisExpandWindow[0],u=o,c=!0):(i=r-(a-1-t)*s,n=s),{position:i,axisNameAvailableWidth:u,axisLabelShow:c,nameTruncateMaxWidth:n}}var Tk={create:function(t,e){var i=[];return t.eachComponent("parallel",function(n,r){var o=new xk(n,t,e);o.name="parallel_"+r,o.resize(n,e),n.coordinateSystem=o,o.model=n,i.push(o)}),t.eachSeries(function(t){if("parallel"===t.get("coordinateSystem")){var e=t.getReferringComponents("parallel",Nr).models[0];t.coordinateSystem=e.coordinateSystem}}),i}},Mk=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.activeIntervals=[],i}return i(e,t),e.prototype.getAreaSelectStyle=function(){return to([["fill","color"],["lineWidth","borderWidth"],["stroke","borderColor"],["width","width"],["opacity","opacity"]])(this.getModel("areaSelectStyle"))},e.prototype.setActiveIntervals=function(t){var e=this.activeIntervals=S(t);if(e)for(var i=e.length-1;i>=0;i--)Kn(e[i])},e.prototype.getActiveState=function(t){var e=this.activeIntervals;if(!e.length)return"normal";if(null==t||isNaN(+t))return"inactive";if(1===e.length){var i=e[0];if(i[0]<=t&&t<=i[1])return"active"}else for(var n=0,r=e.length;n<r;n++)if(e[n][0]<=t&&t<=e[n][1])return"active";return"inactive"},e}(ip);E(Mk,Mx);var Ik=!0,Ck=Math.min,Ak=Math.max,kk=Math.pow,Dk="globalPan",Ek={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},Pk={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},Lk={brushStyle:{lineWidth:2,stroke:"rgba(210,219,238,0.3)",fill:"#D2DBEE"},transformable:!0,brushMode:"single",removeOnClick:!1},zk=0,Ok=function(t){function e(e){var i=t.call(this)||this;return i._track=[],i._covers=[],i._handlers={},i._zr=e,i.group=new Fn,i._uid="brushController_"+zk++,L(lD,function(t,e){this._handlers[e]=F(t,this)},i),i}return i(e,t),e.prototype.enableBrush=function(t){return this._brushType&&this._doDisableBrush(),t.brushType&&this._doEnableBrush(t),this},e.prototype._doEnableBrush=function(t){var e=this._zr;this._enableGlobalPan||function(t,e,i){yM(t)[e]=i}(e,Dk,this._uid),L(this._handlers,function(t,i){e.on(i,t)}),this._brushType=t.brushType,this._brushOption=T(S(Lk),t,!0)},e.prototype._doDisableBrush=function(){var t=this._zr;!function(t,e,i){var n=yM(t);n[e]===i&&(n[e]=null)}(t,Dk,this._uid),L(this._handlers,function(e,i){t.off(i,e)}),this._brushType=this._brushOption=null},e.prototype.setPanels=function(t){if(t&&t.length){var e=this._panels={};L(t,function(t){e[t.panelId]=S(t)})}else this._panels=null;return this},e.prototype.mount=function(t){t=t||{},this._enableGlobalPan=t.enableGlobalPan;var e=this.group;return this._zr.add(e),e.attr({x:t.x||0,y:t.y||0,rotation:t.rotation||0,scaleX:t.scaleX||1,scaleY:t.scaleY||1}),this._transform=e.getLocalTransform(),this},e.prototype.updateCovers=function(t){t=z(t,function(t){return T(S(Lk),t,!0)});var e=this._covers,i=this._covers=[],n=this,r=this._creatingCover;return new Fv(e,t,function(t,e){return o(t.__brushOption,e)},o).add(a).update(a).remove(function(t){e[t]!==r&&n.group.remove(e[t])}).execute(),this;function o(t,e){return(null!=t.id?t.id:"\0-brush-index-"+e)+"-"+t.brushType}function a(o,a){var s=t[o];if(null!=a&&e[a]===r)i[o]=e[a];else{var l=i[o]=null!=a?(e[a].__brushOption=s,e[a]):Bk(n,Rk(n,s));Vk(n,l)}}},e.prototype.unmount=function(){return this.enableBrush(!1),Wk(this),this._zr.remove(this.group),this},e.prototype.dispose=function(){this.unmount(),this.off()},e}(Ut);function Rk(t,e){var i=cD[e.brushType].createCover(t,e);return i.__brushOption=e,Fk(i,e),t.group.add(i),i}function Bk(t,e){var i=Uk(e);return i.endCreating&&(i.endCreating(t,e),Fk(e,e.__brushOption)),e}function Nk(t,e){var i=e.__brushOption;Uk(e).updateCoverShape(t,e,i.range,i)}function Fk(t,e){var i=e.z;null==i&&(i=1e4),t.traverse(function(t){t.z=i,t.z2=i})}function Vk(t,e){Uk(e).updateCommon(t,e),Nk(t,e)}function Uk(t){return cD[t.__brushOption.brushType]}function Gk(t,e,i){var n,r=t._panels;if(!r)return Ik;var o=t._transform;return L(r,function(t){t.isTargetByCursor(e,i,o)&&(n=t)}),n}function $k(t,e){var i=t._panels;if(!i)return Ik;var n=e.__brushOption.panelId;return null!=n?i[n]:Ik}function Wk(t){var e=t._covers,i=e.length;return L(e,function(e){t.group.remove(e)},t),e.length=0,!!i}function Hk(t,e){var i=z(t._covers,function(t){var e=t.__brushOption,i=S(e.range);return{brushType:e.brushType,panelId:e.panelId,range:i}});t.trigger("brush",{areas:i,isEnd:!!e.isEnd,removeOnClick:!!e.removeOnClick})}function jk(t){var e=t.length-1;return e<0&&(e=0),[t[0],t[e]]}function Zk(t,e,i,n){var r=new Fn;return r.add(new hs({name:"main",style:Kk(i),silent:!0,draggable:!0,cursor:"move",drift:V(tD,t,e,r,["n","s","w","e"]),ondragend:V(Hk,e,{isEnd:!0})})),L(n,function(i){r.add(new hs({name:i.join(""),style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:V(tD,t,e,r,i),ondragend:V(Hk,e,{isEnd:!0})}))}),r}function qk(t,e,i,n){var r=n.brushStyle.lineWidth||0,o=Ak(r,6),a=i[0][0],s=i[1][0],l=a-r/2,u=s-r/2,c=i[0][1],h=i[1][1],p=c-o+r/2,d=h-o+r/2,f=c-a,m=h-s,g=f+r,y=m+r;Yk(t,e,"main",a,s,f,m),n.transformable&&(Yk(t,e,"w",l,u,o,y),Yk(t,e,"e",p,u,o,y),Yk(t,e,"n",l,u,g,o),Yk(t,e,"s",l,d,g,o),Yk(t,e,"nw",l,u,o,o),Yk(t,e,"ne",p,u,o,o),Yk(t,e,"sw",l,d,o,o),Yk(t,e,"se",p,d,o,o))}function Xk(t,e){var i=e.__brushOption,n=i.transformable,r=e.childAt(0);r.useStyle(Kk(i)),r.attr({silent:!n,cursor:n?"move":"default"}),L([["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]],function(i){var r=e.childOfName(i.join("")),o=1===i.length?Qk(t,i[0]):function(t,e){var i=[Qk(t,e[0]),Qk(t,e[1])];return("e"===i[0]||"w"===i[0])&&i.reverse(),i.join("")}(t,i);r&&r.attr({silent:!n,invisible:!n,cursor:n?Pk[o]+"-resize":null})})}function Yk(t,e,i,n,r,o,a){var s=e.childOfName(i);s&&s.setShape(function(t){var e=Ck(t[0][0],t[1][0]),i=Ck(t[0][1],t[1][1]),n,r;return{x:e,y:i,width:Ak(t[0][0],t[1][0])-e,height:Ak(t[0][1],t[1][1])-i}}(nD(t,e,[[n,r],[n+o,r+a]])))}function Kk(t){return C({strokeNoScale:!0},t.brushStyle)}function Jk(t,e,i,n){var r=[Ck(t,i),Ck(e,n)],o=[Ak(t,i),Ak(e,n)];return[[r[0],o[0]],[r[1],o[1]]]}function Qk(t,e){return{left:"w",right:"e",top:"n",bottom:"s"}[ac({w:"left",e:"right",n:"top",s:"bottom"}[e],function(t){return rc(t.group)}(t))]}function tD(t,e,i,n,r,o){var a=i.__brushOption,s=t.toRectRange(a.range),l=iD(e,r,o);L(n,function(t){var e=Ek[t];s[e[0]][e[1]]+=l[e[0]]}),a.range=t.fromRectRange(Jk(s[0][0],s[1][0],s[0][1],s[1][1])),Vk(e,i),Hk(e,{isEnd:!1})}function eD(t,e,i,n){var r=e.__brushOption.range,o=iD(t,i,n);L(r,function(t){t[0]+=o[0],t[1]+=o[1]}),Vk(t,e),Hk(t,{isEnd:!1})}function iD(t,e,i){var n=t.group,r=n.transformCoordToLocal(e,i),o=n.transformCoordToLocal(0,0);return[r[0]-o[0],r[1]-o[1]]}function nD(t,e,i){var n=$k(t,e);return n&&n!==Ik?n.clipPath(i,t._transform):S(i)}function rD(t){var e=t.event;e.preventDefault&&e.preventDefault()}function oD(t,e,i){return t.childOfName("main").contain(e,i)}function aD(t,e,i,n){var r,o=t._creatingCover,a=t._creatingPanel,s=t._brushOption;if(t._track.push(i.slice()),function(t){var e=t._track;if(!e.length)return!1;var i=e[e.length-1],n=e[0],r=i[0]-n[0],o=i[1]-n[1];return kk(r*r+o*o,.5)>6}(t)||o){if(a&&!o){"single"===s.brushMode&&Wk(t);var l=S(s);l.brushType=sD(l.brushType,a),l.panelId=a===Ik?null:a.panelId,o=t._creatingCover=Rk(t,l),t._covers.push(o)}if(o){var u=cD[sD(t._brushType,a)];o.__brushOption.range=u.getCreatingRange(nD(t,o,t._track)),n&&(Bk(t,o),u.updateCommon(t,o)),Nk(t,o),r={isEnd:n}}}else n&&"single"===s.brushMode&&s.removeOnClick&&Gk(t,e,i)&&Wk(t)&&(r={isEnd:n,removeOnClick:!0});return r}function sD(t,e){return"auto"===t?e.defaultBrushType:t}var lD={mousedown:function(t){if(this._dragging)uD(this,t);else if(!t.target||!t.target.draggable){rD(t);var e=this.group.transformCoordToLocal(t.offsetX,t.offsetY);this._creatingCover=null,(this._creatingPanel=Gk(this,t,e))&&(this._dragging=!0,this._track=[e.slice()])}},mousemove:function(t){var e=t.offsetX,i=t.offsetY,n=this.group.transformCoordToLocal(e,i);if(function(t,e,i){if(t._brushType&&!function(t,e,i){var n=t._zr;return e<0||e>n.getWidth()||i<0||i>n.getHeight()}(t,e.offsetX,e.offsetY)){var n=t._zr,r=t._covers,o=Gk(t,e,i);if(!t._dragging)for(var a=0;a<r.length;a++){var s=r[a].__brushOption;if(o&&(o===Ik||s.panelId===o.panelId)&&cD[s.brushType].contain(r[a],i[0],i[1]))return}o&&n.setCursorStyle("crosshair")}}(this,t,n),this._dragging){rD(t);var r=aD(this,t,n,!1);r&&Hk(this,r)}},mouseup:function(t){uD(this,t)}};function uD(t,e){if(t._dragging){rD(e);var i=e.offsetX,n=e.offsetY,r=t.group.transformCoordToLocal(i,n),o=aD(t,e,r,!0);t._dragging=!1,t._track=[],t._creatingCover=null,o&&Hk(t,o)}}var cD={lineX:hD(0),lineY:hD(1),rect:{createCover:function(t,e){function i(t){return t}return Zk({toRectRange:i,fromRectRange:i},t,e,[["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]])},getCreatingRange:function(t){var e=jk(t);return Jk(e[1][0],e[1][1],e[0][0],e[0][1])},updateCoverShape:function(t,e,i,n){qk(t,e,i,n)},updateCommon:Xk,contain:oD},polygon:{createCover:function(t,e){var i=new Fn;return i.add(new du({name:"main",style:Kk(e),silent:!0})),i},getCreatingRange:function(t){return t},endCreating:function(t,e){e.remove(e.childAt(0)),e.add(new hu({name:"main",draggable:!0,drift:V(eD,t,e),ondragend:V(Hk,t,{isEnd:!0})}))},updateCoverShape:function(t,e,i,n){e.childAt(0).setShape({points:nD(t,e,i)})},updateCommon:Xk,contain:oD}};function hD(t){return{createCover:function(e,i){return Zk({toRectRange:function(e){var i=[e,[0,100]];return t&&i.reverse(),i},fromRectRange:function(e){return e[t]}},e,i,[[["w"],["e"]],[["n"],["s"]]][t])},getCreatingRange:function(e){var i=jk(e);return[Ck(i[0][t],i[1][t]),Ak(i[0][t],i[1][t])]},updateCoverShape:function(e,i,n,r){var o,a=$k(e,i);if(a!==Ik&&a.getLinearBrushOtherExtent)o=a.getLinearBrushOtherExtent(t);else{var s=e._zr;o=[0,[s.getWidth(),s.getHeight()][1-t]]}var l=[n,o];t&&l.reverse(),qk(e,i,l,r)},updateCommon:Xk,contain:oD}}function pD(t){return t=mD(t),function(e){return uc(e,t)}}function dD(t,e){return t=mD(t),function(i){var n=null!=e?e:i,r=n?t.width:t.height,o=n?t.x:t.y;return[o,o+(r||0)]}}function fD(t,e,i){var n=mD(t);return function(t,r){return n.contain(r[0],r[1])&&!MM(t,e,i)}}function mD(t){return yn.create(t)}var gD=["axisLine","axisTickLabel","axisName"],yD=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.init=function(e,i){t.prototype.init.apply(this,arguments),(this._brushController=new Ok(i.getZr())).on("brush",F(this._onBrush,this))},e.prototype.render=function(t,e,i,n){if(!function(t,e,i){return i&&"axisAreaSelect"===i.type&&e.findComponents({mainType:"parallelAxis",query:i})[0]===t}(t,e,n)){this.axisModel=t,this.api=i,this.group.removeAll();var r=this._axisGroup;if(this._axisGroup=new Fn,this.group.add(this._axisGroup),t.get("show")){var o=function(t,e){return e.getComponent("parallel",t.get("parallelIndex"))}(t,e),a=o.coordinateSystem,s=t.getAreaSelectStyle(),l=s.width,u=t.axis.dim,c=I({strokeContainThreshold:l},a.getAxisLayout(u)),h=new kT(t,c);L(gD,h.add,h),this._axisGroup.add(h.getGroup()),this._refreshBrushController(c,s,t,o,l,i),lc(r,this._axisGroup,t)}}},e.prototype._refreshBrushController=function(t,e,i,n,r,o){var a=i.axis.getExtent(),s=a[1]-a[0],l=Math.min(30,.1*Math.abs(s)),u=yn.create({x:a[0],y:-r/2,width:s,height:r});u.x-=l,u.width+=2*l,this._brushController.mount({enableGlobalPan:!0,rotation:t.rotation,x:t.position[0],y:t.position[1]}).setPanels([{panelId:"pl",clipPath:pD(u),isTargetByCursor:fD(u,o,n),getLinearBrushOtherExtent:dD(u,0)}]).enableBrush({brushType:"lineX",brushStyle:e,removeOnClick:!0}).updateCovers(function(t){var e=t.axis;return z(t.activeIntervals,function(t){return{brushType:"lineX",panelId:"pl",range:[e.dataToCoord(t[0],!0),e.dataToCoord(t[1],!0)]}})}(i))},e.prototype._onBrush=function(t){var e=t.areas,i=this.axisModel,n=i.axis,r=z(e,function(t){return[n.coordToData(t.range[0],!0),n.coordToData(t.range[1],!0)]});(!i.option.realtime===t.isEnd||t.removeOnClick)&&this.api.dispatchAction({type:"axisAreaSelect",parallelAxisId:i.id,intervals:r})},e.prototype.dispose=function(){this._brushController.dispose()},e.type="parallelAxis",e}($f),vD={type:"axisAreaSelect",event:"axisAreaSelected"},_D={type:"value",areaSelectStyle:{width:20,borderWidth:1,borderColor:"rgba(160,197,232)",color:"rgba(160,197,232)",opacity:.3},realtime:!0,z:10};function xD(t){t.registerComponentView(ok),t.registerComponentModel(lk),t.registerCoordinateSystem("parallel",Tk),t.registerPreprocessor(rk),t.registerComponentModel(Mk),t.registerComponentView(yD),fT(t,"parallel",Mk,_D),function(t){t.registerAction(vD,function(t,e){e.eachComponent({mainType:"parallelAxis",query:t},function(e){e.axis.model.setActiveIntervals(t.intervals)})}),t.registerAction("parallelAxisExpand",function(t,e){e.eachComponent({mainType:"parallel",query:t},function(e){e.setAxisExpand(t)})})}(t)}var bD=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.cpx2=0,this.cpy2=0,this.extent=0},wD=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getDefaultShape=function(){return new bD},e.prototype.buildPath=function(t,e){var i=e.extent;t.moveTo(e.x1,e.y1),t.bezierCurveTo(e.cpx1,e.cpy1,e.cpx2,e.cpy2,e.x2,e.y2),"vertical"===e.orient?(t.lineTo(e.x2+i,e.y2),t.bezierCurveTo(e.cpx2+i,e.cpy2,e.cpx1+i,e.cpy1,e.x1+i,e.y1)):(t.lineTo(e.x2,e.y2+i),t.bezierCurveTo(e.cpx2,e.cpy2+i,e.cpx1,e.cpy1+i,e.x1,e.y1+i)),t.closePath()},e.prototype.highlight=function(){Qs(this)},e.prototype.downplay=function(){tl(this)},e}(Qa),SD=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._focusAdjacencyDisabled=!1,i}return i(e,t),e.prototype.render=function(t,e,i){var n=this,r=t.getGraph(),o=this.group,a=t.layoutInfo,s=a.width,l=a.height,u=t.getData(),c=t.getData("edge"),h=t.get("orient");this._model=t,o.removeAll(),o.x=a.x,o.y=a.y,r.eachEdge(function(e){var i=new wD,n=Ss(i);n.dataIndex=e.dataIndex,n.seriesIndex=t.seriesIndex,n.dataType="edge";var r,a,u,p,d,f,m,g,y=e.getModel(),v=y.getModel("lineStyle"),_=v.get("curveness"),x=e.node1.getLayout(),b=e.node1.getModel(),w=b.get("localX"),S=b.get("localY"),T=e.node2.getLayout(),M=e.node2.getModel(),I=M.get("localX"),C=M.get("localY"),A=e.getLayout();switch(i.shape.extent=Math.max(1,A.dy),i.shape.orient=h,"vertical"===h?(r=(null!=w?w*s:x.x)+A.sy,a=(null!=S?S*l:x.y)+x.dy,u=(null!=I?I*s:T.x)+A.ty,d=r,f=a*(1-_)+(p=null!=C?C*l:T.y)*_,m=u,g=a*_+p*(1-_)):(r=(null!=w?w*s:x.x)+x.dx,a=(null!=S?S*l:x.y)+A.sy,d=r*(1-_)+(u=null!=I?I*s:T.x)*_,f=a,m=r*_+u*(1-_),g=p=(null!=C?C*l:T.y)+A.ty),i.setShape({x1:r,y1:a,x2:u,y2:p,cpx1:d,cpy1:f,cpx2:m,cpy2:g}),i.useStyle(v.getItemStyle()),i.style.fill){case"source":i.style.fill=e.node1.getVisual("color"),i.style.decal=e.node1.getVisual("style").decal;break;case"target":i.style.fill=e.node2.getVisual("color"),i.style.decal=e.node2.getVisual("style").decal;break;case"gradient":var k=e.node1.getVisual("color"),D=e.node2.getVisual("color");"string"==typeof k&&"string"==typeof D&&(i.style.fill=new Mu(0,0,+("horizontal"===h),+("vertical"===h),[{color:k,offset:0},{color:D,offset:1}]))}var E=y.getModel("emphasis");gl(i,y,"lineStyle",function(t){return t.getItemStyle()}),o.add(i),c.setItemGraphicEl(e.dataIndex,i);var P=E.get("focus");pl(i,"adjacency"===P?e.getAdjacentDataIndices():P,E.get("blurScope")),Ss(i).dataType="edge"}),r.eachNode(function(e){var i=e.getLayout(),n=e.getModel(),r=n.get("localX"),a=n.get("localY"),c=n.getModel("emphasis"),h=new hs({shape:{x:null!=r?r*s:i.x,y:null!=a?a*l:i.y,width:i.dx,height:i.dy},style:n.getModel("itemStyle").getItemStyle(),z2:10});xc(h,bc(n),{labelFetcher:t,labelDataIndex:e.dataIndex,defaultText:e.id}),h.disableLabelAnimation=!0,h.setStyle("fill",e.getVisual("color")),h.setStyle("decal",e.getVisual("style").decal),gl(h,n),o.add(h),u.setItemGraphicEl(e.dataIndex,h),Ss(h).dataType="node";var p=c.get("focus");pl(h,"adjacency"===p?e.getAdjacentDataIndices():p,c.get("blurScope"))}),u.eachItemGraphicEl(function(e,r){u.getItemModel(r).get("draggable")&&(e.drift=function(e,o){n._focusAdjacencyDisabled=!0,this.shape.x+=e,this.shape.y+=o,this.dirty(),i.dispatchAction({type:"dragNode",seriesId:t.id,dataIndex:u.getRawIndex(r),localX:this.shape.x/s,localY:this.shape.y/l})},e.ondragend=function(){n._focusAdjacencyDisabled=!1},e.draggable=!0,e.cursor="move")}),!this._data&&t.isAnimationEnabled()&&o.setClipPath(function(t,e,i){var n=new hs({shape:{x:t.x-10,y:t.y-10,width:0,height:t.height+20}});return Nu(n,{shape:{width:t.width+20}},e,i),n}(o.getBoundingRect(),t,function(){o.removeClipPath()})),this._data=t.getData()},e.prototype.dispose=function(){},e.type="sankey",e}(Zf),TD=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.getInitialData=function(t,e){var i=t.edges||t.links,n=t.data||t.nodes,r=t.levels;this.levelModels=[];for(var o=this.levelModels,a=0;a<r.length;a++)null!=r[a].depth&&r[a].depth>=0&&(o[r[a].depth]=new $c(r[a],this,e));if(n&&i)return OA(n,i,this,!0,function(t,e){t.wrapMethod("getItemModel",function(t,e){var i=t.parentModel,n=i.getData().getItemLayout(e);if(n){var r=n.depth,o=i.levelModels[r];o&&(t.parentModel=o)}return t}),e.wrapMethod("getItemModel",function(t,e){var i=t.parentModel,n=i.getGraph().getEdgeByIndex(e).node1.getLayout();if(n){var r=n.depth,o=i.levelModels[r];o&&(t.parentModel=o)}return t})}).data},e.prototype.setNodePosition=function(t,e){var i=(this.option.data||this.option.nodes)[t];i.localX=e[0],i.localY=e[1]},e.prototype.getGraph=function(){return this.getData().graph},e.prototype.getEdgeData=function(){return this.getGraph().edgeData},e.prototype.formatTooltip=function(t,e,i){function n(t){return isNaN(t)||null==t}if("edge"===i){var r=this.getDataParams(t,i),o=r.data,a=r.value;return wf("nameValue",{name:o.source+" -- "+o.target,value:a,noValue:n(a)})}var s=this.getGraph().getNodeByIndex(t).getLayout().value,l=this.getDataParams(t,i).data.name;return wf("nameValue",{name:null!=l?l+"":null,value:s,noValue:n(s)})},e.prototype.optionUpdated=function(){},e.prototype.getDataParams=function(e,i){var n=t.prototype.getDataParams.call(this,e,i);if(null==n.value&&"node"===i){var r=this.getGraph().getNodeByIndex(e).getLayout().value;n.value=r}return n},e.type="series.sankey",e.defaultOption={zlevel:0,z:2,coordinateSystem:"view",left:"5%",top:"5%",right:"20%",bottom:"5%",orient:"horizontal",nodeWidth:20,nodeGap:8,draggable:!0,layoutIterations:32,label:{show:!0,position:"right",fontSize:12},levels:[],nodeAlign:"justify",lineStyle:{color:"#314656",opacity:.2,curveness:.5},emphasis:{label:{show:!0},lineStyle:{opacity:.5}},select:{itemStyle:{borderColor:"#212121"}},animationEasing:"linear",animationDuration:1e3},e}(Of);function MD(t,e){t.eachSeriesByType("sankey",function(t){var i=t.get("nodeWidth"),n=t.get("nodeGap"),r=function(t,e){return Xh(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}(t,e);t.layoutInfo=r;var o=r.width,a=r.height,s=t.getGraph(),l=s.nodes,u=s.edges;!function(t){L(t,function(t){var e=OD(t.outEdges,zD),i=OD(t.inEdges,zD),n=t.getValue()||0,r=Math.max(e,i,n);t.setLayout({value:r},!0)})}(l),function(t,e,i,n,r,o,a,s,l){(function(t,e,i,n,r,o,a){for(var s=[],l=[],u=[],c=[],h=0,p=0;p<e.length;p++)s[p]=1;for(p=0;p<t.length;p++)l[p]=t[p].inEdges.length,0===l[p]&&u.push(t[p]);for(var d=-1;u.length;){for(var f=0;f<u.length;f++){var m=u[f],g=m.hostGraph.data.getRawDataItem(m.dataIndex),y=null!=g.depth&&g.depth>=0;y&&g.depth>d&&(d=g.depth),m.setLayout({depth:y?g.depth:h},!0),"vertical"===o?m.setLayout({dy:i},!0):m.setLayout({dx:i},!0);for(var v=0;v<m.outEdges.length;v++){var _=m.outEdges[v];s[e.indexOf(_)]=0;var x=_.node2;0==--l[t.indexOf(x)]&&c.indexOf(x)<0&&c.push(x)}}++h,u=c,c=[]}for(p=0;p<s.length;p++)if(1===s[p])throw Error("Sankey is a DAG, the original data has cycle!");var b=d>h-1?d:h-1;a&&"left"!==a&&function(t,e,i,n){if("right"===e){for(var r=[],o=t,a=0;o.length;){for(var s=0;s<o.length;s++){var l=o[s];l.setLayout({skNodeHeight:a},!0);for(var u=0;u<l.inEdges.length;u++){var c=l.inEdges[u];r.indexOf(c.node1)<0&&r.push(c.node1)}}o=r,r=[],++a}L(t,function(t){ID(t)||t.setLayout({depth:Math.max(0,n-t.getLayout().skNodeHeight)},!0)})}else"justify"===e&&function(t,e){L(t,function(t){ID(t)||t.outEdges.length||t.setLayout({depth:e},!0)})}(t,n)}(t,a,0,b),function(t,e,i){L(t,function(t){var n=t.getLayout().depth*e;"vertical"===i?t.setLayout({y:n},!0):t.setLayout({x:n},!0)})}(t,"vertical"===o?(r-i)/b:(n-i)/b,o)})(t,e,i,r,o,s,l),function(t,e,i,n,r,o,a){var s=function(t,e){var i=[],n="vertical"===e?"y":"x",r=Gr(t,function(t){return t.getLayout()[n]});return r.keys.sort(function(t,e){return t-e}),L(r.keys,function(t){i.push(r.buckets.get(t))}),i}(t,a);(function(t,e,i,n,r,o){var a=1/0;L(t,function(t){var e=t.length,s=0;L(t,function(t){s+=t.getLayout().value});var l="vertical"===o?(n-(e-1)*r)/s:(i-(e-1)*r)/s;l<a&&(a=l)}),L(t,function(t){L(t,function(t,e){var i=t.getLayout().value*a;"vertical"===o?(t.setLayout({x:e},!0),t.setLayout({dx:i},!0)):(t.setLayout({y:e},!0),t.setLayout({dy:i},!0))})}),L(e,function(t){var e=+t.getValue()*a;t.setLayout({dy:e},!0)})})(s,e,i,n,r,a),CD(s,r,i,n,a);for(var l=1;o>0;o--)AD(s,l*=.99,a),CD(s,r,i,n,a),RD(s,l,a),CD(s,r,i,n,a)}(t,e,o,r,n,a,s),function(t,e){var i="vertical"===e?"x":"y";L(t,function(t){t.outEdges.sort(function(t,e){return t.node2.getLayout()[i]-e.node2.getLayout()[i]}),t.inEdges.sort(function(t,e){return t.node1.getLayout()[i]-e.node1.getLayout()[i]})}),L(t,function(t){var e=0,i=0;L(t.outEdges,function(t){t.setLayout({sy:e},!0),e+=t.getLayout().dy}),L(t.inEdges,function(t){t.setLayout({ty:i},!0),i+=t.getLayout().dy})})}(t,s)}(l,u,i,n,o,a,0!==R(l,function(t){return 0===t.getLayout().value}).length?0:t.get("layoutIterations"),t.get("orient"),t.get("nodeAlign"))})}function ID(t){var e=t.hostGraph.data.getRawDataItem(t.dataIndex);return null!=e.depth&&e.depth>=0}function CD(t,e,i,n,r){var o="vertical"===r?"x":"y";L(t,function(t){var a,s,l;t.sort(function(t,e){return t.getLayout()[o]-e.getLayout()[o]});for(var u=0,c=t.length,h="vertical"===r?"dx":"dy",p=0;p<c;p++)(l=u-(s=t[p]).getLayout()[o])>0&&(a=s.getLayout()[o]+l,"vertical"===r?s.setLayout({x:a},!0):s.setLayout({y:a},!0)),u=s.getLayout()[o]+s.getLayout()[h]+e;if((l=u-e-("vertical"===r?n:i))>0)for(a=s.getLayout()[o]-l,"vertical"===r?s.setLayout({x:a},!0):s.setLayout({y:a},!0),u=a,p=c-2;p>=0;--p)(l=(s=t[p]).getLayout()[o]+s.getLayout()[h]+e-u)>0&&(a=s.getLayout()[o]-l,"vertical"===r?s.setLayout({x:a},!0):s.setLayout({y:a},!0)),u=s.getLayout()[o]})}function AD(t,e,i){L(t.slice().reverse(),function(t){L(t,function(t){if(t.outEdges.length){var n=OD(t.outEdges,kD,i)/OD(t.outEdges,zD);if(isNaN(n)){var r=t.outEdges.length;n=r?OD(t.outEdges,DD,i)/r:0}if("vertical"===i){var o=t.getLayout().x+(n-LD(t,i))*e;t.setLayout({x:o},!0)}else{var a=t.getLayout().y+(n-LD(t,i))*e;t.setLayout({y:a},!0)}}})})}function kD(t,e){return LD(t.node2,e)*t.getValue()}function DD(t,e){return LD(t.node2,e)}function ED(t,e){return LD(t.node1,e)*t.getValue()}function PD(t,e){return LD(t.node1,e)}function LD(t,e){return"vertical"===e?t.getLayout().x+t.getLayout().dx/2:t.getLayout().y+t.getLayout().dy/2}function zD(t){return t.getValue()}function OD(t,e,i){for(var n=0,r=t.length,o=-1;++o<r;){var a=+e(t[o],i);isNaN(a)||(n+=a)}return n}function RD(t,e,i){L(t,function(t){L(t,function(t){if(t.inEdges.length){var n=OD(t.inEdges,ED,i)/OD(t.inEdges,zD);if(isNaN(n)){var r=t.inEdges.length;n=r?OD(t.inEdges,PD,i)/r:0}if("vertical"===i){var o=t.getLayout().x+(n-LD(t,i))*e;t.setLayout({x:o},!0)}else{var a=t.getLayout().y+(n-LD(t,i))*e;t.setLayout({y:a},!0)}}})})}function BD(t){t.eachSeriesByType("sankey",function(t){var e=t.getGraph().nodes;if(e.length){var i=1/0,n=-1/0;L(e,function(t){var e=t.getLayout().value;e<i&&(i=e),e>n&&(n=e)}),L(e,function(e){var r=new rC({type:"color",mappingMethod:"linear",dataExtent:[i,n],visual:t.get("color")}).mapValueToVisual(e.getLayout().value),o=e.getModel().get(["itemStyle","color"]);null!=o?(e.setVisual("color",o),e.setVisual("style",{fill:o})):(e.setVisual("color",r),e.setVisual("style",{fill:r}))})}})}var ND=function(){function t(){}return t.prototype.getInitialData=function(t,e){var i,n,r=e.getComponent("xAxis",this.get("xAxisIndex")),o=e.getComponent("yAxis",this.get("yAxisIndex")),a=r.get("type"),s=o.get("type");"category"===a?(t.layout="horizontal",i=r.getOrdinalMeta(),n=!0):"category"===s?(t.layout="vertical",i=o.getOrdinalMeta(),n=!0):t.layout=t.layout||"horizontal";var l=["x","y"],u="horizontal"===t.layout?0:1,c=this._baseAxisDim=l[u],h=l[1-u],p=[r,o],d=p[u].get("type"),f=p[1-u].get("type"),m=t.data;if(m&&n){var g=[];L(m,function(t,e){var i;U(t)?(i=t.slice(),t.unshift(e)):U(t.value)?((i=I({},t)).value=i.value.slice(),t.value.unshift(e)):i=t,g.push(i)}),t.data=g}var y=this.defaultValueDimensions,v=[{name:c,type:Gv(d),ordinalMeta:i,otherDims:{tooltip:!1,itemName:0},dimsDef:["base"]},{name:h,type:Gv(f),dimsDef:y.slice()}];return QS(this,{coordDimensions:v,dimensionsCount:y.length+1,encodeDefaulter:V(_p,v,this)})},t.prototype.getBaseAxis=function(){var t=this._baseAxisDim;return this.ecModel.getComponent(t+"Axis",this.get(t+"AxisIndex")).axis},t}(),FD=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.defaultValueDimensions=[{name:"min",defaultTooltip:!0},{name:"Q1",defaultTooltip:!0},{name:"median",defaultTooltip:!0},{name:"Q3",defaultTooltip:!0},{name:"max",defaultTooltip:!0}],i.visualDrawType="stroke",i}return i(e,t),e.type="series.boxplot",e.dependencies=["xAxis","yAxis","grid"],e.defaultOption={zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,boxWidth:[7,50],itemStyle:{color:"#fff",borderWidth:1},emphasis:{scale:!0,itemStyle:{borderWidth:2,shadowBlur:5,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0,0,0,0.2)"}},animationDuration:800},e}(Of);E(FD,ND,!0);var VD=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(t,e,i){var n=t.getData(),r=this.group,o=this._data;this._data||r.removeAll();var a="horizontal"===t.get("layout")?1:0;n.diff(o).add(function(t){if(n.hasValue(t)){var e=$D(n.getItemLayout(t),n,t,a,!0);n.setItemGraphicEl(t,e),r.add(e)}}).update(function(t,e){var i=o.getItemGraphicEl(e);if(n.hasValue(t)){var s=n.getItemLayout(t);i?($u(i),WD(s,i,n,t)):i=$D(s,n,t,a),r.add(i),n.setItemGraphicEl(t,i)}else r.remove(i)}).remove(function(t){var e=o.getItemGraphicEl(t);e&&r.remove(e)}).execute(),this._data=n},e.prototype.remove=function(t){var e=this.group,i=this._data;this._data=null,i&&i.eachItemGraphicEl(function(t){t&&e.remove(t)})},e.type="boxplot",e}(Zf),UD=function(){},GD=function(t){function e(e){var i=t.call(this,e)||this;return i.type="boxplotBoxPath",i}return i(e,t),e.prototype.getDefaultShape=function(){return new UD},e.prototype.buildPath=function(t,e){var i=e.points,n=0;for(t.moveTo(i[n][0],i[n][1]),n++;n<4;n++)t.lineTo(i[n][0],i[n][1]);for(t.closePath();n<i.length;n++)t.moveTo(i[n][0],i[n][1]),n++,t.lineTo(i[n][0],i[n][1])},e}(Qa);function $D(t,e,i,n,r){var o=t.ends,a=new GD({shape:{points:r?HD(o,n,t):o}});return WD(t,a,e,i,r),a}function WD(t,e,i,n,r){var o=i.hostModel;(0,gc[r?"initProps":"updateProps"])(e,{shape:{points:t.ends}},o,n),e.useStyle(i.getItemVisual(n,"style")),e.style.strokeNoScale=!0,e.z2=100;var a=i.getItemModel(n);gl(e,a),pl(e,a.get(["emphasis","focus"]),a.get(["emphasis","blurScope"]))}function HD(t,e,i){return z(t,function(t){return(t=t.slice())[e]=i.initBaseline,t})}function jD(t,e){}var ZD=L;function qD(t){var e=function(t){var e=[],i=[];return t.eachSeriesByType("boxplot",function(t){var n=t.getBaseAxis(),r=k(i,n);r<0&&(r=i.length,i[r]=n,e[r]={axis:n,seriesModels:[]}),e[r].seriesModels.push(t)}),e}(t);ZD(e,function(t){var e=t.seriesModels;e.length&&(function(t){var e,i,n=t.axis,r=t.seriesModels,o=r.length,a=t.boxWidthList=[],s=t.boxOffsetList=[],l=[];if("category"===n.type)i=n.getBandWidth();else{var u=0;ZD(r,function(t){u=Math.max(u,t.getData().count())}),(e=n.getExtent())[1],e[0]}ZD(r,function(t){var e=t.get("boxWidth");U(e)||(e=[e,e]),l.push([Xn(e[0],i)||0,Xn(e[1],i)||0])});var c=.8*i-2,h=c/o*.3,p=(c-h*(o-1))/o,d=p/2-c/2;ZD(r,function(t,e){s.push(d),d+=h+p,a.push(Math.min(Math.max(p,l[e][0]),l[e][1]))})}(t),ZD(e,function(e,i){!function(t,e,i){var n=t.coordinateSystem,r=t.getData(),o=i/2,a="horizontal"===t.get("layout")?0:1,s=1-a,l=["x","y"],u=r.mapDimension(l[a]),c=r.mapDimensionsAll(l[s]);if(!(null==u||c.length<5))for(var h=0;h<r.count();h++){var p=r.get(u,h),d=_(p,c[2],h),f=_(p,c[0],h),m=_(p,c[1],h),g=_(p,c[3],h),y=_(p,c[4],h),v=[];x(v,m,!1),x(v,g,!0),v.push(f,m,y,g),b(v,f),b(v,y),b(v,d),r.setItemLayout(h,{initBaseline:d[s],ends:v})}function _(t,i,o){var l,u=r.get(i,o),c=[];return c[a]=t,c[s]=u,isNaN(t)||isNaN(u)?l=[NaN,NaN]:(l=n.dataToPoint(c))[a]+=e,l}function x(t,e,i){var n=e.slice(),r=e.slice();n[a]+=o,r[a]-=o,i?t.push(n,r):t.push(r,n)}function b(t,e){var i=e.slice(),n=e.slice();i[a]-=o,n[a]+=o,t.push(i,n)}}(e,t.boxOffsetList[i],t.boxWidthList[i])}))})}var XD={type:"echarts:boxplot",transform:function(t){var e=t.upstream,i;e.sourceFormat!==lp&&_r("");var n=function(t,e){for(var i=[],n=[],r=(e=e||{}).boundIQR,o="none"===r||0===r,a=0;a<t.length;a++){var s=Kn(t[a].slice()),l=hr(s,.25),u=hr(s,.5),c=hr(s,.75),h=s[0],p=s[s.length-1],d=(null==r?1.5:r)*(c-l),f=o?h:Math.max(h,l-d),m=o?p:Math.min(p,c+d),g=e.itemNameFormatter,y=G(g)?g({value:a}):$(g)?g.replace("{value}",a+""):a+"";i.push([y,f,l,u,c,m]);for(var v=0;v<s.length;v++){var _=s[v];if(_<f||_>m){var x=[y,_];n.push(x)}}}return{boxData:i,outliers:n}}(e.getRawData(),t.config);return[{dimensions:["ItemName","Low","Q1","Q2","Q3","High"],data:n.boxData},{data:n.outliers}]}},YD=["color","borderColor"],KD=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(t,e,i){this.group.removeClipPath(),this._updateDrawMode(t),this._isLargeDraw?this._renderLarge(t):this._renderNormal(t)},e.prototype.incrementalPrepareRender=function(t,e,i){this._clear(),this._updateDrawMode(t)},e.prototype.incrementalRender=function(t,e,i,n){this._isLargeDraw?this._incrementalRenderLarge(t,e):this._incrementalRenderNormal(t,e)},e.prototype._updateDrawMode=function(t){var e=t.pipelineContext.large;null!=this._isLargeDraw&&e===this._isLargeDraw||(this._isLargeDraw=e,this._clear())},e.prototype._renderNormal=function(t){var e=t.getData(),i=this._data,n=this.group,r=e.getLayout("isSimpleBox"),o=t.get("clip",!0),a=t.coordinateSystem,s=a.getArea&&a.getArea();this._data||n.removeAll(),e.diff(i).add(function(i){if(e.hasValue(i)){var a=e.getItemLayout(i);if(o&&eE(s,a))return;var l=tE(a,i,!0);Nu(l,{shape:{points:a.ends}},t,i),iE(l,e,i,r),n.add(l),e.setItemGraphicEl(i,l)}}).update(function(a,l){var u=i.getItemGraphicEl(l);if(e.hasValue(a)){var c=e.getItemLayout(a);o&&eE(s,c)?n.remove(u):(u?(Bu(u,{shape:{points:c.ends}},t,a),$u(u)):u=tE(c),iE(u,e,a,r),n.add(u),e.setItemGraphicEl(a,u))}else n.remove(u)}).remove(function(t){var e=i.getItemGraphicEl(t);e&&n.remove(e)}).execute(),this._data=e},e.prototype._renderLarge=function(t){this._clear(),aE(t,this.group);var e=t.get("clip",!0)?Jw(t.coordinateSystem,!1,t):null;e?this.group.setClipPath(e):this.group.removeClipPath()},e.prototype._incrementalRenderNormal=function(t,e){for(var i,n=e.getData(),r=n.getLayout("isSimpleBox");null!=(i=t.next());){var o=tE(n.getItemLayout(i));iE(o,n,i,r),o.incremental=!0,this.group.add(o)}},e.prototype._incrementalRenderLarge=function(t,e){aE(e,this.group,!0)},e.prototype.remove=function(t){this._clear()},e.prototype._clear=function(){this.group.removeAll(),this._data=null},e.type="candlestick",e}(Zf),JD=function(){},QD=function(t){function e(e){var i=t.call(this,e)||this;return i.type="normalCandlestickBox",i}return i(e,t),e.prototype.getDefaultShape=function(){return new JD},e.prototype.buildPath=function(t,e){var i=e.points;this.__simpleBox?(t.moveTo(i[4][0],i[4][1]),t.lineTo(i[6][0],i[6][1])):(t.moveTo(i[0][0],i[0][1]),t.lineTo(i[1][0],i[1][1]),t.lineTo(i[2][0],i[2][1]),t.lineTo(i[3][0],i[3][1]),t.closePath(),t.moveTo(i[4][0],i[4][1]),t.lineTo(i[5][0],i[5][1]),t.moveTo(i[6][0],i[6][1]),t.lineTo(i[7][0],i[7][1]))},e}(Qa);function tE(t,e,i){var n=t.ends;return new QD({shape:{points:i?nE(n,t):n},z2:100})}function eE(t,e){for(var i=!0,n=0;n<e.ends.length;n++)if(t.contain(e.ends[n][0],e.ends[n][1])){i=!1;break}return i}function iE(t,e,i,n){var r=e.getItemModel(i);t.useStyle(e.getItemVisual(i,"style")),t.style.strokeNoScale=!0,t.__simpleBox=n,gl(t,r)}function nE(t,e){return z(t,function(t){return(t=t.slice())[1]=e.initBaseline,t})}var rE=function(){},oE=function(t){function e(e){var i=t.call(this,e)||this;return i.type="largeCandlestickBox",i}return i(e,t),e.prototype.getDefaultShape=function(){return new rE},e.prototype.buildPath=function(t,e){for(var i=e.points,n=0;n<i.length;)if(this.__sign===i[n++]){var r=i[n++];t.moveTo(r,i[n++]),t.lineTo(r,i[n++])}else n+=3},e}(Qa);function aE(t,e,i){var n=t.getData().getLayout("largePoints"),r=new oE({shape:{points:n},__sign:1});e.add(r);var o=new oE({shape:{points:n},__sign:-1});e.add(o),sE(1,r,t),sE(-1,o,t),i&&(r.incremental=!0,o.incremental=!0)}function sE(t,e,i,n){var r=i.get(["itemStyle",t>0?"borderColor":"borderColor0"])||i.get(["itemStyle",t>0?"color":"color0"]),o=i.getModel("itemStyle").getItemStyle(YD);e.useStyle(o),e.style.fill=null,e.style.stroke=r}var lE=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.defaultValueDimensions=[{name:"open",defaultTooltip:!0},{name:"close",defaultTooltip:!0},{name:"lowest",defaultTooltip:!0},{name:"highest",defaultTooltip:!0}],i}return i(e,t),e.prototype.getShadowDim=function(){return"open"},e.prototype.brushSelector=function(t,e,i){var n=e.getItemLayout(t);return n&&i.rect(n.brushRect)},e.type="series.candlestick",e.dependencies=["xAxis","yAxis","grid"],e.defaultOption={zlevel:0,z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,clip:!0,itemStyle:{color:"#eb5454",color0:"#47b262",borderColor:"#eb5454",borderColor0:"#47b262",borderWidth:1},emphasis:{scale:!0,itemStyle:{borderWidth:2}},barMaxWidth:null,barMinWidth:null,barWidth:null,large:!0,largeThreshold:600,progressive:3e3,progressiveThreshold:1e4,progressiveChunkMode:"mod",animationEasing:"linear",animationDuration:300},e}(Of);function uE(t){t&&U(t.series)&&L(t.series,function(t){j(t)&&"k"===t.type&&(t.type="candlestick")})}E(lE,ND,!0);var cE=["itemStyle","borderColor"],hE=["itemStyle","borderColor0"],pE=["itemStyle","color"],dE=["itemStyle","color0"],fE={seriesType:"candlestick",plan:Wf(),performRawSeries:!0,reset:function(t,e){function i(t,e){return e.get(t>0?pE:dE)}function n(t,e){return e.get(t>0?cE:hE)}if(!e.isSeriesFiltered(t))return!t.pipelineContext.large&&{progress:function(t,e){for(var r;null!=(r=t.next());){var o=e.getItemModel(r),a=e.getItemLayout(r).sign,s=o.getItemStyle();s.fill=i(a,o),s.stroke=n(a,o)||s.fill,I(e.ensureUniqueItemVisual(r,"style"),s)}}}}},mE="undefined"!=typeof Float32Array?Float32Array:Array,gE={seriesType:"candlestick",plan:Wf(),reset:function(t){var e=t.coordinateSystem,i=t.getData(),n=function(t,e){var i,n=t.getBaseAxis(),r="category"===n.type?n.getBandWidth():(i=n.getExtent(),Math.abs(i[1]-i[0])/e.count()),o=Xn(et(t.get("barMaxWidth"),r),r),a=Xn(et(t.get("barMinWidth"),1),r),s=t.get("barWidth");return null!=s?Xn(s,r):Math.max(Math.min(r/2,o),a)}(t,i),r=["x","y"],o=i.getDimensionIndex(i.mapDimension("x")),a=z(i.mapDimensionsAll("y"),i.getDimensionIndex,i),s=a[0],l=a[1],u=a[2],c=a[3];if(i.setLayout({candleWidth:n,isSimpleBox:n<=1.3}),!(o<0||a.length<4))return{progress:t.pipelineContext.large?function(t,i){for(var n,r,a=new mE(4*t.count),h=0,p=[],d=[],f=i.getStore();null!=(r=t.next());){var m=f.get(o,r),g=f.get(s,r),y=f.get(l,r),v=f.get(u,r),_=f.get(c,r);isNaN(m)||isNaN(v)||isNaN(_)?(a[h++]=NaN,h+=3):(a[h++]=yE(f,r,g,y,l),p[0]=m,p[1]=v,n=e.dataToPoint(p,null,d),a[h++]=n?n[0]:NaN,a[h++]=n?n[1]:NaN,p[1]=_,n=e.dataToPoint(p,null,d),a[h++]=n?n[1]:NaN)}i.setLayout("largePoints",a)}:function(t,i){for(var r,a=i.getStore();null!=(r=t.next());){var h=a.get(o,r),p=a.get(s,r),d=a.get(l,r),f=a.get(u,r),m=a.get(c,r),g=Math.min(p,d),y=Math.max(p,d),v=S(g,h),_=S(y,h),x=S(f,h),b=S(m,h),w=[];T(w,_,0),T(w,v,1),w.push(I(b),I(_),I(x),I(v)),i.setItemLayout(r,{sign:yE(a,r,p,d,l),initBaseline:p>d?_[1]:v[1],ends:w,brushRect:M(f,m,h)})}function S(t,i){var n=[];return n[0]=i,n[1]=t,isNaN(i)||isNaN(t)?[NaN,NaN]:e.dataToPoint(n)}function T(t,e,i){var r=e.slice(),o=e.slice();r[0]=nc(r[0]+n/2,1,!1),o[0]=nc(o[0]-n/2,1,!0),i?t.push(r,o):t.push(o,r)}function M(t,e,i){var r=S(t,i),o=S(e,i);return r[0]-=n/2,o[0]-=n/2,{x:r[0],y:r[1],width:n,height:o[1]-r[1]}}function I(t){return t[0]=nc(t[0],1),t}}}}};function yE(t,e,i,n,r){return i>n?-1:i<n?1:e>0?t.get(r,e-1)<=n?1:-1:1}function vE(t,e){var i=e.rippleEffectColor||e.color;t.eachChild(function(t){t.attr({z:e.z,zlevel:e.zlevel,style:{stroke:"stroke"===e.brushType?i:null,fill:"fill"===e.brushType?i:null}})})}var _E=function(t){function e(e,i){var n=t.call(this)||this,r=new Ew(e,i),o=new Fn;return n.add(r),n.add(o),n.updateData(e,i),n}return i(e,t),e.prototype.stopEffectAnimation=function(){this.childAt(1).removeAll()},e.prototype.startEffectAnimation=function(t){for(var e=t.symbolType,i=t.color,n=t.rippleNumber,r=this.childAt(1),o=0;o<n;o++){var a=eg(e,-1,-1,2,2,i);a.attr({style:{strokeNoScale:!0},z2:99,silent:!0,scaleX:.5,scaleY:.5});var s=-o/n*t.period+t.effectOffset;a.animate("",!0).when(t.period,{scaleX:t.rippleScale/2,scaleY:t.rippleScale/2}).delay(s).start(),a.animateStyle(!0).when(t.period,{opacity:0}).delay(s).start(),r.add(a)}vE(r,t)},e.prototype.updateEffectAnimation=function(t){for(var e=this._effectCfg,i=this.childAt(1),n=["symbolType","period","rippleScale","rippleNumber"],r=0;r<n.length;r++){var o=n[r];if(e[o]!==t[o])return this.stopEffectAnimation(),void this.startEffectAnimation(t)}vE(i,t)},e.prototype.highlight=function(){Qs(this)},e.prototype.downplay=function(){tl(this)},e.prototype.getSymbolType=function(){var t=this.childAt(0);return t&&t.getSymbolType()},e.prototype.updateData=function(t,e){var i=this,n=t.hostModel;this.childAt(0).updateData(t,e);var r=this.childAt(1),o=t.getItemModel(e),a=t.getItemVisual(e,"symbol"),s=ig(t.getItemVisual(e,"symbolSize")),l=t.getItemVisual(e,"style"),u=l&&l.fill;r.setScale(s),r.traverse(function(t){t.setStyle("fill",u)});var c=ng(t.getItemVisual(e,"symbolOffset"),s);c&&(r.x=c[0],r.y=c[1]);var h=t.getItemVisual(e,"symbolRotate");r.rotation=(h||0)*Math.PI/180||0;var p={};p.showEffectOn=n.get("showEffectOn"),p.rippleScale=o.get(["rippleEffect","scale"]),p.brushType=o.get(["rippleEffect","brushType"]),p.period=1e3*o.get(["rippleEffect","period"]),p.effectOffset=e/t.count(),p.z=n.getShallow("z")||0,p.zlevel=n.getShallow("zlevel")||0,p.symbolType=a,p.color=u,p.rippleEffectColor=o.get(["rippleEffect","color"]),p.rippleNumber=o.get(["rippleEffect","number"]),this.off("mouseover").off("mouseout").off("emphasis").off("normal"),"render"===p.showEffectOn?(this._effectCfg?this.updateEffectAnimation(p):this.startEffectAnimation(p),this._effectCfg=p):(this._effectCfg=null,this.stopEffectAnimation(),this.onHoverStateChange=function(t){"emphasis"===t?"render"!==p.showEffectOn&&i.startEffectAnimation(p):"normal"===t&&"render"!==p.showEffectOn&&i.stopEffectAnimation()}),this._effectCfg=p,pl(this)},e.prototype.fadeOut=function(t){this.off("mouseover").off("mouseout"),t&&t()},e}(Fn),xE=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.init=function(){this._symbolDraw=new Rw(_E)},e.prototype.render=function(t,e,i){var n=t.getData(),r=this._symbolDraw;r.updateData(n,{clipShape:this._getClipShape(t)}),this.group.add(r.group)},e.prototype._getClipShape=function(t){var e=t.coordinateSystem,i=e&&e.getArea&&e.getArea();return t.get("clip",!0)?i:null},e.prototype.updateTransform=function(t,e,i){var n=t.getData();this.group.dirty();var r=hS("").reset(t,e,i);r.progress&&r.progress({start:0,end:n.count(),count:n.count()},n),this._symbolDraw.updateLayout()},e.prototype._updateGroupTransform=function(t){var e=t.coordinateSystem;e&&e.getRoamTransform&&(this.group.transform=qi(e.getRoamTransform()),this.group.decomposeTransform())},e.prototype.remove=function(t,e){this._symbolDraw&&this._symbolDraw.remove(!0)},e.type="effectScatter",e}(Zf),bE=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.hasSymbolVisual=!0,i}return i(e,t),e.prototype.getInitialData=function(t,e){return v_(null,this,{useEncodeDefaulter:!0})},e.prototype.brushSelector=function(t,e,i){return i.point(e.getItemLayout(t))},e.type="series.effectScatter",e.dependencies=["grid","polar"],e.defaultOption={coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,effectType:"ripple",progressive:0,showEffectOn:"render",clip:!0,rippleEffect:{period:4,scale:2.5,brushType:"fill",number:3},universalTransition:{divideShape:"clone"},symbolSize:10},e}(Of),wE=function(t){function e(e,i,n){var r=t.call(this)||this;return r.add(r.createLine(e,i,n)),r._updateEffectSymbol(e,i),r}return i(e,t),e.prototype.createLine=function(t,e,i){return new mA(t,e,i)},e.prototype._updateEffectSymbol=function(t,e){var i=t.getItemModel(e).getModel("effect"),n=i.get("symbolSize"),r=i.get("symbol");U(n)||(n=[n,n]);var o=t.getItemVisual(e,"style"),a=i.get("color")||o&&o.stroke,s=this.childAt(1);this._symbolType!==r&&(this.remove(s),(s=eg(r,-.5,-.5,1,1,a)).z2=100,s.culling=!0,this.add(s)),s&&(s.setStyle("shadowColor",a),s.setStyle(i.getItemStyle(["color"])),s.scaleX=n[0],s.scaleY=n[1],s.setColor(a),this._symbolType=r,this._symbolScale=n,this._updateEffectAnimation(t,i,e))},e.prototype._updateEffectAnimation=function(t,e,i){var n=this.childAt(1);if(n){var r=this,o=t.getItemLayout(i),a=1e3*e.get("period"),s=e.get("loop"),l=e.get("constantSpeed"),u=tt(e.get("delay"),function(e){return e/t.count()*a/3});if(n.ignore=!0,this._updateAnimationPoints(n,o),l>0&&(a=this._getLineLength(n)/l*1e3),(a!==this._period||s!==this._loop)&&(n.stopAnimation(),a>0)){var c=void 0;c="function"==typeof u?u(i):u,n.__t>0&&(c=-a*n.__t),n.__t=0;var h=n.animate("",s).when(a,{__t:1}).delay(c).during(function(){r._updateSymbolPosition(n)});s||h.done(function(){r.remove(n)}),h.start()}this._period=a,this._loop=s}},e.prototype._getLineLength=function(t){return Et(t.__p1,t.__cp1)+Et(t.__cp1,t.__p2)},e.prototype._updateAnimationPoints=function(t,e){t.__p1=e[0],t.__p2=e[1],t.__cp1=e[2]||[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]},e.prototype.updateData=function(t,e,i){this.childAt(0).updateData(t,e,i),this._updateEffectSymbol(t,e)},e.prototype._updateSymbolPosition=function(t){var e=t.__p1,i=t.__p2,n=t.__cp1,r=t.__t,o=[t.x,t.y],a=o.slice(),s=Zo,l=qo;o[0]=s(e[0],n[0],i[0],r),o[1]=s(e[1],n[1],i[1],r);var u=l(e[0],n[0],i[0],r),c=l(e[1],n[1],i[1],r);t.rotation=-Math.atan2(c,u)-Math.PI/2,"line"!==this._symbolType&&"rect"!==this._symbolType&&"roundRect"!==this._symbolType||(void 0!==t.__lastT&&t.__lastT<t.__t?(t.scaleY=1.05*Et(a,o),1===r&&(o[0]=a[0]+(o[0]-a[0])/2,o[1]=a[1]+(o[1]-a[1])/2)):1===t.__lastT?t.scaleY=2*Et(e,o):t.scaleY=this._symbolScale[1]),t.__lastT=t.__t,t.ignore=!1,t.x=o[0],t.y=o[1]},e.prototype.updateLayout=function(t,e){this.childAt(0).updateLayout(t,e);var i=t.getItemModel(e).getModel("effect");this._updateEffectAnimation(t,i,e)},e}(Fn),SE=function(t){function e(e,i,n){var r=t.call(this)||this;return r._createPolyline(e,i,n),r}return i(e,t),e.prototype._createPolyline=function(t,e,i){var n=t.getItemLayout(e),r=new du({shape:{points:n}});this.add(r),this._updateCommonStl(t,e,i)},e.prototype.updateData=function(t,e,i){var n=t.hostModel;Bu(this.childAt(0),{shape:{points:t.getItemLayout(e)}},n,e),this._updateCommonStl(t,e,i)},e.prototype._updateCommonStl=function(t,e,i){var n=this.childAt(0),r=t.getItemModel(e),o=i&&i.emphasisLineStyle;i&&!t.hasItemOption||(o=r.getModel(["emphasis","lineStyle"]).getLineStyle()),n.useStyle(t.getItemVisual(e,"style")),n.style.fill=null,n.style.strokeNoScale=!0,n.ensureState("emphasis").style=o,pl(this)},e.prototype.updateLayout=function(t,e){this.childAt(0).setShape("points",t.getItemLayout(e))},e}(Fn),TE=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._lastFrame=0,e._lastFramePercent=0,e}return i(e,t),e.prototype.createLine=function(t,e,i){return new SE(t,e,i)},e.prototype._updateAnimationPoints=function(t,e){this._points=e;for(var i=[0],n=0,r=1;r<e.length;r++){var o=e[r-1],a=e[r];n+=Et(o,a),i.push(n)}if(0!==n){for(r=0;r<i.length;r++)i[r]/=n;this._offsets=i,this._length=n}else this._length=0},e.prototype._getLineLength=function(){return this._length},e.prototype._updateSymbolPosition=function(t){var e=t.__t,i=this._points,n=this._offsets,r=i.length;if(n){var o,a=this._lastFrame;if(e<this._lastFramePercent){for(o=Math.min(a+1,r-1);o>=0&&!(n[o]<=e);o--);o=Math.min(o,r-2)}else{for(o=a;o<r&&!(n[o]>e);o++);o=Math.min(o-1,r-2)}var s=(e-n[o])/(n[o+1]-n[o]),l=i[o],u=i[o+1];t.x=l[0]*(1-s)+s*u[0],t.y=l[1]*(1-s)+s*u[1];var c=u[0]-l[0],h=u[1]-l[1];t.rotation=-Math.atan2(h,c)-Math.PI/2,this._lastFrame=o,this._lastFramePercent=e,t.ignore=!1}},e}(wE),ME=function(){this.polyline=!1,this.curveness=0,this.segs=[]},IE=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new ME},e.prototype.buildPath=function(t,e){var i=e.segs,n=e.curveness;if(e.polyline)for(var r=0;r<i.length;){var o=i[r++];if(o>0){t.moveTo(i[r++],i[r++]);for(var a=1;a<o;a++)t.lineTo(i[r++],i[r++])}}else for(r=0;r<i.length;){var s=i[r++],l=i[r++],u=i[r++],c=i[r++];if(t.moveTo(s,l),n>0){var h=(s+u)/2-(l-c)*n,p=(l+c)/2-(u-s)*n;t.quadraticCurveTo(h,p,u,c)}else t.lineTo(u,c)}},e.prototype.findDataIndex=function(t,e){var i=this.shape,n=i.segs,r=i.curveness,o=this.style.lineWidth;if(i.polyline)for(var a=0,s=0;s<n.length;){var l=n[s++];if(l>0)for(var u=n[s++],c=n[s++],h=1;h<l;h++)if(za(u,c,p=n[s++],d=n[s++],o,t,e))return a;a++}else for(a=0,s=0;s<n.length;){u=n[s++],c=n[s++];var p=n[s++],d=n[s++];if(r>0){if(Ra(u,c,(u+p)/2-(c-d)*r,(c+d)/2-(p-u)*r,p,d,o,t,e))return a}else if(za(u,c,p,d,o,t,e))return a;a++}return-1},e}(Qa),CE=function(){function t(){this.group=new Fn}return t.prototype.isPersistent=function(){return!this._incremental},t.prototype.updateData=function(t){this.group.removeAll();var e=new IE({rectHover:!0,cursor:"default"});e.setShape({segs:t.getLayout("linesPoints")}),this._setCommon(e,t),this.group.add(e),this._incremental=null},t.prototype.incrementalPrepareUpdate=function(t){this.group.removeAll(),this._clearIncremental(),t.count()>5e5?(this._incremental||(this._incremental=new Lu({silent:!0})),this.group.add(this._incremental)):this._incremental=null},t.prototype.incrementalUpdate=function(t,e){var i=new IE;i.setShape({segs:e.getLayout("linesPoints")}),this._setCommon(i,e,!!this._incremental),this._incremental?this._incremental.addDisplayable(i,!0):(i.rectHover=!0,i.cursor="default",i.__startIndex=t.start,this.group.add(i))},t.prototype.remove=function(){this._clearIncremental(),this._incremental=null,this.group.removeAll()},t.prototype._setCommon=function(t,e,i){var n=e.hostModel;t.setShape({polyline:n.get("polyline"),curveness:n.get(["lineStyle","curveness"])}),t.useStyle(n.getModel("lineStyle").getLineStyle()),t.style.strokeNoScale=!0;var r=e.getVisual("style");if(r&&r.stroke&&t.setStyle("stroke",r.stroke),t.setStyle("fill",null),!i){var o=Ss(t);o.seriesIndex=n.seriesIndex,t.on("mousemove",function(e){o.dataIndex=null;var i=t.findDataIndex(e.offsetX,e.offsetY);i>0&&(o.dataIndex=i+t.__startIndex)})}},t.prototype._clearIncremental=function(){var t=this._incremental;t&&t.clearDisplaybles()},t}(),AE={seriesType:"lines",plan:Wf(),reset:function(t){var e=t.coordinateSystem,i=t.get("polyline"),n=t.pipelineContext.large;return{progress:function(r,o){var a=[];if(n){var s=void 0,l=r.end-r.start;if(i){for(var u=0,c=r.start;c<r.end;c++)u+=t.getLineCoordsCount(c);s=new Float32Array(l+2*u)}else s=new Float32Array(4*l);var h=0,p=[];for(c=r.start;c<r.end;c++){var d=t.getLineCoords(c,a);i&&(s[h++]=d);for(var f=0;f<d;f++)p=e.dataToPoint(a[f],!1,p),s[h++]=p[0],s[h++]=p[1]}o.setLayout("linesPoints",s)}else for(c=r.start;c<r.end;c++){var m=o.getItemModel(c),g=(d=t.getLineCoords(c,a),[]);if(i)for(var y=0;y<d;y++)g.push(e.dataToPoint(a[y]));else{g[0]=e.dataToPoint(a[0]),g[1]=e.dataToPoint(a[1]);var v=m.get(["lineStyle","curveness"]);+v&&(g[2]=[(g[0][0]+g[1][0])/2-(g[0][1]-g[1][1])*v,(g[0][1]+g[1][1])/2-(g[1][0]-g[0][0])*v])}o.setItemLayout(c,g)}}}}},kE=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(t,e,i){var n=t.getData(),r=this._updateLineDraw(n,t),o=t.get("zlevel"),a=t.get(["effect","trailLength"]),s=i.getZr(),l="svg"===s.painter.getType();l||s.painter.getLayer(o).clear(!0),null==this._lastZlevel||l||s.configLayer(this._lastZlevel,{motionBlur:!1}),this._showEffect(t)&&a&&(l||s.configLayer(o,{motionBlur:!0,lastFrameAlpha:Math.max(Math.min(a/10+.9,1),0)})),r.updateData(n);var u=t.get("clip",!0)&&Jw(t.coordinateSystem,!1,t);u?this.group.setClipPath(u):this.group.removeClipPath(),this._lastZlevel=o,this._finished=!0},e.prototype.incrementalPrepareRender=function(t,e,i){var n=t.getData();this._updateLineDraw(n,t).incrementalPrepareUpdate(n),this._clearLayer(i),this._finished=!1},e.prototype.incrementalRender=function(t,e,i){this._lineDraw.incrementalUpdate(t,e.getData()),this._finished=t.end===e.getData().count()},e.prototype.updateTransform=function(t,e,i){var n=t.getData(),r=t.pipelineContext;if(!this._finished||r.large||r.progressiveRender)return{update:!0};var o=AE.reset(t,e,i);o.progress&&o.progress({start:0,end:n.count(),count:n.count()},n),this._lineDraw.updateLayout(),this._clearLayer(i)},e.prototype._updateLineDraw=function(t,e){var i=this._lineDraw,n=this._showEffect(e),r=!!e.get("polyline"),o=e.pipelineContext.large;return i&&n===this._hasEffet&&r===this._isPolyline&&o===this._isLargeDraw||(i&&i.remove(),i=this._lineDraw=o?new CE:new gA(r?n?TE:SE:n?wE:mA),this._hasEffet=n,this._isPolyline=r,this._isLargeDraw=o),this.group.add(i.group),i},e.prototype._showEffect=function(t){return!!t.get(["effect","show"])},e.prototype._clearLayer=function(t){var e=t.getZr();"svg"===e.painter.getType()||null==this._lastZlevel||e.painter.getLayer(this._lastZlevel).clear(!0)},e.prototype.remove=function(t,e){this._lineDraw&&this._lineDraw.remove(),this._lineDraw=null,this._clearLayer(e)},e.prototype.dispose=function(t,e){this.remove(t,e)},e.type="lines",e}(Zf),DE="undefined"==typeof Uint32Array?Array:Uint32Array,EE="undefined"==typeof Float64Array?Array:Float64Array;function PE(t){var e=t.data;e&&e[0]&&e[0][0]&&e[0][0].coord&&(t.data=z(e,function(t){var e={coords:[t[0].coord,t[1].coord]};return t[0].name&&(e.fromName=t[0].name),t[1].name&&(e.toName=t[1].name),M([e,t[0],t[1]])}))}var LE=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.visualStyleAccessPath="lineStyle",i.visualDrawType="stroke",i}return i(e,t),e.prototype.init=function(e){e.data=e.data||[],PE(e);var i=this._processFlatCoordsArray(e.data);this._flatCoords=i.flatCoords,this._flatCoordsOffset=i.flatCoordsOffset,i.flatCoords&&(e.data=new Float32Array(i.count)),t.prototype.init.apply(this,arguments)},e.prototype.mergeOption=function(e){if(PE(e),e.data){var i=this._processFlatCoordsArray(e.data);this._flatCoords=i.flatCoords,this._flatCoordsOffset=i.flatCoordsOffset,i.flatCoords&&(e.data=new Float32Array(i.count))}t.prototype.mergeOption.apply(this,arguments)},e.prototype.appendData=function(t){var e=this._processFlatCoordsArray(t.data);e.flatCoords&&(this._flatCoords?(this._flatCoords=pt(this._flatCoords,e.flatCoords),this._flatCoordsOffset=pt(this._flatCoordsOffset,e.flatCoordsOffset)):(this._flatCoords=e.flatCoords,this._flatCoordsOffset=e.flatCoordsOffset),t.data=new Float32Array(e.count)),this.getRawData().appendData(t.data)},e.prototype._getCoordsFromItemModel=function(t){var e=this.getData().getItemModel(t),i;return e.option instanceof Array?e.option:e.getShallow("coords")},e.prototype.getLineCoordsCount=function(t){return this._flatCoordsOffset?this._flatCoordsOffset[2*t+1]:this._getCoordsFromItemModel(t).length},e.prototype.getLineCoords=function(t,e){if(this._flatCoordsOffset){for(var i=this._flatCoordsOffset[2*t],n=this._flatCoordsOffset[2*t+1],r=0;r<n;r++)e[r]=e[r]||[],e[r][0]=this._flatCoords[i+2*r],e[r][1]=this._flatCoords[i+2*r+1];return n}var o=this._getCoordsFromItemModel(t);for(r=0;r<o.length;r++)e[r]=e[r]||[],e[r][0]=o[r][0],e[r][1]=o[r][1];return o.length},e.prototype._processFlatCoordsArray=function(t){var e=0;if(this._flatCoords&&(e=this._flatCoords.length),"number"==typeof t[0]){for(var i=t.length,n=new DE(i),r=new EE(i),o=0,a=0,s=0,l=0;l<i;){s++;var u=t[l++];n[a++]=o+e,n[a++]=u;for(var c=0;c<u;c++){var h=t[l++],p=t[l++];r[o++]=h,r[o++]=p}}return{flatCoordsOffset:new Uint32Array(n.buffer,0,a),flatCoords:r,count:s}}return{flatCoordsOffset:null,flatCoords:null,count:t.length}},e.prototype.getInitialData=function(t,e){var i=new u_(["value"],this);return i.hasItemOption=!1,i.initData(t.data,[],function(t,e,n,r){if(t instanceof Array)return NaN;i.hasItemOption=!0;var o=t.value;return null!=o?o instanceof Array?o[r]:o:void 0}),i},e.prototype.formatTooltip=function(t,e,i){var n=this.getData().getItemModel(t),r=n.get("name");if(r)return r;var o=n.get("fromName"),a=n.get("toName"),s=[];return null!=o&&s.push(o),null!=a&&s.push(a),wf("nameValue",{name:s.join(" > ")})},e.prototype.preventIncremental=function(){return!!this.get(["effect","show"])},e.prototype.getProgressive=function(){var t=this.option.progressive;return null==t?this.option.large?1e4:this.get("progressive"):t},e.prototype.getProgressiveThreshold=function(){var t=this.option.progressiveThreshold;return null==t?this.option.large?2e4:this.get("progressiveThreshold"):t},e.type="series.lines",e.dependencies=["grid","polar","geo","calendar"],e.defaultOption={coordinateSystem:"geo",zlevel:0,z:2,legendHoverLink:!0,xAxisIndex:0,yAxisIndex:0,symbol:["none","none"],symbolSize:[10,10],geoIndex:0,effect:{show:!1,period:4,constantSpeed:0,symbol:"circle",symbolSize:3,loop:!0,trailLength:.2},large:!1,largeThreshold:2e3,polyline:!1,clip:!0,label:{show:!1,position:"end"},lineStyle:{opacity:.5}},e}(Of);function zE(t){return t instanceof Array||(t=[t,t]),t}var OE={seriesType:"lines",reset:function(t){var e=zE(t.get("symbol")),i=zE(t.get("symbolSize")),n=t.getData();return n.setVisual("fromSymbol",e&&e[0]),n.setVisual("toSymbol",e&&e[1]),n.setVisual("fromSymbolSize",i&&i[0]),n.setVisual("toSymbolSize",i&&i[1]),{dataEach:n.hasItemOption?function(t,e){var i=t.getItemModel(e),n=zE(i.getShallow("symbol",!0)),r=zE(i.getShallow("symbolSize",!0));n[0]&&t.setItemVisual(e,"fromSymbol",n[0]),n[1]&&t.setItemVisual(e,"toSymbol",n[1]),r[0]&&t.setItemVisual(e,"fromSymbolSize",r[0]),r[1]&&t.setItemVisual(e,"toSymbolSize",r[1])}:null}}},RE=function(){function t(){this.blurSize=30,this.pointSize=20,this.maxOpacity=1,this.minOpacity=0,this._gradientPixels={inRange:null,outOfRange:null};var t=A();this.canvas=t}return t.prototype.update=function(t,e,i,n,r,o){var a=this._getBrush(),s=this._getGradient(r,"inRange"),l=this._getGradient(r,"outOfRange"),u=this.pointSize+this.blurSize,c=this.canvas,h=c.getContext("2d"),p=t.length;c.width=e,c.height=i;for(var d=0;d<p;++d){var f=t[d],m=f[0],g=f[1],y=n(f[2]);h.globalAlpha=y,h.drawImage(a,m-u,g-u)}if(!c.width||!c.height)return c;for(var v=h.getImageData(0,0,c.width,c.height),_=v.data,x=0,b=_.length,w=this.minOpacity,S=this.maxOpacity-w;x<b;){y=_[x+3]/256;var T=4*Math.floor(255*y);if(y>0){var M=o(y)?s:l;y>0&&(y=y*S+w),_[x++]=M[T],_[x++]=M[T+1],_[x++]=M[T+2],_[x++]=M[T+3]*y*256}else x+=4}return h.putImageData(v,0,0),c},t.prototype._getBrush=function(){var t=this._brushCanvas||(this._brushCanvas=A()),e=this.pointSize+this.blurSize,i=2*e;t.width=i,t.height=i;var n=t.getContext("2d");return n.clearRect(0,0,i,i),n.shadowOffsetX=i,n.shadowBlur=this.blurSize,n.shadowColor="#000",n.beginPath(),n.arc(-e,e,this.pointSize,0,2*Math.PI,!0),n.closePath(),n.fill(),t},t.prototype._getGradient=function(t,e){for(var i=this._gradientPixels,n=i[e]||(i[e]=new Uint8ClampedArray(1024)),r=[0,0,0,0],o=0,a=0;a<256;a++)t[e](a/255,!0,r),n[o++]=r[0],n[o++]=r[1],n[o++]=r[2],n[o++]=r[3];return n},t}();function BE(t){var e=t.dimensions;return"lng"===e[0]&&"lat"===e[1]}var NE=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(t,e,i){var n;e.eachComponent("visualMap",function(e){e.eachTargetSeries(function(i){i===t&&(n=e)})}),this.group.removeAll(),this._incrementalDisplayable=null;var r=t.coordinateSystem;"cartesian2d"===r.type||"calendar"===r.type?this._renderOnCartesianAndCalendar(t,i,0,t.getData().count()):BE(r)&&this._renderOnGeo(r,t,n,i)},e.prototype.incrementalPrepareRender=function(t,e,i){this.group.removeAll()},e.prototype.incrementalRender=function(t,e,i,n){var r=e.coordinateSystem;r&&(BE(r)?this.render(e,i,n):this._renderOnCartesianAndCalendar(e,n,t.start,t.end,!0))},e.prototype._renderOnCartesianAndCalendar=function(t,e,i,n,r){var o,a,s,l,u=t.coordinateSystem;if(Qw(u,"cartesian2d")){var c=u.getAxis("x"),h=u.getAxis("y");o=c.getBandWidth(),a=h.getBandWidth(),s=c.scale.getExtent(),l=h.scale.getExtent()}for(var p=this.group,d=t.getData(),f=t.getModel(["emphasis","itemStyle"]).getItemStyle(),m=t.getModel(["blur","itemStyle"]).getItemStyle(),g=t.getModel(["select","itemStyle"]).getItemStyle(),y=bc(t),v=t.get(["emphasis","focus"]),_=t.get(["emphasis","blurScope"]),x=Qw(u,"cartesian2d")?[d.mapDimension("x"),d.mapDimension("y"),d.mapDimension("value")]:[d.mapDimension("time"),d.mapDimension("value")],b=i;b<n;b++){var w=void 0,S=d.getItemVisual(b,"style");if(Qw(u,"cartesian2d")){var T=d.get(x[0],b),M=d.get(x[1],b);if(isNaN(d.get(x[2],b))||T<s[0]||T>s[1]||M<l[0]||M>l[1])continue;var I=u.dataToPoint([T,M]);w=new hs({shape:{x:Math.floor(Math.round(I[0])-o/2),y:Math.floor(Math.round(I[1])-a/2),width:Math.ceil(o),height:Math.ceil(a)},style:S})}else{if(isNaN(d.get(x[1],b)))continue;w=new hs({z2:1,shape:u.dataToRect([d.get(x[0],b)]).contentShape,style:S})}var C=d.getItemModel(b);if(d.hasItemOption){var A=C.getModel("emphasis");f=A.getModel("itemStyle").getItemStyle(),m=C.getModel(["blur","itemStyle"]).getItemStyle(),g=C.getModel(["select","itemStyle"]).getItemStyle(),v=A.get("focus"),_=A.get("blurScope"),y=bc(C)}var k=t.getRawValue(b),D="-";k&&null!=k[2]&&(D=k[2]+""),xc(w,y,{labelFetcher:t,labelDataIndex:b,defaultOpacity:S.opacity,defaultText:D}),w.ensureState("emphasis").style=f,w.ensureState("blur").style=m,w.ensureState("select").style=g,pl(w,v,_),w.incremental=r,r&&(w.states.emphasis.hoverLayer=!0),p.add(w),d.setItemGraphicEl(b,w)}},e.prototype._renderOnGeo=function(t,e,i,n){var r=i.targetVisuals.inRange,o=i.targetVisuals.outOfRange,a=e.getData(),s=this._hmLayer||this._hmLayer||new RE;s.blurSize=e.get("blurSize"),s.pointSize=e.get("pointSize"),s.minOpacity=e.get("minOpacity"),s.maxOpacity=e.get("maxOpacity");var l=t.getViewRect().clone(),u=t.getRoamTransform();l.applyTransform(u);var c=Math.max(l.x,0),h=Math.max(l.y,0),p=Math.min(l.width+l.x,n.getWidth()),d=Math.min(l.height+l.y,n.getHeight()),f=p-c,m=d-h,g=[a.mapDimension("lng"),a.mapDimension("lat"),a.mapDimension("value")],y=a.mapArray(g,function(e,i,n){var r=t.dataToPoint([e,i]);return r[0]-=c,r[1]-=h,r.push(n),r}),v=i.getExtent(),_="visualMap.continuous"===i.type?function(t,e){var i=t[1]-t[0];return e=[(e[0]-t[0])/i,(e[1]-t[0])/i],function(t){return t>=e[0]&&t<=e[1]}}(v,i.option.range):function(t,e,i){var n=t[1]-t[0],r=(e=z(e,function(e){return{interval:[(e.interval[0]-t[0])/n,(e.interval[1]-t[0])/n]}})).length,o=0;return function(t){var n;for(n=o;n<r;n++)if((a=e[n].interval)[0]<=t&&t<=a[1]){o=n;break}if(n===r)for(n=o-1;n>=0;n--){var a;if((a=e[n].interval)[0]<=t&&t<=a[1]){o=n;break}}return n>=0&&n<r&&i[n]}}(v,i.getPieceList(),i.option.selected);s.update(y,f,m,r.color.getNormalizer(),{inRange:r.color.getColorMapper(),outOfRange:o.color.getColorMapper()},_);var x=new rs({style:{width:f,height:m,x:c,y:h,image:s.canvas},silent:!0});this.group.add(x)},e.type="heatmap",e}(Zf),FE=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.getInitialData=function(t,e){return v_(null,this,{generateCoord:"value"})},e.prototype.preventIncremental=function(){var t=Vp.get(this.get("coordinateSystem"));if(t&&t.dimensions)return"lng"===t.dimensions[0]&&"lat"===t.dimensions[1]},e.type="series.heatmap",e.dependencies=["grid","geo","calendar"],e.defaultOption={coordinateSystem:"cartesian2d",zlevel:0,z:2,geoIndex:0,blurSize:30,pointSize:20,maxOpacity:1,minOpacity:0,select:{itemStyle:{borderColor:"#212121"}}},e}(Of),VE=["itemStyle","borderWidth"],UE=[{xy:"x",wh:"width",index:0,posDesc:["left","right"]},{xy:"y",wh:"height",index:1,posDesc:["top","bottom"]}],GE=new Gl,$E=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(t,e,i){var n=this.group,r=t.getData(),o=this._data,a=t.coordinateSystem,s=a.getBaseAxis().isHorizontal(),l=a.master.getRect(),u={ecSize:{width:i.getWidth(),height:i.getHeight()},seriesModel:t,coordSys:a,coordSysExtent:[[l.x,l.x+l.width],[l.y,l.y+l.height]],isHorizontal:s,valueDim:UE[+s],categoryDim:UE[1-+s]};return r.diff(o).add(function(t){if(r.hasValue(t)){var e=KE(r,t),i=WE(r,t,e,u),o=tP(r,u,i);r.setItemGraphicEl(t,o),n.add(o),oP(o,u,i)}}).update(function(t,e){var i=o.getItemGraphicEl(e);if(r.hasValue(t)){var a=KE(r,t),s=WE(r,t,a,u),l=iP(r,s);i&&l!==i.__pictorialShapeStr&&(n.remove(i),r.setItemGraphicEl(t,null),i=null),i?function(t,e,i){var n=i.animationModel,r=i.dataIndex;Bu(t.__pictorialBundle,{x:i.bundlePosition[0],y:i.bundlePosition[1]},n,r),i.symbolRepeat?ZE(t,e,i,!0):qE(t,e,i,!0),XE(t,i,!0),YE(t,e,i,!0)}(i,u,s):i=tP(r,u,s,!0),r.setItemGraphicEl(t,i),i.__pictorialSymbolMeta=s,n.add(i),oP(i,u,s)}else n.remove(i)}).remove(function(t){var e=o.getItemGraphicEl(t);e&&eP(o,t,e.__pictorialSymbolMeta.animationModel,e)}).execute(),this._data=r,this.group},e.prototype.remove=function(t,e){var i=this.group,n=this._data;t.get("animation")?n&&n.eachItemGraphicEl(function(e){eP(n,Ss(e).dataIndex,t,e)}):i.removeAll()},e.type="pictorialBar",e}(Zf);function WE(t,e,i,n){var r=t.getItemLayout(e),o=i.get("symbolRepeat"),a=i.get("symbolClip"),s=i.get("symbolPosition")||"start",l=(i.get("symbolRotate")||0)*Math.PI/180||0,u=i.get("symbolPatternSize")||2,c=i.isAnimationEnabled(),h={dataIndex:e,layout:r,itemModel:i,symbolType:t.getItemVisual(e,"symbol")||"circle",style:t.getItemVisual(e,"style"),symbolClip:a,symbolRepeat:o,symbolRepeatDirection:i.get("symbolRepeatDirection"),symbolPatternSize:u,rotation:l,animationModel:c?i:null,hoverScale:c&&i.get(["emphasis","scale"]),z2:i.getShallow("z",!0)||0};!function(t,e,i,n,r){var o,a=n.valueDim,s=t.get("symbolBoundingData"),l=n.coordSys.getOtherAxis(n.coordSys.getBaseAxis()),u=l.toGlobalCoord(l.dataToCoord(0)),c=1-+(i[a.wh]<=0);if(U(s)){var h=[HE(l,s[0])-u,HE(l,s[1])-u];h[1]<h[0]&&h.reverse(),o=h[c]}else o=null!=s?HE(l,s)-u:e?n.coordSysExtent[a.index][c]-u:i[a.wh];r.boundingLength=o,e&&(r.repeatCutLength=i[a.wh]),r.pxSign=o>0?1:o<0?-1:0}(i,o,r,n,h),function(t,e,i,n,r,o,a,s,l,u){var c,h=l.valueDim,p=l.categoryDim,d=Math.abs(i[p.wh]),f=t.getItemVisual(e,"symbolSize");(c=U(f)?f.slice():null==f?["100%","100%"]:[f,f])[p.index]=Xn(c[p.index],d),c[h.index]=Xn(c[h.index],n?d:Math.abs(o)),u.symbolSize=c,(u.symbolScale=[c[0]/s,c[1]/s])[h.index]*=(l.isHorizontal?-1:1)*a}(t,e,r,o,0,h.boundingLength,h.pxSign,u,n,h),function(t,e,i,n,r){var o=t.get(VE)||0;o&&(GE.attr({scaleX:e[0],scaleY:e[1],rotation:i}),GE.updateTransform(),o/=GE.getLineScale(),o*=e[n.valueDim.index]),r.valueLineWidth=o}(i,h.symbolScale,l,n,h);var p=h.symbolSize,d=ng(i.get("symbolOffset"),p);return function(t,e,i,n,r,o,a,s,l,u,c,h){var p=c.categoryDim,d=c.valueDim,f=h.pxSign,m=Math.max(e[d.index]+s,0),g=m;if(n){var y=Math.abs(l),v=tt(t.get("symbolMargin"),"15%")+"",_=!1;v.lastIndexOf("!")===v.length-1&&(_=!0,v=v.slice(0,v.length-1));var x=Xn(v,e[d.index]),b=Math.max(m+2*x,0),w=_?0:2*x,S=fr(n),T=S?n:aP((y+w)/b);b=m+2*(x=(y-T*m)/2/(_?T:Math.max(T-1,1))),w=_?0:2*x,S||"fixed"===n||(T=u?aP((Math.abs(u)+w)/b):0),g=T*b-w,h.repeatTimes=T,h.symbolMargin=x}var M=f*(g/2),C=h.pathPosition=[];C[p.index]=i[p.wh]/2,C[d.index]="start"===a?M:"end"===a?l-M:l/2,o&&(C[0]+=o[0],C[1]+=o[1]);var A=h.bundlePosition=[];A[p.index]=i[p.xy],A[d.index]=i[d.xy];var k=h.barRectShape=I({},i);k[d.wh]=f*Math.max(Math.abs(i[d.wh]),Math.abs(C[d.index]+M)),k[p.wh]=i[p.wh];var D=h.clipShape={};D[p.xy]=-i[p.xy],D[p.wh]=c.ecSize[p.wh],D[d.xy]=0,D[d.wh]=i[d.wh]}(i,p,r,o,0,d,s,h.valueLineWidth,h.boundingLength,h.repeatCutLength,n,h),h}function HE(t,e){return t.toGlobalCoord(t.dataToCoord(t.scale.parse(e)))}function jE(t){var e=t.symbolPatternSize,i=eg(t.symbolType,-e/2,-e/2,e,e);return i.attr({culling:!0}),"image"!==i.type&&i.setStyle({strokeNoScale:!0}),i}function ZE(t,e,i,n){var r=t.__pictorialBundle,o=i.symbolSize,a=i.valueLineWidth,s=i.pathPosition,l=e.valueDim,u=i.repeatTimes||0,c=0,h=o[e.valueDim.index]+a+2*i.symbolMargin;for(nP(t,function(t){t.__pictorialAnimationIndex=c,t.__pictorialRepeatTimes=u,c<u?rP(t,null,f(c),i,n):rP(t,null,{scaleX:0,scaleY:0},i,n,function(){r.remove(t)}),c++});c<u;c++){var p=jE(i);p.__pictorialAnimationIndex=c,p.__pictorialRepeatTimes=u,r.add(p);var d=f(c);rP(p,{x:d.x,y:d.y,scaleX:0,scaleY:0},{scaleX:d.scaleX,scaleY:d.scaleY,rotation:d.rotation},i,n)}function f(t){var e=s.slice(),n=i.pxSign,r=t;return("start"===i.symbolRepeatDirection?n>0:n<0)&&(r=u-1-t),e[l.index]=h*(r-u/2+.5)+s[l.index],{x:e[0],y:e[1],scaleX:i.symbolScale[0],scaleY:i.symbolScale[1],rotation:i.rotation}}}function qE(t,e,i,n){var r=t.__pictorialBundle,o=t.__pictorialMainPath;o?rP(o,null,{x:i.pathPosition[0],y:i.pathPosition[1],scaleX:i.symbolScale[0],scaleY:i.symbolScale[1],rotation:i.rotation},i,n):(o=t.__pictorialMainPath=jE(i),r.add(o),rP(o,{x:i.pathPosition[0],y:i.pathPosition[1],scaleX:0,scaleY:0,rotation:i.rotation},{scaleX:i.symbolScale[0],scaleY:i.symbolScale[1]},i,n))}function XE(t,e,i){var n=I({},e.barRectShape),r=t.__pictorialBarRect;r?rP(r,null,{shape:n},e,i):((r=t.__pictorialBarRect=new hs({z2:2,shape:n,silent:!0,style:{stroke:"transparent",fill:"transparent",lineWidth:0}})).disableMorphing=!0,t.add(r))}function YE(t,e,i,n){if(i.symbolClip){var r=t.__pictorialClipPath,o=I({},i.clipShape),a=e.valueDim,s=i.animationModel,l=i.dataIndex;if(r)Bu(r,{shape:o},s,l);else{o[a.wh]=0,r=new hs({shape:o}),t.__pictorialBundle.setClipPath(r),t.__pictorialClipPath=r;var u={};u[a.wh]=i.clipShape[a.wh],gc[n?"updateProps":"initProps"](r,{shape:u},s,l)}}}function KE(t,e){var i=t.getItemModel(e);return i.getAnimationDelayParams=JE,i.isAnimationEnabled=QE,i}function JE(t){return{index:t.__pictorialAnimationIndex,count:t.__pictorialRepeatTimes}}function QE(){return this.parentModel.isAnimationEnabled()&&!!this.getShallow("animation")}function tP(t,e,i,n){var r=new Fn,o=new Fn;return r.add(o),r.__pictorialBundle=o,o.x=i.bundlePosition[0],o.y=i.bundlePosition[1],i.symbolRepeat?ZE(r,e,i):qE(r,0,i),XE(r,i,n),YE(r,e,i,n),r.__pictorialShapeStr=iP(t,i),r.__pictorialSymbolMeta=i,r}function eP(t,e,i,n){var r=n.__pictorialBarRect;r&&r.removeTextContent();var o=[];nP(n,function(t){o.push(t)}),n.__pictorialMainPath&&o.push(n.__pictorialMainPath),n.__pictorialClipPath&&(i=null),L(o,function(t){Vu(t,{scaleX:0,scaleY:0},i,e,function(){n.parent&&n.parent.remove(n)})}),t.setItemGraphicEl(e,null)}function iP(t,e){return[t.getItemVisual(e.dataIndex,"symbol")||"none",!!e.symbolRepeat,!!e.symbolClip].join(":")}function nP(t,e,i){L(t.__pictorialBundle.children(),function(n){n!==t.__pictorialBarRect&&e.call(i,n)})}function rP(t,e,i,n,r,o){e&&t.attr(e),n.symbolClip&&!r?i&&t.attr(i):i&&gc[r?"updateProps":"initProps"](t,i,n.animationModel,n.dataIndex,o)}function oP(t,e,i){var n=i.dataIndex,r=i.itemModel,o=r.getModel("emphasis"),a=o.getModel("itemStyle").getItemStyle(),s=r.getModel(["blur","itemStyle"]).getItemStyle(),l=r.getModel(["select","itemStyle"]).getItemStyle(),u=r.getShallow("cursor"),c=o.get("focus"),h=o.get("blurScope"),p=o.get("scale");nP(t,function(t){if(t instanceof rs){var e=t.style;t.useStyle(I({image:e.image,x:e.x,y:e.y,width:e.width,height:e.height},i.style))}else t.useStyle(i.style);var n=t.ensureState("emphasis");n.style=a,p&&(n.scaleX=1.1*t.scaleX,n.scaleY=1.1*t.scaleY),t.ensureState("blur").style=s,t.ensureState("select").style=l,u&&(t.cursor=u),t.z2=i.z2});var d=e.valueDim.posDesc[+(i.boundingLength>0)];xc(t.__pictorialBarRect,bc(r),{labelFetcher:e.seriesModel,labelDataIndex:n,defaultText:kw(e.seriesModel.getData(),n),inheritColor:i.style.fill,defaultOpacity:i.style.opacity,defaultOutsidePosition:d}),pl(t,c,h)}function aP(t){var e=Math.round(t);return Math.abs(t-e)<1e-4?e:Math.ceil(t)}var sP=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.hasSymbolVisual=!0,i.defaultSymbol="roundRect",i}return i(e,t),e.prototype.getInitialData=function(e){return e.stack=null,t.prototype.getInitialData.apply(this,arguments)},e.type="series.pictorialBar",e.dependencies=["grid"],e.defaultOption=jc(mS.defaultOption,{symbol:"circle",symbolSize:null,symbolRotate:null,symbolPosition:null,symbolOffset:null,symbolMargin:null,symbolRepeat:!1,symbolRepeatDirection:"end",symbolClip:!1,symbolBoundingData:null,symbolPatternSize:400,barGap:"-100%",progressive:0,emphasis:{scale:!1},select:{itemStyle:{borderColor:"#212121"}}}),e}(mS),lP=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._layers=[],i}return i(e,t),e.prototype.render=function(t,e,i){var n=t.getData(),r=this,o=this.group,a=t.getLayerSeries(),s=n.getLayout("layoutInfo"),l=s.rect,u=s.boundaryGap;function c(t){return t.name}o.x=0,o.y=l.y+u[0];var h=new Fv(this._layersSeries||[],a,c,c),p=[];function d(e,i,s){var l=r._layers;if("remove"!==e){for(var u,c,h=[],d=[],f=a[i].indices,m=0;m<f.length;m++){var g=n.getItemLayout(f[m]),y=g.x,v=g.y0,_=g.y;h.push(y,v),d.push(y,v+_),u=n.getItemVisual(f[m],"style")}var x=n.getItemLayout(f[0]),b=t.getModel("label").get("margin"),w=t.getModel("emphasis");if("add"===e){var S=p[i]=new Fn;c=new Xw({shape:{points:h,stackedOnPoints:d,smooth:.4,stackedOnSmooth:.4,smoothConstraint:!1},z2:0}),S.add(c),o.add(S),t.isAnimationEnabled()&&c.setClipPath(function(t,e,i){var n=new hs({shape:{x:t.x-10,y:t.y-10,width:0,height:t.height+20}});return Nu(n,{shape:{x:t.x-50,width:t.width+100,height:t.height+20}},e,i),n}(c.getBoundingRect(),t,function(){c.removeClipPath()}))}else S=l[s],c=S.childAt(0),o.add(S),p[i]=S,Bu(c,{shape:{points:h,stackedOnPoints:d}},t),$u(c);xc(c,bc(t),{labelDataIndex:f[m-1],defaultText:n.getName(f[m-1]),inheritColor:u.fill},{normal:{verticalAlign:"middle"}}),c.setTextConfig({position:null,local:!0});var T=c.getTextContent();T&&(T.x=x.x-b,T.y=x.y0+x.y/2),c.useStyle(u),n.setItemGraphicEl(i,c),gl(c,t),pl(c,w.get("focus"),w.get("blurScope"))}else o.remove(l[i])}h.add(F(d,this,"add")).update(F(d,this,"update")).remove(F(d,this,"remove")).execute(),this._layersSeries=a,this._layers=p},e.type="themeRiver",e}(Zf),uP=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.init=function(e){t.prototype.init.apply(this,arguments),this.legendVisualProvider=new tT(F(this.getData,this),F(this.getRawData,this))},e.prototype.fixData=function(t){var e=t.length,i={},n=Gr(t,function(t){return i.hasOwnProperty(t[0]+"")||(i[t[0]+""]=-1),t[2]}),r=[];n.buckets.each(function(t,e){r.push({name:e,dataList:t})});for(var o=r.length,a=0;a<o;++a){for(var s=r[a].name,l=0;l<r[a].dataList.length;++l){var u=r[a].dataList[l][0]+"";i[u]=a}for(var u in i)i.hasOwnProperty(u)&&i[u]!==a&&(i[u]=a,t[e]=[u,0,s],e++)}return t},e.prototype.getInitialData=function(t,e){for(var i=this.getReferringComponents("singleAxis",Nr).models[0].get("type"),n=R(t.data,function(t){return void 0!==t[2]}),r=this.fixData(n||[]),o=[],a=this.nameMap=ht(),s=0,l=0;l<r.length;++l)o.push(r[l][2]),a.get(r[l][2])||(a.set(r[l][2],s),s++);var u=c_(r,{coordDimensions:["single"],dimensionsDefine:[{name:"time",type:Gv(i)},{name:"value",type:"float"},{name:"name",type:"ordinal"}],encodeDefine:{single:0,value:1,itemName:2}}).dimensions,c=new u_(u,this);return c.initData(r),c},e.prototype.getLayerSeries=function(){for(var t=this.getData(),e=t.count(),i=[],n=0;n<e;++n)i[n]=n;var r=t.mapDimension("single"),o=Gr(i,function(e){return t.get("name",e)}),a=[];return o.buckets.each(function(e,i){e.sort(function(e,i){return t.get(r,e)-t.get(r,i)}),a.push({name:i,indices:e})}),a},e.prototype.getAxisTooltipData=function(t,e,i){U(t)||(t=t?[t]:[]);for(var n,r=this.getData(),o=this.getLayerSeries(),a=[],s=o.length,l=0;l<s;++l){for(var u=Number.MAX_VALUE,c=-1,h=o[l].indices.length,p=0;p<h;++p){var d=r.get(t[0],o[l].indices[p]),f=Math.abs(d-e);f<=u&&(n=d,u=f,c=o[l].indices[p])}a.push(c)}return{dataIndices:a,nestestValue:n}},e.prototype.formatTooltip=function(t,e,i){var n=this.getData();return wf("nameValue",{name:n.getName(t),value:n.get(n.mapDimension("value"),t)})},e.type="series.themeRiver",e.dependencies=["singleAxis"],e.defaultOption={zlevel:0,z:2,colorBy:"data",coordinateSystem:"singleAxis",boundaryGap:["10%","10%"],singleAxisIndex:0,animationEasing:"linear",label:{margin:4,show:!0,position:"left",fontSize:11},emphasis:{label:{show:!0}}},e}(Of);function cP(t,e){t.eachSeriesByType("themeRiver",function(t){var e=t.getData(),i=t.coordinateSystem,n={},r=i.getRect();n.rect=r;var o=t.get("boundaryGap"),a=i.getAxis();n.boundaryGap=o,"horizontal"===a.orient?(o[0]=Xn(o[0],r.height),o[1]=Xn(o[1],r.height),hP(e,t,r.height-o[0]-o[1])):(o[0]=Xn(o[0],r.width),o[1]=Xn(o[1],r.width),hP(e,t,r.width-o[0]-o[1])),e.setLayout("layoutInfo",n)})}function hP(t,e,i){if(t.count())for(var n,r=e.coordinateSystem,o=e.getLayerSeries(),a=t.mapDimension("single"),s=t.mapDimension("value"),l=z(o,function(e){return z(e.indices,function(e){var i=r.dataToPoint(t.get(a,e));return i[1]=t.get(s,e),i})}),u=function(t){for(var e=t.length,i=t[0].length,n=[],r=[],o=0,a=0;a<i;++a){for(var s=0,l=0;l<e;++l)s+=t[l][a][1];s>o&&(o=s),n.push(s)}for(var u=0;u<i;++u)r[u]=(o-n[u])/2;o=0;for(var c=0;c<i;++c){var h=n[c]+r[c];h>o&&(o=h)}return{y0:r,max:o}}(l),c=u.y0,h=i/u.max,p=o.length,d=o[0].indices.length,f=0;f<d;++f){n=c[f]*h,t.setItemLayout(o[0].indices[f],{layerIndex:0,x:l[0][f][0],y0:n,y:l[0][f][1]*h});for(var m=1;m<p;++m)n+=l[m-1][f][1]*h,t.setItemLayout(o[m].indices[f],{layerIndex:m,x:l[m][f][0],y0:n,y:l[m][f][1]*h})}}var pP=function(t){function e(e,i,n,r){var o=t.call(this)||this;o.z2=2,o.textConfig={inside:!0},Ss(o).seriesIndex=i.seriesIndex;var a=new fs({z2:4,silent:e.getModel().get(["label","silent"])});return o.setTextContent(a),o.updateData(!0,e,i,n,r),o}return i(e,t),e.prototype.updateData=function(t,e,i,n,r){this.node=e,e.piece=this,i=i||this._seriesModel,n=n||this._ecModel;var o=this;Ss(o).dataIndex=e.dataIndex;var a=e.getModel(),s=a.getModel("emphasis"),l=e.getLayout(),u=I({},l);u.label=null;var c=e.getVisual("style");c.lineJoin="bevel";var h=e.getVisual("decal");h&&(c.decal=Cg(h,r));var p=YS(a.getModel("itemStyle"),u,!0);I(u,p),L(As,function(t){var e=o.ensureState(t),i=a.getModel([t,"itemStyle"]);e.style=i.getItemStyle();var n=YS(i,u);n&&(e.shape=n)}),t?(o.setShape(u),o.shape.r=l.r0,Bu(o,{shape:{r:l.r}},i,e.dataIndex)):(Bu(o,{shape:u},i),$u(o)),o.useStyle(c),this._updateLabel(i);var d=a.getShallow("cursor");d&&o.attr("cursor",d),this._seriesModel=i||this._seriesModel,this._ecModel=n||this._ecModel;var f=s.get("focus");pl(this,"ancestor"===f?e.getAncestorsIndices():"descendant"===f?e.getDescendantIndices():f,s.get("blurScope"))},e.prototype._updateLabel=function(t){var e=this,i=this.node.getModel(),n=i.getModel("label"),r=this.node.getLayout(),o=r.endAngle-r.startAngle,a=(r.startAngle+r.endAngle)/2,s=Math.cos(a),l=Math.sin(a),u=this,c=u.getTextContent(),h=this.node.dataIndex,p=n.get("minAngle")/180*Math.PI,d=n.get("show")&&!(null!=p&&Math.abs(o)<p);function f(t,e){var i=t.get(e);return null==i?n.get(e):i}c.ignore=!d,L(ks,function(n){var o="normal"===n?i.getModel("label"):i.getModel([n,"label"]),p="normal"===n,d=p?c:c.ensureState(n),m=t.getFormattedLabel(h,n);p&&(m=m||e.node.name),d.style=wc(o,{},null,"normal"!==n,!0),m&&(d.style.text=m);var g=o.get("show");null==g||p||(d.ignore=!g);var y,v=f(o,"position"),_=p?u:u.states[n],x=_.style.fill;_.textConfig={outsideFill:"inherit"===o.get("color")?x:null,inside:"outside"!==v};var b=f(o,"distance")||0,w=f(o,"align");"outside"===v?(y=r.r+b,w=a>Math.PI/2?"right":"left"):w&&"center"!==w?"left"===w?(y=r.r0+b,a>Math.PI/2&&(w="right")):"right"===w&&(y=r.r-b,a>Math.PI/2&&(w="left")):(y=(r.r+r.r0)/2,w="center"),d.style.align=w,d.style.verticalAlign=f(o,"verticalAlign")||"middle",d.x=y*s+r.cx,d.y=y*l+r.cy;var S=f(o,"rotate"),T=0;"radial"===S?(T=-a)<-Math.PI/2&&(T+=Math.PI):"tangential"===S?(T=Math.PI/2-a)>Math.PI/2?T-=Math.PI:T<-Math.PI/2&&(T+=Math.PI):"number"==typeof S&&(T=S*Math.PI/180),d.rotation=T}),c.dirtyStyle()},e}(ou),dP="sunburstRootToNode",fP="sunburstHighlight",mP=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(t,e,i,n){var r=this;this.seriesModel=t,this.api=i,this.ecModel=e;var o=t.getData(),a=o.tree.root,s=t.getViewRoot(),l=this.group,u=t.get("renderLabelForZeroData"),c=[];s.eachNode(function(t){c.push(t)});var h=this._oldChildren||[];!function(n,r){function s(t){return t.getId()}function c(s,c){!function(n,r){if(u||!n||n.getValue()||(n=null),n!==a&&r!==a)if(r&&r.piece)n?(r.piece.updateData(!1,n,t,e,i),o.setItemGraphicEl(n.dataIndex,r.piece)):function(t){t&&t.piece&&(l.remove(t.piece),t.piece=null)}(r);else if(n){var s=new pP(n,t,e,i);l.add(s),o.setItemGraphicEl(n.dataIndex,s)}}(null==s?null:n[s],null==c?null:r[c])}0===n.length&&0===r.length||new Fv(r,n,s,s).add(c).update(c).remove(V(c,null)).execute()}(c,h),function(n,o){o.depth>0?(r.virtualPiece?r.virtualPiece.updateData(!1,n,t,e,i):(r.virtualPiece=new pP(n,t,e,i),l.add(r.virtualPiece)),o.piece.off("click"),r.virtualPiece.on("click",function(t){r._rootToNode(o.parentNode)})):r.virtualPiece&&(l.remove(r.virtualPiece),r.virtualPiece=null)}(a,s),this._initEvents(),this._oldChildren=c},e.prototype._initEvents=function(){var t=this;this.group.off("click"),this.group.on("click",function(e){var i=!1;t.seriesModel.getViewRoot().eachNode(function(n){if(!i&&n.piece&&n.piece===e.target){var r=n.getModel().get("nodeClick");if("rootToNode"===r)t._rootToNode(n);else if("link"===r){var o=n.getModel(),a=o.get("link");a&&$h(a,o.get("target",!0)||"_blank")}i=!0}})})},e.prototype._rootToNode=function(t){t!==this.seriesModel.getViewRoot()&&this.api.dispatchAction({type:dP,from:this.uid,seriesId:this.seriesModel.id,targetNode:t})},e.prototype.containPoint=function(t,e){var i=e.getData().getItemLayout(0);if(i){var n=t[0]-i.cx,r=t[1]-i.cy,o=Math.sqrt(n*n+r*r);return o<=i.r&&o>=i.r0}},e.type="sunburst",e}(Zf),gP=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.ignoreStyleOnData=!0,i}return i(e,t),e.prototype.getInitialData=function(t,e){var i={name:t.name,children:t.data};yP(i);var n=this._levelModels=z(t.levels||[],function(t){return new $c(t,this,e)},this),r=kI.createTree(i,this,function(t){t.wrapMethod("getItemModel",function(t,e){var i=r.getNodeByDataIndex(e),o=n[i.depth];return o&&(t.parentModel=o),t})});return r.data},e.prototype.optionUpdated=function(){this.resetViewRoot()},e.prototype.getDataParams=function(e){var i=t.prototype.getDataParams.apply(this,arguments),n=this.getData().tree.getNodeByDataIndex(e);return i.treePathInfo=LI(n,this),i},e.prototype.getLevelModel=function(t){return this._levelModels&&this._levelModels[t.depth]},e.prototype.getViewRoot=function(){return this._viewRoot},e.prototype.resetViewRoot=function(t){t?this._viewRoot=t:t=this._viewRoot;var e=this.getRawData().tree.root;t&&(t===e||e.contains(t))||(this._viewRoot=e)},e.prototype.enableAriaDecal=function(){VI(this)},e.type="series.sunburst",e.defaultOption={zlevel:0,z:2,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,stillShowZeroSum:!0,nodeClick:"rootToNode",renderLabelForZeroData:!1,label:{rotate:"radial",show:!0,opacity:1,align:"center",position:"inside",distance:5,silent:!0},itemStyle:{borderWidth:1,borderColor:"white",borderType:"solid",shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,opacity:1},emphasis:{focus:"descendant"},blur:{itemStyle:{opacity:.2},label:{opacity:.1}},animationType:"expansion",animationDuration:1e3,animationDurationUpdate:500,data:[],sort:"desc"},e}(Of);function yP(t){var e=0;L(t.children,function(t){yP(t);var i=t.value;U(i)&&(i=i[0]),e+=i});var i=t.value;U(i)&&(i=i[0]),(null==i||isNaN(i))&&(i=e),i<0&&(i=0),U(t.value)?t.value[0]=i:t.value=i}var vP=Math.PI/180;function _P(t,e,i){e.eachSeriesByType(t,function(t){var e=t.get("center"),n=t.get("radius");U(n)||(n=[0,n]),U(e)||(e=[e,e]);var r=i.getWidth(),o=i.getHeight(),a=Math.min(r,o),s=Xn(e[0],r),l=Xn(e[1],o),u=Xn(n[0],a/2),c=Xn(n[1],a/2),h=-t.get("startAngle")*vP,p=t.get("minAngle")*vP,d=t.getData().tree.root,f=t.getViewRoot(),m=f.depth,g=t.get("sort");null!=g&&xP(f,g);var y=0;L(f.children,function(t){!isNaN(t.getValue())&&y++});var v=f.getValue(),_=Math.PI/(v||y)*2,x=f.depth>0,b=f.height-(x?-1:1),w=(c-u)/(b||1),S=t.get("clockwise"),T=t.get("stillShowZeroSum"),M=S?1:-1,I=function(e,i){if(e){var n=i;if(e!==d){var r=e.getValue(),o=0===v&&T?_:r*_;o<p&&(o=p),n=i+M*o;var c=e.depth-m-(x?-1:1),h=u+w*c,f=u+w*(c+1),g=t.getLevelModel(e);if(g){var y=g.get("r0",!0),b=g.get("r",!0),C=g.get("radius",!0);null!=C&&(y=C[0],b=C[1]),null!=y&&(h=Xn(y,a/2)),null!=b&&(f=Xn(b,a/2))}e.setLayout({angle:o,startAngle:i,endAngle:n,clockwise:S,cx:s,cy:l,r0:h,r:f})}if(e.children&&e.children.length){var A=0;L(e.children,function(t){A+=I(t,i+A)})}return n-i}};if(x){var C=u,A=u+w,k=2*Math.PI;d.setLayout({angle:k,startAngle:h,endAngle:h+k,clockwise:S,cx:s,cy:l,r0:C,r:A})}I(f,h)})}function xP(t,e){var i=t.children||[];t.children=function(t,e){if("function"==typeof e){var i=z(t,function(t,e){var i=t.getValue();return{params:{depth:t.depth,height:t.height,dataIndex:t.dataIndex,getValue:function(){return i}},index:e}});return i.sort(function(t,i){return e(t.params,i.params)}),z(i,function(e){return t[e.index]})}var n="asc"===e;return t.sort(function(t,e){var i=(t.getValue()-e.getValue())*(n?1:-1);return 0===i?(t.dataIndex-e.dataIndex)*(n?-1:1):i})}(i,e),i.length&&L(t.children,function(t){xP(t,e)})}function bP(t){var e={};t.eachSeriesByType("sunburst",function(t){var i=t.getData(),n=i.tree;n.eachNode(function(r){var o=r.getModel().getModel("itemStyle").getItemStyle();o.fill||(o.fill=function(t,i,n){for(var r=t;r&&r.depth>1;)r=r.parentNode;var o=i.getColorFromPalette(r.name||r.dataIndex+"",e);return t.depth>1&&"string"==typeof o&&(o=Ze(o,(t.depth-1)/(n-1)*.5)),o}(r,t,n.root.height)),I(i.ensureUniqueItemVisual(r.dataIndex,"style"),o)})})}var wP={x:1,y:1,scaleX:1,scaleY:1,originX:1,originY:1,rotation:1},SP={color:"fill",borderColor:"stroke"},TP={symbol:1,symbolSize:1,symbolKeepAspect:1,legendIcon:1,visualMeta:1,liftZ:1,decal:1},MP=zr(),IP=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.optionUpdated=function(){this.currentZLevel=this.get("zlevel",!0),this.currentZ=this.get("z",!0)},e.prototype.getInitialData=function(t,e){return v_(null,this)},e.prototype.getDataParams=function(e,i,n){var r=t.prototype.getDataParams.call(this,e,i);return n&&(r.info=MP(n).info),r},e.type="series.custom",e.dependencies=["grid","polar","geo","singleAxis","calendar"],e.defaultOption={coordinateSystem:"cartesian2d",zlevel:0,z:2,legendHoverLink:!0,clip:!1},e}(Of);function CP(t,e){return e=e||[0,0],z(["x","y"],function(i,n){var r=this.getAxis(i),o=e[n],a=t[n]/2;return"category"===r.type?r.getBandWidth():Math.abs(r.dataToCoord(o-a)-r.dataToCoord(o+a))},this)}function AP(t,e){return e=e||[0,0],z([0,1],function(i){var n=e[i],r=t[i]/2,o=[],a=[];return o[i]=n-r,a[i]=n+r,o[1-i]=a[1-i]=e[1-i],Math.abs(this.dataToPoint(o)[i]-this.dataToPoint(a)[i])},this)}function kP(t,e){var i=this.getAxis(),n=e instanceof Array?e[0]:e,r=(t instanceof Array?t[0]:t)/2;return"category"===i.type?i.getBandWidth():Math.abs(i.dataToCoord(n-r)-i.dataToCoord(n+r))}function DP(t,e){return e=e||[0,0],z(["Radius","Angle"],function(i,n){var r=this["get"+i+"Axis"](),o=e[n],a=t[n]/2,s="category"===r.type?r.getBandWidth():Math.abs(r.dataToCoord(o-a)-r.dataToCoord(o+a));return"Angle"===i&&(s=s*Math.PI/180),s},this)}function EP(t,e,i,n){return t&&(t.legacy||!1!==t.legacy&&!i&&!n&&"tspan"!==e&&("text"===e||ft(t,"text")))}function PP(t,e,i){var n,r,o,a=t;if("text"===e)o=a;else{o={},ft(a,"text")&&(o.text=a.text),ft(a,"rich")&&(o.rich=a.rich),ft(a,"textFill")&&(o.fill=a.textFill),ft(a,"textStroke")&&(o.stroke=a.textStroke),ft(a,"fontFamily")&&(o.fontFamily=a.fontFamily),ft(a,"fontSize")&&(o.fontSize=a.fontSize),ft(a,"fontStyle")&&(o.fontStyle=a.fontStyle),ft(a,"fontWeight")&&(o.fontWeight=a.fontWeight),r={type:"text",style:o,silent:!0},n={};var s=ft(a,"textPosition");i?n.position=s?a.textPosition:"inside":s&&(n.position=a.textPosition),ft(a,"textPosition")&&(n.position=a.textPosition),ft(a,"textOffset")&&(n.offset=a.textOffset),ft(a,"textRotation")&&(n.rotation=a.textRotation),ft(a,"textDistance")&&(n.distance=a.textDistance)}return LP(o,t),L(o.rich,function(t){LP(t,t)}),{textConfig:n,textContent:r}}function LP(t,e){e&&(e.font=e.textFont||e.font,ft(e,"textStrokeWidth")&&(t.lineWidth=e.textStrokeWidth),ft(e,"textAlign")&&(t.align=e.textAlign),ft(e,"textVerticalAlign")&&(t.verticalAlign=e.textVerticalAlign),ft(e,"textLineHeight")&&(t.lineHeight=e.textLineHeight),ft(e,"textWidth")&&(t.width=e.textWidth),ft(e,"textHeight")&&(t.height=e.textHeight),ft(e,"textBackgroundColor")&&(t.backgroundColor=e.textBackgroundColor),ft(e,"textPadding")&&(t.padding=e.textPadding),ft(e,"textBorderColor")&&(t.borderColor=e.textBorderColor),ft(e,"textBorderWidth")&&(t.borderWidth=e.textBorderWidth),ft(e,"textBorderRadius")&&(t.borderRadius=e.textBorderRadius),ft(e,"textBoxShadowColor")&&(t.shadowColor=e.textBoxShadowColor),ft(e,"textBoxShadowBlur")&&(t.shadowBlur=e.textBoxShadowBlur),ft(e,"textBoxShadowOffsetX")&&(t.shadowOffsetX=e.textBoxShadowOffsetX),ft(e,"textBoxShadowOffsetY")&&(t.shadowOffsetY=e.textBoxShadowOffsetY))}function zP(t,e,i){var n=t;n.textPosition=n.textPosition||i.position||"inside",null!=i.offset&&(n.textOffset=i.offset),null!=i.rotation&&(n.textRotation=i.rotation),null!=i.distance&&(n.textDistance=i.distance);var r=n.textPosition.indexOf("inside")>=0,o=t.fill||"#000";OP(n,e);var a=null==n.textFill;return r?a&&(n.textFill=i.insideFill||"#fff",!n.textStroke&&i.insideStroke&&(n.textStroke=i.insideStroke),!n.textStroke&&(n.textStroke=o),null==n.textStrokeWidth&&(n.textStrokeWidth=2)):(a&&(n.textFill=t.fill||i.outsideFill||"#000"),!n.textStroke&&i.outsideStroke&&(n.textStroke=i.outsideStroke)),n.text=e.text,n.rich=e.rich,L(e.rich,function(t){OP(t,t)}),n}function OP(t,e){e&&(ft(e,"fill")&&(t.textFill=e.fill),ft(e,"stroke")&&(t.textStroke=e.fill),ft(e,"lineWidth")&&(t.textStrokeWidth=e.lineWidth),ft(e,"font")&&(t.font=e.font),ft(e,"fontStyle")&&(t.fontStyle=e.fontStyle),ft(e,"fontWeight")&&(t.fontWeight=e.fontWeight),ft(e,"fontSize")&&(t.fontSize=e.fontSize),ft(e,"fontFamily")&&(t.fontFamily=e.fontFamily),ft(e,"align")&&(t.textAlign=e.align),ft(e,"verticalAlign")&&(t.textVerticalAlign=e.verticalAlign),ft(e,"lineHeight")&&(t.textLineHeight=e.lineHeight),ft(e,"width")&&(t.textWidth=e.width),ft(e,"height")&&(t.textHeight=e.height),ft(e,"backgroundColor")&&(t.textBackgroundColor=e.backgroundColor),ft(e,"padding")&&(t.textPadding=e.padding),ft(e,"borderColor")&&(t.textBorderColor=e.borderColor),ft(e,"borderWidth")&&(t.textBorderWidth=e.borderWidth),ft(e,"borderRadius")&&(t.textBorderRadius=e.borderRadius),ft(e,"shadowColor")&&(t.textBoxShadowColor=e.shadowColor),ft(e,"shadowBlur")&&(t.textBoxShadowBlur=e.shadowBlur),ft(e,"shadowOffsetX")&&(t.textBoxShadowOffsetX=e.shadowOffsetX),ft(e,"shadowOffsetY")&&(t.textBoxShadowOffsetY=e.shadowOffsetY),ft(e,"textShadowColor")&&(t.textShadowColor=e.textShadowColor),ft(e,"textShadowBlur")&&(t.textShadowBlur=e.textShadowBlur),ft(e,"textShadowOffsetX")&&(t.textShadowOffsetX=e.textShadowOffsetX),ft(e,"textShadowOffsetY")&&(t.textShadowOffsetY=e.textShadowOffsetY))}var RP={position:["x","y"],scale:["scaleX","scaleY"],origin:["originX","originY"]};function BP(t,e,i){var n=t[i],r=RP[i];n&&(e[r[0]]=n[0],e[r[1]]=n[1])}function NP(t,e,i){null!=t[i]&&(e[i]=t[i])}function FP(t,e,i){i&&(t[e]=i[e])}function VP(t,e,i,n,r){var o=i[t];if(o){var a,s=e[t],l=o.enterFrom;if(r&&l){!a&&(a=n[t]={});for(var u=N(l),c=0;c<u.length;c++)a[v=u[c]]=l[v]}if(!r&&s)if(o.transition){!a&&(a=n[t]={});var h=wr(o.transition);for(c=0;c<h.length;c++){var p=s[v=h[c]];a[v]=p}}else if(k(i.transition,t)>=0){!a&&(a=n[t]={});var d=N(s);for(c=0;c<d.length;c++)p=s[v=d[c]],GP(o[v],p)&&(a[v]=p)}var f=o.leaveTo;if(f){var m=$P(e),g=m[t]||(m[t]={}),y=N(f);for(c=0;c<y.length;c++){var v;g[v=y[c]]=f[v]}}}}function UP(t,e,i){var n=e[t];if(n)for(var r=i[t]={},o=N(n),a=0;a<o.length;a++){var s=o[a];r[s]=hi(n[s])}}function GP(t,e){return P(t)?t!==e:null!=t&&isFinite(t)}function $P(t){var e=MP(t);return e.leaveToProps||(e.leaveToProps={})}N(wP).join(", ");var WP="emphasis",HP="normal",jP="blur",ZP="select",qP=[HP,WP,jP,ZP],XP={normal:["itemStyle"],emphasis:[WP,"itemStyle"],blur:[jP,"itemStyle"],select:[ZP,"itemStyle"]},YP={normal:["label"],emphasis:[WP,"label"],blur:[jP,"label"],select:[ZP,"label"]},KP={normal:{},emphasis:{},blur:{},select:{}},JP={cartesian2d:function(t){var e=t.master.getRect();return{coordSys:{type:"cartesian2d",x:e.x,y:e.y,width:e.width,height:e.height},api:{coord:function(e){return t.dataToPoint(e)},size:F(CP,t)}}},geo:function(t){var e=t.getBoundingRect();return{coordSys:{type:"geo",x:e.x,y:e.y,width:e.width,height:e.height,zoom:t.getZoom()},api:{coord:function(e){return t.dataToPoint(e)},size:F(AP,t)}}},singleAxis:function(t){var e=t.getRect();return{coordSys:{type:"singleAxis",x:e.x,y:e.y,width:e.width,height:e.height},api:{coord:function(e){return t.dataToPoint(e)},size:F(kP,t)}}},polar:function(t){var e=t.getRadiusAxis(),i=t.getAngleAxis(),n=e.getExtent();return n[0]>n[1]&&n.reverse(),{coordSys:{type:"polar",cx:t.cx,cy:t.cy,r:n[1],r0:n[0]},api:{coord:function(n){var r=e.dataToRadius(n[0]),o=i.dataToAngle(n[1]),a=t.coordToPoint([r,o]);return a.push(r,o*Math.PI/180),a},size:F(DP,t)}}},calendar:function(t){var e=t.getRect(),i=t.getRangeInfo();return{coordSys:{type:"calendar",x:e.x,y:e.y,width:e.width,height:e.height,cellWidth:t.getCellWidth(),cellHeight:t.getCellHeight(),rangeInfo:{start:i.start,end:i.end,weeks:i.weeks,dayCount:i.allDay}},api:{coord:function(e,i){return t.dataToPoint(e,i)}}}}};function QP(t){return t instanceof Qa}function tL(t){return t instanceof Io}var eL=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(t,e,i,n){var r=this._data,o=t.getData(),a=this.group,s=uL(t,o,e,i);r||a.removeAll(),o.diff(r).add(function(e){hL(i,null,e,s(e,n),t,a,o)}).remove(function(e){xL(r.getItemGraphicEl(e),t,a)}).update(function(e,l){var u=r.getItemGraphicEl(l);hL(i,u,e,s(e,n),t,a,o)}).execute();var l=t.get("clip",!0)?Jw(t.coordinateSystem,!1,t):null;l?a.setClipPath(l):a.removeClipPath(),this._data=o},e.prototype.incrementalPrepareRender=function(t,e,i){this.group.removeAll(),this._data=null},e.prototype.incrementalRender=function(t,e,i,n,r){var o=e.getData(),a=uL(e,o,i,n);function s(t){t.isGroup||(t.incremental=!0,t.ensureState("emphasis").hoverLayer=!0)}for(var l=t.start;l<t.end;l++){var u=hL(null,null,l,a(l,r),e,this.group,o);u&&u.traverse(s)}},e.prototype.filterForExposedEvent=function(t,e,i,n){var r=e.element;if(null==r||i.name===r)return!0;for(;(i=i.__hostTarget||i.parent)&&i!==this.group;)if(i.name===r)return!0;return!1},e.type="custom",e}(Zf);function iL(t){var e,i=t.type;if("path"===i){var n=t.shape,r=null!=n.width&&null!=n.height?{x:n.x||0,y:n.y||0,width:n.width,height:n.height}:null,o=bL(n);e=Ju(o,null,r,n.layout||"center"),MP(e).customPathData=o}else if("image"===i)e=new rs({}),MP(e).customImagePath=t.style.image;else if("text"===i)e=new fs({});else if("group"===i)e=new Fn;else{if("compoundPath"===i)throw Error('"compoundPath" is not supported yet.');var a=Ku(i),s;if(!a)_r("");e=new a}return MP(e).customGraphicType=i,e.name=t.name,e.z2EmphasisLift=1,e.z2SelectLift=1,e}function nL(t,e,i,n,r,o,a,s){var l=r&&r.normal.cfg;l&&e.setTextConfig(l);var u=n&&n.style;if(u){if("text"===e.type){var c=u;ft(c,"textFill")&&(c.fill=c.textFill),ft(c,"textStroke")&&(c.stroke=c.textStroke)}var h=void 0,p=QP(e)?u.decal:null;t&&p&&(p.dirty=!0,h=Cg(p,t)),u.__decalPattern=h}MP(e).userDuring=n.during;var d={},f={};VP("shape",e,n,d,a),UP("shape",n,f),function(t,e,i,n){var r=e.enterFrom;if(n&&r)for(var o=N(r),a=0;a<o.length;a++)i[p=o[a]]=r[p];if(!n)if(e.transition){var s=wr(e.transition);for(a=0;a<s.length;a++)if("style"!==(p=s[a])&&"shape"!==p&&"extra"!==p){var l=t[p];i[p]=l}}else FP(i,"x",t),FP(i,"y",t);var u=e.leaveTo;if(u){var c=$P(t),h=N(u);for(a=0;a<h.length;a++){var p;c[p=h[a]]=u[p]}}}(e,n,d,a),function(t,e,i){BP(e,i,"position"),BP(e,i,"scale"),BP(e,i,"origin"),NP(e,i,"x"),NP(e,i,"y"),NP(e,i,"scaleX"),NP(e,i,"scaleY"),NP(e,i,"originX"),NP(e,i,"originY"),NP(e,i,"rotation")}(0,n,f),VP("extra",e,n,d,a),UP("extra",n,f),function(t,e,i,n,r){if(i){var o,a=t.style,s=i.enterFrom;if(r&&s){var l=N(s);!o&&(o=n.style={});for(var u=0;u<l.length;u++)o[_=l[u]]=s[_]}if(!r&&a)if(i.transition){var c=wr(i.transition);for(!o&&(o=n.style={}),u=0;u<c.length;u++){var h=a[_=c[u]];o[_]=h}}else if(t.getAnimationStyleProps&&k(e.transition,"style")>=0){var p=t.getAnimationStyleProps(),d=p?p.style:null;if(d){!o&&(o=n.style={});var f=N(i);for(u=0;u<f.length;u++)d[_=f[u]]&&(h=a[_],o[_]=h)}}var m=i.leaveTo;if(m){var g=N(m),y=$P(t),v=y.style||(y.style={});for(u=0;u<g.length;u++){var _;v[_=g[u]]=m[_]}}}}(e,n,u,d,a),f.style=u,function(t,e){var i=t.isGroup?null:t,n=e.style;if(i&&n){i.useStyle(n);var r=n.__decalPattern;r&&(i.style.decal=r);for(var o=i.animators,a=0;a<o.length;a++){var s=o[a];"style"===s.targetName&&s.changeTarget(i.style)}}e&&(e.style=null,e&&t.attr(e),e.style=n)}(e,f),function(t,e,i,n,r){if(n){var o=MP(t).userDuring,a={dataIndex:e,isFrom:!0,during:o?F(aL,{el:t,userDuring:o}):null};r?Nu(t,n,i,a):Bu(t,n,i,a)}}(e,i,o,d,a),function(t,e,i){ft(e,"silent")&&(t.silent=e.silent),ft(e,"ignore")&&(t.ignore=e.ignore),tL(t)&&ft(e,"invisible")&&(t.invisible=e.invisible),QP(t)&&ft(e,"autoBatch")&&(t.autoBatch=e.autoBatch),i||ft(e,"info")&&(MP(t).info=e.info)}(e,n,s),u?e.dirty():e.markRedraw()}var rL={},oL={setTransform:function(t,e){return rL.el[t]=e,this},getTransform:function(t){return rL.el[t]},setShape:function(t,e){return(rL.el.shape||(rL.el.shape={}))[t]=e,rL.isShapeDirty=!0,this},getShape:function(t){var e=rL.el.shape;if(e)return e[t]},setStyle:function(t,e){var i=rL.el.style;return i&&(i[t]=e,rL.isStyleDirty=!0),this},getStyle:function(t){var e=rL.el.style;if(e)return e[t]},setExtra:function(t,e){return(rL.el.extra||(rL.el.extra={}))[t]=e,this},getExtra:function(t){var e=rL.el.extra;if(e)return e[t]}};function aL(){var t=this,e=t.el;if(e){var i=MP(e).userDuring,n=t.userDuring;i===n?(rL.el=e,rL.isShapeDirty=!1,rL.isStyleDirty=!1,n(oL),rL.isShapeDirty&&e.dirtyShape&&e.dirtyShape(),rL.isStyleDirty&&e.dirtyStyle&&e.dirtyStyle()):t.el=t.userDuring=null}}function sL(t,e,i,n,r,o,a){var s=e.isGroup?null:e,l=r&&r[t].cfg;if(s){var u=s.ensureState(t);if(!1===n){var c=s.getState(t);c&&(c.style=null)}else u.style=n||null;l&&(u.textConfig=l),Ys(s)}}function lL(t,e,i){var n=i===HP,r=n?e:mL(e,i),o=r?r.z2:null;null!=o&&((n?t:t.ensureState(i)).z2=o||0)}function uL(t,e,i,n){var r=t.get("renderItem"),o=t.coordinateSystem,a={};o&&(a=o.prepareCustoms?o.prepareCustoms(o):JP[o.type](o));for(var s,l,u=C({getWidth:n.getWidth,getHeight:n.getHeight,getZr:n.getZr,getDevicePixelRatio:n.getDevicePixelRatio,value:function(t,i){return null==i&&(i=s),e.getStore().get(e.getDimensionIndex(t||0),i)},style:function(i,n){null==n&&(n=s);var r=e.getItemVisual(n,"style"),o=r&&r.fill,a=r&&r.opacity,l=v(n,HP).getItemStyle();null!=o&&(l.fill=o),null!=a&&(l.opacity=a);var u={inheritColor:$(o)?o:"#000"},c=_(n,HP),h=wc(c,null,u,!1,!0);h.text=c.getShallow("show")?et(t.getFormattedLabel(n,HP),kw(e,n)):null;var p=Sc(c,u,!1);return b(i,l),l=zP(l,h,p),i&&x(l,i),l.legacy=!0,l},ordinalRawValue:function(t,i){null==i&&(i=s),t=t||0;var n=e.getDimensionInfo(t);if(!n){var r=e.getDimensionIndex(t);return r>=0?e.getStore().get(r,i):void 0}var o=e.get(n.name,i),a=n&&n.ordinalMeta;return a?a.categories[o]:o},styleEmphasis:function(i,n){null==n&&(n=s);var r=v(n,WP).getItemStyle(),o=_(n,WP),a=wc(o,null,null,!0,!0);a.text=o.getShallow("show")?it(t.getFormattedLabel(n,WP),t.getFormattedLabel(n,HP),kw(e,n)):null;var l=Sc(o,null,!0);return b(i,r),r=zP(r,a,l),i&&x(r,i),r.legacy=!0,r},visual:function(t,i){if(null==i&&(i=s),ft(SP,t)){var n=e.getItemVisual(i,"style");return n?n[SP[t]]:null}if(ft(TP,t))return e.getItemVisual(i,t)},barLayout:function(t){if("cartesian2d"===o.type)return function(t){var e=[],i=t.axis,n="axis0";if("category"===i.type){for(var r=i.getBandWidth(),o=0;o<t.count;o++)e.push(C({bandWidth:r,axisKey:n,stackId:L_+o},t));var a=F_(e),s=[];for(o=0;o<t.count;o++){var l=a.axis0[L_+o];l.offsetCenter=l.offset+l.width/2,s.push(l)}return s}}(C({axis:o.getBaseAxis()},t))},currentSeriesIndices:function(){return i.getCurrentSeriesIndices()},font:function(t){return Ac(t,i)}},a.api||{}),c={context:{},seriesId:t.id,seriesName:t.name,seriesIndex:t.seriesIndex,coordSys:a.coordSys,dataInsideLength:e.count(),encode:cL(t.getData())},h={},p={},d={},f={},m=0;m<qP.length;m++){var g=qP[m];d[g]=t.getModel(XP[g]),f[g]=t.getModel(YP[g])}function y(t){return t===s?l||(l=e.getItemModel(t)):e.getItemModel(t)}function v(t,i){return e.hasItemOption?t===s?h[i]||(h[i]=y(t).getModel(XP[i])):y(t).getModel(XP[i]):d[i]}function _(t,i){return e.hasItemOption?t===s?p[i]||(p[i]=y(t).getModel(YP[i])):y(t).getModel(YP[i]):f[i]}return function(t,i){return s=t,l=null,h={},p={},r&&r(C({dataIndexInside:t,dataIndex:e.getRawIndex(t),actionType:i?i.type:null},c),u)};function x(t,e){for(var i in e)ft(e,i)&&(t[i]=e[i])}function b(t,e){t&&(t.textFill&&(e.textFill=t.textFill),t.textPosition&&(e.textPosition=t.textPosition))}}function cL(t){var e={};return L(t.dimensions,function(i){var n=t.getDimensionInfo(i);if(!n.isExtraCoord){var r=n.coordDim;(e[r]=e[r]||[])[n.coordDimIndex]=t.getDimensionIndex(i)}}),e}function hL(t,e,i,n,r,o,a){if(n){var s=pL(t,e,i,n,r,o);return s&&a.setItemGraphicEl(i,s),s&&pl(s,n.focus,n.blurScope),s}o.remove(e)}function pL(t,e,i,n,r,o,a){var s=-1,l=e;e&&dL(e,n,r)&&(s=k(o.childrenRef(),e),e=null);var u,c,h=!e,p=e;p?p.clearStates():(p=iL(n),l&&(u=l,(c=p).copyTransform(u),tL(c)&&tL(u)&&(c.setStyle(u.style),c.z=u.z,c.z2=u.z2,c.zlevel=u.zlevel,c.invisible=u.invisible,c.ignore=u.ignore,QP(c)&&QP(u)&&c.setShape(u.shape)))),!1===n.morph?p.disableMorphing=!0:p.disableMorphing&&(p.disableMorphing=!1),KP.normal.cfg=KP.normal.conOpt=KP.emphasis.cfg=KP.emphasis.conOpt=KP.blur.cfg=KP.blur.conOpt=KP.select.cfg=KP.select.conOpt=null,KP.isLegacy=!1,function(t,e,i,n,r,o){if(!t.isGroup){fL(i,null,o),fL(i,WP,o);var a=o.normal.conOpt,s=o.emphasis.conOpt,l=o.blur.conOpt,u=o.select.conOpt;if(null!=a||null!=s||null!=u||null!=l){var c=t.getTextContent();if(!1===a)c&&t.removeTextContent();else{a=o.normal.conOpt=a||{type:"text"},c?c.clearStates():(c=iL(a),t.setTextContent(c)),nL(null,c,e,a,null,n,r,!0);for(var h=a&&a.style,p=0;p<qP.length;p++){var d=qP[p],f;if(d!==HP)sL(d,c,0,gL(a,o[d].conOpt,d),null)}h?c.dirty():c.markRedraw()}}}}(p,i,n,r,h,KP),function(t,e,i,n,r){var o=i.clipPath;if(!1===o)t&&t.getClipPath()&&t.removeClipPath();else if(o){var a=t.getClipPath();a&&dL(a,o,n)&&(a=null),a||(a=iL(o),t.setClipPath(a)),nL(null,a,e,o,null,n,r,!1)}}(p,i,n,r,h),nL(t,p,i,n,KP,r,h,!1);for(var d=0;d<qP.length;d++){var f=qP[d],m;if(f!==HP)sL(f,p,0,gL(n,mL(n,f),f),KP)}return function(t,e,i){if(!t.isGroup){var n=t,r=i.currentZ,o=i.currentZLevel;n.z=r,n.zlevel=o;var a=e.z2;null!=a&&(n.z2=a||0);for(var s=0;s<qP.length;s++)lL(n,e,qP[s])}}(p,n,r),"group"===n.type&&function(t,e,i,n,r){var o=n.children,a=o?o.length:0,s=n.$mergeChildren,l="byName"===s||n.diffChildrenByName,u=!1===s;if(a||l||u){if(l)return c={api:t,oldChildren:e.children()||[],newChildren:o||[],dataIndex:i,seriesModel:r,group:e},void new Fv(c.oldChildren,c.newChildren,yL,yL,c).add(vL).update(vL).remove(_L).execute();var c;u&&e.removeAll();for(var h=0;h<a;h++)o[h]&&pL(t,e.childAt(h),i,o[h],r,e);for(var p=e.childCount()-1;p>=h;p--)xL(e.childAt(p),r,e)}}(t,p,i,n,r),s>=0?o.replaceAt(p,s):o.add(p),p}function dL(t,e,i){var n,r=MP(t),o=e.type,a=e.shape,s=e.style;return i.isUniversalTransitionEnabled()||null!=o&&o!==r.customGraphicType||"path"===o&&(n=a)&&(ft(n,"pathData")||ft(n,"d"))&&bL(a)!==r.customPathData||"image"===o&&ft(s,"image")&&s.image!==r.customImagePath}function fL(t,e,i){var n=e?mL(t,e):t,r=e?gL(t,n,WP):t.style,o=t.type,a=n?n.textConfig:null,s=t.textContent,l=s?e?mL(s,e):s:null;if(r&&(i.isLegacy||EP(r,o,!!a,!!l))){i.isLegacy=!0;var u=PP(r,o,!e);!a&&u.textConfig&&(a=u.textConfig),!l&&u.textContent&&(l=u.textContent)}if(!e&&l){var c=l;!c.type&&(c.type="text")}var h=e?i[e]:i.normal;h.cfg=a,h.conOpt=l}function mL(t,e){return e?t?t[e]:null:t}function gL(t,e,i){var n=e&&e.style;return null==n&&i===WP&&t&&(n=t.styleEmphasis),n}function yL(t,e){var i=t&&t.name;return null!=i?i:"e\0\0"+e}function vL(t,e){var i=this.context,n=null!=t?i.newChildren[t]:null,r=null!=e?i.oldChildren[e]:null;pL(i.api,r,i.dataIndex,n,i.seriesModel,i.group)}function _L(t){var e=this.context;xL(e.oldChildren[t],e.seriesModel,e.group)}function xL(t,e,i){if(t){var n=MP(t).leaveToProps;n?Bu(t,n,e,{cb:function(){i.remove(t)}}):i.remove(t)}}function bL(t){return t&&(t.pathData||t.d)}var wL=zr(),SL=S,TL=F,ML=function(){function t(){this._dragging=!1,this.animationThreshold=15}return t.prototype.render=function(t,e,i,n){var r=e.get("value"),o=e.get("status");if(this._axisModel=t,this._axisPointerModel=e,this._api=i,n||this._lastValue!==r||this._lastStatus!==o){this._lastValue=r,this._lastStatus=o;var a=this._group,s=this._handle;if(!o||"hide"===o)return a&&a.hide(),void(s&&s.hide());a&&a.show(),s&&s.show();var l={};this.makeElOption(l,r,t,e,i);var u=l.graphicKey;u!==this._lastGraphicKey&&this.clear(i),this._lastGraphicKey=u;var c=this._moveAnimation=this.determineAnimation(t,e);if(a){var h=V(IL,e,c);this.updatePointerEl(a,l,h),this.updateLabelEl(a,l,h,e)}else a=this._group=new Fn,this.createPointerEl(a,l,t,e),this.createLabelEl(a,l,t,e),i.getZr().add(a);DL(a,e,!0),this._renderHandle(r)}},t.prototype.remove=function(t){this.clear(t)},t.prototype.dispose=function(t){this.clear(t)},t.prototype.determineAnimation=function(t,e){var i=e.get("animation"),n=t.axis,r="category"===n.type,o=e.get("snap");if(!o&&!r)return!1;if("auto"===i||null==i){var a=this.animationThreshold;if(r&&n.getBandWidth()>a)return!0;if(o){var s=NT(t).seriesDataCount,l=n.getExtent();return Math.abs(l[0]-l[1])/s>a}return!1}return!0===i},t.prototype.makeElOption=function(t,e,i,n,r){},t.prototype.createPointerEl=function(t,e,i,n){var r=e.pointer;if(r){var o=wL(t).pointerEl=new gc[r.type](SL(e.pointer));t.add(o)}},t.prototype.createLabelEl=function(t,e,i,n){if(e.label){var r=wL(t).labelEl=new fs(SL(e.label));t.add(r),AL(r,n)}},t.prototype.updatePointerEl=function(t,e,i){var n=wL(t).pointerEl;n&&e.pointer&&(n.setStyle(e.pointer.style),i(n,{shape:e.pointer.shape}))},t.prototype.updateLabelEl=function(t,e,i,n){var r=wL(t).labelEl;r&&(r.setStyle(e.label.style),i(r,{x:e.label.x,y:e.label.y}),AL(r,n))},t.prototype._renderHandle=function(t){if(!this._dragging&&this.updateHandleTransform){var e,i=this._axisPointerModel,n=this._api.getZr(),r=this._handle,o=i.getModel("handle"),a=i.get("status");if(!o.get("show")||!a||"hide"===a)return r&&n.remove(r),void(this._handle=null);this._handle||(e=!0,r=this._handle=hc(o.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(t){ie(t.event)},onmousedown:TL(this._onHandleDragMove,this,0,0),drift:TL(this._onHandleDragMove,this),ondragend:TL(this._onHandleDragEnd,this)}),n.add(r)),DL(r,i,!1),r.setStyle(o.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var s=o.get("size");U(s)||(s=[s,s]),r.scaleX=s[0]/2,r.scaleY=s[1]/2,nm(this,"_doDispatchAxisPointer",o.get("throttle")||0,"fixRate"),this._moveHandleToValue(t,e)}},t.prototype._moveHandleToValue=function(t,e){IL(this._axisPointerModel,!e&&this._moveAnimation,this._handle,kL(this.getHandleTransform(t,this._axisModel,this._axisPointerModel)))},t.prototype._onHandleDragMove=function(t,e){var i=this._handle;if(i){this._dragging=!0;var n=this.updateHandleTransform(kL(i),[t,e],this._axisModel,this._axisPointerModel);this._payloadInfo=n,i.stopAnimation(),i.attr(kL(n)),wL(i).lastProp=null,this._doDispatchAxisPointer()}},t.prototype._doDispatchAxisPointer=function(){if(this._handle){var t=this._payloadInfo,e=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:t.cursorPoint[0],y:t.cursorPoint[1],tooltipOption:t.tooltipOption,axesInfo:[{axisDim:e.axis.dim,axisIndex:e.componentIndex}]})}},t.prototype._onHandleDragEnd=function(){if(this._dragging=!1,this._handle){var t=this._axisPointerModel.get("value");this._moveHandleToValue(t),this._api.dispatchAction({type:"hideTip"})}},t.prototype.clear=function(t){this._lastValue=null,this._lastStatus=null;var e=t.getZr(),i=this._group,n=this._handle;e&&i&&(this._lastGraphicKey=null,i&&e.remove(i),n&&e.remove(n),this._group=null,this._handle=null,this._payloadInfo=null)},t.prototype.doClear=function(){},t.prototype.buildLabel=function(t,e,i){return{x:t[i=i||0],y:t[1-i],width:e[i],height:e[1-i]}},t}();function IL(t,e,i,n){CL(wL(i).lastProp,n)||(wL(i).lastProp=n,e?Bu(i,n,t):(i.stopAnimation(),i.attr(n)))}function CL(t,e){if(j(t)&&j(e)){var i=!0;return L(e,function(e,n){i=i&&CL(t[n],e)}),!!i}return t===e}function AL(t,e){t[e.get(["label","show"])?"show":"hide"]()}function kL(t){return{x:t.x||0,y:t.y||0,rotation:t.rotation||0}}function DL(t,e,i){var n=e.get("z"),r=e.get("zlevel");t&&t.traverse(function(t){"group"!==t.type&&(null!=n&&(t.z=n),null!=r&&(t.zlevel=r),t.silent=i)})}function EL(t){var e,i=t.get("type"),n=t.getModel(i+"Style");return"line"===i?(e=n.getLineStyle()).fill=null:"shadow"===i&&((e=n.getAreaStyle()).stroke=null),e}function PL(t,e,i,n,r){var o=LL(i.get("value"),e.axis,e.ecModel,i.get("seriesDataIndices"),{precision:i.get(["label","precision"]),formatter:i.get(["label","formatter"])}),a=i.getModel("label"),s=Lh(a.get("padding")||0),l=a.getFont(),u=Sn(o,l),c=r.position,h=u.width+s[1]+s[3],p=u.height+s[0]+s[2],d=r.align;"right"===d&&(c[0]-=h),"center"===d&&(c[0]-=h/2);var f=r.verticalAlign;"bottom"===f&&(c[1]-=p),"middle"===f&&(c[1]-=p/2),function(t,e,i,n){var r=n.getWidth(),o=n.getHeight();t[0]=Math.min(t[0]+e,r)-e,t[1]=Math.min(t[1]+i,o)-i,t[0]=Math.max(t[0],0),t[1]=Math.max(t[1],0)}(c,h,p,n);var m=a.get("backgroundColor");m&&"auto"!==m||(m=e.get(["axisLine","lineStyle","color"])),t.label={x:c[0],y:c[1],style:wc(a,{text:o,font:l,fill:a.getTextColor(),padding:s,backgroundColor:m}),z2:10}}function LL(t,e,i,n,r){t=e.scale.parse(t);var o=e.scale.getLabel({value:t},{precision:r.precision}),a=r.formatter;if(a){var s={value:_x(e,{value:t}),axisDimension:e.dim,axisIndex:e.index,seriesData:[]};L(n,function(t){var e=i.getSeriesByIndex(t.seriesIndex),n=t.dataIndexInside,r=e&&e.getDataParams(n);r&&s.seriesData.push(r)}),$(a)?o=a.replace("{value}",o):G(a)&&(o=a(s))}return o}function zL(t,e,i){var n=[1,0,0,1,0,0];return Hi(n,n,i.rotation),Wi(n,n,i.position),oc([t.dataToCoord(e),(i.labelOffset||0)+(i.labelDirection||1)*(i.labelMargin||0)],n)}function OL(t,e,i,n,r,o){var a=kT.innerTextLayout(i.rotation,0,i.labelDirection);i.labelMargin=r.get(["label","margin"]),PL(e,n,r,o,{position:zL(n.axis,t,i),align:a.textAlign,verticalAlign:a.textVerticalAlign})}function RL(t,e,i){return{x1:t[i=i||0],y1:t[1-i],x2:e[i],y2:e[1-i]}}function BL(t,e,i){return{x:t[i=i||0],y:t[1-i],width:e[i],height:e[1-i]}}function NL(t,e,i,n,r,o){return{cx:t,cy:e,r0:i,r:n,startAngle:r,endAngle:o,clockwise:!0}}var FL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.makeElOption=function(t,e,i,n,r){var o=i.axis,a=o.grid,s=n.get("type"),l=VL(a,o).getOtherAxis(o).getGlobalExtent(),u=o.toGlobalCoord(o.dataToCoord(e,!0));if(s&&"none"!==s){var c=EL(n),h=UL[s](o,u,l);h.style=c,t.graphicKey=h.type,t.pointer=h}OL(e,t,bT(a.model,i),i,n,r)},e.prototype.getHandleTransform=function(t,e,i){var n=bT(e.axis.grid.model,e,{labelInside:!1});n.labelMargin=i.get(["handle","margin"]);var r=zL(e.axis,t,n);return{x:r[0],y:r[1],rotation:n.rotation+(n.labelDirection<0?Math.PI:0)}},e.prototype.updateHandleTransform=function(t,e,i,n){var r=i.axis,o=r.grid,a=r.getGlobalExtent(!0),s=VL(o,r).getOtherAxis(r).getGlobalExtent(),l="x"===r.dim?0:1,u=[t.x,t.y];u[l]+=e[l],u[l]=Math.min(a[1],u[l]),u[l]=Math.max(a[0],u[l]);var c=(s[1]+s[0])/2,h=[c,c];return h[l]=u[l],{x:u[0],y:u[1],rotation:t.rotation,cursorPoint:h,tooltipOption:[{verticalAlign:"middle"},{align:"center"}][l]}},e}(ML);function VL(t,e){var i={};return i[e.dim+"AxisIndex"]=e.index,t.getCartesian(i)}var UL={line:function(t,e,i){return{type:"Line",subPixelOptimize:!0,shape:RL([e,i[0]],[e,i[1]],GL(t))}},shadow:function(t,e,i){var n=Math.max(1,t.getBandWidth()),r=i[1]-i[0];return{type:"Rect",shape:BL([e-n/2,i[0]],[n,r],GL(t))}}};function GL(t){return"x"===t.dim?0:1}var $L=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.type="axisPointer",e.defaultOption={show:"auto",zlevel:0,z:50,type:"line",snap:!1,triggerTooltip:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#B9BEC9",width:1,type:"dashed"},shadowStyle:{color:"rgba(210,219,238,0.2)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}},e}(ip),WL=zr(),HL=L;function jL(t,e,i){if(!a.node){var n=e.getZr();WL(n).records||(WL(n).records={}),function(t,e){function i(i,n){t.on(i,function(i){var r=function(t){var e={showTip:[],hideTip:[]},i=function(n){var r=e[n.type];r?r.push(n):(n.dispatchAction=i,t.dispatchAction(n))};return{dispatchAction:i,pendings:e}}(e);HL(WL(t).records,function(t){t&&n(t,i,r.dispatchAction)}),function(t,e){var i,n=t.showTip.length,r=t.hideTip.length;n?i=t.showTip[n-1]:r&&(i=t.hideTip[r-1]),i&&(i.dispatchAction=null,e.dispatchAction(i))}(r.pendings,e)})}WL(t).initialized||(WL(t).initialized=!0,i("click",V(qL,"click")),i("mousemove",V(qL,"mousemove")),i("globalout",ZL))}(n,e),(WL(n).records[t]||(WL(n).records[t]={})).handler=i}}function ZL(t,e,i){t.handler("leave",null,i)}function qL(t,e,i,n){e.handler(t,i,n)}function XL(t,e){if(!a.node){var i=e.getZr();(WL(i).records||{})[t]&&(WL(i).records[t]=null)}}var YL=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(t,e,i){var n=e.getComponent("tooltip"),r=t.get("triggerOn")||n&&n.get("triggerOn")||"mousemove|click";jL("axisPointer",i,function(t,e,i){"none"!==r&&("leave"===t||r.indexOf(t)>=0)&&i({type:"updateAxisPointer",currTrigger:t,x:e&&e.offsetX,y:e&&e.offsetY})})},e.prototype.remove=function(t,e){XL("axisPointer",e)},e.prototype.dispose=function(t,e){XL("axisPointer",e)},e.type="axisPointer",e}($f);function KL(t,e){var i,n=[],r=t.seriesIndex;if(null==r||!(i=e.getSeriesByIndex(r)))return{point:[]};var o=i.getData(),a=Lr(o,t);if(null==a||a<0||U(a))return{point:[]};var s=o.getItemGraphicEl(a),l=i.coordinateSystem;if(i.getTooltipPosition)n=i.getTooltipPosition(a)||[];else if(l&&l.dataToPoint)if(t.isStacked){var u=l.getBaseAxis(),c=l.getOtherAxis(u).dim,h=u.dim,p="x"===c||"radius"===c?1:0,d=o.mapDimension(h),f=[];f[p]=o.get(d,a),f[1-p]=o.get(o.getCalculationInfo("stackResultDimension"),a),n=l.dataToPoint(f)||[]}else n=l.dataToPoint(o.getValues(z(l.dimensions,function(t){return o.mapDimension(t)}),a))||[];else if(s){var m=s.getBoundingRect().clone();m.applyTransform(s.transform),n=[m.x+m.width/2,m.y+m.height/2]}return{point:n,el:s}}var JL=zr();function QL(t,e,i){var n=t.currTrigger,r=[t.x,t.y],o=t,a=t.dispatchAction||F(i.dispatchAction,i),s=e.getComponent("axisPointer").coordSysAxesInfo;if(s){rz(r)&&(r=KL({seriesIndex:o.seriesIndex,dataIndex:o.dataIndex},e).point);var l=rz(r),u=o.axesInfo,c=s.axesInfo,h="leave"===n||rz(r),p={},d={},f={list:[],map:{}},m={showPointer:V(ez,d),showTooltip:V(iz,f)};L(s.coordSysMap,function(t,e){var i=l||t.containPoint(r);L(s.coordSysAxesInfo[e],function(t,e){var n=t.axis,o=function(t,e){for(var i=0;i<(t||[]).length;i++){var n=t[i];if(e.axis.dim===n.axisDim&&e.axis.model.componentIndex===n.axisIndex)return n}}(u,t);if(!h&&i&&(!u||o)){var a=o&&o.value;null!=a||l||(a=n.pointToData(r)),null!=a&&tz(t,a,m,!1,p)}})});var g={};return L(c,function(t,e){var i=t.linkGroup;i&&!d[e]&&L(i.axesInfo,function(e,n){var r=d[n];if(e!==t&&r){var o=r.value;i.mapper&&(o=t.axis.scale.parse(i.mapper(o,nz(e),nz(t)))),g[t.key]=o}})}),L(g,function(t,e){tz(c[e],t,m,!0,p)}),function(t,e,i){var n=i.axesInfo=[];L(e,function(e,i){var r=e.axisPointerModel.option,o=t[i];o?(!e.useHandle&&(r.status="show"),r.value=o.value,r.seriesDataIndices=(o.payloadBatch||[]).slice()):!e.useHandle&&(r.status="hide"),"show"===r.status&&n.push({axisDim:e.axis.dim,axisIndex:e.axis.model.componentIndex,value:r.value})})}(d,c,p),function(t,e,i,n){if(!rz(e)&&t.list.length){var r=((t.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};n({type:"showTip",escapeConnect:!0,x:e[0],y:e[1],tooltipOption:i.tooltipOption,position:i.position,dataIndexInside:r.dataIndexInside,dataIndex:r.dataIndex,seriesIndex:r.seriesIndex,dataByCoordSys:t.list})}else n({type:"hideTip"})}(f,r,t,a),function(t,e,i){var n=i.getZr(),r="axisPointerLastHighlights",o=JL(n)[r]||{},a=JL(n)[r]={};L(t,function(t,e){var i=t.axisPointerModel.option;"show"===i.status&&L(i.seriesDataIndices,function(t){var e=t.seriesIndex+" | "+t.dataIndex;a[e]=t})});var s=[],l=[];L(o,function(t,e){!a[e]&&l.push(t)}),L(a,function(t,e){!o[e]&&s.push(t)}),l.length&&i.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:l}),s.length&&i.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:s})}(c,0,i),p}}function tz(t,e,i,n,r){var o=t.axis;if(!o.scale.isBlank()&&o.containData(e))if(t.involveSeries){var a=function(t,e){var i=e.axis,n=i.dim,r=t,o=[],a=Number.MAX_VALUE,s=-1;return L(e.seriesModels,function(e,l){var u,c,h=e.getData().mapDimensionsAll(n);if(e.getAxisTooltipData){var p=e.getAxisTooltipData(h,t,i);c=p.dataIndices,u=p.nestestValue}else{if(!(c=e.getData().indicesOfNearest(h[0],t,"category"===i.type?.5:null)).length)return;u=e.getData().get(h[0],c[0])}if(null!=u&&isFinite(u)){var d=t-u,f=Math.abs(d);f<=a&&((f<a||d>=0&&s<0)&&(a=f,s=d,r=u,o.length=0),L(c,function(t){o.push({seriesIndex:e.seriesIndex,dataIndexInside:t,dataIndex:e.getData().getRawIndex(t)})}))}}),{payloadBatch:o,snapToValue:r}}(e,t),s=a.payloadBatch,l=a.snapToValue;s[0]&&null==r.seriesIndex&&I(r,s[0]),!n&&t.snap&&o.containData(l)&&null!=l&&(e=l),i.showPointer(t,e,s),i.showTooltip(t,a,l)}else i.showPointer(t,e)}function ez(t,e,i,n){t[e.key]={value:i,payloadBatch:n}}function iz(t,e,i,n){var r=i.payloadBatch,o=e.axis,a=o.model,s=e.axisPointerModel;if(e.triggerTooltip&&r.length){var l=e.coordSys.model,u=VT(l),c=t.map[u];c||(c=t.map[u]={coordSysId:l.id,coordSysIndex:l.componentIndex,coordSysType:l.type,coordSysMainType:l.mainType,dataByAxis:[]},t.list.push(c)),c.dataByAxis.push({axisDim:o.dim,axisIndex:a.componentIndex,axisType:a.type,axisId:a.id,value:n,valueLabelOpt:{precision:s.get(["label","precision"]),formatter:s.get(["label","formatter"])},seriesDataIndices:r.slice()})}}function nz(t){var e=t.axis.model,i={},n=i.axisDim=t.axis.dim;return i.axisIndex=i[n+"AxisIndex"]=e.componentIndex,i.axisName=i[n+"AxisName"]=e.name,i.axisId=i[n+"AxisId"]=e.id,i}function rz(t){return!t||null==t[0]||isNaN(t[0])||null==t[1]||isNaN(t[1])}function oz(t){GT.registerAxisPointerClass("CartesianAxisPointer",FL),t.registerComponentModel($L),t.registerComponentView(YL),t.registerPreprocessor(function(t){if(t){(!t.axisPointer||0===t.axisPointer.length)&&(t.axisPointer={});var e=t.axisPointer.link;e&&!U(e)&&(t.axisPointer.link=[e])}}),t.registerProcessor(t.PRIORITY.PROCESSOR.STATISTIC,function(t,e){t.getComponent("axisPointer").coordSysAxesInfo=OT(t,e)}),t.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},QL)}var az=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.makeElOption=function(t,e,i,n,r){var o=i.axis;"angle"===o.dim&&(this.animationThreshold=Math.PI/18);var a=o.polar,s=a.getOtherAxis(o).getExtent(),l=o.dataToCoord(e),u=n.get("type");if(u&&"none"!==u){var c=EL(n),h=sz[u](o,a,l,s);h.style=c,t.graphicKey=h.type,t.pointer=h}var p=function(t,e,i,n,r){var o=e.axis,a=o.dataToCoord(t),s=n.getAngleAxis().getExtent()[0];s=s/180*Math.PI;var l,u,c,h=n.getRadiusAxis().getExtent();if("radius"===o.dim){var p=[1,0,0,1,0,0];Hi(p,p,s),Wi(p,p,[n.cx,n.cy]),l=oc([a,-r],p);var d=e.getModel("axisLabel").get("rotate")||0,f=kT.innerTextLayout(s,d*Math.PI/180,-1);u=f.textAlign,c=f.textVerticalAlign}else{var m=h[1];l=n.coordToPoint([m+r,a]);var g=n.cx,y=n.cy;u=Math.abs(l[0]-g)/m<.3?"center":l[0]>g?"left":"right",c=Math.abs(l[1]-y)/m<.3?"middle":l[1]>y?"top":"bottom"}return{position:l,align:u,verticalAlign:c}}(e,i,0,a,n.get(["label","margin"]));PL(t,i,n,r,p)},e}(ML),sz={line:function(t,e,i,n){return"angle"===t.dim?{type:"Line",shape:RL(e.coordToPoint([n[0],i]),e.coordToPoint([n[1],i]))}:{type:"Circle",shape:{cx:e.cx,cy:e.cy,r:i}}},shadow:function(t,e,i,n){var r=Math.max(1,t.getBandWidth()),o=Math.PI/180;return"angle"===t.dim?{type:"Sector",shape:NL(e.cx,e.cy,n[0],n[1],(-i-r/2)*o,(r/2-i)*o)}:{type:"Sector",shape:NL(e.cx,e.cy,i-r/2,i+r/2,0,2*Math.PI)}}},lz=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.findAxisModel=function(t){var e;return this.ecModel.eachComponent(t,function(t){t.getCoordSysModel()===this&&(e=t)},this),e},e.type="polar",e.dependencies=["radiusAxis","angleAxis"],e.defaultOption={zlevel:0,z:0,center:["50%","50%"],radius:"80%"},e}(ip),uz=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getCoordSysModel=function(){return this.getReferringComponents("polar",Nr).models[0]},e.type="polarAxis",e}(ip);E(uz,Mx);var cz=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.type="angleAxis",e}(uz),hz=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.type="radiusAxis",e}(uz),pz=function(t){function e(e,i){return t.call(this,"radius",e,i)||this}return i(e,t),e.prototype.pointToData=function(t,e){return this.polar.pointToData(t,e)["radius"===this.dim?0:1]},e}($x);pz.prototype.dataToRadius=$x.prototype.dataToCoord,pz.prototype.radiusToData=$x.prototype.coordToData;var dz=zr(),fz=function(t){function e(e,i){return t.call(this,"angle",e,i||[0,360])||this}return i(e,t),e.prototype.pointToData=function(t,e){return this.polar.pointToData(t,e)["radius"===this.dim?0:1]},e.prototype.calculateCategoryInterval=function(){var t=this,e=t.getLabelModel(),i=t.scale,n=i.getExtent(),r=i.count();if(n[1]-n[0]<1)return 0;var o=n[0],a=t.dataToCoord(o+1)-t.dataToCoord(o),s=Math.abs(a),l=Sn(null==o?"":o+"",e.getFont(),"center","top"),u=Math.max(l.height,7)/s;isNaN(u)&&(u=1/0);var c=Math.max(0,Math.floor(u)),h=dz(t.model),p=h.lastAutoInterval,d=h.lastTickCount;return null!=p&&null!=d&&Math.abs(p-c)<=1&&Math.abs(d-r)<=1&&p>c?c=p:(h.lastTickCount=r,h.lastAutoInterval=c),c},e}($x);fz.prototype.dataToAngle=$x.prototype.dataToCoord,fz.prototype.angleToData=$x.prototype.coordToData;var mz=["radius","angle"],gz=function(){function t(t){this.dimensions=mz,this.type="polar",this.cx=0,this.cy=0,this._radiusAxis=new pz,this._angleAxis=new fz,this.axisPointerEnabled=!0,this.name=t||"",this._radiusAxis.polar=this._angleAxis.polar=this}return t.prototype.containPoint=function(t){var e=this.pointToCoord(t);return this._radiusAxis.contain(e[0])&&this._angleAxis.contain(e[1])},t.prototype.containData=function(t){return this._radiusAxis.containData(t[0])&&this._angleAxis.containData(t[1])},t.prototype.getAxis=function(t){return this["_"+t+"Axis"]},t.prototype.getAxes=function(){return[this._radiusAxis,this._angleAxis]},t.prototype.getAxesByScale=function(t){var e=[],i=this._angleAxis,n=this._radiusAxis;return i.scale.type===t&&e.push(i),n.scale.type===t&&e.push(n),e},t.prototype.getAngleAxis=function(){return this._angleAxis},t.prototype.getRadiusAxis=function(){return this._radiusAxis},t.prototype.getOtherAxis=function(t){var e=this._angleAxis;return t===e?this._radiusAxis:e},t.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis()},t.prototype.getTooltipAxes=function(t){var e=null!=t&&"auto"!==t?this.getAxis(t):this.getBaseAxis();return{baseAxes:[e],otherAxes:[this.getOtherAxis(e)]}},t.prototype.dataToPoint=function(t,e){return this.coordToPoint([this._radiusAxis.dataToRadius(t[0],e),this._angleAxis.dataToAngle(t[1],e)])},t.prototype.pointToData=function(t,e){var i=this.pointToCoord(t);return[this._radiusAxis.radiusToData(i[0],e),this._angleAxis.angleToData(i[1],e)]},t.prototype.pointToCoord=function(t){var e=t[0]-this.cx,i=t[1]-this.cy,n=this.getAngleAxis(),r=n.getExtent(),o=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);n.inverse?o=a-360:a=o+360;for(var s=Math.sqrt(e*e+i*i),l=Math.atan2(-(i/=s),e/=s)/Math.PI*180,u=l<o?1:-1;l<o||l>a;)l+=360*u;return[s,l]},t.prototype.coordToPoint=function(t){var e=t[0],i=t[1]/180*Math.PI;return[Math.cos(i)*e+this.cx,-Math.sin(i)*e+this.cy]},t.prototype.getArea=function(){var t=this.getAngleAxis(),e=this.getRadiusAxis().getExtent().slice();e[0]>e[1]&&e.reverse();var i=t.getExtent(),n=Math.PI/180;return{cx:this.cx,cy:this.cy,r0:e[0],r:e[1],startAngle:-i[0]*n,endAngle:-i[1]*n,clockwise:t.inverse,contain:function(t,e){var i=t-this.cx,n=e-this.cy,r=i*i+n*n,o=this.r,a=this.r0;return r<=o*o&&r>=a*a}}},t.prototype.convertToPixel=function(t,e,i){return yz(e)===this?this.dataToPoint(i):null},t.prototype.convertFromPixel=function(t,e,i){return yz(e)===this?this.pointToData(i):null},t}();function yz(t){var e=t.seriesModel,i=t.polarModel;return i&&i.coordinateSystem||e&&e.coordinateSystem}function vz(t,e){var i=this,n=i.getAngleAxis(),r=i.getRadiusAxis();if(n.scale.setExtent(1/0,-1/0),r.scale.setExtent(1/0,-1/0),t.eachSeries(function(t){if(t.coordinateSystem===i){var e=t.getData();L(Tx(e,"radius"),function(t){r.scale.unionExtentFromData(e,t)}),L(Tx(e,"angle"),function(t){n.scale.unionExtentFromData(e,t)})}}),gx(n.scale,n.model),gx(r.scale,r.model),"category"===n.type&&!n.onBand){var o=n.getExtent(),a=360/n.scale.count();n.inverse?o[1]+=a:o[1]-=a,n.setExtent(o[0],o[1])}}function _z(t,e){if(t.type=e.get("type"),t.scale=yx(e),t.onBand=e.get("boundaryGap")&&"category"===t.type,t.inverse=e.get("inverse"),function(t){return"angleAxis"===t.mainType}(e)){t.inverse=t.inverse!==e.get("clockwise");var i=e.get("startAngle");t.setExtent(i,i+(t.inverse?-360:360))}e.axis=t,t.model=e}var xz={dimensions:mz,create:function(t,e){var i=[];return t.eachComponent("polar",function(t,n){var r=new gz(n+"");r.update=vz;var o=r.getRadiusAxis(),a=r.getAngleAxis(),s=t.findAxisModel("radiusAxis"),l=t.findAxisModel("angleAxis");_z(o,s),_z(a,l),function(t,e,i){var n=e.get("center"),r=i.getWidth(),o=i.getHeight();t.cx=Xn(n[0],r),t.cy=Xn(n[1],o);var a=t.getRadiusAxis(),s=Math.min(r,o)/2,l=e.get("radius");null==l?l=[0,"100%"]:U(l)||(l=[0,l]);var u=[Xn(l[0],s),Xn(l[1],s)];a.inverse?a.setExtent(u[1],u[0]):a.setExtent(u[0],u[1])}(r,t,e),i.push(r),t.coordinateSystem=r,r.model=t}),t.eachSeries(function(t){if("polar"===t.get("coordinateSystem")){var e=t.getReferringComponents("polar",Nr).models[0];t.coordinateSystem=e.coordinateSystem}}),i}},bz=["axisLine","axisLabel","axisTick","minorTick","splitLine","minorSplitLine","splitArea"];function wz(t,e,i){e[1]>e[0]&&(e=e.slice().reverse());var n=t.coordToPoint([e[0],i]),r=t.coordToPoint([e[1],i]);return{x1:n[0],y1:n[1],x2:r[0],y2:r[1]}}function Sz(t){return t.getRadiusAxis().inverse?0:1}function Tz(t){var e=t[0],i=t[t.length-1];e&&i&&Math.abs(Math.abs(e.coord-i.coord)-360)<1e-4&&t.pop()}var Mz=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.axisPointerClass="PolarAxisPointer",i}return i(e,t),e.prototype.render=function(t,e){if(this.group.removeAll(),t.get("show")){var i=t.axis,n=i.polar,r=n.getRadiusAxis().getExtent(),o=i.getTicksCoords(),a=i.getMinorTicksCoords(),s=z(i.getViewLabels(),function(t){t=S(t);var e=i.scale,n="ordinal"===e.type?e.getRawOrdinalNumber(t.tickValue):t.tickValue;return t.coord=i.dataToCoord(n),t});Tz(s),Tz(o),L(bz,function(e){!t.get([e,"show"])||i.scale.isBlank()&&"axisLine"!==e||Iz[e](this.group,t,n,o,a,r,s)},this)}},e.type="angleAxis",e}(GT),Iz={axisLine:function(t,e,i,n,r,o){var a,s=e.getModel(["axisLine","lineStyle"]),l=Sz(i),u=l?0:1;(a=0===o[u]?new Gl({shape:{cx:i.cx,cy:i.cy,r:o[l]},style:s.getLineStyle(),z2:1,silent:!0}):new su({shape:{cx:i.cx,cy:i.cy,r:o[l],r0:o[u]},style:s.getLineStyle(),z2:1,silent:!0})).style.fill=null,t.add(a)},axisTick:function(t,e,i,n,r,o){var a=e.getModel("axisTick"),s=(a.get("inside")?-1:1)*a.get("length"),l=o[Sz(i)],u=z(n,function(t){return new gu({shape:wz(i,[l,l+s],t.coord)})});t.add(ec(u,{style:C(a.getModel("lineStyle").getLineStyle(),{stroke:e.get(["axisLine","lineStyle","color"])})}))},minorTick:function(t,e,i,n,r,o){if(r.length){for(var a=e.getModel("axisTick"),s=e.getModel("minorTick"),l=(a.get("inside")?-1:1)*s.get("length"),u=o[Sz(i)],c=[],h=0;h<r.length;h++)for(var p=0;p<r[h].length;p++)c.push(new gu({shape:wz(i,[u,u+l],r[h][p].coord)}));t.add(ec(c,{style:C(s.getModel("lineStyle").getLineStyle(),C(a.getLineStyle(),{stroke:e.get(["axisLine","lineStyle","color"])}))}))}},axisLabel:function(t,e,i,n,r,o,a){var s=e.getCategories(!0),l=e.getModel("axisLabel"),u=l.get("margin"),c=e.get("triggerEvent");L(a,function(n,r){var a=l,h=n.tickValue,p=o[Sz(i)],d=i.coordToPoint([p+u,n.coord]),f=i.cx,m=i.cy,g=Math.abs(d[0]-f)/p<.3?"center":d[0]>f?"left":"right",y=Math.abs(d[1]-m)/p<.3?"middle":d[1]>m?"top":"bottom";if(s&&s[h]){var v=s[h];j(v)&&v.textStyle&&(a=new $c(v.textStyle,l,l.ecModel))}var _=new fs({silent:kT.isLabelSilent(e),style:wc(a,{x:d[0],y:d[1],fill:a.getTextColor()||e.get(["axisLine","lineStyle","color"]),text:n.formattedLabel,align:g,verticalAlign:y})});if(t.add(_),c){var x=kT.makeAxisEventDataBase(e);x.targetType="axisLabel",x.value=n.rawLabel,Ss(_).eventData=x}},this)},splitLine:function(t,e,i,n,r,o){var a=e.getModel("splitLine").getModel("lineStyle"),s=a.get("color"),l=0;s=s instanceof Array?s:[s];for(var u=[],c=0;c<n.length;c++){var h=l++%s.length;u[h]=u[h]||[],u[h].push(new gu({shape:wz(i,o,n[c].coord)}))}for(c=0;c<u.length;c++)t.add(ec(u[c],{style:C({stroke:s[c%s.length]},a.getLineStyle()),silent:!0,z:e.get("z")}))},minorSplitLine:function(t,e,i,n,r,o){if(r.length){for(var a=e.getModel("minorSplitLine").getModel("lineStyle"),s=[],l=0;l<r.length;l++)for(var u=0;u<r[l].length;u++)s.push(new gu({shape:wz(i,o,r[l][u].coord)}));t.add(ec(s,{style:a.getLineStyle(),silent:!0,z:e.get("z")}))}},splitArea:function(t,e,i,n,r,o){if(n.length){var a=e.getModel("splitArea").getModel("areaStyle"),s=a.get("color"),l=0;s=s instanceof Array?s:[s];for(var u=[],c=Math.PI/180,h=-n[0].coord*c,p=Math.min(o[0],o[1]),d=Math.max(o[0],o[1]),f=e.get("clockwise"),m=1,g=n.length;m<=g;m++){var y=m===g?n[0].coord:n[m].coord,v=l++%s.length;u[v]=u[v]||[],u[v].push(new ou({shape:{cx:i.cx,cy:i.cy,r0:p,r:d,startAngle:h,endAngle:-y*c,clockwise:f},silent:!0})),h=-y*c}for(m=0;m<u.length;m++)t.add(ec(u[m],{style:C({fill:s[m%s.length]},a.getAreaStyle()),silent:!0}))}}},Cz=["axisLine","axisTickLabel","axisName"],Az=["splitLine","splitArea","minorSplitLine"],kz=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.axisPointerClass="PolarAxisPointer",i}return i(e,t),e.prototype.render=function(t,e){if(this.group.removeAll(),t.get("show")){var i=this._axisGroup,n=this._axisGroup=new Fn;this.group.add(n);var r=t.axis,o=r.polar,a=o.getAngleAxis(),s=r.getTicksCoords(),l=r.getMinorTicksCoords(),u=a.getExtent()[0],c=r.getExtent(),h=function(t,e,i){return{position:[t.cx,t.cy],rotation:i/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:e.getModel("axisLabel").get("rotate"),z2:1}}(o,t,u),p=new kT(t,h);L(Cz,p.add,p),n.add(p.getGroup()),lc(i,n,t),L(Az,function(e){t.get([e,"show"])&&!r.scale.isBlank()&&Dz[e](this.group,t,o,u,c,s,l)},this)}},e.type="radiusAxis",e}(GT),Dz={splitLine:function(t,e,i,n,r,o){var a=e.getModel("splitLine").getModel("lineStyle"),s=a.get("color"),l=0;s=s instanceof Array?s:[s];for(var u=[],c=0;c<o.length;c++){var h=l++%s.length;u[h]=u[h]||[],u[h].push(new Gl({shape:{cx:i.cx,cy:i.cy,r:o[c].coord}}))}for(c=0;c<u.length;c++)t.add(ec(u[c],{style:C({stroke:s[c%s.length],fill:null},a.getLineStyle()),silent:!0}))},minorSplitLine:function(t,e,i,n,r,o,a){if(a.length){for(var s=e.getModel("minorSplitLine").getModel("lineStyle"),l=[],u=0;u<a.length;u++)for(var c=0;c<a[u].length;c++)l.push(new Gl({shape:{cx:i.cx,cy:i.cy,r:a[u][c].coord}}));t.add(ec(l,{style:C({fill:null},s.getLineStyle()),silent:!0}))}},splitArea:function(t,e,i,n,r,o){if(o.length){var a=e.getModel("splitArea").getModel("areaStyle"),s=a.get("color"),l=0;s=s instanceof Array?s:[s];for(var u=[],c=o[0].coord,h=1;h<o.length;h++){var p=l++%s.length;u[p]=u[p]||[],u[p].push(new ou({shape:{cx:i.cx,cy:i.cy,r0:c,r:o[h].coord,startAngle:0,endAngle:2*Math.PI},silent:!0})),c=o[h].coord}for(h=0;h<u.length;h++)t.add(ec(u[h],{style:C({fill:s[h%s.length]},a.getAreaStyle()),silent:!0}))}}};function Ez(t){return t.get("stack")||"__ec_stack_"+t.seriesIndex}function Pz(t,e){return e.dim+t.model.componentIndex}function Lz(t,e,i){var n={},r=function(t){var e={};L(t,function(t,i){var n=t.getData(),r=t.coordinateSystem,o=r.getBaseAxis(),a=Pz(r,o),s=o.getExtent(),l="category"===o.type?o.getBandWidth():Math.abs(s[1]-s[0])/n.count(),u=e[a]||{bandWidth:l,remainedWidth:l,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},c=u.stacks;e[a]=u;var h=Ez(t);c[h]||u.autoWidthCount++,c[h]=c[h]||{width:0,maxWidth:0};var p=Xn(t.get("barWidth"),l),d=Xn(t.get("barMaxWidth"),l),f=t.get("barGap"),m=t.get("barCategoryGap");p&&!c[h].width&&(p=Math.min(u.remainedWidth,p),c[h].width=p,u.remainedWidth-=p),d&&(c[h].maxWidth=d),null!=f&&(u.gap=f),null!=m&&(u.categoryGap=m)});var i={};return L(e,function(t,e){i[e]={};var n=t.stacks,r=t.bandWidth,o=Xn(t.categoryGap,r),a=Xn(t.gap,1),s=t.remainedWidth,l=t.autoWidthCount,u=(s-o)/(l+(l-1)*a);u=Math.max(u,0),L(n,function(t,e){var i=t.maxWidth;i&&i<u&&(i=Math.min(i,s),t.width&&(i=Math.min(i,t.width)),s-=i,t.width=i,l--)}),u=Math.max(u=(s-o)/(l+(l-1)*a),0);var c,h=0;L(n,function(t,e){t.width||(t.width=u),c=t,h+=t.width*(1+a)}),c&&(h-=c.width*a);var p=-h/2;L(n,function(t,n){i[e][n]=i[e][n]||{offset:p,width:t.width},p+=t.width*(1+a)})}),i}(R(e.getSeriesByType(t),function(t){return!e.isSeriesFiltered(t)&&t.coordinateSystem&&"polar"===t.coordinateSystem.type}));e.eachSeriesByType(t,function(t){if("polar"===t.coordinateSystem.type){var e=t.getData(),i=t.coordinateSystem,o=i.getBaseAxis(),a=Pz(i,o),s=Ez(t),l=r[a][s],u=l.offset,c=l.width,h=i.getOtherAxis(o),p=t.coordinateSystem.cx,d=t.coordinateSystem.cy,f=t.get("barMinHeight")||0,m=t.get("barMinAngle")||0;n[s]=n[s]||[];for(var g=e.mapDimension(h.dim),y=e.mapDimension(o.dim),v=g_(e,g),_="radius"!==o.dim||!t.get("roundCap",!0),x=h.dataToCoord(0),b=0,w=e.count();b<w;b++){var S=e.get(g,b),T=e.get(y,b),M=S>=0?"p":"n",I=x;v&&(n[s][T]||(n[s][T]={p:x,n:x}),I=n[s][T][M]);var C=void 0,A=void 0,k=void 0,D=void 0;if("radius"===h.dim){var E=h.dataToCoord(S)-x,P=o.dataToCoord(T);Math.abs(E)<f&&(E=(E<0?-1:1)*f),C=I,A=I+E,D=(k=P-u)-c,v&&(n[s][T][M]=A)}else{var L=h.dataToCoord(S,_)-x,z=o.dataToCoord(T);Math.abs(L)<m&&(L=(L<0?-1:1)*m),A=(C=z+u)+c,k=I,D=I+L,v&&(n[s][T][M]=D)}e.setItemLayout(b,{cx:p,cy:d,r0:C,r:A,startAngle:-k*Math.PI/180,endAngle:-D*Math.PI/180,clockwise:k>=D})}}})}var zz={startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:0}},Oz={splitNumber:5},Rz=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.type="polar",e}($f);function Bz(t,e){e=e||{};var i=t.coordinateSystem,n=t.axis,r={},o=n.position,a=n.orient,s=i.getRect(),l=[s.x,s.x+s.width,s.y,s.y+s.height],u={horizontal:{top:l[2],bottom:l[3]},vertical:{left:l[0],right:l[1]}};r.position=["vertical"===a?u.vertical[o]:l[0],"horizontal"===a?u.horizontal[o]:l[3]],r.rotation=Math.PI/2*{horizontal:0,vertical:1}[a],r.labelDirection=r.tickDirection=r.nameDirection={top:-1,bottom:1,right:1,left:-1}[o],t.get(["axisTick","inside"])&&(r.tickDirection=-r.tickDirection),tt(e.labelInside,t.get(["axisLabel","inside"]))&&(r.labelDirection=-r.labelDirection);var c=e.rotate;return null==c&&(c=t.get(["axisLabel","rotate"])),r.labelRotation="top"===o?-c:c,r.z2=1,r}var Nz=["axisLine","axisTickLabel","axisName"],Fz=["splitArea","splitLine"],Vz=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.axisPointerClass="SingleAxisPointer",i}return i(e,t),e.prototype.render=function(e,i,n,r){var o=this.group;o.removeAll();var a=this._axisGroup;this._axisGroup=new Fn;var s=Bz(e),l=new kT(e,s);L(Nz,l.add,l),o.add(this._axisGroup),o.add(l.getGroup()),L(Fz,function(t){e.get([t,"show"])&&Uz[t](this,this.group,this._axisGroup,e)},this),lc(a,this._axisGroup,e),t.prototype.render.call(this,e,i,n,r)},e.prototype.remove=function(){HT(this)},e.type="singleAxis",e}(GT),Uz={splitLine:function(t,e,i,n){var r=n.axis;if(!r.scale.isBlank()){var o=n.getModel("splitLine"),a=o.getModel("lineStyle"),s=a.get("color");s=s instanceof Array?s:[s];for(var l=n.coordinateSystem.getRect(),u=r.isHorizontal(),c=[],h=0,p=r.getTicksCoords({tickModel:o}),d=[],f=[],m=0;m<p.length;++m){var g=r.toGlobalCoord(p[m].coord);u?(d[0]=g,d[1]=l.y,f[0]=g,f[1]=l.y+l.height):(d[0]=l.x,d[1]=g,f[0]=l.x+l.width,f[1]=g);var y=h++%s.length;c[y]=c[y]||[],c[y].push(new gu({subPixelOptimize:!0,shape:{x1:d[0],y1:d[1],x2:f[0],y2:f[1]},silent:!0}))}var v=a.getLineStyle(["color"]);for(m=0;m<c.length;++m)e.add(ec(c[m],{style:C({stroke:s[m%s.length]},v),silent:!0}))}},splitArea:function(t,e,i,n){WT(t,i,n,n)}},Gz=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.getCoordSysModel=function(){return this},e.type="singleAxis",e.layoutMode="box",e.defaultOption={left:"5%",top:"5%",right:"5%",bottom:"5%",type:"value",position:"bottom",orient:"horizontal",axisLine:{show:!0,lineStyle:{width:1,type:"solid"}},tooltip:{show:!0},axisTick:{show:!0,length:6,lineStyle:{width:1}},axisLabel:{show:!0,interval:"auto"},splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.2}}},e}(ip);E(Gz,Mx.prototype);var $z=function(t){function e(e,i,n,r,o){var a=t.call(this,e,i,n)||this;return a.type=r||"value",a.position=o||"bottom",a}return i(e,t),e.prototype.isHorizontal=function(){var t=this.position;return"top"===t||"bottom"===t},e.prototype.pointToData=function(t,e){return this.coordinateSystem.pointToData(t)[0]},e}($x),Wz=["single"],Hz=function(){function t(t,e,i){this.type="single",this.dimension="single",this.dimensions=Wz,this.axisPointerEnabled=!0,this.model=t,this._init(t,e,i)}return t.prototype._init=function(t,e,i){var n=this.dimension,r=new $z(n,yx(t),[0,0],t.get("type"),t.get("position")),o="category"===r.type;r.onBand=o&&t.get("boundaryGap"),r.inverse=t.get("inverse"),r.orient=t.get("orient"),t.axis=r,r.model=t,r.coordinateSystem=this,this._axis=r},t.prototype.update=function(t,e){t.eachSeries(function(t){if(t.coordinateSystem===this){var e=t.getData();L(e.mapDimensionsAll(this.dimension),function(t){this._axis.scale.unionExtentFromData(e,t)},this),gx(this._axis.scale,this._axis.model)}},this)},t.prototype.resize=function(t,e){this._rect=Xh({left:t.get("left"),top:t.get("top"),right:t.get("right"),bottom:t.get("bottom"),width:t.get("width"),height:t.get("height")},{width:e.getWidth(),height:e.getHeight()}),this._adjustAxis()},t.prototype.getRect=function(){return this._rect},t.prototype._adjustAxis=function(){var t=this._rect,e=this._axis,i=e.isHorizontal(),n=i?[0,t.width]:[0,t.height],r=e.reverse?1:0;e.setExtent(n[r],n[1-r]),this._updateAxisTransform(e,i?t.x:t.y)},t.prototype._updateAxisTransform=function(t,e){var i=t.getExtent(),n=i[0]+i[1],r=t.isHorizontal();t.toGlobalCoord=r?function(t){return t+e}:function(t){return n-t+e},t.toLocalCoord=r?function(t){return t-e}:function(t){return n-t+e}},t.prototype.getAxis=function(){return this._axis},t.prototype.getBaseAxis=function(){return this._axis},t.prototype.getAxes=function(){return[this._axis]},t.prototype.getTooltipAxes=function(){return{baseAxes:[this.getAxis()],otherAxes:[]}},t.prototype.containPoint=function(t){var e=this.getRect(),i=this.getAxis();return"horizontal"===i.orient?i.contain(i.toLocalCoord(t[0]))&&t[1]>=e.y&&t[1]<=e.y+e.height:i.contain(i.toLocalCoord(t[1]))&&t[0]>=e.y&&t[0]<=e.y+e.height},t.prototype.pointToData=function(t){var e=this.getAxis();return[e.coordToData(e.toLocalCoord(t["horizontal"===e.orient?0:1]))]},t.prototype.dataToPoint=function(t){var e=this.getAxis(),i=this.getRect(),n=[],r="horizontal"===e.orient?0:1;return t instanceof Array&&(t=t[0]),n[r]=e.toGlobalCoord(e.dataToCoord(+t)),n[1-r]=0===r?i.y+i.height/2:i.x+i.width/2,n},t.prototype.convertToPixel=function(t,e,i){return jz(e)===this?this.dataToPoint(i):null},t.prototype.convertFromPixel=function(t,e,i){return jz(e)===this?this.pointToData(i):null},t}();function jz(t){var e=t.seriesModel,i=t.singleAxisModel;return i&&i.coordinateSystem||e&&e.coordinateSystem}var Zz={create:function(t,e){var i=[];return t.eachComponent("singleAxis",function(n,r){var o=new Hz(n,t,e);o.name="single_"+r,o.resize(n,e),n.coordinateSystem=o,i.push(o)}),t.eachSeries(function(t){if("singleAxis"===t.get("coordinateSystem")){var e=t.getReferringComponents("singleAxis",Nr).models[0];t.coordinateSystem=e&&e.coordinateSystem}}),i},dimensions:Wz},qz=["x","y"],Xz=["width","height"],Yz=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.makeElOption=function(t,e,i,n,r){var o=i.axis,a=o.coordinateSystem,s=Qz(a,1-Jz(o)),l=a.dataToPoint(e)[0],u=n.get("type");if(u&&"none"!==u){var c=EL(n),h=Kz[u](o,l,s);h.style=c,t.graphicKey=h.type,t.pointer=h}OL(e,t,Bz(i),i,n,r)},e.prototype.getHandleTransform=function(t,e,i){var n=Bz(e,{labelInside:!1});n.labelMargin=i.get(["handle","margin"]);var r=zL(e.axis,t,n);return{x:r[0],y:r[1],rotation:n.rotation+(n.labelDirection<0?Math.PI:0)}},e.prototype.updateHandleTransform=function(t,e,i,n){var r=i.axis,o=r.coordinateSystem,a=Jz(r),s=Qz(o,a),l=[t.x,t.y];l[a]+=e[a],l[a]=Math.min(s[1],l[a]),l[a]=Math.max(s[0],l[a]);var u=Qz(o,1-a),c=(u[1]+u[0])/2,h=[c,c];return h[a]=l[a],{x:l[0],y:l[1],rotation:t.rotation,cursorPoint:h,tooltipOption:{verticalAlign:"middle"}}},e}(ML),Kz={line:function(t,e,i){return{type:"Line",subPixelOptimize:!0,shape:RL([e,i[0]],[e,i[1]],Jz(t))}},shadow:function(t,e,i){var n=t.getBandWidth(),r=i[1]-i[0];return{type:"Rect",shape:BL([e-n/2,i[0]],[n,r],Jz(t))}}};function Jz(t){return t.isHorizontal()?0:1}function Qz(t,e){var i=t.getRect();return[i[qz[e]],i[qz[e]]+i[Xz[e]]]}var tO=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.type="single",e}($f),eO=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.init=function(e,i,n){var r=Qh(e);t.prototype.init.apply(this,arguments),iO(e,r)},e.prototype.mergeOption=function(e){t.prototype.mergeOption.apply(this,arguments),iO(this.option,e)},e.prototype.getCellSize=function(){return this.option.cellSize},e.type="calendar",e.defaultOption={zlevel:0,z:2,left:80,top:60,cellSize:20,orient:"horizontal",splitLine:{show:!0,lineStyle:{color:"#000",width:1,type:"solid"}},itemStyle:{color:"#fff",borderWidth:1,borderColor:"#ccc"},dayLabel:{show:!0,firstDay:0,position:"start",margin:"50%",color:"#000"},monthLabel:{show:!0,position:"start",margin:5,align:"center",formatter:null,color:"#000"},yearLabel:{show:!0,position:null,margin:30,formatter:null,color:"#ccc",fontFamily:"sans-serif",fontWeight:"bolder",fontSize:20}},e}(ip);function iO(t,e){var i,n=t.cellSize;1===(i=U(n)?n:t.cellSize=[n,n]).length&&(i[1]=i[0]);var r=z([0,1],function(t){return function(t,e){return null!=t[jh[e][0]]||null!=t[jh[e][1]]&&null!=t[jh[e][2]]}(e,t)&&(i[t]="auto"),null!=i[t]&&"auto"!==i[t]});Jh(t,e,{type:"box",ignoreSize:r})}var nO=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(t,e,i){var n=this.group;n.removeAll();var r=t.coordinateSystem,o=r.getRangeInfo(),a=r.getOrient(),s=e.getLocaleModel();this._renderDayRect(t,o,n),this._renderLines(t,o,a,n),this._renderYearText(t,o,a,n),this._renderMonthText(t,s,a,n),this._renderWeekText(t,s,o,a,n)},e.prototype._renderDayRect=function(t,e,i){for(var n=t.coordinateSystem,r=t.getModel("itemStyle").getItemStyle(),o=n.getCellWidth(),a=n.getCellHeight(),s=e.start.time;s<=e.end.time;s=n.getNextNDay(s,1).time){var l=n.dataToRect([s],!1).tl,u=new hs({shape:{x:l[0],y:l[1],width:o,height:a},cursor:"default",style:r});i.add(u)}},e.prototype._renderLines=function(t,e,i,n){var r=this,o=t.coordinateSystem,a=t.getModel(["splitLine","lineStyle"]).getLineStyle(),s=t.get(["splitLine","show"]),l=a.lineWidth;this._tlpoints=[],this._blpoints=[],this._firstDayOfMonth=[],this._firstDayPoints=[];for(var u=e.start,c=0;u.time<=e.end.time;c++){p(u.formatedDate),0===c&&(u=o.getDateInfo(e.start.y+"-"+e.start.m));var h=u.date;h.setMonth(h.getMonth()+1),u=o.getDateInfo(h)}function p(e){r._firstDayOfMonth.push(o.getDateInfo(e)),r._firstDayPoints.push(o.dataToRect([e],!1).tl);var l=r._getLinePointsOfOneWeek(t,e,i);r._tlpoints.push(l[0]),r._blpoints.push(l[l.length-1]),s&&r._drawSplitline(l,a,n)}p(o.getNextNDay(e.end.time,1).formatedDate),s&&this._drawSplitline(r._getEdgesPoints(r._tlpoints,l,i),a,n),s&&this._drawSplitline(r._getEdgesPoints(r._blpoints,l,i),a,n)},e.prototype._getEdgesPoints=function(t,e,i){var n=[t[0].slice(),t[t.length-1].slice()],r="horizontal"===i?0:1;return n[0][r]=n[0][r]-e/2,n[1][r]=n[1][r]+e/2,n},e.prototype._drawSplitline=function(t,e,i){var n=new du({z2:20,shape:{points:t},style:e});i.add(n)},e.prototype._getLinePointsOfOneWeek=function(t,e,i){for(var n=t.coordinateSystem,r=n.getDateInfo(e),o=[],a=0;a<7;a++){var s=n.getNextNDay(r.time,a),l=n.dataToRect([s.time],!1);o[2*s.day]=l.tl,o[2*s.day+1]=l["horizontal"===i?"bl":"tr"]}return o},e.prototype._formatterLabel=function(t,e){return"string"==typeof t&&t?(i=t,L(e,function(t,e){i=i.replace("{"+e+"}",t)}),i):"function"==typeof t?t(e):e.nameMap;var i,n},e.prototype._yearTextPositionControl=function(t,e,i,n,r){var o=e[0],a=e[1],s=["center","bottom"];"bottom"===n?(a+=r,s=["center","top"]):"left"===n?o-=r:"right"===n?(o+=r,s=["center","top"]):a-=r;var l=0;return"left"!==n&&"right"!==n||(l=Math.PI/2),{rotation:l,x:o,y:a,style:{align:s[0],verticalAlign:s[1]}}},e.prototype._renderYearText=function(t,e,i,n){var r=t.getModel("yearLabel");if(r.get("show")){var o=r.get("margin"),a=r.get("position");a||(a="horizontal"!==i?"top":"left");var s=[this._tlpoints[this._tlpoints.length-1],this._blpoints[0]],l=(s[0][0]+s[1][0])/2,u=(s[0][1]+s[1][1])/2,c="horizontal"===i?0:1,h={top:[l,s[c][1]],bottom:[l,s[1-c][1]],left:[s[1-c][0],u],right:[s[c][0],u]},p=e.start.y;+e.end.y>+e.start.y&&(p=p+"-"+e.end.y);var d=r.get("formatter"),f={start:e.start.y,end:e.end.y,nameMap:p},m=this._formatterLabel(d,f),g=new fs({z2:30,style:wc(r,{text:m})});g.attr(this._yearTextPositionControl(g,h[a],i,a,o)),n.add(g)}},e.prototype._monthTextPositionControl=function(t,e,i,n,r){var o="left",a="top",s=t[0],l=t[1];return"horizontal"===i?(l+=r,e&&(o="center"),"start"===n&&(a="bottom")):(s+=r,e&&(a="middle"),"start"===n&&(o="right")),{x:s,y:l,align:o,verticalAlign:a}},e.prototype._renderMonthText=function(t,e,i,n){var r=t.getModel("monthLabel");if(r.get("show")){var o=r.get("nameMap"),a=r.get("margin"),s=r.get("position"),l=r.get("align"),u=[this._tlpoints,this._blpoints];o&&!$(o)||(o&&(e=th(o)||e),o=e.get(["time","monthAbbr"])||[]);var c="start"===s?0:1,h="horizontal"===i?0:1;a="start"===s?-a:a;for(var p="center"===l,d=0;d<u[c].length-1;d++){var f=u[c][d].slice(),m=this._firstDayOfMonth[d];if(p){var g=this._firstDayPoints[d];f[h]=(g[h]+u[0][d+1][h])/2}var y=r.get("formatter"),v=o[+m.m-1],_={yyyy:m.y,yy:(m.y+"").slice(2),MM:m.m,M:+m.m,nameMap:v},x=this._formatterLabel(y,_),b=new fs({z2:30,style:I(wc(r,{text:x}),this._monthTextPositionControl(f,p,i,s,a))});n.add(b)}}},e.prototype._weekTextPositionControl=function(t,e,i,n,r){var o="center",a="middle",s=t[0],l=t[1],u="start"===i;return"horizontal"===e?(s=s+n+(u?1:-1)*r[0]/2,o=u?"right":"left"):(l=l+n+(u?1:-1)*r[1]/2,a=u?"bottom":"top"),{x:s,y:l,align:o,verticalAlign:a}},e.prototype._renderWeekText=function(t,e,i,n,r){var o=t.getModel("dayLabel");if(o.get("show")){var a=t.coordinateSystem,s=o.get("position"),l=o.get("nameMap"),u=o.get("margin"),c=a.getFirstDayOfWeek();l&&!$(l)||(l&&(e=th(l)||e),l=e.get(["time","dayOfWeekShort"])||z(e.get(["time","dayOfWeekAbbr"]),function(t){return t[0]}));var h=a.getNextNDay(i.end.time,7-i.lweek).time,p=[a.getCellWidth(),a.getCellHeight()];u=Xn(u,Math.min(p[1],p[0])),"start"===s&&(h=a.getNextNDay(i.start.time,-(7+i.fweek)).time,u=-u);for(var d=0;d<7;d++){var f,m=a.getNextNDay(h,d),g=a.dataToRect([m.time],!1).center,y=new fs({z2:30,style:I(wc(o,{text:l[f=Math.abs((d+c)%7)]}),this._weekTextPositionControl(g,n,s,u,p))});r.add(y)}}},e.type="calendar",e}($f),rO=864e5,oO=function(){function t(e,i,n){this.type="calendar",this.dimensions=t.dimensions,this.getDimensionsInfo=t.getDimensionsInfo,this._model=e}return t.getDimensionsInfo=function(){return[{name:"time",type:"time"},"value"]},t.prototype.getRangeInfo=function(){return this._rangeInfo},t.prototype.getModel=function(){return this._model},t.prototype.getRect=function(){return this._rect},t.prototype.getCellWidth=function(){return this._sw},t.prototype.getCellHeight=function(){return this._sh},t.prototype.getOrient=function(){return this._orient},t.prototype.getFirstDayOfWeek=function(){return this._firstDayOfWeek},t.prototype.getDateInfo=function(t){var e=(t=sr(t)).getFullYear(),i=t.getMonth()+1,n=i<10?"0"+i:""+i,r=t.getDate(),o=r<10?"0"+r:""+r,a=t.getDay();return{y:e+"",m:n,d:o,day:a=Math.abs((a+7-this.getFirstDayOfWeek())%7),time:t.getTime(),formatedDate:e+"-"+n+"-"+o,date:t}},t.prototype.getNextNDay=function(t,e){return 0===(e=e||0)||(t=new Date(this.getDateInfo(t).time)).setDate(t.getDate()+e),this.getDateInfo(t)},t.prototype.update=function(t,e){this._firstDayOfWeek=+this._model.getModel("dayLabel").get("firstDay"),this._orient=this._model.get("orient"),this._lineWidth=this._model.getModel("itemStyle").getItemStyle().lineWidth||0,this._rangeInfo=this._getRangeInfo(this._initRangeOption());var i=this._rangeInfo.weeks||1,n=["width","height"],r=this._model.getCellSize().slice(),o=this._model.getBoxLayoutParams(),a="horizontal"===this._orient?[i,7]:[7,i];L([0,1],function(t){u(r,t)&&(o[n[t]]=r[t]*a[t])});var s={width:e.getWidth(),height:e.getHeight()},l=this._rect=Xh(o,s);function u(t,e){return null!=t[e]&&"auto"!==t[e]}L([0,1],function(t){u(r,t)||(r[t]=l[n[t]]/a[t])}),this._sw=r[0],this._sh=r[1]},t.prototype.dataToPoint=function(t,e){U(t)&&(t=t[0]),null==e&&(e=!0);var i=this.getDateInfo(t),n=this._rangeInfo,r=i.formatedDate;if(e&&!(i.time>=n.start.time&&i.time<n.end.time+rO))return[NaN,NaN];var o=i.day,a=this._getRangeInfo([n.start.time,r]).nthWeek;return"vertical"===this._orient?[this._rect.x+o*this._sw+this._sw/2,this._rect.y+a*this._sh+this._sh/2]:[this._rect.x+a*this._sw+this._sw/2,this._rect.y+o*this._sh+this._sh/2]},t.prototype.pointToData=function(t){var e=this.pointToDate(t);return e&&e.time},t.prototype.dataToRect=function(t,e){var i=this.dataToPoint(t,e);return{contentShape:{x:i[0]-(this._sw-this._lineWidth)/2,y:i[1]-(this._sh-this._lineWidth)/2,width:this._sw-this._lineWidth,height:this._sh-this._lineWidth},center:i,tl:[i[0]-this._sw/2,i[1]-this._sh/2],tr:[i[0]+this._sw/2,i[1]-this._sh/2],br:[i[0]+this._sw/2,i[1]+this._sh/2],bl:[i[0]-this._sw/2,i[1]+this._sh/2]}},t.prototype.pointToDate=function(t){var e=Math.floor((t[0]-this._rect.x)/this._sw)+1,i=Math.floor((t[1]-this._rect.y)/this._sh)+1,n=this._rangeInfo.range;return"vertical"===this._orient?this._getDateByWeeksAndDay(i,e-1,n):this._getDateByWeeksAndDay(e,i-1,n)},t.prototype.convertToPixel=function(t,e,i){var n=aO(e);return n===this?n.dataToPoint(i):null},t.prototype.convertFromPixel=function(t,e,i){var n=aO(e);return n===this?n.pointToData(i):null},t.prototype.containPoint=function(t){return console.warn("Not implemented."),!1},t.prototype._initRangeOption=function(){var t,e=this._model.get("range");if(U(e)&&1===e.length&&(e=e[0]),U(e))t=e;else{var i=e.toString();if(/^\d{4}$/.test(i)&&(t=[i+"-01-01",i+"-12-31"]),/^\d{4}[\/|-]\d{1,2}$/.test(i)){var n=this.getDateInfo(i),r=n.date;r.setMonth(r.getMonth()+1);var o=this.getNextNDay(r,-1);t=[n.formatedDate,o.formatedDate]}/^\d{4}[\/|-]\d{1,2}[\/|-]\d{1,2}$/.test(i)&&(t=[i,i])}if(!t)return e;var a=this._getRangeInfo(t);return a.start.time>a.end.time&&t.reverse(),t},t.prototype._getRangeInfo=function(t){var e,i=[this.getDateInfo(t[0]),this.getDateInfo(t[1])];i[0].time>i[1].time&&(e=!0,i.reverse());var n=Math.floor(i[1].time/rO)-Math.floor(i[0].time/rO)+1,r=new Date(i[0].time),o=r.getDate(),a=i[1].date.getDate();r.setDate(o+n-1);var s=r.getDate();if(s!==a)for(var l=r.getTime()-i[1].time>0?1:-1;(s=r.getDate())!==a&&(r.getTime()-i[1].time)*l>0;)n-=l,r.setDate(s-l);var u=Math.floor((n+i[0].day+6)/7),c=e?1-u:u-1;return e&&i.reverse(),{range:[i[0].formatedDate,i[1].formatedDate],start:i[0],end:i[1],allDay:n,weeks:u,nthWeek:c,fweek:i[0].day,lweek:i[1].day}},t.prototype._getDateByWeeksAndDay=function(t,e,i){var n=this._getRangeInfo(i);if(t>n.weeks||0===t&&e<n.fweek||t===n.weeks&&e>n.lweek)return null;var r=7*(t-1)-n.fweek+e,o=new Date(n.start.time);return o.setDate(+n.start.d+r),this.getDateInfo(o)},t.create=function(e,i){var n=[];return e.eachComponent("calendar",function(r){var o=new t(r,e,i);n.push(o),r.coordinateSystem=o}),e.eachSeries(function(t){"calendar"===t.get("coordinateSystem")&&(t.coordinateSystem=n[t.get("calendarIndex")||0])}),n},t.dimensions=["time","value"],t}();function aO(t){var e=t.calendarModel,i=t.seriesModel;return e?e.coordinateSystem:i?i.coordinateSystem:null}var sO=zr(),lO={path:null,compoundPath:null,group:Fn,image:rs,text:fs},uO=function(t){var e=t.graphic;U(e)?e[0]&&e[0].elements?t.graphic=[t.graphic[0]]:t.graphic=[{elements:e}]:e&&!e.elements&&(t.graphic=[{elements:[e]}])},cO=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.preventAutoZ=!0,i}return i(e,t),e.prototype.mergeOption=function(e,i){var n=this.option.elements;this.option.elements=null,t.prototype.mergeOption.call(this,e,i),this.option.elements=n},e.prototype.optionUpdated=function(t,e){var i=this.option,n=(e?i:t).elements,r=i.elements=e?[]:i.elements,o=[];this._flatten(n,o,null);var a=Cr(r,o,"normalMerge"),s=this._elOptionsToUpdate=[];L(a,function(t,e){var i=t.newOption;i&&(s.push(i),function(t,e){var i=t.existing;if(e.id=t.keyInfo.id,!e.type&&i&&(e.type=i.type),null==e.parentId){var n=e.parentOption;n?e.parentId=n.id:i&&(e.parentId=i.parentId)}e.parentOption=null}(t,i),function(t,e,i){var n=I({},i),r=t[e],o=i.$action||"merge";"merge"===o?r?(T(r,n,!0),Jh(r,n,{ignoreSize:!0}),tp(i,r)):t[e]=n:"replace"===o?t[e]=n:"remove"===o&&r&&(t[e]=null)}(r,e,i),function(t,e){if(t&&(t.hv=e.hv=[fO(e,["left","right"]),fO(e,["top","bottom"])],"group"===t.type)){var i=t,n=e;null==i.width&&(i.width=n.width=0),null==i.height&&(i.height=n.height=0)}}(r[e],i))},this);for(var l=r.length-1;l>=0;l--)null==r[l]?r.splice(l,1):delete r[l].$action},e.prototype._flatten=function(t,e,i){L(t,function(t){if(t){i&&(t.parentOption=i),e.push(t);var n=t.children;"group"===t.type&&n&&this._flatten(n,e,t),delete t.children}},this)},e.prototype.useElOptionsToUpdate=function(){var t=this._elOptionsToUpdate;return this._elOptionsToUpdate=null,t},e.type="graphic",e.defaultOption={elements:[]},e}(ip),hO=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.init=function(){this._elMap=ht()},e.prototype.render=function(t,e,i){t!==this._lastGraphicModel&&this._clear(),this._lastGraphicModel=t,this._updateElements(t),this._relocate(t,i)},e.prototype._updateElements=function(t){var e=t.useElOptionsToUpdate();if(e){var i=this._elMap,n=this.group;L(e,function(e){var r=Dr(e.id,null),o=null!=r?i.get(r):null,a=Dr(e.parentId,null),s=null!=a?i.get(a):n,l=e.type,u=e.style;"text"===l&&u&&e.hv&&e.hv[1]&&(u.textVerticalAlign=u.textBaseline=u.verticalAlign=u.align=null);var c=e.textContent,h=e.textConfig;if(u&&EP(u,l,!!h,!!c)){var p=PP(u,l,!0);!h&&p.textConfig&&(h=e.textConfig=p.textConfig),!c&&p.textContent&&(c=p.textContent)}var d=function(t){return t=I({},t),L(["id","parentId","$action","hv","bounding","textContent"].concat(Hh),function(e){delete t[e]}),t}(e),f=e.$action||"merge";"merge"===f?o?o.attr(d):pO(r,s,d,i):"replace"===f?(dO(o,i),pO(r,s,d,i)):"remove"===f&&dO(o,i);var m=i.get(r);if(m&&c)if("merge"===f){var g=m.getTextContent();g?g.attr(c):m.setTextContent(new fs(c))}else"replace"===f&&m.setTextContent(new fs(c));if(m){var y=sO(m);y.__ecGraphicWidthOption=e.width,y.__ecGraphicHeightOption=e.height,function(t,e,i){var n=Ss(t).eventData;t.silent||t.ignore||n||(n=Ss(t).eventData={componentType:"graphic",componentIndex:e.componentIndex,name:t.name}),n&&(n.info=i.info)}(m,t,e),mc({el:m,componentModel:t,itemName:m.name,itemTooltipOption:e.tooltip})}})}},e.prototype._relocate=function(t,e){for(var i=t.option.elements,n=this.group,r=this._elMap,o=e.getWidth(),a=e.getHeight(),s=0;s<i.length;s++)if((d=null!=(p=Dr((h=i[s]).id,null))?r.get(p):null)&&d.isGroup){var l=(f=d.parent)===n,u=sO(d),c=sO(f);u.__ecGraphicWidth=Xn(u.__ecGraphicWidthOption,l?o:c.__ecGraphicWidth)||0,u.__ecGraphicHeight=Xn(u.__ecGraphicHeightOption,l?a:c.__ecGraphicHeight)||0}for(s=i.length-1;s>=0;s--){var h,p,d;if(d=null!=(p=Dr((h=i[s]).id,null))?r.get(p):null){var f=d.parent;c=sO(f),Yh(d,h,f===n?{width:o,height:a}:{width:c.__ecGraphicWidth,height:c.__ecGraphicHeight},null,{hv:h.hv,boundingMode:h.bounding})}}},e.prototype._clear=function(){var t=this._elMap;t.each(function(e){dO(e,t)}),this._elMap=ht()},e.prototype.dispose=function(){this._clear()},e.type="graphic",e}($f);function pO(t,e,i,n){var r=i.type,o,a=new(ft(lO,r)?lO[r]:Ku(r))(i);e.add(a),n.set(t,a),sO(a).__ecGraphicId=t}function dO(t,e){var i=t&&t.parent;i&&("group"===t.type&&t.traverse(function(t){dO(t,e)}),e.removeKey(sO(t).__ecGraphicId),i.remove(t))}function fO(t,e){var i;return L(e,function(e){null!=t[e]&&"auto"!==t[e]&&(i=!0)}),i}var mO=["x","y","radius","angle","single"],gO=["cartesian2d","polar","singleAxis"];function yO(t){return t+"Axis"}function vO(t,e){var i,n=ht(),r=[],o=ht();t.eachComponent({mainType:"dataZoom",query:e},function(t){o.get(t.uid)||s(t)});do{i=!1,t.eachComponent("dataZoom",a)}while(i);function a(t){!o.get(t.uid)&&function(t){var e=!1;return t.eachTargetAxis(function(t,i){var r=n.get(t);r&&r[i]&&(e=!0)}),e}(t)&&(s(t),i=!0)}function s(t){o.set(t.uid,!0),r.push(t),t.eachTargetAxis(function(t,e){(n.get(t)||n.set(t,[]))[e]=!0})}return r}function _O(t){var e=t.ecModel,i={infoList:[],infoMap:ht()};return t.eachTargetAxis(function(t,n){var r=e.getComponent(yO(t),n);if(r){var o=r.getCoordSysModel();if(o){var a=o.uid,s=i.infoMap.get(a);s||(s={model:o,axisModels:[]},i.infoList.push(s),i.infoMap.set(a,s)),s.axisModels.push(r)}}}),i}var xO=function(){function t(){this.indexList=[],this.indexMap=[]}return t.prototype.add=function(t){this.indexMap[t]||(this.indexList.push(t),this.indexMap[t]=!0)},t}(),bO=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._autoThrottle=!0,i._noTarget=!0,i._rangePropMode=["percent","percent"],i}return i(e,t),e.prototype.init=function(t,e,i){var n=wO(t);this.settledOption=n,this.mergeDefaultAndTheme(t,i),this._doInit(n)},e.prototype.mergeOption=function(t){var e=wO(t);T(this.option,t,!0),T(this.settledOption,e,!0),this._doInit(e)},e.prototype._doInit=function(t){var e=this.option;this._setDefaultThrottle(t),this._updateRangeUse(t);var i=this.settledOption;L([["start","startValue"],["end","endValue"]],function(t,n){"value"===this._rangePropMode[n]&&(e[t[0]]=i[t[0]]=null)},this),this._resetTarget()},e.prototype._resetTarget=function(){var t=this.get("orient",!0),e=this._targetAxisInfoMap=ht();this._fillSpecifiedTargetAxis(e)?this._orient=t||this._makeAutoOrientByTargetAxis():(this._orient=t||"horizontal",this._fillAutoTargetAxisByOrient(e,this._orient)),this._noTarget=!0,e.each(function(t){t.indexList.length&&(this._noTarget=!1)},this)},e.prototype._fillSpecifiedTargetAxis=function(t){var e=!1;return L(mO,function(i){var n=this.getReferringComponents(yO(i),Fr);if(n.specified){e=!0;var r=new xO;L(n.models,function(t){r.add(t.componentIndex)}),t.set(i,r)}},this),e},e.prototype._fillAutoTargetAxisByOrient=function(t,e){var i=this.ecModel,n=!0;if(n){var r="vertical"===e?"y":"x";o(i.findComponents({mainType:r+"Axis"}),r)}function o(e,i){var r=e[0];if(r){var o=new xO;if(o.add(r.componentIndex),t.set(i,o),n=!1,"x"===i||"y"===i){var a=r.getReferringComponents("grid",Nr).models[0];a&&L(e,function(t){r.componentIndex!==t.componentIndex&&a===t.getReferringComponents("grid",Nr).models[0]&&o.add(t.componentIndex)})}}}n&&o(i.findComponents({mainType:"singleAxis",filter:function(t){return t.get("orient",!0)===e}}),"single"),n&&L(mO,function(e){if(n){var r=i.findComponents({mainType:yO(e),filter:function(t){return"category"===t.get("type",!0)}});if(r[0]){var o=new xO;o.add(r[0].componentIndex),t.set(e,o),n=!1}}},this)},e.prototype._makeAutoOrientByTargetAxis=function(){var t;return this.eachTargetAxis(function(e){!t&&(t=e)},this),"y"===t?"vertical":"horizontal"},e.prototype._setDefaultThrottle=function(t){if(t.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var e=this.ecModel.option;this.option.throttle=e.animation&&e.animationDurationUpdate>0?100:20}},e.prototype._updateRangeUse=function(t){var e=this._rangePropMode,i=this.get("rangeMode");L([["start","startValue"],["end","endValue"]],function(n,r){var o=null!=t[n[0]],a=null!=t[n[1]];o&&!a?e[r]="percent":!o&&a?e[r]="value":i?e[r]=i[r]:o&&(e[r]="percent")})},e.prototype.noTarget=function(){return this._noTarget},e.prototype.getFirstTargetAxisModel=function(){var t;return this.eachTargetAxis(function(e,i){null==t&&(t=this.ecModel.getComponent(yO(e),i))},this),t},e.prototype.eachTargetAxis=function(t,e){this._targetAxisInfoMap.each(function(i,n){L(i.indexList,function(i){t.call(e,n,i)})})},e.prototype.getAxisProxy=function(t,e){var i=this.getAxisModel(t,e);if(i)return i.__dzAxisProxy},e.prototype.getAxisModel=function(t,e){var i=this._targetAxisInfoMap.get(t);if(i&&i.indexMap[e])return this.ecModel.getComponent(yO(t),e)},e.prototype.setRawRange=function(t){var e=this.option,i=this.settledOption;L([["start","startValue"],["end","endValue"]],function(n){null==t[n[0]]&&null==t[n[1]]||(e[n[0]]=i[n[0]]=t[n[0]],e[n[1]]=i[n[1]]=t[n[1]])},this),this._updateRangeUse(t)},e.prototype.setCalculatedRange=function(t){var e=this.option;L(["start","startValue","end","endValue"],function(i){e[i]=t[i]})},e.prototype.getPercentRange=function(){var t=this.findRepresentativeAxisProxy();if(t)return t.getDataPercentWindow()},e.prototype.getValueRange=function(t,e){if(null!=t||null!=e)return this.getAxisProxy(t,e).getDataValueWindow();var i=this.findRepresentativeAxisProxy();return i?i.getDataValueWindow():void 0},e.prototype.findRepresentativeAxisProxy=function(t){if(t)return t.__dzAxisProxy;for(var e,i=this._targetAxisInfoMap.keys(),n=0;n<i.length;n++)for(var r=i[n],o=this._targetAxisInfoMap.get(r),a=0;a<o.indexList.length;a++){var s=this.getAxisProxy(r,o.indexList[a]);if(s.hostedBy(this))return s;e||(e=s)}return e},e.prototype.getRangePropMode=function(){return this._rangePropMode.slice()},e.prototype.getOrient=function(){return this._orient},e.type="dataZoom",e.dependencies=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","series","toolbox"],e.defaultOption={zlevel:0,z:4,filterMode:"filter",start:0,end:100},e}(ip);function wO(t){var e={};return L(["start","end","startValue","endValue","throttle"],function(i){t.hasOwnProperty(i)&&(e[i]=t[i])}),e}var SO=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.type="dataZoom.select",e}(bO),TO=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(t,e,i,n){this.dataZoomModel=t,this.ecModel=e,this.api=i},e.type="dataZoom",e}($f),MO=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.type="dataZoom.select",e}(TO),IO=L,CO=Kn,AO=function(){function t(t,e,i,n){this._dimName=t,this._axisIndex=e,this.ecModel=n,this._dataZoomModel=i}return t.prototype.hostedBy=function(t){return this._dataZoomModel===t},t.prototype.getDataValueWindow=function(){return this._valueWindow.slice()},t.prototype.getDataPercentWindow=function(){return this._percentWindow.slice()},t.prototype.getTargetSeriesModels=function(){var t=[];return this.ecModel.eachSeries(function(e){if(function(t){var e=t.get("coordinateSystem");return k(gO,e)>=0}(e)){var i=yO(this._dimName),n=e.getReferringComponents(i,Nr).models[0];n&&this._axisIndex===n.componentIndex&&t.push(e)}},this),t},t.prototype.getAxisModel=function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},t.prototype.getMinMaxSpan=function(){return S(this._minMaxSpan)},t.prototype.calculateDataWindow=function(t){var e,i=this._dataExtent,n=this.getAxisModel().axis.scale,r=this._dataZoomModel.getRangePropMode(),o=[0,100],a=[],s=[];IO(["start","end"],function(l,u){var c=t[l],h=t[l+"Value"];"percent"===r[u]?(null==c&&(c=o[u]),h=n.parse(qn(c,o,i))):(e=!0,c=qn(h=null==h?i[u]:n.parse(h),i,o)),s[u]=h,a[u]=c}),CO(s),CO(a);var l=this._minMaxSpan;function u(t,e,i,r,o){var a=o?"Span":"ValueSpan";ck(0,t,i,"all",l["min"+a],l["max"+a]);for(var s=0;s<2;s++)e[s]=qn(t[s],i,r,!0),o&&(e[s]=n.parse(e[s]))}return e?u(s,a,i,o,!1):u(a,s,o,i,!0),{valueWindow:s,percentWindow:a}},t.prototype.reset=function(t){if(t===this._dataZoomModel){var e=this.getTargetSeriesModels();this._dataExtent=function(t,e,i){var n=[1/0,-1/0];IO(i,function(t){!function(t,e,i){e&&L(Tx(e,i),function(i){var n=e.getApproximateExtent(i);n[0]<t[0]&&(t[0]=n[0]),n[1]>t[1]&&(t[1]=n[1])})}(n,t.getData(),e)});var r=t.getAxisModel(),o=dx(r.axis.scale,r,n).calculate();return[o.min,o.max]}(this,this._dimName,e),this._updateMinMaxSpan();var i=this.calculateDataWindow(t.settledOption);this._valueWindow=i.valueWindow,this._percentWindow=i.percentWindow,this._setAxisModel()}},t.prototype.filterData=function(t,e){if(t===this._dataZoomModel){var i=this._dimName,n=this.getTargetSeriesModels(),r=t.get("filterMode"),o=this._valueWindow;"none"!==r&&IO(n,function(t){var e=t.getData(),n=e.mapDimensionsAll(i);if(n.length){if("weakFilter"===r){var a=e.getStore(),s=z(n,function(t){return e.getDimensionIndex(t)},e);e.filterSelf(function(t){for(var e,i,r,l=0;l<n.length;l++){var u=a.get(s[l],t),c=!isNaN(u),h=u<o[0],p=u>o[1];if(c&&!h&&!p)return!0;c&&(r=!0),h&&(e=!0),p&&(i=!0)}return r&&e&&i})}else IO(n,function(i){if("empty"===r)t.setData(e=e.map(i,function(t){return function(t){return t>=o[0]&&t<=o[1]}(t)?t:NaN}));else{var n={};n[i]=o,e.selectRange(n)}});IO(n,function(t){e.setApproximateExtent(o,t)})}})}},t.prototype._updateMinMaxSpan=function(){var t=this._minMaxSpan={},e=this._dataZoomModel,i=this._dataExtent;IO(["min","max"],function(n){var r=e.get(n+"Span"),o=e.get(n+"ValueSpan");null!=o&&(o=this.getAxisModel().axis.scale.parse(o)),null!=o?r=qn(i[0]+o,i,[0,100],!0):null!=r&&(o=qn(r,[0,100],i,!0)-i[0]),t[n+"Span"]=r,t[n+"ValueSpan"]=o},this)},t.prototype._setAxisModel=function(){var t=this.getAxisModel(),e=this._percentWindow,i=this._valueWindow;if(e){var n=tr(i,[0,500]);n=Math.min(n,20);var r=t.axis.scale.rawExtentInfo;0!==e[0]&&r.setDeterminedMinMax("min",+i[0].toFixed(n)),100!==e[1]&&r.setDeterminedMinMax("max",+i[1].toFixed(n)),r.freeze()}},t}(),kO={getTargetSeries:function(t){function e(e){t.eachComponent("dataZoom",function(i){i.eachTargetAxis(function(n,r){var o=t.getComponent(yO(n),r);e(n,r,o,i)})})}e(function(t,e,i,n){i.__dzAxisProxy=null});var i=[];e(function(e,n,r,o){r.__dzAxisProxy||(r.__dzAxisProxy=new AO(e,n,o,t),i.push(r.__dzAxisProxy))});var n=ht();return L(i,function(t){L(t.getTargetSeriesModels(),function(t){n.set(t.uid,t)})}),n},overallReset:function(t,e){t.eachComponent("dataZoom",function(t){t.eachTargetAxis(function(e,i){t.getAxisProxy(e,i).reset(t)}),t.eachTargetAxis(function(i,n){t.getAxisProxy(i,n).filterData(t,e)})}),t.eachComponent("dataZoom",function(t){var e=t.findRepresentativeAxisProxy();if(e){var i=e.getDataPercentWindow(),n=e.getDataValueWindow();t.setCalculatedRange({start:i[0],end:i[1],startValue:n[0],endValue:n[1]})}})}},DO=!1;function EO(t){DO||(DO=!0,t.registerProcessor(t.PRIORITY.PROCESSOR.FILTER,kO),function(t){t.registerAction("dataZoom",function(t,e){L(vO(e,t),function(e){e.setRawRange({start:t.start,end:t.end,startValue:t.startValue,endValue:t.endValue})})})}(t),t.registerSubTypeDefaulter("dataZoom",function(){return"slider"}))}function PO(t){t.registerComponentModel(SO),t.registerComponentView(MO),EO(t)}var LO=function(){},zO={};function OO(t,e){zO[t]=e}function RO(t){return zO[t]}var BO=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.optionUpdated=function(){t.prototype.optionUpdated.apply(this,arguments);var e=this.ecModel;L(this.option.feature,function(t,i){var n=RO(i);n&&(n.getDefaultOption&&(n.defaultOption=n.getDefaultOption(e)),T(t,n.defaultOption))})},e.type="toolbox",e.layoutMode={type:"box",ignoreSize:!0},e.defaultOption={show:!0,z:6,zlevel:0,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1,position:"bottom"}},e}(ip);function NO(t,e){var i=Lh(e.get("padding")),n=e.getItemStyle(["color","opacity"]);return n.fill=e.get("backgroundColor"),new hs({shape:{x:t.x-i[3],y:t.y-i[0],width:t.width+i[1]+i[3],height:t.height+i[0]+i[2],r:e.get("borderRadius")},style:n,silent:!0,z2:-1})}var FO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.render=function(t,e,i,n){var r=this.group;if(r.removeAll(),t.get("show")){var o=+t.get("itemSize"),a=t.get("feature")||{},s=this._features||(this._features={}),l=[];L(a,function(t,e){l.push(e)}),new Fv(this._featureNames||[],l).add(u).update(u).remove(V(u,null)).execute(),this._featureNames=l,function(t,e,i){var n=e.getBoxLayoutParams(),r=e.get("padding"),o={width:i.getWidth(),height:i.getHeight()},a=Xh(n,o,r);qh(e.get("orient"),t,e.get("itemGap"),a.width,a.height),Yh(t,n,o,r)}(r,t,i),r.add(NO(r.getBoundingRect(),t)),r.eachChild(function(t){var e=t.__title,n=t.ensureState("emphasis"),a=n.textConfig||(n.textConfig={}),s=t.getTextContent(),l=s&&s.states.emphasis;if(l&&!G(l)&&e){var u=l.style||(l.style={}),c=Sn(e,fs.makeFont(u)),h=t.x+r.x,p=!1;t.y+r.y+o+c.height>i.getHeight()&&(a.position="top",p=!0);var d=p?-5-c.height:o+8;h+c.width/2>i.getWidth()?(a.position=["100%",d],u.align="right"):h-c.width/2<0&&(a.position=[0,d],u.align="left")}})}function u(u,c){var h,p=l[u],d=l[c],f=a[p],m=new $c(f,t,t.ecModel);if(n&&null!=n.newTitle&&n.featureName===p&&(f.title=n.newTitle),p&&!d){if(function(t){return 0===t.indexOf("my")}(p))h={onclick:m.option.onclick,featureName:p};else{var g=RO(p);if(!g)return;h=new g}s[p]=h}else if(!(h=s[d]))return;h.uid=Hc("toolbox-feature"),h.model=m,h.ecModel=e,h.api=i;var y=h instanceof LO;p||!d?!m.get("show")||y&&h.unusable?y&&h.remove&&h.remove(e,i):(function(n,a,s){var l,u,c=n.getModel("iconStyle"),h=n.getModel(["emphasis","iconStyle"]),p=a instanceof LO&&a.getIcons?a.getIcons():n.get("icon"),d=n.get("title")||{};"string"==typeof p?(l={})[s]=p:l=p,"string"==typeof d?(u={})[s]=d:u=d;var f=n.iconPaths={};L(l,function(s,l){var p=hc(s,{},{x:-o/2,y:-o/2,width:o,height:o});p.setStyle(c.getItemStyle()),p.ensureState("emphasis").style=h.getItemStyle();var d=new fs({style:{text:u[l],align:h.get("textAlign"),borderRadius:h.get("textBorderRadius"),padding:h.get("textPadding"),fill:null},ignore:!0});p.setTextContent(d),mc({el:p,componentModel:t,itemName:l,formatterParamsExtra:{title:u[l]}}),p.__title=u[l],p.on("mouseover",function(){var e=h.getItemStyle(),i="vertical"===t.get("orient")?null==t.get("right")?"right":"left":null==t.get("bottom")?"bottom":"top";d.setStyle({fill:h.get("textFill")||e.fill||e.stroke||"#000",backgroundColor:h.get("textBackgroundColor")}),p.setTextConfig({position:h.get("textPosition")||i}),d.ignore=!t.get("showTitle"),Qs(this)}).on("mouseout",function(){"emphasis"!==n.get(["iconStatus",l])&&tl(this),d.hide()}),("emphasis"===n.get(["iconStatus",l])?Qs:tl)(p),r.add(p),p.on("click",F(a.onclick,a,e,i,l)),f[l]=p})}(m,h,p),m.setIconStatus=function(t,e){var i=this.option,n=this.iconPaths;i.iconStatus=i.iconStatus||{},i.iconStatus[t]=e,n[t]&&("emphasis"===e?Qs:tl)(n[t])},h instanceof LO&&h.render&&h.render(m,e,i,n)):y&&h.dispose&&h.dispose(e,i)}},e.prototype.updateView=function(t,e,i,n){L(this._features,function(t){t instanceof LO&&t.updateView&&t.updateView(t.model,e,i,n)})},e.prototype.remove=function(t,e){L(this._features,function(i){i instanceof LO&&i.remove&&i.remove(t,e)}),this.group.removeAll()},e.prototype.dispose=function(t,e){L(this._features,function(i){i instanceof LO&&i.dispose&&i.dispose(t,e)})},e.type="toolbox",e}($f),VO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onclick=function(t,e){var i=this.model,n=i.get("name")||t.get("title.0.text")||"echarts",r="svg"===e.getZr().painter.getType(),o=r?"svg":i.get("type",!0)||"png",s=e.getConnectedDataURL({type:o,backgroundColor:i.get("backgroundColor",!0)||t.get("backgroundColor")||"#fff",connectedBackgroundColor:i.get("connectedBackgroundColor"),excludeComponents:i.get("excludeComponents"),pixelRatio:i.get("pixelRatio")});if("function"!=typeof MouseEvent||!a.browser.newEdge&&(a.browser.ie||a.browser.edge))if(window.navigator.msSaveOrOpenBlob||r){var l=s.split(","),u=l[0].indexOf("base64")>-1,c=r?decodeURIComponent(l[1]):l[1];u&&(c=window.atob(c));var h=n+"."+o;if(window.navigator.msSaveOrOpenBlob){for(var p=c.length,d=new Uint8Array(p);p--;)d[p]=c.charCodeAt(p);var f=new Blob([d]);window.navigator.msSaveOrOpenBlob(f,h)}else{var m=document.createElement("iframe");document.body.appendChild(m);var g=m.contentWindow,y=g.document;y.open("image/svg+xml","replace"),y.write(c),y.close(),g.focus(),y.execCommand("SaveAs",!0,h),document.body.removeChild(m)}}else{var v=i.get("lang"),_='<body style="margin:0;"><img src="'+s+'" style="max-width:100%;" title="'+(v&&v[0]||"")+'" /></body>',x=window.open();x.document.write(_),x.document.title=n}else{var b=document.createElement("a");b.download=n+"."+o,b.target="_blank",b.href=s;var w=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});b.dispatchEvent(w)}},e.getDefaultOption=function(t){return{show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:t.getLocaleModel().get(["toolbox","saveAsImage","title"]),type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],lang:t.getLocaleModel().get(["toolbox","saveAsImage","lang"])}},e}(LO);VO.prototype.unusable=!a.canvasSupported;var UO="__ec_magicType_stack__",GO=[["line","bar"],["stack"]],$O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getIcons=function(){var t=this.model,e=t.get("icon"),i={};return L(t.get("type"),function(t){e[t]&&(i[t]=e[t])}),i},e.getDefaultOption=function(t){return{show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:t.getLocaleModel().get(["toolbox","magicType","title"]),option:{},seriesIndex:{}}},e.prototype.onclick=function(t,e,i){var n=this.model,r=n.get(["seriesIndex",i]);if(WO[i]){var o,a={series:[]};L(GO,function(t){k(t,i)>=0&&L(t,function(t){n.setIconStatus(t,"normal")})}),n.setIconStatus(i,"emphasis"),t.eachComponent({mainType:"series",query:null==r?null:{seriesIndex:r}},function(t){var e=t.subType,r=t.id,o=WO[i](e,r,t,n);o&&(C(o,t.option),a.series.push(o));var s=t.coordinateSystem;if(s&&"cartesian2d"===s.type&&("line"===i||"bar"===i)){var l=s.getAxesByScale("ordinal")[0];if(l){var u=l.dim+"Axis",c=t.getReferringComponents(u,Nr).models[0].componentIndex;a[u]=a[u]||[];for(var h=0;h<=c;h++)a[u][c]=a[u][c]||{};a[u][c].boundaryGap="bar"===i}}});var s=i;"stack"===i&&(o=T({stack:n.option.title.tiled,tiled:n.option.title.stack},n.option.title),"emphasis"!==n.get(["iconStatus",i])&&(s="tiled")),e.dispatchAction({type:"changeMagicType",currentType:s,newOption:a,newTitle:o,featureName:"magicType"})}},e}(LO),WO={line:function(t,e,i,n){if("bar"===t)return T({id:e,type:"line",data:i.get("data"),stack:i.get("stack"),markPoint:i.get("markPoint"),markLine:i.get("markLine")},n.get(["option","line"])||{},!0)},bar:function(t,e,i,n){if("line"===t)return T({id:e,type:"bar",data:i.get("data"),stack:i.get("stack"),markPoint:i.get("markPoint"),markLine:i.get("markLine")},n.get(["option","bar"])||{},!0)},stack:function(t,e,i,n){var r=i.get("stack")===UO;if("line"===t||"bar"===t)return n.setIconStatus("stack",r?"normal":"emphasis"),T({id:e,stack:r?"":UO},n.get(["option","stack"])||{},!0)}};Mv({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(t,e){e.mergeOption(t.newOption)});var HO=Array(60).join("-"),jO="\t";function ZO(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}var qO=/[	]+/g;function XO(t,e){var i=t.split(RegExp("\n*"+HO+"\n*","g")),n={series:[]};return L(i,function(t,i){if(function(t){if(t.slice(0,t.indexOf("\n")).indexOf(jO)>=0)return!0}(t)){var r=function(t){for(var e=t.split(/\n+/g),i=[],n=z(ZO(e.shift()).split(qO),function(t){return{name:t,data:[]}}),r=0;r<e.length;r++){var o=ZO(e[r]).split(qO);i.push(o.shift());for(var a=0;a<o.length;a++)n[a]&&(n[a].data[r]=o[a])}return{series:n,categories:i}}(t),o=e[i],a=o.axisDim+"Axis";o&&(n[a]=n[a]||[],n[a][o.axisIndex]={data:r.categories},n.series=n.series.concat(r.series))}else r=function(t){for(var e=t.split(/\n+/g),i=ZO(e.shift()),n=[],r=0;r<e.length;r++){var o=ZO(e[r]);if(o){var a=o.split(qO),s="",l=void 0,u=!1;isNaN(a[0])?(u=!0,s=a[0],a=a.slice(1),n[r]={name:s,value:[]},l=n[r].value):l=n[r]=[];for(var c=0;c<a.length;c++)l.push(+a[c]);1===l.length&&(u?n[r].value=l[0]:n[r]=l[0])}}return{name:i,data:n}}(t),n.series.push(r)}),n}var YO=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onclick=function(t,e){var i=e.getDom(),n=this.model;this._dom&&i.removeChild(this._dom);var r=document.createElement("div");r.style.cssText="position:absolute;left:5px;top:5px;bottom:5px;right:5px;",r.style.backgroundColor=n.get("backgroundColor")||"#fff";var o=document.createElement("h4"),a=n.get("lang")||[];o.innerHTML=a[0]||n.get("title"),o.style.cssText="margin: 10px 20px;",o.style.color=n.get("textColor");var s=document.createElement("div"),l=document.createElement("textarea");s.style.cssText="display:block;width:100%;overflow:auto;";var u=n.get("optionToContent"),c=n.get("contentToOption"),h=function(t){var e,i,n,r=function(t){var e={},i=[],n=[];return t.eachRawSeries(function(t){var r=t.coordinateSystem;if(!r||"cartesian2d"!==r.type&&"polar"!==r.type)i.push(t);else{var o=r.getBaseAxis();if("category"===o.type){var a=o.dim+"_"+o.index;e[a]||(e[a]={categoryAxis:o,valueAxis:r.getOtherAxis(o),series:[]},n.push({axisDim:o.dim,axisIndex:o.index})),e[a].series.push(t)}else i.push(t)}}),{seriesGroupByCategoryAxis:e,other:i,meta:n}}(t);return{value:R([(i=r.seriesGroupByCategoryAxis,n=[],L(i,function(t,e){var i=t.categoryAxis,r=t.valueAxis.dim,o=[" "].concat(z(t.series,function(t){return t.name})),a=[i.model.getCategories()];L(t.series,function(t){var e=t.getRawData();a.push(t.getRawData().mapArray(e.mapDimension(r),function(t){return t}))});for(var s=[o.join(jO)],l=0;l<a[0].length;l++){for(var u=[],c=0;c<a.length;c++)u.push(a[c][l]);s.push(u.join(jO))}n.push(s.join("\n"))}),n.join("\n\n"+HO+"\n\n")),(e=r.other,z(e,function(t){var e=t.getRawData(),i=[t.name],n=[];return e.each(e.dimensions,function(){for(var t=arguments.length,r=arguments[t-1],o=e.getName(r),a=0;a<t-1;a++)n[a]=arguments[a];i.push((o?o+jO:"")+n.join(jO))}),i.join("\n")}).join("\n\n"+HO+"\n\n"))],function(t){return!!t.replace(/[\n\t\s]/g,"")}).join("\n\n"+HO+"\n\n"),meta:r.meta}}(t);if("function"==typeof u){var p=u(e.getOption());"string"==typeof p?s.innerHTML=p:X(p)&&s.appendChild(p)}else s.appendChild(l),l.readOnly=n.get("readOnly"),l.style.cssText="width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;",l.style.color=n.get("textColor"),l.style.borderColor=n.get("textareaBorderColor"),l.style.backgroundColor=n.get("textareaColor"),l.value=h.value;var d=h.meta,f=document.createElement("div");f.style.cssText="position:absolute;bottom:0;left:0;right:0;";var m="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",g=document.createElement("div"),y=document.createElement("div");m+=";background-color:"+n.get("buttonColor"),m+=";color:"+n.get("buttonTextColor");var v=this;function _(){i.removeChild(r),v._dom=null}ee(g,"click",_),ee(y,"click",function(){if(null==c&&null!=u||null!=c&&null==u)_();else{var t;try{t="function"==typeof c?c(s,e.getOption()):XO(l.value,d)}catch(t){throw _(),Error("Data view format error "+t)}t&&e.dispatchAction({type:"changeDataView",newOption:t}),_()}}),g.innerHTML=a[1],y.innerHTML=a[2],y.style.cssText=m,g.style.cssText=m,!n.get("readOnly")&&f.appendChild(y),f.appendChild(g),r.appendChild(o),r.appendChild(s),r.appendChild(f),s.style.height=i.clientHeight-80+"px",i.appendChild(r),this._dom=r},e.prototype.remove=function(t,e){this._dom&&e.getDom().removeChild(this._dom)},e.prototype.dispose=function(t,e){this.remove(t,e)},e.getDefaultOption=function(t){return{show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:t.getLocaleModel().get(["toolbox","dataView","title"]),lang:t.getLocaleModel().get(["toolbox","dataView","lang"]),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"}},e}(LO);function KO(t,e){return z(t,function(t,i){var n=e&&e[i];if(j(n)&&!U(n)){j(t)&&!U(t)||(t={value:t});var r=null!=n.name&&null==t.name;return t=C(t,n),r&&delete t.name,t}return t})}Mv({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(t,e){var i=[];L(t.newOption.series,function(t){var n=e.getSeriesByName(t.name)[0];if(n){var r=n.get("data");i.push({name:t.name,data:KO(t.data,r)})}else i.push(I({type:"scatter"},t))}),e.mergeOption(C({series:i},t.newOption))});var JO=L,QO=zr();function tR(t){var e=QO(t);return e.snapshots||(e.snapshots=[{}]),e.snapshots}var eR=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onclick=function(t,e){!function(t){QO(t).snapshots=null}(t),e.dispatchAction({type:"restore",from:this.uid})},e.getDefaultOption=function(t){return{show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:t.getLocaleModel().get(["toolbox","restore","title"])}},e}(LO);Mv({type:"restore",event:"restore",update:"prepareAndUpdate"},function(t,e){e.resetOption("recreate")});var iR=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],nR=function(){function t(t,e,i){var n=this;this._targetInfoList=[];var r=oR(e,t);L(aR,function(t,e){(!i||!i.include||k(i.include,e)>=0)&&t(r,n._targetInfoList)})}return t.prototype.setOutputRanges=function(t,e){return this.matchOutputRanges(t,e,function(t,e,i){if((t.coordRanges||(t.coordRanges=[])).push(e),!t.coordRange){t.coordRange=e;var n=uR[t.brushType](0,i,e);t.__rangeOffset={offset:hR[t.brushType](n.values,t.range,[1,1]),xyMinMax:n.xyMinMax}}}),t},t.prototype.matchOutputRanges=function(t,e,i){L(t,function(t){var n=this.findTargetInfo(t,e);n&&!0!==n&&L(n.coordSyses,function(n){var r=uR[t.brushType](1,n,t.range,!0);i(t,r.values,n,e)})},this)},t.prototype.setInputRanges=function(t,e){L(t,function(t){var i,n,r,o,a,s=this.findTargetInfo(t,e);if(t.range=t.range||[],s&&!0!==s){t.panelId=s.panelId;var l=uR[t.brushType](0,s.coordSys,t.coordRange),u=t.__rangeOffset;t.range=u?hR[t.brushType](l.values,u.offset,(i=l.xyMinMax,n=u.xyMinMax,r=dR(i),o=dR(n),a=[r[0]/o[0],r[1]/o[1]],isNaN(a[0])&&(a[0]=1),isNaN(a[1])&&(a[1]=1),a)):l.values}},this)},t.prototype.makePanelOpts=function(t,e){return z(this._targetInfoList,function(i){var n=i.getPanelRect();return{panelId:i.panelId,defaultBrushType:e?e(i):null,clipPath:pD(n),isTargetByCursor:fD(n,t,i.coordSysModel),getLinearBrushOtherExtent:dD(n)}})},t.prototype.controlSeries=function(t,e,i){var n=this.findTargetInfo(t,i);return!0===n||n&&k(n.coordSyses,e.coordinateSystem)>=0},t.prototype.findTargetInfo=function(t,e){for(var i=this._targetInfoList,n=oR(e,t),r=0;r<i.length;r++){var o=i[r],a=t.panelId;if(a){if(o.panelId===a)return o}else for(var s=0;s<sR.length;s++)if(sR[s](n,o))return o}return!0},t}();function rR(t){return t[0]>t[1]&&t.reverse(),t}function oR(t,e){return Rr(t,e,{includeMainTypes:iR})}var aR={grid:function(t,e){var i=t.xAxisModels,n=t.yAxisModels,r=t.gridModels,o=ht(),a={},s={};(i||n||r)&&(L(i,function(t){var e=t.axis.grid.model;o.set(e.id,e),a[e.id]=!0}),L(n,function(t){var e=t.axis.grid.model;o.set(e.id,e),s[e.id]=!0}),L(r,function(t){o.set(t.id,t),a[t.id]=!0,s[t.id]=!0}),o.each(function(t){var r=t.coordinateSystem,o=[];L(r.getCartesians(),function(t,e){(k(i,t.getAxis("x").model)>=0||k(n,t.getAxis("y").model)>=0)&&o.push(t)}),e.push({panelId:"grid--"+t.id,gridModel:t,coordSysModel:t,coordSys:o[0],coordSyses:o,getPanelRect:lR.grid,xAxisDeclared:a[t.id],yAxisDeclared:s[t.id]})}))},geo:function(t,e){L(t.geoModels,function(t){var i=t.coordinateSystem;e.push({panelId:"geo--"+t.id,geoModel:t,coordSysModel:t,coordSys:i,coordSyses:[i],getPanelRect:lR.geo})})}},sR=[function(t,e){var i=t.xAxisModel,n=t.yAxisModel,r=t.gridModel;return!r&&i&&(r=i.axis.grid.model),!r&&n&&(r=n.axis.grid.model),r&&r===e.gridModel},function(t,e){var i=t.geoModel;return i&&i===e.geoModel}],lR={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var t=this.coordSys,e=t.getBoundingRect().clone();return e.applyTransform(rc(t)),e}},uR={lineX:V(cR,0),lineY:V(cR,1),rect:function(t,e,i,n){var r=t?e.pointToData([i[0][0],i[1][0]],n):e.dataToPoint([i[0][0],i[1][0]],n),o=t?e.pointToData([i[0][1],i[1][1]],n):e.dataToPoint([i[0][1],i[1][1]],n),a=[rR([r[0],o[0]]),rR([r[1],o[1]])];return{values:a,xyMinMax:a}},polygon:function(t,e,i,n){var r=[[1/0,-1/0],[1/0,-1/0]];return{values:z(i,function(i){var o=t?e.pointToData(i,n):e.dataToPoint(i,n);return r[0][0]=Math.min(r[0][0],o[0]),r[1][0]=Math.min(r[1][0],o[1]),r[0][1]=Math.max(r[0][1],o[0]),r[1][1]=Math.max(r[1][1],o[1]),o}),xyMinMax:r}}};function cR(t,e,i,n){var r=i.getAxis(["x","y"][t]),o=rR(z([0,1],function(t){return e?r.coordToData(r.toLocalCoord(n[t]),!0):r.toGlobalCoord(r.dataToCoord(n[t]))})),a=[];return a[t]=o,a[1-t]=[NaN,NaN],{values:o,xyMinMax:a}}var hR={lineX:V(pR,0),lineY:V(pR,1),rect:function(t,e,i){return[[t[0][0]-i[0]*e[0][0],t[0][1]-i[0]*e[0][1]],[t[1][0]-i[1]*e[1][0],t[1][1]-i[1]*e[1][1]]]},polygon:function(t,e,i){return z(t,function(t,n){return[t[0]-i[0]*e[n][0],t[1]-i[1]*e[n][1]]})}};function pR(t,e,i,n){return[e[0]-n[t]*i[0],e[1]-n[t]*i[1]]}function dR(t){return t?[t[0][1]-t[0][0],t[1][1]-t[1][0]]:[NaN,NaN]}var fR,mR,gR=L,yR=br+"toolbox-dataZoom_",vR=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.render=function(t,e,i,n){this._brushController||(this._brushController=new Ok(i.getZr()),this._brushController.on("brush",F(this._onBrush,this)).mount()),function(t,e,i,n,r){var o=i._isZoomActive;n&&"takeGlobalCursor"===n.type&&(o="dataZoomSelect"===n.key&&n.dataZoomSelectActive),i._isZoomActive=o,t.setIconStatus("zoom",o?"emphasis":"normal");var a=new nR(xR(t),e,{include:["grid"]}).makePanelOpts(r,function(t){return t.xAxisDeclared&&!t.yAxisDeclared?"lineX":!t.xAxisDeclared&&t.yAxisDeclared?"lineY":"rect"});i._brushController.setPanels(a).enableBrush(!(!o||!a.length)&&{brushType:"auto",brushStyle:t.getModel("brushStyle").getItemStyle()})}(t,e,this,n,i),function(t,e){t.setIconStatus("back",function(t){return tR(t).length}(e)>1?"emphasis":"normal")}(t,e)},e.prototype.onclick=function(t,e,i){_R[i].call(this)},e.prototype.remove=function(t,e){this._brushController&&this._brushController.unmount()},e.prototype.dispose=function(t,e){this._brushController&&this._brushController.dispose()},e.prototype._onBrush=function(t){var e=t.areas;if(t.isEnd&&e.length){var i={},n=this.ecModel;this._brushController.updateCovers([]),new nR(xR(this.model),n,{include:["grid"]}).matchOutputRanges(e,n,function(t,e,i){if("cartesian2d"===i.type){var n=t.brushType;"rect"===n?(r("x",i,e[0]),r("y",i,e[1])):r({lineX:"x",lineY:"y"}[n],i,e)}}),function(t,e){var i=tR(t);JO(e,function(e,n){for(var r=i.length-1;r>=0&&!i[r][n];r--);if(r<0){var o=t.queryComponents({mainType:"dataZoom",subType:"select",id:n})[0];if(o){var a=o.getPercentRange();i[0][n]={dataZoomId:n,start:a[0],end:a[1]}}}}),i.push(e)}(n,i),this._dispatchZoomAction(i)}function r(t,e,r){var o=e.getAxis(t),a=o.model,s=function(t,e,i){var n;return i.eachComponent({mainType:"dataZoom",subType:"select"},function(i){i.getAxisModel(t,e.componentIndex)&&(n=i)}),n}(t,a,n),l=s.findRepresentativeAxisProxy(a).getMinMaxSpan();null==l.minValueSpan&&null==l.maxValueSpan||(r=ck(0,r.slice(),o.scale.getExtent(),0,l.minValueSpan,l.maxValueSpan)),s&&(i[s.id]={dataZoomId:s.id,startValue:r[0],endValue:r[1]})}},e.prototype._dispatchZoomAction=function(t){var e=[];gR(t,function(t,i){e.push(S(t))}),e.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:e})},e.getDefaultOption=function(t){return{show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:t.getLocaleModel().get(["toolbox","dataZoom","title"]),brushStyle:{borderWidth:0,color:"rgba(210,219,238,0.2)"}}},e}(LO),_R={zoom:function(){var t=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:t})},back:function(){this._dispatchZoomAction(function(t){var e=tR(t),i=e[e.length-1];e.length>1&&e.pop();var n={};return JO(i,function(t,i){for(var r=e.length-1;r>=0;r--)if(t=e[r][i]){n[i]=t;break}}),n}(this.ecModel))}};function xR(t){var e={xAxisIndex:t.get("xAxisIndex",!0),yAxisIndex:t.get("yAxisIndex",!0),xAxisId:t.get("xAxisId",!0),yAxisId:t.get("yAxisId",!0)};return null==e.xAxisIndex&&null==e.xAxisId&&(e.xAxisIndex="all"),null==e.yAxisIndex&&null==e.yAxisId&&(e.yAxisIndex="all"),e}fR="dataZoom",mR=function(t){var e=t.getComponent("toolbox",0),i=["feature","dataZoom"];if(e&&null!=e.get(i)){var n=e.getModel(i),r=[],o=Rr(t,xR(n));return gR(o.xAxisModels,function(t){return a(t,"xAxis","xAxisIndex")}),gR(o.yAxisModels,function(t){return a(t,"yAxis","yAxisIndex")}),r}function a(t,e,i){var o=t.componentIndex,a={type:"select",$fromToolbox:!0,filterMode:n.get("filterMode",!0)||"filter",id:yR+e+o};a[i]=o,r.push(a)}},ot(null==Tp.get(fR)&&mR),Tp.set(fR,mR);var bR=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.type="tooltip",e.dependencies=["axisPointer"],e.defaultOption={zlevel:0,z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},e}(ip);function wR(t){var e=t.get("confine");return null!=e?!!e:"richText"===t.get("renderMode")}function SR(t){if(a.domSupported)for(var e=document.documentElement.style,i=0,n=t.length;i<n;i++)if(t[i]in e)return t[i]}var TR=SR(["transform","webkitTransform","OTransform","MozTransform","msTransform"]);function MR(t,e){if(!t)return e;e=Ph(e,!0);var i=t.indexOf(e);return(t=-1===i?e:"-"+t.slice(0,i)+"-"+e).toLowerCase()}var IR=MR(SR(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),"transition"),CR=MR(TR,"transform"),AR="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(a.transform3dSupported?"will-change:transform;":"");function kR(t,e,i){var n=t.toFixed(0)+"px",r=e.toFixed(0)+"px";if(!a.transformSupported)return i?"top:"+r+";left:"+n+";":[["top",r],["left",n]];var o=a.transform3dSupported,s="translate"+(o?"3d":"")+"("+n+","+r+(o?",0":"")+")";return i?"top:0;left:0;"+CR+":"+s+";":[["top",0],["left",0],[TR,s]]}function DR(t,e,i){var n=[],r=t.get("transitionDuration"),o=t.get("backgroundColor"),s=t.get("shadowBlur"),l=t.get("shadowColor"),u=t.get("shadowOffsetX"),c=t.get("shadowOffsetY"),h=t.getModel("textStyle"),p=Df(t,"html"),d=u+"px "+c+"px "+s+"px "+l;return n.push("box-shadow:"+d),e&&r&&n.push(function(t,e){var i="cubic-bezier(0.23,1,0.32,1)",n=" "+t/2+"s "+i,r="opacity"+n+",visibility"+n;return e||(n=" "+t+"s "+i,r+=a.transformSupported?","+CR+n:",left"+n+",top"+n),IR+":"+r}(r,i)),o&&(a.canvasSupported?n.push("background-color:"+o):(n.push("background-color:#"+qe(o)),n.push("filter:alpha(opacity=70)"))),L(["width","color","radius"],function(e){var i="border-"+e,r=Ph(i),o=t.get(r);null!=o&&n.push(i+":"+o+("color"===e?"":"px"))}),n.push(function(t){var e=[],i=t.get("fontSize"),n=t.getTextColor();n&&e.push("color:"+n),e.push("font:"+t.getFont()),i&&e.push("line-height:"+Math.round(3*i/2)+"px");var r=t.get("textShadowColor"),o=t.get("textShadowBlur")||0,a=t.get("textShadowOffsetX")||0,s=t.get("textShadowOffsetY")||0;return r&&o&&e.push("text-shadow:"+a+"px "+s+"px "+o+"px "+r),L(["decoration","align"],function(i){var n=t.get(i);n&&e.push("text-"+i+":"+n)}),e.join(";")}(h)),null!=p&&n.push("padding:"+Lh(p).join("px ")+"px"),n.join(";")+";"}function ER(t,e,i,n,r){var o=e&&e.painter;if(i){var a=o&&o.getViewportRoot();a&&function(t,e,i,n,r){jt(Ht,e,n,r,!0)&&jt(t,i,Ht[0],Ht[1])}(t,a,document.body,n,r)}else{t[0]=n,t[1]=r;var s=o&&o.getViewportRootOffset();s&&(t[0]+=s.offsetLeft,t[1]+=s.offsetTop)}t[2]=t[0]/e.getWidth(),t[3]=t[1]/e.getHeight()}var PR=function(){function t(t,e,i){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._firstShow=!0,this._longHide=!0,a.wxa)return null;var n=document.createElement("div");n.domBelongToZr=!0,this.el=n;var r=this._zr=e.getZr(),o=this._appendToBody=i&&i.appendToBody;ER(this._styleCoord,r,o,e.getWidth()/2,e.getHeight()/2),o?document.body.appendChild(n):t.appendChild(n),this._container=t;var s=this;n.onmouseenter=function(){s._enterable&&(clearTimeout(s._hideTimeout),s._show=!0),s._inContent=!0},n.onmousemove=function(t){if(t=t||window.event,!s._enterable){var e=r.handler;te(r.painter.getViewportRoot(),t,!0),e.dispatch("mousemove",t)}},n.onmouseleave=function(){s._inContent=!1,s._enterable&&s._show&&s.hideLater(s._hideDelay)}}return t.prototype.update=function(t){var e,i,n,r=this._container,o=(i="position",(n=(e=r).currentStyle||document.defaultView&&document.defaultView.getComputedStyle(e))?n[i]:null),a=r.style;"absolute"!==a.position&&"absolute"!==o&&(a.position="relative"),t.get("alwaysShowContent")&&this._moveIfResized(),this.el.className=t.get("className")||""},t.prototype.show=function(t,e){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var i=this.el,n=i.style,r=this._styleCoord;i.innerHTML?n.cssText=AR+DR(t,!this._firstShow,this._longHide)+kR(r[0],r[1],!0)+"border-color:"+Gh(e)+";"+(t.get("extraCssText")||"")+";pointer-events:"+(this._enterable?"auto":"none"):n.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},t.prototype.setContent=function(t,e,i,n,r){var o=this.el;if(null!=t){var a="";if($(r)&&"item"===i.get("trigger")&&!wR(i)&&(a=function(t,e,i){if(!$(i)||"inside"===i)return"";var n=t.get("backgroundColor"),r=t.get("borderWidth");e=Gh(e);var o,a,s="left"===(o=i)?"right":"right"===o?"left":"top"===o?"bottom":"top",l=Math.max(1.5*Math.round(r),6),u="",c=CR+":";k(["left","right"],s)>-1?(u+="top:50%",c+="translateY(-50%) rotate("+(a="left"===s?-225:-45)+"deg)"):(u+="left:50%",c+="translateX(-50%) rotate("+(a="top"===s?225:45)+"deg)");var h=a*Math.PI/180,p=l+r,d=p*Math.abs(Math.cos(h))+p*Math.abs(Math.sin(h)),f=e+" solid "+r+"px;";return'<div style="position:absolute;width:'+l+"px;height:"+l+"px;"+(u+=";"+s+":-"+Math.round(100*((d-Math.SQRT2*r)/2+Math.SQRT2*r-(d-p)/2))/100+"px")+";"+c+";border-bottom:"+f+"border-right:"+f+"background-color:"+n+';"></div>'}(i,n,r)),$(t))o.innerHTML=t+a;else if(t){o.innerHTML="",U(t)||(t=[t]);for(var s=0;s<t.length;s++)X(t[s])&&t[s].parentNode!==o&&o.appendChild(t[s]);if(a&&o.childNodes.length){var l=document.createElement("div");l.innerHTML=a,o.appendChild(l)}}}else o.innerHTML=""},t.prototype.setEnterable=function(t){this._enterable=t},t.prototype.getSize=function(){var t=this.el;return[t.offsetWidth,t.offsetHeight]},t.prototype.moveTo=function(t,e){var i=this._styleCoord;if(ER(i,this._zr,this._appendToBody,t,e),null!=i[0]&&null!=i[1]){var n=this.el.style;L(kR(i[0],i[1]),function(t){n[t[0]]=t[1]})}},t.prototype._moveIfResized=function(){var t=this._styleCoord[2],e=this._styleCoord[3];this.moveTo(t*this._zr.getWidth(),e*this._zr.getHeight())},t.prototype.hide=function(){var t=this,e=this.el.style;e.visibility="hidden",e.opacity="0",a.transform3dSupported&&(e.willChange=""),this._show=!1,this._longHideTimeout=setTimeout(function(){return t._longHide=!0},500)},t.prototype.hideLater=function(t){!this._show||this._inContent&&this._enterable||(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(F(this.hide,this),t)):this.hide())},t.prototype.isShow=function(){return this._show},t.prototype.dispose=function(){this.el.parentNode.removeChild(this.el)},t}(),LR=function(){function t(t){this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._zr=t.getZr(),RR(this._styleCoord,this._zr,t.getWidth()/2,t.getHeight()/2)}return t.prototype.update=function(t){t.get("alwaysShowContent")&&this._moveIfResized()},t.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},t.prototype.setContent=function(t,e,i,n,r){j(t)&&_r(""),this.el&&this._zr.remove(this.el);var o=i.getModel("textStyle");this.el=new fs({style:{rich:e.richTextStyles,text:t,lineHeight:22,backgroundColor:i.get("backgroundColor"),borderRadius:i.get("borderRadius"),borderWidth:1,borderColor:n,shadowColor:i.get("shadowColor"),shadowBlur:i.get("shadowBlur"),shadowOffsetX:i.get("shadowOffsetX"),shadowOffsetY:i.get("shadowOffsetY"),textShadowColor:o.get("textShadowColor"),textShadowBlur:o.get("textShadowBlur")||0,textShadowOffsetX:o.get("textShadowOffsetX")||0,textShadowOffsetY:o.get("textShadowOffsetY")||0,fill:i.get(["textStyle","color"]),padding:Df(i,"richText"),verticalAlign:"top",align:"left"},z:i.get("z")}),this._zr.add(this.el);var a=this;this.el.on("mouseover",function(){a._enterable&&(clearTimeout(a._hideTimeout),a._show=!0),a._inContent=!0}),this.el.on("mouseout",function(){a._enterable&&a._show&&a.hideLater(a._hideDelay),a._inContent=!1})},t.prototype.setEnterable=function(t){this._enterable=t},t.prototype.getSize=function(){var t=this.el,e=this.el.getBoundingRect(),i=OR(t.style);return[e.width+i.left+i.right,e.height+i.top+i.bottom]},t.prototype.moveTo=function(t,e){var i=this.el;if(i){var n=this._styleCoord;RR(n,this._zr,t,e),t=n[0],e=n[1];var r=i.style,o=zR(r.borderWidth||0),a=OR(r);i.x=t+o+a.left,i.y=e+o+a.top,i.markRedraw()}},t.prototype._moveIfResized=function(){var t=this._styleCoord[2],e=this._styleCoord[3];this.moveTo(t*this._zr.getWidth(),e*this._zr.getHeight())},t.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},t.prototype.hideLater=function(t){!this._show||this._inContent&&this._enterable||(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(F(this.hide,this),t)):this.hide())},t.prototype.isShow=function(){return this._show},t.prototype.dispose=function(){this._zr.remove(this.el)},t}();function zR(t){return Math.max(0,t)}function OR(t){var e=zR(t.shadowBlur||0),i=zR(t.shadowOffsetX||0),n=zR(t.shadowOffsetY||0);return{left:zR(e-i),right:zR(e+i),top:zR(e-n),bottom:zR(e+n)}}function RR(t,e,i,n){t[0]=i,t[1]=n,t[2]=t[0]/e.getWidth(),t[3]=t[1]/e.getHeight()}var BR=F,NR=L,FR=Xn,VR=new hs({shape:{x:-1,y:-1,width:2,height:2}}),UR=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.init=function(t,e){if(!a.node){var i,n=t.getComponent("tooltip"),r=n.get("renderMode");this._renderMode="auto"===(i=r)?a.domSupported?"html":"richText":i||"html",this._tooltipContent="richText"===this._renderMode?new LR(e):new PR(e.getDom(),e,{appendToBody:n.get("appendToBody",!0)})}},e.prototype.render=function(t,e,i){if(!a.node){this.group.removeAll(),this._tooltipModel=t,this._ecModel=e,this._api=i,this._alwaysShowContent=t.get("alwaysShowContent");var n=this._tooltipContent;n.update(t),n.setEnterable(t.get("enterable")),this._initGlobalListener(),this._keepShow(),this._updatePosition="html"===this._renderMode?im(BR(this._doUpdatePosition,this),50):this._doUpdatePosition}},e.prototype._initGlobalListener=function(){var t=this._tooltipModel.get("triggerOn");jL("itemTooltip",this._api,BR(function(e,i,n){"none"!==t&&(t.indexOf(e)>=0?this._tryShow(i,n):"leave"===e&&this._hide(n))},this))},e.prototype._keepShow=function(){var t=this._tooltipModel,e=this._ecModel,i=this._api;if(null!=this._lastX&&null!=this._lastY&&"none"!==t.get("triggerOn")){var n=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){!i.isDisposed()&&n.manuallyShowTip(t,e,i,{x:n._lastX,y:n._lastY,dataByCoordSys:n._lastDataByCoordSys})})}},e.prototype.manuallyShowTip=function(t,e,i,n){if(n.from!==this.uid&&!a.node){var r=$R(n,i);this._ticket="";var o=n.dataByCoordSys,s=function(t,e,i){var n=Br(t).queryOptionMap,r=n.keys()[0];if(r&&"series"!==r){var o,a=Vr(e,r,n.get(r),{useDefault:!1,enableAll:!1,enableNone:!1}).models[0];if(a)return i.getViewOfComponentModel(a).group.traverse(function(e){var i=Ss(e).tooltipConfig;if(i&&i.name===t.name)return o=e,!0}),o?{componentMainType:r,componentIndex:a.componentIndex,el:o}:void 0}}(n,e,i);if(s){var l=s.el.getBoundingRect().clone();l.applyTransform(s.el.transform),this._tryShow({offsetX:l.x+l.width/2,offsetY:l.y+l.height/2,target:s.el,position:n.position,positionDefault:"bottom"},r)}else if(n.tooltip&&null!=n.x&&null!=n.y){var u=VR;u.x=n.x,u.y=n.y,u.update(),Ss(u).tooltipConfig={name:null,option:n.tooltip},this._tryShow({offsetX:n.x,offsetY:n.y,target:u},r)}else if(o)this._tryShow({offsetX:n.x,offsetY:n.y,position:n.position,dataByCoordSys:o,tooltipOption:n.tooltipOption},r);else if(null!=n.seriesIndex){if(this._manuallyAxisShowTip(t,e,i,n))return;var c=KL(n,e),h=c.point[0],p=c.point[1];null!=h&&null!=p&&this._tryShow({offsetX:h,offsetY:p,target:c.el,position:n.position,positionDefault:"bottom"},r)}else null!=n.x&&null!=n.y&&(i.dispatchAction({type:"updateAxisPointer",x:n.x,y:n.y}),this._tryShow({offsetX:n.x,offsetY:n.y,position:n.position,target:i.getZr().findHover(n.x,n.y).target},r))}},e.prototype.manuallyHideTip=function(t,e,i,n){var r=this._tooltipContent;!this._alwaysShowContent&&this._tooltipModel&&r.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,n.from!==this.uid&&this._hide($R(n,i))},e.prototype._manuallyAxisShowTip=function(t,e,i,n){var r=n.seriesIndex,o=n.dataIndex,a=e.getComponent("axisPointer").coordSysAxesInfo;if(null!=r&&null!=o&&null!=a){var s=e.getSeriesByIndex(r);if(s&&"axis"===GR([s.getData().getItemModel(o),s,(s.coordinateSystem||{}).model],this._tooltipModel).get("trigger"))return i.dispatchAction({type:"updateAxisPointer",seriesIndex:r,dataIndex:o,position:n.position}),!0}},e.prototype._tryShow=function(t,e){var i=t.target;if(this._tooltipModel){this._lastX=t.offsetX,this._lastY=t.offsetY;var n=t.dataByCoordSys;if(n&&n.length)this._showAxisTooltip(n,t);else if(i){var r,o;this._lastDataByCoordSys=null,$m(i,function(t){return null!=Ss(t).dataIndex?(r=t,!0):null!=Ss(t).tooltipConfig?(o=t,!0):void 0},!0),r?this._showSeriesItemTooltip(t,r,e):o?this._showComponentItemTooltip(t,o,e):this._hide(e)}else this._lastDataByCoordSys=null,this._hide(e)}},e.prototype._showOrMove=function(t,e){var i=t.get("showDelay");e=F(e,this),clearTimeout(this._showTimout),i>0?this._showTimout=setTimeout(e,i):e()},e.prototype._showAxisTooltip=function(t,e){var i=this._ecModel,n=this._tooltipModel,r=[e.offsetX,e.offsetY],o=GR([e.tooltipOption],n),a=this._renderMode,s=[],l=wf("section",{blocks:[],noHeader:!0}),u=[],c=new Ef;NR(t,function(t){NR(t.dataByAxis,function(t){var e=i.getComponent(t.axisDim+"Axis",t.axisIndex),n=t.value;if(e&&null!=n){var r=LL(n,e.axis,i,t.seriesDataIndices,t.valueLabelOpt),o=wf("section",{header:r,noHeader:!at(r),sortBlocks:!0,blocks:[]});l.blocks.push(o),L(t.seriesDataIndices,function(l){var h=i.getSeriesByIndex(l.seriesIndex),p=l.dataIndexInside,d=h.getDataParams(p);if(!(d.dataIndex<0)){d.axisDim=t.axisDim,d.axisIndex=t.axisIndex,d.axisType=t.axisType,d.axisId=t.axisId,d.axisValue=_x(e.axis,{value:n}),d.axisValueLabel=r,d.marker=c.makeTooltipMarker("item",Gh(d.color),a);var f=Nd(h.formatTooltip(p,!0,null));f.markupFragment&&o.blocks.push(f.markupFragment),f.markupText&&u.push(f.markupText),s.push(d)}})}})}),l.blocks.reverse(),u.reverse();var h=e.position,p=o.get("order"),d=Mf(l,c,a,p,i.get("useUTC"),o.get("textStyle"));d&&u.unshift(d);var f="richText"===a?"\n\n":"<br/>",m=u.join(f);this._showOrMove(o,function(){this._updateContentNotChangedOnAxis(t,s)?this._updatePosition(o,h,r[0],r[1],this._tooltipContent,s):this._showTooltipContent(o,m,s,Math.random()+"",r[0],r[1],h,null,c)})},e.prototype._showSeriesItemTooltip=function(t,e,i){var n=this._ecModel,r=Ss(e),o=r.seriesIndex,a=n.getSeriesByIndex(o),s=r.dataModel||a,l=r.dataIndex,u=r.dataType,c=s.getData(u),h=this._renderMode,p=t.positionDefault,d=GR([c.getItemModel(l),s,a&&(a.coordinateSystem||{}).model],this._tooltipModel,p?{position:p}:null),f=d.get("trigger");if(null==f||"item"===f){var m=s.getDataParams(l,u),g=new Ef;m.marker=g.makeTooltipMarker("item",Gh(m.color),h);var y=Nd(s.formatTooltip(l,!1,u)),v=d.get("order"),_=y.markupFragment?Mf(y.markupFragment,g,h,v,n.get("useUTC"),d.get("textStyle")):y.markupText,x="item_"+s.name+"_"+l;this._showOrMove(d,function(){this._showTooltipContent(d,_,m,x,t.offsetX,t.offsetY,t.position,t.target,g)}),i({type:"showTip",dataIndexInside:l,dataIndex:c.getRawIndex(l),seriesIndex:o,from:this.uid})}},e.prototype._showComponentItemTooltip=function(t,e,i){var n=Ss(e),r=n.tooltipConfig.option||{};$(r)&&(r={content:r,formatter:r});var o=[r],a=this._ecModel.getComponent(n.componentMainType,n.componentIndex);a&&o.push(a),o.push({formatter:r.content});var s=t.positionDefault,l=GR(o,this._tooltipModel,s?{position:s}:null),u=l.get("content"),c=Math.random()+"",h=new Ef;this._showOrMove(l,function(){var i=S(l.get("formatterParams")||{});this._showTooltipContent(l,u,i,c,t.offsetX,t.offsetY,t.position,e,h)}),i({type:"showTip",from:this.uid})},e.prototype._showTooltipContent=function(t,e,i,n,r,o,a,s,l){if(this._ticket="",t.get("showContent")&&t.get("show")){var u=this._tooltipContent,c=t.get("formatter");a=a||t.get("position");var h=e,p=this._getNearestPoint([r,o],i,t.get("trigger"),t.get("borderColor")).color;if(c)if($(c)){var d=t.ecModel.get("useUTC"),f=U(i)?i[0]:i;h=c,f&&f.axisType&&f.axisType.indexOf("time")>=0&&(h=fh(f.axisValue,h,d)),h=Vh(h,i,!0)}else if(G(c)){var m=BR(function(e,n){e===this._ticket&&(u.setContent(n,l,t,p,a),this._updatePosition(t,a,r,o,u,i,s))},this);this._ticket=n,h=c(i,n,m)}else h=c;u.setContent(h,l,t,p,a),u.show(t,p),this._updatePosition(t,a,r,o,u,i,s)}},e.prototype._getNearestPoint=function(t,e,i,n){return"axis"===i||U(e)?{color:n||("html"===this._renderMode?"#fff":"none")}:U(e)?void 0:{color:n||e.color||e.borderColor}},e.prototype._doUpdatePosition=function(t,e,i,n,r,o,a){var s=this._api.getWidth(),l=this._api.getHeight();e=e||t.get("position");var u=r.getSize(),c=t.get("align"),h=t.get("verticalAlign"),p=a&&a.getBoundingRect().clone();if(a&&p.applyTransform(a.transform),G(e)&&(e=e([i,n],o,r.el,p,{viewSize:[s,l],contentSize:u.slice()})),U(e))i=FR(e[0],s),n=FR(e[1],l);else if(j(e)){var d=e;d.width=u[0],d.height=u[1];var f=Xh(d,{width:s,height:l});i=f.x,n=f.y,c=null,h=null}else if($(e)&&a){var m=function(t,e,i,n){var r=i[0],o=i[1],a=Math.ceil(Math.SQRT2*n)+8,s=0,l=0,u=e.width,c=e.height;switch(t){case"inside":s=e.x+u/2-r/2,l=e.y+c/2-o/2;break;case"top":s=e.x+u/2-r/2,l=e.y-o-a;break;case"bottom":s=e.x+u/2-r/2,l=e.y+c+a;break;case"left":s=e.x-r-a,l=e.y+c/2-o/2;break;case"right":s=e.x+u+a,l=e.y+c/2-o/2}return[s,l]}(e,p,u,t.get("borderWidth"));i=m[0],n=m[1]}else m=function(t,e,i,n,r,o,a){var s=i.getSize(),l=s[0],u=s[1];return null!=o&&(t+l+o+2>n?t-=l+o:t+=o),null!=a&&(e+u+a>r?e-=u+a:e+=a),[t,e]}(i,n,r,s,l,c?null:20,h?null:20),i=m[0],n=m[1];c&&(i-=WR(c)?u[0]/2:"right"===c?u[0]:0),h&&(n-=WR(h)?u[1]/2:"bottom"===h?u[1]:0),wR(t)&&(m=function(t,e,i,n,r){var o=i.getSize(),a=o[0],s=o[1];return t=Math.min(t+a,n)-a,e=Math.min(e+s,r)-s,[t=Math.max(t,0),e=Math.max(e,0)]}(i,n,r,s,l),i=m[0],n=m[1]),r.moveTo(i,n)},e.prototype._updateContentNotChangedOnAxis=function(t,e){var i=this._lastDataByCoordSys,n=this._cbParamsList,r=!!i&&i.length===t.length;return r&&NR(i,function(i,o){var a=i.dataByAxis||[],s=(t[o]||{}).dataByAxis||[];(r=r&&a.length===s.length)&&NR(a,function(t,i){var o=s[i]||{},a=t.seriesDataIndices||[],l=o.seriesDataIndices||[];(r=r&&t.value===o.value&&t.axisType===o.axisType&&t.axisId===o.axisId&&a.length===l.length)&&NR(a,function(t,e){var i=l[e];r=r&&t.seriesIndex===i.seriesIndex&&t.dataIndex===i.dataIndex}),n&&L(t.seriesDataIndices,function(t){var i=t.seriesIndex,o=e[i],a=n[i];o&&a&&a.data!==o.data&&(r=!1)})})}),this._lastDataByCoordSys=t,this._cbParamsList=e,!!r},e.prototype._hide=function(t){this._lastDataByCoordSys=null,t({type:"hideTip",from:this.uid})},e.prototype.dispose=function(t,e){a.node||(this._tooltipContent.dispose(),XL("itemTooltip",e))},e.type="tooltip",e}($f);function GR(t,e,i){var n,r=e.ecModel;i?(n=new $c(i,r,r),n=new $c(e.option,n,r)):n=e;for(var o=t.length-1;o>=0;o--){var a=t[o];a&&(a instanceof $c&&(a=a.get("tooltip",!0)),$(a)&&(a={formatter:a}),a&&(n=new $c(a,n,r)))}return n}function $R(t,e){return t.dispatchAction||F(e.dispatchAction,e)}function WR(t){return"center"===t||"middle"===t}var HR=["rect","polygon","keep","clear"];function jR(t,e){var i=wr(t?t.brush:[]);if(i.length){var n=[];L(i,function(t){var e=t.hasOwnProperty("toolbox")?t.toolbox:[];e instanceof Array&&(n=n.concat(e))});var r=t&&t.toolbox;U(r)&&(r=r[0]),r||(r={feature:{}},t.toolbox=[r]);var o=r.feature||(r.feature={}),a=o.brush||(o.brush={}),s=a.type||(a.type=[]);s.push.apply(s,n),function(t){var e={};L(t,function(t){e[t]=1}),t.length=0,L(e,function(e,i){t.push(i)})}(s),e&&!s.length&&s.push.apply(s,HR)}}var ZR=L;function qR(t){if(t)for(var e in t)if(t.hasOwnProperty(e))return!0}function XR(t,e,i){var n={};return ZR(e,function(e){var r,o=n[e]=((r=function(){}).prototype.__hidden=r.prototype,new r);ZR(t[e],function(t,n){if(rC.isValidType(n)){var r={type:n,visual:t};i&&i(r,e),o[n]=new rC(r),"opacity"===n&&((r=S(r)).type="colorAlpha",o.__hidden.__alphaForOpacity=new rC(r))}})}),n}function YR(t,e,i){var n;L(i,function(t){e.hasOwnProperty(t)&&qR(e[t])&&(n=!0)}),n&&L(i,function(i){e.hasOwnProperty(i)&&qR(e[i])?t[i]=S(e[i]):delete t[i]})}var KR={lineX:JR(0),lineY:JR(1),rect:{point:function(t,e,i){return t&&i.boundingRect.contain(t[0],t[1])},rect:function(t,e,i){return t&&i.boundingRect.intersect(t)}},polygon:{point:function(t,e,i){return t&&i.boundingRect.contain(t[0],t[1])&&Qg(i.range,t[0],t[1])},rect:function(t,e,i){var n=i.range;if(!t||n.length<=1)return!1;var r=t.x,o=t.y,a=t.width,s=t.height,l=n[0];return!!(Qg(n,r,o)||Qg(n,r+a,o)||Qg(n,r,o+s)||Qg(n,r+a,o+s)||yn.create(t).contain(l[0],l[1])||pc(r,o,r+a,o,n)||pc(r,o,r,o+s,n)||pc(r+a,o,r+a,o+s,n)||pc(r,o+s,r+a,o+s,n))||void 0}}};function JR(t){var e=["x","y"],i=["width","height"];return{point:function(e,i,n){if(e){var r=n.range;return QR(e[t],r)}},rect:function(n,r,o){if(n){var a=o.range,s=[n[e[t]],n[e[t]]+n[i[t]]];return s[1]<s[0]&&s.reverse(),QR(s[0],a)||QR(s[1],a)||QR(a[0],s)||QR(a[1],s)}}}}function QR(t,e){return e[0]<=t&&t<=e[1]}var tB=["inBrush","outOfBrush"],eB="__ecBrushSelect",iB="__ecInBrushSelectEvent";function nB(t){t.eachComponent({mainType:"brush"},function(e){(e.brushTargetManager=new nR(e.option,t)).setInputRanges(e.areas,t)})}function rB(t,e,i){var n,r,o=[];t.eachComponent({mainType:"brush"},function(t){i&&"takeGlobalCursor"===i.type&&t.setBrushOption("brush"===i.key?i.brushOption:{brushType:!1})}),nB(t),t.eachComponent({mainType:"brush"},function(e,i){var a={brushId:e.id,brushIndex:i,brushName:e.name,areas:S(e.areas),selected:[]};o.push(a);var s=e.option,l=s.brushLink,u=[],c=[],h=[],p=!1;i||(n=s.throttleType,r=s.throttleDelay);var d=z(e.areas,function(t){var e=sB[t.brushType],i=C({boundingRect:e?e(t):void 0},t);return i.selectors=function(t){var e=t.brushType,i={point:function(n){return KR[e].point(n,i,t)},rect:function(n){return KR[e].rect(n,i,t)}};return i}(i),i}),f=XR(e.option,tB,function(t){t.mappingMethod="fixed"});function m(t){return"all"===l||!!u[t]}function g(t){return!!t.length}U(l)&&L(l,function(t){u[t]=1}),t.eachSeries(function(i,n){var r=h[n]=[];"parallel"===i.subType?function(t,e){var i=t.coordinateSystem;p=p||i.hasAxisBrushed(),m(e)&&i.eachActiveState(t.getData(),function(t,e){"active"===t&&(c[e]=1)})}(i,n):function(i,n,r){if(i.brushSelector&&!function(t,e){var i=t.option.seriesIndex;return null!=i&&"all"!==i&&(U(i)?k(i,e)<0:e!==i)}(e,n)&&(L(d,function(n){e.brushTargetManager.controlSeries(n,i,t)&&r.push(n),p=p||g(r)}),m(n)&&g(r))){var o=i.getData();o.each(function(t){aB(i,r,o,t)&&(c[t]=1)})}}(i,n,r)}),t.eachSeries(function(t,e){var i={seriesId:t.id,seriesIndex:e,seriesName:t.name,dataIndex:[]};a.selected.push(i);var n=h[e],r=t.getData(),o=m(e)?function(t){return c[t]?(i.dataIndex.push(r.getRawIndex(t)),"inBrush"):"outOfBrush"}:function(e){return aB(t,n,r,e)?(i.dataIndex.push(r.getRawIndex(e)),"inBrush"):"outOfBrush"};(m(e)?p:g(n))&&function(t,e,i,n,r,o){var a,s={};function l(t){return Nm(i,a,t)}function u(t,e){Vm(i,a,t,e)}function c(t,c){a=null==o?t:c;var h=i.getRawDataItem(a);if(!h||!1!==h.visualMap)for(var p=n.call(r,t),d=e[p],f=s[p],m=0,g=f.length;m<g;m++){var y=f[m];d[y]&&d[y].applyVisual(t,l,u)}}L(t,function(t){var i=rC.prepareVisualTypes(e[t]);s[t]=i}),null==o?i.each(c):i.each([o],c)}(tB,f,r,o)})}),function(t,e,i,n,r){if(r){var o=t.getZr();o[iB]||(o.__ecBrushSelect||(o.__ecBrushSelect=oB),nm(o,eB,i,e)(t,n))}}(e,n,r,o,i)}function oB(t,e){if(!t.isDisposed()){var i=t.getZr();i[iB]=!0,t.dispatchAction({type:"brushSelect",batch:e}),i[iB]=!1}}function aB(t,e,i,n){for(var r=0,o=e.length;r<o;r++){var a=e[r];if(t.brushSelector(n,i,a.selectors,a))return!0}}var sB={rect:function(t){return lB(t.range)},polygon:function(t){for(var e,i=t.range,n=0,r=i.length;n<r;n++){e=e||[[1/0,-1/0],[1/0,-1/0]];var o=i[n];o[0]<e[0][0]&&(e[0][0]=o[0]),o[0]>e[0][1]&&(e[0][1]=o[0]),o[1]<e[1][0]&&(e[1][0]=o[1]),o[1]>e[1][1]&&(e[1][1]=o[1])}return e&&lB(e)}};function lB(t){return new yn(t[0][0],t[1][0],t[0][1]-t[0][0],t[1][1]-t[1][0])}var uB=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.init=function(t,e){this.ecModel=t,this.api=e,this.model,(this._brushController=new Ok(e.getZr())).on("brush",F(this._onBrush,this)).mount()},e.prototype.render=function(t,e,i,n){this.model=t,this._updateController(t,e,i,n)},e.prototype.updateTransform=function(t,e,i,n){nB(e),this._updateController(t,e,i,n)},e.prototype.updateVisual=function(t,e,i,n){this.updateTransform(t,e,i,n)},e.prototype.updateView=function(t,e,i,n){this._updateController(t,e,i,n)},e.prototype._updateController=function(t,e,i,n){(!n||n.$from!==t.id)&&this._brushController.setPanels(t.brushTargetManager.makePanelOpts(i)).enableBrush(t.brushOption).updateCovers(t.areas.slice())},e.prototype.dispose=function(){this._brushController.dispose()},e.prototype._onBrush=function(t){var e=this.model.id,i=this.model.brushTargetManager.setOutputRanges(t.areas,this.ecModel);(!t.isEnd||t.removeOnClick)&&this.api.dispatchAction({type:"brush",brushId:e,areas:S(i),$from:e}),t.isEnd&&this.api.dispatchAction({type:"brushEnd",brushId:e,areas:S(i),$from:e})},e.type="brush",e}($f),cB=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.areas=[],i.brushOption={},i}return i(e,t),e.prototype.optionUpdated=function(t,e){var i=this.option;!e&&YR(i,t,["inBrush","outOfBrush"]);var n=i.inBrush=i.inBrush||{};i.outOfBrush=i.outOfBrush||{color:"#ddd"},n.hasOwnProperty("liftZ")||(n.liftZ=5)},e.prototype.setAreas=function(t){t&&(this.areas=z(t,function(t){return hB(this.option,t)},this))},e.prototype.setBrushOption=function(t){this.brushOption=hB(this.option,t),this.brushType=this.brushOption.brushType},e.type="brush",e.dependencies=["geo","grid","xAxis","yAxis","parallel","series"],e.defaultOption={seriesIndex:"all",brushType:"rect",brushMode:"single",transformable:!0,brushStyle:{borderWidth:1,color:"rgba(210,219,238,0.3)",borderColor:"#D2DBEE"},throttleType:"fixRate",throttleDelay:0,removeOnClick:!0,z:1e4},e}(ip);function hB(t,e){return T({brushType:t.brushType,brushMode:t.brushMode,transformable:t.transformable,brushStyle:new $c(t.brushStyle).getItemStyle(),removeOnClick:t.removeOnClick,z:t.z},e,!0)}var pB=["rect","polygon","lineX","lineY","keep","clear"],dB=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.render=function(t,e,i){var n,r,o;e.eachComponent({mainType:"brush"},function(t){n=t.brushType,r=t.brushOption.brushMode||"single",o=o||!!t.areas.length}),this._brushType=n,this._brushMode=r,L(t.get("type",!0),function(e){t.setIconStatus(e,("keep"===e?"multiple"===r:"clear"===e?o:e===n)?"emphasis":"normal")})},e.prototype.updateView=function(t,e,i){this.render(t,e,i)},e.prototype.getIcons=function(){var t=this.model,e=t.get("icon",!0),i={};return L(t.get("type",!0),function(t){e[t]&&(i[t]=e[t])}),i},e.prototype.onclick=function(t,e,i){var n=this._brushType,r=this._brushMode;"clear"===i?(e.dispatchAction({type:"axisAreaSelect",intervals:[]}),e.dispatchAction({type:"brush",command:"clear",areas:[]})):e.dispatchAction({type:"takeGlobalCursor",key:"brush",brushOption:{brushType:"keep"===i?n:n!==i&&i,brushMode:"keep"===i?"multiple"===r?"single":"multiple":r}})},e.getDefaultOption=function(t){return{show:!0,type:pB.slice(),icon:{rect:"M7.3,34.7 M0.4,10V-0.2h9.8 M89.6,10V-0.2h-9.8 M0.4,60v10.2h9.8 M89.6,60v10.2h-9.8 M12.3,22.4V10.5h13.1 M33.6,10.5h7.8 M49.1,10.5h7.8 M77.5,22.4V10.5h-13 M12.3,31.1v8.2 M77.7,31.1v8.2 M12.3,47.6v11.9h13.1 M33.6,59.5h7.6 M49.1,59.5 h7.7 M77.5,47.6v11.9h-13",polygon:"M55.2,34.9c1.7,0,3.1,1.4,3.1,3.1s-1.4,3.1-3.1,3.1 s-3.1-1.4-3.1-3.1S53.5,34.9,55.2,34.9z M50.4,51c1.7,0,3.1,1.4,3.1,3.1c0,1.7-1.4,3.1-3.1,3.1c-1.7,0-3.1-1.4-3.1-3.1 C47.3,52.4,48.7,51,50.4,51z M55.6,37.1l1.5-7.8 M60.1,13.5l1.6-8.7l-7.8,4 M59,19l-1,5.3 M24,16.1l6.4,4.9l6.4-3.3 M48.5,11.6 l-5.9,3.1 M19.1,12.8L9.7,5.1l1.1,7.7 M13.4,29.8l1,7.3l6.6,1.6 M11.6,18.4l1,6.1 M32.8,41.9 M26.6,40.4 M27.3,40.2l6.1,1.6 M49.9,52.1l-5.6-7.6l-4.9-1.2",lineX:"M15.2,30 M19.7,15.6V1.9H29 M34.8,1.9H40.4 M55.3,15.6V1.9H45.9 M19.7,44.4V58.1H29 M34.8,58.1H40.4 M55.3,44.4 V58.1H45.9 M12.5,20.3l-9.4,9.6l9.6,9.8 M3.1,29.9h16.5 M62.5,20.3l9.4,9.6L62.3,39.7 M71.9,29.9H55.4",lineY:"M38.8,7.7 M52.7,12h13.2v9 M65.9,26.6V32 M52.7,46.3h13.2v-9 M24.9,12H11.8v9 M11.8,26.6V32 M24.9,46.3H11.8v-9 M48.2,5.1l-9.3-9l-9.4,9.2 M38.9-3.9V12 M48.2,53.3l-9.3,9l-9.4-9.2 M38.9,62.3V46.4",keep:"M4,10.5V1h10.3 M20.7,1h6.1 M33,1h6.1 M55.4,10.5V1H45.2 M4,17.3v6.6 M55.6,17.3v6.6 M4,30.5V40h10.3 M20.7,40 h6.1 M33,40h6.1 M55.4,30.5V40H45.2 M21,18.9h62.9v48.6H21V18.9z",clear:"M22,14.7l30.9,31 M52.9,14.7L22,45.7 M4.7,16.8V4.2h13.1 M26,4.2h7.8 M41.6,4.2h7.8 M70.3,16.8V4.2H57.2 M4.7,25.9v8.6 M70.3,25.9v8.6 M4.7,43.2v12.6h13.1 M26,55.8h7.8 M41.6,55.8h7.8 M70.3,43.2v12.6H57.2"},title:t.getLocaleModel().get(["toolbox","brush","title"])}},e}(LO),fB=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.layoutMode={type:"box",ignoreSize:!0},i}return i(e,t),e.type="title",e.defaultOption={zlevel:0,z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:"#464646"},subtextStyle:{fontSize:12,color:"#6E7079"}},e}(ip),mB=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.render=function(t,e,i){if(this.group.removeAll(),t.get("show")){var n=this.group,r=t.getModel("textStyle"),o=t.getModel("subtextStyle"),a=t.get("textAlign"),s=et(t.get("textBaseline"),t.get("textVerticalAlign")),l=new fs({style:wc(r,{text:t.get("text"),fill:r.getTextColor()},{disableBox:!0}),z2:10}),u=l.getBoundingRect(),c=t.get("subtext"),h=new fs({style:wc(o,{text:c,fill:o.getTextColor(),y:u.height+t.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),p=t.get("link"),d=t.get("sublink"),f=t.get("triggerEvent",!0);l.silent=!p&&!f,h.silent=!d&&!f,p&&l.on("click",function(){$h(p,"_"+t.get("target"))}),d&&h.on("click",function(){$h(d,"_"+t.get("subtarget"))}),Ss(l).eventData=Ss(h).eventData=f?{componentType:"title",componentIndex:t.componentIndex}:null,n.add(l),c&&n.add(h);var m=n.getBoundingRect(),g=t.getBoxLayoutParams();g.width=m.width,g.height=m.height;var y=Xh(g,{width:i.getWidth(),height:i.getHeight()},t.get("padding"));a||("middle"===(a=t.get("left")||t.get("right"))&&(a="center"),"right"===a?y.x+=y.width:"center"===a&&(y.x+=y.width/2)),s||("center"===(s=t.get("top")||t.get("bottom"))&&(s="middle"),"bottom"===s?y.y+=y.height:"middle"===s&&(y.y+=y.height/2),s=s||"top"),n.x=y.x,n.y=y.y,n.markRedraw();var v={align:a,verticalAlign:s};l.setStyle(v),h.setStyle(v),m=n.getBoundingRect();var _=y.margin,x=t.getItemStyle(["color","opacity"]);x.fill=t.get("backgroundColor");var b=new hs({shape:{x:m.x-_[3],y:m.y-_[0],width:m.width+_[1]+_[3],height:m.height+_[0]+_[2],r:t.get("borderRadius")},style:x,subPixelOptimize:!0,silent:!0});n.add(b)}},e.type="title",e}($f),gB=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.layoutMode="box",i}return i(e,t),e.prototype.init=function(t,e,i){this.mergeDefaultAndTheme(t,i),this._initData()},e.prototype.mergeOption=function(e){t.prototype.mergeOption.apply(this,arguments),this._initData()},e.prototype.setCurrentIndex=function(t){null==t&&(t=this.option.currentIndex);var e=this._data.count();this.option.loop?t=(t%e+e)%e:(t>=e&&(t=e-1),t<0&&(t=0)),this.option.currentIndex=t},e.prototype.getCurrentIndex=function(){return this.option.currentIndex},e.prototype.isIndexMax=function(){return this.getCurrentIndex()>=this._data.count()-1},e.prototype.setPlayState=function(t){this.option.autoPlay=!!t},e.prototype.getPlayState=function(){return!!this.option.autoPlay},e.prototype._initData=function(){var t,e=this.option,i=e.data||[],n=e.axisType,r=this._names=[];"category"===n?(t=[],L(i,function(e,i){var n,o=Dr(Mr(e),"");j(e)?(n=S(e)).value=i:n=i,t.push(n),r.push(o)})):t=i;var o={category:"ordinal",time:"time",value:"number"}[n]||"number";(this._data=new u_([{name:"value",type:o}],this)).initData(t,r)},e.prototype.getData=function(){return this._data},e.prototype.getCategories=function(){if("category"===this.get("axisType"))return this._names.slice()},e.type="timeline",e.defaultOption={zlevel:0,z:4,show:!0,axisType:"time",realtime:!0,left:"20%",top:null,right:"20%",bottom:0,width:null,height:40,padding:5,controlPosition:"left",autoPlay:!1,rewind:!1,loop:!0,playInterval:2e3,currentIndex:0,itemStyle:{},label:{color:"#000"},data:[]},e}(ip),yB=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.type="timeline.slider",e.defaultOption=jc(gB.defaultOption,{backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,orient:"horizontal",inverse:!1,tooltip:{trigger:"item"},symbol:"circle",symbolSize:12,lineStyle:{show:!0,width:2,color:"#DAE1F5"},label:{position:"auto",show:!0,interval:"auto",rotate:0,color:"#A4B1D7"},itemStyle:{color:"#A4B1D7",borderWidth:1},checkpointStyle:{symbol:"circle",symbolSize:15,color:"#316bf3",borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0, 0, 0, 0.3)",animation:!0,animationDuration:300,animationEasing:"quinticInOut"},controlStyle:{show:!0,showPlayBtn:!0,showPrevBtn:!0,showNextBtn:!0,itemSize:24,itemGap:12,position:"left",playIcon:"path://M31.6,53C17.5,53,6,41.5,6,27.4S17.5,1.8,31.6,1.8C45.7,1.8,57.2,13.3,57.2,27.4S45.7,53,31.6,53z M31.6,3.3 C18.4,3.3,7.5,14.1,7.5,27.4c0,13.3,10.8,24.1,24.1,24.1C44.9,51.5,55.7,40.7,55.7,27.4C55.7,14.1,44.9,3.3,31.6,3.3z M24.9,21.3 c0-2.2,1.6-3.1,3.5-2l10.5,6.1c1.899,1.1,1.899,2.9,0,4l-10.5,6.1c-1.9,1.1-3.5,0.2-3.5-2V21.3z",stopIcon:"path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z",nextIcon:"M2,18.5A1.52,1.52,0,0,1,.92,18a1.49,1.49,0,0,1,0-2.12L7.81,9.36,1,3.11A1.5,1.5,0,1,1,3,.89l8,7.34a1.48,1.48,0,0,1,.49,1.09,1.51,1.51,0,0,1-.46,1.1L3,18.08A1.5,1.5,0,0,1,2,18.5Z",prevIcon:"M10,.5A1.52,1.52,0,0,1,11.08,1a1.49,1.49,0,0,1,0,2.12L4.19,9.64,11,15.89a1.5,1.5,0,1,1-2,2.22L1,10.77A1.48,1.48,0,0,1,.5,9.68,1.51,1.51,0,0,1,1,8.58L9,.92A1.5,1.5,0,0,1,10,.5Z",prevBtnSize:18,nextBtnSize:18,color:"#A4B1D7",borderColor:"#A4B1D7",borderWidth:1},emphasis:{label:{show:!0,color:"#6f778d"},itemStyle:{color:"#316BF3"},controlStyle:{color:"#316BF3",borderColor:"#316BF3",borderWidth:2}},progress:{lineStyle:{color:"#316BF3"},itemStyle:{color:"#316BF3"},label:{color:"#6f778d"}},data:[]}),e}(gB);E(yB,Bd.prototype);var vB=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.type="timeline",e}($f),_B=function(t){function e(e,i,n,r){var o=t.call(this,e,i,n)||this;return o.type=r||"value",o}return i(e,t),e.prototype.getLabelModel=function(){return this.model.getModel("label")},e.prototype.isHorizontal=function(){return"horizontal"===this.model.get("orient")},e}($x),xB=Math.PI,bB=zr(),wB=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.init=function(t,e){this.api=e},e.prototype.render=function(t,e,i){if(this.model=t,this.api=i,this.ecModel=e,this.group.removeAll(),t.get("show",!0)){var n=this._layout(t,i),r=this._createGroup("_mainGroup"),o=this._createGroup("_labelGroup"),a=this._axis=this._createAxis(n,t);t.formatTooltip=function(t){return wf("nameValue",{noName:!0,value:a.scale.getLabel({value:t})})},L(["AxisLine","AxisTick","Control","CurrentPointer"],function(e){this["_render"+e](n,r,a,t)},this),this._renderAxisLabel(n,o,a,t),this._position(n,t)}this._doPlayStop(),this._updateTicksStatus()},e.prototype.remove=function(){this._clearTimer(),this.group.removeAll()},e.prototype.dispose=function(){this._clearTimer()},e.prototype._layout=function(t,e){var i,n,r,o,a=t.get(["label","position"]),s=t.get("orient"),l=function(t,e){return Xh(t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()},t.get("padding"))}(t,e),u={horizontal:"center",vertical:(i=null==a||"auto"===a?"horizontal"===s?l.y+l.height/2<e.getHeight()/2?"-":"+":l.x+l.width/2<e.getWidth()/2?"+":"-":$(a)?{horizontal:{top:"-",bottom:"+"},vertical:{left:"-",right:"+"}}[s][a]:a)>=0||"+"===i?"left":"right"},c={horizontal:i>=0||"+"===i?"top":"bottom",vertical:"middle"},h={horizontal:0,vertical:xB/2},p="vertical"===s?l.height:l.width,d=t.getModel("controlStyle"),f=d.get("show",!0),m=f?d.get("itemSize"):0,g=f?d.get("itemGap"):0,y=m+g,v=t.get(["label","rotate"])||0;v=v*xB/180;var _=d.get("position",!0),x=f&&d.get("showPlayBtn",!0),b=f&&d.get("showPrevBtn",!0),w=f&&d.get("showNextBtn",!0),S=0,T=p;"left"===_||"bottom"===_?(x&&(n=[0,0],S+=y),b&&(r=[S,0],S+=y),w&&(o=[T-m,0],T-=y)):(x&&(n=[T-m,0],T-=y),b&&(r=[0,0],S+=y),w&&(o=[T-m,0],T-=y));var M=[S,T];return t.get("inverse")&&M.reverse(),{viewRect:l,mainLength:p,orient:s,rotation:h[s],labelRotation:v,labelPosOpt:i,labelAlign:t.get(["label","align"])||u[s],labelBaseline:t.get(["label","verticalAlign"])||t.get(["label","baseline"])||c[s],playPosition:n,prevBtnPosition:r,nextBtnPosition:o,axisExtent:M,controlSize:m,controlGap:g}},e.prototype._position=function(t,e){var i=this._mainGroup,n=this._labelGroup,r=t.viewRect;if("vertical"===t.orient){var o=[1,0,0,1,0,0],a=r.x,s=r.y+r.height;Wi(o,o,[-a,-s]),Hi(o,o,-xB/2),Wi(o,o,[a,s]),(r=r.clone()).applyTransform(o)}var l=g(r),u=g(i.getBoundingRect()),c=g(n.getBoundingRect()),h=[i.x,i.y],p=[n.x,n.y];p[0]=h[0]=l[0][0];var d,f=t.labelPosOpt;function m(t){t.originX=l[0][0]-t.x,t.originY=l[1][0]-t.y}function g(t){return[[t.x,t.x+t.width],[t.y,t.y+t.height]]}function y(t,e,i,n,r){t[n]+=i[n][r]-e[n][r]}null==f||$(f)?(y(h,u,l,1,d="+"===f?0:1),y(p,c,l,1,1-d)):(y(h,u,l,1,d=f>=0?0:1),p[1]=h[1]+f),i.setPosition(h),n.setPosition(p),i.rotation=n.rotation=t.rotation,m(i),m(n)},e.prototype._createAxis=function(t,e){var i=e.getData(),n=e.get("axisType"),r=function(t,e){if(e=e||t.get("type"))switch(e){case"category":return new D_({ordinalMeta:t.getCategories(),extent:[1/0,-1/0]});case"time":return new j_({locale:t.ecModel.getLocaleModel(),useUTC:t.ecModel.get("useUTC")});default:return new P_}}(e,n);r.getTicks=function(){return i.mapArray(["value"],function(t){return{value:t}})};var o=i.getDataExtent("value");r.setExtent(o[0],o[1]),r.niceTicks();var a=new _B("value",r,t.axisExtent,n);return a.model=e,a},e.prototype._createGroup=function(t){var e=this[t]=new Fn;return this.group.add(e),e},e.prototype._renderAxisLine=function(t,e,i,n){var r=i.getExtent();if(n.get(["lineStyle","show"])){var o=new gu({shape:{x1:r[0],y1:0,x2:r[1],y2:0},style:I({lineCap:"round"},n.getModel("lineStyle").getLineStyle()),silent:!0,z2:1});e.add(o);var a=this._progressLine=new gu({shape:{x1:r[0],x2:this._currentPointer?this._currentPointer.x:r[0],y1:0,y2:0},style:C({lineCap:"round",lineWidth:o.style.lineWidth},n.getModel(["progress","lineStyle"]).getLineStyle()),silent:!0,z2:1});e.add(a)}},e.prototype._renderAxisTick=function(t,e,i,n){var r=this,o=n.getData(),a=i.scale.getTicks();this._tickSymbols=[],L(a,function(t){var a=i.dataToCoord(t.value),s=o.getItemModel(t.value),l=s.getModel("itemStyle"),u=s.getModel(["emphasis","itemStyle"]),c=s.getModel(["progress","itemStyle"]),h={x:a,y:0,onclick:F(r._changeTimeline,r,t.value)},p=SB(s,l,e,h);p.ensureState("emphasis").style=u.getItemStyle(),p.ensureState("progress").style=c.getItemStyle(),pl(p);var d=Ss(p);s.get("tooltip")?(d.dataIndex=t.value,d.dataModel=n):d.dataIndex=d.dataModel=null,r._tickSymbols.push(p)})},e.prototype._renderAxisLabel=function(t,e,i,n){var r=this;if(i.getLabelModel().get("show")){var o=n.getData(),a=i.getViewLabels();this._tickLabels=[],L(a,function(n){var a=n.tickValue,s=o.getItemModel(a),l=s.getModel("label"),u=s.getModel(["emphasis","label"]),c=s.getModel(["progress","label"]),h=i.dataToCoord(n.tickValue),p=new fs({x:h,y:0,rotation:t.labelRotation-t.rotation,onclick:F(r._changeTimeline,r,a),silent:!1,style:wc(l,{text:n.formattedLabel,align:t.labelAlign,verticalAlign:t.labelBaseline})});p.ensureState("emphasis").style=wc(u),p.ensureState("progress").style=wc(c),e.add(p),pl(p),bB(p).dataIndex=a,r._tickLabels.push(p)})}},e.prototype._renderControl=function(t,e,i,n){var r=t.controlSize,o=t.rotation,a=n.getModel("controlStyle").getItemStyle(),s=n.getModel(["emphasis","controlStyle"]).getItemStyle(),l=n.getPlayState(),u=n.get("inverse",!0);function c(t,i,l,u){if(t){var c=Cn(et(n.get(["controlStyle",i+"BtnSize"]),r),r),h=function(t,e,i,n){var r=n.style,o=hc(t.get(["controlStyle",e]),n||{},new yn(i[0],i[1],i[2],i[3]));return r&&o.setStyle(r),o}(n,i+"Icon",[0,-c/2,c,c],{x:t[0],y:t[1],originX:r/2,originY:0,rotation:u?-o:0,rectHover:!0,style:a,onclick:l});h.ensureState("emphasis").style=s,e.add(h),pl(h)}}c(t.nextBtnPosition,"next",F(this._changeTimeline,this,u?"-":"+")),c(t.prevBtnPosition,"prev",F(this._changeTimeline,this,u?"+":"-")),c(t.playPosition,l?"stop":"play",F(this._handlePlayClick,this,!l),!0)},e.prototype._renderCurrentPointer=function(t,e,i,n){var r=n.getData(),o=n.getCurrentIndex(),a=r.getItemModel(o).getModel("checkpointStyle"),s=this,l={onCreate:function(t){t.draggable=!0,t.drift=F(s._handlePointerDrag,s),t.ondragend=F(s._handlePointerDragend,s),TB(t,s._progressLine,o,i,n,!0)},onUpdate:function(t){TB(t,s._progressLine,o,i,n)}};this._currentPointer=SB(a,a,this._mainGroup,{},this._currentPointer,l)},e.prototype._handlePlayClick=function(t){this._clearTimer(),this.api.dispatchAction({type:"timelinePlayChange",playState:t,from:this.uid})},e.prototype._handlePointerDrag=function(t,e,i){this._clearTimer(),this._pointerChangeTimeline([i.offsetX,i.offsetY])},e.prototype._handlePointerDragend=function(t){this._pointerChangeTimeline([t.offsetX,t.offsetY],!0)},e.prototype._pointerChangeTimeline=function(t,e){var i=this._toAxisCoord(t)[0],n=Kn(this._axis.getExtent().slice());i>n[1]&&(i=n[1]),i<n[0]&&(i=n[0]),this._currentPointer.x=i,this._currentPointer.markRedraw(),this._progressLine.shape.x2=i,this._progressLine.dirty();var r=this._findNearestTick(i),o=this.model;(e||r!==o.getCurrentIndex()&&o.get("realtime"))&&this._changeTimeline(r)},e.prototype._doPlayStop=function(){var t=this;this._clearTimer(),this.model.getPlayState()&&(this._timer=setTimeout(function(){var e=t.model;t._changeTimeline(e.getCurrentIndex()+(e.get("rewind",!0)?-1:1))},this.model.get("playInterval")))},e.prototype._toAxisCoord=function(t){return oc(t,this._mainGroup.getLocalTransform(),!0)},e.prototype._findNearestTick=function(t){var e,i=this.model.getData(),n=1/0,r=this._axis;return i.each(["value"],function(i,o){var a=r.dataToCoord(i),s=Math.abs(a-t);s<n&&(n=s,e=o)}),e},e.prototype._clearTimer=function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},e.prototype._changeTimeline=function(t){var e=this.model.getCurrentIndex();"+"===t?t=e+1:"-"===t&&(t=e-1),this.api.dispatchAction({type:"timelineChange",currentIndex:t,from:this.uid})},e.prototype._updateTicksStatus=function(){var t=this.model.getCurrentIndex(),e=this._tickSymbols,i=this._tickLabels;if(e)for(var n=0;n<e.length;n++)e&&e[n]&&e[n].toggleState("progress",n<t);if(i)for(n=0;n<i.length;n++)i&&i[n]&&i[n].toggleState("progress",bB(i[n]).dataIndex<=t)},e.type="timeline.slider",e}(vB);function SB(t,e,i,n,r,o){var a=e.get("color");r?(r.setColor(a),i.add(r),o&&o.onUpdate(r)):((r=eg(t.get("symbol"),-1,-1,2,2,a)).setStyle("strokeNoScale",!0),i.add(r),o&&o.onCreate(r));var s=e.getItemStyle(["color"]);r.setStyle(s),n=T({rectHover:!0,z2:100},n,!0);var l=ig(t.get("symbolSize"));n.scaleX=l[0]/2,n.scaleY=l[1]/2;var u=ng(t.get("symbolOffset"),l);u&&(n.x=(n.x||0)+u[0],n.y=(n.y||0)+u[1]);var c=t.get("symbolRotate");return n.rotation=(c||0)*Math.PI/180||0,r.attr(n),r.updateTransform(),r}function TB(t,e,i,n,r,o){if(!t.dragging){var a=r.getModel("checkpointStyle"),s=n.dataToCoord(r.getData().get("value",i));if(o||!a.get("animation",!0))t.attr({x:s,y:0}),e&&e.attr({shape:{x2:s}});else{var l={duration:a.get("animationDuration",!0),easing:a.get("animationEasing",!0)};t.stopAnimation(null,!0),t.animateTo({x:s,y:0},l),e&&e.animateTo({shape:{x2:s}},l)}}}function MB(t){var e=t&&t.timeline;U(e)||(e=e?[e]:[]),L(e,function(t){t&&function(t){var e=t.type,i={number:"value",time:"time"};if(i[e]&&(t.axisType=i[e],delete t.type),IB(t),CB(t,"controlPosition")){var n=t.controlStyle||(t.controlStyle={});CB(n,"position")||(n.position=t.controlPosition),"none"!==n.position||CB(n,"show")||(n.show=!1,delete n.position),delete t.controlPosition}L(t.data||[],function(t){j(t)&&!U(t)&&(!CB(t,"value")&&CB(t,"name")&&(t.value=t.name),IB(t))})}(t)})}function IB(t){var e=t.itemStyle||(t.itemStyle={}),i=e.emphasis||(e.emphasis={}),n=t.label||t.label||{},r=n.normal||(n.normal={}),o={normal:1,emphasis:1};L(n,function(t,e){o[e]||CB(r,e)||(r[e]=t)}),i.label&&!CB(n,"emphasis")&&(n.emphasis=i.label,delete i.label)}function CB(t,e){return t.hasOwnProperty(e)}function AB(t,e){if(!t)return!1;for(var i=U(t)?t:[t],n=0;n<i.length;n++)if(i[n]&&i[n][e])return!0;return!1}function kB(t){Sr(t,"label",["show"])}var DB=zr(),EB=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.createdBySelf=!1,i}return i(e,t),e.prototype.init=function(t,e,i){this.mergeDefaultAndTheme(t,i),this._mergeOption(t,i,!1,!0)},e.prototype.isAnimationEnabled=function(){if(a.node)return!1;var t=this.__hostSeries;return this.getShallow("animation")&&t&&t.isAnimationEnabled()},e.prototype.mergeOption=function(t,e){this._mergeOption(t,e,!1,!1)},e.prototype._mergeOption=function(t,e,i,n){var r=this.mainType;i||e.eachSeries(function(t){var i=t.get(this.mainType,!0),o=DB(t)[r];i&&i.data?(o?o._mergeOption(i,e,!0):(n&&kB(i),L(i.data,function(t){t instanceof Array?(kB(t[0]),kB(t[1])):kB(t)}),I(o=this.createMarkerModelFromSeries(i,this,e),{mainType:this.mainType,seriesIndex:t.seriesIndex,name:t.name,createdBySelf:!0}),o.__hostSeries=t),DB(t)[r]=o):DB(t)[r]=null},this)},e.prototype.formatTooltip=function(t,e,i){var n=this.getData(),r=this.getRawValue(t),o=n.getName(t);return wf("section",{header:this.name,blocks:[wf("nameValue",{name:o,value:r,noName:!o,noValue:null==r})]})},e.prototype.getData=function(){return this._data},e.prototype.setData=function(t){this._data=t},e.getMarkerModelFromSeries=function(t,e){return DB(t)[e]},e.type="marker",e.dependencies=["series","grid","polar","geo"],e}(ip);E(EB,Bd.prototype);var PB=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.createMarkerModelFromSeries=function(t,i,n){return new e(t,i,n)},e.type="markPoint",e.defaultOption={zlevel:0,z:5,symbol:"pin",symbolSize:50,tooltip:{trigger:"item"},label:{show:!0,position:"inside"},itemStyle:{borderWidth:2},emphasis:{label:{show:!0}}},e}(EB);function LB(t,e,i,n,r,o){var a=[],s=g_(e,n)?e.getCalculationInfo("stackResultDimension"):n,l=FB(e,s,t),u=e.indicesOfNearest(s,l)[0];a[r]=e.get(i,u),a[o]=e.get(s,u);var c=e.get(n,u),h=Jn(e.get(n,u));return(h=Math.min(h,20))>=0&&(a[o]=+a[o].toFixed(h)),[a,c]}var zB={min:V(LB,"min"),max:V(LB,"max"),average:V(LB,"average"),median:V(LB,"median")};function OB(t,e){var i=t.getData(),n=t.coordinateSystem;if(e&&!function(t){return!isNaN(parseFloat(t.x))&&!isNaN(parseFloat(t.y))}(e)&&!U(e.coord)&&n){var r=n.dimensions,o=RB(e,i,n,t);if((e=S(e)).type&&zB[e.type]&&o.baseAxis&&o.valueAxis){var a=k(r,o.baseAxis.dim),s=k(r,o.valueAxis.dim),l=zB[e.type](i,o.baseDataDim,o.valueDataDim,a,s);e.coord=l[0],e.value=l[1]}else{for(var u=[null!=e.xAxis?e.xAxis:e.radiusAxis,null!=e.yAxis?e.yAxis:e.angleAxis],c=0;c<2;c++)zB[u[c]]&&(u[c]=FB(i,i.mapDimension(r[c]),u[c]));e.coord=u}}return e}function RB(t,e,i,n){var r={};return null!=t.valueIndex||null!=t.valueDim?(r.valueDataDim=null!=t.valueIndex?e.getDimension(t.valueIndex):t.valueDim,r.valueAxis=i.getAxis(function(t,e){var i=t.getData().getDimensionInfo(e);return i&&i.coordDim}(n,r.valueDataDim)),r.baseAxis=i.getOtherAxis(r.valueAxis),r.baseDataDim=e.mapDimension(r.baseAxis.dim)):(r.baseAxis=n.getBaseAxis(),r.valueAxis=i.getOtherAxis(r.baseAxis),r.baseDataDim=e.mapDimension(r.baseAxis.dim),r.valueDataDim=e.mapDimension(r.valueAxis.dim)),r}function BB(t,e){return!(t&&t.containData&&e.coord&&!function(t){return!(isNaN(parseFloat(t.x))&&isNaN(parseFloat(t.y)))}(e))||t.containData(e.coord)}function NB(t,e){return t?function(t,i,n,r){return Gd(r<2?t.coord&&t.coord[r]:t.value,e[r])}:function(t,i,n,r){return Gd(t.value,e[r])}}function FB(t,e,i){if("average"===i){var n=0,r=0;return t.each(e,function(t,e){isNaN(t)||(n+=t,r++)}),n/r}return"median"===i?t.getMedian(e):t.getDataExtent(e)["max"===i?1:0]}var VB=zr(),UB=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.init=function(){this.markerGroupMap=ht()},e.prototype.render=function(t,e,i){var n=this,r=this.markerGroupMap;r.each(function(t){VB(t).keep=!1}),e.eachSeries(function(t){var r=EB.getMarkerModelFromSeries(t,n.type);r&&n.renderSeries(t,r,e,i)}),r.each(function(t){!VB(t).keep&&n.group.remove(t.group)})},e.prototype.markKeep=function(t){VB(t).keep=!0},e.prototype.blurSeries=function(t){var e=this;L(t,function(t){var i=EB.getMarkerModelFromSeries(t,e.type);i&&i.getData().eachItemGraphicEl(function(t){t&&el(t)})})},e.type="marker",e}($f);function GB(t,e,i){var n=e.coordinateSystem;t.each(function(r){var o,a=t.getItemModel(r),s=Xn(a.get("x"),i.getWidth()),l=Xn(a.get("y"),i.getHeight());if(isNaN(s)||isNaN(l)){if(e.getMarkerPosition)o=e.getMarkerPosition(t.getValues(t.dimensions,r));else if(n){var u=t.get(n.dimensions[0],r),c=t.get(n.dimensions[1],r);o=n.dataToPoint([u,c])}}else o=[s,l];isNaN(s)||(o[0]=s),isNaN(l)||(o[1]=l),t.setItemLayout(r,o)})}var $B=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.updateTransform=function(t,e,i){e.eachSeries(function(t){var e=EB.getMarkerModelFromSeries(t,"markPoint");e&&(GB(e.getData(),t,i),this.markerGroupMap.get(t.id).updateLayout())},this)},e.prototype.renderSeries=function(t,e,i,n){var r=t.coordinateSystem,o=t.id,a=t.getData(),s=this.markerGroupMap,l=s.get(o)||s.set(o,new Rw),u=function(t,e,i){var n;n=t?z(t&&t.dimensions,function(t){return I(I({},e.getData().getDimensionInfo(e.getData().mapDimension(t))||{}),{name:t,ordinalMeta:null})}):[{name:"value",type:"float"}];var r=new u_(n,i),o=z(i.get("data"),V(OB,e));t&&(o=R(o,V(BB,t)));var a=NB(!!t,n);return r.initData(o,null,a),r}(r,t,e);e.setData(u),GB(e.getData(),t,n),u.each(function(t){var i=u.getItemModel(t),n=i.getShallow("symbol"),r=i.getShallow("symbolSize"),o=i.getShallow("symbolRotate"),s=i.getShallow("symbolOffset"),l=i.getShallow("symbolKeepAspect");if(G(n)||G(r)||G(o)||G(s)){var c=e.getRawValue(t),h=e.getDataParams(t);G(n)&&(n=n(c,h)),G(r)&&(r=r(c,h)),G(o)&&(o=o(c,h)),G(s)&&(s=s(c,h))}var p=i.getModel("itemStyle").getItemStyle(),d=Fm(a,"color");p.fill||(p.fill=d),u.setItemVisual(t,{symbol:n,symbolSize:r,symbolRotate:o,symbolOffset:s,symbolKeepAspect:l,style:p})}),l.updateData(u),this.group.add(l.group),u.eachItemGraphicEl(function(t){t.traverse(function(t){Ss(t).dataModel=e})}),this.markKeep(l),l.group.silent=e.get("silent")||t.get("silent")},e.type="markPoint",e}(UB),WB=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.createMarkerModelFromSeries=function(t,i,n){return new e(t,i,n)},e.type="markLine",e.defaultOption={zlevel:0,z:5,symbol:["circle","arrow"],symbolSize:[8,16],symbolOffset:0,precision:2,tooltip:{trigger:"item"},label:{show:!0,position:"end",distance:5},lineStyle:{type:"dashed"},emphasis:{label:{show:!0},lineStyle:{width:3}},animationEasing:"linear"},e}(EB),HB=zr(),jB=function(t,e,i,n){var r,o=t.getData();if(U(n))r=n;else{var a=n.type;if("min"===a||"max"===a||"average"===a||"median"===a||null!=n.xAxis||null!=n.yAxis){var s=void 0,l=void 0;if(null!=n.yAxis||null!=n.xAxis)s=e.getAxis(null!=n.yAxis?"y":"x"),l=tt(n.yAxis,n.xAxis);else{var u=RB(n,o,e,t);s=u.valueAxis,l=FB(o,y_(o,u.valueDataDim),a)}var c="x"===s.dim?0:1,h=1-c,p=S(n),d={coord:[]};p.type=null,p.coord=[],p.coord[h]=-1/0,d.coord[h]=1/0;var f=i.get("precision");f>=0&&"number"==typeof l&&(l=+l.toFixed(Math.min(f,20))),p.coord[c]=d.coord[c]=l,r=[p,d,{type:a,valueIndex:n.valueIndex,value:l}]}else r=[]}var m=[OB(t,r[0]),OB(t,r[1]),I({},r[2])];return m[2].type=m[2].type||null,T(m[2],m[0]),T(m[2],m[1]),m};function ZB(t){return!isNaN(t)&&!isFinite(t)}function qB(t,e,i,n){var r=1-t,o=n.dimensions[t];return ZB(e[r])&&ZB(i[r])&&e[t]===i[t]&&n.getAxis(o).containData(e[t])}function XB(t,e){if("cartesian2d"===t.type){var i=e[0].coord,n=e[1].coord;if(i&&n&&(qB(1,i,n,t)||qB(0,i,n,t)))return!0}return BB(t,e[0])&&BB(t,e[1])}function YB(t,e,i,n,r){var o,a=n.coordinateSystem,s=t.getItemModel(e),l=Xn(s.get("x"),r.getWidth()),u=Xn(s.get("y"),r.getHeight());if(isNaN(l)||isNaN(u)){if(n.getMarkerPosition)o=n.getMarkerPosition(t.getValues(t.dimensions,e));else{var c=a.dimensions,h=t.get(c[0],e),p=t.get(c[1],e);o=a.dataToPoint([h,p])}if(Qw(a,"cartesian2d")){var d=a.getAxis("x"),f=a.getAxis("y");c=a.dimensions,ZB(t.get(c[0],e))?o[0]=d.toGlobalCoord(d.getExtent()[i?0:1]):ZB(t.get(c[1],e))&&(o[1]=f.toGlobalCoord(f.getExtent()[i?0:1]))}isNaN(l)||(o[0]=l),isNaN(u)||(o[1]=u)}else o=[l,u];t.setItemLayout(e,o)}var KB=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.updateTransform=function(t,e,i){e.eachSeries(function(t){var e=EB.getMarkerModelFromSeries(t,"markLine");if(e){var n=e.getData(),r=HB(e).from,o=HB(e).to;r.each(function(e){YB(r,e,!0,t,i),YB(o,e,!1,t,i)}),n.each(function(t){n.setItemLayout(t,[r.getItemLayout(t),o.getItemLayout(t)])}),this.markerGroupMap.get(t.id).updateLayout()}},this)},e.prototype.renderSeries=function(t,e,i,n){var r=t.coordinateSystem,o=t.id,a=t.getData(),s=this.markerGroupMap,l=s.get(o)||s.set(o,new gA);this.group.add(l.group);var u=function(t,e,i){var n;n=t?z(t&&t.dimensions,function(t){return I(I({},e.getData().getDimensionInfo(e.getData().mapDimension(t))||{}),{name:t,ordinalMeta:null})}):[{name:"value",type:"float"}];var r=new u_(n,i),o=new u_(n,i),a=new u_([],i),s=z(i.get("data"),V(jB,e,t,i));t&&(s=R(s,V(XB,t)));var l=NB(!!t,n);return r.initData(z(s,function(t){return t[0]}),null,l),o.initData(z(s,function(t){return t[1]}),null,l),a.initData(z(s,function(t){return t[2]})),a.hasItemOption=!0,{from:r,to:o,line:a}}(r,t,e),c=u.from,h=u.to,p=u.line;HB(e).from=c,HB(e).to=h,e.setData(p);var d=e.get("symbol"),f=e.get("symbolSize"),m=e.get("symbolRotate"),g=e.get("symbolOffset");function y(e,i,r){var o=e.getItemModel(i);YB(e,i,r,t,n);var s=o.getModel("itemStyle").getItemStyle();null==s.fill&&(s.fill=Fm(a,"color")),e.setItemVisual(i,{symbolKeepAspect:o.get("symbolKeepAspect"),symbolOffset:et(o.get("symbolOffset",!0),g[r?0:1]),symbolRotate:et(o.get("symbolRotate",!0),m[r?0:1]),symbolSize:et(o.get("symbolSize"),f[r?0:1]),symbol:et(o.get("symbol",!0),d[r?0:1]),style:s})}U(d)||(d=[d,d]),U(f)||(f=[f,f]),U(m)||(m=[m,m]),U(g)||(g=[g,g]),u.from.each(function(t){y(c,t,!0),y(h,t,!1)}),p.each(function(t){var e=p.getItemModel(t).getModel("lineStyle").getLineStyle();p.setItemLayout(t,[c.getItemLayout(t),h.getItemLayout(t)]),null==e.stroke&&(e.stroke=c.getItemVisual(t,"style").fill),p.setItemVisual(t,{fromSymbolKeepAspect:c.getItemVisual(t,"symbolKeepAspect"),fromSymbolOffset:c.getItemVisual(t,"symbolOffset"),fromSymbolRotate:c.getItemVisual(t,"symbolRotate"),fromSymbolSize:c.getItemVisual(t,"symbolSize"),fromSymbol:c.getItemVisual(t,"symbol"),toSymbolKeepAspect:h.getItemVisual(t,"symbolKeepAspect"),toSymbolOffset:h.getItemVisual(t,"symbolOffset"),toSymbolRotate:h.getItemVisual(t,"symbolRotate"),toSymbolSize:h.getItemVisual(t,"symbolSize"),toSymbol:h.getItemVisual(t,"symbol"),style:e})}),l.updateData(p),u.line.eachItemGraphicEl(function(t,i){t.traverse(function(t){Ss(t).dataModel=e})}),this.markKeep(l),l.group.silent=e.get("silent")||t.get("silent")},e.type="markLine",e}(UB),JB=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.createMarkerModelFromSeries=function(t,i,n){return new e(t,i,n)},e.type="markArea",e.defaultOption={zlevel:0,z:1,tooltip:{trigger:"item"},animation:!1,label:{show:!0,position:"top"},itemStyle:{borderWidth:0},emphasis:{label:{show:!0,position:"top"}}},e}(EB),QB=zr(),tN=function(t,e,i,n){var r=OB(t,n[0]),o=OB(t,n[1]),a=r.coord,s=o.coord;a[0]=tt(a[0],-1/0),a[1]=tt(a[1],-1/0),s[0]=tt(s[0],1/0),s[1]=tt(s[1],1/0);var l=M([{},r,o]);return l.coord=[r.coord,o.coord],l.x0=r.x,l.y0=r.y,l.x1=o.x,l.y1=o.y,l};function eN(t){return!isNaN(t)&&!isFinite(t)}function iN(t,e,i,n){var r=1-t;return eN(e[r])&&eN(i[r])}function nN(t,e){var i=e.coord[0],n=e.coord[1];return!!(Qw(t,"cartesian2d")&&i&&n&&(iN(1,i,n)||iN(0,i,n)))||BB(t,{coord:i,x:e.x0,y:e.y0})||BB(t,{coord:n,x:e.x1,y:e.y1})}function rN(t,e,i,n,r){var o,a=n.coordinateSystem,s=t.getItemModel(e),l=Xn(s.get(i[0]),r.getWidth()),u=Xn(s.get(i[1]),r.getHeight());if(isNaN(l)||isNaN(u)){if(n.getMarkerPosition)o=n.getMarkerPosition(t.getValues(i,e));else{var c=[d=t.get(i[0],e),f=t.get(i[1],e)];a.clampData&&a.clampData(c,c),o=a.dataToPoint(c,!0)}if(Qw(a,"cartesian2d")){var h=a.getAxis("x"),p=a.getAxis("y"),d=t.get(i[0],e),f=t.get(i[1],e);eN(d)?o[0]=h.toGlobalCoord(h.getExtent()["x0"===i[0]?0:1]):eN(f)&&(o[1]=p.toGlobalCoord(p.getExtent()["y0"===i[1]?0:1]))}isNaN(l)||(o[0]=l),isNaN(u)||(o[1]=u)}else o=[l,u];return o}var oN=[["x0","y0"],["x1","y0"],["x1","y1"],["x0","y1"]],aN=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.updateTransform=function(t,e,i){e.eachSeries(function(t){var e=EB.getMarkerModelFromSeries(t,"markArea");if(e){var n=e.getData();n.each(function(e){var r=z(oN,function(r){return rN(n,e,r,t,i)});n.setItemLayout(e,r),n.getItemGraphicEl(e).setShape("points",r)})}},this)},e.prototype.renderSeries=function(t,e,i,n){var r=t.coordinateSystem,o=t.id,a=t.getData(),s=this.markerGroupMap,l=s.get(o)||s.set(o,{group:new Fn});this.group.add(l.group),this.markKeep(l);var u=function(t,e,i){var n,r,o=["x0","y0","x1","y1"];if(t){var a=z(t&&t.dimensions,function(t){var i=e.getData();return I(I({},i.getDimensionInfo(i.mapDimension(t))||{}),{name:t,ordinalMeta:null})});r=z(o,function(t,e){return{name:t,type:a[e%2].type}}),n=new u_(r,i)}else n=new u_(r=[{name:"value",type:"float"}],i);var s=z(i.get("data"),V(tN,e,t,i));t&&(s=R(s,V(nN,t)));var l=t?function(t,e,i,n){return Gd(t.coord[Math.floor(n/2)][n%2],r[n])}:function(t,e,i,n){return Gd(t.value,r[n])};return n.initData(s,null,l),n.hasItemOption=!0,n}(r,t,e);e.setData(u),u.each(function(e){var i=z(oN,function(i){return rN(u,e,i,t,n)}),o=r.getAxis("x").scale,s=r.getAxis("y").scale,l=o.getExtent(),c=s.getExtent(),h=[o.parse(u.get("x0",e)),o.parse(u.get("x1",e))],p=[s.parse(u.get("y0",e)),s.parse(u.get("y1",e))];Kn(h),Kn(p);var d=!!(l[0]>h[1]||l[1]<h[0]||c[0]>p[1]||c[1]<p[0]);u.setItemLayout(e,{points:i,allClipped:d});var f=u.getItemModel(e).getModel("itemStyle").getItemStyle(),m=Fm(a,"color");f.fill||(f.fill=m,"string"==typeof f.fill&&(f.fill=Je(f.fill,.4))),f.stroke||(f.stroke=m),u.setItemVisual(e,"style",f)}),u.diff(QB(l).data).add(function(t){var e=u.getItemLayout(t);if(!e.allClipped){var i=new hu({shape:{points:e.points}});u.setItemGraphicEl(t,i),l.group.add(i)}}).update(function(t,i){var n=QB(l).data.getItemGraphicEl(i),r=u.getItemLayout(t);r.allClipped?n&&l.group.remove(n):(n?Bu(n,{shape:{points:r.points}},e,t):n=new hu({shape:{points:r.points}}),u.setItemGraphicEl(t,n),l.group.add(n))}).remove(function(t){var e=QB(l).data.getItemGraphicEl(t);l.group.remove(e)}).execute(),u.eachItemGraphicEl(function(t,i){var n=u.getItemModel(i),r=u.getItemVisual(i,"style");t.useStyle(u.getItemVisual(i,"style")),xc(t,bc(n),{labelFetcher:e,labelDataIndex:i,defaultText:u.getName(i)||"",inheritColor:"string"==typeof r.fill?Je(r.fill,1):"#000"}),gl(t,n),pl(t),Ss(t).dataModel=e}),QB(l).data=u,l.group.silent=e.get("silent")||t.get("silent")},e.type="markArea",e}(UB),sN=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.layoutMode={type:"box",ignoreSize:!0},i}return i(e,t),e.prototype.init=function(t,e,i){this.mergeDefaultAndTheme(t,i),t.selected=t.selected||{},this._updateSelector(t)},e.prototype.mergeOption=function(e,i){t.prototype.mergeOption.call(this,e,i),this._updateSelector(e)},e.prototype._updateSelector=function(t){var e=t.selector,i=this.ecModel;!0===e&&(e=t.selector=["all","inverse"]),U(e)&&L(e,function(t,n){$(t)&&(t={type:t}),e[n]=T(t,function(t,e){return"all"===e?{type:"all",title:t.getLocaleModel().get(["legend","selector","all"])}:"inverse"===e?{type:"inverse",title:t.getLocaleModel().get(["legend","selector","inverse"])}:void 0}(i,t.type))})},e.prototype.optionUpdated=function(){this._updateData(this.ecModel);var t=this._data;if(t[0]&&"single"===this.get("selectedMode")){for(var e=!1,i=0;i<t.length;i++){var n=t[i].get("name");if(this.isSelected(n)){this.select(n),e=!0;break}}!e&&this.select(t[0].get("name"))}},e.prototype._updateData=function(t){var e=[],i=[];t.eachRawSeries(function(n){var r,o=n.name;if(i.push(o),n.legendVisualProvider){var a=n.legendVisualProvider.getAllNames();t.isSeriesFiltered(n)||(i=i.concat(a)),a.length?e=e.concat(a):r=!0}else r=!0;r&&Er(n)&&e.push(n.name)}),this._availableNames=i;var n=z(this.get("data")||e,function(t){return"string"!=typeof t&&"number"!=typeof t||(t={name:t}),new $c(t,this,this.ecModel)},this);this._data=n},e.prototype.getData=function(){return this._data},e.prototype.select=function(t){var e=this.option.selected;"single"===this.get("selectedMode")&&L(this._data,function(t){e[t.get("name")]=!1}),e[t]=!0},e.prototype.unSelect=function(t){"single"!==this.get("selectedMode")&&(this.option.selected[t]=!1)},e.prototype.toggleSelected=function(t){var e=this.option.selected;e.hasOwnProperty(t)||(e[t]=!0),this[e[t]?"unSelect":"select"](t)},e.prototype.allSelect=function(){var t=this._data,e=this.option.selected;L(t,function(t){e[t.get("name",!0)]=!0})},e.prototype.inverseSelect=function(){var t=this._data,e=this.option.selected;L(t,function(t){var i=t.get("name",!0);e.hasOwnProperty(i)||(e[i]=!0),e[i]=!e[i]})},e.prototype.isSelected=function(t){var e=this.option.selected;return!(e.hasOwnProperty(t)&&!e[t])&&k(this._availableNames,t)>=0},e.prototype.getOrient=function(){return"vertical"===this.get("orient")?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},e.type="legend.plain",e.dependencies=["series"],e.defaultOption={zlevel:0,z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},e}(ip),lN=V,uN=L,cN=Fn,hN=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.newlineDisabled=!1,i}return i(e,t),e.prototype.init=function(){this.group.add(this._contentGroup=new cN),this.group.add(this._selectorGroup=new cN),this._isFirstRender=!0},e.prototype.getContentGroup=function(){return this._contentGroup},e.prototype.getSelectorGroup=function(){return this._selectorGroup},e.prototype.render=function(t,e,i){var n=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),t.get("show",!0)){var r=t.get("align"),o=t.get("orient");r&&"auto"!==r||(r="right"===t.get("left")&&"vertical"===o?"right":"left");var a=t.get("selector",!0),s=t.get("selectorPosition",!0);!a||s&&"auto"!==s||(s="horizontal"===o?"end":"start"),this.renderInner(r,t,e,i,a,o,s);var l=t.getBoxLayoutParams(),u={width:i.getWidth(),height:i.getHeight()},c=t.get("padding"),h=Xh(l,u,c),p=this.layoutInner(t,r,h,n,a,s),d=Xh(C({width:p.width,height:p.height},l),u,c);this.group.x=d.x-p.x,this.group.y=d.y-p.y,this.group.markRedraw(),this.group.add(this._backgroundEl=NO(p,t))}},e.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},e.prototype.renderInner=function(t,e,i,n,r,o,a){var s=this.getContentGroup(),l=ht(),u=e.get("selectedMode"),c=[];i.eachRawSeries(function(t){!t.get("legendHoverLink")&&c.push(t.id)}),uN(e.getData(),function(r,o){var a=r.get("name");if(!this.newlineDisabled&&(""===a||"\n"===a)){var h=new cN;return h.newline=!0,void s.add(h)}var p=i.getSeriesByName(a)[0];if(!l.get(a))if(p){var d=p.getData(),f=d.getVisual("legendLineStyle")||{},m=d.getVisual("legendIcon"),g=d.getVisual("style");this._createItem(p,a,o,r,e,t,f,g,m,u).on("click",lN(pN,a,null,n,c)).on("mouseover",lN(fN,p.name,null,n,c)).on("mouseout",lN(mN,p.name,null,n,c)),l.set(a,!0)}else i.eachRawSeries(function(i){if(!l.get(a)&&i.legendVisualProvider){var s=i.legendVisualProvider;if(!s.containName(a))return;var h=s.indexOfName(a),p=s.getItemVisual(h,"style"),d=s.getItemVisual(h,"legendIcon"),f=He(p.fill);f&&0===f[3]&&(f[3]=.2,p.fill=Qe(f,"rgba")),this._createItem(i,a,o,r,e,t,{},p,d,u).on("click",lN(pN,null,a,n,c)).on("mouseover",lN(fN,null,a,n,c)).on("mouseout",lN(mN,null,a,n,c)),l.set(a,!0)}},this)},this),r&&this._createSelector(r,e,n,o,a)},e.prototype._createSelector=function(t,e,i,n,r){var o=this.getSelectorGroup();uN(t,function(t){var n=t.type,r=new fs({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){i.dispatchAction({type:"all"===n?"legendAllSelect":"legendInverseSelect"})}});o.add(r),xc(r,{normal:e.getModel("selectorLabel"),emphasis:e.getModel(["emphasis","selectorLabel"])},{defaultText:t.title}),pl(r)})},e.prototype._createItem=function(t,e,i,n,r,o,a,s,l,u){var c=t.visualDrawType,h=r.get("itemWidth"),p=r.get("itemHeight"),d=r.isSelected(e),f=n.get("symbolRotate"),m=n.get("symbolKeepAspect"),g=n.get("icon"),y=function(t,e,i,n,r,o){function a(t,e){"auto"===t.lineWidth&&(t.lineWidth=e.lineWidth>0?2:0),uN(t,function(i,n){"inherit"===t[n]&&(t[n]=e[n])})}var s=e.getModel("itemStyle").getItemStyle(),l=0===t.lastIndexOf("empty",0)?"fill":"stroke";s.decal=n.decal,"inherit"===s.fill&&(s.fill=n[r]),"inherit"===s.stroke&&(s.stroke=n[l]),"inherit"===s.opacity&&(s.opacity=("fill"===r?n:i).opacity),a(s,n);var u=e.getModel("lineStyle"),c=u.getLineStyle();if(a(c,i),"auto"===s.fill&&(s.fill=n.fill),"auto"===s.stroke&&(s.stroke=n.fill),"auto"===c.stroke&&(c.stroke=n.fill),!o){var h=e.get("inactiveBorderWidth"),p=s[l];s.lineWidth="auto"===h?n.lineWidth>0&&p?2:0:s.lineWidth,s.fill=e.get("inactiveColor"),s.stroke=e.get("inactiveBorderColor"),c.stroke=u.get("inactiveColor"),c.lineWidth=u.get("inactiveWidth")}return{itemStyle:s,lineStyle:c}}(l=g||l||"roundRect",n,a,s,c,d),v=new cN,_=n.getModel("textStyle");if("function"!=typeof t.getLegendIcon||g&&"inherit"!==g){var x="inherit"===g&&t.getData().getVisual("symbol")?"inherit"===f?t.getData().getVisual("symbolRotate"):f:0;v.add(function(t){var e=t.icon||"roundRect",i=eg(e,0,0,t.itemWidth,t.itemHeight,t.itemStyle.fill,t.symbolKeepAspect);return i.setStyle(t.itemStyle),i.rotation=(t.iconRotate||0)*Math.PI/180,i.setOrigin([t.itemWidth/2,t.itemHeight/2]),e.indexOf("empty")>-1&&(i.style.stroke=i.style.fill,i.style.fill="#fff",i.style.lineWidth=2),i}({itemWidth:h,itemHeight:p,icon:l,iconRotate:x,itemStyle:y.itemStyle,lineStyle:y.lineStyle,symbolKeepAspect:m}))}else v.add(t.getLegendIcon({itemWidth:h,itemHeight:p,icon:l,iconRotate:f,itemStyle:y.itemStyle,lineStyle:y.lineStyle,symbolKeepAspect:m}));var b="left"===o?h+5:-5,w=o,S=r.get("formatter"),T=e;"string"==typeof S&&S?T=S.replace("{name}",null!=e?e:""):"function"==typeof S&&(T=S(e));var M=n.get("inactiveColor");v.add(new fs({style:wc(_,{text:T,x:b,y:p/2,fill:d?_.getTextColor():M,align:w,verticalAlign:"middle"})}));var I=new hs({shape:v.getBoundingRect(),invisible:!0}),C=n.getModel("tooltip");return C.get("show")&&mc({el:I,componentModel:r,itemName:e,itemTooltipOption:C.option}),v.add(I),v.eachChild(function(t){t.silent=!0}),I.silent=!u,this.getContentGroup().add(v),pl(v),v.__legendDataIndex=i,v},e.prototype.layoutInner=function(t,e,i,n,r,o){var a=this.getContentGroup(),s=this.getSelectorGroup();qh(t.get("orient"),a,t.get("itemGap"),i.width,i.height);var l=a.getBoundingRect(),u=[-l.x,-l.y];if(s.markRedraw(),a.markRedraw(),r){qh("horizontal",s,t.get("selectorItemGap",!0));var c=s.getBoundingRect(),h=[-c.x,-c.y],p=t.get("selectorButtonGap",!0),d=t.getOrient().index,f=0===d?"width":"height",m=0===d?"height":"width",g=0===d?"y":"x";"end"===o?h[d]+=l[f]+p:u[d]+=c[f]+p,h[1-d]+=l[m]/2-c[m]/2,s.x=h[0],s.y=h[1],a.x=u[0],a.y=u[1];var y={x:0,y:0};return y[f]=l[f]+p+c[f],y[m]=Math.max(l[m],c[m]),y[g]=Math.min(0,c[g]+h[1-d]),y}return a.x=u[0],a.y=u[1],this.group.getBoundingRect()},e.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},e.type="legend.plain",e}($f);function pN(t,e,i,n){mN(t,e,i,n),i.dispatchAction({type:"legendToggleSelect",name:null!=t?t:e}),fN(t,e,i,n)}function dN(t){for(var e,i=t.getZr().storage.getDisplayList(),n=0,r=i.length;n<r&&!(e=i[n].states.emphasis);)n++;return e&&e.hoverLayer}function fN(t,e,i,n){dN(i)||i.dispatchAction({type:"highlight",seriesName:t,name:e,excludeSeriesId:n})}function mN(t,e,i,n){dN(i)||i.dispatchAction({type:"downplay",seriesName:t,name:e,excludeSeriesId:n})}function gN(t){var e=t.findComponents({mainType:"legend"});e&&e.length&&t.filterSeries(function(t){for(var i=0;i<e.length;i++)if(!e[i].isSelected(t.name))return!1;return!0})}function yN(t,e,i){var n,r={},o="toggleSelected"===t;return i.eachComponent("legend",function(i){o&&null!=n?i[n?"select":"unSelect"](e.name):"allSelect"===t||"inverseSelect"===t?i[t]():(i[t](e.name),n=i.isSelected(e.name)),L(i.getData(),function(t){var e=t.get("name");if("\n"!==e&&""!==e){var n=i.isSelected(e);r.hasOwnProperty(e)?r[e]=r[e]&&n:r[e]=n}})}),"allSelect"===t||"inverseSelect"===t?{selected:r}:{name:e.name,selected:r}}function vN(t){t.registerComponentModel(sN),t.registerComponentView(hN),t.registerProcessor(t.PRIORITY.PROCESSOR.SERIES_FILTER,gN),t.registerSubTypeDefaulter("legend",function(){return"plain"}),function(t){t.registerAction("legendToggleSelect","legendselectchanged",V(yN,"toggleSelected")),t.registerAction("legendAllSelect","legendselectall",V(yN,"allSelect")),t.registerAction("legendInverseSelect","legendinverseselect",V(yN,"inverseSelect")),t.registerAction("legendSelect","legendselected",V(yN,"select")),t.registerAction("legendUnSelect","legendunselected",V(yN,"unSelect"))}(t)}var _N=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.setScrollDataIndex=function(t){this.option.scrollDataIndex=t},e.prototype.init=function(e,i,n){var r=Qh(e);t.prototype.init.call(this,e,i,n),xN(this,e,r)},e.prototype.mergeOption=function(e,i){t.prototype.mergeOption.call(this,e,i),xN(this,this.option,e)},e.type="legend.scroll",e.defaultOption=jc(sN.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),e}(sN);function xN(t,e,i){var n=[1,1];n[t.getOrient().index]=0,Jh(e,i,{type:"box",ignoreSize:!!n})}var bN=Fn,wN=["width","height"],SN=["x","y"],TN=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.newlineDisabled=!0,i._currentIndex=0,i}return i(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.group.add(this._containerGroup=new bN),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new bN)},e.prototype.resetInner=function(){t.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},e.prototype.renderInner=function(e,i,n,r,o,a,s){var l=this;t.prototype.renderInner.call(this,e,i,n,r,o,a,s);var u=this._controllerGroup,c=i.get("pageIconSize",!0),h=U(c)?c:[c,c];d("pagePrev",0);var p=i.getModel("pageTextStyle");function d(t,e){var n=t+"DataIndex",o=hc(i.get("pageIcons",!0)[i.getOrient().name][e],{onclick:F(l._pageGo,l,n,i,r)},{x:-h[0]/2,y:-h[1]/2,width:h[0],height:h[1]});o.name=t,u.add(o)}u.add(new fs({name:"pageText",style:{text:"xx/xx",fill:p.getTextColor(),font:p.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),d("pageNext",1)},e.prototype.layoutInner=function(t,e,i,n,r,o){var a=this.getSelectorGroup(),s=t.getOrient().index,l=wN[s],u=SN[s],c=wN[1-s],h=SN[1-s];r&&qh("horizontal",a,t.get("selectorItemGap",!0));var p=t.get("selectorButtonGap",!0),d=a.getBoundingRect(),f=[-d.x,-d.y],m=S(i);r&&(m[l]=i[l]-d[l]-p);var g=this._layoutContentAndController(t,n,m,s,l,c,h,u);if(r){if("end"===o)f[s]+=g[l]+p;else{var y=d[l]+p;f[s]-=y,g[u]-=y}g[l]+=d[l]+p,f[1-s]+=g[h]+g[c]/2-d[c]/2,g[c]=Math.max(g[c],d[c]),g[h]=Math.min(g[h],d[h]+f[1-s]),a.x=f[0],a.y=f[1],a.markRedraw()}return g},e.prototype._layoutContentAndController=function(t,e,i,n,r,o,a,s){var l=this.getContentGroup(),u=this._containerGroup,c=this._controllerGroup;qh(t.get("orient"),l,t.get("itemGap"),n?i.width:null,n?null:i.height),qh("horizontal",c,t.get("pageButtonItemGap",!0));var h=l.getBoundingRect(),p=c.getBoundingRect(),d=this._showController=h[r]>i[r],f=[-h.x,-h.y];e||(f[n]=l[s]);var m=[0,0],g=[-p.x,-p.y],y=et(t.get("pageButtonGap",!0),t.get("itemGap",!0));d&&("end"===t.get("pageButtonPosition",!0)?g[n]+=i[r]-p[r]:m[n]+=p[r]+y),g[1-n]+=h[o]/2-p[o]/2,l.setPosition(f),u.setPosition(m),c.setPosition(g);var v={x:0,y:0};if(v[r]=d?i[r]:h[r],v[o]=Math.max(h[o],p[o]),v[a]=Math.min(0,p[a]+g[1-n]),u.__rectSize=i[r],d){var _={x:0,y:0};_[r]=Math.max(i[r]-p[r]-y,0),_[o]=v[o],u.setClipPath(new hs({shape:_})),u.__rectSize=_[r]}else c.eachChild(function(t){t.attr({invisible:!0,silent:!0})});var x=this._getPageInfo(t);return null!=x.pageIndex&&Bu(l,{x:x.contentPosition[0],y:x.contentPosition[1]},d?t:null),this._updatePageInfoView(t,x),v},e.prototype._pageGo=function(t,e,i){var n=this._getPageInfo(e)[t];null!=n&&i.dispatchAction({type:"legendScroll",scrollDataIndex:n,legendId:e.id})},e.prototype._updatePageInfoView=function(t,e){var i=this._controllerGroup;L(["pagePrev","pageNext"],function(n){var r=null!=e[n+"DataIndex"],o=i.childOfName(n);o&&(o.setStyle("fill",r?t.get("pageIconColor",!0):t.get("pageIconInactiveColor",!0)),o.cursor=r?"pointer":"default")});var n=i.childOfName("pageText"),r=t.get("pageFormatter"),o=e.pageIndex,a=null!=o?o+1:0,s=e.pageCount;n&&r&&n.setStyle("text",$(r)?r.replace("{current}",null==a?"":a+"").replace("{total}",null==s?"":s+""):r({current:a,total:s}))},e.prototype._getPageInfo=function(t){var e=t.get("scrollDataIndex",!0),i=this.getContentGroup(),n=this._containerGroup.__rectSize,r=t.getOrient().index,o=wN[r],a=SN[r],s=this._findTargetItemIndex(e),l=i.children(),u=l[s],c=l.length,h=c?1:0,p={contentPosition:[i.x,i.y],pageCount:h,pageIndex:h-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!u)return p;var d=v(u);p.contentPosition[r]=-d.s;for(var f=s+1,m=d,g=d,y=null;f<=c;++f)(!(y=v(l[f]))&&g.e>m.s+n||y&&!_(y,m.s))&&(m=g.i>m.i?g:y)&&(null==p.pageNextDataIndex&&(p.pageNextDataIndex=m.i),++p.pageCount),g=y;for(f=s-1,m=d,g=d,y=null;f>=-1;--f)(y=v(l[f]))&&_(g,y.s)||!(m.i<g.i)||(g=m,null==p.pagePrevDataIndex&&(p.pagePrevDataIndex=m.i),++p.pageCount,++p.pageIndex),m=y;return p;function v(t){if(t){var e=t.getBoundingRect(),i=e[a]+t[a];return{s:i,e:i+e[o],i:t.__legendDataIndex}}}function _(t,e){return t.e>=e&&t.s<=e+n}},e.prototype._findTargetItemIndex=function(t){return this._showController?(this.getContentGroup().eachChild(function(n,r){var o=n.__legendDataIndex;null==i&&null!=o&&(i=r),o===t&&(e=r)}),null!=e?e:i):0;var e,i},e.type="legend.scroll",e}(hN);function MN(t){Rv(vN),t.registerComponentModel(_N),t.registerComponentView(TN),function(t){t.registerAction("legendScroll","legendscroll",function(t,e){var i=t.scrollDataIndex;null!=i&&e.eachComponent({mainType:"legend",subType:"scroll",query:t},function(t){t.setScrollDataIndex(i)})})}(t)}var IN=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.type="dataZoom.inside",e.defaultOption=jc(bO.defaultOption,{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),e}(bO),CN=zr();function AN(t,e,i){CN(t).coordSysRecordMap.each(function(t){var n=t.dataZoomInfoMap.get(e.uid);n&&(n.getRange=i)})}function kN(t,e){if(e){t.removeKey(e.model.uid);var i=e.controller;i&&i.dispose()}}function DN(t,e){t.dispatchAction({type:"dataZoom",animation:{easing:"cubicOut",duration:100},batch:e})}function EN(t,e,i,n){return t.coordinateSystem.containPoint([i,n])}function PN(t){t.registerProcessor(t.PRIORITY.PROCESSOR.FILTER,function(t,e){var i=CN(e),n=i.coordSysRecordMap||(i.coordSysRecordMap=ht());n.each(function(t){t.dataZoomInfoMap=null}),t.eachComponent({mainType:"dataZoom",subType:"inside"},function(t){L(_O(t).infoList,function(i){var r=i.model.uid,o=n.get(r)||n.set(r,function(t,e){var i={model:e,containsPoint:V(EN,e),dispatchAction:V(DN,t),dataZoomInfoMap:null,controller:null},n=i.controller=new vM(t.getZr());return L(["pan","zoom","scrollMove"],function(t){n.on(t,function(e){var n=[];i.dataZoomInfoMap.each(function(r){if(e.isAvailableBehavior(r.model.option)){var o=(r.getRange||{})[t],a=o&&o(r.dzReferCoordSysInfo,i.model.mainType,i.controller,e);!r.model.get("disabled",!0)&&a&&n.push({dataZoomId:r.model.id,start:a[0],end:a[1]})}}),n.length&&i.dispatchAction(n)})}),i}(e,i.model));(o.dataZoomInfoMap||(o.dataZoomInfoMap=ht())).set(t.uid,{dzReferCoordSysInfo:i,model:t,getRange:null})})}),n.each(function(t){var e,i=t.controller,r=t.dataZoomInfoMap;if(r){var o=r.keys()[0];null!=o&&(e=r.get(o))}if(e){var a=function(t){var e,i="type_",n={type_true:2,type_move:1,type_false:0,type_undefined:-1},r=!0;return t.each(function(t){var o=t.model,a=!o.get("disabled",!0)&&(!o.get("zoomLock",!0)||"move");n[i+a]>n[i+e]&&(e=a),r=r&&o.get("preventDefaultMouseMove",!0)}),{controlType:e,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!r}}}(r);i.enable(a.controlType,a.opt),i.setPointerChecker(t.containsPoint),nm(t,"dispatchAction",e.model.get("throttle",!0),"fixRate")}else kN(n,t)})})}var LN=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="dataZoom.inside",e}return i(e,t),e.prototype.render=function(e,i,n){t.prototype.render.apply(this,arguments),e.noTarget()?this._clear():(this.range=e.getPercentRange(),AN(n,e,{pan:F(zN.pan,this),zoom:F(zN.zoom,this),scrollMove:F(zN.scrollMove,this)}))},e.prototype.dispose=function(){this._clear(),t.prototype.dispose.apply(this,arguments)},e.prototype._clear=function(){!function(t,e){for(var i=CN(t).coordSysRecordMap,n=i.keys(),r=0;r<n.length;r++){var o=n[r],a=i.get(o),s=a.dataZoomInfoMap;if(s){var l=e.uid;s.get(l)&&(s.removeKey(l),s.keys().length||kN(i,a))}}}(this.api,this.dataZoomModel),this.range=null},e.type="dataZoom.inside",e}(TO),zN={zoom:function(t,e,i,n){var r=this.range,o=r.slice(),a=t.axisModels[0];if(a){var s=RN[e](null,[n.originX,n.originY],a,i,t),l=(s.signal>0?s.pixelStart+s.pixelLength-s.pixel:s.pixel-s.pixelStart)/s.pixelLength*(o[1]-o[0])+o[0],u=Math.max(1/n.scale,0);o[0]=(o[0]-l)*u+l,o[1]=(o[1]-l)*u+l;var c=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();return ck(0,o,[0,100],0,c.minSpan,c.maxSpan),this.range=o,r[0]!==o[0]||r[1]!==o[1]?o:void 0}},pan:ON(function(t,e,i,n,r,o){var a=RN[n]([o.oldX,o.oldY],[o.newX,o.newY],e,r,i);return a.signal*(t[1]-t[0])*a.pixel/a.pixelLength}),scrollMove:ON(function(t,e,i,n,r,o){return RN[n]([0,0],[o.scrollDelta,o.scrollDelta],e,r,i).signal*(t[1]-t[0])*o.scrollDelta})};function ON(t){return function(e,i,n,r){var o=this.range,a=o.slice(),s=e.axisModels[0];if(s)return ck(t(a,s,e,i,n,r),a,[0,100],"all"),this.range=a,o[0]!==a[0]||o[1]!==a[1]?a:void 0}}var RN={grid:function(t,e,i,n,r){var o=i.axis,a={},s=r.model.coordinateSystem.getRect();return t=t||[0,0],"x"===o.dim?(a.pixel=e[0]-t[0],a.pixelLength=s.width,a.pixelStart=s.x,a.signal=o.inverse?1:-1):(a.pixel=e[1]-t[1],a.pixelLength=s.height,a.pixelStart=s.y,a.signal=o.inverse?-1:1),a},polar:function(t,e,i,n,r){var o=i.axis,a={},s=r.model.coordinateSystem,l=s.getRadiusAxis().getExtent(),u=s.getAngleAxis().getExtent();return t=t?s.pointToCoord(t):[0,0],e=s.pointToCoord(e),"radiusAxis"===i.mainType?(a.pixel=e[0]-t[0],a.pixelLength=l[1]-l[0],a.pixelStart=l[0],a.signal=o.inverse?1:-1):(a.pixel=e[1]-t[1],a.pixelLength=u[1]-u[0],a.pixelStart=u[0],a.signal=o.inverse?-1:1),a},singleAxis:function(t,e,i,n,r){var o=i.axis,a=r.model.coordinateSystem.getRect(),s={};return t=t||[0,0],"horizontal"===o.orient?(s.pixel=e[0]-t[0],s.pixelLength=a.width,s.pixelStart=a.x,s.signal=o.inverse?1:-1):(s.pixel=e[1]-t[1],s.pixelLength=a.height,s.pixelStart=a.y,s.signal=o.inverse?-1:1),s}};function BN(t){EO(t),t.registerComponentModel(IN),t.registerComponentView(LN),PN(t)}var NN=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.type="dataZoom.slider",e.layoutMode="box",e.defaultOption=jc(bO.defaultOption,{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,borderColor:"#d2dbee",borderRadius:3,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#d2dbee",width:.5},areaStyle:{color:"#d2dbee",opacity:.2}},selectedDataBackground:{lineStyle:{color:"#8fb0f7",width:.5},areaStyle:{color:"#8fb0f7",opacity:.2}},fillerColor:"rgba(135,175,274,0.2)",handleIcon:"path://M-9.35,34.56V42m0-40V9.5m-2,0h4a2,2,0,0,1,2,2v21a2,2,0,0,1-2,2h-4a2,2,0,0,1-2-2v-21A2,2,0,0,1-11.35,9.5Z",handleSize:"100%",handleStyle:{color:"#fff",borderColor:"#ACB8D1"},moveHandleSize:7,moveHandleIcon:"path://M-320.9-50L-320.9-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-348-41-339-50-320.9-50z M-212.3-50L-212.3-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-239.4-41-230.4-50-212.3-50z M-103.7-50L-103.7-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-130.9-41-121.8-50-103.7-50z",moveHandleStyle:{color:"#D2DBEE",opacity:.7},showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#6E7079"},brushSelect:!0,brushStyle:{color:"rgba(135,175,274,0.15)"},emphasis:{handleStyle:{borderColor:"#8FB0F7"},moveHandleStyle:{color:"#8FB0F7"}}}),e}(bO),FN=hs,VN="horizontal",UN="vertical",GN=["line","bar","candlestick","scatter"],$N={easing:"cubicOut",duration:100,delay:0},WN=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._displayables={},i}return i(e,t),e.prototype.init=function(t,e){this.api=e,this._onBrush=F(this._onBrush,this),this._onBrushEnd=F(this._onBrushEnd,this)},e.prototype.render=function(e,i,n,r){if(t.prototype.render.apply(this,arguments),nm(this,"_dispatchZoomAction",e.get("throttle"),"fixRate"),this._orient=e.getOrient(),!1!==e.get("show")){if(e.noTarget())return this._clear(),void this.group.removeAll();r&&"dataZoom"===r.type&&r.from===this.uid||this._buildView(),this._updateView()}else this.group.removeAll()},e.prototype.dispose=function(){this._clear(),t.prototype.dispose.apply(this,arguments)},e.prototype._clear=function(){var t,e,i;(i=(t=this)[e="_dispatchZoomAction"])&&i[Qf]&&(t[e]=i[Qf]);var n=this.api.getZr();n.off("mousemove",this._onBrush),n.off("mouseup",this._onBrushEnd)},e.prototype._buildView=function(){var t=this.group;t.removeAll(),this._brushing=!1,this._displayables.brushRect=null,this._resetLocation(),this._resetInterval();var e=this._displayables.sliderGroup=new Fn;this._renderBackground(),this._renderHandle(),this._renderDataShadow(),t.add(e),this._positionGroup()},e.prototype._resetLocation=function(){var t=this.dataZoomModel,e=this.api,i=t.get("brushSelect")?7:0,n=this._findCoordRect(),r={width:e.getWidth(),height:e.getHeight()},o=this._orient===VN?{right:r.width-n.x-n.width,top:r.height-30-7-i,width:n.width,height:30}:{right:7,top:n.y,width:30,height:n.height},a=Qh(t.option);L(["right","top","width","height"],function(t){"ph"===a[t]&&(a[t]=o[t])});var s=Xh(a,r);this._location={x:s.x,y:s.y},this._size=[s.width,s.height],this._orient===UN&&this._size.reverse()},e.prototype._positionGroup=function(){var t=this.group,e=this._location,i=this._orient,n=this.dataZoomModel.getFirstTargetAxisModel(),r=n&&n.get("inverse"),o=this._displayables.sliderGroup,a=(this._dataShadowInfo||{}).otherAxisInverse;o.attr(i!==VN||r?i===VN&&r?{scaleY:a?1:-1,scaleX:-1}:i!==UN||r?{scaleY:a?-1:1,scaleX:-1,rotation:Math.PI/2}:{scaleY:a?-1:1,scaleX:1,rotation:Math.PI/2}:{scaleY:a?1:-1,scaleX:1});var s=t.getBoundingRect([o]);t.x=e.x-s.x,t.y=e.y-s.y,t.markRedraw()},e.prototype._getViewExtent=function(){return[0,this._size[0]]},e.prototype._renderBackground=function(){var t=this.dataZoomModel,e=this._size,i=this._displayables.sliderGroup,n=t.get("brushSelect");i.add(new FN({silent:!0,shape:{x:0,y:0,width:e[0],height:e[1]},style:{fill:t.get("backgroundColor")},z2:-40}));var r=new FN({shape:{x:0,y:0,width:e[0],height:e[1]},style:{fill:"transparent"},z2:0,onclick:F(this._onClickPanel,this)}),o=this.api.getZr();n?(r.on("mousedown",this._onBrushStart,this),r.cursor="crosshair",o.on("mousemove",this._onBrush),o.on("mouseup",this._onBrushEnd)):(o.off("mousemove",this._onBrush),o.off("mouseup",this._onBrushEnd)),i.add(r)},e.prototype._renderDataShadow=function(){var t=this._dataShadowInfo=this._prepareDataShadowInfo();if(this._displayables.dataShadowSegs=[],t){var e=this._size,i=t.series,n=i.getRawData(),r=i.getShadowDim?i.getShadowDim():t.otherDim;if(null!=r){var o=n.getDataExtent(r),a=.3*(o[1]-o[0]);o=[o[0]-a,o[1]+a];var s,l=[0,e[1]],u=[0,e[0]],c=[[e[0],0],[0,0]],h=[],p=u[1]/(n.count()-1),d=0,f=Math.round(n.count()/e[0]);n.each([r],function(t,e){if(f>0&&e%f)d+=p;else{var i=null==t||isNaN(t)||""===t,n=i?0:qn(t,o,l,!0);i&&!s&&e?(c.push([c[c.length-1][0],0]),h.push([h[h.length-1][0],0])):!i&&s&&(c.push([d,0]),h.push([d,0])),c.push([d,n]),h.push([d,n]),d+=p,s=i}});for(var m=this.dataZoomModel,g=0;g<3;g++){var y=v(1===g);this._displayables.sliderGroup.add(y),this._displayables.dataShadowSegs.push(y)}}}function v(t){var e=m.getModel(t?"selectedDataBackground":"dataBackground"),i=new Fn,n=new hu({shape:{points:c},segmentIgnoreThreshold:1,style:e.getModel("areaStyle").getAreaStyle(),silent:!0,z2:-20}),r=new du({shape:{points:h},segmentIgnoreThreshold:1,style:e.getModel("lineStyle").getLineStyle(),silent:!0,z2:-19});return i.add(n),i.add(r),i}},e.prototype._prepareDataShadowInfo=function(){var t=this.dataZoomModel,e=t.get("showDataShadow");if(!1!==e){var i,n=this.ecModel;return t.eachTargetAxis(function(r,o){L(t.getAxisProxy(r,o).getTargetSeriesModels(),function(t){if(!(i||!0!==e&&k(GN,t.get("type"))<0)){var a,s=n.getComponent(yO(r),o).axis,l={x:"y",y:"x",radius:"angle",angle:"radius"}[r],u=t.coordinateSystem;null!=l&&u.getOtherAxis&&(a=u.getOtherAxis(s).inverse),l=t.getData().mapDimension(l),i={thisAxis:s,series:t,thisDim:r,otherDim:l,otherAxisInverse:a}}},this)},this),i}},e.prototype._renderHandle=function(){var t=this.group,e=this._displayables,i=e.handles=[null,null],n=e.handleLabels=[null,null],r=this._displayables.sliderGroup,o=this._size,a=this.dataZoomModel,s=this.api,l=a.get("borderRadius")||0,u=a.get("brushSelect"),c=e.filler=new FN({silent:u,style:{fill:a.get("fillerColor")},textConfig:{position:"inside"}});r.add(c),r.add(new FN({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:o[0],height:o[1],r:l},style:{stroke:a.get("dataBackgroundColor")||a.get("borderColor"),lineWidth:1,fill:"rgba(0,0,0,0)"}})),L([0,1],function(e){var o=a.get("handleIcon");!Jm[o]&&o.indexOf("path://")<0&&o.indexOf("image://")<0&&(o="path://"+o);var s=eg(o,-1,0,2,2,null,!0);s.attr({cursor:HN(this._orient),draggable:!0,drift:F(this._onDragMove,this,e),ondragend:F(this._onDragEnd,this),onmouseover:F(this._showDataInfo,this,!0),onmouseout:F(this._showDataInfo,this,!1),z2:5});var l=s.getBoundingRect(),u=a.get("handleSize");this._handleHeight=Xn(u,this._size[1]),this._handleWidth=l.width/l.height*this._handleHeight,s.setStyle(a.getModel("handleStyle").getItemStyle()),s.style.strokeNoScale=!0,s.rectHover=!0,s.ensureState("emphasis").style=a.getModel(["emphasis","handleStyle"]).getItemStyle(),pl(s);var c=a.get("handleColor");null!=c&&(s.style.fill=c),r.add(i[e]=s);var h=a.getModel("textStyle");t.add(n[e]=new fs({silent:!0,invisible:!0,style:wc(h,{x:0,y:0,text:"",verticalAlign:"middle",align:"center",fill:h.getTextColor(),font:h.getFont()}),z2:10}))},this);var h=c;if(u){var p=Xn(a.get("moveHandleSize"),o[1]),d=e.moveHandle=new hs({style:a.getModel("moveHandleStyle").getItemStyle(),silent:!0,shape:{r:[0,0,2,2],y:o[1]-.5,height:p}}),f=.8*p,m=e.moveHandleIcon=eg(a.get("moveHandleIcon"),-f/2,-f/2,f,f,"#fff",!0);m.silent=!0,m.y=o[1]+p/2-.5,d.ensureState("emphasis").style=a.getModel(["emphasis","moveHandleStyle"]).getItemStyle();var g=Math.min(o[1]/2,Math.max(p,10));(h=e.moveZone=new hs({invisible:!0,shape:{y:o[1]-g,height:p+g}})).on("mouseover",function(){s.enterEmphasis(d)}).on("mouseout",function(){s.leaveEmphasis(d)}),r.add(d),r.add(m),r.add(h)}h.attr({draggable:!0,cursor:HN(this._orient),drift:F(this._onDragMove,this,"all"),ondragstart:F(this._showDataInfo,this,!0),ondragend:F(this._onDragEnd,this),onmouseover:F(this._showDataInfo,this,!0),onmouseout:F(this._showDataInfo,this,!1)})},e.prototype._resetInterval=function(){var t=this._range=this.dataZoomModel.getPercentRange(),e=this._getViewExtent();this._handleEnds=[qn(t[0],[0,100],e,!0),qn(t[1],[0,100],e,!0)]},e.prototype._updateInterval=function(t,e){var i=this.dataZoomModel,n=this._handleEnds,r=this._getViewExtent(),o=i.findRepresentativeAxisProxy().getMinMaxSpan(),a=[0,100];ck(e,n,r,i.get("zoomLock")?"all":t,null!=o.minSpan?qn(o.minSpan,a,r,!0):null,null!=o.maxSpan?qn(o.maxSpan,a,r,!0):null);var s=this._range,l=this._range=Kn([qn(n[0],r,a,!0),qn(n[1],r,a,!0)]);return!s||s[0]!==l[0]||s[1]!==l[1]},e.prototype._updateView=function(t){var e=this._displayables,i=this._handleEnds,n=Kn(i.slice()),r=this._size;L([0,1],function(t){var n=e.handles[t],o=this._handleHeight;n.attr({scaleX:o/2,scaleY:o/2,x:i[t]+(t?-1:1),y:r[1]/2-o/2})},this),e.filler.setShape({x:n[0],y:0,width:n[1]-n[0],height:r[1]});var o={x:n[0],width:n[1]-n[0]};e.moveHandle&&(e.moveHandle.setShape(o),e.moveZone.setShape(o),e.moveZone.getBoundingRect(),e.moveHandleIcon&&e.moveHandleIcon.attr("x",o.x+o.width/2));for(var a=e.dataShadowSegs,s=[0,n[0],n[1],r[0]],l=0;l<a.length;l++){var u=a[l],c=u.getClipPath();c||(c=new hs,u.setClipPath(c)),c.setShape({x:s[l],y:0,width:s[l+1]-s[l],height:r[1]})}this._updateDataInfo(t)},e.prototype._updateDataInfo=function(t){var e=this.dataZoomModel,i=this._displayables,n=i.handleLabels,r=this._orient,o=["",""];if(e.get("showDetail")){var a=e.findRepresentativeAxisProxy();if(a){var s=a.getAxisModel().axis,l=this._range,u=t?a.calculateDataWindow({start:l[0],end:l[1]}).valueWindow:a.getDataValueWindow();o=[this._formatLabel(u[0],s),this._formatLabel(u[1],s)]}}var c=Kn(this._handleEnds.slice());function h(t){var e=rc(i.handles[t].parent,this.group),a=ac(0===t?"right":"left",e),s=this._handleWidth/2+5,l=oc([c[t]+(0===t?-s:s),this._size[1]/2],e);n[t].setStyle({x:l[0],y:l[1],verticalAlign:r===VN?"middle":a,align:r===VN?a:"center",text:o[t]})}h.call(this,0),h.call(this,1)},e.prototype._formatLabel=function(t,e){var i=this.dataZoomModel,n=i.get("labelFormatter"),r=i.get("labelPrecision");null!=r&&"auto"!==r||(r=e.getPixelPrecision());var o=null==t||isNaN(t)?"":"category"===e.type||"time"===e.type?e.scale.getLabel({value:Math.round(t)}):t.toFixed(Math.min(r,20));return G(n)?n(t,o):$(n)?n.replace("{value}",o):o},e.prototype._showDataInfo=function(t){t=this._dragging||t;var e=this._displayables,i=e.handleLabels;i[0].attr("invisible",!t),i[1].attr("invisible",!t),e.moveHandle&&this.api[t?"enterEmphasis":"leaveEmphasis"](e.moveHandle,1)},e.prototype._onDragMove=function(t,e,i,n){this._dragging=!0,ie(n.event);var r=oc([e,i],this._displayables.sliderGroup.getLocalTransform(),!0),o=this._updateInterval(t,r[0]),a=this.dataZoomModel.get("realtime");this._updateView(!a),o&&a&&this._dispatchZoomAction(!0)},e.prototype._onDragEnd=function(){this._dragging=!1,this._showDataInfo(!1),!this.dataZoomModel.get("realtime")&&this._dispatchZoomAction(!1)},e.prototype._onClickPanel=function(t){var e=this._size,i=this._displayables.sliderGroup.transformCoordToLocal(t.offsetX,t.offsetY);if(!(i[0]<0||i[0]>e[0]||i[1]<0||i[1]>e[1])){var n=this._handleEnds,r=(n[0]+n[1])/2,o=this._updateInterval("all",i[0]-r);this._updateView(),o&&this._dispatchZoomAction(!1)}},e.prototype._onBrushStart=function(t){var e=t.offsetX,i=t.offsetY;this._brushStart=new ln(e,i),this._brushing=!0,this._brushStartTime=+new Date},e.prototype._onBrushEnd=function(t){if(this._brushing){var e=this._displayables.brushRect;if(this._brushing=!1,e){e.attr("ignore",!0);var i=e.shape;if(!(+new Date-this._brushStartTime<200&&Math.abs(i.width)<5)){var n=this._getViewExtent(),r=[0,100];this._range=Kn([qn(i.x,n,r,!0),qn(i.x+i.width,n,r,!0)]),this._handleEnds=[i.x,i.x+i.width],this._updateView(),this._dispatchZoomAction(!1)}}}},e.prototype._onBrush=function(t){this._brushing&&(ie(t.event),this._updateBrushRect(t.offsetX,t.offsetY))},e.prototype._updateBrushRect=function(t,e){var i=this._displayables,n=this.dataZoomModel,r=i.brushRect;r||(r=i.brushRect=new FN({silent:!0,style:n.getModel("brushStyle").getItemStyle()}),i.sliderGroup.add(r)),r.attr("ignore",!1);var o=this._brushStart,a=this._displayables.sliderGroup,s=a.transformCoordToLocal(t,e),l=a.transformCoordToLocal(o.x,o.y),u=this._size;s[0]=Math.max(Math.min(u[0],s[0]),0),r.setShape({x:l[0],y:0,width:s[0]-l[0],height:u[1]})},e.prototype._dispatchZoomAction=function(t){var e=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,animation:t?$N:null,start:e[0],end:e[1]})},e.prototype._findCoordRect=function(){var t,e=_O(this.dataZoomModel).infoList;if(!t&&e.length){var i=e[0].model.coordinateSystem;t=i.getRect&&i.getRect()}if(!t){var n=this.api.getWidth(),r=this.api.getHeight();t={x:.2*n,y:.2*r,width:.6*n,height:.6*r}}return t},e.type="dataZoom.slider",e}(TO);function HN(t){return"vertical"===t?"ns-resize":"ew-resize"}function jN(t){t.registerComponentModel(NN),t.registerComponentView(WN),EO(t)}var ZN=function(t,e,i){var n=S((qN[t]||{})[e]);return i&&U(n)?n[n.length-1]:n},qN={color:{active:["#006edd","#e0ffff"],inactive:["rgba(0,0,0,0)"]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}},XN=rC.mapVisual,YN=rC.eachVisual,KN=U,JN=L,QN=Kn,tF=qn,eF=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.stateList=["inRange","outOfRange"],i.replacableOptionKeys=["inRange","outOfRange","target","controller","color"],i.layoutMode={type:"box",ignoreSize:!0},i.dataBound=[-1/0,1/0],i.targetVisuals={},i.controllerVisuals={},i}return i(e,t),e.prototype.init=function(t,e,i){this.mergeDefaultAndTheme(t,i)},e.prototype.optionUpdated=function(t,e){var i=this.option;a.canvasSupported||(i.realtime=!1),!e&&YR(i,t,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption()},e.prototype.resetVisual=function(t){var e=this.stateList;t=F(t,this),this.controllerVisuals=XR(this.option.controller,e,t),this.targetVisuals=XR(this.option.target,e,t)},e.prototype.getItemSymbol=function(){return null},e.prototype.getTargetSeriesIndices=function(){var t=this.option.seriesIndex,e=[];return null==t||"all"===t?this.ecModel.eachSeries(function(t,i){e.push(i)}):e=wr(t),e},e.prototype.eachTargetSeries=function(t,e){L(this.getTargetSeriesIndices(),function(i){var n=this.ecModel.getSeriesByIndex(i);n&&t.call(e,n)},this)},e.prototype.isTargetSeries=function(t){var e=!1;return this.eachTargetSeries(function(i){i===t&&(e=!0)}),e},e.prototype.formatValueText=function(t,e,i){var n,r=this.option,o=r.precision,a=this.dataBound,s=r.formatter;i=i||["<",">"],U(t)&&(t=t.slice(),n=!0);var l=e?t:n?[u(t[0]),u(t[1])]:u(t);return $(s)?s.replace("{value}",n?l[0]:l).replace("{value2}",n?l[1]:l):G(s)?n?s(t[0],t[1]):s(t):n?t[0]===a[0]?i[0]+" "+l[1]:t[1]===a[1]?i[1]+" "+l[0]:l[0]+" - "+l[1]:l;function u(t){return t===a[0]?"min":t===a[1]?"max":(+t).toFixed(Math.min(o,20))}},e.prototype.resetExtent=function(){var t=this.option,e=QN([t.min,t.max]);this._dataExtent=e},e.prototype.getDataDimensionIndex=function(t){var e=this.option.dimension;if(null!=e)return t.getDimensionIndex(e);for(var i=t.dimensions,n=i.length-1;n>=0;n--){var r=i[n],o=t.getDimensionInfo(r);if(!o.isCalculationCoord)return o.storeDimIndex}},e.prototype.getExtent=function(){return this._dataExtent.slice()},e.prototype.completeVisualOption=function(){var t=this.ecModel,e=this.option,i={inRange:e.inRange,outOfRange:e.outOfRange},n=e.target||(e.target={}),r=e.controller||(e.controller={});T(n,i),T(r,i);var o=this.isCategory();function a(i){KN(e.color)&&!i.inRange&&(i.inRange={color:e.color.slice().reverse()}),i.inRange=i.inRange||{color:t.get("gradientColor")}}a(n),a(r),function(t,e,i){var n=t[e],r=t[i];n&&!r&&(r=t[i]={},JN(n,function(t,e){if(rC.isValidType(e)){var i=ZN(e,"inactive",o);null!=i&&(r[e]=i,"color"!==e||r.hasOwnProperty("opacity")||r.hasOwnProperty("colorAlpha")||(r.opacity=[0,0]))}}))}(n,"inRange","outOfRange"),function(t){var e=(t.inRange||{}).symbol||(t.outOfRange||{}).symbol,i=(t.inRange||{}).symbolSize||(t.outOfRange||{}).symbolSize,n=this.get("inactiveColor"),r=this.getItemSymbol()||"roundRect";JN(this.stateList,function(a){var s=this.itemSize,l=t[a];l||(l=t[a]={color:o?n:[n]}),null==l.symbol&&(l.symbol=e&&S(e)||(o?r:[r])),null==l.symbolSize&&(l.symbolSize=i&&S(i)||(o?s[0]:[s[0],s[0]])),l.symbol=XN(l.symbol,function(t){return"none"===t?r:t});var u=l.symbolSize;if(null!=u){var c=-1/0;YN(u,function(t){t>c&&(c=t)}),l.symbolSize=XN(u,function(t){return tF(t,[0,c],[0,s[0]],!0)})}},this)}.call(this,r)},e.prototype.resetItemSize=function(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))]},e.prototype.isCategory=function(){return!!this.option.categories},e.prototype.setSelected=function(t){},e.prototype.getSelected=function(){return null},e.prototype.getValueState=function(t){return null},e.prototype.getVisualMeta=function(t){return null},e.type="visualMap",e.dependencies=["series"],e.defaultOption={show:!0,zlevel:0,z:4,seriesIndex:"all",min:0,max:200,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",contentColor:"#5793f3",inactiveColor:"#aaa",borderWidth:0,padding:5,textGap:10,precision:0,textStyle:{color:"#333"}},e}(ip),iF=[20,140],nF=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.optionUpdated=function(e,i){t.prototype.optionUpdated.apply(this,arguments),this.resetExtent(),this.resetVisual(function(t){t.mappingMethod="linear",t.dataExtent=this.getExtent()}),this._resetRange()},e.prototype.resetItemSize=function(){t.prototype.resetItemSize.apply(this,arguments);var e=this.itemSize;(null==e[0]||isNaN(e[0]))&&(e[0]=20),(null==e[1]||isNaN(e[1]))&&(e[1]=140)},e.prototype._resetRange=function(){var t=this.getExtent(),e=this.option.range;!e||e.auto?(t.auto=1,this.option.range=t):U(e)&&(e[0]>e[1]&&e.reverse(),e[0]=Math.max(e[0],t[0]),e[1]=Math.min(e[1],t[1]))},e.prototype.completeVisualOption=function(){t.prototype.completeVisualOption.apply(this,arguments),L(this.stateList,function(t){var e=this.option.controller[t].symbolSize;e&&e[0]!==e[1]&&(e[0]=e[1]/3)},this)},e.prototype.setSelected=function(t){this.option.range=t.slice(),this._resetRange()},e.prototype.getSelected=function(){var t=this.getExtent(),e=Kn((this.get("range")||[]).slice());return e[0]>t[1]&&(e[0]=t[1]),e[1]>t[1]&&(e[1]=t[1]),e[0]<t[0]&&(e[0]=t[0]),e[1]<t[0]&&(e[1]=t[0]),e},e.prototype.getValueState=function(t){var e=this.option.range,i=this.getExtent();return(e[0]<=i[0]||e[0]<=t)&&(e[1]>=i[1]||t<=e[1])?"inRange":"outOfRange"},e.prototype.findTargetDataIndices=function(t){var e=[];return this.eachTargetSeries(function(i){var n=[],r=i.getData();r.each(this.getDataDimensionIndex(r),function(e,i){t[0]<=e&&e<=t[1]&&n.push(i)},this),e.push({seriesId:i.id,dataIndex:n})},this),e},e.prototype.getVisualMeta=function(t){var e=rF(this,"outOfRange",this.getExtent()),i=rF(this,"inRange",this.option.range.slice()),n=[];function r(e,i){n.push({value:e,color:t(e,i)})}for(var o=0,a=0,s=i.length,l=e.length;a<l&&(!i.length||e[a]<=i[0]);a++)e[a]<i[o]&&r(e[a],"outOfRange");for(var u=1;o<s;o++,u=0)u&&n.length&&r(i[o],"outOfRange"),r(i[o],"inRange");for(u=1;a<l;a++)(!i.length||i[i.length-1]<e[a])&&(u&&(n.length&&r(n[n.length-1].value,"outOfRange"),u=0),r(e[a],"outOfRange"));var c=n.length;return{stops:n,outerColors:[c?n[0].color:"transparent",c?n[c-1].color:"transparent"]}},e.type="visualMap.continuous",e.defaultOption=jc(eF.defaultOption,{align:"auto",calculable:!1,hoverLink:!0,realtime:!0,handleIcon:"path://M-11.39,9.77h0a3.5,3.5,0,0,1-3.5,3.5h-22a3.5,3.5,0,0,1-3.5-3.5h0a3.5,3.5,0,0,1,3.5-3.5h22A3.5,3.5,0,0,1-11.39,9.77Z",handleSize:"120%",handleStyle:{borderColor:"#fff",borderWidth:1},indicatorIcon:"circle",indicatorSize:"50%",indicatorStyle:{borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0,0,0,0.2)"}}),e}(eF);function rF(t,e,i){if(i[0]===i[1])return i.slice();for(var n=(i[1]-i[0])/200,r=i[0],o=[],a=0;a<=200&&r<i[1];a++)o.push(r),r+=n;return o.push(i[1]),o}var oF=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i.autoPositionValues={left:1,right:1,top:1,bottom:1},i}return i(e,t),e.prototype.init=function(t,e){this.ecModel=t,this.api=e},e.prototype.render=function(t,e,i,n){this.visualMapModel=t,!1!==t.get("show")?this.doRender(t,e,i,n):this.group.removeAll()},e.prototype.renderBackground=function(t){var e=this.visualMapModel,i=Lh(e.get("padding")||0),n=t.getBoundingRect();t.add(new hs({z2:-1,silent:!0,shape:{x:n.x-i[3],y:n.y-i[0],width:n.width+i[3]+i[1],height:n.height+i[0]+i[2]},style:{fill:e.get("backgroundColor"),stroke:e.get("borderColor"),lineWidth:e.get("borderWidth")}}))},e.prototype.getControllerVisual=function(t,e,i){var n=(i=i||{}).forceState,r=this.visualMapModel,o={};if("color"===e){var a=r.get("contentColor");o.color=a}function s(t){return o[t]}function l(t,e){o[t]=e}var u=r.controllerVisuals[n||r.getValueState(t)];return L(rC.prepareVisualTypes(u),function(n){var r=u[n];i.convertOpacityToAlpha&&"opacity"===n&&(n="colorAlpha",r=u.__alphaForOpacity),rC.dependsOn(n,e)&&r&&r.applyVisual(t,s,l)}),o[e]},e.prototype.positionGroup=function(t){var e=this.visualMapModel,i=this.api;Yh(t,e.getBoxLayoutParams(),{width:i.getWidth(),height:i.getHeight()})},e.prototype.doRender=function(t,e,i,n){},e.type="visualMap",e}($f),aF=[["left","right","width"],["top","bottom","height"]];function sF(t,e,i){var n=t.option,r=n.align;if(null!=r&&"auto"!==r)return r;for(var o={width:e.getWidth(),height:e.getHeight()},a="horizontal"===n.orient?1:0,s=aF[a],l=[0,null,10],u={},c=0;c<3;c++)u[aF[1-a][c]]=l[c],u[s[c]]=2===c?i[0]:n[s[c]];var h=[["x","width",3],["y","height",0]][a],p=Xh(u,o,n.padding);return s[(p.margin[h[2]]||0)+p[h[0]]+.5*p[h[1]]<.5*o[h[1]]?0:1]}function lF(t,e){return L(t||[],function(t){null!=t.dataIndex&&(t.dataIndexInside=t.dataIndex,t.dataIndex=null),t.highlightKey="visualMap"+(e?e.componentIndex:"")}),t}var uF=qn,cF=L,hF=Math.min,pF=Math.max,dF=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._shapes={},i._dataInterval=[],i._handleEnds=[],i._hoverLinkDataIndices=[],i}return i(e,t),e.prototype.doRender=function(t,e,i,n){this._api=i,n&&"selectDataRange"===n.type&&n.from===this.uid||this._buildView()},e.prototype._buildView=function(){this.group.removeAll();var t=this.visualMapModel,e=this.group;this._orient=t.get("orient"),this._useHandle=t.get("calculable"),this._resetInterval(),this._renderBar(e);var i=t.get("text");this._renderEndsText(e,i,0),this._renderEndsText(e,i,1),this._updateView(!0),this.renderBackground(e),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(e)},e.prototype._renderEndsText=function(t,e,i){if(e){var n=e[1-i];n=null!=n?n+"":"";var r=this.visualMapModel,o=r.get("textGap"),a=r.itemSize,s=this._shapes.mainGroup,l=this._applyTransform([a[0]/2,0===i?-o:a[1]+o],s),u=this._applyTransform(0===i?"bottom":"top",s),c=this._orient,h=this.visualMapModel.textStyleModel;this.group.add(new fs({style:{x:l[0],y:l[1],verticalAlign:"horizontal"===c?"middle":u,align:"horizontal"===c?u:"center",text:n,font:h.getFont(),fill:h.getTextColor()}}))}},e.prototype._renderBar=function(t){var e=this.visualMapModel,i=this._shapes,n=e.itemSize,r=this._orient,o=this._useHandle,a=sF(e,this.api,n),s=i.mainGroup=this._createBarGroup(a),l=new Fn;s.add(l),l.add(i.outOfRange=fF()),l.add(i.inRange=fF(null,o?gF(this._orient):null,F(this._dragHandle,this,"all",!1),F(this._dragHandle,this,"all",!0))),l.setClipPath(new hs({shape:{x:0,y:0,width:n[0],height:n[1],r:3}}));var u=e.textStyleModel.getTextRect("国"),c=pF(u.width,u.height);o&&(i.handleThumbs=[],i.handleLabels=[],i.handleLabelPoints=[],this._createHandle(e,s,0,n,c,r),this._createHandle(e,s,1,n,c,r)),this._createIndicator(e,s,n,c,r),t.add(s)},e.prototype._createHandle=function(t,e,i,n,r,o){var a=F(this._dragHandle,this,i,!1),s=F(this._dragHandle,this,i,!0),l=Cn(t.get("handleSize"),n[0]),u=eg(t.get("handleIcon"),-l/2,-l/2,l,l,null,!0),c=gF(this._orient);u.attr({cursor:c,draggable:!0,drift:a,ondragend:s,onmousemove:function(t){ie(t.event)}}),u.x=n[0]/2,u.useStyle(t.getModel("handleStyle").getItemStyle()),u.setStyle({strokeNoScale:!0,strokeFirst:!0}),u.style.lineWidth*=2,u.ensureState("emphasis").style=t.getModel(["emphasis","handleStyle"]).getItemStyle(),yl(u,!0),e.add(u);var h=this.visualMapModel.textStyleModel,p=new fs({cursor:c,draggable:!0,drift:a,onmousemove:function(t){ie(t.event)},ondragend:s,style:{x:0,y:0,text:"",font:h.getFont(),fill:h.getTextColor()}});p.ensureState("blur").style={opacity:.1},p.stateTransition={duration:200},this.group.add(p);var d=[l,0],f=this._shapes;f.handleThumbs[i]=u,f.handleLabelPoints[i]=d,f.handleLabels[i]=p},e.prototype._createIndicator=function(t,e,i,n,r){var o=Cn(t.get("indicatorSize"),i[0]),a=eg(t.get("indicatorIcon"),-o/2,-o/2,o,o,null,!0);a.attr({cursor:"move",invisible:!0,silent:!0,x:i[0]/2});var s=t.getModel("indicatorStyle").getItemStyle();if(a instanceof rs){var l=a.style;a.useStyle(I({image:l.image,x:l.x,y:l.y,width:l.width,height:l.height},s))}else a.useStyle(s);e.add(a);var u=this.visualMapModel.textStyleModel,c=new fs({silent:!0,invisible:!0,style:{x:0,y:0,text:"",font:u.getFont(),fill:u.getTextColor()}});this.group.add(c);var h=[("horizontal"===r?n/2:6)+i[0]/2,0],p=this._shapes;p.indicator=a,p.indicatorLabel=c,p.indicatorLabelPoint=h,this._firstShowIndicator=!0},e.prototype._dragHandle=function(t,e,i,n){if(this._useHandle){if(this._dragging=!e,!e){var r=this._applyTransform([i,n],this._shapes.mainGroup,!0);this._updateInterval(t,r[1]),this._hideIndicator(),this._updateView()}e===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),e?!this._hovering&&this._clearHoverLinkToSeries():mF(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[t],!1)}},e.prototype._resetInterval=function(){var t=this.visualMapModel,e=this._dataInterval=t.getSelected(),i=t.getExtent(),n=[0,t.itemSize[1]];this._handleEnds=[uF(e[0],i,n,!0),uF(e[1],i,n,!0)]},e.prototype._updateInterval=function(t,e){e=e||0;var i=this.visualMapModel,n=this._handleEnds,r=[0,i.itemSize[1]];ck(e,n,r,t,0);var o=i.getExtent();this._dataInterval=[uF(n[0],r,o,!0),uF(n[1],r,o,!0)]},e.prototype._updateView=function(t){var e=this.visualMapModel,i=e.getExtent(),n=this._shapes,r=[0,e.itemSize[1]],o=t?r:this._handleEnds,a=this._createBarVisual(this._dataInterval,i,o,"inRange"),s=this._createBarVisual(i,i,r,"outOfRange");n.inRange.setStyle({fill:a.barColor}).setShape("points",a.barPoints),n.outOfRange.setStyle({fill:s.barColor}).setShape("points",s.barPoints),this._updateHandle(o,a)},e.prototype._createBarVisual=function(t,e,i,n){var r={forceState:n,convertOpacityToAlpha:!0},o=this._makeColorGradient(t,r),a=[this.getControllerVisual(t[0],"symbolSize",r),this.getControllerVisual(t[1],"symbolSize",r)],s=this._createBarPoints(i,a);return{barColor:new Mu(0,0,0,1,o),barPoints:s,handlesColor:[o[0].color,o[o.length-1].color]}},e.prototype._makeColorGradient=function(t,e){var i=[],n=(t[1]-t[0])/100;i.push({color:this.getControllerVisual(t[0],"color",e),offset:0});for(var r=1;r<100;r++){var o=t[0]+n*r;if(o>t[1])break;i.push({color:this.getControllerVisual(o,"color",e),offset:r/100})}return i.push({color:this.getControllerVisual(t[1],"color",e),offset:1}),i},e.prototype._createBarPoints=function(t,e){var i=this.visualMapModel.itemSize;return[[i[0]-e[0],t[0]],[i[0],t[0]],[i[0],t[1]],[i[0]-e[1],t[1]]]},e.prototype._createBarGroup=function(t){var e=this._orient,i=this.visualMapModel.get("inverse");return new Fn("horizontal"!==e||i?"horizontal"===e&&i?{scaleX:"bottom"===t?-1:1,rotation:-Math.PI/2}:"vertical"!==e||i?{scaleX:"left"===t?1:-1}:{scaleX:"left"===t?1:-1,scaleY:-1}:{scaleX:"bottom"===t?1:-1,rotation:Math.PI/2})},e.prototype._updateHandle=function(t,e){if(this._useHandle){var i=this._shapes,n=this.visualMapModel,r=i.handleThumbs,o=i.handleLabels,a=n.itemSize,s=n.getExtent();cF([0,1],function(l){var u=r[l];u.setStyle("fill",e.handlesColor[l]),u.y=t[l];var c=uF(t[l],[0,a[1]],s,!0),h=this.getControllerVisual(c,"symbolSize");u.scaleX=u.scaleY=h/a[0],u.x=a[0]-h/2;var p=oc(i.handleLabelPoints[l],rc(u,this.group));o[l].setStyle({x:p[0],y:p[1],text:n.formatValueText(this._dataInterval[l]),verticalAlign:"middle",align:"vertical"===this._orient?this._applyTransform("left",i.mainGroup):"center"})},this)}},e.prototype._showIndicator=function(t,e,i,n){var r=this.visualMapModel,o=r.getExtent(),a=r.itemSize,s=[0,a[1]],l=this._shapes,u=l.indicator;if(u){u.attr("invisible",!1);var c=this.getControllerVisual(t,"color",{convertOpacityToAlpha:!0}),h=this.getControllerVisual(t,"symbolSize"),p=uF(t,o,s,!0),d=a[0]-h/2,f={x:u.x,y:u.y};u.y=p,u.x=d;var m=oc(l.indicatorLabelPoint,rc(u,this.group)),g=l.indicatorLabel;g.attr("invisible",!1);var y=this._applyTransform("left",l.mainGroup),v="horizontal"===this._orient;g.setStyle({text:(i||"")+r.formatValueText(e),verticalAlign:v?y:"middle",align:v?"center":y});var _={x:d,y:p,style:{fill:c}},x={style:{x:m[0],y:m[1]}};if(r.ecModel.isAnimationEnabled()&&!this._firstShowIndicator){var b={duration:100,easing:"cubicInOut",additive:!0};u.x=f.x,u.y=f.y,u.animateTo(_,b),g.animateTo(x,b)}else u.attr(_),g.attr(x);this._firstShowIndicator=!1;var w=this._shapes.handleLabels;if(w)for(var S=0;S<w.length;S++)this._api.enterBlur(w[S])}},e.prototype._enableHoverLinkToSeries=function(){var t=this;this._shapes.mainGroup.on("mousemove",function(e){if(t._hovering=!0,!t._dragging){var i=t.visualMapModel.itemSize,n=t._applyTransform([e.offsetX,e.offsetY],t._shapes.mainGroup,!0,!0);n[1]=hF(pF(0,n[1]),i[1]),t._doHoverLinkToSeries(n[1],0<=n[0]&&n[0]<=i[0])}}).on("mouseout",function(){t._hovering=!1,!t._dragging&&t._clearHoverLinkToSeries()})},e.prototype._enableHoverLinkFromSeries=function(){var t=this.api.getZr();this.visualMapModel.option.hoverLink?(t.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),t.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries()},e.prototype._doHoverLinkToSeries=function(t,e){var i=this.visualMapModel,n=i.itemSize;if(i.option.hoverLink){var r=[0,n[1]],o=i.getExtent();t=hF(pF(r[0],t),r[1]);var a=function(t,e,i){var n=6,r=t.get("hoverLinkDataSize");return r&&(n=uF(r,e,i,!0)/2),n}(i,o,r),s=[t-a,t+a],l=uF(t,r,o,!0),u=[uF(s[0],r,o,!0),uF(s[1],r,o,!0)];s[0]<r[0]&&(u[0]=-1/0),s[1]>r[1]&&(u[1]=1/0),e&&(u[0]===-1/0?this._showIndicator(l,u[1],"< ",a):u[1]===1/0?this._showIndicator(l,u[0],"> ",a):this._showIndicator(l,l,"≈ ",a));var c=this._hoverLinkDataIndices,h=[];(e||mF(i))&&(h=this._hoverLinkDataIndices=i.findTargetDataIndices(u));var p=function(t,e){var i={},n={};return r(t||[],i),r(e||[],n,i),[o(i),o(n)];function r(t,e,i){for(var n=0,r=t.length;n<r;n++){var o=Dr(t[n].seriesId,null);if(null==o)return;for(var a=wr(t[n].dataIndex),s=i&&i[o],l=0,u=a.length;l<u;l++){var c=a[l];s&&s[c]?s[c]=null:(e[o]||(e[o]={}))[c]=1}}}function o(t,e){var i=[];for(var n in t)if(t.hasOwnProperty(n)&&null!=t[n])if(e)i.push(+n);else{var r=o(t[n],!0);r.length&&i.push({seriesId:n,dataIndex:r})}return i}}(c,h);this._dispatchHighDown("downplay",lF(p[0],i)),this._dispatchHighDown("highlight",lF(p[1],i))}},e.prototype._hoverLinkFromSeriesMouseOver=function(t){var e=t.target,i=this.visualMapModel;if(e&&null!=Ss(e).dataIndex){var n=Ss(e),r=this.ecModel.getSeriesByIndex(n.seriesIndex);if(i.isTargetSeries(r)){var o=r.getData(n.dataType),a=o.getStore().get(i.getDataDimensionIndex(o),n.dataIndex);isNaN(a)||this._showIndicator(a,a)}}},e.prototype._hideIndicator=function(){var t=this._shapes;t.indicator&&t.indicator.attr("invisible",!0),t.indicatorLabel&&t.indicatorLabel.attr("invisible",!0);var e=this._shapes.handleLabels;if(e)for(var i=0;i<e.length;i++)this._api.leaveBlur(e[i])},e.prototype._clearHoverLinkToSeries=function(){this._hideIndicator();var t=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",lF(t,this.visualMapModel)),t.length=0},e.prototype._clearHoverLinkFromSeries=function(){this._hideIndicator();var t=this.api.getZr();t.off("mouseover",this._hoverLinkFromSeriesMouseOver),t.off("mouseout",this._hideIndicator)},e.prototype._applyTransform=function(t,e,i,n){var r=rc(e,n?null:this.group);return U(t)?oc(t,r,i):ac(t,r,i)},e.prototype._dispatchHighDown=function(t,e){e&&e.length&&this.api.dispatchAction({type:t,batch:e})},e.prototype.dispose=function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},e.prototype.remove=function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},e.type="visualMap.continuous",e}(oF);function fF(t,e,i,n){return new hu({shape:{points:t},draggable:!!i,cursor:e,drift:i,onmousemove:function(t){ie(t.event)},ondragend:n})}function mF(t){var e=t.get("hoverLinkOnHandle");return!!(null==e?t.get("realtime"):e)}function gF(t){return"vertical"===t?"ns-resize":"ew-resize"}var yF={type:"selectDataRange",event:"dataRangeSelected",update:"update"},vF=function(t,e){e.eachComponent({mainType:"visualMap",query:t},function(e){e.setSelected(t.selected)})},_F=[{createOnAllSeries:!0,reset:function(t,e){var i=[];return e.eachComponent("visualMap",function(e){var n,r,o,a,s,l=t.pipelineContext;!e.isTargetSeries(t)||l&&l.large||i.push((n=e.stateList,r=e.targetVisuals,o=F(e.getValueState,e),a=e.getDataDimensionIndex(t.getData()),s={},L(n,function(t){var e=rC.prepareVisualTypes(r[t]);s[t]=e}),{progress:function(t,e){var i,n;function l(t){return Nm(e,n,t)}function u(t,i){Vm(e,n,t,i)}null!=a&&(i=e.getDimensionIndex(a));for(var c=e.getStore();null!=(n=t.next());){var h=e.getRawDataItem(n);if(!h||!1!==h.visualMap)for(var p=null!=a?c.get(i,n):n,d=o(p),f=r[d],m=s[d],g=0,y=m.length;g<y;g++){var v=m[g];f[v]&&f[v].applyVisual(p,l,u)}}}}))}),i}},{createOnAllSeries:!0,reset:function(t,e){var i=t.getData(),n=[];e.eachComponent("visualMap",function(e){if(e.isTargetSeries(t)){var r=e.getVisualMeta(F(xF,null,t,e))||{stops:[],outerColors:[]},o=e.getDataDimensionIndex(i);o>=0&&(r.dimension=o,n.push(r))}}),t.getData().setVisual("visualMeta",n)}}];function xF(t,e,i,n){for(var r=e.targetVisuals[n],o=rC.prepareVisualTypes(r),a={color:Fm(t.getData(),"color")},s=0,l=o.length;s<l;s++){var u=o[s],c=r["opacity"===u?"__alphaForOpacity":u];c&&c.applyVisual(i,h,p)}return a.color;function h(t){return a[t]}function p(t,e){a[t]=e}}var bF=L;function wF(t){var e=t&&t.visualMap;U(e)||(e=e?[e]:[]),bF(e,function(t){if(t){SF(t,"splitList")&&!SF(t,"pieces")&&(t.pieces=t.splitList,delete t.splitList);var e=t.pieces;e&&U(e)&&bF(e,function(t){j(t)&&(SF(t,"start")&&!SF(t,"min")&&(t.min=t.start),SF(t,"end")&&!SF(t,"max")&&(t.max=t.end))})}})}function SF(t,e){return t&&t.hasOwnProperty&&t.hasOwnProperty(e)}var TF=!1;function MF(t){TF||(TF=!0,t.registerSubTypeDefaulter("visualMap",function(t){return t.categories||(t.pieces?t.pieces.length>0:t.splitNumber>0)&&!t.calculable?"piecewise":"continuous"}),t.registerAction(yF,vF),L(_F,function(e){t.registerVisual(t.PRIORITY.VISUAL.COMPONENT,e)}),t.registerPreprocessor(wF))}function IF(t){t.registerComponentModel(nF),t.registerComponentView(dF),MF(t)}var CF=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i._pieceList=[],i}return i(e,t),e.prototype.optionUpdated=function(e,i){t.prototype.optionUpdated.apply(this,arguments),this.resetExtent();var n=this._mode=this._determineMode();this._pieceList=[],AF[this._mode].call(this,this._pieceList),this._resetSelected(e,i);var r=this.option.categories;this.resetVisual(function(t,e){"categories"===n?(t.mappingMethod="category",t.categories=S(r)):(t.dataExtent=this.getExtent(),t.mappingMethod="piecewise",t.pieceList=z(this._pieceList,function(t){return t=S(t),"inRange"!==e&&(t.visual=null),t}))})},e.prototype.completeVisualOption=function(){var e=this.option,i={},n=rC.listVisualTypes(),r=this.isCategory();function o(t,e,i){return t&&t[e]&&t[e].hasOwnProperty(i)}L(e.pieces,function(t){L(n,function(e){t.hasOwnProperty(e)&&(i[e]=1)})}),L(i,function(t,i){var n=!1;L(this.stateList,function(t){n=n||o(e,t,i)||o(e.target,t,i)},this),!n&&L(this.stateList,function(t){(e[t]||(e[t]={}))[i]=ZN(i,"inRange"===t?"active":"inactive",r)})},this),t.prototype.completeVisualOption.apply(this,arguments)},e.prototype._resetSelected=function(t,e){var i=this.option,n=this._pieceList,r=(e?i:t).selected||{};if(i.selected=r,L(n,function(t,e){var i=this.getSelectedMapKey(t);r.hasOwnProperty(i)||(r[i]=!0)},this),"single"===i.selectedMode){var o=!1;L(n,function(t,e){var i=this.getSelectedMapKey(t);r[i]&&(o?r[i]=!1:o=!0)},this)}},e.prototype.getItemSymbol=function(){return this.get("itemSymbol")},e.prototype.getSelectedMapKey=function(t){return"categories"===this._mode?t.value+"":t.index+""},e.prototype.getPieceList=function(){return this._pieceList},e.prototype._determineMode=function(){var t=this.option;return t.pieces&&t.pieces.length>0?"pieces":this.option.categories?"categories":"splitNumber"},e.prototype.setSelected=function(t){this.option.selected=S(t)},e.prototype.getValueState=function(t){var e=rC.findPieceIndex(t,this._pieceList);return null!=e&&this.option.selected[this.getSelectedMapKey(this._pieceList[e])]?"inRange":"outOfRange"},e.prototype.findTargetDataIndices=function(t){var e=[],i=this._pieceList;return this.eachTargetSeries(function(n){var r=[],o=n.getData();o.each(this.getDataDimensionIndex(o),function(e,n){rC.findPieceIndex(e,i)===t&&r.push(n)},this),e.push({seriesId:n.id,dataIndex:r})},this),e},e.prototype.getRepresentValue=function(t){var e;if(this.isCategory())e=t.value;else if(null!=t.value)e=t.value;else{var i=t.interval||[];e=i[0]===-1/0&&i[1]===1/0?0:(i[0]+i[1])/2}return e},e.prototype.getVisualMeta=function(t){if(!this.isCategory()){var e=[],i=["",""],n=this,r=this._pieceList.slice();if(r.length){var o=r[0].interval[0];o!==-1/0&&r.unshift({interval:[-1/0,o]}),(o=r[r.length-1].interval[1])!==1/0&&r.push({interval:[o,1/0]})}else r.push({interval:[-1/0,1/0]});var a=-1/0;return L(r,function(t){var e=t.interval;e&&(e[0]>a&&s([a,e[0]],"outOfRange"),s(e.slice()),a=e[1])},this),{stops:e,outerColors:i}}function s(r,o){var a=n.getRepresentValue({interval:r});o||(o=n.getValueState(a));var s=t(a,o);r[0]===-1/0?i[0]=s:r[1]===1/0?i[1]=s:e.push({value:r[0],color:s},{value:r[1],color:s})}},e.type="visualMap.piecewise",e.defaultOption=jc(eF.defaultOption,{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieces:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0}),e}(eF),AF={splitNumber:function(t){var e=this.option,i=Math.min(e.precision,20),n=this.getExtent(),r=e.splitNumber;r=Math.max(parseInt(r,10),1),e.splitNumber=r;for(var o=(n[1]-n[0])/r;+o.toFixed(i)!==o&&i<5;)i++;e.precision=i,o=+o.toFixed(i),e.minOpen&&t.push({interval:[-1/0,n[0]],close:[0,0]});for(var a=0,s=n[0];a<r;s+=o,a++){var l=a===r-1?n[1]:s+o;t.push({interval:[s,l],close:[1,1]})}e.maxOpen&&t.push({interval:[n[1],1/0],close:[0,0]}),pr(t),L(t,function(t,e){t.index=e,t.text=this.formatValueText(t.interval)},this)},categories:function(t){var e=this.option;L(e.categories,function(e){t.push({text:this.formatValueText(e,!0),value:e})},this),kF(e,t)},pieces:function(t){var e=this.option;L(e.pieces,function(e,i){j(e)||(e={value:e});var n={text:"",index:i};if(null!=e.label&&(n.text=e.label),e.hasOwnProperty("value")){var r=n.value=e.value;n.interval=[r,r],n.close=[1,1]}else{for(var o=n.interval=[],a=n.close=[0,0],s=[1,0,1],l=[-1/0,1/0],u=[],c=0;c<2;c++){for(var h=[["gte","gt","min"],["lte","lt","max"]][c],p=0;p<3&&null==o[c];p++)o[c]=e[h[p]],a[c]=s[p],u[c]=2===p;null==o[c]&&(o[c]=l[c])}u[0]&&o[1]===1/0&&(a[0]=0),u[1]&&o[0]===-1/0&&(a[1]=0),o[0]===o[1]&&a[0]&&a[1]&&(n.value=o[0])}n.visual=rC.retrieveVisuals(e),t.push(n)},this),kF(e,t),pr(t),L(t,function(t){var e=t.close,i=[["<","≤"][e[1]],[">","≥"][e[0]]];t.text=t.text||this.formatValueText(null!=t.value?t.value:t.interval,!1,i)},this)}};function kF(t,e){var i=t.inverse;("vertical"===t.orient?!i:i)&&e.reverse()}var DF=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.type=e.type,i}return i(e,t),e.prototype.doRender=function(){var t=this.group;t.removeAll();var e=this.visualMapModel,i=e.get("textGap"),n=e.textStyleModel,r=n.getFont(),o=n.getTextColor(),a=this._getItemAlign(),s=e.itemSize,l=this._getViewData(),u=l.endsText,c=tt(e.get("showLabel",!0),!u);u&&this._renderEndsText(t,u[0],s,c,a),L(l.viewPieceList,function(n){var l=n.piece,u=new Fn;u.onclick=F(this._onItemClick,this,l),this._enableHoverLink(u,n.indexInModelPieceList);var h=e.getRepresentValue(l);if(this._createItemSymbol(u,h,[0,0,s[0],s[1]]),c){var p=this.visualMapModel.getValueState(h);u.add(new fs({style:{x:"right"===a?-i:s[0]+i,y:s[1]/2,text:l.text,verticalAlign:"middle",align:a,font:r,fill:o,opacity:"outOfRange"===p?.5:1}}))}t.add(u)},this),u&&this._renderEndsText(t,u[1],s,c,a),qh(e.get("orient"),t,e.get("itemGap")),this.renderBackground(t),this.positionGroup(t)},e.prototype._enableHoverLink=function(t,e){var i=this;t.on("mouseover",function(){return n("highlight")}).on("mouseout",function(){return n("downplay")});var n=function(t){var n=i.visualMapModel;n.option.hoverLink&&i.api.dispatchAction({type:t,batch:lF(n.findTargetDataIndices(e),n)})}},e.prototype._getItemAlign=function(){var t=this.visualMapModel,e=t.option;if("vertical"===e.orient)return sF(t,this.api,t.itemSize);var i=e.align;return i&&"auto"!==i||(i="left"),i},e.prototype._renderEndsText=function(t,e,i,n,r){if(e){var o=new Fn,a=this.visualMapModel.textStyleModel;o.add(new fs({style:{x:n?"right"===r?i[0]:0:i[0]/2,y:i[1]/2,verticalAlign:"middle",align:n?r:"center",text:e,font:a.getFont(),fill:a.getTextColor()}})),t.add(o)}},e.prototype._getViewData=function(){var t=this.visualMapModel,e=z(t.getPieceList(),function(t,e){return{piece:t,indexInModelPieceList:e}}),i=t.get("text"),n=t.get("orient"),r=t.get("inverse");return("horizontal"===n?r:!r)?e.reverse():i&&(i=i.slice().reverse()),{viewPieceList:e,endsText:i}},e.prototype._createItemSymbol=function(t,e,i){t.add(eg(this.getControllerVisual(e,"symbol"),i[0],i[1],i[2],i[3],this.getControllerVisual(e,"color")))},e.prototype._onItemClick=function(t){var e=this.visualMapModel,i=e.option,n=S(i.selected),r=e.getSelectedMapKey(t);"single"===i.selectedMode?(n[r]=!0,L(n,function(t,e){n[e]=e===r})):n[r]=!n[r],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:n})},e.type="visualMap.piecewise",e}(oF);function EF(t){t.registerComponentModel(CF),t.registerComponentView(DF),MF(t)}var PF={label:{enabled:!0},decal:{show:!1}},LF=zr(),zF={};function OF(t,e){var i=t.getModel("aria");if(i.get("enabled")){var n=S(PF);T(n.label,t.getLocaleModel().get("aria"),!1),T(i.option,n,!1),function(){if(i.getModel("decal").get("show")){var e=ht();t.eachSeries(function(t){if(!t.isColorBySeries()){var i=e.get(t.type);i||(i={},e.set(t.type,i)),LF(t).scope=i}}),t.eachRawSeries(function(e){if(!t.isSeriesFiltered(e))if("function"!=typeof e.enableAriaDecal){var i=e.getData();if(e.isColorBySeries()){var n=Ep(e.ecModel,e.name,zF,t.getSeriesCount()),r=i.getVisual("decal");i.setVisual("decal",u(r,n))}else{var o=e.getRawData(),a={},s=LF(e).scope;i.each(function(t){var e=i.getRawIndex(t);a[e]=t});var l=o.count();o.each(function(t){var n=a[t],r=o.getName(t)||t+"",c=Ep(e.ecModel,r,s,l),h=i.getItemVisual(n,"decal");i.setItemVisual(n,"decal",u(h,c))})}}else e.enableAriaDecal();function u(t,e){var i=t?I(I({},e),t):e;return i.dirty=!0,i}})}}(),function(){var n=t.getLocaleModel().get("aria"),o=i.getModel("label");if(o.option=C(o.option,n),o.get("enabled")){var a=e.getZr().dom;if(o.get("description"))a.setAttribute("aria-label",o.get("description"));else{var s,l=t.getSeriesCount(),u=o.get(["data","maxCount"])||10,c=o.get(["series","maxCount"])||10,h=Math.min(l,c);if(!(l<1)){var p=function(){var e=t.get("title");return e&&e.length&&(e=e[0]),e&&e.text}(),d;if(p)s=r(o.get(["general","withTitle"]),{title:p});else s=o.get(["general","withoutTitle"]);var f=[],m;s+=r(l>1?o.get(["series","multiple","prefix"]):o.get(["series","single","prefix"]),{seriesCount:l}),t.eachSeries(function(e,i){if(i<h){var n=void 0,a=e.get("name")?"withName":"withoutName";n=r(n=l>1?o.get(["series","multiple",a]):o.get(["series","single",a]),{seriesId:e.seriesIndex,seriesName:e.get("name"),seriesType:(_=e.subType,t.getLocaleModel().get(["series","typeNames"])[_]||"自定义图")});var s=e.getData();s.count()>u?n+=r(o.get(["data","partialData"]),{displayCnt:u}):n+=o.get(["data","allData"]);for(var c=o.get(["data","separator","middle"]),p=o.get(["data","separator","end"]),d=[],m=0;m<s.count();m++)if(m<u){var g=s.getName(m),y=s.getValues(m),v=o.get(["data",g?"withName":"withoutName"]);d.push(r(v,{name:g,value:y.join(c)}))}n+=d.join(c)+p,f.push(n)}var _});var g=o.getModel(["series","multiple","separator"]),y=g.get("middle"),v=g.get("end");s+=f.join(y)+v,a.setAttribute("aria-label",s)}}}}()}function r(t,e){if("string"!=typeof t)return t;var i=t;return L(e,function(t,e){i=i.replace(RegExp("\\{\\s*"+e+"\\s*\\}","g"),t)}),i}}function RF(t){if(t&&t.aria){var e=t.aria;null!=e.show&&(e.enabled=e.show),e.label=e.label||{},L(["description","general","series","data"],function(t){null!=e[t]&&(e.label[t]=e[t])})}}var BF={value:"eq","<":"lt","<=":"lte",">":"gt",">=":"gte","=":"eq","!=":"ne","<>":"ne"},NF=function(){function t(t){var e;null==(this._condVal=$(t)?RegExp(t):J(t)?t:null)&&_r("")}return t.prototype.evaluate=function(t){var e=typeof t;return"string"===e?this._condVal.test(t):"number"===e&&this._condVal.test(t+"")},t}(),FF=function(){function t(){}return t.prototype.evaluate=function(){return this.value},t}(),VF=function(){function t(){}return t.prototype.evaluate=function(){for(var t=this.children,e=0;e<t.length;e++)if(!t[e].evaluate())return!1;return!0},t}(),UF=function(){function t(){}return t.prototype.evaluate=function(){for(var t=this.children,e=0;e<t.length;e++)if(t[e].evaluate())return!0;return!1},t}(),GF=function(){function t(){}return t.prototype.evaluate=function(){return!this.child.evaluate()},t}(),$F=function(){function t(){}return t.prototype.evaluate=function(){for(var t=!!this.valueParser,e=(0,this.getValue)(this.valueGetterParam),i=t?this.valueParser(e):null,n=0;n<this.subCondList.length;n++)if(!this.subCondList[n].evaluate(t?i:e))return!1;return!0},t}();function WF(t,e){if(!0===t||!1===t){var i=new FF;return i.value=t,i}var n="";return jF(t)||_r(n),t.and?HF("and",t,e):t.or?HF("or",t,e):t.not?function(t,e){var i=t.not,n="";jF(i)||_r(n);var r=new GF;return r.child=WF(i,e),r.child||_r(n),r}(t,e):function(t,e){for(var i="",n=e.prepareGetValue(t),r=[],o=N(t),a=t.parser,s=a?Wd(a):null,l=0;l<o.length;l++){var u=o[l];if("parser"!==u&&!e.valueGetterAttrMap.get(u)){var c=ft(BF,u)?BF[u]:u,h=t[u],p=s?s(h):h,d=Xd(c,p)||"reg"===c&&new NF(p);d||_r(i),r.push(d)}}r.length||_r(i);var f=new $F;return f.valueGetterParam=n,f.valueParser=s,f.getValue=e.getValue,f.subCondList=r,f}(t,e)}function HF(t,e,i){var n=e[t],r="";U(n)||_r(r),n.length||_r(r);var o="and"===t?new VF:new UF;return o.children=z(n,function(t){return WF(t,i)}),o.children.length||_r(r),o}function jF(t){return j(t)&&!P(t)}var ZF=function(){function t(t,e){this._cond=WF(t,e)}return t.prototype.evaluate=function(){return this._cond.evaluate()},t}(),qF={type:"echarts:filter",transform:function(t){for(var e,i,n,r=t.upstream,o=(i=t.config,n={valueGetterAttrMap:ht({dimension:!0}),prepareGetValue:function(t){var e="",i=t.dimension;ft(t,"dimension")||_r(e);var n=r.getDimensionInfo(i);return n||_r(e),{dimIdx:n.index}},getValue:function(t){return r.retrieveValueFromItem(e,t.dimIdx)}},new ZF(i,n)),a=[],s=0,l=r.count();s<l;s++)e=r.getRawDataItem(s),o.evaluate()&&a.push(e);return{data:a}}},XF={type:"echarts:sort",transform:function(t){var e=t.upstream,i=t.config,n="",r=wr(i);r.length||_r(n);var o=[];L(r,function(t){var i=t.dimension,r=t.order,a=t.parser,s=t.incomparable,l,u;(null==i&&_r(n),"asc"!==r&&"desc"!==r&&_r(n),s&&"min"!==s&&"max"!==s)&&_r("");"asc"!==r&&"desc"!==r&&_r("");var c=e.getDimensionInfo(i);c||_r(n);var h=a?Wd(a):null;a&&!h&&_r(n),o.push({dimIdx:c.index,parser:h,comparator:new Zd(r,s)})});var a=e.sourceFormat;a!==lp&&a!==up&&_r(n);for(var s=[],l=0,u=e.count();l<u;l++)s.push(e.getRawDataItem(l));return s.sort(function(t,i){for(var n=0;n<o.length;n++){var r=o[n],a=e.retrieveValueFromItem(t,r.dimIdx),s=e.retrieveValueFromItem(i,r.dimIdx);r.parser&&(a=r.parser(a),s=r.parser(s));var l=r.comparator.evaluate(a,s);if(0!==l)return l}return 0}),{data:s}}},YF=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="dataset",e}return i(e,t),e.prototype.init=function(e,i,n){t.prototype.init.call(this,e,i,n),this._sourceManager=new mf(this),gf(this)},e.prototype.mergeOption=function(e,i){t.prototype.mergeOption.call(this,e,i),gf(this)},e.prototype.optionUpdated=function(){this._sourceManager.dirty()},e.prototype.getSourceManager=function(){return this._sourceManager},e.type="dataset",e.defaultOption={seriesLayoutBy:dp},e}(ip),KF=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="dataset",e}return i(e,t),e.type="dataset",e}($f),JF=La.CMD;function QF(t,e){return Math.abs(t-e)<1e-5}function tV(t){var e,i,n,r,o,a=t.data,s=t.len(),l=[],u=0,c=0,h=0,p=0;function d(t,i){e&&e.length>2&&l.push(e),e=[t,i]}function f(t,i,n,r){QF(t,n)&&QF(i,r)||e.push(t,i,n,r,n,r)}function m(t,i,n,r,o,a){var s,l=4*Math.tan(Math.abs(i-t)/4)/3,u=i<t?-1:1,c=Math.cos(t),h=Math.sin(t),p=Math.cos(i),d=Math.sin(i),f=c*o+n,m=h*a+r,g=p*o+n,y=d*a+r,v=o*l*u,_=a*l*u;e.push(f-v*h,m+_*c,g+v*d,y-_*p,g,y)}for(var g=0;g<s;){var y=a[g++],v=1===g;switch(v&&(h=u=a[g],p=c=a[g+1],y!==JF.L&&y!==JF.C&&y!==JF.Q||(e=[h,p])),y){case JF.M:u=h=a[g++],c=p=a[g++],d(h,p);break;case JF.L:f(u,c,i=a[g++],n=a[g++]),u=i,c=n;break;case JF.C:e.push(a[g++],a[g++],a[g++],a[g++],u=a[g++],c=a[g++]);break;case JF.Q:i=a[g++],n=a[g++],r=a[g++],o=a[g++],e.push(u+2/3*(i-u),c+2/3*(n-c),r+2/3*(i-r),o+2/3*(n-o),r,o),u=r,c=o;break;case JF.A:var _=a[g++],x=a[g++],b=a[g++],w=a[g++],S=a[g++],T=a[g++]+S;g+=1;var M=!a[g++];i=Math.cos(S)*b+_,n=Math.sin(S)*w+x,v?d(h=i,p=n):f(u,c,i,n),u=Math.cos(T)*b+_,c=Math.sin(T)*w+x;for(var I=(M?-1:1)*Math.PI/2,C=S;M?C>T:C<T;C+=I)m(C,M?Math.max(C+I,T):Math.min(C+I,T),_,x,b,w);break;case JF.R:h=u=a[g++],p=c=a[g++],i=h+a[g++],n=p+a[g++],d(i,p),f(i,p,i,n),f(i,n,h,n),f(h,n,h,p),f(h,p,i,p);break;case JF.Z:e&&f(u,c,h,p),u=h,c=p}}return e&&e.length>2&&l.push(e),l}function eV(t,e,i,n,r,o,a,s,l,u){if(QF(t,i)&&QF(e,n)&&QF(r,a)&&QF(o,s))l.push(a,s);else{var c=2/u,h=c*c,p=a-t,d=s-e,f=Math.sqrt(p*p+d*d);p/=f,d/=f;var m=i-t,g=n-e,y=r-a,v=o-s,_=m*m+g*g,x=y*y+v*v;if(_<h&&x<h)l.push(a,s);else{var b=p*m+d*g,w=-p*y-d*v;if(_-b*b<h&&b>=0&&x-w*w<h&&w>=0)l.push(a,s);else{var S=[],T=[];Wo(t,i,r,a,.5,S),Wo(e,n,o,s,.5,T),eV(S[0],T[0],S[1],T[1],S[2],T[2],S[3],T[3],l,u),eV(S[4],T[4],S[5],T[5],S[6],T[6],S[7],T[7],l,u)}}}}function iV(t,e,i){var n=t[e],r=t[1-e],o,a=Math.ceil(Math.sqrt(Math.abs(n/r)*i)),s=Math.floor(i/a);0===s&&(s=1,a=i);for(var l=[],u=0;u<a;u++)l.push(s);var c=i-a*s;if(c>0)for(u=0;u<c;u++)l[u%a]+=1;return l}function nV(t,e,i){for(var n=t.r0,r=t.r,o=t.startAngle,a=t.endAngle,s=Math.abs(a-o),l=s*r,u=r-n,c=l>Math.abs(u),h=iV([l,u],c?0:1,e),p=(c?s:u)/h.length,d=0;d<h.length;d++)for(var f=(c?u:s)/h[d],m=0;m<h[d];m++){var g={};c?(g.startAngle=o+p*d,g.endAngle=o+p*(d+1),g.r0=n+f*m,g.r=n+f*(m+1)):(g.startAngle=o+f*m,g.endAngle=o+f*(m+1),g.r0=n+p*d,g.r=n+p*(d+1)),g.clockwise=t.clockwise,g.cx=t.cx,g.cy=t.cy,i.push(g)}}function rV(t,e,i,n){return t*n-i*e}function oV(t,e,i,n,r,o,a,s){var l=i-t,u=n-e,c=a-r,h=s-o,p=rV(c,h,l,u);if(Math.abs(p)<1e-6)return null;var d=rV(t-r,e-o,c,h)/p;return d<0||d>1?null:new ln(d*l+t,d*u+e)}function aV(t,e,i){var n=new ln;ln.sub(n,i,e),n.normalize();var r=new ln;return ln.sub(r,t,e),r.dot(n)}function sV(t,e){var i=t[t.length-1];i&&i[0]===e[0]&&i[1]===e[1]||t.push(e)}function lV(t){var e=t.points,i=[],n=[];sa(e,i,n);var r=new yn(i[0],i[1],n[0]-i[0],n[1]-i[1]),o=r.width,a=r.height,s=r.x,l=r.y,u=new ln,c=new ln;return o>a?(u.x=c.x=s+o/2,u.y=l,c.y=l+a):(u.y=c.y=l+a/2,u.x=s,c.x=s+o),function(t,e,i){for(var n=t.length,r=[],o=0;o<n;o++){var a=t[o],s=t[(o+1)%n],l=oV(a[0],a[1],s[0],s[1],e.x,e.y,i.x,i.y);l&&r.push({projPt:aV(l,e,i),pt:l,idx:o})}if(r.length<2)return[{points:t},{points:t}];r.sort(function(t,e){return t.projPt-e.projPt});var u=r[0],c=r[r.length-1];if(c.idx<u.idx){var h=u;u=c,c=h}var p=[u.pt.x,u.pt.y],d=[c.pt.x,c.pt.y],f=[p],m=[d];for(o=u.idx+1;o<=c.idx;o++)sV(f,t[o].slice());for(sV(f,d),sV(f,p),o=c.idx+1;o<=u.idx+n;o++)sV(m,t[o%n].slice());return sV(m,p),sV(m,d),[{points:f},{points:m}]}(e,u,c)}function uV(t,e,i,n){if(1===i)n.push(e);else{var r=Math.floor(i/2),o=t(e);uV(t,o[0],r,n),uV(t,o[1],i-r,n)}return n}function cV(t,e){e.setStyle(t.style),e.z=t.z,e.z2=t.z2,e.zlevel=t.zlevel}function hV(t,e){var i,n=[],r=t.shape;switch(t.type){case"rect":!function(t,e,i){for(var n=t.width,r=t.height,o=n>r,a=iV([n,r],o?0:1,e),s=o?"width":"height",l=o?"height":"width",u=o?"x":"y",c=o?"y":"x",h=t[s]/a.length,p=0;p<a.length;p++)for(var d=t[l]/a[p],f=0;f<a[p];f++){var m={};m[u]=p*h,m[c]=f*d,m[s]=h,m[l]=d,m.x+=t.x,m.y+=t.y,i.push(m)}}(r,e,n),i=hs;break;case"sector":nV(r,e,n),i=ou;break;case"circle":nV({r0:0,r:r.r,startAngle:0,endAngle:2*Math.PI,cx:r.cx,cy:r.cy},e,n),i=ou;break;default:var o=t.getComputedTransform(),a=o?Math.sqrt(Math.max(o[0]*o[0]+o[1]*o[1],o[2]*o[2]+o[3]*o[3])):1,s=z(function(t,e){var i=tV(t),n=[];e=e||1;for(var r=0;r<i.length;r++){var o=i[r],a=[],s=o[0],l=o[1];a.push(s,l);for(var u=2;u<o.length;){var c=o[u++],h=o[u++],p=o[u++],d=o[u++],f=o[u++],m=o[u++];eV(s,l,c,h,p,d,f,m,a,e),s=f,l=m}n.push(a)}return n}(t.getUpdatedPathProxy(),a),function(t){return function(t){for(var e=[],i=0;i<t.length;)e.push([t[i++],t[i++]]);return e}(t)}),l=s.length;if(0===l)uV(lV,{points:s[0]},e,n);else if(l===e)for(var u=0;u<l;u++)n.push({points:s[u]});else{var c=0,h=z(s,function(t){var e=[],i=[];sa(t,e,i);var n=(i[1]-e[1])*(i[0]-e[0]);return c+=n,{poly:t,area:n}});h.sort(function(t,e){return e.area-t.area});var p=e;for(u=0;u<l;u++){var d=h[u];if(p<=0)break;var f=u===l-1?p:Math.ceil(d.area/c*e);f<0||(uV(lV,{points:d.poly},f,n),p-=f)}}i=hu}if(!i)return function(t,e){for(var i=[],n=0;n<e;n++)i.push(Vl(t));return i}(t,e);var m=[];for(u=0;u<n.length;u++){var g=new i;g.setShape(n[u]),cV(t,g),m.push(g)}return m}function pV(t,e){var i=t.length,n=e.length;if(i===n)return[t,e];for(var r=[],o=[],a=i<n?t:e,s=Math.min(i,n),l=Math.abs(n-i)/6,u,c=Math.ceil(l/((s-2)/6))+1,h=[a[0],a[1]],p=l,d=2;d<s;){var f=a[d-2],m=a[d-1],g=a[d++],y=a[d++],v=a[d++],_=a[d++],x=a[d++],b=a[d++];if(p<=0)h.push(g,y,v,_,x,b);else{for(var w=Math.min(p,c-1)+1,S=1;S<=w;S++){var T=S/w;Wo(f,g,v,x,T,r),Wo(m,y,_,b,T,o),f=r[3],m=o[3],h.push(r[1],o[1],r[2],o[2],f,m),g=r[5],y=o[5],v=r[6],_=o[6]}p-=w-1}}return a===t?[h,e]:[t,h]}function dV(t,e){for(var i=t.length,n=t[i-2],r=t[i-1],o=[],a=0;a<e.length;)o[a++]=n,o[a++]=r;return o}function fV(t){for(var e=0,i=0,n=0,r=t.length,o=0,a=r-2;o<r;a=o,o+=2){var s=t[a],l=t[a+1],u=t[o],c=t[o+1],h=s*c-u*l;e+=h,i+=(s+u)*h,n+=(l+c)*h}return 0===e?[t[0]||0,t[1]||0]:[i/e/3,n/e/3,e]}function mV(t,e,i,n){for(var r=(t.length-2)/6,o=1/0,a=0,s=t.length,l=s-2,u=0;u<r;u++){for(var c=6*u,h=0,p=0;p<s;p+=2){var d=0===p?c:(c+p-2)%l+2,f=t[d]-i[0],m=t[d+1]-i[1],g=e[p]-n[0]-f,y=e[p+1]-n[1]-m;h+=g*g+y*y}h<o&&(o=h,a=u)}return a}function gV(t){for(var e=[],i=t.length,n=0;n<i;n+=2)e[n]=t[i-n-2],e[n+1]=t[i-n-1];return e}function yV(t){return t.__isCombineMorphing}var vV="__mOriginal_";function _V(t,e,i){var n=vV+e,r=t[n]||t[e];t[n]||(t[n]=t[e]);var o=i.replace,a=i.after,s=i.before;t[e]=function(){var t,e=arguments;return s&&s.apply(this,e),t=o?o.apply(this,e):r.apply(this,e),a&&a.apply(this,e),t}}function xV(t,e){var i=vV+e;t[i]&&(t[e]=t[i],t[i]=null)}function bV(t,e){for(var i=0;i<t.length;i++)for(var n=t[i],r=0;r<n.length;){var o=n[r],a=n[r+1];n[r++]=e[0]*o+e[2]*a+e[4],n[r++]=e[1]*o+e[3]*a+e[5]}}function wV(t,e){var i=t.getUpdatedPathProxy(),n=e.getUpdatedPathProxy(),r=function(t,e){for(var i,n,r,o=[],a=[],s=0;s<Math.max(t.length,e.length);s++){var l=t[s],u=e[s],c=void 0,h=void 0;l?u?(n=c=(i=pV(l,u))[0],r=h=i[1]):(h=dV(r||l,l),c=l):(c=dV(n||u,u),h=u),o.push(c),a.push(h)}return[o,a]}(tV(i),tV(n)),o=r[0],a=r[1],s=t.getComputedTransform(),l=e.getComputedTransform();s&&bV(o,s),l&&bV(a,l),_V(e,"updateTransform",{replace:function(){this.transform=null}}),e.transform=null;var u=function(t,e,i,n){for(var r,o=[],a=0;a<t.length;a++){var s=t[a],l=e[a],u=fV(s),c=fV(l);null==r&&(r=u[2]<0!=c[2]<0);var h=[],p=[],d=0,f=1/0,m=[],g=s.length,y;r&&(s=gV(s));for(var v=6*mV(s,l,u,c),_=g-2,x=0;x<_;x+=2){var b=(v+x)%_+2;h[x+2]=s[b]-u[0],h[x+3]=s[b+1]-u[1]}h[0]=s[v]-u[0],h[1]=s[v+1]-u[1];for(var w=n/i,S=-n/2;S<=n/2;S+=w){var T=Math.sin(S),M=Math.cos(S),I=0;for(x=0;x<s.length;x+=2){var C=h[x],A=h[x+1],k=l[x]-c[0],D=l[x+1]-c[1],E=k*M-D*T,P=k*T+D*M;m[x]=E,m[x+1]=P;var L=E-C,z=P-A;I+=L*L+z*z}if(I<f){f=I,d=S;for(var O=0;O<m.length;O++)p[O]=m[O]}}o.push({from:h,to:p,fromCp:u,toCp:c,rotation:-d})}return o}(o,a,10,Math.PI),c=[];_V(e,"buildPath",{replace:function(t){for(var i=e.__morphT,n=1-i,r=[],o=0;o<u.length;o++){var a=u[o],s=a.from,l=a.to,h=a.rotation*i,p=a.fromCp,d=a.toCp,f=Math.sin(h),m=Math.cos(h);zt(r,p,d,i);for(var g=0;g<s.length;g+=2){var y=s[g],v=s[g+1],_=y*n+(S=l[g])*i,x=v*n+(T=l[g+1])*i;c[g]=_*m-x*f+r[0],c[g+1]=_*f+x*m+r[1]}var b=c[0],w=c[1];for(t.moveTo(b,w),g=2;g<s.length;){var S=c[g++],T=c[g++],M=c[g++],I=c[g++],C=c[g++],A=c[g++];b===S&&w===T&&M===C&&I===A?t.lineTo(C,A):t.bezierCurveTo(S,T,M,I,C,A),b=C,w=A}}}})}function SV(t,e,i){if(!t||!e)return e;var n=i.done,r=i.during;return wV(t,e),e.__morphT=0,e.animateTo({__morphT:1},C({during:function(t){e.dirtyShape(),r&&r(t)},done:function(){xV(e,"buildPath"),xV(e,"updateTransform"),e.__morphT=-1,e.createPathProxy(),e.dirtyShape(),n&&n()}},i)),e}function TV(t,e,i,n,r,o){t=r===i?0:Math.round(32767*(t-i)/(r-i)),e=o===n?0:Math.round(32767*(e-n)/(o-n));for(var a,s=0,l=32768;l>0;l/=2){var u=0,c=0;(t&l)>0&&(u=1),(e&l)>0&&(c=1),s+=l*l*(3*u^c),0===c&&(1===u&&(t=l-1-t,e=l-1-e),a=t,t=e,e=a)}return s}function MV(t){var e=1/0,i=1/0,n=-1/0,r=-1/0,o=z(t,function(t){var o=t.getBoundingRect(),a=t.getComputedTransform(),s=o.x+o.width/2+(a?a[4]:0),l=o.y+o.height/2+(a?a[5]:0);return e=Math.min(s,e),i=Math.min(l,i),n=Math.max(s,n),r=Math.max(l,r),[s,l]});return z(o,function(o,a){return{cp:o,z:TV(o[0],o[1],e,i,n,r),path:t[a]}}).sort(function(t,e){return t.z-e.z}).map(function(t){return t.path})}function IV(t){return hV(t.path,t.count)}function CV(t){return U(t[0])}function AV(t,e){for(var i=[],n=t.length,r=0;r<n;r++)i.push({one:t[r],many:[]});for(r=0;r<e.length;r++){var o=e[r].length,a=void 0;for(a=0;a<o;a++)i[a%n].many.push(e[r][a])}var s=0;for(r=n-1;r>=0;r--)if(!i[r].many.length){var l=i[s].many;if(l.length<=1){if(!s)return i;s=0}o=l.length;var u=Math.ceil(o/2);i[r].many=l.slice(u,o),i[s].many=l.slice(0,u),s++}return i}var kV={clone:function(t){for(var e=[],i=1-Math.pow(1-t.path.style.opacity,1/t.count),n=0;n<t.count;n++){var r=Vl(t.path);r.setStyle("opacity",i),e.push(r)}return e},split:null};function DV(t,e,i,n,r,o){if(t.length&&e.length){var a=Ou("update",n,r);if(a&&a.duration>0){var s,l,u=n.getModel("universalTransition").get("delay"),c=Object.assign({setToFinal:!0},a);CV(t)&&(s=t,l=e),CV(e)&&(s=e,l=t);for(var h=s?s===t:t.length>e.length,p=s?AV(l,s):AV(h?e:t,[h?t:e]),d=0,f=0;f<p.length;f++)d+=p[f].many.length;var m=0;for(f=0;f<p.length;f++)g(p[f],h,m,d),m+=p[f].many.length}}function g(t,e,n,r,a){var s=t.many,l=t.one;if(1!==s.length||a)for(var h=C({dividePath:kV[i],individualDelay:u&&function(t,e,i,o){return u(t+n,r)}},c),p=e?function(t,e,i){var n=[];!function t(e){for(var i=0;i<e.length;i++){var r=e[i];yV(r)?t(r.childrenRef()):r instanceof Qa&&n.push(r)}}(t);var r=n.length;if(!r)return{fromIndividuals:[],toIndividuals:[],count:0};var o=(i.dividePath||IV)({path:e,count:r});if(o.length!==r)return console.error("Invalid morphing: unmatched splitted path"),{fromIndividuals:[],toIndividuals:[],count:0};n=MV(n),o=MV(o);for(var a=i.done,s=i.during,l=i.individualDelay,u=new an,c=0;c<r;c++){var h=n[c],p=o[c];p.parent=e,p.copyTransform(u),l||wV(h,p)}function d(t){for(var e=0;e<o.length;e++)o[e].addSelfToZr(t)}function f(){e.__isCombineMorphing=!1,e.__morphT=-1,e.childrenRef=null,xV(e,"addSelfToZr"),xV(e,"removeSelfFromZr")}e.__isCombineMorphing=!0,e.childrenRef=function(){return o},_V(e,"addSelfToZr",{after:function(t){d(t)}}),_V(e,"removeSelfFromZr",{after:function(t){for(var e=0;e<o.length;e++)o[e].removeSelfFromZr(t)}});var m=o.length;if(l){var g=m,y=function(){0==--g&&(f(),a&&a())};for(c=0;c<m;c++){var v=l?C({delay:(i.delay||0)+l(c,m,n[c],o[c]),done:y},i):i;SV(n[c],o[c],v)}}else e.__morphT=0,e.animateTo({__morphT:1},C({during:function(t){for(var i=0;i<m;i++){var n=o[i];n.__morphT=e.__morphT,n.dirtyShape()}s&&s(t)},done:function(){f();for(var e=0;e<t.length;e++)xV(t[e],"updateTransform");a&&a()}},i));return e.__zr&&d(e.__zr),{fromIndividuals:n,toIndividuals:o,count:m}}(s,l,h):function(t,e,i){var n=e.length,r=[],o=i.dividePath||IV;if(yV(t)){!function t(e){for(var i=0;i<e.length;i++){var n=e[i];yV(n)?t(n.childrenRef()):n instanceof Qa&&r.push(n)}}(t.childrenRef());var a=r.length;if(a<n)for(var s=0,l=a;l<n;l++)r.push(Vl(r[s++%a]));r.length=n}else{r=o({path:t,count:n});var u=t.getComputedTransform();for(l=0;l<r.length;l++)r[l].setLocalTransform(u);if(r.length!==n)return console.error("Invalid morphing: unmatched splitted path"),{fromIndividuals:[],toIndividuals:[],count:0}}r=MV(r),e=MV(e);var c=i.individualDelay;for(l=0;l<n;l++){var h=c?C({delay:(i.delay||0)+c(l,n,r[l],e[l])},i):i;SV(r[l],e[l],h)}return{fromIndividuals:r,toIndividuals:e,count:e.length}}(l,s,h),d=p.fromIndividuals,f=p.toIndividuals,m=d.length,y=0;y<m;y++)v=u?C({delay:u(y,m)},c):c,o(d[y],f[y],e?s[y]:t.one,e?t.one:s[y],v);else{var v,_=e?s[0]:l,x=e?l:s[0];yV(_)?g({many:[_],one:x},!0,n,r,!0):(SV(_,x,v=u?C({delay:u(n,r)},c):c),o(_,x,_,x,v))}}}function EV(t){if(!t)return[];if(U(t)){for(var e=[],i=0;i<t.length;i++)e.push(EV(t[i]));return e}var n=[];return t.traverse(function(t){t instanceof Qa&&!t.disableMorphing&&!t.invisible&&!t.ignore&&n.push(t)}),n}var PV=zr();function LV(t){var e=[];return L(t,function(t){var i=t.data;if(!(i.count()>1e4))for(var n=i.getIndices(),r=function(t){for(var e=t.dimensions,i=0;i<e.length;i++){var n=t.getDimensionInfo(e[i]);if(n&&0===n.otherDims.itemGroupId)return e[i]}}(i),o=0;o<n.length;o++)e.push({data:i,dim:t.dim||r,divide:t.divide,dataIndex:o})}),e}function zV(t,e,i){t.traverse(function(t){t instanceof Qa&&Nu(t,{style:{opacity:0}},e,{dataIndex:i,isFrom:!0})})}function OV(t){if(t.parent){var e=t.getComputedTransform();t.setLocalTransform(e),t.parent.remove(t)}}function RV(t){t.stopAnimation(),t.isGroup&&t.traverse(function(t){t.stopAnimation()})}function BV(t,e,i){var n=Ou("update",i,e);n&&t.traverse(function(t){if(t instanceof Io){var e=function(t){return zu(t).oldStyle}(t);e&&t.animateFrom({style:e},n)}})}function NV(t,e,i){var n=LV(t),r=LV(e);function o(t,e,i,n,r){(i||t)&&e.animateFrom({style:(i||t).style},r)}function a(t){for(var e=0;e<t.length;e++)if(t[e].dim)return t[e].dim}var s=a(n),l=a(r),u=!1;function c(t,e){return function(i){var n=i.data,r=i.dataIndex;if(e)return n.getId(r);var o=n.hostModel&&n.hostModel.get("dataGroupId"),a=t?s||l:l||s,u=a&&n.getDimensionInfo(a),c=u&&u.ordinalMeta;if(u){var h=n.get(u.name,r);return c&&c.categories[h]||h+""}var p=n.getRawDataItem(r);return p&&p.groupId?p.groupId+"":o||n.getId(r)}}var h=function(t,e){var i=t.length;if(i!==e.length)return!1;for(var n=0;n<i;n++){var r=t[n],o=e[n];if(r.data.getId(r.dataIndex)!==o.data.getId(o.dataIndex))return!1}return!0}(n,r),p={};if(!h)for(var d=0;d<r.length;d++){var f=r[d],m=f.data.getItemGraphicEl(f.dataIndex);m&&(p[m.id]=!0)}function g(t,e){var i=n[e],a=r[t],s=a.data.hostModel,l=i.data.getItemGraphicEl(i.dataIndex),c=a.data.getItemGraphicEl(a.dataIndex);l!==c?l&&p[l.id]||c&&(RV(c),l?(RV(l),OV(l),u=!0,DV(EV(l),EV(c),a.divide,s,t,o)):zV(c,s,t)):c&&BV(c,a.dataIndex,s)}new Fv(n,r,c(!0,h),c(!1,h),null,"multiple").update(g).updateManyToOne(function(t,e){var i=r[t],a=i.data,s=a.hostModel,l=a.getItemGraphicEl(i.dataIndex),c=R(z(e,function(t){return n[t].data.getItemGraphicEl(n[t].dataIndex)}),function(t){return t&&t!==l&&!p[t.id]});l&&(RV(l),c.length?(L(c,function(t){RV(t),OV(t)}),u=!0,DV(EV(c),EV(l),i.divide,s,t,o)):zV(l,s,i.dataIndex))}).updateOneToMany(function(t,e){var i=n[e],a=i.data.getItemGraphicEl(i.dataIndex);if(!a||!p[a.id]){var s=R(z(t,function(t){return r[t].data.getItemGraphicEl(r[t].dataIndex)}),function(t){return t&&t!==a}),l=r[t[0]].data.hostModel;s.length&&(L(s,function(t){return RV(t)}),a?(RV(a),OV(a),u=!0,DV(EV(a),EV(s),i.divide,l,t[0],o)):L(s,function(e){return zV(e,l,t[0])}))}}).updateManyToMany(function(t,e){new Fv(e,t,function(t){return n[t].data.getId(n[t].dataIndex)},function(t){return r[t].data.getId(r[t].dataIndex)}).update(function(i,n){g(t[i],e[n])}).execute()}).execute(),u&&L(e,function(t){var e=t.data.hostModel,n=e&&i.getViewOfSeriesModel(e),r=Ou("update",e,0);n&&e.isAnimationEnabled()&&r&&r.duration>0&&n.group.traverse(function(t){t instanceof Qa&&!t.animators.length&&t.animateFrom({style:{opacity:0}},r)})})}function FV(t){var e;return t.getModel("universalTransition").get("seriesKey")||t.id}function VV(t){return U(t)?t.sort().join(","):t}function UV(t){if(t.hostModel)return t.hostModel.getModel("universalTransition").get("divideShape")}function GV(t,e){for(var i=0;i<t.length;i++)if(null!=e.seriesIndex&&e.seriesIndex===t[i].seriesIndex||null!=e.seriesId&&e.seriesId===t[i].id)return i}Rv([function(t){t.registerPainter("canvas",Cw)}]),Rv([function(t){t.registerPainter("svg",vw)}]),Rv([function(t){t.registerChartView(cS),t.registerSeriesModel(Aw),t.registerLayout(hS("line",!0)),t.registerVisual({seriesType:"line",reset:function(t){var e=t.getData(),i=t.getModel("lineStyle").getLineStyle();i&&!i.stroke&&(i.stroke=e.getVisual("style").fill),e.setVisual("legendLineStyle",i)}}),t.registerProcessor(t.PRIORITY.PROCESSOR.STATISTIC,fS("line"))},function(t){t.registerChartView(TS),t.registerSeriesModel(gS),t.registerLayout(t.PRIORITY.VISUAL.LAYOUT,V(U_,"bar")),t.registerLayout(t.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,G_),t.registerProcessor(t.PRIORITY.PROCESSOR.STATISTIC,fS("bar")),t.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},function(t,e){var i=t.componentType||"series";e.eachComponent({mainType:i,query:t},function(e){t.sortInfo&&e.axis.setCategorySortInfo(t.sortInfo)})})},function(t){t.registerChartView(JS),t.registerSeriesModel(eT),Um("pie",t.registerAction),t.registerLayout(V(WS,"pie")),t.registerProcessor(HS("pie")),t.registerProcessor(function(t){return{seriesType:t,reset:function(t,e){var i=t.getData();i.filterSelf(function(t){var e=i.mapDimension("value"),n=i.get(e,t);return!("number"==typeof n&&!isNaN(n)&&n<0)})}}}("pie"))},function(t){Rv(tM),t.registerSeriesModel(iT),t.registerChartView(aT),t.registerLayout(hS("scatter"))},function(t){Rv(fM),t.registerChartView(oM),t.registerSeriesModel(aM),t.registerLayout(eM),t.registerProcessor(HS("radar")),t.registerPreprocessor(rM)},function(t){Rv(tI),t.registerChartView(NM),t.registerSeriesModel(FM),t.registerLayout(UM),t.registerProcessor(t.PRIORITY.PROCESSOR.STATISTIC,VM),Um("map",t.registerAction)},function(t){t.registerChartView(pI),t.registerSeriesModel(zI),t.registerLayout(RI),t.registerVisual(BI),function(t){t.registerAction({type:"treeExpandAndCollapse",event:"treeExpandAndCollapse",update:"update"},function(t,e){e.eachComponent({mainType:"series",subType:"tree",query:t},function(e){var i=t.dataIndex,n=e.getData().tree.getNodeByDataIndex(i);n.isExpand=!n.isExpand})}),t.registerAction({type:"treeRoam",event:"treeRoam",update:"none"},function(t,e){e.eachComponent({mainType:"series",subType:"tree",query:t},function(e){var i=JM(e.coordinateSystem,t);e.setCenter&&e.setCenter(i.center),e.setZoom&&e.setZoom(i.zoom)})})}(t)},function(t){t.registerSeriesModel(UI),t.registerChartView(tC),t.registerVisual(yC),t.registerLayout(DC),function(t){for(var e=0;e<FI.length;e++)t.registerAction({type:FI[e],update:"updateView"},NI);t.registerAction({type:"treemapRootToNode",update:"updateView"},function(t,e){e.eachComponent({mainType:"series",subType:"treemap",query:t},function(e,i){var n=DI(t,["treemapZoomToNode","treemapRootToNode"],e);if(n){var r=e.getViewRoot();r&&(t.direction=PI(r,n.node)?"rollUp":"drillDown"),e.resetViewRoot(n.node)}})})}(t)},function(t){t.registerChartView(kA),t.registerSeriesModel(RA),t.registerProcessor(RC),t.registerVisual(BC),t.registerVisual(FC),t.registerLayout(XC),t.registerLayout(t.PRIORITY.VISUAL.POST_CHART_LAYOUT,iA),t.registerLayout(rA),t.registerCoordinateSystem("graphView",{dimensions:$M.dimensions,create:oA}),t.registerAction({type:"focusNodeAdjacency",event:"focusNodeAdjacency",update:"series:focusNodeAdjacency"},function(){}),t.registerAction({type:"unfocusNodeAdjacency",event:"unfocusNodeAdjacency",update:"series:unfocusNodeAdjacency"},function(){}),t.registerAction(BA,function(t,e){e.eachComponent({mainType:"series",query:t},function(e){var i=JM(e.coordinateSystem,t);e.setCenter&&e.setCenter(i.center),e.setZoom&&e.setZoom(i.zoom)})})},function(t){t.registerChartView(GA),t.registerSeriesModel($A)},function(t){t.registerChartView(jA),t.registerSeriesModel(ZA),t.registerLayout(qA),t.registerProcessor(HS("funnel"))},function(t){Rv(xD),t.registerChartView(XA),t.registerSeriesModel(tk),t.registerVisual(t.PRIORITY.VISUAL.BRUSH,nk)},function(t){t.registerChartView(SD),t.registerSeriesModel(TD),t.registerLayout(MD),t.registerVisual(BD),t.registerAction({type:"dragNode",event:"dragnode",update:"update"},function(t,e){e.eachComponent({mainType:"series",subType:"sankey",query:t},function(e){e.setNodePosition(t.dataIndex,[t.localX,t.localY])})})},function(t){t.registerSeriesModel(FD),t.registerChartView(VD),t.registerVisual(jD),t.registerLayout(qD),t.registerTransform(XD)},function(t){t.registerChartView(KD),t.registerSeriesModel(lE),t.registerPreprocessor(uE),t.registerVisual(fE),t.registerLayout(gE)},function(t){t.registerChartView(xE),t.registerSeriesModel(bE),t.registerLayout(hS("effectScatter"))},function(t){t.registerChartView(kE),t.registerSeriesModel(LE),t.registerLayout(AE),t.registerVisual(OE)},function(t){t.registerChartView(NE),t.registerSeriesModel(FE)},function(t){t.registerChartView($E),t.registerSeriesModel(sP),t.registerLayout(V(U_,"pictorialBar"))},function(t){t.registerChartView(lP),t.registerSeriesModel(uP),t.registerLayout(cP),t.registerProcessor(HS("themeRiver"))},function(t){t.registerChartView(mP),t.registerSeriesModel(gP),t.registerLayout(V(_P,"sunburst")),t.registerProcessor(V(HS,"sunburst")),t.registerVisual(bP),function(t){t.registerAction({type:dP,update:"updateView"},function(t,e){e.eachComponent({mainType:"series",subType:"sunburst",query:t},function(e,i){var n=DI(t,[dP],e);if(n){var r=e.getViewRoot();r&&(t.direction=PI(r,n.node)?"rollUp":"drillDown"),e.resetViewRoot(n.node)}})}),t.registerAction({type:fP,update:"none"},function(t,e,i){t=I({},t),e.eachComponent({mainType:"series",subType:"sunburst",query:t},function(e){var i=DI(t,[fP],e);i&&(t.dataIndex=i.node.dataIndex)}),i.dispatchAction(I(t,{type:"highlight"}))}),t.registerAction({type:"sunburstUnhighlight",update:"updateView"},function(t,e,i){t=I({},t),i.dispatchAction(I(t,{type:"downplay"}))})}(t)},function(t){t.registerChartView(eL),t.registerSeriesModel(IP)}]),Rv(function(t){Rv(tM),Rv(oz)}),Rv(function(t){Rv(oz),GT.registerAxisPointerClass("PolarAxisPointer",az),t.registerCoordinateSystem("polar",xz),t.registerComponentModel(lz),t.registerComponentView(Rz),fT(t,"angle",cz,zz),fT(t,"radius",hz,Oz),t.registerComponentView(Mz),t.registerComponentView(kz),t.registerLayout(V(Lz,"bar"))}),Rv(tI),Rv(function(t){Rv(oz),GT.registerAxisPointerClass("SingleAxisPointer",Yz),t.registerComponentView(tO),t.registerComponentView(Vz),t.registerComponentModel(Gz),fT(t,"single",Gz,Gz.defaultOption),t.registerCoordinateSystem("single",Zz)}),Rv(xD),Rv(function(t){t.registerComponentModel(eO),t.registerComponentView(nO),t.registerCoordinateSystem("calendar",oO)}),Rv(function(t){t.registerComponentModel(cO),t.registerComponentView(hO),t.registerPreprocessor(uO)}),Rv(function(t){t.registerComponentModel(BO),t.registerComponentView(FO),OO("saveAsImage",VO),OO("magicType",$O),OO("dataView",YO),OO("dataZoom",vR),OO("restore",eR),Rv(PO)}),Rv(function(t){Rv(oz),t.registerComponentModel(bR),t.registerComponentView(UR),t.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},function(){}),t.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},function(){})}),Rv(oz),Rv(function(t){t.registerComponentView(uB),t.registerComponentModel(cB),t.registerPreprocessor(jR),t.registerVisual(t.PRIORITY.VISUAL.BRUSH,rB),t.registerAction({type:"brush",event:"brush",update:"updateVisual"},function(t,e){e.eachComponent({mainType:"brush",query:t},function(e){e.setAreas(t.areas)})}),t.registerAction({type:"brushSelect",event:"brushSelected",update:"none"},function(){}),t.registerAction({type:"brushEnd",event:"brushEnd",update:"none"},function(){}),OO("brush",dB)}),Rv(function(t){t.registerComponentModel(fB),t.registerComponentView(mB)}),Rv(function(t){t.registerComponentModel(yB),t.registerComponentView(wB),t.registerSubTypeDefaulter("timeline",function(){return"slider"}),function(t){t.registerAction({type:"timelineChange",event:"timelineChanged",update:"prepareAndUpdate"},function(t,e,i){var n=e.getComponent("timeline");return n&&null!=t.currentIndex&&(n.setCurrentIndex(t.currentIndex),!n.get("loop",!0)&&n.isIndexMax()&&n.getPlayState()&&(n.setPlayState(!1),i.dispatchAction({type:"timelinePlayChange",playState:!1,from:t.from}))),e.resetOption("timeline",{replaceMerge:n.get("replaceMerge",!0)}),C({currentIndex:n.option.currentIndex},t)}),t.registerAction({type:"timelinePlayChange",event:"timelinePlayChanged",update:"update"},function(t,e){var i=e.getComponent("timeline");i&&null!=t.playState&&i.setPlayState(t.playState)})}(t),t.registerPreprocessor(MB)}),Rv(function(t){t.registerComponentModel(PB),t.registerComponentView($B),t.registerPreprocessor(function(t){AB(t.series,"markPoint")&&(t.markPoint=t.markPoint||{})})}),Rv(function(t){t.registerComponentModel(WB),t.registerComponentView(KB),t.registerPreprocessor(function(t){AB(t.series,"markLine")&&(t.markLine=t.markLine||{})})}),Rv(function(t){t.registerComponentModel(JB),t.registerComponentView(aN),t.registerPreprocessor(function(t){AB(t.series,"markArea")&&(t.markArea=t.markArea||{})})}),Rv(function(t){Rv(vN),Rv(MN)}),Rv(function(t){Rv(BN),Rv(jN)}),Rv(BN),Rv(jN),Rv(function(t){Rv(IF),Rv(EF)}),Rv(IF),Rv(EF),Rv(function(t){t.registerPreprocessor(RF),t.registerVisual(t.PRIORITY.VISUAL.ARIA,OF)}),Rv(function(t){t.registerTransform(qF),t.registerTransform(XF)}),Rv(function(t){t.registerComponentModel(YF),t.registerComponentView(KF)}),Rv(function(t){t.registerUpdateLifecycle("series:beforeupdate",function(t,e,i){L(wr(i.seriesTransition),function(t){L(wr(t.to),function(t){for(var e=i.updatedSeries,n=0;n<e.length;n++)(null!=t.seriesIndex&&t.seriesIndex===e[n].seriesIndex||null!=t.seriesId&&t.seriesId===e[n].id)&&(e[n].__universalTransitionEnabled=!0)})})}),t.registerUpdateLifecycle("series:transition",function(t,e,i){var n=PV(e);if(n.oldSeries&&i.updatedSeries&&i.optionChanged){var r=i.seriesTransition;if(r)L(wr(r),function(t){!function(t,e,i,n){var r=[],o=[];L(wr(t.from),function(t){var i=GV(e.oldSeries,t);i>=0&&r.push({data:e.oldData[i],divide:UV(e.oldData[i]),dim:t.dimension})}),L(wr(t.to),function(t){var e=GV(i.updatedSeries,t);if(e>=0){var n=i.updatedSeries[e].getData();o.push({data:n,divide:UV(n),dim:t.dimension})}}),r.length>0&&o.length>0&&NV(r,o,n)}(t,n,i,e)});else{var o=function(t,e){var i=ht(),n=ht(),r=ht();return L(t.oldSeries,function(e,i){var o=t.oldData[i],a=FV(e),s=VV(a);n.set(s,o),U(a)&&L(a,function(t){r.set(t,{data:o,key:s})})}),L(e.updatedSeries,function(t){if(t.isUniversalTransitionEnabled()&&t.isAnimationEnabled()){var e=t.getData(),o=FV(t),a=VV(o),s=n.get(a);if(s)i.set(a,{oldSeries:[{divide:UV(s),data:s}],newSeries:[{divide:UV(e),data:e}]});else if(U(o)){var l=[];L(o,function(t){var e=n.get(t);e&&l.push({divide:UV(e),data:e})}),l.length&&i.set(a,{oldSeries:l,newSeries:[{data:e,divide:UV(e)}]})}else{var u=r.get(o);if(u){var c=i.get(u.key);c||(c={oldSeries:[{data:u.data,divide:UV(u.data)}],newSeries:[]},i.set(u.key,c)),c.newSeries.push({data:e,divide:UV(e)})}}}}),i}(n,i);L(o.keys(),function(t){var i=o.get(t);NV(i.oldSeries,i.newSeries,e)})}L(i.updatedSeries,function(t){t.__universalTransitionEnabled&&(t.__universalTransitionEnabled=!1)})}for(var a=t.getSeries(),s=n.oldSeries=[],l=n.oldData=[],u=0;u<a.length;u++){var c=a[u].getData();c.count()<1e4&&(s.push(a[u]),l.push(c))}})}),Rv(function(t){t.registerUpdateLifecycle("series:beforeupdate",function(t,e,i){var n=Ab(e).labelManager;n||(n=Ab(e).labelManager=new Cb),n.clearLabels()}),t.registerUpdateLifecycle("series:layoutlabels",function(t,e,i){var n=Ab(e).labelManager;i.updatedSeries.forEach(function(t){n.addLabelsOfSeries(e.getViewOfSeriesModel(t))}),n.updateLayoutConfig(e),n.layout(e),n.processLabelsOverall()})}),t.Axis=$x,t.ChartView=Zf,t.ComponentModel=ip,t.ComponentView=$f,t.List=u_,t.Model=$c,t.PRIORITY=Cy,t.SeriesModel=Of,t.color=ei,t.connect=function(t){if(U(t)){var e=t;t=null,L(e,function(e){null!=e.group&&(t=e.group)}),t=t||"g_"+fv++,L(e,function(e){e.group=t})}return pv[t]=!0,t},t.dataTool={},t.dependencies={zrender:"5.2.1"},t.disConnect=gv,t.disconnect=yv,t.dispose=function(t){"string"==typeof t?t=hv[t]:t instanceof tv||(t=vv(t)),t instanceof tv&&!t.isDisposed()&&t.dispose()},t.env=a,t.extendChartView=function(t){var e=Zf.extend(t);return Zf.registerClass(e),e},t.extendComponentModel=function(t){var e=ip.extend(t);return ip.registerClass(e),e},t.extendComponentView=function(t){var e=$f.extend(t);return $f.registerClass(e),e},t.extendSeriesModel=function(t){var e=Of.extend(t);return Of.registerClass(e),e},t.format=Ex,t.getCoordinateSystemDimensions=function(t){var e=Vp.get(t);if(e)return e.getDimensionsInfo?e.getDimensionsInfo():e.dimensions.slice()},t.getInstanceByDom=vv,t.getInstanceById=function(t){return hv[t]},t.getMap=function(t){return by(t)},t.graphic=Dx,t.helper=Cx,t.init=function(t,e,i){var n=vv(t);if(n)return n;var r=new tv(t,e,i);return r.id="ec_"+dv++,hv[r.id]=r,Ur(t,mv,r.id),Xy(r),Sy.trigger("afterinit",r),r},t.innerDrawElementOnCanvas=bg,t.matrix=Xi,t.number=Ax,t.parseGeoJSON=sy,t.parseGeoJson=sy,t.registerAction=Mv,t.registerCoordinateSystem=Iv,t.registerLayout=Cv,t.registerLoading=Ev,t.registerLocale=Qc,t.registerMap=Pv,t.registerPostInit=wv,t.registerPostUpdate=Sv,t.registerPreprocessor=xv,t.registerProcessor=bv,t.registerTheme=_v,t.registerTransform=Lv,t.registerUpdateLifecycle=Tv,t.registerVisual=Av,t.setCanvasCreator=function(t){_("createCanvas",t)},t.throttle=im,t.time=kx,t.use=Rv,t.util=Px,t.vector=Nt,t.version="5.2.2",t.zrUtil=gt,t.zrender=jn,Object.defineProperty(t,"__esModule",{value:!0})}),function(t,e){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",e):"object"==typeof module&&module.exports?module.exports=e():t.EvEmitter=e()}("undefined"!=typeof window?window:this,function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return-1==n.indexOf(e)&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{},n;return(i[t]=i[t]||{})[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return-1!=n&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){i=i.slice(0),e=e||[];for(var n=this._onceEvents&&this._onceEvents[t],r=0;r<i.length;r++){var o=i[r],a;n&&n[o]&&(this.off(t,o),delete n[o]),o.apply(this,e)}return this}},e.allOff=function(){delete this._events,delete this._onceEvents},t}),function(t,e){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter")):t.imagesLoaded=e(t,t.EvEmitter)}("undefined"!=typeof window?window:this,function(t,e){function i(t,e){for(var i in e)t[i]=e[i];return t}function n(t){return Array.isArray(t)?t:"object"==typeof t&&"number"==typeof t.length?u.call(t):[t];var e}function r(t,e,o){if(!(this instanceof r))return new r(t,e,o);var a=t;return"string"==typeof t&&(a=document.querySelectorAll(t)),a?(this.elements=n(a),this.options=i({},this.options),"function"==typeof e?o=e:i(this.options,e),o&&this.on("always",o),this.getImages(),s&&(this.jqDeferred=new s.Deferred),void setTimeout(this.check.bind(this))):void l.error("Bad element for imagesLoaded "+(a||t))}function o(t){this.img=t}function a(t,e){this.url=t,this.element=e,this.img=new Image}var s=t.jQuery,l=t.console,u=Array.prototype.slice;r.prototype=Object.create(e.prototype),r.prototype.options={},r.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},r.prototype.addElementImages=function(t){"IMG"==t.nodeName&&this.addImage(t),!0===this.options.background&&this.addElementBackgroundImages(t);var e=t.nodeType;if(e&&c[e]){for(var i=t.querySelectorAll("img"),n=0;n<i.length;n++){var r=i[n];this.addImage(r)}if("string"==typeof this.options.background){var o=t.querySelectorAll(this.options.background);for(n=0;n<o.length;n++){var a=o[n];this.addElementBackgroundImages(a)}}}};var c={1:!0,9:!0,11:!0};return r.prototype.addElementBackgroundImages=function(t){var e=getComputedStyle(t);if(e)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(e.backgroundImage);null!==n;){var r=n&&n[2];r&&this.addBackground(r,t),n=i.exec(e.backgroundImage)}},r.prototype.addImage=function(t){var e=new o(t);this.images.push(e)},r.prototype.addBackground=function(t,e){var i=new a(t,e);this.images.push(i)},r.prototype.check=function(){function t(t,i,n){setTimeout(function(){e.progress(t,i,n)})}var e=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(e){e.once("progress",t),e.check()}):void this.complete()},r.prototype.progress=function(t,e,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded,this.emitEvent("progress",[this,t,e]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,t),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&l&&l.log("progress: "+i,t,e)},r.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(t,[this]),this.emitEvent("always",[this]),this.jqDeferred){var e=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[e](this)}},o.prototype=Object.create(e.prototype),o.prototype.check=function(){var t;return this.getIsImageComplete()?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},o.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},o.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.img,e])},o.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},o.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},o.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},o.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},a.prototype=Object.create(o.prototype),a.prototype.check=function(){var t;this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url,this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},a.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},a.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.element,e])},r.makeJQueryPlugin=function(e){(e=e||t.jQuery)&&((s=e).fn.imagesLoaded=function(t,e){var i;return new r(this,t,e).jqDeferred.promise(s(this))})},r.makeJQueryPlugin(),r}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).mapboxgl=e()}(this,function(){"use strict";var t,e,i,n;function r(n,r){if(t)if(e){var o="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/api/#transpiling-v2'); }; var sharedChunk = {}; ("+t+")(sharedChunk); ("+e+")(sharedChunk); self.onerror = null;",a={};t(a),i=r(a),"undefined"!=typeof window&&(i.workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"})))}else e=r;else t=r}return r(["exports"],function(t){var e="2.3.1",i=n;function n(t,e,i,n){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=i,this.p2y=n}n.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},n.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},n.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},n.prototype.solveCurveX=function(t,e){var i,n,r,o,a;for(void 0===e&&(e=1e-6),r=t,a=0;a<8;a++){if(o=this.sampleCurveX(r)-t,Math.abs(o)<e)return r;var s=this.sampleCurveDerivativeX(r);if(Math.abs(s)<1e-6)break;r-=o/s}if((r=t)<(i=0))return i;if(r>(n=1))return n;for(;i<n;){if(o=this.sampleCurveX(r),Math.abs(o-t)<e)return r;t>o?i=r:n=r,r=.5*(n-i)+i}return r},n.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var r=o;function o(t,e){this.x=t,this.y=e}o.prototype={clone:function(){return new o(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=n,this},_rotateAround:function(t,e){var i=Math.cos(t),n=Math.sin(t),r=e.y+n*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-n*(this.y-e.y),this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(t){return t instanceof o?t:Array.isArray(t)?new o(t[0],t[1]):t};var a="undefined"!=typeof self?self:{};const s=9007199254740991,l=Math.PI/180,u=180/Math.PI;function c(t){return t*l}const h=[[0,0],[1,0],[1,1],[0,1]];function p(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,i=e*t;return 4*(t<.5?i:3*(t-e)+i-.75)}function d(t,e,n,r){const o=new i(t,e,n,r);return function(t){return o.solve(t)}}const f=d(.25,.1,.25,1);function m(t,e,i){return Math.min(i,Math.max(e,t))}function g(t,e,i){const n=i-e,r=((t-e)%n+n)%n+e;return r===e?i:r}function y(t,e,i){if(!t.length)return i(null,[]);let n=t.length;const r=Array(t.length);let o=null;t.forEach((t,a)=>{e(t,(t,e)=>{t&&(o=t),r[a]=e,0==--n&&i(o,r)})})}function v(t){const e=[];for(const i in t)e.push(t[i]);return e}function _(t,...e){for(const i of e)for(const e in i)t[e]=i[e];return t}let x=1;function b(){return x++}function w(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function S(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function T(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function M(t,e){t.forEach(t=>{e[t]&&(e[t]=e[t].bind(e))})}function I(t,e){return-1!==t.indexOf(e,t.length-e.length)}function C(t,e,i){const n={};for(const r in t)n[r]=e.call(i||this,t[r],r,t);return n}function A(t,e,i){const n={};for(const r in t)e.call(i||this,t[r],r,t)&&(n[r]=t[r]);return n}function k(t){return Array.isArray(t)?t.map(k):"object"==typeof t&&t?C(t,k):t}const D={};function E(t){D[t]||(void 0!==console&&console.warn(t),D[t]=!0)}function P(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}function L(t){let e=0;for(let i,n,r=0,o=t.length,a=o-1;r<o;a=r++)i=t[r],e+=((n=t[a]).x-i.x)*(i.y+n.y);return e}function z(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function O(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(t,i,n,r)=>{const o=n||r;return e[i]=!o||o.toLowerCase(),""}),e["max-age"]){const t=parseInt(e["max-age"],10);isNaN(t)?delete e["max-age"]:e["max-age"]=t}return e}let R,B,N,F=null;function V(t){if(null==F){const e=t.navigator?t.navigator.userAgent:null;F=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return F}function U(t){try{const e=a[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch(t){return!1}}const G={now:()=>void 0!==N?N:a.performance.now(),setNow(t){N=t},restoreNow(){N=void 0},frame(t){const e=a.requestAnimationFrame(t);return{cancel:()=>a.cancelAnimationFrame(e)}},getImageData(t,e=0){const i=a.document.createElement("canvas"),n=i.getContext("2d");if(!n)throw Error("failed to create canvas 2d context");return i.width=t.width,i.height=t.height,n.drawImage(t,0,0,t.width,t.height),n.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:t=>(R||(R=a.document.createElement("a")),R.href=t,R.href),get devicePixelRatio(){return a.devicePixelRatio},get prefersReducedMotion(){return!!a.matchMedia&&(null==B&&(B=a.matchMedia("(prefers-reduced-motion: reduce)")),B.matches)}};let $;const W={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==$){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{$=null!=process.env.API_URL_REGEX?RegExp(process.env.API_URL_REGEX):t}catch(e){$=t}}return $},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},H={supported:!1,testSupport:function(t){!q&&Z&&(X?Y(t):j=t)}};let j,Z,q=!1,X=!1;function Y(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,Z),t.isContextLost())return;H.supported=!0}catch(t){}t.deleteTexture(e),q=!0}a.document&&((Z=a.document.createElement("img")).onload=function(){j&&Y(j),j=null,X=!0},Z.onerror=function(){q=!0,j=null},Z.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const K="01",J="NO_ACCESS_TOKEN";function Q(t){return 0===t.indexOf("mapbox:")}function tt(t){return W.API_URL_REGEX.test(t)}const et=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function it(t){const e=t.match(et);if(!e)throw Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function nt(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}function rt(t){if(!t)return null;const e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(a.atob(e[1]).split("").map(t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch(t){return null}}class ot{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const e=rt(W.ACCESS_TOKEN);let i="";return i=e&&e.u?a.btoa(encodeURIComponent(e.u).replace(/%([0-9A-F]{2})/g,(t,e)=>String.fromCharCode(+("0x"+e)))):W.ACCESS_TOKEN||"",t?`mapbox.eventData.${t}:${i}`:`mapbox.eventData:${i}`}fetchEventData(){const t=U("localStorage"),e=this.getStorageKey(),i=this.getStorageKey("uuid");if(t)try{const n=a.localStorage.getItem(e);n&&(this.eventData=JSON.parse(n));const r=a.localStorage.getItem(i);r&&(this.anonId=r)}catch(t){E("Unable to read from LocalStorage")}}saveEventData(){const t=U("localStorage"),e=this.getStorageKey(),i=this.getStorageKey("uuid");if(t)try{a.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&a.localStorage.setItem(e,JSON.stringify(this.eventData))}catch(t){E("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,i,n,r){if(!W.EVENTS_URL)return;const o=it(W.EVENTS_URL);o.params.push(`access_token=${r||W.ACCESS_TOKEN||""}`);const a={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:e,skuId:K,userId:this.anonId},s=i?_(a,i):a,l={url:nt(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([s])};this.pendingRequest=It(l,t=>{this.pendingRequest=null,n(t),this.saveEventData(),this.processRequests(r)})}queueRequest(t,e){this.queue.push(t),this.processRequests(e)}}const at=new class extends ot{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){W.EVENTS_URL&&W.ACCESS_TOKEN&&Array.isArray(t)&&t.some(t=>Q(t)||tt(t))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=rt(W.ACCESS_TOKEN),i=e?e.u:W.ACCESS_TOKEN;let n=i!==this.eventData.tokenU;T(this.anonId)||(this.anonId=w(),n=!0);const r=this.queue.shift();if(this.eventData.lastSuccess){const t=new Date(this.eventData.lastSuccess),e=new Date(r),i=(r-this.eventData.lastSuccess)/864e5;n=n||i>=1||i<-1||t.getDate()!==e.getDate()}else n=!0;if(!n)return this.processRequests();this.postEvent(r,{"enabled.telemetry":!1},t=>{t||(this.eventData.lastSuccess=r,this.eventData.tokenU=i)},t)}},st=at.postTurnstileEvent.bind(at),lt=new class extends ot{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,i,n){this.skuToken=e,this.errorCb=n,W.EVENTS_URL&&(i||W.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},i):this.errorCb(Error(J)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),T(this.anonId)||(this.anonId=w()),this.postEvent(i,{skuToken:this.skuToken},t=>{t?this.errorCb(t):e&&(this.success[e]=!0)},t))}},ut=lt.postMapLoadEvent.bind(lt),ct=new class extends ot{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,i,n){if(!W.API_URL||!W.SESSION_PATH)return;const r=it(W.API_URL+W.SESSION_PATH);r.params.push(`sku=${e||""}`),r.params.push(`access_token=${n||W.ACCESS_TOKEN||""}`);const o={url:nt(r),headers:{"Content-Type":"text/plain"}};this.pendingRequest=Ct(o,t=>{this.pendingRequest=null,i(t),this.saveEventData(),this.processRequests(n)})}getSessionAPI(t,e,i,n){this.skuToken=e,this.errorCb=n,W.SESSION_PATH&&W.API_URL&&(i||W.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},i):this.errorCb(Error(J)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||this.getSession(i,this.skuToken,t=>{t?this.errorCb(t):e&&(this.success[e]=!0)},t)}},ht=ct.getSessionAPI.bind(ct),pt=new Set,dt="mapbox-tiles";let ft,mt,gt=500,yt=50;function vt(){a.caches&&!ft&&(ft=a.caches.open(dt))}function _t(t){const e=t.indexOf("?");return e<0?t:t.slice(0,e)}let xt=1/0;const bt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(bt);class wt extends Error{constructor(t,e,i){401===e&&tt(i)&&(t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(t),this.status=e,this.url=i}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const St=z()?()=>self.worker&&self.worker.referrer:()=>("blob:"===a.location.protocol?a.parent:a).location.href,Tt=function(t,e){if(!(/^file:/.test(i=t.url)||/^file:/.test(St())&&!/^\w+:/.test(i))){if(a.fetch&&a.Request&&a.AbortController&&a.Request.prototype.hasOwnProperty("signal"))return function(t,e){const i=new a.AbortController,n=new a.Request(t.url,{method:t.method||"GET",body:t.body,credentials:t.credentials,headers:t.headers,referrer:St(),signal:i.signal});let r=!1,o=!1;const s=(l=n.url).indexOf("sku=")>0&&tt(l);var l;"json"===t.type&&n.headers.set("Accept","application/json");const u=(i,r,l)=>{if(o)return;if(i&&"SecurityError"!==i.message&&E(i),r&&l)return c(r);const u=Date.now();a.fetch(n).then(i=>{if(i.ok){const t=s?i.clone():null;return c(i,t,u)}return e(new wt(i.statusText,i.status,t.url))}).catch(t=>{20!==t.code&&e(Error(t.message))})},c=(i,s,l)=>{("arrayBuffer"===t.type?i.arrayBuffer():"json"===t.type?i.json():i.text()).then(t=>{o||(s&&l&&function(t,e,i){if(vt(),!ft)return;const n={status:e.status,statusText:e.statusText,headers:new a.Headers};e.headers.forEach((t,e)=>n.headers.set(e,t));const r=O(e.headers.get("Cache-Control")||"");r["no-store"]||(r["max-age"]&&n.headers.set("Expires",new Date(i+1e3*r["max-age"]).toUTCString()),new Date(n.headers.get("Expires")).getTime()-i<42e4||function(t,e){if(void 0===mt)try{new Response(new ReadableStream),mt=!0}catch(t){mt=!1}mt?e(t.body):t.blob().then(e)}(e,e=>{const i=new a.Response(e,n);vt(),ft&&ft.then(e=>e.put(_t(t.url),i)).catch(t=>E(t.message))}))}(n,s,l),r=!0,e(null,t,i.headers.get("Cache-Control"),i.headers.get("Expires")))}).catch(t=>{o||e(Error(t.message))})};return s?function(t,e){if(vt(),!ft)return e(null);const i=_t(t.url);ft.then(t=>{t.match(i).then(n=>{const r=function(t){if(!t)return!1;const e=new Date(t.headers.get("Expires")||0),i=O(t.headers.get("Cache-Control")||"");return e>Date.now()&&!i["no-cache"]}(n);t.delete(i),r&&t.put(i,n.clone()),e(null,n,r)}).catch(e)}).catch(e)}(n,u):u(null,null),{cancel:()=>{o=!0,r||i.abort()}}}(t,e);if(z()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var i;return function(t,e){const i=new a.XMLHttpRequest;i.open(t.method||"GET",t.url,!0),"arrayBuffer"===t.type&&(i.responseType="arraybuffer");for(const e in t.headers)i.setRequestHeader(e,t.headers[e]);return"json"===t.type&&(i.responseType="text",i.setRequestHeader("Accept","application/json")),i.withCredentials="include"===t.credentials,i.onerror=(()=>{e(Error(i.statusText))}),i.onload=(()=>{if((i.status>=200&&i.status<300||0===i.status)&&null!==i.response){let n=i.response;if("json"===t.type)try{n=JSON.parse(i.response)}catch(t){return e(t)}e(null,n,i.getResponseHeader("Cache-Control"),i.getResponseHeader("Expires"))}else e(new wt(i.statusText,i.status,t.url))}),i.send(t.body),{cancel:()=>i.abort()}}(t,e)},Mt=function(t,e){return Tt(_(t,{type:"arrayBuffer"}),e)},It=function(t,e){return Tt(_(t,{method:"POST"}),e)},Ct=function(t,e){return Tt(_(t,{method:"GET"}),e)};function At(t){const e=a.document.createElement("a");return e.href=t,e.protocol===a.document.location.protocol&&e.host===a.document.location.host}const kt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Dt,Et;Dt=[],Et=0;const Pt=function(t,e){if(H.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Et>=W.MAX_PARALLEL_IMAGE_REQUESTS){const i={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Dt.push(i),i}Et++;let i=!1;const n=()=>{if(!i)for(i=!0,Et--;Dt.length&&Et<W.MAX_PARALLEL_IMAGE_REQUESTS;){const t=Dt.shift(),{requestParameters:e,callback:i,cancelled:n}=t;n||(t.cancel=Pt(e,i).cancel)}},r=Mt(t,(t,i,r,o)=>{n(),t?e(t):i&&(a.createImageBitmap?function(t,e){const i=new a.Blob([new Uint8Array(t)],{type:"image/png"});a.createImageBitmap(i).then(t=>{e(null,t)}).catch(t=>{e(Error(`Could not load image because of ${t.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(i,(t,i)=>e(t,i,r,o)):function(t,e){const i=new a.Image,n=a.URL;i.onload=(()=>{e(null,i),n.revokeObjectURL(i.src),i.onload=null,a.requestAnimationFrame(()=>{i.src=kt})}),i.onerror=(()=>e(Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")));const r=new a.Blob([new Uint8Array(t)],{type:"image/png"});i.src=t.byteLength?n.createObjectURL(r):kt}(i,(t,i)=>e(t,i,r,o)))});return{cancel:()=>{r.cancel(),n()}}};function Lt(t,e,i){i[t]&&-1!==i[t].indexOf(e)||(i[t]=i[t]||[],i[t].push(e))}function zt(t,e,i){if(i&&i[t]){const n=i[t].indexOf(e);-1!==n&&i[t].splice(n,1)}}class Ot{constructor(t,e={}){_(this,e),this.type=t}}class Rt extends Ot{constructor(t,e={}){super("error",_({error:t},e))}}class Bt{on(t,e){return this._listeners=this._listeners||{},Lt(t,e,this._listeners),this}off(t,e){return zt(t,e,this._listeners),zt(t,e,this._oneTimeListeners),this}once(t,e){return e?(this._oneTimeListeners=this._oneTimeListeners||{},Lt(t,e,this._oneTimeListeners),this):new Promise(e=>this.once(t,e))}fire(t,e){"string"==typeof t&&(t=new Ot(t,e||{}));const i=t.type;if(this.listens(i)){t.target=this;const e=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];for(const i of e)i.call(this,t);const n=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];for(const e of n)zt(i,e,this._oneTimeListeners),e.call(this,t);const r=this._eventedParent;r&&(_(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),r.fire(t))}else t instanceof Rt&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,e){return this._eventedParent=t,this._eventedParentData=e,this}}var Nt={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.1,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class Ft{constructor(t,e,i,n){this.message=(t?`${t}: `:"")+i,n&&(this.identifier=n),null!=e&&e.__line__&&(this.line=e.__line__)}}function Vt(t){const e=t.value;return e?[new Ft(t.key,e,"constants have been deprecated as of v8")]:[]}function Ut(t,...e){for(const i of e)for(const e in i)t[e]=i[e];return t}function Gt(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function $t(t){if(Array.isArray(t))return t.map($t);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const i in t)e[i]=$t(t[i]);return e}return Gt(t)}class Wt extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}class Ht{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[t,i]of e)this.bindings[t]=i}concat(t){return new Ht(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const jt={kind:"null"},Zt={kind:"number"},qt={kind:"string"},Xt={kind:"boolean"},Yt={kind:"color"},Kt={kind:"object"},Jt={kind:"value"},Qt={kind:"collator"},te={kind:"formatted"},ee={kind:"resolvedImage"};function ie(t,e){return{kind:"array",itemType:t,N:e}}function ne(t){if("array"===t.kind){const e=ne(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const re=[jt,Zt,qt,Xt,Yt,te,Kt,ie(Jt),ee];function oe(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!oe(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of re)if(!oe(t,e))return null}return`Expected ${ne(t)} but found ${ne(e)} instead.`}function ae(t,e){return e.some(e=>e.kind===t.kind)}function se(t,e){return e.some(e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t)}function le(t){var e={exports:{}};return t(e,e.exports),e.exports}var ue=le(function(t,e){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(t){return(t=Math.round(t))<0?0:t>255?255:t}function r(t){return n("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function o(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function a(t,e,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}try{e.parseCSSColor=function(t){var e,s=t.replace(/ /g,"").toLowerCase();if(s in i)return i[s].slice();if("#"===s[0])return 4===s.length?(e=parseInt(s.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===s.length&&(e=parseInt(s.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var l=s.indexOf("("),u=s.indexOf(")");if(-1!==l&&u+1===s.length){var c=s.substr(0,l),h=s.substr(l+1,u-(l+1)).split(","),p=1;switch(c){case"rgba":if(4!==h.length)return null;p=o(h.pop());case"rgb":return 3!==h.length?null:[r(h[0]),r(h[1]),r(h[2]),p];case"hsla":if(4!==h.length)return null;p=o(h.pop());case"hsl":if(3!==h.length)return null;var d=(parseFloat(h[0])%360+360)%360/360,f=o(h[1]),m=o(h[2]),g=m<=.5?m*(f+1):m+f-m*f,y=2*m-g;return[n(255*a(y,g,d+1/3)),n(255*a(y,g,d)),n(255*a(y,g,d-1/3)),p];default:return null}}return null}}catch(t){}});class ce{constructor(t,e,i,n=1){this.r=t,this.g=e,this.b=i,this.a=n}static parse(t){if(!t)return;if(t instanceof ce)return t;if("string"!=typeof t)return;const e=ue.parseCSSColor(t);return e?new ce(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3]):void 0}toString(){const[t,e,i,n]=this.toArray();return`rgba(${Math.round(t)},${Math.round(e)},${Math.round(i)},${n})`}toArray(){const{r:t,g:e,b:i,a:n}=this;return 0===n?[0,0,0,0]:[255*t/n,255*e/n,255*i/n,n]}}ce.black=new ce(0,0,0,1),ce.white=new ce(1,1,1,1),ce.transparent=new ce(0,0,0,0),ce.red=new ce(1,0,0,1),ce.blue=new ce(0,0,1,1);class he{constructor(t,e,i){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class pe{constructor(t,e,i,n,r){this.text=t,this.image=e,this.scale=i,this.fontStack=n,this.textColor=r}}class de{constructor(t){this.sections=t}static fromString(t){return new de([new pe(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(t=>0!==t.text.length||t.image&&0!==t.image.name.length)}static factory(t){return t instanceof de?t:de.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const e of this.sections){if(e.image){t.push(["image",e.image.name]);continue}t.push(e.text);const i={};e.fontStack&&(i["text-font"]=["literal",e.fontStack.split(",")]),e.scale&&(i["font-scale"]=e.scale),e.textColor&&(i["text-color"]=["rgba"].concat(e.textColor.toArray())),t.push(i)}return t}}class fe{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new fe({name:t,available:!1}):null}serialize(){return["image",this.name]}}function me(t,e,i,n){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:`Invalid rgba value [${[t,e,i,n].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof n?[t,e,i,n]:[t,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ge(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof ce)return!0;if(t instanceof he)return!0;if(t instanceof de)return!0;if(t instanceof fe)return!0;if(Array.isArray(t)){for(const e of t)if(!ge(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!ge(t[e]))return!1;return!0}return!1}function ye(t){if(null===t)return jt;if("string"==typeof t)return qt;if("boolean"==typeof t)return Xt;if("number"==typeof t)return Zt;if(t instanceof ce)return Yt;if(t instanceof he)return Qt;if(t instanceof de)return te;if(t instanceof fe)return ee;if(Array.isArray(t)){const e=t.length;let i;for(const e of t){const t=ye(e);if(i){if(i===t)continue;i=Jt;break}i=t}return ie(i||Jt,e)}return Kt}function ve(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?t+"":t instanceof ce||t instanceof de||t instanceof fe?t.toString():JSON.stringify(t)}class _e{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ge(t[1]))return e.error("invalid value");const i=t[1];let n=ye(i);const r=e.expectedType;return"array"!==n.kind||0!==n.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(n=r),new _e(n,i)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof ce?["rgba"].concat(this.value.toArray()):this.value instanceof de?this.value.serialize():this.value}}class xe{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const be={string:qt,number:Zt,boolean:Xt,object:Kt};class we{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let i,n=1;const r=t[0];if("array"===r){let r,o;if(t.length>2){const i=t[1];if("string"!=typeof i||!(i in be)||"object"===i)return e.error('The item type argument of "array" must be one of string, number, boolean',1);r=be[i],n++}else r=Jt;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);o=t[2],n++}i=ie(r,o)}else i=be[r];const o=[];for(;n<t.length;n++){const i=e.parse(t[n],n,Jt);if(!i)return null;o.push(i)}return new we(i,o)}evaluate(t){for(let e=0;e<this.args.length;e++){const i=this.args[e].evaluate(t);if(!oe(this.type,ye(i)))return i;if(e===this.args.length-1)throw new xe(`Expected value to be of type ${ne(this.type)}, but found ${ne(ye(i))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,e=[t.kind];if("array"===t.kind){const i=t.itemType;if("string"===i.kind||"number"===i.kind||"boolean"===i.kind){e.push(i.kind);const n=t.N;("number"==typeof n||this.args.length>1)&&e.push(n)}}return e.concat(this.args.map(t=>t.serialize()))}}class Se{constructor(t){this.type=te,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const i=t[1];if(!Array.isArray(i)&&"object"==typeof i)return e.error("First argument must be an image or text section.");const n=[];let r=!1;for(let i=1;i<=t.length-1;++i){const o=t[i];if(r&&"object"==typeof o&&!Array.isArray(o)){r=!1;let t=null;if(o["font-scale"]&&!(t=e.parse(o["font-scale"],1,Zt)))return null;let i=null;if(o["text-font"]&&!(i=e.parse(o["text-font"],1,ie(qt))))return null;let a=null;if(o["text-color"]&&!(a=e.parse(o["text-color"],1,Yt)))return null;const s=n[n.length-1];s.scale=t,s.font=i,s.textColor=a}else{const o=e.parse(t[i],1,Jt);if(!o)return null;const a=o.type.kind;if("string"!==a&&"value"!==a&&"null"!==a&&"resolvedImage"!==a)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,n.push({content:o,scale:null,font:null,textColor:null})}}return new Se(n)}evaluate(t){return new de(this.sections.map(e=>{const i=e.content.evaluate(t);return ye(i)===ee?new pe("",i,null,null,null):new pe(ve(i),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)}))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const e of this.sections){t.push(e.content.serialize());const i={};e.scale&&(i["font-scale"]=e.scale.serialize()),e.font&&(i["text-font"]=e.font.serialize()),e.textColor&&(i["text-color"]=e.textColor.serialize()),t.push(i)}return t}}class Te{constructor(t){this.type=ee,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const i=e.parse(t[1],1,qt);return i?new Te(i):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),i=fe.fromString(e);return i&&t.availableImages&&(i.available=t.availableImages.indexOf(e)>-1),i}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Me={"to-boolean":Xt,"to-color":Yt,"to-number":Zt,"to-string":qt};class Ie{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const i=t[0];if(("to-boolean"===i||"to-string"===i)&&2!==t.length)return e.error("Expected one argument.");const n=Me[i],r=[];for(let i=1;i<t.length;i++){const n=e.parse(t[i],i,Jt);if(!n)return null;r.push(n)}return new Ie(n,r)}evaluate(t){if("boolean"===this.type.kind)return!!this.args[0].evaluate(t);if("color"===this.type.kind){let e,i;for(const n of this.args){if(e=n.evaluate(t),i=null,e instanceof ce)return e;if("string"==typeof e){const i=t.parseColor(e);if(i)return i}else if(Array.isArray(e)&&!(i=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:me(e[0],e[1],e[2],e[3])))return new ce(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new xe(i||`Could not parse color from value '${"string"==typeof e?e:JSON.stringify(e)+""}'`)}if("number"===this.type.kind){let e=null;for(const i of this.args){if(null===(e=i.evaluate(t)))return 0;const n=+e;if(!isNaN(n))return n}throw new xe(`Could not convert ${JSON.stringify(e)} to number.`)}return"formatted"===this.type.kind?de.fromString(ve(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?fe.fromString(ve(this.args[0].evaluate(t))):ve(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Se([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Te(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild(e=>{t.push(e.serialize())}),t}}const Ce=["Unknown","Point","LineString","Polygon"];class Ae{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Ce[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=ce.parse(t)),e}}class ke{constructor(t,e,i,n){this.name=t,this.type=e,this._evaluate=i,this.args=n}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,e){const i=t[0],n=ke.definitions[i];if(!n)return e.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0);const r=Array.isArray(n)?n[0]:n.type,o=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,a=o.filter(([e])=>!Array.isArray(e)||e.length===t.length-1);let s=null;for(const[n,o]of a){s=new Je(e.registry,e.path,null,e.scope);const a=[];let l=!1;for(let e=1;e<t.length;e++){const i=t[e],r=Array.isArray(n)?n[e-1]:n.type,o=s.parse(i,1+a.length,r);if(!o){l=!0;break}a.push(o)}if(!l)if(Array.isArray(n)&&n.length!==a.length)s.error(`Expected ${n.length} arguments, but found ${a.length} instead.`);else{for(let t=0;t<a.length;t++){const e=Array.isArray(n)?n[t]:n.type,i=a[t];s.concat(t+1).checkSubtype(e,i.type)}if(0===s.errors.length)return new ke(i,r,o,a)}}if(1===a.length)e.errors.push(...s.errors);else{const i=(a.length?a:o).map(([t])=>{return Array.isArray(e=t)?`(${e.map(ne).join(", ")})`:`(${ne(e.type)}...)`;var e}).join(" | "),n=[];for(let i=1;i<t.length;i++){const r=e.parse(t[i],1+n.length);if(!r)return null;n.push(ne(r.type))}e.error(`Expected arguments of type ${i}, but found (${n.join(", ")}) instead.`)}return null}static register(t,e){ke.definitions=e;for(const i in e)t[i]=ke}}class De{constructor(t,e,i){this.type=Qt,this.locale=i,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const i=t[1];if("object"!=typeof i||Array.isArray(i))return e.error("Collator options argument must be an object.");const n=e.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,Xt);if(!n)return null;const r=e.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,Xt);if(!r)return null;let o=null;return i.locale&&!(o=e.parse(i.locale,1,qt))?null:new De(n,r,o)}evaluate(t){return new he(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const Ee=8192;function Pe(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Le(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function ze(t,e){const i=(180+t[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,r=Math.pow(2,e.z);return[Math.round(i*r*Ee),Math.round(n*r*Ee)]}function Oe(t,e,i){const n=t[0]-e[0],r=t[1]-e[1],o=t[0]-i[0],a=t[1]-i[1];return n*a-o*r==0&&n*o<=0&&r*a<=0}function Re(t,e){let i=!1;for(let a=0,s=e.length;a<s;a++){const s=e[a];for(let e=0,a=s.length;e<a-1;e++){if(Oe(t,s[e],s[e+1]))return!1;(r=s[e])[1]>(n=t)[1]!=(o=s[e+1])[1]>n[1]&&n[0]<(o[0]-r[0])*(n[1]-r[1])/(o[1]-r[1])+r[0]&&(i=!i)}}var n,r,o;return i}function Be(t,e){for(let i=0;i<e.length;i++)if(Re(t,e[i]))return!0;return!1}function Ne(t,e,i,n){const r=n[0]-i[0],o=n[1]-i[1],a=(t[0]-i[0])*o-r*(t[1]-i[1]),s=(e[0]-i[0])*o-r*(e[1]-i[1]);return a>0&&s<0||a<0&&s>0}function Fe(t,e,i){for(const u of i)for(let i=0;i<u.length-1;++i)if(0!=(s=[(a=u[i+1])[0]-(o=u[i])[0],a[1]-o[1]])[0]*(l=[(r=e)[0]-(n=t)[0],r[1]-n[1]])[1]-s[1]*l[0]&&Ne(n,r,o,a)&&Ne(o,a,n,r))return!0;var n,r,o,a,s,l;return!1}function Ve(t,e){for(let i=0;i<t.length;++i)if(!Re(t[i],e))return!1;for(let i=0;i<t.length-1;++i)if(Fe(t[i],t[i+1],e))return!1;return!0}function Ue(t,e){for(let i=0;i<e.length;i++)if(Ve(t,e[i]))return!0;return!1}function Ge(t,e,i){const n=[];for(let r=0;r<t.length;r++){const o=[];for(let n=0;n<t[r].length;n++){const a=ze(t[r][n],i);Pe(e,a),o.push(a)}n.push(o)}return n}function $e(t,e,i){const n=[];for(let r=0;r<t.length;r++){const o=Ge(t[r],e,i);n.push(o)}return n}function We(t,e,i,n){if(t[0]<i[0]||t[0]>i[2]){const e=.5*n;let r=t[0]-i[0]>e?-n:i[0]-t[0]>e?n:0;0===r&&(r=t[0]-i[2]>e?-n:i[2]-t[0]>e?n:0),t[0]+=r}Pe(e,t)}function He(t,e,i,n){const r=Math.pow(2,n.z)*Ee,o=[n.x*Ee,n.y*Ee],a=[];for(const n of t)for(const t of n){const n=[t.x+o[0],t.y+o[1]];We(n,e,i,r),a.push(n)}return a}function je(t,e,i,n){const r=Math.pow(2,n.z)*Ee,o=[n.x*Ee,n.y*Ee],a=[];for(const i of t){const t=[];for(const n of i){const i=[n.x+o[0],n.y+o[1]];Pe(e,i),t.push(i)}a.push(t)}if(e[2]-e[0]<=r/2){(s=e)[0]=s[1]=1/0,s[2]=s[3]=-1/0;for(const t of a)for(const n of t)We(n,e,i,r)}var s;return a}class Ze{constructor(t,e){this.type=Xt,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ge(t[1])){const e=t[1];if("FeatureCollection"===e.type)for(let t=0;t<e.features.length;++t){const i=e.features[t].geometry.type;if("Polygon"===i||"MultiPolygon"===i)return new Ze(e,e.features[t].geometry)}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new Ze(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new Ze(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const i=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if("Polygon"===e.type){const o=Ge(e.coordinates,n,r),a=He(t.geometry(),i,n,r);if(!Le(i,n))return!1;for(const t of a)if(!Re(t,o))return!1}if("MultiPolygon"===e.type){const o=$e(e.coordinates,n,r),a=He(t.geometry(),i,n,r);if(!Le(i,n))return!1;for(const t of a)if(!Be(t,o))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const i=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if("Polygon"===e.type){const o=Ge(e.coordinates,n,r),a=je(t.geometry(),i,n,r);if(!Le(i,n))return!1;for(const t of a)if(!Ve(t,o))return!1}if("MultiPolygon"===e.type){const o=$e(e.coordinates,n,r),a=je(t.geometry(),i,n,r);if(!Le(i,n))return!1;for(const t of a)if(!Ue(t,o))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function qe(t){if(t instanceof ke){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof Ze)return!1;let e=!0;return t.eachChild(t=>{e&&!qe(t)&&(e=!1)}),e}function Xe(t){if(t instanceof ke&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild(t=>{e&&!Xe(t)&&(e=!1)}),e}function Ye(t,e){if(t instanceof ke&&e.indexOf(t.name)>=0)return!1;let i=!0;return t.eachChild(t=>{i&&!Ye(t,e)&&(i=!1)}),i}class Ke{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const i=t[1];return e.scope.has(i)?new Ke(i,e.scope.get(i)):e.error(`Unknown variable "${i}". Make sure "${i}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Je{constructor(t,e=[],i,n=new Ht,r=[]){this.registry=t,this.path=e,this.key=e.map(t=>`[${t}]`).join(""),this.scope=n,this.errors=r,this.expectedType=i}parse(t,e,i,n,r={}){return e?this.concat(e,i,n)._parse(t,r):this._parse(t,r)}_parse(t,e){function i(t,e,i){return"assert"===i?new we(e,[t]):"coerce"===i?new Ie(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const n=t[0];if("string"!=typeof n)return this.error(`Expression name must be a string, but found ${typeof n} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const r=this.registry[n];if(r){let n=r.parse(t,this);if(!n)return null;if(this.expectedType){const t=this.expectedType,r=n.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==r.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==r.kind&&"string"!==r.kind){if(this.checkSubtype(t,r))return null}else n=i(n,t,e.typeAnnotation||"coerce");else n=i(n,t,e.typeAnnotation||"assert")}if(!(n instanceof _e)&&"resolvedImage"!==n.type.kind&&Qe(n)){const e=new Ae;try{n=new _e(n.type,n.evaluate(e))}catch(t){return this.error(t.message),null}}return n}return this.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,e,i){const n="number"==typeof t?this.path.concat(t):this.path,r=i?this.scope.concat(i):this.scope;return new Je(this.registry,n,e||null,r,this.errors)}error(t,...e){const i=`${this.key}${e.map(t=>`[${t}]`).join("")}`;this.errors.push(new Wt(i,t))}checkSubtype(t,e){const i=oe(t,e);return i&&this.error(i),i}}function Qe(t){if(t instanceof Ke)return Qe(t.boundExpression);if(t instanceof ke&&"error"===t.name)return!1;if(t instanceof De)return!1;if(t instanceof Ze)return!1;const e=t instanceof Ie||t instanceof we;let i=!0;return t.eachChild(t=>{i=e?i&&Qe(t):i&&t instanceof _e}),!!i&&qe(t)&&Ye(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script"])}function ti(t,e){const i=t.length-1;let n,r,o=0,a=i,s=0;for(;o<=a;)if(n=t[s=Math.floor((o+a)/2)],r=t[s+1],n<=e){if(s===i||e<r)return s;o=s+1}else{if(!(n>e))throw new xe("Input is not a number.");a=s-1}return 0}class ei{constructor(t,e,i){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[t,e]of i)this.labels.push(t),this.outputs.push(e)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const i=e.parse(t[1],1,Zt);if(!i)return null;const n=[];let r=null;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(let i=1;i<t.length;i+=2){const o=1===i?-1/0:t[i],a=t[i+1],s=i,l=i+1;if("number"!=typeof o)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(n.length&&n[n.length-1][0]>=o)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);const u=e.parse(a,l,r);if(!u)return null;r=r||u.type,n.push([o,u])}return new ei(r,i,n)}evaluate(t){const e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);const n=this.input.evaluate(t);if(n<=e[0])return i[0].evaluate(t);const r=e.length;return n>=e[r-1]?i[r-1].evaluate(t):i[ti(e,n)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t}}function ii(t,e,i){return t*(1-i)+e*i}var ni=Object.freeze({__proto__:null,number:ii,color:function(t,e,i){return new ce(ii(t.r,e.r,i),ii(t.g,e.g,i),ii(t.b,e.b,i),ii(t.a,e.a,i))},array:function(t,e,i){return t.map((t,n)=>ii(t,e[n],i))}});const ri=.95047,oi=1.08883,ai=4/29,si=6/29,li=3*si*si,ui=Math.PI/180,ci=180/Math.PI;function hi(t){return t>.008856451679035631?Math.pow(t,1/3):t/li+ai}function pi(t){return t>si?t*t*t:li*(t-ai)}function di(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function fi(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function mi(t){const e=fi(t.r),i=fi(t.g),n=fi(t.b),r=hi((.4124564*e+.3575761*i+.1804375*n)/ri),o=hi((.2126729*e+.7151522*i+.072175*n)/1);return{l:116*o-16,a:500*(r-o),b:200*(o-hi((.0193339*e+.119192*i+.9503041*n)/oi)),alpha:t.a}}function gi(t){let e=(t.l+16)/116,i=isNaN(t.a)?e:e+t.a/500,n=isNaN(t.b)?e:e-t.b/200;return e=1*pi(e),i=ri*pi(i),n=oi*pi(n),new ce(di(3.2404542*i-1.5371385*e-.4985314*n),di(-.969266*i+1.8760108*e+.041556*n),di(.0556434*i-.2040259*e+1.0572252*n),t.alpha)}function yi(t,e,i){const n=e-t;return t+i*(n>180||n<-180?n-360*Math.round(n/360):n)}const vi={forward:mi,reverse:gi,interpolate:function(t,e,i){return{l:ii(t.l,e.l,i),a:ii(t.a,e.a,i),b:ii(t.b,e.b,i),alpha:ii(t.alpha,e.alpha,i)}}},_i={forward:function(t){const{l:e,a:i,b:n}=mi(t),r=Math.atan2(n,i)*ci;return{h:r<0?r+360:r,c:Math.sqrt(i*i+n*n),l:e,alpha:t.a}},reverse:function(t){const e=t.h*ui,i=t.c;return gi({l:t.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:t.alpha})},interpolate:function(t,e,i){return{h:yi(t.h,e.h,i),c:ii(t.c,e.c,i),l:ii(t.l,e.l,i),alpha:ii(t.alpha,e.alpha,i)}}};var xi=Object.freeze({__proto__:null,lab:vi,hcl:_i});class bi{constructor(t,e,i,n,r){this.type=t,this.operator=e,this.interpolation=i,this.input=n,this.labels=[],this.outputs=[];for(const[t,e]of r)this.labels.push(t),this.outputs.push(e)}static interpolationFactor(t,e,n,r){let o=0;if("exponential"===t.name)o=wi(e,t.base,n,r);else if("linear"===t.name)o=wi(e,1,n,r);else if("cubic-bezier"===t.name){const a=t.controlPoints;o=new i(a[0],a[1],a[2],a[3]).solve(wi(e,1,n,r))}return o}static parse(t,e){let[i,n,r,...o]=t;if(!Array.isArray(n)||0===n.length)return e.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){const t=n[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:t}}else{if("cubic-bezier"!==n[0])return e.error(`Unknown interpolation type ${n[0]+""}`,1,0);{const t=n.slice(1);if(4!==t.length||t.some(t=>"number"!=typeof t||t<0||t>1))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(r=e.parse(r,2,Zt)))return null;const a=[];let s=null;"interpolate-hcl"===i||"interpolate-lab"===i?s=Yt:e.expectedType&&"value"!==e.expectedType.kind&&(s=e.expectedType);for(let t=0;t<o.length;t+=2){const i=o[t],n=o[t+1],r=t+3,l=t+4;if("number"!=typeof i)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',r);if(a.length&&a[a.length-1][0]>=i)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',r);const u=e.parse(n,l,s);if(!u)return null;s=s||u.type,a.push([i,u])}return"number"===s.kind||"color"===s.kind||"array"===s.kind&&"number"===s.itemType.kind&&"number"==typeof s.N?new bi(s,i,n,r,a):e.error(`Type ${ne(s)} is not interpolatable.`)}evaluate(t){const e=this.labels,i=this.outputs;if(1===e.length)return i[0].evaluate(t);const n=this.input.evaluate(t);if(n<=e[0])return i[0].evaluate(t);const r=e.length;if(n>=e[r-1])return i[r-1].evaluate(t);const o=ti(e,n),a=bi.interpolationFactor(this.interpolation,n,e[o],e[o+1]),s=i[o].evaluate(t),l=i[o+1].evaluate(t);return"interpolate"===this.operator?ni[this.type.kind.toLowerCase()](s,l,a):"interpolate-hcl"===this.operator?_i.reverse(_i.interpolate(_i.forward(s),_i.forward(l),a)):vi.reverse(vi.interpolate(vi.forward(s),vi.forward(l),a))}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const e=[this.operator,t,this.input.serialize()];for(let t=0;t<this.labels.length;t++)e.push(this.labels[t],this.outputs[t].serialize());return e}}function wi(t,e,i,n){const r=n-i,o=t-i;return 0===r?0:1===e?o/r:(Math.pow(e,o)-1)/(Math.pow(e,r)-1)}class Si{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let i=null;const n=e.expectedType;n&&"value"!==n.kind&&(i=n);const r=[];for(const n of t.slice(1)){const t=e.parse(n,1+r.length,i,void 0,{typeAnnotation:"omit"});if(!t)return null;i=i||t.type,r.push(t)}const o=n&&r.some(t=>oe(n,t.type));return new Si(o?Jt:i,r)}evaluate(t){let e,i=null,n=0;for(const r of this.args)if(n++,(i=r.evaluate(t))&&i instanceof fe&&!i.available&&(e||(e=i.name),i=null,n===this.args.length&&(i=e)),null!==i)break;return i}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(e=>{t.push(e.serialize())}),t}}class Ti{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const i=[];for(let n=1;n<t.length-1;n+=2){const r=t[n];if("string"!=typeof r)return e.error(`Expected string, but found ${typeof r} instead.`,n);if(/[^a-zA-Z0-9_]/.test(r))return e.error("Variable names must contain only alphanumeric characters or '_'.",n);const o=e.parse(t[n+1],n+1);if(!o)return null;i.push([r,o])}const n=e.parse(t[t.length-1],t.length-1,e.expectedType,i);return n?new Ti(i,n):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[e,i]of this.bindings)t.push(e,i.serialize());return t.push(this.result.serialize()),t}}class Mi{constructor(t,e,i){this.type=t,this.index=e,this.input=i}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,Zt),n=e.parse(t[2],2,ie(e.expectedType||Jt));return i&&n?new Mi(n.type.itemType,i,n):null}evaluate(t){const e=this.index.evaluate(t),i=this.input.evaluate(t);if(e<0)throw new xe(`Array index out of bounds: ${e} < 0.`);if(e>=i.length)throw new xe(`Array index out of bounds: ${e} > ${i.length-1}.`);if(e!==Math.floor(e))throw new xe(`Array index must be an integer, but found ${e} instead.`);return i[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Ii{constructor(t,e){this.type=Xt,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,Jt),n=e.parse(t[2],2,Jt);return i&&n?ae(i.type,[Xt,qt,Zt,jt,Jt])?new Ii(i,n):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${ne(i.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!i)return!1;if(!se(e,["boolean","string","number","null"]))throw new xe(`Expected first argument to be of type boolean, string, number or null, but found ${ne(ye(e))} instead.`);if(!se(i,["string","array"]))throw new xe(`Expected second argument to be of type array or string, but found ${ne(ye(i))} instead.`);return i.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Ci{constructor(t,e,i){this.type=Zt,this.needle=t,this.haystack=e,this.fromIndex=i}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,Jt),n=e.parse(t[2],2,Jt);if(!i||!n)return null;if(!ae(i.type,[Xt,qt,Zt,jt,Jt]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${ne(i.type)} instead`);if(4===t.length){const r=e.parse(t[3],3,Zt);return r?new Ci(i,n,r):null}return new Ci(i,n)}evaluate(t){const e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!se(e,["boolean","string","number","null"]))throw new xe(`Expected first argument to be of type boolean, string, number or null, but found ${ne(ye(e))} instead.`);if(!se(i,["string","array"]))throw new xe(`Expected second argument to be of type array or string, but found ${ne(ye(i))} instead.`);if(this.fromIndex){const n=this.fromIndex.evaluate(t);return i.indexOf(e,n)}return i.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Ai{constructor(t,e,i,n,r,o){this.inputType=t,this.type=e,this.input=i,this.cases=n,this.outputs=r,this.otherwise=o}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let i,n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);const r={},o=[];for(let a=2;a<t.length-1;a+=2){let s=t[a];const l=t[a+1];Array.isArray(s)||(s=[s]);const u=e.concat(a);if(0===s.length)return u.error("Expected at least one branch label.");for(const t of s){if("number"!=typeof t&&"string"!=typeof t)return u.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return u.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof t&&Math.floor(t)!==t)return u.error("Numeric branch labels must be integer values.");if(i){if(u.checkSubtype(i,ye(t)))return null}else i=ye(t);if(void 0!==r[t+""])return u.error("Branch labels must be unique.");r[t+""]=o.length}const c=e.parse(l,a,n);if(!c)return null;n=n||c.type,o.push(c)}const a=e.parse(t[1],1,Jt);if(!a)return null;const s=e.parse(t[t.length-1],t.length-1,n);return s?"value"!==a.type.kind&&e.concat(1).checkSubtype(i,a.type)?null:new Ai(i,n,a,r,o,s):null}evaluate(t){const e=this.input.evaluate(t);return(ye(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],e=Object.keys(this.cases).sort(),i=[],n={};for(const t of e){const e=n[this.cases[t]];void 0===e?(n[this.cases[t]]=i.length,i.push([this.cases[t],[t]])):i[e][1].push(t)}const r=t=>"number"===this.inputType.kind?+t:t;for(const[e,n]of i)t.push(1===n.length?r(n[0]):n.map(r)),t.push(this.outputs[e].serialize());return t.push(this.otherwise.serialize()),t}}class ki{constructor(t,e,i){this.type=t,this.branches=e,this.otherwise=i}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);const n=[];for(let r=1;r<t.length-1;r+=2){const o=e.parse(t[r],r,Xt);if(!o)return null;const a=e.parse(t[r+1],r+1,i);if(!a)return null;n.push([o,a]),i=i||a.type}const r=e.parse(t[t.length-1],t.length-1,i);return r?new ki(i,n,r):null}evaluate(t){for(const[e,i]of this.branches)if(e.evaluate(t))return i.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,i]of this.branches)t(e),t(i);t(this.otherwise)}outputDefined(){return this.branches.every(([t,e])=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(e=>{t.push(e.serialize())}),t}}class Di{constructor(t,e,i,n){this.type=t,this.input=e,this.beginIndex=i,this.endIndex=n}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const i=e.parse(t[1],1,Jt),n=e.parse(t[2],2,Zt);if(!i||!n)return null;if(!ae(i.type,[ie(Jt),qt,Jt]))return e.error(`Expected first argument to be of type array or string, but found ${ne(i.type)} instead`);if(4===t.length){const r=e.parse(t[3],3,Zt);return r?new Di(i.type,i,n,r):null}return new Di(i.type,i,n)}evaluate(t){const e=this.input.evaluate(t),i=this.beginIndex.evaluate(t);if(!se(e,["string","array"]))throw new xe(`Expected first argument to be of type array or string, but found ${ne(ye(e))} instead.`);if(this.endIndex){const n=this.endIndex.evaluate(t);return e.slice(i,n)}return e.slice(i)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Ei(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Pi(t,e,i,n){return 0===n.compare(e,i)}function Li(t,e,i){const n="=="!==t&&"!="!==t;return class r{constructor(t,e,i){this.type=Xt,this.lhs=t,this.rhs=e,this.collator=i,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const i=t[0];let o=e.parse(t[1],1,Jt);if(!o)return null;if(!Ei(i,o.type))return e.concat(1).error(`"${i}" comparisons are not supported for type '${ne(o.type)}'.`);let a=e.parse(t[2],2,Jt);if(!a)return null;if(!Ei(i,a.type))return e.concat(2).error(`"${i}" comparisons are not supported for type '${ne(a.type)}'.`);if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error(`Cannot compare types '${ne(o.type)}' and '${ne(a.type)}'.`);n&&("value"===o.type.kind&&"value"!==a.type.kind?o=new we(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new we(o.type,[a])));let s=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(s=e.parse(t[3],3,Qt)))return null}return new r(o,a,s)}evaluate(r){const o=this.lhs.evaluate(r),a=this.rhs.evaluate(r);if(n&&this.hasUntypedArgument){const e=ye(o),i=ye(a);if(e.kind!==i.kind||"string"!==e.kind&&"number"!==e.kind)throw new xe(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${e.kind}, ${i.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const t=ye(o),i=ye(a);if("string"!==t.kind||"string"!==i.kind)return e(r,o,a)}return this.collator?i(r,o,a,this.collator.evaluate(r)):e(r,o,a)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}serialize(){const e=[t];return this.eachChild(t=>{e.push(t.serialize())}),e}}}const zi=Li("==",function(t,e,i){return e===i},Pi),Oi=Li("!=",function(t,e,i){return e!==i},function(t,e,i,n){return!Pi(0,e,i,n)}),Ri=Li("<",function(t,e,i){return e<i},function(t,e,i,n){return n.compare(e,i)<0}),Bi=Li(">",function(t,e,i){return e>i},function(t,e,i,n){return n.compare(e,i)>0}),Ni=Li("<=",function(t,e,i){return e<=i},function(t,e,i,n){return n.compare(e,i)<=0}),Fi=Li(">=",function(t,e,i){return e>=i},function(t,e,i,n){return n.compare(e,i)>=0});class Vi{constructor(t,e,i,n,r){this.type=qt,this.number=t,this.locale=e,this.currency=i,this.minFractionDigits=n,this.maxFractionDigits=r}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const i=e.parse(t[1],1,Zt);if(!i)return null;const n=t[2];if("object"!=typeof n||Array.isArray(n))return e.error("NumberFormat options argument must be an object.");let r=null;if(n.locale&&!(r=e.parse(n.locale,1,qt)))return null;let o=null;if(n.currency&&!(o=e.parse(n.currency,1,qt)))return null;let a=null;if(n["min-fraction-digits"]&&!(a=e.parse(n["min-fraction-digits"],1,Zt)))return null;let s=null;return n["max-fraction-digits"]&&!(s=e.parse(n["max-fraction-digits"],1,Zt))?null:new Vi(i,r,o,a,s)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class Ui{constructor(t){this.type=Zt,this.input=t}static parse(t,e){if(2!==t.length)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const i=e.parse(t[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?e.error(`Expected argument of type string or array, but found ${ne(i.type)} instead.`):new Ui(i):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new xe(`Expected value to be of type string or array, but found ${ne(ye(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(e=>{t.push(e.serialize())}),t}}const Gi={"==":zi,"!=":Oi,">":Bi,"<":Ri,">=":Fi,"<=":Ni,array:we,at:Mi,boolean:we,case:ki,coalesce:Si,collator:De,format:Se,image:Te,in:Ii,"index-of":Ci,interpolate:bi,"interpolate-hcl":bi,"interpolate-lab":bi,length:Ui,let:Ti,literal:_e,match:Ai,number:we,"number-format":Vi,object:we,slice:Di,step:ei,string:we,"to-boolean":Ie,"to-color":Ie,"to-number":Ie,"to-string":Ie,var:Ke,within:Ze};function $i(t,[e,i,n,r]){e=e.evaluate(t),i=i.evaluate(t),n=n.evaluate(t);const o=r?r.evaluate(t):1,a=me(e,i,n,o);if(a)throw new xe(a);return new ce(e/255*o,i/255*o,n/255*o,o)}function Wi(t,e){return t in e}function Hi(t,e){const i=e[t];return void 0===i?null:i}function ji(t){return{type:t}}function Zi(t){return{result:"success",value:t}}function qi(t){return{result:"error",value:t}}function Xi(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Yi(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Ki(t){return!!t.expression&&t.expression.interpolated}function Ji(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Qi(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function tn(t){return t}function en(t,e){const i="color"===e.type,n=t.stops&&"object"==typeof t.stops[0][0],r=n||!(n||void 0!==t.property),o=t.type||(Ki(e)?"exponential":"interval");if(i&&((t=Ut({},t)).stops&&(t.stops=t.stops.map(t=>[t[0],ce.parse(t[1])])),t.default=ce.parse(t.default?t.default:e.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!xi[t.colorSpace])throw Error(`Unknown color space: ${t.colorSpace}`);let a,s,l;if("exponential"===o)a=an;else if("interval"===o)a=on;else if("categorical"===o){a=rn,s=Object.create(null);for(const e of t.stops)s[e[0]]=e[1];l=typeof t.stops[0][0]}else{if("identity"!==o)throw Error(`Unknown function type "${o}"`);a=sn}if(n){const i={},n=[];for(let e=0;e<t.stops.length;e++){const r=t.stops[e],o=r[0].zoom;void 0===i[o]&&(i[o]={zoom:o,type:t.type,property:t.property,default:t.default,stops:[]},n.push(o)),i[o].stops.push([r[0].value,r[1]])}const r=[];for(const t of n)r.push([i[t].zoom,en(i[t],e)]);const o={name:"linear"};return{kind:"composite",interpolationType:o,interpolationFactor:bi.interpolationFactor.bind(void 0,o),zoomStops:r.map(t=>t[0]),evaluate:({zoom:i},n)=>an({stops:r,base:t.base},e,i).evaluate(i,n)}}if(r){const i="exponential"===o?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:i,interpolationFactor:bi.interpolationFactor.bind(void 0,i),zoomStops:t.stops.map(t=>t[0]),evaluate:({zoom:i})=>a(t,e,i,s,l)}}return{kind:"source",evaluate(i,n){const r=n&&n.properties?n.properties[t.property]:void 0;return void 0===r?nn(t.default,e.default):a(t,e,r,s,l)}}}function nn(t,e,i){return void 0!==t?t:void 0!==e?e:void 0!==i?i:void 0}function rn(t,e,i,n,r){return nn(typeof i===r?n[i]:void 0,t.default,e.default)}function on(t,e,i){if("number"!==Ji(i))return nn(t.default,e.default);const n=t.stops.length;if(1===n)return t.stops[0][1];if(i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[n-1][0])return t.stops[n-1][1];const r=ti(t.stops.map(t=>t[0]),i);return t.stops[r][1]}function an(t,e,i){const n=void 0!==t.base?t.base:1;if("number"!==Ji(i))return nn(t.default,e.default);const r=t.stops.length;if(1===r)return t.stops[0][1];if(i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[r-1][0])return t.stops[r-1][1];const o=ti(t.stops.map(t=>t[0]),i),a=function(t,e,i,n){const r=n-i,o=t-i;return 0===r?0:1===e?o/r:(Math.pow(e,o)-1)/(Math.pow(e,r)-1)}(i,n,t.stops[o][0],t.stops[o+1][0]),s=t.stops[o][1],l=t.stops[o+1][1];let u=ni[e.type]||tn;if(t.colorSpace&&"rgb"!==t.colorSpace){const e=xi[t.colorSpace];u=((t,i)=>e.reverse(e.interpolate(e.forward(t),e.forward(i),a)))}return"function"==typeof s.evaluate?{evaluate(...t){const e=s.evaluate.apply(void 0,t),i=l.evaluate.apply(void 0,t);if(void 0!==e&&void 0!==i)return u(e,i,a)}}:u(s,l,a)}function sn(t,e,i){return"color"===e.type?i=ce.parse(i):"formatted"===e.type?i=de.fromString(i.toString()):"resolvedImage"===e.type?i=fe.fromString(i.toString()):Ji(i)===e.type||"enum"===e.type&&e.values[i]||(i=void 0),nn(i,t.default,e.default)}ke.register(Gi,{error:[{kind:"error"},[qt],(t,[e])=>{throw new xe(e.evaluate(t))}],typeof:[qt,[Jt],(t,[e])=>ne(ye(e.evaluate(t)))],"to-rgba":[ie(Zt,4),[Yt],(t,[e])=>e.evaluate(t).toArray()],rgb:[Yt,[Zt,Zt,Zt],$i],rgba:[Yt,[Zt,Zt,Zt,Zt],$i],has:{type:Xt,overloads:[[[qt],(t,[e])=>Wi(e.evaluate(t),t.properties())],[[qt,Kt],(t,[e,i])=>Wi(e.evaluate(t),i.evaluate(t))]]},get:{type:Jt,overloads:[[[qt],(t,[e])=>Hi(e.evaluate(t),t.properties())],[[qt,Kt],(t,[e,i])=>Hi(e.evaluate(t),i.evaluate(t))]]},"feature-state":[Jt,[qt],(t,[e])=>Hi(e.evaluate(t),t.featureState||{})],properties:[Kt,[],t=>t.properties()],"geometry-type":[qt,[],t=>t.geometryType()],id:[Jt,[],t=>t.id()],zoom:[Zt,[],t=>t.globals.zoom],"heatmap-density":[Zt,[],t=>t.globals.heatmapDensity||0],"line-progress":[Zt,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[Zt,[],t=>t.globals.skyRadialProgress||0],accumulated:[Jt,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[Zt,ji(Zt),(t,e)=>{let i=0;for(const n of e)i+=n.evaluate(t);return i}],"*":[Zt,ji(Zt),(t,e)=>{let i=1;for(const n of e)i*=n.evaluate(t);return i}],"-":{type:Zt,overloads:[[[Zt,Zt],(t,[e,i])=>e.evaluate(t)-i.evaluate(t)],[[Zt],(t,[e])=>-e.evaluate(t)]]},"/":[Zt,[Zt,Zt],(t,[e,i])=>e.evaluate(t)/i.evaluate(t)],"%":[Zt,[Zt,Zt],(t,[e,i])=>e.evaluate(t)%i.evaluate(t)],ln2:[Zt,[],()=>Math.LN2],pi:[Zt,[],()=>Math.PI],e:[Zt,[],()=>Math.E],"^":[Zt,[Zt,Zt],(t,[e,i])=>Math.pow(e.evaluate(t),i.evaluate(t))],sqrt:[Zt,[Zt],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[Zt,[Zt],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[Zt,[Zt],(t,[e])=>Math.log(e.evaluate(t))],log2:[Zt,[Zt],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[Zt,[Zt],(t,[e])=>Math.sin(e.evaluate(t))],cos:[Zt,[Zt],(t,[e])=>Math.cos(e.evaluate(t))],tan:[Zt,[Zt],(t,[e])=>Math.tan(e.evaluate(t))],asin:[Zt,[Zt],(t,[e])=>Math.asin(e.evaluate(t))],acos:[Zt,[Zt],(t,[e])=>Math.acos(e.evaluate(t))],atan:[Zt,[Zt],(t,[e])=>Math.atan(e.evaluate(t))],min:[Zt,ji(Zt),(t,e)=>Math.min(...e.map(e=>e.evaluate(t)))],max:[Zt,ji(Zt),(t,e)=>Math.max(...e.map(e=>e.evaluate(t)))],abs:[Zt,[Zt],(t,[e])=>Math.abs(e.evaluate(t))],round:[Zt,[Zt],(t,[e])=>{const i=e.evaluate(t);return i<0?-Math.round(-i):Math.round(i)}],floor:[Zt,[Zt],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[Zt,[Zt],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Xt,[qt,Jt],(t,[e,i])=>t.properties()[e.value]===i.value],"filter-id-==":[Xt,[Jt],(t,[e])=>t.id()===e.value],"filter-type-==":[Xt,[qt],(t,[e])=>t.geometryType()===e.value],"filter-<":[Xt,[qt,Jt],(t,[e,i])=>{const n=t.properties()[e.value],r=i.value;return typeof n==typeof r&&n<r}],"filter-id-<":[Xt,[Jt],(t,[e])=>{const i=t.id(),n=e.value;return typeof i==typeof n&&i<n}],"filter->":[Xt,[qt,Jt],(t,[e,i])=>{const n=t.properties()[e.value],r=i.value;return typeof n==typeof r&&n>r}],"filter-id->":[Xt,[Jt],(t,[e])=>{const i=t.id(),n=e.value;return typeof i==typeof n&&i>n}],"filter-<=":[Xt,[qt,Jt],(t,[e,i])=>{const n=t.properties()[e.value],r=i.value;return typeof n==typeof r&&n<=r}],"filter-id-<=":[Xt,[Jt],(t,[e])=>{const i=t.id(),n=e.value;return typeof i==typeof n&&i<=n}],"filter->=":[Xt,[qt,Jt],(t,[e,i])=>{const n=t.properties()[e.value],r=i.value;return typeof n==typeof r&&n>=r}],"filter-id->=":[Xt,[Jt],(t,[e])=>{const i=t.id(),n=e.value;return typeof i==typeof n&&i>=n}],"filter-has":[Xt,[Jt],(t,[e])=>e.value in t.properties()],"filter-has-id":[Xt,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[Xt,[ie(qt)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Xt,[ie(Jt)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Xt,[qt,ie(Jt)],(t,[e,i])=>i.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Xt,[qt,ie(Jt)],(t,[e,i])=>(function(t,e,i,n){for(;i<=n;){const r=i+n>>1;if(e[r]===t)return!0;e[r]>t?n=r-1:i=r+1}return!1})(t.properties()[e.value],i.value,0,i.value.length-1)],all:{type:Xt,overloads:[[[Xt,Xt],(t,[e,i])=>e.evaluate(t)&&i.evaluate(t)],[ji(Xt),(t,e)=>{for(const i of e)if(!i.evaluate(t))return!1;return!0}]]},any:{type:Xt,overloads:[[[Xt,Xt],(t,[e,i])=>e.evaluate(t)||i.evaluate(t)],[ji(Xt),(t,e)=>{for(const i of e)if(i.evaluate(t))return!0;return!1}]]},"!":[Xt,[Xt],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Xt,[qt],(t,[e])=>{const i=t.globals&&t.globals.isSupportedScript;return!i||i(e.evaluate(t))}],upcase:[qt,[qt],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[qt,[qt],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[qt,ji(Jt),(t,e)=>e.map(e=>ve(e.evaluate(t))).join("")],"resolved-locale":[qt,[Qt],(t,[e])=>e.evaluate(t).resolvedLocale()]});class ln{constructor(t,e){this.expression=t,this._warningHistory={},this._evaluator=new Ae,this._defaultValue=e?function(t){return"color"===t.type&&Qi(t.default)?new ce(0,0,0,0):"color"===t.type?ce.parse(t.default)||null:void 0===t.default?null:t.default}(e):null,this._enumValues=e&&"enum"===e.type?e.values:null}evaluateWithoutErrorHandling(t,e,i,n,r,o){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=i,this._evaluator.canonical=n,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)}evaluate(t,e,i,n,r,o){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=i||null,this._evaluator.canonical=n,this._evaluator.availableImages=r||null,this._evaluator.formattedSection=o||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new xe(`Expected value to be one of ${Object.keys(this._enumValues).map(t=>JSON.stringify(t)).join(", ")}, but found ${JSON.stringify(e)} instead.`);return e}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,void 0!==console&&console.warn(t.message)),this._defaultValue}}}function un(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Gi}function cn(t,e){const i=new Je(Gi,[],e?function(t){const e={color:Yt,string:qt,number:Zt,enum:qt,boolean:Xt,formatted:te,resolvedImage:ee};return"array"===t.type?ie(e[t.value]||Jt,t.length):e[t.type]}(e):void 0),n=i.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return n?Zi(new ln(n,e)):qi(i.errors)}class hn{constructor(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent="constant"!==t&&!Xe(e.expression)}evaluateWithoutErrorHandling(t,e,i,n,r,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,n,r,o)}evaluate(t,e,i,n,r,o){return this._styleExpression.evaluate(t,e,i,n,r,o)}}class pn{constructor(t,e,i,n){this.kind=t,this.zoomStops=i,this._styleExpression=e,this.isStateDependent="camera"!==t&&!Xe(e.expression),this.interpolationType=n}evaluateWithoutErrorHandling(t,e,i,n,r,o){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,n,r,o)}evaluate(t,e,i,n,r,o){return this._styleExpression.evaluate(t,e,i,n,r,o)}interpolationFactor(t,e,i){return this.interpolationType?bi.interpolationFactor(this.interpolationType,t,e,i):0}}function dn(t,e){if("error"===(t=cn(t,e)).result)return t;const i=t.value.expression,n=qe(i);if(!n&&!Xi(e))return qi([new Wt("","data expressions not supported")]);const r=Ye(i,["zoom"]);if(!r&&!Yi(e))return qi([new Wt("","zoom expressions not supported")]);const o=mn(i);return o||r?o instanceof Wt?qi([o]):o instanceof bi&&!Ki(e)?qi([new Wt("",'"interpolate" expressions cannot be used with this property')]):Zi(o?new pn(n?"camera":"composite",t.value,o.labels,o instanceof bi?o.interpolation:void 0):new hn(n?"constant":"source",t.value)):qi([new Wt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class fn{constructor(t,e){this._parameters=t,this._specification=e,Ut(this,en(this._parameters,this._specification))}static deserialize(t){return new fn(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function mn(t){let e=null;if(t instanceof Ti)e=mn(t.result);else if(t instanceof Si){for(const i of t.args)if(e=mn(i))break}else(t instanceof ei||t instanceof bi)&&t.input instanceof ke&&"zoom"===t.input.name&&(e=t);return e instanceof Wt||t.eachChild(t=>{const i=mn(t);i instanceof Wt?e=i:!e&&i?e=new Wt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&i&&e!==i&&(e=new Wt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function gn(t){const e=t.key,i=t.value,n=t.valueSpec||{},r=t.objectElementValidators||{},o=t.style,a=t.styleSpec;let s=[];const l=Ji(i);if("object"!==l)return[new Ft(e,i,`object expected, ${l} found`)];for(const t in i){const l=t.split(".")[0],u=n[l]||n["*"];let c;if(r[l])c=r[l];else if(n[l])c=Hn;else if(r["*"])c=r["*"];else{if(!n["*"]){s.push(new Ft(e,i[t],`unknown property "${t}"`));continue}c=Hn}s=s.concat(c({key:(e?`${e}.`:e)+t,value:i[t],valueSpec:u,style:o,styleSpec:a,object:i,objectKey:t},i))}for(const t in n)r[t]||n[t].required&&void 0===n[t].default&&void 0===i[t]&&s.push(new Ft(e,i,`missing required property "${t}"`));return s}function yn(t){const e=t.value,i=t.valueSpec,n=t.style,r=t.styleSpec,o=t.key,a=t.arrayElementValidator||Hn;if("array"!==Ji(e))return[new Ft(o,e,`array expected, ${Ji(e)} found`)];if(i.length&&e.length!==i.length)return[new Ft(o,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new Ft(o,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let s={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum};r.$version<7&&(s.function=i.function),"object"===Ji(i.value)&&(s=i.value);let l=[];for(let t=0;t<e.length;t++)l=l.concat(a({array:e,arrayIndex:t,value:e[t],valueSpec:s,style:n,styleSpec:r,key:`${o}[${t}]`}));return l}function vn(t){const e=t.key,i=t.value,n=t.valueSpec;let r=Ji(i);if("number"===r&&i!=i&&(r="NaN"),"number"!==r)return[new Ft(e,i,`number expected, ${r} found`)];if("minimum"in n){let r=n.minimum;if("array"===Ji(n.minimum)&&(r=n.minimum[t.arrayIndex]),i<r)return[new Ft(e,i,`${i} is less than the minimum value ${r}`)]}if("maximum"in n){let r=n.maximum;if("array"===Ji(n.maximum)&&(r=n.maximum[t.arrayIndex]),i>r)return[new Ft(e,i,`${i} is greater than the maximum value ${r}`)]}return[]}function _n(t){const e=t.valueSpec,i=Gt(t.value.type);let n,r,o,a={};const s="categorical"!==i&&void 0===t.value.property,l=!s,u="array"===Ji(t.value.stops)&&"array"===Ji(t.value.stops[0])&&"object"===Ji(t.value.stops[0][0]),c=gn({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(t){if("identity"===i)return[new Ft(t.key,t.value,'identity function may not have a "stops" property')];let e=[];const n=t.value;return e=e.concat(yn({key:t.key,value:n,valueSpec:t.valueSpec,style:t.style,styleSpec:t.styleSpec,arrayElementValidator:h})),"array"===Ji(n)&&0===n.length&&e.push(new Ft(t.key,n,"array must have at least one stop")),e},default:function(t){return Hn({key:t.key,value:t.value,valueSpec:e,style:t.style,styleSpec:t.styleSpec})}}});return"identity"===i&&s&&c.push(new Ft(t.key,t.value,'missing required property "property"')),"identity"===i||t.value.stops||c.push(new Ft(t.key,t.value,'missing required property "stops"')),"exponential"===i&&t.valueSpec.expression&&!Ki(t.valueSpec)&&c.push(new Ft(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(l&&!Xi(t.valueSpec)?c.push(new Ft(t.key,t.value,"property functions not supported")):s&&!Yi(t.valueSpec)&&c.push(new Ft(t.key,t.value,"zoom functions not supported"))),"categorical"!==i&&!u||void 0!==t.value.property||c.push(new Ft(t.key,t.value,'"property" property is required')),c;function h(t){let i=[];const n=t.value,s=t.key;if("array"!==Ji(n))return[new Ft(s,n,`array expected, ${Ji(n)} found`)];if(2!==n.length)return[new Ft(s,n,`array length 2 expected, length ${n.length} found`)];if(u){if("object"!==Ji(n[0]))return[new Ft(s,n,`object expected, ${Ji(n[0])} found`)];if(void 0===n[0].zoom)return[new Ft(s,n,"object stop key must have zoom")];if(void 0===n[0].value)return[new Ft(s,n,"object stop key must have value")];if(o&&o>Gt(n[0].zoom))return[new Ft(s,n[0].zoom,"stop zoom values must appear in ascending order")];Gt(n[0].zoom)!==o&&(o=Gt(n[0].zoom),r=void 0,a={}),i=i.concat(gn({key:`${s}[0]`,value:n[0],valueSpec:{zoom:{}},style:t.style,styleSpec:t.styleSpec,objectElementValidators:{zoom:vn,value:p}}))}else i=i.concat(p({key:`${s}[0]`,value:n[0],valueSpec:{},style:t.style,styleSpec:t.styleSpec},n));return un($t(n[1]))?i.concat([new Ft(`${s}[1]`,n[1],"expressions are not allowed in function stops.")]):i.concat(Hn({key:`${s}[1]`,value:n[1],valueSpec:e,style:t.style,styleSpec:t.styleSpec}))}function p(t,o){const s=Ji(t.value),l=Gt(t.value),u=null!==t.value?t.value:o;if(n){if(s!==n)return[new Ft(t.key,u,`${s} stop domain type must match previous stop domain type ${n}`)]}else n=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new Ft(t.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==i){let n=`number expected, ${s} found`;return Xi(e)&&void 0===i&&(n+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ft(t.key,u,n)]}return"categorical"!==i||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==i&&"number"===s&&void 0!==r&&l<r?[new Ft(t.key,u,"stop domain values must appear in ascending order")]:(r=l,"categorical"===i&&l in a?[new Ft(t.key,u,"stop domain values must be unique")]:(a[l]=!0,[])):[new Ft(t.key,u,`integer expected, found ${l}`)]}}function xn(t){const e=("property"===t.expressionContext?dn:cn)($t(t.value),t.valueSpec);if("error"===e.result)return e.value.map(e=>new Ft(`${t.key}${e.key}`,t.value,e.message));const i=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!i.outputDefined())return[new Ft(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!Xe(i))return[new Ft(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext&&!Xe(i))return[new Ft(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Ye(i,["zoom","feature-state"]))return[new Ft(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!qe(i))return[new Ft(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function bn(t){const e=t.key,i=t.value,n=t.valueSpec,r=[];return Array.isArray(n.values)?-1===n.values.indexOf(Gt(i))&&r.push(new Ft(e,i,`expected one of [${n.values.join(", ")}], ${JSON.stringify(i)} found`)):-1===Object.keys(n.values).indexOf(Gt(i))&&r.push(new Ft(e,i,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(i)} found`)),r}function wn(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!wn(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}const Sn={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Tn(t){if(null==t)return{filter:()=>!0,needGeometry:!1};wn(t)||(t=Cn(t));const e=cn(t,Sn);if("error"===e.result)throw Error(e.value.map(t=>`${t.key}: ${t.message}`).join(", "));return{filter:(t,i,n)=>e.value.evaluate(t,i,{},n),needGeometry:In(t)}}function Mn(t,e){return t<e?-1:t>e?1:0}function In(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(In(t[e]))return!0;return!1}function Cn(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?An(t[1],t[2],"=="):"!="===e?En(An(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?An(t[1],t[2],e):"any"===e?(i=t.slice(1),["any"].concat(i.map(Cn))):"all"===e?["all"].concat(t.slice(1).map(Cn)):"none"===e?["all"].concat(t.slice(1).map(Cn).map(En)):"in"===e?kn(t[1],t.slice(2)):"!in"===e?En(kn(t[1],t.slice(2))):"has"===e?Dn(t[1]):"!has"===e?En(Dn(t[1])):"within"!==e||t;var i}function An(t,e,i){switch(t){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,t,e]}}function kn(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(t=>typeof t!=typeof e[0])?["filter-in-large",t,["literal",e.sort(Mn)]]:["filter-in-small",t,["literal",e]]}}function Dn(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function En(t){return["!",t]}function Pn(t){return wn($t(t.value))?xn(Ut({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ln(t)}function Ln(t){const e=t.value,i=t.key;if("array"!==Ji(e))return[new Ft(i,e,`array expected, ${Ji(e)} found`)];const n=t.styleSpec;let r,o=[];if(e.length<1)return[new Ft(i,e,"filter array must have at least 1 element")];switch(o=o.concat(bn({key:`${i}[0]`,value:e[0],valueSpec:n.filter_operator,style:t.style,styleSpec:t.styleSpec})),Gt(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===Gt(e[1])&&o.push(new Ft(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&o.push(new Ft(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&("string"!==(r=Ji(e[1]))&&o.push(new Ft(`${i}[1]`,e[1],`string expected, ${r} found`)));for(let a=2;a<e.length;a++)r=Ji(e[a]),"$type"===Gt(e[1])?o=o.concat(bn({key:`${i}[${a}]`,value:e[a],valueSpec:n.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==r&&"number"!==r&&"boolean"!==r&&o.push(new Ft(`${i}[${a}]`,e[a],`string, number, or boolean expected, ${r} found`));break;case"any":case"all":case"none":for(let n=1;n<e.length;n++)o=o.concat(Ln({key:`${i}[${n}]`,value:e[n],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":r=Ji(e[1]),2!==e.length?o.push(new Ft(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==r&&o.push(new Ft(`${i}[1]`,e[1],`string expected, ${r} found`));break;case"within":r=Ji(e[1]),2!==e.length?o.push(new Ft(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==r&&o.push(new Ft(`${i}[1]`,e[1],`object expected, ${r} found`))}return o}function zn(t,e){const i=t.key,n=t.style,r=t.styleSpec,o=t.value,a=t.objectKey,s=r[`${e}_${t.layerType}`];if(!s)return[];const l=a.match(/^(.*)-transition$/);if("paint"===e&&l&&s[l[1]]&&s[l[1]].transition)return Hn({key:i,value:o,valueSpec:r.transition,style:n,styleSpec:r});const u=t.valueSpec||s[a];if(!u)return[new Ft(i,o,`unknown property "${a}"`)];let c;if("string"===Ji(o)&&Xi(u)&&!u.tokens&&(c=/^{([^}]+)}$/.exec(o)))return[new Ft(i,o,`"${a}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(c[1])} }\`.`)];const h=[];return"symbol"===t.layerType&&("text-field"===a&&n&&!n.glyphs&&h.push(new Ft(i,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&Qi($t(o))&&"identity"===Gt(o.type)&&h.push(new Ft(i,o,'"text-font" does not support identity functions'))),h.concat(Hn({key:t.key,value:o,valueSpec:u,style:n,styleSpec:r,expressionContext:"property",propertyType:e,propertyKey:a}))}function On(t){return zn(t,"paint")}function Rn(t){return zn(t,"layout")}function Bn(t){let e=[];const i=t.value,n=t.key,r=t.style,o=t.styleSpec;i.type||i.ref||e.push(new Ft(n,i,'either "type" or "ref" is required'));let a=Gt(i.type);const s=Gt(i.ref);if(i.id){const o=Gt(i.id);for(let a=0;a<t.arrayIndex;a++){const t=r.layers[a];Gt(t.id)===o&&e.push(new Ft(n,i.id,`duplicate layer id "${i.id}", previously used at line ${t.id.__line__}`))}}if("ref"in i){let t;["type","source","source-layer","filter","layout"].forEach(t=>{t in i&&e.push(new Ft(n,i[t],`"${t}" is prohibited for ref layers`))}),r.layers.forEach(e=>{Gt(e.id)===s&&(t=e)}),t?t.ref?e.push(new Ft(n,i.ref,"ref cannot reference another ref layer")):a=Gt(t.type):e.push(new Ft(n,i.ref,`ref layer "${s}" not found`))}else if("background"!==a&&"sky"!==a)if(i.source){const t=r.sources&&r.sources[i.source],o=t&&Gt(t.type);t?"vector"===o&&"raster"===a?e.push(new Ft(n,i.source,`layer "${i.id}" requires a raster source`)):"raster"===o&&"raster"!==a?e.push(new Ft(n,i.source,`layer "${i.id}" requires a vector source`)):"vector"!==o||i["source-layer"]?"raster-dem"===o&&"hillshade"!==a?e.push(new Ft(n,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==a||!i.paint||!i.paint["line-gradient"]||"geojson"===o&&t.lineMetrics||e.push(new Ft(n,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Ft(n,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new Ft(n,i.source,`source "${i.source}" not found`))}else e.push(new Ft(n,i,'missing required property "source"'));return e=e.concat(gn({key:n,value:i,valueSpec:o.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Hn({key:`${n}.type`,value:i.type,valueSpec:o.layer.type,style:t.style,styleSpec:t.styleSpec,object:i,objectKey:"type"}),filter:Pn,layout:t=>gn({layer:i,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>Rn(Ut({layerType:a},t))}}),paint:t=>gn({layer:i,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":t=>On(Ut({layerType:a},t))}})}}))}function Nn(t){const e=t.value,i=t.key,n=Ji(e);return"string"!==n?[new Ft(i,e,`string expected, ${n} found`)]:[]}const Fn={promoteId:function({key:t,value:e}){if("string"===Ji(e))return Nn({key:t,value:e});{const i=[];for(const n in e)i.push(...Nn({key:`${t}.${n}`,value:e[n]}));return i}}};function Vn(t){const e=t.value,i=t.key,n=t.styleSpec,r=t.style;if(!e.type)return[new Ft(i,e,'"type" is required')];const o=Gt(e.type);let a;switch(o){case"vector":case"raster":case"raster-dem":return a=gn({key:i,value:e,valueSpec:n[`source_${o.replace("-","_")}`],style:t.style,styleSpec:n,objectElementValidators:Fn});case"geojson":if(a=gn({key:i,value:e,valueSpec:n.source_geojson,style:r,styleSpec:n,objectElementValidators:Fn}),e.cluster)for(const t in e.clusterProperties){const[n,r]=e.clusterProperties[t],o="string"==typeof n?[n,["accumulated"],["get",t]]:n;a.push(...xn({key:`${i}.${t}.map`,value:r,expressionContext:"cluster-map"})),a.push(...xn({key:`${i}.${t}.reduce`,value:o,expressionContext:"cluster-reduce"}))}return a;case"video":return gn({key:i,value:e,valueSpec:n.source_video,style:r,styleSpec:n});case"image":return gn({key:i,value:e,valueSpec:n.source_image,style:r,styleSpec:n});case"canvas":return[new Ft(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return bn({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:r,styleSpec:n})}}function Un(t){const e=t.value,i=t.styleSpec,n=i.light,r=t.style;let o=[];const a=Ji(e);if(void 0===e)return o;if("object"!==a)return o=o.concat([new Ft("light",e,`object expected, ${a} found`)]);for(const t in e){const a=t.match(/^(.*)-transition$/);o=o.concat(a&&n[a[1]]&&n[a[1]].transition?Hn({key:t,value:e[t],valueSpec:i.transition,style:r,styleSpec:i}):n[t]?Hn({key:t,value:e[t],valueSpec:n[t],style:r,styleSpec:i}):[new Ft(t,e[t],`unknown property "${t}"`)])}return o}function Gn(t){const e=t.value,i=t.key,n=t.style,r=t.styleSpec,o=r.terrain;let a=[];const s=Ji(e);if(void 0===e)return a;if("object"!==s)return a=a.concat([new Ft("terrain",e,`object expected, ${s} found`)]);for(const t in e){const i=t.match(/^(.*)-transition$/);a=a.concat(i&&o[i[1]]&&o[i[1]].transition?Hn({key:t,value:e[t],valueSpec:r.transition,style:n,styleSpec:r}):o[t]?Hn({key:t,value:e[t],valueSpec:o[t],style:n,styleSpec:r}):[new Ft(t,e[t],`unknown property "${t}"`)])}if(e.source){const t=n.sources&&n.sources[e.source],r=t&&Gt(t.type);t?"raster-dem"!==r&&a.push(new Ft(i,e.source,`terrain cannot be used with a source of type ${r}, it only be used with a "raster-dem" source type`)):a.push(new Ft(i,e.source,`source "${e.source}" not found`))}else a.push(new Ft(i,e,'terrain is missing required property "source"'));return a}function $n(t){const e=t.value,i=t.style,n=t.styleSpec,r=n.fog;let o=[];const a=Ji(e);if(void 0===e)return o;if("object"!==a)return o=o.concat([new Ft("fog",e,`object expected, ${a} found`)]);for(const t in e){const a=t.match(/^(.*)-transition$/);o=o.concat(a&&r[a[1]]&&r[a[1]].transition?Hn({key:t,value:e[t],valueSpec:n.transition,style:i,styleSpec:n}):r[t]?Hn({key:t,value:e[t],valueSpec:r[t],style:i,styleSpec:n}):[new Ft(t,e[t],`unknown property "${t}"`)])}return o}const Wn={"*":()=>[],array:yn,boolean:function(t){const e=t.value,i=t.key,n=Ji(e);return"boolean"!==n?[new Ft(i,e,`boolean expected, ${n} found`)]:[]},number:vn,color:function(t){const e=t.key,i=t.value,n=Ji(i);return"string"!==n?[new Ft(e,i,`color expected, ${n} found`)]:null===ue.parseCSSColor(i)?[new Ft(e,i,`color expected, "${i}" found`)]:[]},constants:Vt,enum:bn,filter:Pn,function:_n,layer:Bn,object:gn,source:Vn,light:Un,terrain:Gn,fog:$n,string:Nn,formatted:function(t){return 0===Nn(t).length?[]:xn(t)},resolvedImage:function(t){return 0===Nn(t).length?[]:xn(t)}};function Hn(t){const e=t.value,i=t.valueSpec,n=t.styleSpec;return i.expression&&Qi(Gt(e))?_n(t):i.expression&&un($t(e))?xn(t):i.type&&Wn[i.type]?Wn[i.type](t):gn(Ut({},t,{valueSpec:i.type?n[i.type]:i}))}function jn(t){const e=t.value,i=t.key,n=Nn(t);return n.length||(-1===e.indexOf("{fontstack}")&&n.push(new Ft(i,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&n.push(new Ft(i,e,'"glyphs" url must include a "{range}" token'))),n}function Zn(t,e=Nt){let i=[];return i=i.concat(Hn({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:jn,"*":()=>[]}})),t.constants&&(i=i.concat(Vt({key:"constants",value:t.constants,style:t,styleSpec:e}))),qn(i)}function qn(t){return[].concat(t).sort((t,e)=>t.line-e.line)}function Xn(t){return function(...e){return qn(t.apply(this,e))}}Zn.source=Xn(Vn),Zn.light=Xn(Un),Zn.terrain=Xn(Gn),Zn.fog=Xn($n),Zn.layer=Xn(Bn),Zn.filter=Xn(Pn),Zn.paintProperty=Xn(On),Zn.layoutProperty=Xn(Rn);const Yn=Zn,Kn=Yn.light,Jn=Yn.fog,Qn=Yn.paintProperty,tr=Yn.layoutProperty;function er(t,e){let i=!1;if(e&&e.length)for(const n of e)t.fire(new Rt(Error(n.message))),i=!0;return i}var ir=nr;function nr(t,e,i){var n=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var r=new Int32Array(this.arrayBuffer);t=r[0],this.d=(e=r[1])+2*(i=r[2]);for(var o=0;o<this.d*this.d;o++){var a=r[3+o],s=r[3+o+1];n.push(a===s?null:r.subarray(a,s))}var l=r[3+n.length+1];this.keys=r.subarray(r[3+n.length],l),this.bboxes=r.subarray(l),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var u=0;u<this.d*this.d;u++)n.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=i,this.scale=e/t,this.uid=0;var c=i/e*t;this.min=-c,this.max=t+c}nr.prototype.insert=function(t,e,i,n,r){this._forEachCell(e,i,n,r,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(r)},nr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},nr.prototype._insertCell=function(t,e,i,n,r,o){this.cells[r].push(o)},nr.prototype.query=function(t,e,i,n,r){var o=this.min,a=this.max;if(t<=o&&e<=o&&a<=i&&a<=n&&!r)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(t,e,i,n,this._queryCell,s,{},r),s},nr.prototype._queryCell=function(t,e,i,n,r,o,a,s){var l=this.cells[r];if(null!==l)for(var u=this.keys,c=this.bboxes,h=0;h<l.length;h++){var p=l[h];if(void 0===a[p]){var d=4*p;(s?s(c[d+0],c[d+1],c[d+2],c[d+3]):t<=c[d+2]&&e<=c[d+3]&&i>=c[d+0]&&n>=c[d+1])?(a[p]=!0,o.push(u[p])):a[p]=!1}}},nr.prototype._forEachCell=function(t,e,i,n,r,o,a,s){for(var l=this._convertToCellCoord(t),u=this._convertToCellCoord(e),c=this._convertToCellCoord(i),h=this._convertToCellCoord(n),p=l;p<=c;p++)for(var d=u;d<=h;d++){var f=this.d*d+p;if((!s||s(this._convertFromCellCoord(p),this._convertFromCellCoord(d),this._convertFromCellCoord(p+1),this._convertFromCellCoord(d+1)))&&r.call(this,t,e,i,n,f,o,a,s))return}},nr.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},nr.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},nr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,i=0,n=0;n<this.cells.length;n++)i+=this.cells[n].length;var r=new Int32Array(e+i+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;for(var o=e,a=0;a<t.length;a++){var s=t[a];r[3+a]=o,r.set(s,o),o+=s.length}return r[3+t.length]=o,r.set(this.keys,o),r[3+t.length+1]=o+=this.keys.length,r.set(this.bboxes,o),o+=this.bboxes.length,r.buffer};const{ImageData:rr,ImageBitmap:or}=a,ar={};function sr(t,e,i={}){Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),ar[t]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}sr("Object",Object),ir.serialize=function(t,e){const i=t.toArrayBuffer();return e&&e.push(i),{buffer:i}},ir.deserialize=function(t){return new ir(t.buffer)},sr("Grid",ir),sr("Color",ce),sr("Error",Error),sr("ResolvedImage",fe),sr("StylePropertyFunction",fn),sr("StyleExpression",ln,{omit:["_evaluator"]}),sr("ZoomDependentExpression",pn),sr("ZoomConstantExpression",hn),sr("CompoundExpression",ke,{omit:["_evaluate"]});for(const t in Gi)Gi[t]._classRegistryKey||sr(`Expression_${t}`,Gi[t]);function lr(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function ur(t){return or&&t instanceof or}function cr(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(lr(t)||ur(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const i=t;return e&&e.push(i.buffer),i}if(t instanceof rr)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const i=[];for(const n of t)i.push(cr(n,e));return i}if("object"==typeof t){const i=t.constructor,n=i._classRegistryKey;if(!n)throw Error("can't serialize object of unregistered class");const r=i.serialize?i.serialize(t,e):{};if(!i.serialize){for(const i in t){if(!t.hasOwnProperty(i))continue;if(ar[n].omit.indexOf(i)>=0)continue;const o=t[i];r[i]=ar[n].shallow.indexOf(i)>=0?o:cr(o,e)}t instanceof Error&&(r.message=t.message)}if(r.$name)throw Error("$name property is reserved for worker serialization logic.");return"Object"!==n&&(r.$name=n),r}throw Error("can't serialize object of type "+typeof t)}function hr(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||lr(t)||ur(t)||ArrayBuffer.isView(t)||t instanceof rr)return t;if(Array.isArray(t))return t.map(hr);if("object"==typeof t){const e=t.$name||"Object",{klass:i}=ar[e];if(!i)throw Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(t);const n=Object.create(i.prototype);for(const i of Object.keys(t)){if("$name"===i)continue;const r=t[i];n[i]=ar[e].shallow.indexOf(i)>=0?r:hr(r)}return n}throw Error("can't deserialize object of type "+typeof t)}class pr{constructor(){this.first=!0}update(t,e){const i=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=i,!0))}}const dr=t=>t>=1536&&t<=1791,fr=t=>t>=1872&&t<=1919,mr=t=>t>=2208&&t<=2303,gr=t=>t>=11904&&t<=12031,yr=t=>t>=12032&&t<=12255,vr=t=>t>=12272&&t<=12287,_r=t=>t>=12288&&t<=12351,xr=t=>t>=12352&&t<=12447,br=t=>t>=12448&&t<=12543,wr=t=>t>=12544&&t<=12591,Sr=t=>t>=12704&&t<=12735,Tr=t=>t>=12736&&t<=12783,Mr=t=>t>=12784&&t<=12799,Ir=t=>t>=12800&&t<=13055,Cr=t=>t>=13056&&t<=13311,Ar=t=>t>=13312&&t<=19903,kr=t=>t>=19968&&t<=40959,Dr=t=>t>=40960&&t<=42127,Er=t=>t>=42128&&t<=42191,Pr=t=>t>=44032&&t<=55215,Lr=t=>t>=63744&&t<=64255,zr=t=>t>=64336&&t<=65023,Or=t=>t>=65040&&t<=65055,Rr=t=>t>=65072&&t<=65103,Br=t=>t>=65104&&t<=65135,Nr=t=>t>=65136&&t<=65279,Fr=t=>t>=65280&&t<=65519;function Vr(t){for(const e of t)if($r(e.charCodeAt(0)))return!0;return!1}function Ur(t){for(const e of t)if(!Gr(e.charCodeAt(0)))return!1;return!0}function Gr(t){return!(dr(t)||fr(t)||mr(t)||zr(t)||Nr(t))}function $r(t){return!(746!==t&&747!==t&&(t<4352||!(Sr(t)||wr(t)||Rr(t)&&!(t>=65097&&t<=65103)||Lr(t)||Cr(t)||gr(t)||Tr(t)||!(!_r(t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||Ar(t)||kr(t)||Ir(t)||(t=>t>=12592&&t<=12687)(t)||(t=>t>=43360&&t<=43391)(t)||(t=>t>=55216&&t<=55295)(t)||(t=>t>=4352&&t<=4607)(t)||Pr(t)||xr(t)||vr(t)||(t=>t>=12688&&t<=12703)(t)||yr(t)||Mr(t)||br(t)&&12540!==t||!(!Fr(t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Br(t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||(t=>t>=5120&&t<=5759)(t)||(t=>t>=6320&&t<=6399)(t)||Or(t)||(t=>t>=19904&&t<=19967)(t)||Dr(t)||Er(t))))}function Wr(t){return!($r(t)||function(t){return!!((t=>t>=128&&t<=255)(t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||(t=>t>=8192&&t<=8303)(t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||(t=>t>=8448&&t<=8527)(t)||(t=>t>=8528&&t<=8591)(t)||(t=>t>=8960&&t<=9215)(t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||(t=>t>=9216&&t<=9279)(t)&&9251!==t||(t=>t>=9280&&t<=9311)(t)||(t=>t>=9312&&t<=9471)(t)||(t=>t>=9632&&t<=9727)(t)||(t=>t>=9728&&t<=9983)(t)&&!(t>=9754&&t<=9759)||(t=>t>=11008&&t<=11263)(t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||_r(t)||br(t)||(t=>t>=57344&&t<=63743)(t)||Rr(t)||Br(t)||Fr(t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t)}(t))}function Hr(t){return t>=1424&&t<=2303||zr(t)||Nr(t)}function jr(t,e){return!(!e&&Hr(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||(t=>t>=6016&&t<=6143)(t))}function Zr(t){for(const e of t)if(Hr(e.charCodeAt(0)))return!0;return!1}const qr="deferred",Xr="loading",Yr="loaded";let Kr=null,Jr="unavailable",Qr=null;const to=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Jr="error"),Kr&&Kr(t)};function eo(){io.fire(new Ot("pluginStateChange",{pluginStatus:Jr,pluginURL:Qr}))}const io=new Bt,no=function(){return Jr},ro=function(){if(Jr!==qr||!Qr)throw Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Jr=Xr,eo(),Qr&&Mt({url:Qr},t=>{t?to(t):(Jr=Yr,eo())})},oo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Jr===Yr||null!=oo.applyArabicShaping,isLoading:()=>Jr===Xr,setState(t){Jr=t.pluginStatus,Qr=t.pluginURL},isParsed:()=>null!=oo.applyArabicShaping&&null!=oo.processBidirectionalText&&null!=oo.processStyledBidirectionalText,getPluginURL:()=>Qr};class ao{constructor(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new pr,this.transition={})}isSupportedScript(t){return function(t,e){for(const i of t)if(!jr(i.charCodeAt(0),e))return!1;return!0}(t,oo.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,e=t-Math.floor(t),i=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*e}}}class so{constructor(t,e){this.property=t,this.value=e,this.expression=function(t,e){if(Qi(t))return new fn(t,e);if(un(t)){const i=dn(t,e);if("error"===i.result)throw Error(i.value.map(t=>`${t.key}: ${t.message}`).join(", "));return i.value}{let i=t;return"string"==typeof t&&"color"===e.type&&(i=ce.parse(t)),{kind:"constant",evaluate:()=>i}}}(void 0===e?t.specification.default:e,t.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,e,i){return this.property.possiblyEvaluate(this,t,e,i)}}class lo{constructor(t){this.property=t,this.value=new so(t,void 0)}transitioned(t,e){return new co(this.property,this.value,e,_({},t.transition,this.transition),t.now)}untransitioned(){return new co(this.property,this.value,null,{},0)}}class uo{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return k(this._values[t].value.value)}setValue(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new lo(this._values[t].property)),this._values[t].value=new so(this._values[t].property,null===e?void 0:k(e))}getTransition(t){return k(this._values[t].transition)}setTransition(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new lo(this._values[t].property)),this._values[t].transition=k(e)||void 0}serialize(){const t={};for(const e of Object.keys(this._values)){const i=this.getValue(e);void 0!==i&&(t[e]=i);const n=this.getTransition(e);void 0!==n&&(t[`${e}-transition`]=n)}return t}transitioned(t,e){const i=new ho(this._properties);for(const n of Object.keys(this._values))i._values[n]=this._values[n].transitioned(t,e._values[n]);return i}untransitioned(){const t=new ho(this._properties);for(const e of Object.keys(this._values))t._values[e]=this._values[e].untransitioned();return t}}class co{constructor(t,e,i,n,r){const o=n.delay||0,a=n.duration||0;r=r||0,this.property=t,this.value=e,this.begin=r+o,this.end=this.begin+a,t.specification.transition&&(n.delay||n.duration)&&(this.prior=i)}possiblyEvaluate(t,e,i){const n=t.now||0,r=this.value.possiblyEvaluate(t,e,i),o=this.prior;if(o){if(n>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(n<this.begin)return o.possiblyEvaluate(t,e,i);{const a=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(t,e,i),r,p(a))}}return r}}class ho{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,e,i){const n=new mo(this._properties);for(const r of Object.keys(this._values))n._values[r]=this._values[r].possiblyEvaluate(t,e,i);return n}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class po{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return k(this._values[t].value)}setValue(t,e){this._values[t]=new so(this._values[t].property,null===e?void 0:k(e))}serialize(){const t={};for(const e of Object.keys(this._values)){const i=this.getValue(e);void 0!==i&&(t[e]=i)}return t}possiblyEvaluate(t,e,i){const n=new mo(this._properties);for(const r of Object.keys(this._values))n._values[r]=this._values[r].possiblyEvaluate(t,e,i);return n}}class fo{constructor(t,e,i){this.property=t,this.value=e,this.parameters=i}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,e,i,n){return this.property.evaluate(this.value,this.parameters,t,e,i,n)}}class mo{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class go{constructor(t){this.specification=t}possiblyEvaluate(t,e){return t.expression.evaluate(e)}interpolate(t,e,i){const n=ni[this.specification.type];return n?n(t,e,i):t}}class yo{constructor(t,e){this.specification=t,this.overrides=e}possiblyEvaluate(t,e,i,n){return new fo(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(e,null,{},i,n)}:t.expression,e)}interpolate(t,e,i){if("constant"!==t.value.kind||"constant"!==e.value.kind)return t;if(void 0===t.value.value||void 0===e.value.value)return new fo(this,{kind:"constant",value:void 0},t.parameters);const n=ni[this.specification.type];return n?new fo(this,{kind:"constant",value:n(t.value.value,e.value.value,i)},t.parameters):t}evaluate(t,e,i,n,r,o){return"constant"===t.kind?t.value:t.evaluate(e,i,n,r,o)}}class vo extends yo{possiblyEvaluate(t,e,i,n){if(void 0===t.value)return new fo(this,{kind:"constant",value:void 0},e);if("constant"===t.expression.kind){const r=t.expression.evaluate(e,null,{},i,n),o="resolvedImage"===t.property.specification.type&&"string"!=typeof r?r.name:r,a=this._calculate(o,o,o,e);return new fo(this,{kind:"constant",value:a},e)}if("camera"===t.expression.kind){const i=this._calculate(t.expression.evaluate({zoom:e.zoom-1}),t.expression.evaluate({zoom:e.zoom}),t.expression.evaluate({zoom:e.zoom+1}),e);return new fo(this,{kind:"constant",value:i},e)}return new fo(this,t.expression,e)}evaluate(t,e,i,n,r,o){if("source"===t.kind){const a=t.evaluate(e,i,n,r,o);return this._calculate(a,a,a,e)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(e.zoom)-1},i,n),t.evaluate({zoom:Math.floor(e.zoom)},i,n),t.evaluate({zoom:Math.floor(e.zoom)+1},i,n),e):t.value}_calculate(t,e,i,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:t,to:e,other:i}:{from:i,to:e,other:t}}interpolate(t){return t}}class _o{constructor(t){this.specification=t}possiblyEvaluate(t,e,i,n){if(void 0!==t.value){if("constant"===t.expression.kind){const r=t.expression.evaluate(e,null,{},i,n);return this._calculate(r,r,r,e)}return this._calculate(t.expression.evaluate(new ao(Math.floor(e.zoom-1),e)),t.expression.evaluate(new ao(Math.floor(e.zoom),e)),t.expression.evaluate(new ao(Math.floor(e.zoom+1),e)),e)}}_calculate(t,e,i,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:i,to:e}}interpolate(t){return t}}class xo{constructor(t){this.specification=t}possiblyEvaluate(t,e,i,n){return!!t.expression.evaluate(e,null,{},i,n)}interpolate(){return!1}}class bo{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const e in t){const i=t[e];i.specification.overridable&&this.overridableProperties.push(e);const n=this.defaultPropertyValues[e]=new so(i,void 0),r=this.defaultTransitionablePropertyValues[e]=new lo(i);this.defaultTransitioningPropertyValues[e]=r.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=n.possiblyEvaluate({})}}}function wo(t,e){return 256*(t=m(Math.floor(t),0,255))+m(Math.floor(e),0,255)}sr("DataDrivenProperty",yo),sr("DataConstantProperty",go),sr("CrossFadedDataDrivenProperty",vo),sr("CrossFadedProperty",_o),sr("ColorRampProperty",xo);const So={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class To{constructor(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Mo{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}}_refreshViews(){throw Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Io(t,e=1){let i=0,n=0;return{members:t.map(t=>{const r=So[t.type].BYTES_PER_ELEMENT,o=i=Co(i,Math.max(e,r)),a=t.components||1;return n=Math.max(n,r),i+=r*a,{name:t.name,type:t.type,components:a,offset:o}}),size:Co(i,Math.max(n,e)),alignment:e}}function Co(t,e){return Math.ceil(t/e)*e}class Ao extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e){const i=this.length;return this.resize(i+1),this.emplace(i,t,e)}emplace(t,e,i){const n=2*t;return this.int16[n+0]=e,this.int16[n+1]=i,t}}Ao.prototype.bytesPerElement=4,sr("StructArrayLayout2i4",Ao);class ko extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i,n)}emplace(t,e,i,n,r){const o=4*t;return this.int16[o+0]=e,this.int16[o+1]=i,this.int16[o+2]=n,this.int16[o+3]=r,t}}ko.prototype.bytesPerElement=8,sr("StructArrayLayout4i8",ko);class Do extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r,o,a){const s=this.length;return this.resize(s+1),this.emplace(s,t,e,i,n,r,o,a)}emplace(t,e,i,n,r,o,a,s){const l=6*t,u=12*t,c=3*t;return this.int16[l+0]=e,this.int16[l+1]=i,this.uint8[u+4]=n,this.uint8[u+5]=r,this.uint8[u+6]=o,this.uint8[u+7]=a,this.float32[c+2]=s,t}}Do.prototype.bytesPerElement=12,sr("StructArrayLayout2i4ub1f12",Do);class Eo extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e){const i=this.length;return this.resize(i+1),this.emplace(i,t,e)}emplace(t,e,i){const n=2*t;return this.float32[n+0]=e,this.float32[n+1]=i,t}}Eo.prototype.bytesPerElement=8,sr("StructArrayLayout2f8",Eo);class Po extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r,o,a,s,l,u){const c=this.length;return this.resize(c+1),this.emplace(c,t,e,i,n,r,o,a,s,l,u)}emplace(t,e,i,n,r,o,a,s,l,u,c){const h=10*t;return this.uint16[h+0]=e,this.uint16[h+1]=i,this.uint16[h+2]=n,this.uint16[h+3]=r,this.uint16[h+4]=o,this.uint16[h+5]=a,this.uint16[h+6]=s,this.uint16[h+7]=l,this.uint16[h+8]=u,this.uint16[h+9]=c,t}}Po.prototype.bytesPerElement=20,sr("StructArrayLayout10ui20",Po);class Lo extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r,o,a,s){const l=this.length;return this.resize(l+1),this.emplace(l,t,e,i,n,r,o,a,s)}emplace(t,e,i,n,r,o,a,s,l){const u=8*t;return this.uint16[u+0]=e,this.uint16[u+1]=i,this.uint16[u+2]=n,this.uint16[u+3]=r,this.uint16[u+4]=o,this.uint16[u+5]=a,this.uint16[u+6]=s,this.uint16[u+7]=l,t}}Lo.prototype.bytesPerElement=16,sr("StructArrayLayout8ui16",Lo);class zo extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r,o,a,s,l,u,c,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,e,i,n,r,o,a,s,l,u,c,h)}emplace(t,e,i,n,r,o,a,s,l,u,c,h,p){const d=12*t;return this.int16[d+0]=e,this.int16[d+1]=i,this.int16[d+2]=n,this.int16[d+3]=r,this.uint16[d+4]=o,this.uint16[d+5]=a,this.uint16[d+6]=s,this.uint16[d+7]=l,this.int16[d+8]=u,this.int16[d+9]=c,this.int16[d+10]=h,this.int16[d+11]=p,t}}zo.prototype.bytesPerElement=24,sr("StructArrayLayout4i4ui4i24",zo);class Oo extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,i)}emplace(t,e,i,n){const r=3*t;return this.float32[r+0]=e,this.float32[r+1]=i,this.float32[r+2]=n,t}}Oo.prototype.bytesPerElement=12,sr("StructArrayLayout3f12",Oo);class Ro extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint32[1*t+0]=e,t}}Ro.prototype.bytesPerElement=4,sr("StructArrayLayout1ul4",Ro);class Bo extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r,o,a,s,l,u){const c=this.length;return this.resize(c+1),this.emplace(c,t,e,i,n,r,o,a,s,l,u)}emplace(t,e,i,n,r,o,a,s,l,u,c){const h=16*t,p=8*t;return this.int16[h+0]=e,this.int16[h+1]=i,this.float32[p+1]=n,this.float32[p+2]=r,this.float32[p+3]=o,this.float32[p+4]=a,this.int16[h+10]=s,this.uint32[p+6]=l,this.uint16[h+14]=u,this.uint16[h+15]=c,t}}Bo.prototype.bytesPerElement=32,sr("StructArrayLayout2i4f1i1ul2ui32",Bo);class No extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r,o){const a=this.length;return this.resize(a+1),this.emplace(a,t,e,i,n,r,o)}emplace(t,e,i,n,r,o,a){const s=6*t;return this.int16[s+0]=e,this.int16[s+1]=i,this.int16[s+2]=n,this.int16[s+3]=r,this.int16[s+4]=o,this.int16[s+5]=a,t}}No.prototype.bytesPerElement=12,sr("StructArrayLayout2i2i2i12",No);class Fo extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r){const o=this.length;return this.resize(o+1),this.emplace(o,t,e,i,n,r)}emplace(t,e,i,n,r,o){const a=4*t,s=8*t;return this.float32[a+0]=e,this.float32[a+1]=i,this.float32[a+2]=n,this.int16[s+6]=r,this.int16[s+7]=o,t}}Fo.prototype.bytesPerElement=16,sr("StructArrayLayout2f1f2i16",Fo);class Vo extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i,n)}emplace(t,e,i,n,r){const o=12*t,a=3*t;return this.uint8[o+0]=e,this.uint8[o+1]=i,this.float32[a+1]=n,this.float32[a+2]=r,t}}Vo.prototype.bytesPerElement=12,sr("StructArrayLayout2ub2f12",Vo);class Uo extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,i)}emplace(t,e,i,n){const r=3*t;return this.uint16[r+0]=e,this.uint16[r+1]=i,this.uint16[r+2]=n,t}}Uo.prototype.bytesPerElement=6,sr("StructArrayLayout3ui6",Uo);class Go extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r,o,a,s,l,u,c,h,p,d,f,m,g){const y=this.length;return this.resize(y+1),this.emplace(y,t,e,i,n,r,o,a,s,l,u,c,h,p,d,f,m,g)}emplace(t,e,i,n,r,o,a,s,l,u,c,h,p,d,f,m,g,y){const v=24*t,_=12*t,x=48*t;return this.int16[v+0]=e,this.int16[v+1]=i,this.uint16[v+2]=n,this.uint16[v+3]=r,this.uint32[_+2]=o,this.uint32[_+3]=a,this.uint32[_+4]=s,this.uint16[v+10]=l,this.uint16[v+11]=u,this.uint16[v+12]=c,this.float32[_+7]=h,this.float32[_+8]=p,this.uint8[x+36]=d,this.uint8[x+37]=f,this.uint8[x+38]=m,this.uint32[_+10]=g,this.int16[v+22]=y,t}}Go.prototype.bytesPerElement=48,sr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Go);class $o extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,n,r,o,a,s,l,u,c,h,p,d,f,m,g,y,v,_,x,b,w,S,T,M,I){const C=this.length;return this.resize(C+1),this.emplace(C,t,e,i,n,r,o,a,s,l,u,c,h,p,d,f,m,g,y,v,_,x,b,w,S,T,M,I)}emplace(t,e,i,n,r,o,a,s,l,u,c,h,p,d,f,m,g,y,v,_,x,b,w,S,T,M,I,C){const A=32*t,k=16*t;return this.int16[A+0]=e,this.int16[A+1]=i,this.int16[A+2]=n,this.int16[A+3]=r,this.int16[A+4]=o,this.int16[A+5]=a,this.int16[A+6]=s,this.int16[A+7]=l,this.uint16[A+8]=u,this.uint16[A+9]=c,this.uint16[A+10]=h,this.uint16[A+11]=p,this.uint16[A+12]=d,this.uint16[A+13]=f,this.uint16[A+14]=m,this.uint16[A+15]=g,this.uint16[A+16]=y,this.uint16[A+17]=v,this.uint16[A+18]=_,this.uint16[A+19]=x,this.uint16[A+20]=b,this.uint16[A+21]=w,this.uint16[A+22]=S,this.uint32[k+12]=T,this.float32[k+13]=M,this.float32[k+14]=I,this.float32[k+15]=C,t}}$o.prototype.bytesPerElement=64,sr("StructArrayLayout8i15ui1ul3f64",$o);class Wo extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.float32[1*t+0]=e,t}}Wo.prototype.bytesPerElement=4,sr("StructArrayLayout1f4",Wo);class Ho extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,e,i){const n=this.length;return this.resize(n+1),this.emplace(n,t,e,i)}emplace(t,e,i,n){const r=3*t;return this.int16[r+0]=e,this.int16[r+1]=i,this.int16[r+2]=n,t}}Ho.prototype.bytesPerElement=6,sr("StructArrayLayout3i6",Ho);class jo extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i,n)}emplace(t,e,i,n,r){const o=6*t;return this.uint32[3*t+0]=e,this.uint16[o+2]=i,this.uint16[o+3]=n,this.uint16[o+4]=r,t}}jo.prototype.bytesPerElement=12,sr("StructArrayLayout1ul3ui12",jo);class Zo extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,e){const i=this.length;return this.resize(i+1),this.emplace(i,t,e)}emplace(t,e,i){const n=2*t;return this.uint16[n+0]=e,this.uint16[n+1]=i,t}}Zo.prototype.bytesPerElement=4,sr("StructArrayLayout2ui4",Zo);class qo extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const e=this.length;return this.resize(e+1),this.emplace(e,t)}emplace(t,e){return this.uint16[1*t+0]=e,t}}qo.prototype.bytesPerElement=2,sr("StructArrayLayout1ui2",qo);class Xo extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,e,i,n){const r=this.length;return this.resize(r+1),this.emplace(r,t,e,i,n)}emplace(t,e,i,n,r){const o=4*t;return this.float32[o+0]=e,this.float32[o+1]=i,this.float32[o+2]=n,this.float32[o+3]=r,t}}Xo.prototype.bytesPerElement=16,sr("StructArrayLayout4f16",Xo);class Yo extends To{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.float32[this._pos4+1]}get y1(){return this._structArray.float32[this._pos4+2]}get x2(){return this._structArray.float32[this._pos4+3]}get y2(){return this._structArray.float32[this._pos4+4]}get padding(){return this._structArray.int16[this._pos2+10]}get featureIndex(){return this._structArray.uint32[this._pos4+6]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+14]}get bucketIndex(){return this._structArray.uint16[this._pos2+15]}get anchorPoint(){return new r(this.anchorPointX,this.anchorPointY)}}Yo.prototype.size=32;class Ko extends Bo{get(t){return new Yo(this,t)}}sr("CollisionBoxArray",Ko);class Jo extends To{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Jo.prototype.size=48;class Qo extends Go{get(t){return new Jo(this,t)}}sr("PlacedSymbolArray",Qo);class ta extends To{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textOffset0(){return this._structArray.float32[this._pos4+13]}get textOffset1(){return this._structArray.float32[this._pos4+14]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+15]}}ta.prototype.size=64;class ea extends $o{get(t){return new ta(this,t)}}sr("SymbolInstanceArray",ea);class ia extends Wo{getoffsetX(t){return this.float32[1*t+0]}}sr("GlyphOffsetArray",ia);class na extends Ho{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}sr("SymbolLineVertexArray",na);class ra extends To{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}ra.prototype.size=12;class oa extends jo{get(t){return new ra(this,t)}}sr("FeatureIndexArray",oa);class aa extends To{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}aa.prototype.size=4;class sa extends Zo{get(t){return new aa(this,t)}}sr("FillExtrusionCentroidArray",sa);const la=Io([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),ua=Io([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var ca=le(function(t){t.exports=function(t,e){var i,n,r,o,a,s,l,u;for(n=t.length-(i=3&t.length),r=e,a=3432918353,s=461845907,u=0;u<n;)l=255&t.charCodeAt(u)|(255&t.charCodeAt(++u))<<8|(255&t.charCodeAt(++u))<<16|(255&t.charCodeAt(++u))<<24,++u,r=27492+(65535&(o=5*(65535&(r=(r^=l=(65535&(l=(l=(65535&l)*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|r>>>19))+((5*(r>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(l=0,i){case 3:l^=(255&t.charCodeAt(u+2))<<16;case 2:l^=(255&t.charCodeAt(u+1))<<8;case 1:r^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(u)))*a+(((l>>>16)*a&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return r^=t.length,r=2246822507*(65535&(r^=r>>>16))+((2246822507*(r>>>16)&65535)<<16)&4294967295,r=3266489909*(65535&(r^=r>>>13))+((3266489909*(r>>>16)&65535)<<16)&4294967295,(r^=r>>>16)>>>0}}),ha=le(function(t){t.exports=function(t,e){for(var i,n=t.length,r=e^n,o=0;n>=4;)i=1540483477*(65535&(i=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+((1540483477*(i>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),n-=4,++o;switch(n){case 3:r^=(255&t.charCodeAt(o+2))<<16;case 2:r^=(255&t.charCodeAt(o+1))<<8;case 1:r=1540483477*(65535&(r^=255&t.charCodeAt(o)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0}}),pa=ca,da=ha;pa.murmur3=ca,pa.murmur2=da;class fa{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,e,i,n){this.ids.push(ma(t)),this.positions.push(e,i,n)}getPositions(t){const e=ma(t);let i=0,n=this.ids.length-1;for(;i<n;){const t=i+n>>1;this.ids[t]>=e?n=t:i=t+1}const r=[];for(;this.ids[i]===e;)r.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return r}static serialize(t,e){const i=new Float64Array(t.ids),n=new Uint32Array(t.positions);return ga(i,n,0,i.length-1),e&&e.push(i.buffer,n.buffer),{ids:i,positions:n}}static deserialize(t){const e=new fa;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e}}function ma(t){const e=+t;return!isNaN(e)&&e<=s?e:pa(t+"")}function ga(t,e,i,n){for(;i<n;){const r=t[i+n>>1];let o=i-1,a=n+1;for(;;){do{o++}while(t[o]<r);do{a--}while(t[a]>r);if(o>=a)break;ya(t,o,a),ya(e,3*o,3*a),ya(e,3*o+1,3*a+1),ya(e,3*o+2,3*a+2)}a-i<n-a?(ga(t,e,i,a),i=a+1):(ga(t,e,a+1,n),n=a)}}function ya(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}sr("FeaturePositionMap",fa);class va{constructor(t,e){this.gl=t.gl,this.location=e}}class _a extends va{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class xa extends va{constructor(t,e){super(t,e),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class ba extends va{constructor(t,e){super(t,e),this.current=ce.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const wa=new Float32Array(16),Sa=new Float32Array(9);function Ta(t){return[wo(255*t.r,255*t.g),wo(255*t.b,255*t.a)]}class Ma{constructor(t,e,i){this.value=t,this.uniformNames=e.map(t=>`u_${t}`),this.type=i}setUniform(t,e,i){t.set(i.constantOr(this.value))}getBinding(t,e,i){return"color"===this.type?new ba(t,e):new _a(t,e)}}class Ia{constructor(t,e){this.uniformNames=e.map(t=>`u_${t}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tl.concat(e.br),this.patternTo=t.tl.concat(t.br)}setUniform(t,e,i,n){const r="u_pattern_to"===n||"u_dash_to"===n?this.patternTo:"u_pattern_from"===n||"u_dash_from"===n?this.patternFrom:"u_pixel_ratio_to"===n?this.pixelRatioTo:"u_pixel_ratio_from"===n?this.pixelRatioFrom:null;r&&t.set(r)}getBinding(t,e,i){return"u_pattern_from"===i||"u_pattern_to"===i||"u_dash_from"===i||"u_dash_to"===i?new xa(t,e):new _a(t,e)}}class Ca{constructor(t,e,i,n){this.expression=t,this.type=i,this.maxValue=0,this.paintVertexAttributes=e.map(t=>({name:`a_${t}`,type:"Float32",components:"color"===i?2:1,offset:0})),this.paintVertexArray=new n}populatePaintArray(t,e,i,n,r){const o=this.paintVertexArray.length,a=this.expression.evaluate(new ao(0),e,{},n,[],r);this.paintVertexArray.resize(t),this._setPaintValue(o,t,a)}updatePaintArray(t,e,i,n){const r=this.expression.evaluate({zoom:0},i,n);this._setPaintValue(t,e,r)}_setPaintValue(t,e,i){if("color"===this.type){const n=Ta(i);for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,n[0],n[1])}else{for(let n=t;n<e;n++)this.paintVertexArray.emplace(n,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Aa{constructor(t,e,i,n,r,o){this.expression=t,this.uniformNames=e.map(t=>`u_${t}_t`),this.type=i,this.useIntegerZoom=n,this.zoom=r,this.maxValue=0,this.paintVertexAttributes=e.map(t=>({name:`a_${t}`,type:"Float32",components:"color"===i?4:2,offset:0})),this.paintVertexArray=new o}populatePaintArray(t,e,i,n,r){const o=this.expression.evaluate(new ao(this.zoom),e,{},n,[],r),a=this.expression.evaluate(new ao(this.zoom+1),e,{},n,[],r),s=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(s,t,o,a)}updatePaintArray(t,e,i,n){const r=this.expression.evaluate({zoom:this.zoom},i,n),o=this.expression.evaluate({zoom:this.zoom+1},i,n);this._setPaintValue(t,e,r,o)}_setPaintValue(t,e,i,n){if("color"===this.type){const r=Ta(i),o=Ta(n);for(let i=t;i<e;i++)this.paintVertexArray.emplace(i,r[0],r[1],o[0],o[1])}else{for(let r=t;r<e;r++)this.paintVertexArray.emplace(r,i,n);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(n))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,e){const i=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,n=m(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);t.set(n)}getBinding(t,e,i){return new _a(t,e)}}class ka{constructor(t,e,i,n,r,o,a){this.expression=t,this.type=i,this.useIntegerZoom=n,this.zoom=r,this.layerId=a,this.paintVertexAttributes=("array"===i?ua:la).members;for(let t=0;t<e.length;++t);this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o}populatePaintArray(t,e,i){const n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(n,t,e.patterns&&e.patterns[this.layerId],i)}updatePaintArray(t,e,i,n,r){this._setPaintValues(t,e,i.patterns&&i.patterns[this.layerId],r)}_setPaintValues(t,e,i,n){if(!n||!i)return;const{min:r,mid:o,max:a}=i,s=n[r],l=n[o],u=n[a];if(s&&l&&u)for(let i=t;i<e;i++)this._setPaintValue(this.zoomInPaintVertexArray,i,l,s),this._setPaintValue(this.zoomOutPaintVertexArray,i,l,u)}_setPaintValue(t,e,i,n){t.emplace(e,i.tl[0],i.tl[1],i.br[0],i.br[1],n.tl[0],n.tl[1],n.br[0],n.br[1],i.pixelRatio,n.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Da{constructor(t,e,i=(()=>!0)){this.binders={},this._buffers=[];const n=[];for(const r in t.paint._values){if(!i(r))continue;const o=t.paint.get(r);if(!(o instanceof fo&&Xi(o.property.specification)))continue;const a=La(r,t.type),s=o.value,l=o.property.specification.type,u=o.property.useIntegerZoom,c=o.property.specification["property-type"],h="cross-faded"===c||"cross-faded-data-driven"===c,p="line-dasharray"==r+""&&"constant"!==t.layout.get("line-cap").value.kind;if("constant"!==s.kind||p)if("source"===s.kind||p||h){const i=Ra(r,l,"source");this.binders[r]=h?new ka(s,a,l,u,e,i,t.id):new Ca(s,a,l,i),n.push(`/a_${r}`)}else{const t=Ra(r,l,"composite");this.binders[r]=new Aa(s,a,l,u,e,t),n.push(`/z_${r}`)}else this.binders[r]=h?new Ia(s.value,a):new Ma(s.value,a,l),n.push(`/u_${r}`)}this.cacheKey=n.sort().join("")}getMaxValue(t){const e=this.binders[t];return e instanceof Ca||e instanceof Aa?e.maxValue:0}populatePaintArrays(t,e,i,n,r){for(const o in this.binders){const a=this.binders[o];(a instanceof Ca||a instanceof Aa||a instanceof ka)&&a.populatePaintArray(t,e,i,n,r)}}setConstantPatternPositions(t,e){for(const i in this.binders){const n=this.binders[i];n instanceof Ia&&n.setConstantPatternPositions(t,e)}}updatePaintArrays(t,e,i,n,r){let o=!1;for(const a in t){const s=e.getPositions(a);for(const e of s){const s=i.feature(e.index);for(const i in this.binders){const l=this.binders[i];if((l instanceof Ca||l instanceof Aa||l instanceof ka)&&!0===l.expression.isStateDependent){const u=n.paint.get(i);l.expression=u.value,l.updatePaintArray(e.start,e.end,s,t[a],r),o=!0}}}}return o}defines(){const t=[];for(const e in this.binders){const i=this.binders[e];(i instanceof Ma||i instanceof Ia)&&t.push(...i.uniformNames.map(t=>`#define HAS_UNIFORM_${t}`))}return t}getBinderAttributes(){const t=[];for(const e in this.binders){const i=this.binders[e];if(i instanceof Ca||i instanceof Aa||i instanceof ka)for(let e=0;e<i.paintVertexAttributes.length;e++)t.push(i.paintVertexAttributes[e].name)}return t}getBinderUniforms(){const t=[];for(const e in this.binders){const i=this.binders[e];if(i instanceof Ma||i instanceof Ia||i instanceof Aa)for(const e of i.uniformNames)t.push(e)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,e){const i=[];for(const n in this.binders){const r=this.binders[n];if(r instanceof Ma||r instanceof Ia||r instanceof Aa)for(const o of r.uniformNames)if(e[o]){const a=r.getBinding(t,e[o],o);i.push({name:o,property:n,binding:a})}}return i}setUniforms(t,e,i,n){for(const{name:t,property:r,binding:o}of e)this.binders[r].setUniform(o,n,i.get(r),t)}updatePaintBuffers(t){this._buffers=[];for(const e in this.binders){const i=this.binders[e];if(t&&i instanceof ka){const e=2===t.fromScale?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;e&&this._buffers.push(e)}else(i instanceof Ca||i instanceof Aa)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(t){for(const e in this.binders){const i=this.binders[e];(i instanceof Ca||i instanceof Aa||i instanceof ka)&&i.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const e=this.binders[t];(e instanceof Ca||e instanceof Aa||e instanceof ka)&&e.destroy()}}}class Ea{constructor(t,e,i=(()=>!0)){this.programConfigurations={};for(const n of t)this.programConfigurations[n.id]=new Da(n,e,i);this.needsUpload=!1,this._featureMap=new fa,this._bufferOffset=0}populatePaintArrays(t,e,i,n,r,o){for(const i in this.programConfigurations)this.programConfigurations[i].populatePaintArrays(t,e,n,r,o);void 0!==e.id&&this._featureMap.add(e.id,i,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,e,i,n){for(const r of i)this.needsUpload=this.programConfigurations[r.id].updatePaintArrays(t,this._featureMap,e,r,n)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const Pa={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function La(t,e){return Pa[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const za={"line-pattern":{source:Po,composite:Po},"fill-pattern":{source:Po,composite:Po},"fill-extrusion-pattern":{source:Po,composite:Po},"line-dasharray":{source:Lo,composite:Lo}},Oa={color:{source:Eo,composite:Xo},number:{source:Wo,composite:Eo}};function Ra(t,e,i){const n=za[t];return n&&n[i]||Oa[e][i]}sr("ConstantBinder",Ma),sr("CrossFadedConstantBinder",Ia),sr("SourceExpressionBinder",Ca),sr("CrossFadedCompositeBinder",ka),sr("CompositeExpressionBinder",Aa),sr("ProgramConfiguration",Da,{omit:["_buffers"]}),sr("ProgramConfigurationSet",Ea);const Ba="-transition";class Na extends Bt{constructor(t,e){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==t.type&&(this.metadata=(t=t).metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&"sky"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),e.layout&&(this._unevaluatedLayout=new po(e.layout)),e.paint)){this._transitionablePaint=new uo(e.paint);for(const e in t.paint)this.setPaintProperty(e,t.paint[e],{validate:!1});for(const e in t.layout)this.setLayoutProperty(e,t.layout[e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new mo(e.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,e,i={}){null!=e&&this._validate(tr,`layers.${this.id}.layout.${t}`,t,e,i)||("visibility"!==t?this._unevaluatedLayout.setValue(t,e):this.visibility=e)}getPaintProperty(t){return I(t,Ba)?this._transitionablePaint.getTransition(t.slice(0,-Ba.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,e,i={}){if(null!=e&&this._validate(Qn,`layers.${this.id}.paint.${t}`,t,e,i))return!1;if(I(t,Ba))return this._transitionablePaint.setTransition(t.slice(0,-Ba.length),e||void 0),!1;{const i=this._transitionablePaint._values[t],n="cross-faded-data-driven"===i.property.specification["property-type"],r=i.value.isDataDriven(),o=i.value;this._transitionablePaint.setValue(t,e),this._handleSpecialPaintPropertyUpdate(t);const a=this._transitionablePaint._values[t].value;return a.isDataDriven()||r||n||this._handleOverridablePaintPropertyUpdate(t,o,a)}}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getProgramConfiguration(t){return null}_handleOverridablePaintPropertyUpdate(t,e,i){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,e){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,e)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,e)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),A(t,(t,e)=>!(void 0===t||"layout"===e&&!Object.keys(t).length||"paint"===e&&!Object.keys(t).length))}_validate(t,e,i,n,r={}){return(!r||!1!==r.validate)&&er(this,t.call(Yn,{key:e,layerType:this.type,objectKey:i,value:n,styleSpec:Nt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const e=this.paint.get(t);if(e instanceof fo&&Xi(e.property.specification)&&("source"===e.value.kind||"composite"===e.value.kind)&&e.value.isStateDependent)return!0}return!1}}const Fa=Io([{name:"a_pos",components:2,type:"Int16"}],4),{members:Va}=Fa;class Ua{constructor(t=[]){this.segments=t}prepareSegment(t,e,i,n){let r=this.segments[this.segments.length-1];return t>Ua.MAX_VERTEX_ARRAY_LENGTH&&E(`Max vertices per segment is ${Ua.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!r||r.vertexLength+t>Ua.MAX_VERTEX_ARRAY_LENGTH||r.sortKey!==n)&&(r={vertexOffset:e.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},void 0!==n&&(r.sortKey=n),this.segments.push(r)),r}get(){return this.segments}destroy(){for(const t of this.segments)for(const e in t.vaos)t.vaos[e].destroy()}static simpleSegment(t,e,i,n){return new Ua([{vertexOffset:t,primitiveOffset:e,vertexLength:i,primitiveLength:n,vaos:{},sortKey:0}])}}Ua.MAX_VERTEX_ARRAY_LENGTH=65535,sr("SegmentVector",Ua);var Ga=8192;const $a=16383,Wa=-$a-1;function Ha(t){const e=Ga/t.extent,i=t.loadGeometry();for(let t=0;t<i.length;t++){const n=i[t];for(let t=0;t<n.length;t++){const i=n[t],r=Math.round(i.x*e),o=Math.round(i.y*e);i.x=m(r,Wa,$a),i.y=m(o,Wa,$a),(r<i.x||r>i.x+1||o<i.y||o>i.y+1)&&E("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function ja(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Ha(t):[]}}function Za(t,e,i,n,r){t.emplaceBack(2*e+(n+1)/2,2*i+(r+1)/2)}class qa{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ao,this.indexArray=new Uo,this.segments=new Ua,this.programConfigurations=new Ea(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(t,e,i){const n=this.layers[0],r=[];let o=null;"circle"===n.type&&(o=n.layout.get("circle-sort-key"));for(const{feature:e,id:n,index:a,sourceLayerIndex:s}of t){const t=this.layers[0]._featureFilter.needGeometry,l=ja(e,t);if(!this.layers[0]._featureFilter.filter(new ao(this.zoom),l,i))continue;const u=o?o.evaluate(l,{},i):void 0,c={id:n,properties:e.properties,type:e.type,sourceLayerIndex:s,index:a,geometry:t?l.geometry:Ha(e),patterns:{},sortKey:u};r.push(c)}o&&r.sort((t,e)=>t.sortKey-e.sortKey);for(const n of r){const{geometry:r,index:o,sourceLayerIndex:a}=n,s=t[o].feature;this.addFeature(n,r,o,i),e.featureIndex.insert(s,r,o,a,this.index)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Va),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,i,n){for(const i of e)for(const e of i){const i=e.x,n=e.y;if(i<0||i>=Ga||n<0||n>=Ga)continue;const r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),o=r.vertexLength;Za(this.layoutVertexArray,i,n,-1,-1),Za(this.layoutVertexArray,i,n,1,-1),Za(this.layoutVertexArray,i,n,1,1),Za(this.layoutVertexArray,i,n,-1,1),this.indexArray.emplaceBack(o,o+1,o+2),this.indexArray.emplaceBack(o,o+3,o+2),r.vertexLength+=4,r.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,{},n)}}function Xa(t,e){for(let i=0;i<t.length;i++)if(rs(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(rs(t,e[i]))return!0;return!!Qa(t,e)}function Ya(t,e,i){return!!rs(t,e)||!!es(e,t,i)}function Ka(t,e){if(1===t.length)return ns(e,t[0]);for(let i=0;i<e.length;i++){const n=e[i];for(let e=0;e<n.length;e++)if(rs(t,n[e]))return!0}for(let i=0;i<t.length;i++)if(ns(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(Qa(t,e[i]))return!0;return!1}function Ja(t,e,i){if(t.length>1){if(Qa(t,e))return!0;for(let n=0;n<e.length;n++)if(es(e[n],t,i))return!0}for(let n=0;n<t.length;n++)if(es(t[n],e,i))return!0;return!1}function Qa(t,e){if(0===t.length||0===e.length)return!1;for(let i=0;i<t.length-1;i++){const n=t[i],r=t[i+1];for(let t=0;t<e.length-1;t++)if(ts(n,r,e[t],e[t+1]))return!0}return!1}function ts(t,e,i,n){return P(t,i,n)!==P(e,i,n)&&P(t,e,i)!==P(t,e,n)}function es(t,e,i){const n=i*i;if(1===e.length)return t.distSqr(e[0])<n;for(let i=1;i<e.length;i++)if(is(t,e[i-1],e[i])<n)return!0;return!1}function is(t,e,i){const n=e.distSqr(i);if(0===n)return t.distSqr(e);const r=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/n;return t.distSqr(r<0?e:r>1?i:i.sub(e)._mult(r)._add(e))}function ns(t,e){let i,n,r,o=!1;for(let a=0;a<t.length;a++){i=t[a];for(let t=0,a=i.length-1;t<i.length;a=t++)n=i[t],r=i[a],n.y>e.y!=r.y>e.y&&e.x<(r.x-n.x)*(e.y-n.y)/(r.y-n.y)+n.x&&(o=!o)}return o}function rs(t,e){let i=!1;for(let n=0,r=t.length-1;n<t.length;r=n++){const o=t[n],a=t[r];o.y>e.y!=a.y>e.y&&e.x<(a.x-o.x)*(e.y-o.y)/(a.y-o.y)+o.x&&(i=!i)}return i}function os(t,e,i,n,o){for(const r of t)if(e<=r.x&&i<=r.y&&n>=r.x&&o>=r.y)return!0;const a=[new r(e,i),new r(e,o),new r(n,o),new r(n,i)];if(t.length>2)for(const e of a)if(rs(t,e))return!0;for(let e=0;e<t.length-1;e++)if(as(t[e],t[e+1],a))return!0;return!1}function as(t,e,i){const n=i[0],r=i[2];if(t.x<n.x&&e.x<n.x||t.x>r.x&&e.x>r.x||t.y<n.y&&e.y<n.y||t.y>r.y&&e.y>r.y)return!1;const o=P(t,e,i[0]);return o!==P(t,e,i[1])||o!==P(t,e,i[2])||o!==P(t,e,i[3])}function ss(t,e,i){const n=e.paint.get(t).value;return"constant"===n.kind?n.value:i.programConfigurations.get(e.id).getMaxValue(t)}function ls(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function us(t,e,i,n,o){if(!e[0]&&!e[1])return t;const a=r.convert(e)._mult(o);"viewport"===i&&a._rotate(-n);const s=[];for(let e=0;e<t.length;e++)s.push(t[e].sub(a));return s}function cs(t,e,i,n){const o=r.convert(t)._mult(n);return"viewport"===e&&o._rotate(-i),o}sr("CircleBucket",qa,{omit:["layers"]});const hs=new bo({"circle-sort-key":new yo(Nt.layout_circle["circle-sort-key"])});var ps={paint:new bo({"circle-radius":new yo(Nt.paint_circle["circle-radius"]),"circle-color":new yo(Nt.paint_circle["circle-color"]),"circle-blur":new yo(Nt.paint_circle["circle-blur"]),"circle-opacity":new yo(Nt.paint_circle["circle-opacity"]),"circle-translate":new go(Nt.paint_circle["circle-translate"]),"circle-translate-anchor":new go(Nt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new go(Nt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new go(Nt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new yo(Nt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new yo(Nt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new yo(Nt.paint_circle["circle-stroke-opacity"])}),layout:hs},ds="undefined"!=typeof Float32Array?Float32Array:Array;function fs(){var t=new ds(9);return ds!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function ms(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function gs(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],d=e[10],f=e[11],m=e[12],g=e[13],y=e[14],v=e[15],_=i[0],x=i[1],b=i[2],w=i[3];return t[0]=_*n+x*s+b*h+w*m,t[1]=_*r+x*l+b*p+w*g,t[2]=_*o+x*u+b*d+w*y,t[3]=_*a+x*c+b*f+w*v,t[4]=(_=i[4])*n+(x=i[5])*s+(b=i[6])*h+(w=i[7])*m,t[5]=_*r+x*l+b*p+w*g,t[6]=_*o+x*u+b*d+w*y,t[7]=_*a+x*c+b*f+w*v,t[8]=(_=i[8])*n+(x=i[9])*s+(b=i[10])*h+(w=i[11])*m,t[9]=_*r+x*l+b*p+w*g,t[10]=_*o+x*u+b*d+w*y,t[11]=_*a+x*c+b*f+w*v,t[12]=(_=i[12])*n+(x=i[13])*s+(b=i[14])*h+(w=i[15])*m,t[13]=_*r+x*l+b*p+w*g,t[14]=_*o+x*u+b*d+w*y,t[15]=_*a+x*c+b*f+w*v,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var ys=gs;function vs(){var t=new ds(3);return ds!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function _s(t){return Math.hypot(t[0],t[1],t[2])}function xs(t,e,i){var n=new ds(3);return n[0]=t,n[1]=e,n[2]=i,n}function bs(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function ws(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function Ss(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t}function Ts(t,e){var i=e[0],n=e[1],r=e[2],o=i*i+n*n+r*r;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function Ms(t,e,i){var n=i[0],r=i[1],o=i[2],a=e[0],s=e[1],l=e[2],u=r*l-o*s,c=o*a-n*l,h=n*s-r*a,p=r*h-o*c,d=o*u-n*h,f=n*c-r*u,m=2*i[3];return c*=m,h*=m,d*=2,f*=2,t[0]=a+(u*=m)+(p*=2),t[1]=s+c+d,t[2]=l+h+f,t}var Is,Cs=bs,As=ws,ks=_s;function Ds(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3];return t[0]=i[0]*n+i[4]*r+i[8]*o+i[12]*a,t[1]=i[1]*n+i[5]*r+i[9]*o+i[13]*a,t[2]=i[2]*n+i[6]*r+i[10]*o+i[14]*a,t[3]=i[3]*n+i[7]*r+i[11]*o+i[15]*a,t}function Es(){var t=new ds(4);return ds!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Ps(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Ls(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(i),l=Math.cos(i);return t[0]=n*l+a*s,t[1]=r*l+o*s,t[2]=o*l-r*s,t[3]=a*l-n*s,t}function zs(t,e,i){const n=Ds([],[t.x,t.y,e,1],i);return new r(n[0]/n[3],n[1]/n[3])}vs(),Is=new ds(4),ds!=Float32Array&&(Is[0]=0,Is[1]=0,Is[2]=0,Is[3]=0),vs(),xs(1,0,0),xs(0,1,0),Es(),Es(),fs();const Os=xs(0,0,0),Rs=xs(0,0,1);function Bs(t,e){const i=vs();return Os[2]=e,t.intersectsPlane(Os,Rs,i),new r(i[0],i[1])}class Ns extends qa{}function Fs(t,{width:e,height:i},n,r){if(r){if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==e*i*n)throw new RangeError("mismatched image size")}else r=new Uint8Array(e*i*n);return t.width=e,t.height=i,t.data=r,t}function Vs(t,{width:e,height:i},n){if(e===t.width&&i===t.height)return;const r=Fs({},{width:e,height:i},n);Us(t,r,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,i)},n),t.width=e,t.height=i,t.data=r.data}function Us(t,e,i,n,r,o){if(0===r.width||0===r.height)return e;if(r.width>t.width||r.height>t.height||i.x>t.width-r.width||i.y>t.height-r.height)throw new RangeError("out of range source coordinates for image copy");if(r.width>e.width||r.height>e.height||n.x>e.width-r.width||n.y>e.height-r.height)throw new RangeError("out of range destination coordinates for image copy");const a=t.data,s=e.data;for(let l=0;l<r.height;l++){const u=((i.y+l)*t.width+i.x)*o,c=((n.y+l)*e.width+n.x)*o;for(let t=0;t<r.width*o;t++)s[c+t]=a[u+t]}return e}sr("HeatmapBucket",Ns,{omit:["layers"]});class Gs{constructor(t,e){Fs(this,t,1,e)}resize(t){Vs(this,t,1)}clone(){return new Gs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,i,n,r){Us(t,e,i,n,r,1)}}class $s{constructor(t,e){Fs(this,t,4,e)}resize(t){Vs(this,t,4)}replace(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new $s({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,e,i,n,r){Us(t,e,i,n,r,4)}}sr("AlphaImage",Gs),sr("RGBAImage",$s);var Ws={paint:new bo({"heatmap-radius":new yo(Nt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new yo(Nt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new go(Nt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new xo(Nt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new go(Nt.paint_heatmap["heatmap-opacity"])})};function Hs(t){const e={},i=t.resolution||256,n=t.clips?t.clips.length:1,r=t.image||new $s({width:i,height:n}),o=(i,n,o)=>{e[t.evaluationKey]=o;const a=t.expression.evaluate(e);r.data[i+n+0]=Math.floor(255*a.r/a.a),r.data[i+n+1]=Math.floor(255*a.g/a.a),r.data[i+n+2]=Math.floor(255*a.b/a.a),r.data[i+n+3]=Math.floor(255*a.a)};if(t.clips)for(let e=0,r=0;e<n;++e,r+=4*i)for(let n=0,a=0;n<i;n++,a+=4){const s=n/(i-1),{start:l,end:u}=t.clips[e];o(r,a,l*(1-s)+u*s)}else for(let t=0,e=0;t<i;t++,e+=4)o(0,e,t/(i-1));return r}var js={paint:new bo({"hillshade-illumination-direction":new go(Nt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new go(Nt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new go(Nt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new go(Nt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new go(Nt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new go(Nt.paint_hillshade["hillshade-accent-color"])})};const Zs=Io([{name:"a_pos",components:2,type:"Int16"}],4),{members:qs}=Zs;var Xs=Ks,Ys=Ks;function Ks(t,e,i){i=i||2;var n,r,o,a,s,l,u,c=e&&e.length,h=c?e[0]*i:t.length,p=Js(t,0,h,i,!0),d=[];if(!p||p.next===p.prev)return d;if(c&&(p=function(t,e,i,n){var r,o,a,s=[];for(r=0,o=e.length;r<o;r++)(a=Js(t,e[r]*n,r<o-1?e[r+1]*n:t.length,n,!1))===a.next&&(a.steiner=!0),s.push(ul(a));for(s.sort(ol),r=0;r<s.length;r++)al(s[r],i),i=Qs(i,i.next);return i}(t,e,p,i)),t.length>80*i){n=o=t[0],r=a=t[1];for(var f=i;f<h;f+=i)(s=t[f])<n&&(n=s),(l=t[f+1])<r&&(r=l),s>o&&(o=s),l>a&&(a=l);u=0!==(u=Math.max(o-n,a-r))?1/u:0}return tl(p,d,i,n,r,u),d}function Js(t,e,i,n,r){var o,a;if(r===wl(t,e,i,n)>0)for(o=e;o<i;o+=n)a=_l(o,t[o],t[o+1],a);else for(o=i-n;o>=e;o-=n)a=_l(o,t[o],t[o+1],a);return a&&dl(a,a.next)&&(xl(a),a=a.next),a}function Qs(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!dl(n,n.next)&&0!==pl(n.prev,n,n.next))n=n.next;else{if(xl(n),(n=e=n.prev)===n.next)break;i=!0}}while(i||n!==e);return e}function tl(t,e,i,n,r,o,a){if(t){!a&&o&&function(t,e,i,n){var r=t;do{null===r.z&&(r.z=ll(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,i,n,r,o,a,s,l,u=1;do{for(i=t,t=null,o=null,a=0;i;){for(a++,n=i,s=0,e=0;e<u&&(s++,n=n.nextZ);e++);for(l=u;s>0||l>0&&n;)0!==s&&(0===l||!n||i.z<=n.z)?(r=i,i=i.nextZ,s--):(r=n,n=n.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;i=n}o.nextZ=null,u*=2}while(a>1)}(r)}(t,n,r,o);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,o?il(t,n,r,o):el(t))e.push(s.i/i),e.push(t.i/i),e.push(l.i/i),xl(t),t=l.next,u=l.next;else if((t=l)===u){a?1===a?tl(t=nl(Qs(t),e,i),e,i,n,r,o,2):2===a&&rl(t,e,i,n,r,o):tl(Qs(t),e,i,n,r,o,1);break}}}function el(t){var e=t.prev,i=t,n=t.next;if(pl(e,i,n)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(cl(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&pl(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function il(t,e,i,n){var r=t.prev,o=t,a=t.next;if(pl(r,o,a)>=0)return!1;for(var s=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,l=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,u=ll(r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,e,i,n),c=ll(s,l,e,i,n),h=t.prevZ,p=t.nextZ;h&&h.z>=u&&p&&p.z<=c;){if(h!==t.prev&&h!==t.next&&cl(r.x,r.y,o.x,o.y,a.x,a.y,h.x,h.y)&&pl(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,p!==t.prev&&p!==t.next&&cl(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&pl(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;h&&h.z>=u;){if(h!==t.prev&&h!==t.next&&cl(r.x,r.y,o.x,o.y,a.x,a.y,h.x,h.y)&&pl(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;p&&p.z<=c;){if(p!==t.prev&&p!==t.next&&cl(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&pl(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function nl(t,e,i){var n=t;do{var r=n.prev,o=n.next.next;!dl(r,o)&&fl(r,n,n.next,o)&&yl(r,o)&&yl(o,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(o.i/i),xl(n),xl(n.next),n=t=o),n=n.next}while(n!==t);return Qs(n)}function rl(t,e,i,n,r,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&hl(a,s)){var l=vl(a,s);return a=Qs(a,a.next),l=Qs(l,l.next),tl(a,e,i,n,r,o),void tl(l,e,i,n,r,o)}s=s.next}a=a.next}while(a!==t)}function ol(t,e){return t.x-e.x}function al(t,e){if(e=function(t,e){var i,n=e,r=t.x,o=t.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=r&&s>a){if(a=s,s===r){if(o===n.y)return n;if(o===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(r===a)return i;var l,u=i,c=i.x,h=i.y,p=1/0;n=i;do{r>=n.x&&n.x>=c&&r!==n.x&&cl(o<h?r:a,o,c,h,o<h?a:r,o,n.x,n.y)&&(l=Math.abs(o-n.y)/(r-n.x),yl(n,t)&&(l<p||l===p&&(n.x>i.x||n.x===i.x&&sl(i,n)))&&(i=n,p=l)),n=n.next}while(n!==u);return i}(t,e)){var i=vl(e,t);Qs(e,e.next),Qs(i,i.next)}}function sl(t,e){return pl(t.prev,t,e.prev)<0&&pl(e.next,t,t.next)<0}function ll(t,e,i,n,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function ul(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function cl(t,e,i,n,r,o,a,s){return(r-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(n-s)-(i-a)*(e-s)>=0&&(i-a)*(o-s)-(r-a)*(n-s)>=0}function hl(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&fl(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(yl(t,e)&&yl(e,t)&&function(t,e){var i=t,n=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{i.y>o!=i.next.y>o&&i.next.y!==i.y&&r<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}(t,e)&&(pl(t.prev,t,e.prev)||pl(t,e.prev,e))||dl(t,e)&&pl(t.prev,t,t.next)>0&&pl(e.prev,e,e.next)>0)}function pl(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function dl(t,e){return t.x===e.x&&t.y===e.y}function fl(t,e,i,n){var r=gl(pl(t,e,i)),o=gl(pl(t,e,n)),a=gl(pl(i,n,t)),s=gl(pl(i,n,e));return r!==o&&a!==s||!(0!==r||!ml(t,i,e))||!(0!==o||!ml(t,n,e))||!(0!==a||!ml(i,t,n))||!(0!==s||!ml(i,e,n))}function ml(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function gl(t){return t>0?1:t<0?-1:0}function yl(t,e){return pl(t.prev,t,t.next)<0?pl(t,e,t.next)>=0&&pl(t,t.prev,e)>=0:pl(t,e,t.prev)<0||pl(t,t.next,e)<0}function vl(t,e){var i=new bl(t.i,t.x,t.y),n=new bl(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,o.next=n,n.prev=o,n}function _l(t,e,i,n){var r=new bl(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function xl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function bl(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function wl(t,e,i,n){for(var r=0,o=e,a=i-n;o<i;o+=n)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}function Sl(t,e,i,n,r){Tl(t,e,i||0,n||t.length-1,r||Il)}function Tl(t,e,i,n,r){for(;n>i;){if(n-i>600){var o=n-i+1,a=e-i+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1);Tl(t,e,Math.max(i,Math.floor(e-a*l/o+u)),Math.min(n,Math.floor(e+(o-a)*l/o+u)),r)}var c=t[e],h=i,p=n;for(Ml(t,i,e),r(t[n],c)>0&&Ml(t,i,n);h<p;){for(Ml(t,h,p),h++,p--;r(t[h],c)<0;)h++;for(;r(t[p],c)>0;)p--}0===r(t[i],c)?Ml(t,i,p):Ml(t,++p,n),p<=e&&(i=p+1),e<=p&&(n=p-1)}}function Ml(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function Il(t,e){return t<e?-1:t>e?1:0}function Cl(t,e){const i=t.length;if(i<=1)return[t];const n=[];let r,o;for(let e=0;e<i;e++){const i=L(t[e]);0!==i&&(t[e].area=Math.abs(i),void 0===o&&(o=i<0),o===i<0?(r&&n.push(r),r=[t[e]]):r.push(t[e]))}if(r&&n.push(r),e>1)for(let t=0;t<n.length;t++)n[t].length<=e||(Sl(n[t],e,1,n[t].length-1,Al),n[t]=n[t].slice(0,e));return n}function Al(t,e){return e.area-t.area}function kl(t,e,i){const n=i.patternDependencies;let r=!1;for(const i of e){const e=i.paint.get(`${t}-pattern`);e.isConstant()||(r=!0);const o=e.constantOr(null);o&&(r=!0,n[o.to]=!0,n[o.from]=!0)}return r}function Dl(t,e,i,n,r){const o=r.patternDependencies;for(const a of e){const e=a.paint.get(`${t}-pattern`).value;if("constant"!==e.kind){let t=e.evaluate({zoom:n-1},i,{},r.availableImages),s=e.evaluate({zoom:n},i,{},r.availableImages),l=e.evaluate({zoom:n+1},i,{},r.availableImages);t=t&&t.name?t.name:t,s=s&&s.name?s.name:s,l=l&&l.name?l.name:l,o[t]=!0,o[s]=!0,o[l]=!0,i.patterns[a.id]={min:t,mid:s,max:l}}}return i}Ks.deviation=function(t,e,i,n){var r=e&&e.length,o=Math.abs(wl(t,0,r?e[0]*i:t.length,i));if(r)for(var a=0,s=e.length;a<s;a++)o-=Math.abs(wl(t,e[a]*i,a<s-1?e[a+1]*i:t.length,i));var l=0;for(a=0;a<n.length;a+=3){var u=n[a]*i,c=n[a+1]*i,h=n[a+2]*i;l+=Math.abs((t[u]-t[h])*(t[c+1]-t[u+1])-(t[u]-t[c])*(t[h+1]-t[u+1]))}return 0===o&&0===l?0:Math.abs((l-o)/o)},Ks.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var a=0;a<e;a++)i.vertices.push(t[r][o][a]);r>0&&i.holes.push(n+=t[r-1].length)}return i},Xs.default=Ys;class El{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ao,this.indexArray=new Uo,this.indexArray2=new Zo,this.programConfigurations=new Ea(t.layers,t.zoom),this.segments=new Ua,this.segments2=new Ua,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(t,e,i){this.hasPattern=kl("fill",this.layers,e);const n=this.layers[0].layout.get("fill-sort-key"),r=[];for(const{feature:o,id:a,index:s,sourceLayerIndex:l}of t){const t=this.layers[0]._featureFilter.needGeometry,u=ja(o,t);if(!this.layers[0]._featureFilter.filter(new ao(this.zoom),u,i))continue;const c=n?n.evaluate(u,{},i,e.availableImages):void 0,h={id:a,properties:o.properties,type:o.type,sourceLayerIndex:l,index:s,geometry:t?u.geometry:Ha(o),patterns:{},sortKey:c};r.push(h)}n&&r.sort((t,e)=>t.sortKey-e.sortKey);for(const n of r){const{geometry:r,index:o,sourceLayerIndex:a}=n;if(this.hasPattern){const t=Dl("fill",this.layers,n,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(n,r,o,i,{});e.featureIndex.insert(t[o].feature,r,o,a,this.index)}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}addFeatures(t,e,i){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,qs),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,e,i,n,r){for(const t of Cl(e,500)){let e=0;for(const i of t)e+=i.length;const i=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),n=i.vertexLength,r=[],o=[];for(const e of t){if(0===e.length)continue;e!==t[0]&&o.push(r.length/2);const i=this.segments2.prepareSegment(e.length,this.layoutVertexArray,this.indexArray2),n=i.vertexLength;this.layoutVertexArray.emplaceBack(e[0].x,e[0].y),this.indexArray2.emplaceBack(n+e.length-1,n),r.push(e[0].x),r.push(e[0].y);for(let t=1;t<e.length;t++)this.layoutVertexArray.emplaceBack(e[t].x,e[t].y),this.indexArray2.emplaceBack(n+t-1,n+t),r.push(e[t].x),r.push(e[t].y);i.vertexLength+=e.length,i.primitiveLength+=e.length}const a=Xs(r,o);for(let t=0;t<a.length;t+=3)this.indexArray.emplaceBack(n+a[t],n+a[t+1],n+a[t+2]);i.vertexLength+=e,i.primitiveLength+=a.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,r,n)}}sr("FillBucket",El,{omit:["layers","patternFeatures"]});const Pl=new bo({"fill-sort-key":new yo(Nt.layout_fill["fill-sort-key"])});var Ll={paint:new bo({"fill-antialias":new go(Nt.paint_fill["fill-antialias"]),"fill-opacity":new yo(Nt.paint_fill["fill-opacity"]),"fill-color":new yo(Nt.paint_fill["fill-color"]),"fill-outline-color":new yo(Nt.paint_fill["fill-outline-color"]),"fill-translate":new go(Nt.paint_fill["fill-translate"]),"fill-translate-anchor":new go(Nt.paint_fill["fill-translate-anchor"]),"fill-pattern":new vo(Nt.paint_fill["fill-pattern"])}),layout:Pl};const zl=Io([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Ol=Io([{name:"a_centroid_pos",components:2,type:"Uint16"}]),{members:Rl}=zl;var Bl=Nl;function Nl(t,e,i,n,r){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=n,this._values=r,t.readFields(Fl,this,e)}function Fl(t,e,i){1==t?e.id=i.readVarint():2==t?function(t,e){for(var i=t.readVarint()+t.pos;t.pos<i;){var n=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[n]=r}}(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos)}function Vl(t){for(var e,i,n=0,r=0,o=t.length,a=o-1;r<o;a=r++)n+=((i=t[a]).x-(e=t[r]).x)*(e.y+i.y);return n}Nl.types=["Unknown","Point","LineString","Polygon"],Nl.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,n=1,o=0,a=0,s=0,l=[];t.pos<i;){if(o<=0){var u=t.readVarint();n=7&u,o=u>>3}if(o--,1===n||2===n)a+=t.readSVarint(),s+=t.readSVarint(),1===n&&(e&&l.push(e),e=[]),e.push(new r(a,s));else{if(7!==n)throw Error("unknown command "+n);e&&e.push(e[0].clone())}}return e&&l.push(e),l},Nl.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,n=0,r=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;t.pos<e;){if(n<=0){var c=t.readVarint();i=7&c,n=c>>3}if(n--,1===i||2===i)(r+=t.readSVarint())<a&&(a=r),r>s&&(s=r),(o+=t.readSVarint())<l&&(l=o),o>u&&(u=o);else if(7!==i)throw Error("unknown command "+i)}return[a,l,s,u]},Nl.prototype.toGeoJSON=function(t,e,i){var n,r,o=this.extent*Math.pow(2,i),a=this.extent*t,s=this.extent*e,l=this.loadGeometry(),u=Nl.types[this.type];function c(t){for(var e=0;e<t.length;e++){var i=t[e];t[e]=[360*(i.x+a)/o-180,360/Math.PI*Math.atan(Math.exp((180-360*(i.y+s)/o)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(n=0;n<l.length;n++)h[n]=l[n][0];c(l=h);break;case 2:for(n=0;n<l.length;n++)c(l[n]);break;case 3:for(l=function(t){var e=t.length;if(e<=1)return[t];for(var i,n,r=[],o=0;o<e;o++){var a=Vl(t[o]);0!==a&&(void 0===n&&(n=a<0),n===a<0?(i&&r.push(i),i=[t[o]]):i.push(t[o]))}return i&&r.push(i),r}(l),n=0;n<l.length;n++)for(r=0;r<l[n].length;r++)c(l[n][r])}1===l.length?l=l[0]:u="Multi"+u;var p={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(p.id=this.id),p};var Ul=Gl;function Gl(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields($l,this,e),this.length=this._features.length}function $l(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(function(t){for(var e=null,i=t.readVarint()+t.pos;t.pos<i;){var n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}(i))}function Wl(t,e,i){if(3===t){var n=new Ul(i,i.readVarint()+i.pos);n.length&&(e[n.name]=n)}}Gl.prototype.feature=function(t){if(t<0||t>=this._features.length)throw Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Bl(this._pbf,e,this.extent,this._keys,this._values)};var Hl={VectorTile:function(t,e){this.layers=t.readFields(Wl,{},e)},VectorTileFeature:Bl,VectorTileLayer:Ul};const jl=Hl.VectorTileFeature.types,Zl=8192;function ql(t,e,i,n,r,o,a,s){t.emplaceBack((e<<1)+a,(i<<1)+o,(Math.floor(n*Zl)<<1)+r,Math.round(s))}class Xl{constructor(){this.acc=new r(0,0),this.polyCount=[]}startRing(t){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new r(t.x,t.y),this.max=new r(t.x,t.y))}append(t,e){this.currentPolyCount.edges++,this.acc._add(t);let i=!!this.borders;const n=this.min,r=this.max;t.x<n.x?(n.x=t.x,i=!0):t.x>r.x&&(r.x=t.x,i=!0),t.y<n.y?(n.y=t.y,i=!0):t.y>r.y&&(r.y=t.y,i=!0),((0===t.x||t.x===Ga)&&t.x===e.x)!=((0===t.y||t.y===Ga)&&t.y===e.y)&&this.processBorderOverlap(t,e),i&&this.checkBorderIntersection(t,e)}checkBorderIntersection(t,e){e.x<0!=t.x<0&&this.addBorderIntersection(0,ii(e.y,t.y,(0-e.x)/(t.x-e.x))),e.x>Ga!=t.x>Ga&&this.addBorderIntersection(1,ii(e.y,t.y,(Ga-e.x)/(t.x-e.x))),e.y<0!=t.y<0&&this.addBorderIntersection(2,ii(e.x,t.x,(0-e.y)/(t.y-e.y))),e.y>Ga!=t.y>Ga&&this.addBorderIntersection(3,ii(e.x,t.x,(Ga-e.y)/(t.y-e.y)))}addBorderIntersection(t,e){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const i=this.borders[t];e<i[0]&&(i[0]=e),e>i[1]&&(i[1]=e)}processBorderOverlap(t,e){if(t.x===e.x){if(t.y===e.y)return;const i=0===t.x?0:1;this.addBorderIntersection(i,e.y),this.addBorderIntersection(i,t.y)}else{const i=0===t.y?2:3;this.addBorderIntersection(i,e.x),this.addBorderIntersection(i,t.x)}}centroid(){const t=this.polyCount.reduce((t,e)=>t+e.edges,0);return 0!==t?this.acc.div(t)._round():new r(0,0)}span(){return new r(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((t,e)=>t+ +(e[0]!==Number.MAX_VALUE),0)}}class Yl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ko,this.centroidVertexArray=new sa,this.indexArray=new Uo,this.programConfigurations=new Ea(t.layers,t.zoom),this.segments=new Ua,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id),this.enableTerrain=t.enableTerrain}populate(t,e,i){this.features=[],this.hasPattern=kl("fill-extrusion",this.layers,e),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(t){const e=Math.exp(Math.PI*(1-t.y/(1<<t.z)*2));return 80150034*e/(e*e+1)/Ga/(1<<t.z)}(i);for(const{feature:n,id:r,index:o,sourceLayerIndex:a}of t){const t=this.layers[0]._featureFilter.needGeometry,s=ja(n,t);if(!this.layers[0]._featureFilter.filter(new ao(this.zoom),s,i))continue;const l={id:r,sourceLayerIndex:a,index:o,geometry:t?s.geometry:Ha(n),properties:n.properties,type:n.type,patterns:{}},u=this.layoutVertexArray.length;this.hasPattern?this.features.push(Dl("fill-extrusion",this.layers,l,this.zoom,e)):this.addFeature(l,l.geometry,o,i,{}),e.featureIndex.insert(n,l.geometry,o,a,this.index,u)}this.sortBorders()}addFeatures(t,e,i){for(const t of this.features){const{geometry:n}=t;this.addFeature(t,n,t.index,e,i)}this.sortBorders()}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Rl),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Ol.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,e,i,n,r){const o=this.enableTerrain&&t.properties&&"Polygon"===jl[t.type]?new Xl:null;for(const i of Cl(e,500)){let e=0,n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(0===i.length||(a=i[0]).every(t=>t.x<=0)||a.every(t=>t.x>=Ga)||a.every(t=>t.y<=0)||a.every(t=>t.y>=Ga))continue;for(let t=0;t<i.length;t++){const r=i[t];if(0===r.length)continue;e+=r.length;let a=0;o&&o.startRing(r[0]);for(let t=0;t<r.length;t++){const e=r[t];if(t>=1){const i=r[t-1];if(!Kl(e,i)){o&&o.append(e,i),n.vertexLength+4>Ua.MAX_VERTEX_ARRAY_LENGTH&&(n=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const t=e.sub(i)._perp(),r=t.x/(Math.abs(t.x)+Math.abs(t.y)),s=t.y>0?1:0,l=i.dist(e);a+l>32768&&(a=0),ql(this.layoutVertexArray,e.x,e.y,r,s,0,0,a),ql(this.layoutVertexArray,e.x,e.y,r,s,0,1,a),a+=l,ql(this.layoutVertexArray,i.x,i.y,r,s,0,0,a),ql(this.layoutVertexArray,i.x,i.y,r,s,0,1,a);const u=n.vertexLength;this.indexArray.emplaceBack(u,u+2,u+1),this.indexArray.emplaceBack(u+1,u+2,u+3),n.vertexLength+=4,n.primitiveLength+=2}}}}if(n.vertexLength+e>Ua.MAX_VERTEX_ARRAY_LENGTH&&(n=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray)),"Polygon"!==jl[t.type])continue;const r=[],s=[],l=n.vertexLength;for(let t=0;t<i.length;t++){const e=i[t];if(0!==e.length){e!==i[0]&&s.push(r.length/2);for(let t=0;t<e.length;t++){const i=e[t];ql(this.layoutVertexArray,i.x,i.y,0,0,1,1,0),r.push(i.x),r.push(i.y),o&&o.currentPolyCount.top++}}}const u=Xs(r,s);for(let t=0;t<u.length;t+=3)this.indexArray.emplaceBack(l+u[t],l+u[t+2],l+u[t+1]);n.primitiveLength+=u.length/3,n.vertexLength+=e}var a;if(o&&o.polyCount.length>0){if(o.borders){o.vertexArrayOffset=this.centroidVertexArray.length;const t=o.borders,e=this.featuresOnBorder.push(o)-1;for(let i=0;i<4;i++)t[i][0]!==Number.MAX_VALUE&&this.borders[i].push(e)}this.encodeCentroid(o.borders?void 0:o.centroid(),o)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,r,n)}sortBorders(){for(let t=0;t<4;t++)this.borders[t].sort((e,i)=>this.featuresOnBorder[e].borders[t][0]-this.featuresOnBorder[i].borders[t][0])}encodeCentroid(t,e,i=!0){let n,r;if(t)if(0!==t.y){const i=e.span()._mult(this.tileToMeter);n=(Math.max(t.x,1)<<3)+Math.min(7,Math.round(i.x/10)),r=(Math.max(t.y,1)<<3)+Math.min(7,Math.round(i.y/10))}else n=Math.ceil(7*(t.x+450)),r=0;else n=0,r=+i;let o=i?this.centroidVertexArray.length:e.vertexArrayOffset;for(const t of e.polyCount){i&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*t.edges+t.top);for(let e=0;e<2*t.edges;e++)this.centroidVertexArray.emplace(o++,0,r),this.centroidVertexArray.emplace(o++,n,r);for(let e=0;e<t.top;e++)this.centroidVertexArray.emplace(o++,n,r)}}}function Kl(t,e){return t.x===e.x&&(t.x<0||t.x>Ga)||t.y===e.y&&(t.y<0||t.y>Ga)}sr("FillExtrusionBucket",Yl,{omit:["layers","features"]}),sr("PartMetadata",Xl);var Jl={paint:new bo({"fill-extrusion-opacity":new go(Nt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new yo(Nt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new go(Nt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new go(Nt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new vo(Nt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new yo(Nt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new yo(Nt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new go(Nt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Ql(t,e){return t.x*e.x+t.y*e.y}function tu(t,e){if(1===t.length){let i=0;const n=e[i++];let r;for(;!r||n.equals(r);)if(!(r=e[i++]))return 1/0;for(;i<e.length;i++){const o=e[i],a=t[0],s=r.sub(n),l=o.sub(n),u=a.sub(n),c=Ql(s,s),h=Ql(s,l),p=Ql(l,l),d=Ql(u,s),f=Ql(u,l),m=c*p-h*h,g=(p*d-h*f)/m,y=(c*f-h*d)/m,v=n.z*(1-g-y)+r.z*g+o.z*y;if(isFinite(v))return v}return 1/0}{let t=1/0;for(const i of e)t=Math.min(t,i.z);return t}}function eu(t){const e=new r(t[0],t[1]);return e.z=t[2],e}function iu(t,e,i,n,r,o,a,s){const l=a*r.getElevationAt(t,e,!0,!0),u=0!==o[0],c=u?0===o[1]?a*(o[0]/7-450):a*function(t,e,i){const n=Math.floor(e[0]/8),r=Math.floor(e[1]/8),o=10*(e[0]-8*n),a=10*(e[1]-8*r),s=t.getElevationAt(n,r,!0,!0),l=t.getMeterToDEM(i),u=Math.floor(.5*(o*l-1)),c=Math.floor(.5*(a*l-1)),h=t.tileCoordToPixel(n,r),p=2*u+1,d=2*c+1,f=function(t,e,i,n,r){return[t.getElevationAtPixel(e,i,!0),t.getElevationAtPixel(e+r,i,!0),t.getElevationAtPixel(e,i+r,!0),t.getElevationAtPixel(e+n,i+r,!0)]}(t,h.x-u,h.y-c,p,d),m=Math.abs(f[0]-f[1]),g=Math.abs(f[2]-f[3]),y=Math.abs(f[0]-f[2])+Math.abs(f[1]-f[3]),v=Math.min(.25,.5*l*(m+g)/p),_=Math.min(.25,.5*l*y/d);return s+Math.max(v*o,_*a)}(r,o,s):l;return{base:l+(0===i)?-1:i,top:u?Math.max(c+n,l+i+2):l+n}}const nu=Io([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:ru}=nu,ou=Io([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:au}=ou,su=Hl.VectorTileFeature.types,lu=.7933533402912352;class uu{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(t=>{this.gradients[t.id]={}}),this.layoutVertexArray=new Do,this.layoutVertexArray2=new Eo,this.indexArray=new Uo,this.programConfigurations=new Ea(t.layers,t.zoom),this.segments=new Ua,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(t,e,i){this.hasPattern=kl("line",this.layers,e);const n=this.layers[0].layout.get("line-sort-key"),r=[];for(const{feature:e,id:o,index:a,sourceLayerIndex:s}of t){const t=this.layers[0]._featureFilter.needGeometry,l=ja(e,t);if(!this.layers[0]._featureFilter.filter(new ao(this.zoom),l,i))continue;const u=n?n.evaluate(l,{},i):void 0,c={id:o,properties:e.properties,type:e.type,sourceLayerIndex:s,index:a,geometry:t?l.geometry:Ha(e),patterns:{},sortKey:u};r.push(c)}n&&r.sort((t,e)=>t.sortKey-e.sortKey);const{lineAtlas:o,featureIndex:a}=e,s=this.addConstantDashes(o);for(const n of r){const{geometry:r,index:l,sourceLayerIndex:u}=n;if(s&&this.addFeatureDashes(n,o),this.hasPattern){const t=Dl("line",this.layers,n,this.zoom,e);this.patternFeatures.push(t)}else this.addFeature(n,r,l,i,o.positions);a.insert(t[l].feature,r,l,u,this.index)}}addConstantDashes(t){let e=!1;for(const i of this.layers){const n=i.paint.get("line-dasharray").value,r=i.layout.get("line-cap").value;if("constant"!==n.kind||"constant"!==r.kind)e=!0;else{const e=r.value,i=n.value;if(!i)continue;t.addDash(i.from,e),t.addDash(i.to,e),i.other&&t.addDash(i.other,e)}}return e}addFeatureDashes(t,e){const i=this.zoom;for(const n of this.layers){const r=n.paint.get("line-dasharray").value,o=n.layout.get("line-cap").value;if("constant"===r.kind&&"constant"===o.kind)continue;let a,s,l,u,c,h;if("constant"===r.kind){const t=r.value;if(!t)continue;a=t.other||t.to,s=t.to,l=t.from}else a=r.evaluate({zoom:i-1},t),s=r.evaluate({zoom:i},t),l=r.evaluate({zoom:i+1},t);"constant"===o.kind?u=c=h=o.value:(u=o.evaluate({zoom:i-1},t),c=o.evaluate({zoom:i},t),h=o.evaluate({zoom:i+1},t)),e.addDash(a,u),e.addDash(s,c),e.addDash(l,h);const p=e.getKey(a,u),d=e.getKey(s,c),f=e.getKey(l,h);t.patterns[n.id]={min:p,mid:d,max:f}}}update(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)}addFeatures(t,e,i){for(const t of this.patternFeatures)this.addFeature(t,t.geometry,t.index,e,i)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,au)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ru),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,e,i,n,r){const o=this.layers[0].layout,a=o.get("line-join").evaluate(t,{}),s=o.get("line-cap").evaluate(t,{}),l=o.get("line-miter-limit"),u=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const i of e)this.addLine(i,t,a,s,l,u);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,r,n)}addLine(t,e,i,n,r,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let e=0;e<t.length-1;e++)this.totalDistance+=t[e].dist(t[e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const a="Polygon"===su[e.type];let s=t.length;for(;s>=2&&t[s-1].equals(t[s-2]);)s--;let l=0;for(;l<s-1&&t[l].equals(t[l+1]);)l++;if(s<(a?3:2))return;"bevel"===i&&(r=1.05);const u=this.overscaling<=16?122880/(512*this.overscaling):0,c=this.segments.prepareSegment(10*s,this.layoutVertexArray,this.indexArray);let h,p,d,f,m;this.e1=this.e2=-1,a&&(h=t[s-2],m=t[l].sub(h)._unit()._perp());for(let e=l;e<s;e++){if((d=e===s-1?a?t[l+1]:void 0:t[e+1])&&t[e].equals(d))continue;m&&(f=m),h&&(p=h),h=t[e],m=d?d.sub(h)._unit()._perp():f;let g=(f=f||m).add(m);0===g.x&&0===g.y||g._unit();const y=f.x*m.x+f.y*m.y,v=g.x*m.x+g.y*m.y,_=0!==v?1/v:1/0,x=2*Math.sqrt(2-2*v),b=v<lu&&p&&d,w=f.x*m.y-f.y*m.x>0;if(b&&e>l){const t=h.dist(p);if(t>2*u){const e=h.sub(h.sub(p)._mult(u/t)._round());this.updateDistance(p,e),this.addCurrentVertex(e,f,0,0,c),p=e}}const S=p&&d;let T=S?i:a?"butt":n;if(S&&"round"===T&&(_<o?T="miter":_<=2&&(T="fakeround")),"miter"===T&&_>r&&(T="bevel"),"bevel"===T&&(_>2&&(T="flipbevel"),_<r&&(T="miter")),p&&this.updateDistance(p,h),"miter"===T)g._mult(_),this.addCurrentVertex(h,g,0,0,c);else if("flipbevel"===T){if(_>100)g=m.mult(-1);else{const t=_*f.add(m).mag()/f.sub(m).mag();g._perp()._mult(t*(w?-1:1))}this.addCurrentVertex(h,g,0,0,c),this.addCurrentVertex(h,g.mult(-1),0,0,c)}else if("bevel"===T||"fakeround"===T){const t=-Math.sqrt(_*_-1),e=w?t:0,i=w?0:t;if(p&&this.addCurrentVertex(h,f,e,i,c),"fakeround"===T){const t=Math.round(180*x/Math.PI/20);for(let e=1;e<t;e++){let i=e/t;if(.5!==i){const t=i-.5;i+=i*t*(i-1)*((1.0904+y*(y*(3.55645-1.43519*y)-3.2452))*t*t+(.848013+y*(.215638*y-1.06021)))}const n=m.sub(f)._mult(i)._add(f)._unit()._mult(w?-1:1);this.addHalfVertex(h,n.x,n.y,!1,w,0,c)}}d&&this.addCurrentVertex(h,m,-e,-i,c)}else if("butt"===T)this.addCurrentVertex(h,g,0,0,c);else if("square"===T){const t=p?1:-1;p||this.addCurrentVertex(h,g,t,t,c),this.addCurrentVertex(h,g,0,0,c),p&&this.addCurrentVertex(h,g,t,t,c)}else"round"===T&&(p&&(this.addCurrentVertex(h,f,0,0,c),this.addCurrentVertex(h,f,1,1,c,!0)),d&&(this.addCurrentVertex(h,m,-1,-1,c,!0),this.addCurrentVertex(h,m,0,0,c)));if(b&&e<s-1){const t=h.dist(d);if(t>2*u){const e=h.add(d.sub(h)._mult(u/t)._round());this.updateDistance(h,e),this.addCurrentVertex(e,m,0,0,c),h=e}}}}addCurrentVertex(t,e,i,n,r,o=!1){const a=e.y*n-e.x,s=-e.y-e.x*n;this.addHalfVertex(t,e.x+e.y*i,e.y-e.x*i,o,!1,i,r),this.addHalfVertex(t,a,s,o,!0,-n,r)}addHalfVertex({x:t,y:e},i,n,r,o,a,s){this.layoutVertexArray.emplaceBack((t<<1)+(r?1:0),(e<<1)+(o?1:0),Math.round(63*i)+128,Math.round(63*n)+128,1+(0===a?0:a<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length);const l=s.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,l),s.primitiveLength++),o?this.e2=l:this.e1=l}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,e){this.distance+=t.dist(e),this.updateScaledDistance()}}sr("LineBucket",uu,{omit:["layers","patternFeatures"]});const cu=new bo({"line-cap":new yo(Nt.layout_line["line-cap"]),"line-join":new yo(Nt.layout_line["line-join"]),"line-miter-limit":new go(Nt.layout_line["line-miter-limit"]),"line-round-limit":new go(Nt.layout_line["line-round-limit"]),"line-sort-key":new yo(Nt.layout_line["line-sort-key"])});var hu={paint:new bo({"line-opacity":new yo(Nt.paint_line["line-opacity"]),"line-color":new yo(Nt.paint_line["line-color"]),"line-translate":new go(Nt.paint_line["line-translate"]),"line-translate-anchor":new go(Nt.paint_line["line-translate-anchor"]),"line-width":new yo(Nt.paint_line["line-width"]),"line-gap-width":new yo(Nt.paint_line["line-gap-width"]),"line-offset":new yo(Nt.paint_line["line-offset"]),"line-blur":new yo(Nt.paint_line["line-blur"]),"line-dasharray":new vo(Nt.paint_line["line-dasharray"]),"line-pattern":new vo(Nt.paint_line["line-pattern"]),"line-gradient":new xo(Nt.paint_line["line-gradient"])}),layout:cu};const pu=new class extends yo{possiblyEvaluate(t,e){return e=new ao(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,i,n){return e=_({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,i,n)}}(hu.paint.properties["line-width"].specification);function du(t,e){return e>0?e+2*t:t}pu.useIntegerZoom=!0;const fu=Io([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),mu=Io([{name:"a_projected_pos",components:3,type:"Float32"}],4);Io([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const gu=Io([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),yu=Io([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Io([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const vu=Io([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),_u=Io([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Io([{name:"triangle",components:3,type:"Uint16"}]),Io([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Io([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Io([{type:"Float32",name:"offsetX"}]),Io([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var xu=24;const bu=128;function wu(t,e){const{expression:i}=e;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new ao(t+1))};if("source"===i.kind)return{kind:"source"};{const{zoomStops:e,interpolationType:n}=i;let r=0;for(;r<e.length&&e[r]<=t;)r++;let o=r=Math.max(0,r-1);for(;o<e.length&&e[o]<t+1;)o++;o=Math.min(e.length-1,o);const a=e[r],s=e[o];return"composite"===i.kind?{kind:"composite",minZoom:a,maxZoom:s,interpolationType:n}:{kind:"camera",minZoom:a,maxZoom:s,minSize:i.evaluate(new ao(a)),maxSize:i.evaluate(new ao(s)),interpolationType:n}}}function Su(t,{uSize:e,uSizeT:i},{lowerSize:n,upperSize:r}){return"source"===t.kind?n/bu:"composite"===t.kind?ii(n/bu,r/bu,i):e}function Tu(t,e){let i=0,n=0;if("constant"===t.kind)n=t.layoutSize;else if("source"!==t.kind){const{interpolationType:r,minZoom:o,maxZoom:a}=t,s=r?m(bi.interpolationFactor(r,e,o,a),0,1):0;"camera"===t.kind?n=ii(t.minSize,t.maxSize,s):i=s}return{uSizeT:i,uSize:n}}var Mu=Object.freeze({__proto__:null,getSizeData:wu,evaluateSizeForFeature:Su,evaluateSizeForZoom:Tu,SIZE_PACK_FACTOR:bu});function Iu(t,e,i){return t.sections.forEach(t=>{t.text=function(t,e,i){const n=e.layout.get("text-transform").evaluate(i,{});return"uppercase"===n?t=t.toLocaleUpperCase():"lowercase"===n&&(t=t.toLocaleLowerCase()),oo.applyArabicShaping&&(t=oo.applyArabicShaping(t)),t}(t.text,e,i)}),t}const Cu={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Au=function(t,e,i,n,r){var o,a,s=8*r-n-1,l=(1<<s)-1,u=l>>1,c=-7,h=i?r-1:0,p=i?-1:1,d=t[e+h];for(h+=p,o=d&(1<<-c)-1,d>>=-c,c+=s;c>0;o=256*o+t[e+h],h+=p,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=256*a+t[e+h],h+=p,c-=8);if(0===o)o=1-u;else{if(o===l)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),o-=u}return(d?-1:1)*a*Math.pow(2,o-n)},ku=function(t,e,i,n,r,o){var a,s,l,u=8*o-r-1,c=(1<<u)-1,h=c>>1,p=23===r?5.960464477539062e-8:0,d=n?0:o-1,f=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(isNaN(e=Math.abs(e))||e===1/0?(s=isNaN(e)?1:0,a=c):(e*(l=Math.pow(2,-(a=Math.floor(Math.log(e)/Math.LN2))))<1&&(a--,l*=2),(e+=a+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(e*l-1)*Math.pow(2,r),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,r),a=0));r>=8;t[i+d]=255&s,d+=f,s/=256,r-=8);for(a=a<<r|s,u+=r;u>0;t[i+d]=255&a,d+=f,a/=256,u-=8);t[i+d-f]|=128*m},Du=Eu;function Eu(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Eu.Varint=0,Eu.Fixed64=1,Eu.Bytes=2,Eu.Fixed32=5;var Pu=4294967296,Lu=1/Pu,zu="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Ou(t){return t.type===Eu.Bytes?t.readVarint()+t.pos:t.pos+1}function Ru(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function Bu(t,e,i){var n=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(n);for(var r=i.pos-1;r>=t;r--)i.buf[r+n]=i.buf[r]}function Nu(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function Fu(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function Vu(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function Uu(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function Gu(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function $u(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function Wu(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function Hu(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function ju(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function Zu(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function qu(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function Xu(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function Yu(t,e,i){1===t&&i.readMessage(Ku,e)}function Ku(t,e,i){if(3===t){const{id:t,bitmap:n,width:r,height:o,left:a,top:s,advance:l}=i.readMessage(Ju,{});e.push({id:t,bitmap:new Gs({width:r+6,height:o+6},n),metrics:{width:r,height:o,left:a,top:s,advance:l}})}}function Ju(t,e,i){1===t?e.id=i.readVarint():2===t?e.bitmap=i.readBytes():3===t?e.width=i.readVarint():4===t?e.height=i.readVarint():5===t?e.left=i.readSVarint():6===t?e.top=i.readSVarint():7===t&&(e.advance=i.readVarint())}function Qu(t){let e=0,i=0;for(const n of t)e+=n.w*n.h,i=Math.max(i,n.w);t.sort((t,e)=>e.h-t.h);const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let r=0,o=0;for(const e of t)for(let t=n.length-1;t>=0;t--){const i=n[t];if(!(e.w>i.w||e.h>i.h)){if(e.x=i.x,e.y=i.y,o=Math.max(o,e.y+e.h),r=Math.max(r,e.x+e.w),e.w===i.w&&e.h===i.h){const e=n.pop();t<n.length&&(n[t]=e)}else e.h===i.h?(i.x+=e.w,i.w-=e.w):e.w===i.w?(i.y+=e.h,i.h-=e.h):(n.push({x:i.x+e.w,y:i.y,w:i.w-e.w,h:e.h}),i.y+=e.h,i.h-=e.h);break}}return{w:r,h:o,fill:e/(r*o)||0}}Eu.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var n=this.readVarint(),r=n>>3,o=this.pos;this.type=7&n,t(r,e,this),this.pos===o&&this.skip(n)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Zu(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Xu(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Zu(this.buf,this.pos)+Zu(this.buf,this.pos+4)*Pu;return this.pos+=8,t},readSFixed64:function(){var t=Zu(this.buf,this.pos)+Xu(this.buf,this.pos+4)*Pu;return this.pos+=8,t},readFloat:function(){var t=Au(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Au(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,n=this.buf;return e=127&(i=n[this.pos++]),i<128?e:(e|=(127&(i=n[this.pos++]))<<7,i<128?e:(e|=(127&(i=n[this.pos++]))<<14,i<128?e:(e|=(127&(i=n[this.pos++]))<<21,i<128?e:function(t,e,i){var n,r,o=i.buf;if(n=(112&(r=o[i.pos++]))>>4,r<128)return Ru(t,n,e);if(n|=(127&(r=o[i.pos++]))<<3,r<128)return Ru(t,n,e);if(n|=(127&(r=o[i.pos++]))<<10,r<128)return Ru(t,n,e);if(n|=(127&(r=o[i.pos++]))<<17,r<128)return Ru(t,n,e);if(n|=(127&(r=o[i.pos++]))<<24,r<128)return Ru(t,n,e);if(n|=(1&(r=o[i.pos++]))<<31,r<128)return Ru(t,n,e);throw Error("Expected varint not more than 10 bytes")}(e|=(15&(i=n[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&zu?function(t,e,i){return zu.decode(t.subarray(e,i))}(this.buf,e,t):function(t,e,i){for(var n="",r=e;r<i;){var o,a,s,l=t[r],u=null,c=l>239?4:l>223?3:l>191?2:1;if(r+c>i)break;1===c?l<128&&(u=l):2===c?128==(192&(o=t[r+1]))&&(u=(31&l)<<6|63&o)<=127&&(u=null):3===c?(a=t[r+2],128==(192&(o=t[r+1]))&&128==(192&a)&&((u=(15&l)<<12|(63&o)<<6|63&a)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(a=t[r+2],s=t[r+3],128==(192&(o=t[r+1]))&&128==(192&a)&&128==(192&s)&&((u=(15&l)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(n+=String.fromCharCode((u-=65536)>>>10&1023|55296),u=56320|1023&u),n+=String.fromCharCode(u),r+=c}return n}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Eu.Bytes)return t.push(this.readVarint(e));var i=Ou(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Eu.Bytes)return t.push(this.readSVarint());var e=Ou(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Eu.Bytes)return t.push(this.readBoolean());var e=Ou(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Eu.Bytes)return t.push(this.readFloat());var e=Ou(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Eu.Bytes)return t.push(this.readDouble());var e=Ou(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Eu.Bytes)return t.push(this.readFixed32());var e=Ou(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Eu.Bytes)return t.push(this.readSFixed32());var e=Ou(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Eu.Bytes)return t.push(this.readFixed64());var e=Ou(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Eu.Bytes)return t.push(this.readSFixed64());var e=Ou(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Eu.Varint)for(;this.buf[this.pos++]>127;);else if(e===Eu.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Eu.Fixed32)this.pos+=4;else{if(e!==Eu.Fixed64)throw Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),qu(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),qu(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),qu(this.buf,-1&t,this.pos),qu(this.buf,Math.floor(t*Lu),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),qu(this.buf,-1&t,this.pos),qu(this.buf,Math.floor(t*Lu),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var i,n;if(t>=0?(i=t%4294967296|0,n=t/4294967296|0):(n=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:(i=0,n=n+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,i){i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,i.buf[i.pos]=127&(t>>>=7)}(i,0,e),function(t,e){var i=(7&t)<<4;e.buf[e.pos++]|=i|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(n,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t+="",this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,i){for(var n,r,o=0;o<e.length;o++){if((n=e.charCodeAt(o))>55295&&n<57344){if(!r){n>56319||o+1===e.length?(t[i++]=239,t[i++]=191,t[i++]=189):r=n;continue}if(n<56320){t[i++]=239,t[i++]=191,t[i++]=189,r=n;continue}n=r-55296<<10|n-56320|65536,r=null}else r&&(t[i++]=239,t[i++]=191,t[i++]=189,r=null);n<128?t[i++]=n:(n<2048?t[i++]=n>>6|192:(n<65536?t[i++]=n>>12|224:(t[i++]=n>>18|240,t[i++]=n>>12&63|128),t[i++]=n>>6&63|128),t[i++]=63&n|128)}return i}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&Bu(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),ku(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ku(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var n=this.pos-i;n>=128&&Bu(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n},writeMessage:function(t,e,i){this.writeTag(t,Eu.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Nu,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Fu,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Gu,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,Vu,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Uu,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,$u,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Wu,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Hu,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,ju,e)},writeBytesField:function(t,e){this.writeTag(t,Eu.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Eu.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Eu.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Eu.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Eu.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Eu.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Eu.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Eu.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Eu.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Eu.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};class tc{constructor(t,{pixelRatio:e,version:i,stretchX:n,stretchY:r,content:o}){this.paddedRect=t,this.pixelRatio=e,this.stretchX=n,this.stretchY=r,this.content=o,this.version=i}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class ec{constructor(t,e){const i={},n={};this.haveRenderCallbacks=[];const r=[];this.addImages(t,i,r),this.addImages(e,n,r);const{w:o,h:a}=Qu(r),s=new $s({width:o||1,height:a||1});for(const e in t){const n=t[e],r=i[e].paddedRect;$s.copy(n.data,s,{x:0,y:0},{x:r.x+1,y:r.y+1},n.data)}for(const t in e){const i=e[t],r=n[t].paddedRect,o=r.x+1,a=r.y+1,l=i.data.width,u=i.data.height;$s.copy(i.data,s,{x:0,y:0},{x:o,y:a},i.data),$s.copy(i.data,s,{x:0,y:u-1},{x:o,y:a-1},{width:l,height:1}),$s.copy(i.data,s,{x:0,y:0},{x:o,y:a+u},{width:l,height:1}),$s.copy(i.data,s,{x:l-1,y:0},{x:o-1,y:a},{width:1,height:u}),$s.copy(i.data,s,{x:0,y:0},{x:o+l,y:a},{width:1,height:u})}this.image=s,this.iconPositions=i,this.patternPositions=n}addImages(t,e,i){for(const n in t){const r=t[n],o={x:0,y:0,w:r.data.width+2,h:r.data.height+2};i.push(o),e[n]=new tc(o,r),r.hasRenderCallback&&this.haveRenderCallbacks.push(n)}}patchUpdatedImages(t,e){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const i in t.updatedImages)this.patchUpdatedImage(this.iconPositions[i],t.getImage(i),e),this.patchUpdatedImage(this.patternPositions[i],t.getImage(i),e)}patchUpdatedImage(t,e,i){if(!t||!e)return;if(t.version===e.version)return;t.version=e.version;const[n,r]=t.tl;i.update(e.data,void 0,{x:n,y:r})}}sr("ImagePosition",tc),sr("ImageAtlas",ec);const ic={horizontal:1,vertical:2,horizontalOnly:3},nc=-17;class rc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,e){const i=new rc;return i.scale=t||1,i.fontStack=e,i}static forImage(t){const e=new rc;return e.imageName=t,e}}class oc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,e){const i=new oc;for(let n=0;n<t.sections.length;n++){const r=t.sections[n];r.image?i.addImageSection(r):i.addTextSection(r,e)}return i}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let e="";for(let i=0;i<t.length;i++){const n=t.charCodeAt(i+1)||null,r=t.charCodeAt(i-1)||null;e+=n&&Wr(n)&&!Cu[t[i+1]]||r&&Wr(r)&&!Cu[t[i-1]]||!Cu[t[i]]?t[i]:Cu[t[i]]}return e}(this.text)}trim(){let t=0;for(let e=0;e<this.text.length&&sc[this.text.charCodeAt(e)];e++)t++;let e=this.text.length;for(let i=this.text.length-1;i>=0&&i>=t&&sc[this.text.charCodeAt(i)];i--)e--;this.text=this.text.substring(t,e),this.sectionIndex=this.sectionIndex.slice(t,e)}substring(t,e){const i=new oc;return i.text=this.text.substring(t,e),i.sectionIndex=this.sectionIndex.slice(t,e),i.sections=this.sections,i}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,e)=>Math.max(t,this.sections[e].scale),0)}addTextSection(t,e){this.text+=t.text,this.sections.push(rc.forText(t.scale,t.fontStack||e));const i=this.sections.length-1;for(let e=0;e<t.text.length;++e)this.sectionIndex.push(i)}addImageSection(t){const e=t.image?t.image.name:"";if(0===e.length)return void E("Can't add FormattedSection with an empty image.");const i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(rc.forImage(e)),this.sectionIndex.push(this.sections.length-1)):E("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ac(t,e,i,n,r,o,a,s,l,u,c,h,p,d,f,m){const g=oc.fromFeature(t,r);let y;h===ic.vertical&&g.verticalizePunctuation();const{processBidirectionalText:v,processStyledBidirectionalText:_}=oo;if(v&&1===g.sections.length){y=[];const t=v(g.toString(),fc(g,u,o,e,n,d,f));for(const e of t){const t=new oc;t.text=e,t.sections=g.sections;for(let i=0;i<e.length;i++)t.sectionIndex.push(0);y.push(t)}}else if(_){y=[];const t=_(g.text,g.sectionIndex,fc(g,u,o,e,n,d,f));for(const e of t){const t=new oc;t.text=e[0],t.sectionIndex=e[1],t.sections=g.sections,y.push(t)}}else y=function(t,e){const i=[],n=t.text;let r=0;for(const n of e)i.push(t.substring(r,n)),r=n;return r<n.length&&i.push(t.substring(r,n.length)),i}(g,fc(g,u,o,e,n,d,f));const x=[],b={positionedLines:x,text:g.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:h,iconsInText:!1,verticalizable:!1};return function(t,e,i,n,r,o,a,s,l,u,c,h){let p=0,d=nc,f=0,m=0;const g="right"===s?1:"left"===s?0:.5;let y=0;for(const a of r){a.trim();const r=a.getMaxScale(),s=(r-1)*xu,_={positionedGlyphs:[],lineOffset:0};t.positionedLines[y]=_;const x=_.positionedGlyphs;let b=0;if(!a.length()){d+=o,++y;continue}for(let o=0;o<a.length();o++){const f=a.getSection(o),m=a.getSectionIndex(o),g=a.getCharCode(o);let y=0,_=null,w=null,S=null,T=xu;const M=!(l===ic.horizontal||!c&&!$r(g)||c&&(sc[g]||(v=g,dr(v)||fr(v)||mr(v)||zr(v)||Nr(v))));if(f.imageName){const e=n[f.imageName];if(!e)continue;S=f.imageName,t.iconsInText=t.iconsInText||!0,w=e.paddedRect;const i=e.displaySize;f.scale=f.scale*xu/h,_={width:i[0],height:i[1],left:1,top:-3,advance:M?i[1]:i[0],localGlyph:!1},y=s+(xu-i[1]*f.scale),T=_.advance;const o=M?i[0]*f.scale-xu*r:i[1]*f.scale-xu*r;o>0&&o>b&&(b=o)}else{const t=i[f.fontStack],n=t&&t[g];if(n&&n.rect)w=n.rect,_=n.metrics;else{const t=e[f.fontStack],i=t&&t[g];if(!i)continue;_=i.metrics}y=(r-f.scale)*xu}M?(t.verticalizable=!0,x.push({glyph:g,imageName:S,x:p,y:d+y,vertical:M,scale:f.scale,localGlyph:_.localGlyph,fontStack:f.fontStack,sectionIndex:m,metrics:_,rect:w}),p+=T*f.scale+u):(x.push({glyph:g,imageName:S,x:p,y:d+y,vertical:M,scale:f.scale,localGlyph:_.localGlyph,fontStack:f.fontStack,sectionIndex:m,metrics:_,rect:w}),p+=_.advance*f.scale+u)}0!==x.length&&(f=Math.max(p-u,f),gc(x,0,x.length-1,g,b)),p=0;const w=o*r+b;_.lineOffset=Math.max(b,s),d+=w,m=Math.max(w,m),++y}var v;const _=d-nc,{horizontalAlign:x,verticalAlign:b}=mc(a);(function(t,e,i,n,r,o,a,s,l){const u=(e-i)*r;let c=0;c=o!==a?-s*n-nc:(-n*l+.5)*a;for(const e of t)for(const t of e.positionedGlyphs)t.x+=u,t.y+=c})(t.positionedLines,g,x,b,f,m,o,_,r.length),t.top+=-b*_,t.bottom=t.top+_,t.left+=-x*f,t.right=t.left+f}(b,e,i,n,y,a,s,l,h,u,p,m),!function(t){for(const e of t)if(0!==e.positionedGlyphs.length)return!1;return!0}(x)&&b}const sc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},lc={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function uc(t,e,i,n,r,o){if(e.imageName){const t=n[e.imageName];return t?t.displaySize[0]*e.scale*xu/o+r:0}{const n=i[e.fontStack],o=n&&n[t];return o?o.metrics.advance*e.scale+r:0}}function cc(t,e,i,n){const r=Math.pow(t-e,2);return n?t<e?r/2:2*r:r+Math.abs(i)*i}function hc(t,e,i){let n=0;return 10===t&&(n-=1e4),i&&(n+=150),40!==t&&65288!==t||(n+=50),41!==e&&65289!==e||(n+=50),n}function pc(t,e,i,n,r,o){let a=null,s=cc(e,i,r,o);for(const t of n){const n=cc(e-t.x,i,r,o)+t.badness;n<=s&&(a=t,s=n)}return{index:t,x:e,priorBreak:a,badness:s}}function dc(t){return t?dc(t.priorBreak).concat(t.index):[]}function fc(t,e,i,n,r,o,a){if("point"!==o)return[];if(!t)return[];const s=[],l=function(t,e,i,n,r,o){let a=0;for(let i=0;i<t.length();i++){const s=t.getSection(i);a+=uc(t.getCharCode(i),s,n,r,e,o)}return a/Math.max(1,Math.ceil(a/i))}(t,e,i,n,r,a),u=t.text.indexOf("​")>=0;let c=0;for(let i=0;i<t.length();i++){const o=t.getSection(i),p=t.getCharCode(i);if(sc[p]||(c+=uc(p,o,n,r,e,a)),i<t.length()-1){const e=!((h=p)<11904||!(Sr(h)||wr(h)||Rr(h)||Lr(h)||Cr(h)||gr(h)||Tr(h)||_r(h)||Ar(h)||kr(h)||Ir(h)||Fr(h)||xr(h)||vr(h)||yr(h)||Mr(h)||br(h)||Or(h)||Er(h)||Dr(h)));(lc[p]||e||o.imageName)&&s.push(pc(i+1,c,l,s,hc(p,t.getCharCode(i+1),e&&u),!1))}}var h;return dc(pc(t.length(),c,l,s,0,!0))}function mc(t){let e=.5,i=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function gc(t,e,i,n,r){if(!n&&!r)return;const o=t[i],a=(t[i].x+o.metrics.advance*o.scale)*n;for(let n=e;n<=i;n++)t[n].x-=a,t[n].y+=r}function yc(t,e,i){const{horizontalAlign:n,verticalAlign:r}=mc(i),o=e[0]-t.displaySize[0]*n,a=e[1]-t.displaySize[1]*r;return{image:t,top:a,bottom:a+t.displaySize[1],left:o,right:o+t.displaySize[0]}}function vc(t,e,i,n,r,o){const a=t.image;let s;if(a.content){const t=a.content,e=a.pixelRatio||1;s=[t[0]/e,t[1]/e,a.displaySize[0]-t[2]/e,a.displaySize[1]-t[3]/e]}const l=e.left*o,u=e.right*o;let c,h,p,d;"width"===i||"both"===i?(d=r[0]+l-n[3],h=r[0]+u+n[1]):h=(d=r[0]+(l+u-a.displaySize[0])/2)+a.displaySize[0];const f=e.top*o,m=e.bottom*o;return"height"===i||"both"===i?(c=r[1]+f-n[0],p=r[1]+m+n[2]):p=(c=r[1]+(f+m-a.displaySize[1])/2)+a.displaySize[1],{image:a,top:c,right:h,bottom:p,left:d,collisionPadding:s}}class _c extends r{constructor(t,e,i,n){super(t,e),this.angle=i,void 0!==n&&(this.segment=n)}clone(){return new _c(this.x,this.y,this.angle,this.segment)}}function xc(t,e,i,n,r){if(void 0===e.segment)return!0;let o=e,a=e.segment+1,s=0;for(;s>-i/2;){if(--a<0)return!1;s-=t[a].dist(o),o=t[a]}s+=t[a].dist(t[a+1]),a++;const l=[];let u=0;for(;s<i/2;){const e=t[a],i=t[a+1];if(!i)return!1;let o=t[a-1].angleTo(e)-e.angleTo(i);for(o=Math.abs((o+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:o}),u+=o;s-l[0].distance>n;)u-=l.shift().angleDelta;if(u>r)return!1;a++,s+=e.dist(i)}return!0}function bc(t){let e=0;for(let i=0;i<t.length-1;i++)e+=t[i].dist(t[i+1]);return e}function wc(t,e,i){return t?.6*e*i:0}function Sc(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Tc(t,e,i,n,r,o){const a=wc(i,r,o),s=Sc(i,n)*o;let l=0;const u=bc(t)/2;for(let i=0;i<t.length-1;i++){const n=t[i],r=t[i+1],o=n.dist(r);if(l+o>u){const c=(u-l)/o,h=ii(n.x,r.x,c),p=ii(n.y,r.y,c),d=new _c(h,p,r.angleTo(n),i);return d._round(),!a||xc(t,d,s,a,e)?d:void 0}l+=o}}function Mc(t,e,i,n,r,o,a,s,l){const u=wc(n,o,a),c=Sc(n,r),h=c*a,p=0===t[0].x||t[0].x===l||0===t[0].y||t[0].y===l;return e-h<e/4&&(e=h+e/4),Ic(t,p?e/2*s%e:(c/2+2*o)*a*s%e,e,u,i,h,p,!1,l)}function Ic(t,e,i,n,r,o,a,s,l){const u=o/2,c=bc(t);let h=0,p=e-i,d=[];for(let e=0;e<t.length-1;e++){const a=t[e],s=t[e+1],f=a.dist(s),m=s.angleTo(a);for(;p+i<h+f;){const g=((p+=i)-h)/f,y=ii(a.x,s.x,g),v=ii(a.y,s.y,g);if(y>=0&&y<l&&v>=0&&v<l&&p-u>=0&&p+u<=c){const i=new _c(y,v,m,e);i._round(),n&&!xc(t,i,o,n,r)||d.push(i)}}h+=f}return s||d.length||a||(d=Ic(t,h/2,i,n,r,o,a,!0,l)),d}function Cc(t,e,i,n,o){const a=[];for(let s=0;s<t.length;s++){const l=t[s];let u;for(let t=0;t<l.length-1;t++){let s=l[t],c=l[t+1];s.x<e&&c.x<e||(s.x<e?s=new r(e,s.y+(e-s.x)/(c.x-s.x)*(c.y-s.y))._round():c.x<e&&(c=new r(e,s.y+(e-s.x)/(c.x-s.x)*(c.y-s.y))._round()),s.y<i&&c.y<i||(s.y<i?s=new r(s.x+(i-s.y)/(c.y-s.y)*(c.x-s.x),i)._round():c.y<i&&(c=new r(s.x+(i-s.y)/(c.y-s.y)*(c.x-s.x),i)._round()),s.x>=n&&c.x>=n||(s.x>=n?s=new r(n,s.y+(n-s.x)/(c.x-s.x)*(c.y-s.y))._round():c.x>=n&&(c=new r(n,s.y+(n-s.x)/(c.x-s.x)*(c.y-s.y))._round()),s.y>=o&&c.y>=o||(s.y>=o?s=new r(s.x+(o-s.y)/(c.y-s.y)*(c.x-s.x),o)._round():c.y>=o&&(c=new r(s.x+(o-s.y)/(c.y-s.y)*(c.x-s.x),o)._round()),u&&s.equals(u[u.length-1])||(u=[s],a.push(u)),u.push(c)))))}}return a}sr("Anchor",_c);var Ac=Ec,kc=Ec,Dc=1e20;function Ec(t,e,i,n,r,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=n||.25,this.fontFamily=r||"sans-serif",this.fontWeight=o||"normal",this.radius=i||8;var a=this.size=this.fontSize+2*this.buffer,s=a+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=a,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(a/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Pc(t,e,i,n,r,o){for(var a=0;a<e;a++)Lc(t,a,e,i,n,r,o);for(var s=0;s<i;s++)Lc(t,s*e,1,e,n,r,o)}function Lc(t,e,i,n,r,o,a){var s,l,u,c;for(o[0]=0,a[0]=-Dc,a[1]=Dc,s=0;s<n;s++)r[s]=t[e+s*i];for(s=1,l=0,u=0;s<n;s++){do{u=(r[s]-r[c=o[l]]+s*s-c*c)/(s-c)/2}while(u<=a[l]&&--l>-1);o[++l]=s,a[l]=u,a[l+1]=Dc}for(s=0,l=0;s<n;s++){for(;a[l+1]<s;)l++;t[e+s*i]=r[c=o[l]]+(s-c)*(s-c)}}Ec.prototype._draw=function(t,e){var i,n,r,o,a,s,l,u,c,h=this.ctx.measureText(t),p=h.width,d=2*this.buffer;e&&this.useMetrics?(a=Math.floor(h.actualBoundingBoxAscent),u=this.buffer+Math.ceil(h.actualBoundingBoxAscent),s=this.buffer,l=this.buffer,i=(n=Math.min(this.size,Math.ceil(h.actualBoundingBoxRight-h.actualBoundingBoxLeft)))+d,r=(o=Math.min(this.size-s,Math.ceil(h.actualBoundingBoxAscent+h.actualBoundingBoxDescent)))+d,this.ctx.textBaseline="alphabetic"):(i=n=this.size,r=o=this.size,a=19*this.fontSize/24,s=l=0,u=this.middle,this.ctx.textBaseline="middle"),n&&o&&(this.ctx.clearRect(l,s,n,o),this.ctx.fillText(t,this.buffer,u),c=this.ctx.getImageData(l,s,n,o));var f=new Uint8ClampedArray(i*r);return function(t,e,i,n,r,o,a){o.fill(Dc,0,e*i),a.fill(0,0,e*i);for(var s=(e-n)/2,l=0;l<r;l++)for(var u=0;u<n;u++){var c=(l+s)*e+u+s,h=t.data[4*(l*n+u)+3]/255;if(1===h)o[c]=0,a[c]=Dc;else if(0===h)o[c]=Dc,a[c]=0;else{var p=Math.max(0,.5-h),d=Math.max(0,h-.5);o[c]=p*p,a[c]=d*d}}}(c,i,r,n,o,this.gridOuter,this.gridInner),Pc(this.gridOuter,i,r,this.f,this.v,this.z),Pc(this.gridInner,i,r,this.f,this.v,this.z),function(t,e,i,n,r,o,a){for(var s=0;s<e*i;s++){var l=Math.sqrt(n[s])-Math.sqrt(r[s]);t[s]=Math.round(255-255*(l/o+a))}}(f,i,r,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:f,metrics:{width:n,height:o,sdfWidth:i,sdfHeight:r,top:a,left:0,advance:p}}},Ec.prototype.draw=function(t){return this._draw(t,!1).data},Ec.prototype.drawWithMetrics=function(t){return this._draw(t,!0)},Ac.default=kc;const zc={none:0,ideographs:1,all:2};class Oc{constructor(t,e,i){this.requestManager=t,this.localGlyphMode=e,this.localFontFamily=i,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t){this.url=t}getGlyphs(t,e){const i=[];for(const e in t)for(const n of t[e])i.push({stack:e,id:n});y(i,({stack:t,id:e},i)=>{let n=this.entries[t];n||(n=this.entries[t]={glyphs:{},requests:{},ranges:{}});let r=n.glyphs[e];if(void 0!==r)return void i(null,{stack:t,id:e,glyph:r});if(r=this._tinySDF(n,t,e))return n.glyphs[e]=r,void i(null,{stack:t,id:e,glyph:r});const o=Math.floor(e/256);if(256*o>65535)return void i(Error("glyphs > 65535 not supported"));if(n.ranges[o])return void i(null,{stack:t,id:e,glyph:r});let a=n.requests[o];a||(a=n.requests[o]=[],Oc.loadGlyphRange(t,o,this.url,this.requestManager,(t,e)=>{if(e){for(const t in e)this._doesCharSupportLocalGlyph(+t)||(n.glyphs[+t]=e[+t]);n.ranges[o]=!0}for(const i of a)i(t,e);delete n.requests[o]})),a.push((n,r)=>{n?i(n):r&&i(null,{stack:t,id:e,glyph:r[e]||null})})},(t,i)=>{if(t)e(t);else if(i){const t={};for(const{stack:e,id:n,glyph:r}of i)(t[e]||(t[e]={}))[n]=r&&{id:r.id,bitmap:r.bitmap.clone(),metrics:r.metrics};e(null,t)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==zc.none&&(this.localGlyphMode===zc.all?!!this.localFontFamily:!!this.localFontFamily&&(kr(t)||Pr(t)||xr(t)||br(t)))}_tinySDF(t,e,i){const n=this.localFontFamily;if(!n)return;if(!this._doesCharSupportLocalGlyph(i))return;let r=t.tinySDF;if(!r){let i="400";/bold/i.test(e)?i="900":/medium/i.test(e)?i="500":/light/i.test(e)&&(i="200"),r=t.tinySDF=new Oc.TinySDF(48,6,16,.25,n,i)}if(this.localGlyphs[r.fontWeight][i])return this.localGlyphs[r.fontWeight][i];const{data:o,metrics:a}=r.drawWithMetrics(String.fromCharCode(i)),{sdfWidth:s,sdfHeight:l,width:u,height:c,left:h,top:p,advance:d}=a;return this.localGlyphs[r.fontWeight][i]={id:i,bitmap:new Gs({width:s,height:l},o),metrics:{width:u/2,height:c/2,left:h/2,top:p/2-27,advance:d/2,localGlyph:!0}}}}function Rc(t,e,i,n){const o=[],a=t.image,s=a.pixelRatio,l=a.paddedRect.w-2,u=a.paddedRect.h-2,c=t.right-t.left,h=t.bottom-t.top,p=a.stretchX||[[0,l]],d=a.stretchY||[[0,u]],f=(t,e)=>t+e[1]-e[0],m=p.reduce(f,0),g=d.reduce(f,0),y=l-m,v=u-g;let _=0,x=m,b=0,w=g,S=0,T=y,M=0,I=v;if(a.content&&n){const t=a.content;_=Bc(p,0,t[0]),b=Bc(d,0,t[1]),x=Bc(p,t[0],t[2]),w=Bc(d,t[1],t[3]),S=t[0]-_,M=t[1]-b,T=t[2]-t[0]-x,I=t[3]-t[1]-w}const C=(n,o,l,u)=>{const p=Fc(n.stretch-_,x,c,t.left),d=Vc(n.fixed-S,T,n.stretch,m),f=Fc(o.stretch-b,w,h,t.top),y=Vc(o.fixed-M,I,o.stretch,g),v=Fc(l.stretch-_,x,c,t.left),C=Vc(l.fixed-S,T,l.stretch,m),A=Fc(u.stretch-b,w,h,t.top),k=Vc(u.fixed-M,I,u.stretch,g),D=new r(p,f),E=new r(v,f),P=new r(v,A),L=new r(p,A),z=new r(d/s,y/s),O=new r(C/s,k/s),R=e*Math.PI/180;if(R){const t=Math.sin(R),e=Math.cos(R),i=[e,-t,t,e];D._matMult(i),E._matMult(i),L._matMult(i),P._matMult(i)}const B=n.stretch+n.fixed,N=o.stretch+o.fixed;return{tl:D,tr:E,bl:L,br:P,tex:{x:a.paddedRect.x+1+B,y:a.paddedRect.y+1+N,w:l.stretch+l.fixed-B,h:u.stretch+u.fixed-N},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:z,pixelOffsetBR:O,minFontScaleX:T/s/c,minFontScaleY:I/s/h,isSDF:i}};if(n&&(a.stretchX||a.stretchY)){const t=Nc(p,y,m),e=Nc(d,v,g);for(let i=0;i<t.length-1;i++){const n=t[i],r=t[i+1];for(let t=0;t<e.length-1;t++)o.push(C(n,e[t],r,e[t+1]))}}else o.push(C({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:u+1}));return o}function Bc(t,e,i){let n=0;for(const r of t)n+=Math.max(e,Math.min(i,r[1]))-Math.max(e,Math.min(i,r[0]));return n}function Nc(t,e,i){const n=[{fixed:-1,stretch:0}];for(const[e,i]of t){const t=n[n.length-1];n.push({fixed:e-t.stretch,stretch:t.stretch}),n.push({fixed:e-t.stretch,stretch:t.stretch+(i-e)})}return n.push({fixed:e+1,stretch:i}),n}function Fc(t,e,i,n){return t/e*i+n}function Vc(t,e,i,n){return t-e*i/n}Oc.loadGlyphRange=function(t,e,i,n,r){const o=256*e,a=o+255,s=n.transformRequest(n.normalizeGlyphsURL(i).replace("{fontstack}",t).replace("{range}",`${o}-${a}`),bt.Glyphs);Mt(s,(t,e)=>{if(t)r(t);else if(e){const t={};for(const i of function(t){return new Du(t).readFields(Yu,[])}(e))t[i.id]=i;r(null,t)}})},Oc.TinySDF=Ac;class Uc{constructor(t=[],e=Gc){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:i}=this,n=e[t];for(;t>0;){const r=t-1>>1,o=e[r];if(i(n,o)>=0)break;e[t]=o,t=r}e[t]=n}_down(t){const{data:e,compare:i}=this,n=this.length>>1,r=e[t];for(;t<n;){let n=1+(t<<1),o=e[n];const a=n+1;if(a<this.length&&i(e[a],o)<0&&(n=a,o=e[a]),i(o,r)>=0)break;e[t]=o,t=n}e[t]=r}}function Gc(t,e){return t<e?-1:t>e?1:0}function $c(t,e=1,i=!1){let n=1/0,o=1/0,a=-1/0,s=-1/0;const l=t[0];for(let t=0;t<l.length;t++){const e=l[t];(!t||e.x<n)&&(n=e.x),(!t||e.y<o)&&(o=e.y),(!t||e.x>a)&&(a=e.x),(!t||e.y>s)&&(s=e.y)}const u=Math.min(a-n,s-o);let c=u/2;const h=new Uc([],Wc);if(0===u)return new r(n,o);for(let e=n;e<a;e+=u)for(let i=o;i<s;i+=u)h.push(new Hc(e+c,i+c,c,t));let p=function(t){let e=0,i=0,n=0;const r=t[0];for(let t=0,o=r.length,a=o-1;t<o;a=t++){const o=r[t],s=r[a],l=o.x*s.y-s.x*o.y;i+=(o.x+s.x)*l,n+=(o.y+s.y)*l,e+=3*l}return new Hc(i/e,n/e,0,t)}(t),d=h.length;for(;h.length;){const n=h.pop();(n.d>p.d||!p.d)&&(p=n,i&&console.log("found best %d after %d probes",Math.round(1e4*n.d)/1e4,d)),n.max-p.d<=e||(c=n.h/2,h.push(new Hc(n.p.x-c,n.p.y-c,c,t)),h.push(new Hc(n.p.x+c,n.p.y-c,c,t)),h.push(new Hc(n.p.x-c,n.p.y+c,c,t)),h.push(new Hc(n.p.x+c,n.p.y+c,c,t)),d+=4)}return i&&(console.log(`num probes: ${d}`),console.log(`best distance: ${p.d}`)),p.p}function Wc(t,e){return e.max-t.max}function Hc(t,e,i,n){this.p=new r(t,e),this.h=i,this.d=function(t,e){let i=!1,n=1/0;for(let r=0;r<e.length;r++){const o=e[r];for(let e=0,r=o.length,a=r-1;e<r;a=e++){const r=o[e],s=o[a];r.y>t.y!=s.y>t.y&&t.x<(s.x-r.x)*(t.y-r.y)/(s.y-r.y)+r.x&&(i=!i),n=Math.min(n,is(t,r,s))}}return(i?1:-1)*Math.sqrt(n)}(this.p,n),this.max=this.d+this.h*Math.SQRT2}const jc=1/0;function Zc(t,e){return e[1]!==jc?function(t,e,i){let n=0,r=0;switch(e=Math.abs(e),i=Math.abs(i),t){case"top-right":case"top-left":case"top":r=i-7;break;case"bottom-right":case"bottom-left":case"bottom":r=7-i}switch(t){case"top-right":case"bottom-right":case"right":n=-e;break;case"top-left":case"bottom-left":case"left":n=e}return[n,r]}(t,e[0],e[1]):function(t,e){let i=0,n=0;e<0&&(e=0);const r=e/Math.sqrt(2);switch(t){case"top-right":case"top-left":n=r-7;break;case"bottom-right":case"bottom-left":n=7-r;break;case"bottom":n=7-e;break;case"top":n=e-7}switch(t){case"top-right":case"bottom-right":i=-r;break;case"top-left":case"bottom-left":i=r;break;case"left":i=e;break;case"right":i=-e}return[i,n]}(t,e[0])}function qc(t,e,i,n,r,o,a,s){t.createArrays(),t.tilePixelRatio=Ga/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const l=t.layers[0].layout,u=t.layers[0]._unevaluatedLayout._values,c={};if("composite"===t.textSizeData.kind){const{minZoom:e,maxZoom:i}=t.textSizeData;c.compositeTextSizes=[u["text-size"].possiblyEvaluate(new ao(e),a),u["text-size"].possiblyEvaluate(new ao(i),a)]}if("composite"===t.iconSizeData.kind){const{minZoom:e,maxZoom:i}=t.iconSizeData;c.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new ao(e),a),u["icon-size"].possiblyEvaluate(new ao(i),a)]}c.layoutTextSize=u["text-size"].possiblyEvaluate(new ao(s+1),a),c.layoutIconSize=u["icon-size"].possiblyEvaluate(new ao(s+1),a),c.textMaxSize=u["text-size"].possiblyEvaluate(new ao(18),a);const h="map"===l.get("text-rotation-alignment")&&"point"!==l.get("symbol-placement"),p=l.get("text-keep-upright"),d=l.get("text-size");for(const o of t.features){const s=l.get("text-font").evaluate(o,{},a).join(","),u=d.evaluate(o,{},a),f=c.layoutTextSize.evaluate(o,{},a),m=(c.layoutIconSize.evaluate(o,{},a),{horizontal:{},vertical:void 0}),g=o.text;let y,v=[0,0];if(g){const n=g.toString(),c=l.get("text-letter-spacing").evaluate(o,{},a)*xu,d=l.get("text-line-height").evaluate(o,{},a)*xu,y=Ur(n)?c:0,_=l.get("text-anchor").evaluate(o,{},a),x=l.get("text-variable-anchor");if(!x){const t=l.get("text-radial-offset").evaluate(o,{},a);v=t?Zc(_,[t*xu,jc]):l.get("text-offset").evaluate(o,{},a).map(t=>t*xu)}let b=h?"center":l.get("text-justify").evaluate(o,{},a);const w=l.get("symbol-placement"),S="point"===w?l.get("text-max-width").evaluate(o,{},a)*xu:0,T=()=>{t.allowVerticalPlacement&&Vr(n)&&(m.vertical=ac(g,e,i,r,s,S,d,_,"left",y,v,ic.vertical,!0,w,f,u))};if(!h&&x){const t="auto"===b?x.map(t=>Xc(t)):[b];let n=!1;for(let o=0;o<t.length;o++){const a=t[o];if(!m.horizontal[a])if(n)m.horizontal[a]=m.horizontal[0];else{const t=ac(g,e,i,r,s,S,d,"center",a,y,v,ic.horizontal,!1,w,f,u);t&&(m.horizontal[a]=t,n=1===t.positionedLines.length)}}T()}else{"auto"===b&&(b=Xc(_));const t=ac(g,e,i,r,s,S,d,_,b,y,v,ic.horizontal,!1,w,f,u);t&&(m.horizontal[b]=t),T(),Vr(n)&&h&&p&&(m.vertical=ac(g,e,i,r,s,S,d,_,b,y,v,ic.vertical,!1,w,f,u))}}let _=!1;if(o.icon&&o.icon.name){const e=n[o.icon.name];e&&(y=yc(r[o.icon.name],l.get("icon-offset").evaluate(o,{},a),l.get("icon-anchor").evaluate(o,{},a)),_=e.sdf,void 0===t.sdfIcons?t.sdfIcons=e.sdf:t.sdfIcons!==e.sdf&&E("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(e.pixelRatio!==t.pixelRatio||0!==l.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}const x=Qc(m.horizontal)||m.vertical;t.iconsInText||(t.iconsInText=!!x&&x.iconsInText),(x||y)&&Yc(t,o,m,y,n,c,f,0,v,_,a)}o&&t.generateCollisionDebugBuffers(s,t.collisionBoxArray)}function Xc(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Yc(t,e,i,n,r,o,a,s,l,u,h){let p=o.textMaxSize.evaluate(e,{},h);void 0===p&&(p=a);const d=t.layers[0].layout,f=d.get("icon-offset").evaluate(e,{},h),m=Qc(i.horizontal),g=a/24,y=t.tilePixelRatio*p/24,v=t.tilePixelRatio*d.get("symbol-spacing"),_=d.get("text-padding")*t.tilePixelRatio,x=d.get("icon-padding")*t.tilePixelRatio,b=c(d.get("text-max-angle")),w="map"===d.get("text-rotation-alignment")&&"point"!==d.get("symbol-placement"),S="map"===d.get("icon-rotation-alignment")&&"point"!==d.get("symbol-placement"),T=d.get("symbol-placement"),M=v/2,I=d.get("icon-text-fit");let C;n&&"none"!==I&&(t.allowVerticalPlacement&&i.vertical&&(C=vc(n,i.vertical,I,d.get("icon-text-fit-padding"),f,g)),m&&(n=vc(n,m,I,d.get("icon-text-fit-padding"),f,g)));const A=(s,c)=>{c.x<0||c.x>=Ga||c.y<0||c.y>=Ga||function(t,e,i,n,r,o,a,s,l,u,c,h,p,d,f,m,g,y,v,_,x,b,w,S){const T=t.addToLineVertexArray(e,i);let M,I,C,A,k,D,P,L=0,z=0,O=0,R=0,B=-1,N=-1;const F={};let V=pa(""),U=0,G=0;if(void 0===s._unevaluatedLayout.getValue("text-radial-offset")?[U,G]=s.layout.get("text-offset").evaluate(_,{},w).map(t=>t*xu):(U=s.layout.get("text-radial-offset").evaluate(_,{},w)*xu,G=jc),t.allowVerticalPlacement&&n.vertical){const t=n.vertical;if(d)D=eh(t),a&&(P=eh(a));else{const i=s.layout.get("text-rotate").evaluate(_,{},w)+90;C=th(l,e,u,c,h,t,p,i),a&&(A=th(l,e,u,c,h,a,g,i))}}if(r){const i=s.layout.get("icon-rotate").evaluate(_,{},w),n="none"!==s.layout.get("icon-text-fit"),o=Rc(r,i,b,n),p=a?Rc(a,i,b,n):void 0;I=th(l,e,u,c,h,r,g,i),L=4*o.length;const d=t.iconSizeData;let f=null;"source"===d.kind?(f=[bu*s.layout.get("icon-size").evaluate(_,{},w)])[0]>Kc&&E(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`):"composite"===d.kind&&(((f=[bu*x.compositeIconSizes[0].evaluate(_,{},w),bu*x.compositeIconSizes[1].evaluate(_,{},w)])[0]>Kc||f[1]>Kc)&&E(`${t.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),t.addSymbols(t.icon,o,f,v,y,_,!1,e,T.lineStartIndex,T.lineLength,-1,w),B=t.icon.placedSymbolArray.length-1,p&&(z=4*p.length,t.addSymbols(t.icon,p,f,v,y,_,ic.vertical,e,T.lineStartIndex,T.lineLength,-1,w),N=t.icon.placedSymbolArray.length-1)}for(const i in n.horizontal){const r=n.horizontal[i];M||(V=pa(r.text),d?k=eh(r):M=th(l,e,u,c,h,r,p,s.layout.get("text-rotate").evaluate(_,{},w)));const a=1===r.positionedLines.length;if(O+=Jc(t,e,r,o,s,d,_,f,T,n.vertical?ic.horizontal:ic.horizontalOnly,a?Object.keys(n.horizontal):[i],F,B,x,w),a)break}n.vertical&&(R+=Jc(t,e,n.vertical,o,s,d,_,f,T,ic.vertical,["vertical"],F,N,x,w));let $=-1;const W=(t,e)=>t?Math.max(t,e):e;$=W(k,$),$=W(D,$);const H=($=W(P,$))>-1?1:0;H&&($*=S/xu),t.glyphOffsetArray.length>=ch.MAX_GLYPHS&&E("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==_.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,_.sortKey),t.symbolInstances.emplaceBack(e.x,e.y,F.right>=0?F.right:-1,F.center>=0?F.center:-1,F.left>=0?F.left:-1,F.vertical||-1,B,N,V,void 0!==M?M:t.collisionBoxArray.length,void 0!==M?M+1:t.collisionBoxArray.length,void 0!==C?C:t.collisionBoxArray.length,void 0!==C?C+1:t.collisionBoxArray.length,void 0!==I?I:t.collisionBoxArray.length,void 0!==I?I+1:t.collisionBoxArray.length,A||t.collisionBoxArray.length,A?A+1:t.collisionBoxArray.length,u,O,R,L,z,H,0,U,G,$)}(t,c,s,i,n,r,C,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,_,w,l,0,x,S,f,e,o,u,h,a)};if("line"===T)for(const r of Cc(e.geometry,0,0,Ga,Ga)){const e=Mc(r,v,b,i.vertical||m,n,24,y,t.overscaling,Ga);for(const i of e){const e=m;e&&ih(t,e.text,M,i)||A(r,i)}}else if("line-center"===T){for(const t of e.geometry)if(t.length>1){const e=Tc(t,b,i.vertical||m,n,24,y);e&&A(t,e)}}else if("Polygon"===e.type)for(const t of Cl(e.geometry,0)){const e=$c(t,16);A(t[0],new _c(e.x,e.y,0))}else if("LineString"===e.type)for(const t of e.geometry)A(t,new _c(t[0].x,t[0].y,0));else if("Point"===e.type)for(const t of e.geometry)for(const e of t)A([e],new _c(e.x,e.y,0))}const Kc=32640;function Jc(t,e,i,n,o,a,s,l,u,c,h,p,d,f,m){const g=function(t,e,i,n,o,a,s,l){const u=n.layout.get("text-rotate").evaluate(a,{})*Math.PI/180,c=[];for(const t of e.positionedLines)for(const n of t.positionedGlyphs){if(!n.rect)continue;const a=n.rect||{};let h=4,p=!0,d=1,f=0;const m=(o||l)&&n.vertical,g=n.metrics.advance*n.scale/2;if(l&&e.verticalizable){const e=(n.scale-1)*xu,i=(xu-n.metrics.width*n.scale)/2;f=t.lineOffset/2-(n.imageName?-i:e)}if(n.imageName){const t=s[n.imageName];p=t.sdf,h=1/(d=t.pixelRatio)}const y=o?[n.x+g,n.y]:[0,0];let v=o?[0,0]:[n.x+g+i[0],n.y+i[1]-f],_=[0,0];m&&(_=v,v=[0,0]);const x=(n.metrics.left-h)*n.scale-g+v[0],b=(-n.metrics.top-h)*n.scale+v[1],w=x+a.w*n.scale/(d*(n.localGlyph?2:1)),S=b+a.h*n.scale/(d*(n.localGlyph?2:1)),T=new r(x,b),M=new r(w,b),I=new r(x,S),C=new r(w,S);if(m){const t=new r(-g,g-nc),e=-Math.PI/2,i=12-g,o=new r(22-i,-(n.imageName?i:0)),a=new r(..._);T._rotateAround(e,t)._add(o)._add(a),M._rotateAround(e,t)._add(o)._add(a),I._rotateAround(e,t)._add(o)._add(a),C._rotateAround(e,t)._add(o)._add(a)}if(u){const t=Math.sin(u),e=Math.cos(u),i=[e,-t,t,e];T._matMult(i),M._matMult(i),I._matMult(i),C._matMult(i)}const A=new r(0,0),k=new r(0,0);c.push({tl:T,tr:M,bl:I,br:C,tex:a,writingMode:e.writingMode,glyphOffset:y,sectionIndex:n.sectionIndex,isSDF:p,pixelOffsetTL:A,pixelOffsetBR:k,minFontScaleX:0,minFontScaleY:0})}return c}(0,i,l,o,a,s,n,t.allowVerticalPlacement),y=t.textSizeData;let v=null;"source"===y.kind?(v=[bu*o.layout.get("text-size").evaluate(s,{},m)])[0]>Kc&&E(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`):"composite"===y.kind&&(((v=[bu*f.compositeTextSizes[0].evaluate(s,{},m),bu*f.compositeTextSizes[1].evaluate(s,{},m)])[0]>Kc||v[1]>Kc)&&E(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),t.addSymbols(t.text,g,v,l,a,s,c,e,u.lineStartIndex,u.lineLength,d,m);for(const e of h)p[e]=t.text.placedSymbolArray.length-1;return 4*g.length}function Qc(t){for(const e in t)return t[e];return null}function th(t,e,i,n,o,a,s,l){let u=a.top,h=a.bottom,p=a.left,d=a.right;const f=a.collisionPadding;if(f&&(p-=f[0],u-=f[1],d+=f[2],h+=f[3]),l){const t=new r(p,u),e=new r(d,u),i=new r(p,h),n=new r(d,h),o=c(l);t._rotate(o),e._rotate(o),i._rotate(o),n._rotate(o),p=Math.min(t.x,e.x,i.x,n.x),d=Math.max(t.x,e.x,i.x,n.x),u=Math.min(t.y,e.y,i.y,n.y),h=Math.max(t.y,e.y,i.y,n.y)}return t.emplaceBack(e.x,e.y,p,u,d,h,s,i,n,o),t.length-1}function eh(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function ih(t,e,i,n){const r=t.compareText;if(e in r){const t=r[e];for(let e=t.length-1;e>=0;e--)if(n.dist(t[e])<i)return!0}else r[e]=[];return r[e].push(n),!1}const nh=Hl.VectorTileFeature.types,rh=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function oh(t,e,i,n,r,o,a,s,l,u,c,h,p){const d=s?Math.min(Kc,Math.round(s[0])):0,f=s?Math.min(Kc,Math.round(s[1])):0;t.emplaceBack(e,i,Math.round(32*n),Math.round(32*r),o,a,(d<<1)+(l?1:0),f,16*u,16*c,256*h,256*p)}function ah(t,e,i){t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i)}function sh(t){for(const e of t.sections)if(Zr(e.text))return!0;return!1}class lh{constructor(t){this.layoutVertexArray=new zo,this.indexArray=new Uo,this.programConfigurations=t,this.segments=new Ua,this.dynamicLayoutVertexArray=new Oo,this.opacityVertexArray=new Ro,this.placedSymbolArray=new Qo}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(t,e,i,n){this.isEmpty()||(i&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,fu.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,mu.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,rh,!0),this.opacityVertexBuffer.itemSize=1),(i||n)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}sr("SymbolBuffers",lh);class uh{constructor(t,e,i){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new i,this.segments=new Ua,this.collisionVertexArray=new Vo,this.collisionVertexArrayExt=new Oo}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,gu.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,yu.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}sr("CollisionBuffers",uh);class ch{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(t=>t.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ms([]),this.placementViewportMatrix=ms([]);const e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=wu(this.zoom,e["text-size"]),this.iconSizeData=wu(this.zoom,e["icon-size"]);const i=this.layers[0].layout,n=i.get("symbol-sort-key"),r=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==r&&void 0!==n.constantOr(1),this.sortFeaturesByY=("viewport-y"===r||"auto"===r&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===i.get("symbol-placement")&&(this.writingModes=i.get("text-writing-mode").map(t=>ic[t])),this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id),this.sourceID=t.sourceID}createArrays(){this.text=new lh(new Ea(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new lh(new Ea(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new ia,this.lineVertexArray=new na,this.symbolInstances=new ea}calculateGlyphDependencies(t,e,i,n,r){for(let o=0;o<t.length;o++)if(e[t.charCodeAt(o)]=!0,(i||n)&&r){const i=Cu[t.charAt(o)];i&&(e[i.charCodeAt(0)]=!0)}}populate(t,e,i){const n=this.layers[0],r=n.layout,o=r.get("text-font"),a=r.get("text-field"),s=r.get("icon-image"),l=("constant"!==a.value.kind||a.value.value instanceof de&&!a.value.value.isEmpty()||a.value.value.toString().length>0)&&("constant"!==o.value.kind||o.value.value.length>0),u="constant"!==s.value.kind||!!s.value.value||Object.keys(s.parameters).length>0,c=r.get("symbol-sort-key");if(this.features=[],!l&&!u)return;const h=e.iconDependencies,p=e.glyphDependencies,d=e.availableImages,f=new ao(this.zoom);for(const{feature:e,id:a,index:s,sourceLayerIndex:m}of t){const t=n._featureFilter.needGeometry,g=ja(e,t);if(!n._featureFilter.filter(f,g,i))continue;let y,v;if(t||(g.geometry=Ha(e)),l){const t=n.getValueAndResolveTokens("text-field",g,i,d),e=de.factory(t);sh(e)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===no()||this.hasRTLText&&oo.isParsed())&&(y=Iu(e,n,g))}if(u){const t=n.getValueAndResolveTokens("icon-image",g,i,d);v=t instanceof fe?t:fe.fromString(t)}if(!y&&!v)continue;const _=this.sortFeaturesByKey?c.evaluate(g,{},i):void 0;if(this.features.push({id:a,text:y,icon:v,index:s,sourceLayerIndex:m,geometry:g.geometry,properties:e.properties,type:nh[e.type],sortKey:_}),v&&(h[v.name]=!0),y){const t=o.evaluate(g,{},i).join(","),e="map"===r.get("text-rotation-alignment")&&"point"!==r.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ic.vertical)>=0;for(const i of y.sections)if(i.image)h[i.image.name]=!0;else{const n=Vr(y.toString()),r=i.fontStack||t,o=p[r]=p[r]||{};this.calculateGlyphDependencies(i.text,o,e,this.allowVerticalPlacement,n)}}}"line"===r.get("symbol-placement")&&(this.features=function(t){const e={},i={},n=[];let r=0;function o(e){n.push(t[e]),r++}function a(t,e,r){const o=i[t];return delete i[t],i[e]=o,n[o].geometry[0].pop(),n[o].geometry[0]=n[o].geometry[0].concat(r[0]),o}function s(t,i,r){const o=e[i];return delete e[i],e[t]=o,n[o].geometry[0].shift(),n[o].geometry[0]=r[0].concat(n[o].geometry[0]),o}function l(t,e,i){const n=i?e[0][e[0].length-1]:e[0][0];return`${t}:${n.x}:${n.y}`}for(let u=0;u<t.length;u++){const c=t[u],h=c.geometry,p=c.text?c.text.toString():null;if(!p){o(u);continue}const d=l(p,h),f=l(p,h,!0);if(d in i&&f in e&&i[d]!==e[f]){const t=s(d,f,h),r=a(d,f,n[t].geometry);delete e[d],delete i[f],i[l(p,n[r].geometry,!0)]=r,n[t].geometry=null}else d in i?a(d,f,h):f in e?s(d,f,h):(o(u),e[d]=r-1,i[f]=r-1)}return n.filter(t=>t.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((t,e)=>t.sortKey-e.sortKey)}update(t,e,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,i),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,i))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,e){const i=this.lineVertexArray.length;if(void 0!==t.segment){let i=t.dist(e[t.segment+1]),n=t.dist(e[t.segment]);const r={};for(let n=t.segment+1;n<e.length;n++)r[n]={x:e[n].x,y:e[n].y,tileUnitDistanceFromAnchor:i},n<e.length-1&&(i+=e[n+1].dist(e[n]));for(let i=t.segment||0;i>=0;i--)r[i]={x:e[i].x,y:e[i].y,tileUnitDistanceFromAnchor:n},i>0&&(n+=e[i-1].dist(e[i]));for(let t=0;t<e.length;t++){const e=r[t];this.lineVertexArray.emplaceBack(e.x,e.y,e.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}}addSymbols(t,e,i,n,r,o,a,s,l,u,c,h){const p=t.indexArray,d=t.layoutVertexArray,f=t.segments.prepareSegment(4*e.length,d,p,this.canOverlap?o.sortKey:void 0),m=this.glyphOffsetArray.length,g=f.vertexLength,y=this.allowVerticalPlacement&&a===ic.vertical?Math.PI/2:0,v=o.text&&o.text.sections;for(let n=0;n<e.length;n++){const{tl:r,tr:a,bl:l,br:u,tex:c,pixelOffsetTL:m,pixelOffsetBR:g,minFontScaleX:_,minFontScaleY:x,glyphOffset:b,isSDF:w,sectionIndex:S}=e[n],T=f.vertexLength,M=b[1];oh(d,s.x,s.y,r.x,M+r.y,c.x,c.y,i,w,m.x,m.y,_,x),oh(d,s.x,s.y,a.x,M+a.y,c.x+c.w,c.y,i,w,g.x,m.y,_,x),oh(d,s.x,s.y,l.x,M+l.y,c.x,c.y+c.h,i,w,m.x,g.y,_,x),oh(d,s.x,s.y,u.x,M+u.y,c.x+c.w,c.y+c.h,i,w,g.x,g.y,_,x),ah(t.dynamicLayoutVertexArray,s,y),p.emplaceBack(T,T+1,T+2),p.emplaceBack(T+1,T+2,T+3),f.vertexLength+=4,f.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(b[0]),n!==e.length-1&&S===e[n+1].sectionIndex||t.programConfigurations.populatePaintArrays(d.length,o,o.index,{},h,v&&v[S])}t.placedSymbolArray.emplaceBack(s.x,s.y,m,this.glyphOffsetArray.length-m,g,l,u,s.segment,i?i[0]:0,i?i[1]:0,n[0],n[1],a,0,!1,0,c)}_commitLayoutVertex(t,e,i,n,r){t.emplaceBack(e.x,e.y,i,n,Math.round(r.x),Math.round(r.y))}_addCollisionDebugVertices(t,e,i,n,o){const a=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),s=a.vertexLength,l=o.anchorX,u=o.anchorY;for(let t=0;t<4;t++)i.collisionVertexArray.emplaceBack(0,0,0,0);i.collisionVertexArrayExt.emplaceBack(e,-t.padding,-t.padding),i.collisionVertexArrayExt.emplaceBack(e,t.padding,-t.padding),i.collisionVertexArrayExt.emplaceBack(e,t.padding,t.padding),i.collisionVertexArrayExt.emplaceBack(e,-t.padding,t.padding),this._commitLayoutVertex(i.layoutVertexArray,n,l,u,new r(t.x1,t.y1)),this._commitLayoutVertex(i.layoutVertexArray,n,l,u,new r(t.x2,t.y1)),this._commitLayoutVertex(i.layoutVertexArray,n,l,u,new r(t.x2,t.y2)),this._commitLayoutVertex(i.layoutVertexArray,n,l,u,new r(t.x1,t.y2)),a.vertexLength+=4;const c=i.indexArray;c.emplaceBack(s,s+1),c.emplaceBack(s+1,s+2),c.emplaceBack(s+2,s+3),c.emplaceBack(s+3,s),a.primitiveLength+=4}_addTextDebugCollisionBoxes(t,e,i,n,r,o){for(let a=n;a<r;a++){const n=i.get(a),r=this.getSymbolInstanceTextSize(t,o,e,a);this._addCollisionDebugVertices(n,r,this.textCollisionBox,n.anchorPoint,o)}}_addIconDebugCollisionBoxes(t,e,i,n,r,o){for(let a=n;a<r;a++){const n=i.get(a),r=this.getSymbolInstanceIconSize(t,e,a);this._addCollisionDebugVertices(n,r,this.iconCollisionBox,n.anchorPoint,o)}}generateCollisionDebugBuffers(t,e){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new uh(No,vu.members,Zo),this.iconCollisionBox=new uh(No,vu.members,Zo);const i=Tu(this.iconSizeData,t),n=Tu(this.textSizeData,t);for(let r=0;r<this.symbolInstances.length;r++){const o=this.symbolInstances.get(r);this._addTextDebugCollisionBoxes(n,t,e,o.textBoxStartIndex,o.textBoxEndIndex,o),this._addTextDebugCollisionBoxes(n,t,e,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o),this._addIconDebugCollisionBoxes(i,t,e,o.iconBoxStartIndex,o.iconBoxEndIndex,o),this._addIconDebugCollisionBoxes(i,t,e,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o)}}getSymbolInstanceTextSize(t,e,i,n){const r=this.text.placedSymbolArray.get(e.rightJustifiedTextSymbolIndex>=0?e.rightJustifiedTextSymbolIndex:e.centerJustifiedTextSymbolIndex>=0?e.centerJustifiedTextSymbolIndex:e.leftJustifiedTextSymbolIndex>=0?e.leftJustifiedTextSymbolIndex:e.verticalPlacedTextSymbolIndex>=0?e.verticalPlacedTextSymbolIndex:n),o=Su(this.textSizeData,t,r)/xu;return this.tilePixelRatio*o}getSymbolInstanceIconSize(t,e,i){const n=this.icon.placedSymbolArray.get(i),r=Su(this.iconSizeData,t,n);return this.tilePixelRatio*r}_commitDebugCollisionVertexUpdate(t,e,i){t.emplaceBack(e,-i,-i),t.emplaceBack(e,i,-i),t.emplaceBack(e,i,i),t.emplaceBack(e,-i,i)}_updateTextDebugCollisionBoxes(t,e,i,n,r,o){for(let a=n;a<r;a++){const n=i.get(a),r=this.getSymbolInstanceTextSize(t,o,e,a);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,r,n.padding)}}_updateIconDebugCollisionBoxes(t,e,i,n,r){for(let o=n;o<r;o++){const n=i.get(o),r=this.getSymbolInstanceIconSize(t,e,o);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,r,n.padding)}}updateCollisionDebugBuffers(t,e){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const i=Tu(this.iconSizeData,t),n=Tu(this.textSizeData,t);for(let r=0;r<this.symbolInstances.length;r++){const o=this.symbolInstances.get(r);this._updateTextDebugCollisionBoxes(n,t,e,o.textBoxStartIndex,o.textBoxEndIndex,o),this._updateTextDebugCollisionBoxes(n,t,e,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o),this._updateIconDebugCollisionBoxes(i,t,e,o.iconBoxStartIndex,o.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(i,t,e,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,e,i,n,r,o,a,s,l){const u={};for(let n=e;n<i;n++){const e=t.get(n);u.textBox={x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,padding:e.padding,anchorPointX:e.anchorPointX,anchorPointY:e.anchorPointY},u.textFeatureIndex=e.featureIndex;break}for(let e=n;e<r;e++){const i=t.get(e);u.verticalTextBox={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,padding:i.padding,anchorPointX:i.anchorPointX,anchorPointY:i.anchorPointY},u.verticalTextFeatureIndex=i.featureIndex;break}for(let e=o;e<a;e++){const i=t.get(e);u.iconBox={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,padding:i.padding,anchorPointX:i.anchorPointX,anchorPointY:i.anchorPointY},u.iconFeatureIndex=i.featureIndex;break}for(let e=s;e<l;e++){const i=t.get(e);u.verticalIconBox={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,padding:i.padding,anchorPointX:i.anchorPointX,anchorPointY:i.anchorPointY},u.verticalIconFeatureIndex=i.featureIndex;break}return u}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let e=0;e<this.symbolInstances.length;e++){const i=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,e){const i=t.placedSymbolArray.get(e),n=i.vertexStartIndex+4*i.numGlyphs;for(let e=i.vertexStartIndex;e<n;e+=4)t.indexArray.emplaceBack(e,e+1,e+2),t.indexArray.emplaceBack(e+1,e+2,e+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const e=Math.sin(t),i=Math.cos(t),n=[],r=[],o=[];for(let t=0;t<this.symbolInstances.length;++t){o.push(t);const a=this.symbolInstances.get(t);n.push(0|Math.round(e*a.anchorX+i*a.anchorY)),r.push(a.featureIndex)}return o.sort((t,e)=>n[t]-n[e]||r[e]-r[t]),o}addToSortKeyRanges(t,e){const i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===e?i.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const t of this.symbolInstanceIndexes){const e=this.symbolInstances.get(t);this.featureSortOrder.push(e.featureIndex),[e.rightJustifiedTextSymbolIndex,e.centerJustifiedTextSymbolIndex,e.leftJustifiedTextSymbolIndex].forEach((t,e,i)=>{t>=0&&i.indexOf(t)===e&&this.addIndicesForPlacedSymbol(this.text,t)}),e.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,e.verticalPlacedTextSymbolIndex),e.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.placedIconSymbolIndex),e.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,e.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}sr("SymbolBucket",ch,{omit:["layers","collisionBoxArray","features","compareText"]}),ch.MAX_GLYPHS=65535,ch.addDynamicAttributes=ah;const hh=new bo({"symbol-placement":new go(Nt.layout_symbol["symbol-placement"]),"symbol-spacing":new go(Nt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new go(Nt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new yo(Nt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new go(Nt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new go(Nt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new go(Nt.layout_symbol["icon-ignore-placement"]),"icon-optional":new go(Nt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new go(Nt.layout_symbol["icon-rotation-alignment"]),"icon-size":new yo(Nt.layout_symbol["icon-size"]),"icon-text-fit":new go(Nt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new go(Nt.layout_symbol["icon-text-fit-padding"]),"icon-image":new yo(Nt.layout_symbol["icon-image"]),"icon-rotate":new yo(Nt.layout_symbol["icon-rotate"]),"icon-padding":new go(Nt.layout_symbol["icon-padding"]),"icon-keep-upright":new go(Nt.layout_symbol["icon-keep-upright"]),"icon-offset":new yo(Nt.layout_symbol["icon-offset"]),"icon-anchor":new yo(Nt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new go(Nt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new go(Nt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new go(Nt.layout_symbol["text-rotation-alignment"]),"text-field":new yo(Nt.layout_symbol["text-field"]),"text-font":new yo(Nt.layout_symbol["text-font"]),"text-size":new yo(Nt.layout_symbol["text-size"]),"text-max-width":new yo(Nt.layout_symbol["text-max-width"]),"text-line-height":new yo(Nt.layout_symbol["text-line-height"]),"text-letter-spacing":new yo(Nt.layout_symbol["text-letter-spacing"]),"text-justify":new yo(Nt.layout_symbol["text-justify"]),"text-radial-offset":new yo(Nt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new go(Nt.layout_symbol["text-variable-anchor"]),"text-anchor":new yo(Nt.layout_symbol["text-anchor"]),"text-max-angle":new go(Nt.layout_symbol["text-max-angle"]),"text-writing-mode":new go(Nt.layout_symbol["text-writing-mode"]),"text-rotate":new yo(Nt.layout_symbol["text-rotate"]),"text-padding":new go(Nt.layout_symbol["text-padding"]),"text-keep-upright":new go(Nt.layout_symbol["text-keep-upright"]),"text-transform":new yo(Nt.layout_symbol["text-transform"]),"text-offset":new yo(Nt.layout_symbol["text-offset"]),"text-allow-overlap":new go(Nt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new go(Nt.layout_symbol["text-ignore-placement"]),"text-optional":new go(Nt.layout_symbol["text-optional"])});var ph={paint:new bo({"icon-opacity":new yo(Nt.paint_symbol["icon-opacity"]),"icon-color":new yo(Nt.paint_symbol["icon-color"]),"icon-halo-color":new yo(Nt.paint_symbol["icon-halo-color"]),"icon-halo-width":new yo(Nt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new yo(Nt.paint_symbol["icon-halo-blur"]),"icon-translate":new go(Nt.paint_symbol["icon-translate"]),"icon-translate-anchor":new go(Nt.paint_symbol["icon-translate-anchor"]),"text-opacity":new yo(Nt.paint_symbol["text-opacity"]),"text-color":new yo(Nt.paint_symbol["text-color"],{runtimeType:Yt,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new yo(Nt.paint_symbol["text-halo-color"]),"text-halo-width":new yo(Nt.paint_symbol["text-halo-width"]),"text-halo-blur":new yo(Nt.paint_symbol["text-halo-blur"]),"text-translate":new go(Nt.paint_symbol["text-translate"]),"text-translate-anchor":new go(Nt.paint_symbol["text-translate-anchor"])}),layout:hh};class dh{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:jt,this.defaultValue=t}evaluate(t){if(t.formattedSection){const e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}sr("FormatSectionOverride",dh,{omit:["defaultValue"]});class fh extends Na{constructor(t){super(t,ph)}recalculate(t,e){if(super.recalculate(t,e),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const t=this.layout.get("text-writing-mode");if(t){const e=[];for(const i of t)e.indexOf(i)<0&&e.push(i);this.layout._values["text-writing-mode"]=e}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,e,i,n){const r=this.layout.get(t).evaluate(e,{},i,n),o=this._unevaluatedLayout._values[t];return o.isDataDriven()||un(o.value)||!r?r:function(t,e){return e.replace(/{([^{}]+)}/g,(e,i)=>i in t?t[i]+"":"")}(e.properties,r)}createBucket(t){return new ch(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of ph.paint.overridableProperties){if(!fh.hasPaintOverride(this.layout,t))continue;const e=this.paint.get(t),i=new dh(e),n=new ln(i,e.property.specification);let r=null;r="constant"===e.value.kind||"source"===e.value.kind?new hn("source",n):new pn("composite",n,e.value.zoomStops,e.value._interpolationType),this.paint._values[t]=new fo(e.property,r,e.parameters)}}_handleOverridablePaintPropertyUpdate(t,e,i){return!(!this.layout||e.isDataDriven()||i.isDataDriven())&&fh.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,e){const i=t.get("text-field"),n=ph.paint.properties[e];let r=!1;const o=t=>{for(const e of t)if(n.overrides&&n.overrides.hasOverride(e))return void(r=!0)};if("constant"===i.value.kind&&i.value.value instanceof de)o(i.value.value.sections);else if("source"===i.value.kind){const t=e=>{r||(e instanceof _e&&ye(e.value)===te?o(e.value.sections):e instanceof Se?o(e.sections):e.eachChild(t))},e=i.value;e._styleExpression&&t(e._styleExpression.expression)}return r}getProgramConfiguration(t){return new Da(this,t)}}var mh={paint:new bo({"background-color":new go(Nt.paint_background["background-color"]),"background-pattern":new _o(Nt.paint_background["background-pattern"]),"background-opacity":new go(Nt.paint_background["background-opacity"])})},gh={paint:new bo({"raster-opacity":new go(Nt.paint_raster["raster-opacity"]),"raster-hue-rotate":new go(Nt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new go(Nt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new go(Nt.paint_raster["raster-brightness-max"]),"raster-saturation":new go(Nt.paint_raster["raster-saturation"]),"raster-contrast":new go(Nt.paint_raster["raster-contrast"]),"raster-resampling":new go(Nt.paint_raster["raster-resampling"]),"raster-fade-duration":new go(Nt.paint_raster["raster-fade-duration"])})};class yh extends Na{constructor(t){super(t,{}),this.implementation=t}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}var vh={paint:new bo({"sky-type":new go(Nt.paint_sky["sky-type"]),"sky-atmosphere-sun":new go(Nt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new go(Nt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new go(Nt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new go(Nt.paint_sky["sky-gradient-radius"]),"sky-gradient":new xo(Nt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new go(Nt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new go(Nt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new go(Nt.paint_sky["sky-opacity"])})};function _h(t,e,i){const n=xs(0,0,1),r=Ps(Es());return function(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(i),l=Math.cos(i);t[0]=n*l-o*s,t[1]=r*l+a*s,t[2]=o*l+n*s,t[3]=a*l-r*s}(r,r,i?-c(t)+Math.PI:c(t)),Ls(r,r,-c(e)),Ms(n,n,r),Ts(n,n)}const xh={circle:class extends Na{constructor(t){super(t,ps)}createBucket(t){return new qa(t)}queryRadius(t){const e=t;return ss("circle-radius",this,e)+ss("circle-stroke-width",this,e)+ls(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,i,n,r,o,a,s){const l="map"===this.paint.get("circle-pitch-alignment");if(l&&t.queryGeometry.isAboveHorizon)return!1;const u=cs(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,t.pixelToTileUnitsFactor),c=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i),h=l?c*t.pixelToTileUnitsFactor:c;for(const e of n)for(const i of e){const e=i.add(u),n=s&&o.elevation?o.elevation.exaggeration()*s.getElevationAt(e.x,e.y,!0):0,r=l?e:zs(e,n,a),c=l?t.tilespaceRays.map(t=>Bs(t,n)):t.queryGeometry.screenGeometry;let p=h;const d=Ds([],[i.x,i.y,n,1],a);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?p*=d[3]/o.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(p*=o.cameraToCenterDistance/d[3]),Ya(c,r,p))return!0}return!1}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new Da(this,t)}},heatmap:class extends Na{createBucket(t){return new Ns(t)}constructor(t){super(t,Ws),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Hs({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new Da(this,t)}},hillshade:class extends Na{constructor(t){super(t,js)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getProgramConfiguration(t){return new Da(this,t)}},fill:class extends Na{constructor(t){super(t,Ll)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),i=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(t){return new Da(this,t)}recalculate(t,e){super.recalculate(t,e);const i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new El(t)}queryRadius(){return ls(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,i,n,r,o){return!t.queryGeometry.isAboveHorizon&&Ka(us(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,t.pixelToTileUnitsFactor),n)}isTileClipped(){return!0}},"fill-extrusion":class extends Na{constructor(t){super(t,Jl)}createBucket(t){return new Yl(t)}queryRadius(){return ls(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new Da(this,t)}queryIntersectsFeature(t,e,i,n,o,a,s,l,u){const c=cs(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,t.pixelToTileUnitsFactor),h=this.paint.get("fill-extrusion-height").evaluate(e,i),p=this.paint.get("fill-extrusion-base").evaluate(e,i),d=[0,0],f=l&&a.elevation,m=a.elevation?a.elevation.exaggeration():1;if(f){const e=t.tile.getBucket(this).centroidVertexArray,i=u+1;if(i<e.length){const t=e.get(i);d[0]=t.a_centroid_pos0,d[1]=t.a_centroid_pos1}}if(0===d[0]&&1===d[1])return!1;const g=function(t,e,i,n,o,a,s,l,u){return a?function(t,e,i,n,r,o,a,s,l){const u=[],c=[],h=[0,0,0,1];for(const p of t){const t=[],d=[];for(const u of p){const c=u.x+n.x,p=u.y+n.y,f=iu(c,p,e,i,o,a,s,l);h[0]=c,h[1]=p,h[2]=f.base,h[3]=1,Ds(h,h,r),h[3]=Math.max(h[3],1e-5);const m=eu([h[0]/h[3],h[1]/h[3],h[2]/h[3]]);h[0]=c,h[1]=p,h[2]=f.top,h[3]=1,Ds(h,h,r),h[3]=Math.max(h[3],1e-5);const g=eu([h[0]/h[3],h[1]/h[3],h[2]/h[3]]);t.push(m),d.push(g)}u.push(t),c.push(d)}return[u,c]}(t,e,i,n,o,a,s,l,u):function(t,e,i,n,o){const a=[],s=[],l=o[8]*e,u=o[9]*e,c=o[10]*e,h=o[11]*e,p=o[8]*i,d=o[9]*i,f=o[10]*i,m=o[11]*i;for(const e of t){const t=[],i=[];for(const a of e){const e=a.x+n.x,s=a.y+n.y,g=o[0]*e+o[4]*s+o[12],y=o[1]*e+o[5]*s+o[13],v=o[2]*e+o[6]*s+o[14],_=o[3]*e+o[7]*s+o[15],x=g+l,b=y+u,w=v+c,S=Math.max(_+h,1e-5),T=g+p,M=y+d,I=v+f,C=Math.max(_+m,1e-5),A=new r(x/S,b/S);A.z=w/S,t.push(A);const k=new r(T/C,M/C);k.z=I/C,i.push(k)}a.push(t),s.push(i)}return[a,s]}(t,e,i,n,o)}(n,p,h,c,s,f?l:null,d,m,a.center.lat),y=t.queryGeometry;return function(t,e,i){let n=1/0;Ka(i,e)&&(n=tu(i,e[0]));for(let r=0;r<e.length;r++){const o=e[r],a=t[r];for(let t=0;t<o.length-1;t++){const e=o[t],r=[e,o[t+1],a[t+1],a[t],e];Xa(i,r)&&(n=Math.min(n,tu(i,r)))}}return n!==1/0&&n}(g[0],g[1],y.isPointQuery()?y.screenBounds:y.screenGeometry)}},line:class extends Na{constructor(t){super(t,hu),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof ei,this.gradientVersion=(this.gradientVersion+1)%s}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=pu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new uu(t)}getProgramIds(){const t=this.paint.get("line-dasharray"),e=this.paint.get("line-pattern").constantOr(1),i=this.paint.get("line-gradient");return[e?"linePattern":t?"lineSDF":i?"lineGradient":"line"]}getProgramConfiguration(t){return new Da(this,t)}queryRadius(t){const e=t,i=du(ss("line-width",this,e),ss("line-gap-width",this,e)),n=ss("line-offset",this,e);return i/2+Math.abs(n)+ls(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,i,n,o,a){if(t.queryGeometry.isAboveHorizon)return!1;const s=us(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,t.pixelToTileUnitsFactor),l=t.pixelToTileUnitsFactor/2*du(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),u=this.paint.get("line-offset").evaluate(e,i);return u&&(n=function(t,e){const i=[],n=new r(0,0);for(let r=0;r<t.length;r++){const o=t[r],a=[];for(let t=0;t<o.length;t++){const i=o[t-1],r=o[t],s=o[t+1],l=0===t?n:r.sub(i)._unit()._perp(),u=t===o.length-1?n:s.sub(r)._unit()._perp(),c=l._add(u)._unit();c._mult(1/(c.x*u.x+c.y*u.y)),a.push(c._mult(e)._add(r))}i.push(a)}return i}(n,u*t.pixelToTileUnitsFactor)),function(t,e,i){for(let n=0;n<e.length;n++){const r=e[n];if(t.length>=3)for(let e=0;e<r.length;e++)if(rs(t,r[e]))return!0;if(Ja(t,r,i))return!0}return!1}(s,n,l)}isTileClipped(){return!0}},symbol:fh,background:class extends Na{constructor(t){super(t,mh)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Na{constructor(t){super(t,gh)}getProgramIds(){return["raster"]}},sky:class extends Na{constructor(t){super(t,vh),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"sky-gradient"===t?this._updateColorRamp():"sky-atmosphere-sun"!==t&&"sky-atmosphere-halo-color"!==t&&"sky-atmosphere-color"!==t&&"sky-atmosphere-sun-intensity"!==t||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Hs({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}}getCenter(t,e){const i=this.paint.get("sky-type");if("atmosphere"===i){const i=this.paint.get("sky-atmosphere-sun"),n=!i,r=t.style.light,o=r.properties.get("position");return n&&"viewport"===r.properties.get("anchor")&&E("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),n?_h(o.azimuthal,90-o.polar,e):_h(i[0],90-i[1],e)}if("gradient"===i){const t=this.paint.get("sky-gradient-center");return _h(t[0],90-t[1],e)}}is3D(){return!1}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return"atmosphere"===t?["skyboxCapture","skybox"]:"gradient"===t?["skyboxGradient"]:null}}},{HTMLImageElement:bh,HTMLCanvasElement:wh,HTMLVideoElement:Sh,ImageData:Th,ImageBitmap:Mh}=a;class Ih{constructor(t,e,i,n){this.context=t,this.format=i,this.texture=t.gl.createTexture(),this.update(e,n)}update(t,e,i){const{width:n,height:r}=t,o=!(this.size&&this.size[0]===n&&this.size[1]===r||i),{context:a}=this,{gl:s}=a;if(this.useMipmap=!(!e||!e.useMipmap),s.bindTexture(s.TEXTURE_2D,this.texture),a.pixelStoreUnpackFlipY.set(!1),a.pixelStoreUnpack.set(1),a.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!e||!1!==e.premultiply)),o)this.size=[n,r],t instanceof bh||t instanceof wh||t instanceof Sh||t instanceof Th||Mh&&t instanceof Mh?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,t):s.texImage2D(s.TEXTURE_2D,0,this.format,n,r,0,this.format,s.UNSIGNED_BYTE,t.data);else{const{x:e,y:o}=i||{x:0,y:0};t instanceof bh||t instanceof wh||t instanceof Sh||t instanceof Th||Mh&&t instanceof Mh?s.texSubImage2D(s.TEXTURE_2D,0,e,o,s.RGBA,s.UNSIGNED_BYTE,t):s.texSubImage2D(s.TEXTURE_2D,0,e,o,n,r,s.RGBA,s.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&s.generateMipmap(s.TEXTURE_2D)}bind(t,e,i){const{context:n}=this,{gl:r}=n;r.bindTexture(r.TEXTURE_2D,this.texture),i!==r.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=r.LINEAR),t!==this.filter&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,i||t),this.filter=t),e!==this.wrap&&(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e),this.wrap=e)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class Ch{constructor(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof kh?new kh(t.lng,t.lat):kh.convert(t),this}setSouthWest(t){return this._sw=t instanceof kh?new kh(t.lng,t.lat):kh.convert(t),this}extend(t){const e=this._sw,i=this._ne;let n,r;if(t instanceof kh)n=t,r=t;else{if(!(t instanceof Ch))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(Ch.convert(t)):this.extend(kh.convert(t)):this;if(n=t._sw,r=t._ne,!n||!r)return this}return e||i?(e.lng=Math.min(n.lng,e.lng),e.lat=Math.min(n.lat,e.lat),i.lng=Math.max(r.lng,i.lng),i.lat=Math.max(r.lat,i.lat)):(this._sw=new kh(n.lng,n.lat),this._ne=new kh(r.lng,r.lat)),this}getCenter(){return new kh((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new kh(this.getWest(),this.getNorth())}getSouthEast(){return new kh(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:e,lat:i}=kh.convert(t);let n=this._sw.lng<=e&&e<=this._ne.lng;return this._sw.lng>this._ne.lng&&(n=this._sw.lng>=e&&e>=this._ne.lng),this._sw.lat<=i&&i<=this._ne.lat&&n}static convert(t){return!t||t instanceof Ch?t:new Ch(t)}}const Ah=6371008.8;class kh{constructor(t,e){if(isNaN(t)||isNaN(e))throw Error(`Invalid LngLat object: (${t}, ${e})`);if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new kh(g(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const e=Math.PI/180,i=this.lat*e,n=t.lat*e,r=Math.sin(i)*Math.sin(n)+Math.cos(i)*Math.cos(n)*Math.cos((t.lng-this.lng)*e);return Ah*Math.acos(Math.min(r,1))}toBounds(t=0){const e=360*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return new Ch(new kh(this.lng-i,this.lat-e),new kh(this.lng+i,this.lat+e))}static convert(t){if(t instanceof kh)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new kh(+t[0],+t[1]);if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new kh(+("lng"in t?t.lng:t.lon),+t.lat);throw Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Dh=2*Math.PI*Ah;function Eh(t){return Dh*Math.cos(t*Math.PI/180)}function Ph(t){return(180+t)/360}function Lh(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function zh(t,e){return t/Eh(e)}function Oh(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Rh(t,e){return t*Eh(Oh(e))}class Bh{constructor(t,e,i=0){this.x=+t,this.y=+e,this.z=+i}static fromLngLat(t,e=0){const i=kh.convert(t);return new Bh(Ph(i.lng),Lh(i.lat),zh(e,i.lat))}toLngLat(){return new kh(360*this.x-180,Oh(this.y))}toAltitude(){return Rh(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Dh*(t=Oh(this.y),1/Math.cos(t*Math.PI/180));var t}}class Nh{constructor(t,e){this.width=t,this.height=e,this.nextRow=0,this.image=new Gs({width:t,height:e}),this.positions={},this.uploaded=!1}getDash(t,e){const i=this.getKey(t,e);return this.positions[i]}trim(){const t=this.width,e=this.height=S(this.nextRow);this.image.resize({width:t,height:e})}getKey(t,e){return t.join(",")+e}getDashRanges(t,e,i){const n=[];let r=t.length%2==1?-t[t.length-1]*i:0,o=t[0]*i,a=!0;n.push({left:r,right:o,isDash:a,zeroLength:0===t[0]});let s=t[0];for(let e=1;e<t.length;e++){a=!a;const l=t[e];r=s*i,o=(s+=l)*i,n.push({left:r,right:o,isDash:a,zeroLength:0===l})}return n}addRoundDash(t,e,i){const n=e/2;for(let e=-i;e<=i;e++){const r=this.width*(this.nextRow+i+e);let o=0,a=t[o];for(let s=0;s<this.width;s++){s/a.right>1&&(a=t[++o]);const l=Math.abs(s-a.left),u=Math.abs(s-a.right),c=Math.min(l,u);let h;const p=e/i*(n+1);if(a.isDash){const t=n-Math.abs(p);h=Math.sqrt(c*c+t*t)}else h=n-Math.sqrt(c*c+p*p);this.image.data[r+s]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(t,e){for(let e=t.length-1;e>=0;--e){const i=t[e],n=t[e+1];i.zeroLength?t.splice(e,1):n&&n.isDash===i.isDash&&(n.left=i.left,t.splice(e,1))}const i=t[0],n=t[t.length-1];i.isDash===n.isDash&&(i.left=n.left-this.width,n.right=i.right+this.width);const r=this.width*this.nextRow;let o=0,a=t[o];for(let i=0;i<this.width;i++){i/a.right>1&&(a=t[++o]);const n=Math.abs(i-a.left),s=Math.abs(i-a.right),l=Math.min(n,s);this.image.data[r+i]=Math.max(0,Math.min(255,(a.isDash?l:-l)+e+128))}}addDash(t,e){const i=this.getKey(t,e);if(this.positions[i])return this.positions[i];const n="round"===e,r=n?7:0,o=2*r+1;if(this.nextRow+o>this.height)return E("LineAtlas out of space"),null;0===t.length&&t.push(1);let a=0;for(let e=0;e<t.length;e++)t[e]<0&&(E("Negative value is found in line dasharray, replacing values with 0"),t[e]=0),a+=t[e];if(0!==a){const i=this.width/a,o=this.getDashRanges(t,this.width,i);n?this.addRoundDash(o,i,r):this.addRegularDash(o,"square"===e?.5*i:0)}const s=this.nextRow+r;this.nextRow+=o;const l={tl:[s,r],br:[a,0]};return this.positions[i]=l,l}}sr("LineAtlas",Nh);class Fh{constructor(t){this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=(()=>{this._triggered=!1,this._callback()}))}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=(()=>{})}}const Vh=a.performance;function Uh(t){const e=t?t.url.toString():void 0;return Vh.getEntriesByName(e)}class Gh{constructor(){this.tasks={},this.taskQueue=[],M(["process"],this),this.invoker=new Fh(this.process),this.nextId=0}add(t,e){const i=this.nextId++,n=function({type:t,isSymbolTile:e,zoom:i}){return i=i||0,"message"===t?0:"maybePrepare"!==t||e?"parseTile"!==t||e?"parseTile"===t&&e?300-i:"maybePrepare"===t&&e?400-i:500:200-i:100-i}(e);if(0===n){z();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[i]={fn:t,metadata:e,priority:n,id:i},this.taskQueue.push(i),this.invoker.trigger(),{cancel:()=>{delete this.tasks[i]}}}process(){z();try{if(this.taskQueue=this.taskQueue.filter(t=>!!this.tasks[t]),!this.taskQueue.length)return;const t=this.pick();if(null===t)return;const e=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!e)return;e.fn()}finally{}}pick(){let t=null,e=1/0;for(let i=0;i<this.taskQueue.length;i++){const n=this.tasks[this.taskQueue[i]];n.priority<e&&(e=n.priority,t=i)}if(null===t)return null;const i=this.taskQueue[t];return this.taskQueue.splice(t,1),i}remove(){this.invoker.remove()}}function $h(t,e,i){var n=156543.03392804097/Math.pow(2,i);return[t*n-20037508.342789244,e*n-20037508.342789244]}class Wh{constructor(t,e,i){this.z=t,this.x=e,this.y=i,this.key=Zh(0,t,t,e,i)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,e){const i=(r=this.y,o=this.z,a=$h(256*(n=this.x),256*(r=Math.pow(2,o)-r-1),o),s=$h(256*(n+1),256*(r+1),o),a[0]+","+a[1]+","+s[0]+","+s[1]);var n,r,o,a,s;const l=function(t,e,i){let n,r="";for(let o=t;o>0;o--)r+=(e&(n=1<<o-1)?1:0)+(i&n?2:0);return r}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",this.z+"").replace("{x}",this.x+"").replace("{y}",("tms"===e?Math.pow(2,this.z)-this.y-1:this.y)+"").replace("{quadkey}",l).replace("{bbox-epsg-3857}",i)}getTilePoint(t){const e=Math.pow(2,this.z);return new r((t.x*e-this.x)*Ga,(t.y*e-this.y)*Ga)}getTileVec3(t){const e=Math.pow(2,this.z);return xs((t.x*e-this.x)*Ga,(t.y*e-this.y)*Ga,Rh(t.z,t.y))}toString(){return`${this.z}/${this.x}/${this.y}`}}class Hh{constructor(t,e){this.wrap=t,this.canonical=e,this.key=Zh(t,e.z,e.z,e.x,e.y)}}class jh{constructor(t,e,i,n,r){this.overscaledZ=t,this.wrap=e,this.canonical=new Wh(i,+n,+r),this.key=0===e&&t===i?this.canonical.key:Zh(e,t,i,n,r)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const e=this.canonical.z-t;return t>this.canonical.z?new jh(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new jh(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)}calculateScaledKey(t,e=!0){if(this.overscaledZ===t&&e)return this.key;if(t>this.canonical.z)return Zh(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y);{const i=this.canonical.z-t;return Zh(this.wrap*+e,t,t,this.canonical.x>>i,this.canonical.y>>i)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const e=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e}children(t){if(this.overscaledZ>=t)return[new jh(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const e=this.canonical.z+1,i=2*this.canonical.x,n=2*this.canonical.y;return[new jh(e,this.wrap,e,i,n),new jh(e,this.wrap,e,i+1,n),new jh(e,this.wrap,e,i,n+1),new jh(e,this.wrap,e,i+1,n+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new jh(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new jh(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Hh(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Bh(t.x-this.wrap,t.y))}getTileVec3(t){return this.canonical.getTileVec3(new Bh(t.x-this.wrap,t.y,t.z))}}function Zh(t,e,i,n,r){const o=1<<Math.min(i,22);let a=o*(r%o)+n%o;return t&&i<22&&(a+=o*o*((t<0?-2*t-1:2*t)%(1<<2*(22-i)))),16*(32*a+i)+(e-i)}sr("CanonicalTileID",Wh),sr("OverscaledTileID",jh,{omit:["projMatrix"]});class qh{constructor(t){this._stringToNumber={},this._numberToString=[];for(let e=0;e<t.length;e++){const i=t[e];this._stringToNumber[i]=e,this._numberToString[e]=i}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}class Xh{constructor(t,e,i,n,r){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=i,t._y=n,this.properties=t.properties,this.id=r}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const e in this)"_geometry"!==e&&"_vectorTileFeature"!==e&&(t[e]=this[e]);return t}}var Yh=Io([{name:"a_pos",type:"Int16",components:2}]);class Kh{constructor(t,e,i){this.tileID=t,this.uid=b(),this.uses=0,this.tileSize=e,this.tileZoom=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const e=t+this.timeAdded;e<G.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}loadVectorData(t,e,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(t,e){const i={};if(!e)return i;for(const n of t){const t=n.layerIds.map(t=>e.getLayer(t)).filter(Boolean);if(0!==t.length){n.layers=t,n.stateDependentLayerIds&&(n.stateDependentLayers=n.stateDependentLayerIds.map(e=>t.filter(t=>t.id===e)[0]));for(const e of t)i[e.id]=n}}return i}(t.buckets,e.style),this.hasSymbolBuckets=!1;for(const t in this.buckets){const e=this.buckets[t];if(e instanceof ch){if(this.hasSymbolBuckets=!0,!i)break;e.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const t in this.buckets){const e=this.buckets[t];if(e instanceof ch&&e.hasRTLText){this.hasRTLText=!0,oo.isLoading()||oo.isLoaded()||"deferred"!==no()||ro();break}}this.queryPadding=0;for(const t in this.buckets){const i=this.buckets[t];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(t).queryRadius(i))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas)}else this.collisionBoxArray=new Ko}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const e in this.buckets){const i=this.buckets[e];i.uploadPending()&&i.upload(t)}const e=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ih(t,this.imageAtlas.image,e.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ih(t,this.glyphAtlasImage,e.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Ih(t,this.lineAtlas.image,e.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,e,i,n,r,o,a,s){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:n,pixelPosMatrix:a,transform:o,params:r},t,e,i):{}}querySourceFeatures(t,e){const i=this.latestFeatureIndex;if(!i||!i.rawTileData)return;const n=i.loadVTLayers(),r=e?e.sourceLayer:"",o=n._geojsonTileLayer||n[r];if(!o)return;const a=Tn(e&&e.filter),{z:s,x:l,y:u}=this.tileID.canonical,c={z:s,x:l,y:u};for(let e=0;e<o.length;e++){const n=o.feature(e);if(a.needGeometry){const t=ja(n,!0);if(!a.filter(new ao(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!a.filter(new ao(this.tileID.overscaledZ),n))continue;const h=i.getId(n,r),p=new Xh(n,s,l,u,h);p.tile=c,t.push(p)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const e=this.expirationTime;if(t.cacheControl){const e=O(t.cacheControl);e["max-age"]&&(this.expirationTime=Date.now()+1e3*e["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const t=Date.now();let i=!1;if(this.expirationTime>t)i=!1;else if(e)if(this.expirationTime<e)i=!0;else{const n=this.expirationTime-e;n?this.expirationTime=t+Math.max(n,3e4):i=!0}else i=!0;i?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),2147483647)}setFeatureState(t,e){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(t).length)return;const i=this.latestFeatureIndex.loadVTLayers();for(const n in this.buckets){if(!e.style.hasLayer(n))continue;const r=this.buckets[n],o=r.layers[0].sourceLayer||"_geojsonTileLayer",a=i[o],s=t[o];if(!a||!s||0===Object.keys(s).length)continue;r.update(s,a,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=e&&e.style&&e.style.getLayer(n);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(r)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<G.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=G.now()+t}setDependencies(t,e){const i={};for(const t of e)i[t]=!0;this.dependencies[t]=i}hasDependency(t,e){for(const i of t){const t=this.dependencies[i];if(t)for(const i of e)if(t[i])return!0}return!1}clearQueryDebugViz(){}}class Jh{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,e,i){const n=e+"";if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][n]=this.stateChanges[t][n]||{},_(this.stateChanges[t][n],i),null===this.deletedStates[t]){this.deletedStates[t]={};for(const e in this.state[t])e!==n&&(this.deletedStates[t][e]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][n]){this.deletedStates[t][n]={};for(const e in this.state[t][n])i[e]||(this.deletedStates[t][n][e]=null)}else for(const e in i)this.deletedStates[t]&&this.deletedStates[t][n]&&null===this.deletedStates[t][n][e]&&delete this.deletedStates[t][n][e]}removeFeatureState(t,e,i){if(null===this.deletedStates[t])return;const n=e+"";if(this.deletedStates[t]=this.deletedStates[t]||{},i&&void 0!==e)null!==this.deletedStates[t][n]&&(this.deletedStates[t][n]=this.deletedStates[t][n]||{},this.deletedStates[t][n][i]=null);else if(void 0!==e)if(this.stateChanges[t]&&this.stateChanges[t][n])for(i in this.deletedStates[t][n]={},this.stateChanges[t][n])this.deletedStates[t][n][i]=null;else this.deletedStates[t][n]=null;else this.deletedStates[t]=null}getState(t,e){const i=e+"",n=_({},(this.state[t]||{})[i],(this.stateChanges[t]||{})[i]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){const i=this.deletedStates[t][e];if(null===i)return{};for(const t in i)delete n[t]}return n}initializeTileState(t,e){t.setFeatureState(this.state,e)}coalesceChanges(t,e){const i={};for(const t in this.stateChanges){this.state[t]=this.state[t]||{};const e={};for(const i in this.stateChanges[t])this.state[t][i]||(this.state[t][i]={}),_(this.state[t][i],this.stateChanges[t][i]),e[i]=this.state[t][i];i[t]=e}for(const t in this.deletedStates){this.state[t]=this.state[t]||{};const e={};if(null===this.deletedStates[t])for(const i in this.state[t])e[i]={},this.state[t][i]={};else for(const i in this.deletedStates[t]){if(null===this.deletedStates[t][i])this.state[t][i]={};else for(const e of Object.keys(this.deletedStates[t][i]))delete this.state[t][i][e];e[i]=this.state[t][i]}i[t]=i[t]||{},_(i[t],e)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(i).length)for(const n in t)t[n].setFeatureState(i,e)}}class Qh{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,e){const i=this.toIdx(t,e);return{min:this.minimums[i],max:this.maximums[i]}}isLeaf(t,e){return this.leaves[this.toIdx(t,e)]}toIdx(t,e){return e*this.size+t}}function tp(t,e,i,n){let r=0,o=Number.MAX_VALUE;for(let a=0;a<3;a++)if(Math.abs(n[a])<1e-15){if(i[a]<t[a]||i[a]>e[a])return null}else{const s=1/n[a];let l=(t[a]-i[a])*s,u=(e[a]-i[a])*s;if(l>u){const t=l;l=u,u=t}if(l>r&&(r=l),u<o&&(o=u),r>o)return null}return r}function ep(t,e,i,n,r,o,a,s,l,u,c){const h=n-t,p=r-e,d=o-i,f=a-t,m=s-e,g=l-i,y=c[1]*g-c[2]*m,v=c[2]*f-c[0]*g,_=c[0]*m-c[1]*f,x=h*y+p*v+d*_;if(Math.abs(x)<1e-15)return null;const b=1/x,w=u[0]-t,S=u[1]-e,T=u[2]-i,M=(w*y+S*v+T*_)*b;if(M<0||M>1)return null;const I=S*d-T*p,C=T*h-w*d,A=w*p-S*h,k=(c[0]*I+c[1]*C+c[2]*A)*b;return k<0||M+k>1?null:(f*I+m*C+g*A)*b}function ip(t,e,i){return(t-e)/(i-e)}function np(t,e,i,n,r,o,a,s,l){const u=1<<i,c=o-n,h=a-r,p=(t+1)/u*c+n,d=(e+0)/u*h+r,f=(e+1)/u*h+r;s[0]=(t+0)/u*c+n,s[1]=d,l[0]=p,l[1]=f}class rp{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const e=function(t){const e=Math.ceil(Math.log2(t.dim/8)),i=[];let n=Math.ceil(Math.pow(2,e));const r=1/n,o=(t,e,i,n,r)=>{const o=n?1:0,a=(t+1)*i-o,s=e*i,l=(e+1)*i-o;r[0]=t*i,r[1]=s,r[2]=a,r[3]=l};let a=new Qh(n);const s=[];for(let e=0;e<n*n;e++){o(e%n,Math.floor(e/n),r,!1,s);const i=ap(s[0],s[1],t),l=ap(s[2],s[1],t),u=ap(s[2],s[3],t),c=ap(s[0],s[3],t);a.minimums.push(Math.min(i,l,u,c)),a.maximums.push(Math.max(i,l,u,c)),a.leaves.push(1)}for(i.push(a),n/=2;n>=1;n/=2){const t=i[i.length-1];a=new Qh(n);for(let e=0;e<n*n;e++){o(e%n,Math.floor(e/n),2,!0,s);const i=t.getElevation(s[0],s[1]),r=t.getElevation(s[2],s[1]),l=t.getElevation(s[2],s[3]),u=t.getElevation(s[0],s[3]),c=t.isLeaf(s[0],s[1]),h=t.isLeaf(s[2],s[1]),p=t.isLeaf(s[2],s[3]),d=t.isLeaf(s[0],s[3]),f=Math.min(i.min,r.min,l.min,u.min),m=Math.max(i.max,r.max,l.max,u.max),g=c&&h&&p&&d;a.maximums.push(m),a.minimums.push(f),a.leaves.push(m-f<=5&&g?1:0)}i.push(a)}return i}(this.dem),i=e.length-1,n=e[i];this._addNode(n.minimums[0],n.maximums[0],n.leaves[0]),this._construct(e,0,0,i,0)}raycastRoot(t,e,i,n,r,o,a=1){return tp([t,e,-100],[i,n,this.maximums[0]*a],r,o)}raycast(t,e,i,n,r,o,a=1){if(!this.nodeCount)return null;const s=this.raycastRoot(t,e,i,n,r,o,a);if(null==s)return null;const l=[],u=[],c=[],h=[],p=[{idx:0,t:s,nodex:0,nodey:0,depth:0}];for(;p.length>0;){const{idx:s,t:d,nodex:f,nodey:m,depth:g}=p.pop();if(this.leaves[s]){np(f,m,g,t,e,i,n,c,h);const s=1<<g,l=(f+0)/s,u=(f+1)/s,p=(m+0)/s,y=(m+1)/s,v=ap(l,p,this.dem)*a,_=ap(u,p,this.dem)*a,x=ap(u,y,this.dem)*a,b=ap(l,y,this.dem)*a,w=ep(c[0],c[1],v,h[0],c[1],_,h[0],h[1],x,r,o),S=ep(h[0],h[1],x,c[0],h[1],b,c[0],c[1],v,r,o),T=Math.min(null!==w?w:Number.MAX_VALUE,null!==S?S:Number.MAX_VALUE);if(T!==Number.MAX_VALUE)return T;{const t=Ss([],r,o,d);if(op(v,_,b,x,ip(t[0],c[0],h[0]),ip(t[1],c[1],h[1]))>=t[2])return d}continue}let y=0;for(let p=0;p<this._siblingOffset.length;p++){np((f<<1)+this._siblingOffset[p][0],(m<<1)+this._siblingOffset[p][1],g+1,t,e,i,n,c,h),c[2]=-100,h[2]=this.maximums[this.childOffsets[s]+p]*a;const d=tp(c,h,r,o);if(null!=d){const t=d;l[p]=t;let e=!1;for(let i=0;i<y&&!e;i++)t>=l[u[i]]&&(u.splice(i,0,p),e=!0);e||(u[y]=p),y++}}for(let t=0;t<y;t++){const e=u[t];p.push({idx:this.childOffsets[s]+e,t:l[e],nodex:(f<<1)+this._siblingOffset[e][0],nodey:(m<<1)+this._siblingOffset[e][1],depth:g+1})}}return null}_addNode(t,e,i){return this.minimums.push(t),this.maximums.push(e),this.leaves.push(i),this.childOffsets.push(0),this.nodeCount++}_construct(t,e,i,n,r){if(1===t[n].isLeaf(e,i))return;this.childOffsets[r]||(this.childOffsets[r]=this.nodeCount);const o=n-1,a=t[o];let s,l=0;for(let t=0;t<this._siblingOffset.length;t++){const n=2*e+this._siblingOffset[t][0],r=2*i+this._siblingOffset[t][1],o=a.getElevation(n,r),u=a.isLeaf(n,r),c=this._addNode(o.min,o.max,u);u&&(l|=1<<t),s||(s=c)}for(let n=0;n<this._siblingOffset.length;n++)l&1<<n||this._construct(t,2*e+this._siblingOffset[n][0],2*i+this._siblingOffset[n][1],o,s+n)}}function op(t,e,i,n,r,o){return ii(ii(t,i,o),ii(e,n,o),r)}function ap(t,e,i){const n=i.dim,r=m(t*n-.5,0,n-1),o=m(e*n-.5,0,n-1),a=Math.floor(r),s=Math.floor(o),l=Math.min(a+1,n-1),u=Math.min(s+1,n-1);return op(i.get(a,s),i.get(l,s),i.get(a,u),i.get(l,u),r-a,o-s)}const sp={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class lp{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,e,i,n=!1,r=!1){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(i&&"mapbox"!==i&&"terrarium"!==i)return E(`"${i}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=e.height;const o=this.dim=e.height-2;if(this.data=new Uint32Array(e.data.buffer),this.encoding=i||"mapbox",this.borderReady=n,!n){for(let t=0;t<o;t++)this.data[this._idx(-1,t)]=this.data[this._idx(0,t)],this.data[this._idx(o,t)]=this.data[this._idx(o-1,t)],this.data[this._idx(t,-1)]=this.data[this._idx(t,0)],this.data[this._idx(t,o)]=this.data[this._idx(t,o-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(o,-1)]=this.data[this._idx(o-1,0)],this.data[this._idx(-1,o)]=this.data[this._idx(0,o-1)],this.data[this._idx(o,o)]=this.data[this._idx(o-1,o-1)],r&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new rp(this)}get(t,e,i=!1){const n=new Uint8Array(this.data.buffer);i&&(t=m(t,-1,this.dim),e=m(e,-1,this.dim));const r=4*this._idx(t,e);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(n[r],n[r+1],n[r+2])}static getUnpackVector(t){return sp[t]}get unpackVector(){return sp[this.encoding]}_idx(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)}_unpackMapbox(t,e,i){return(256*t*256+256*e+i)/10-1e4}_unpackTerrarium(t,e,i){return 256*t+e+i/256-32768}static pack(t,e){const i=[0,0,0,0],n=lp.getUnpackVector(e);let r=Math.floor((t+n[3])/n[2]);return i[2]=r%256,r=Math.floor(r/256),i[1]=r%256,r=Math.floor(r/256),i[0]=r,i}getPixels(){return new $s({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,e,i){if(this.dim!==t.dim)throw Error("dem dimension mismatch");let n=e*this.dim,r=e*this.dim+this.dim,o=i*this.dim,a=i*this.dim+this.dim;switch(e){case-1:n=r-1;break;case 1:r=n+1}switch(i){case-1:o=a-1;break;case 1:a=o+1}const s=-e*this.dim,l=-i*this.dim;for(let e=o;e<a;e++)for(let i=n;i<r;i++)this.data[this._idx(i,e)]=t.data[this._idx(i+s,e+l)]}onDeserialize(){this._tree&&(this._tree.dem=this)}}sr("DEMData",lp),sr("DemMinMaxQuadTree",rp,{omit:["dem"]});class up{constructor(t,e){this.max=t,this.onRemove=e,this.reset()}reset(){for(const t in this.data)for(const e of this.data[t])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(t,e,i){const n=t.wrapped().key;void 0===this.data[n]&&(this.data[n]=[]);const r={value:e,timeout:void 0};if(void 0!==i&&(r.timeout=setTimeout(()=>{this.remove(t,r)},i)),this.data[n].push(r),this.order.push(n),this.order.length>this.max){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const e=this.data[t].shift();return e.timeout&&clearTimeout(e.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),e.value}getByKey(t){const e=this.data[t];return e?e[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,e){if(!this.has(t))return this;const i=t.wrapped().key,n=void 0===e?0:this.data[i].indexOf(e),r=this.data[i][n];return this.data[i].splice(n,1),r.timeout&&clearTimeout(r.timeout),0===this.data[i].length&&delete this.data[i],this.onRemove(r.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(t){const e=[];for(const i in this.data)for(const n of this.data[i])t(n.value)||e.push(n);for(const t of e)this.remove(t.value.tileID,t)}}class cp{constructor(t,e,i){this.func=t,this.mask=e,this.range=i}}cp.ReadOnly=!1,cp.ReadWrite=!0,cp.disabled=new cp(519,cp.ReadOnly,[0,1]);const hp=7680;class pp{constructor(t,e,i,n,r,o){this.test=t,this.ref=e,this.mask=i,this.fail=n,this.depthFail=r,this.pass=o}}pp.disabled=new pp({func:519,mask:0},0,0,hp,hp,hp);class dp{constructor(t,e,i){this.blendFunction=t,this.blendColor=e,this.mask=i}}dp.Replace=[1,0],dp.disabled=new dp(dp.Replace,ce.transparent,[!1,!1,!1,!1]),dp.unblended=new dp(dp.Replace,ce.transparent,[!0,!0,!0,!0]),dp.alphaBlended=new dp([1,771],ce.transparent,[!0,!0,!0,!0]);const fp=1029,mp=2305;class gp{constructor(t,e,i){this.enable=t,this.mode=e,this.frontFace=i}}gp.disabled=new gp(!1,fp,mp),gp.backCCW=new gp(!0,fp,mp),gp.backCW=new gp(!0,fp,2304),gp.frontCW=new gp(!0,1028,2304),gp.frontCCW=new gp(!0,1028,mp);class yp extends Bt{constructor(t,e,i){super(),this.id=t,this._onlySymbols=i,e.on("data",t=>{"source"===t.dataType&&"metadata"===t.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===t.dataType&&"content"===t.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),e.on("error",()=>{this._sourceErrored=!0}),this._source=e,this._tiles={},this._cache=new up(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Jh}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(const t in this._tiles){const e=this._tiles[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,e){return t.isSymbolTile=this._onlySymbols,this._source.loadTile(t,e)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const e in this._tiles){const i=this._tiles[e];i.upload(t),i.prepare(this.map.style.imageManager)}}getIds(){return v(this._tiles).map(t=>t.tileID).sort(vp).map(t=>t.key)}getRenderableIds(t){const e=[];for(const i in this._tiles)this._isIdRenderable(+i,t)&&e.push(this._tiles[i]);return t?e.sort((t,e)=>{const i=t.tileID,n=e.tileID,o=new r(i.canonical.x,i.canonical.y)._rotate(this.transform.angle),a=new r(n.canonical.x,n.canonical.y)._rotate(this.transform.angle);return i.overscaledZ-n.overscaledZ||a.y-o.y||a.x-o.x}).map(t=>t.tileID.key):e.map(t=>t.tileID).sort(vp).map(t=>t.key)}hasRenderableParent(t){const e=this.findLoadedParent(t,0);return!!e&&this._isIdRenderable(e.tileID.key)}_isIdRenderable(t,e){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(e||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(+t,"reloading")}}_reloadTile(t,e){const i=this._tiles[t];i&&("loading"!==i.state&&(i.state=e),this._loadTile(i,this._tileLoaded.bind(this,i,t,e)))}_tileLoaded(t,e,i,n){if(n)return t.state="errored",void(404!==n.status?this._source.fire(new Rt(n,{tile:t})):this.update(this.transform));t.timeAdded=G.now(),"expired"===i&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(e,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new Ot("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const e=this.getRenderableIds();for(let n=0;n<e.length;n++){const r=e[n];if(t.neighboringTiles&&t.neighboringTiles[r]){const e=this.getTileByID(r);i(t,e),i(e,t)}}function i(t,e){if(!t.dem||t.dem.borderReady)return;t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0;let i=e.tileID.canonical.x-t.tileID.canonical.x;const n=e.tileID.canonical.y-t.tileID.canonical.y,r=Math.pow(2,t.tileID.canonical.z),o=e.tileID.key;0===i&&0===n||Math.abs(n)>1||(Math.abs(i)>1&&(1===Math.abs(i+r)?i+=r:1===Math.abs(i-r)&&(i-=r)),e.dem&&t.dem&&(t.dem.backfillBorder(e.dem,i,n),t.neighboringTiles&&t.neighboringTiles[o]&&(t.neighboringTiles[o].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,e,i,n){for(const r in this._tiles){let o=this._tiles[r];if(n[r]||!o.hasData()||o.tileID.overscaledZ<=e||o.tileID.overscaledZ>i)continue;let a=o.tileID;for(;o&&o.tileID.overscaledZ>e+1;){const t=o.tileID.scaledTo(o.tileID.overscaledZ-1);(o=this._tiles[t.key])&&o.hasData()&&(a=t)}let s=a;for(;s.overscaledZ>e;)if(t[(s=s.scaledTo(s.overscaledZ-1)).key]){n[a.key]=a;break}}}findLoadedParent(t,e){if(t.key in this._loadedParentTiles){const i=this._loadedParentTiles[t.key];return i&&i.tileID.overscaledZ>=e?i:null}for(let i=t.overscaledZ-1;i>=e;i--){const e=t.scaledTo(i),n=this._getLoadedTile(e);if(n)return n}}_getLoadedTile(t){const e=this._tiles[t.key];return e&&e.hasData()?e:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,e){e=e||this._source.tileSize;const i=Math.ceil(t.width/e)+1,n=Math.ceil(t.height/e)+1,r=Math.floor(i*n*5),o="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(o)}handleWrapJump(t){const e=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,e){const t={};for(const i in this._tiles){const n=this._tiles[i];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+e),t[n.tileID.key]=n}this._tiles=t;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(+t,this._tiles[t])}}update(t,e,i){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage)return;if(this.usedForTerrain&&!i)return;let n;this.updateCacheSize(t,e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?n=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(t=>new jh(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)):(n=t.coveringTiles({tileSize:e||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!i,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(n=n.filter(t=>this._source.hasTile(t)))):n=[];const r=this._updateRetainedTiles(n);if(_p(this._source.type)&&0!==n.length){const t={},e={},i=Object.keys(r);for(const n of i){const i=r[n],o=this._tiles[n];if(!o||o.fadeEndTime&&o.fadeEndTime<=G.now())continue;const a=this.findLoadedParent(i,Math.max(i.overscaledZ-yp.maxOverzooming,this._source.minzoom));a&&(this._addTile(a.tileID),t[a.tileID.key]=a.tileID),e[n]=i}const o=n[n.length-1].overscaledZ;for(const t in this._tiles){const i=this._tiles[t];if(r[t]||!i.hasData())continue;let n=i.tileID;for(;n.overscaledZ>o;){n=n.scaledTo(n.overscaledZ-1);const o=this._tiles[n.key];if(o&&o.hasData()&&e[n.key]){r[t]=i.tileID;break}}}for(const e in t)r[e]||(this._coveredTiles[e]=!0,r[e]=t[e])}for(const t in r)this._tiles[t].clearFadeHold();const o=function(t,e){const i=[];for(const n in t)n in e||i.push(n);return i}(this._tiles,r);for(const t of o){const e=this._tiles[t];e.hasSymbolBuckets&&!e.holdingForFade()?e.setHoldDuration(this.map._fadeDuration):e.hasSymbolBuckets&&!e.symbolFadeFinished()||this._removeTile(+t)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const e={};if(0===t.length)return e;const i={},n=t[t.length-1].overscaledZ,r=t[0].overscaledZ,o=Math.max(r-yp.maxOverzooming,this._source.minzoom),a=Math.max(r+yp.maxUnderzooming,this._source.minzoom),s={};for(const i of t){const t=this._addTile(i);e[i.key]=i,t.hasData()||n<this._source.maxzoom&&(s[i.key]=i)}this._retainLoadedChildren(s,n,a,e);for(const n of t){let t=this._tiles[n.key];if(t.hasData())continue;if(n.canonical.z>=this._source.maxzoom){const t=n.children(this._source.maxzoom)[0],i=this.getTile(t);if(i&&i.hasData()){e[t.key]=t;continue}}else{const t=n.children(this._source.maxzoom);if(e[t[0].key]&&e[t[1].key]&&e[t[2].key]&&e[t[3].key])continue}let r=t.wasRequested();for(let a=n.overscaledZ-1;a>=o;--a){const o=n.scaledTo(a);if(i[o.key])break;if(i[o.key]=!0,!(t=this.getTile(o))&&r&&(t=this._addTile(o)),t&&(e[o.key]=o,r=t.wasRequested(),t.hasData()))break}}return e}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const e=[];let i,n=this._tiles[t].tileID;for(;n.overscaledZ>0;){if(n.key in this._loadedParentTiles){i=this._loadedParentTiles[n.key];break}e.push(n.key);const t=n.scaledTo(n.overscaledZ-1);if(i=this._getLoadedTile(t))break;n=t}for(const t of e)this._loadedParentTiles[t]=i}}_addTile(t){let e=this._tiles[t.key];if(e)return e;(e=this._cache.getAndRemove(t))&&(this._setTileReloadTimer(t.key,e),e.tileID=t,this._state.initializeTileState(e,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,e)));const i=!!e;return i||(e=new Kh(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom),this._loadTile(e,this._tileLoaded.bind(this,e,t.key,e.state))),e?(e.uses++,this._tiles[t.key]=e,i||this._source.fire(new Ot("dataloading",{tile:e,coord:e.tileID,dataType:"source"})),e):null}_setTileReloadTimer(t,e){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const i=e.getExpiryTimeout();i&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},i))}_removeTile(t){const e=this._tiles[t];e&&(e.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),e.uses>0||(e.hasData()&&"reloading"!==e.state?this._cache.add(e.tileID,e,e.getExpiryTimeout()):(e.aborted=!0,this._abortTile(e),this._unloadTile(e))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._cache.reset()}tilesIn(t,e,i){const n=[],r=this.transform;if(!r)return n;for(const o in this._tiles){const a=this._tiles[o];if(i&&a.clearQueryDebugViz(),a.holdingForFade())continue;const s=t.containsTile(a,r,e);s&&n.push(s)}return n}getVisibleCoordinates(t){const e=this.getRenderableIds(t).map(t=>this._tiles[t].tileID);for(const t of e)t.projMatrix=this.transform.calculateProjMatrix(t.toUnwrapped());return e}hasTransition(){if(this._source.hasTransition())return!0;if(_p(this._source.type))for(const t in this._tiles){const e=this._tiles[t];if(void 0!==e.fadeEndTime&&e.fadeEndTime>=G.now())return!0}return!1}setFeatureState(t,e,i){this._state.updateState(t=t||"_geojsonTileLayer",e,i)}removeFeatureState(t,e,i){this._state.removeFeatureState(t=t||"_geojsonTileLayer",e,i)}getFeatureState(t,e){return this._state.getState(t=t||"_geojsonTileLayer",e)}setDependencies(t,e,i){const n=this._tiles[t];n&&n.setDependencies(e,i)}reloadTilesForDependencies(t,e){for(const i in this._tiles)this._tiles[i].hasDependency(t,e)&&this._reloadTile(+i,"reloading");this._cache.filter(i=>!i.hasDependency(t,e))}}function vp(t,e){const i=Math.abs(2*t.wrap)-+(t.wrap<0),n=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||n-i||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function _p(t){return"raster"===t||"image"===t||"video"===t}yp.maxOverzooming=10,yp.maxUnderzooming=3;class xp{constructor(t,e,i){this._demTile=t,this._dem=this._demTile.dem,this._scale=e,this._offset=i}static create(t,e,i){const n=i||t.findDEMTileFor(e);if(!n||!n.dem)return;const r=n.dem,o=n.tileID,a=1<<e.canonical.z-o.canonical.z;return new xp(n,n.tileSize/Ga/a,[(e.canonical.x/a-o.canonical.x)*r.dim,(e.canonical.y/a-o.canonical.y)*r.dim])}tileCoordToPixel(t,e){const i=e*this._scale+this._offset[1],n=Math.floor(t*this._scale+this._offset[0]),o=Math.floor(i);return new r(n,o)}getElevationAt(t,e,i,n){const r=t*this._scale+this._offset[0],o=e*this._scale+this._offset[1],a=Math.floor(r),s=Math.floor(o),l=this._dem;return n=!!n,i?ii(ii(l.get(a,s,n),l.get(a,s+1,n),o-s),ii(l.get(a+1,s,n),l.get(a+1,s+1,n),o-s),r-a):l.get(a,s,n)}getElevationAtPixel(t,e,i){return this._dem.get(t,e,!!i)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*zh(1,t)*this._dem.stride}}class bp{constructor(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ir(Ga,16,0),this.featureIndexArray=new oa,this.promoteId=e}insert(t,e,i,n,r,o=0){const a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,n,r,o);const s=this.grid;for(let t=0;t<e.length;t++){const i=e[t],n=[1/0,1/0,-1/0,-1/0];for(let t=0;t<i.length;t++){const e=i[t];n[0]=Math.min(n[0],e.x),n[1]=Math.min(n[1],e.y),n[2]=Math.max(n[2],e.x),n[3]=Math.max(n[3],e.y)}n[0]<Ga&&n[1]<Ga&&n[2]>=0&&n[3]>=0&&s.insert(a,n[0],n[1],n[2],n[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Hl.VectorTile(new Du(this.rawTileData)).layers,this.sourceLayerCoder=new qh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,e,i,n){this.loadVTLayers();const r=t.params||{},o=Tn(r.filter),a=t.tileResult,s=t.transform,l=a.bufferedTilespaceBounds,u=this.grid.query(l.min.x,l.min.y,l.max.x,l.max.y,(t,e,i,n)=>os(a.bufferedTilespaceGeometry,t,e,i,n));u.sort(Sp);let c=null;s.elevation&&u.length>0&&(c=xp.create(s.elevation,this.tileID));const h={};let p;for(let s=0;s<u.length;s++){const l=u[s];if(l===p)continue;p=l;const d=this.featureIndexArray.get(l);let f=null;this.loadMatchingFeature(h,d,o,r.layers,r.availableImages,e,i,n,(e,i,n,r=0)=>(f||(f=Ha(e)),i.queryIntersectsFeature(a,e,n,f,this.z,t.transform,t.pixelPosMatrix,c,r)))}return h}loadMatchingFeature(t,e,i,n,r,o,a,s,l){const{featureIndex:u,bucketIndex:c,sourceLayerIndex:h,layoutVertexArrayOffset:p}=e,d=this.bucketLayerIDs[c];if(n&&!function(t,e){for(let i=0;i<t.length;i++)if(e.indexOf(t[i])>=0)return!0;return!1}(n,d))return;const f=this.sourceLayerCoder.decode(h),m=this.vtLayers[f].feature(u);if(i.needGeometry){const t=ja(m,!0);if(!i.filter(new ao(this.tileID.overscaledZ),t,this.tileID.canonical))return}else if(!i.filter(new ao(this.tileID.overscaledZ),m))return;const g=this.getId(m,f);for(let e=0;e<d.length;e++){const i=d[e];if(n&&n.indexOf(i)<0)continue;const c=o[i];if(!c)continue;let h={};void 0!==g&&s&&(h=s.getState(c.sourceLayer||"_geojsonTileLayer",g));const f=_({},a[i]);f.paint=wp(f.paint,c.paint,m,h,r),f.layout=wp(f.layout,c.layout,m,h,r);const y=!l||l(m,c,h,p);if(!y)continue;const v=new Xh(m,this.z,this.x,this.y,g);v.layer=f;let x=t[i];void 0===x&&(x=t[i]=[]),x.push({featureIndex:u,feature:v,intersectionZ:y})}}lookupSymbolFeatures(t,e,i,n,r,o,a,s){const l={};this.loadVTLayers();const u=Tn(r);for(const r of t)this.loadMatchingFeature(l,{bucketIndex:i,sourceLayerIndex:n,featureIndex:r,layoutVertexArrayOffset:0},u,o,a,s,e);return l}hasLayer(t){for(const e of this.bucketLayerIDs)for(const i of e)if(t===i)return!0;return!1}getId(t,e){let i=t.id;return this.promoteId&&("boolean"==typeof(i=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[e]])&&(i=+i)),i}}function wp(t,e,i,n,r){return C(t,(t,o)=>{const a=e instanceof mo?e.get(o):null;return a&&a.evaluate?a.evaluate(i,n,r):a})}function Sp(t,e){return e-t}sr("FeatureIndex",bp,{omit:["rawTileData","sourceLayerCoder"]});class Tp{constructor(t){const e={},i=[];for(const n in t){const r=t[n],o=e[n]={};for(const t in r){const e=r[+t];if(!e||0===e.bitmap.width||0===e.bitmap.height)continue;const n=e.metrics.localGlyph?2:1,a={x:0,y:0,w:e.bitmap.width+2*n,h:e.bitmap.height+2*n};i.push(a),o[t]={rect:a,metrics:e.metrics}}}const{w:n,h:r}=Qu(i),o=new Gs({width:n||1,height:r||1});for(const i in t){const n=t[i];for(const t in n){const r=n[+t];if(!r||0===r.bitmap.width||0===r.bitmap.height)continue;const a=e[i][t].rect,s=r.metrics.localGlyph?2:1;Gs.copy(r.bitmap,o,{x:0,y:0},{x:a.x+s,y:a.y+s},r.bitmap)}}this.image=o,this.positions=e}}sr("GlyphAtlas",Tp);class Mp{constructor(t){this.tileID=new jh(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile}parse(t,e,i,n,r){this.status="parsing",this.data=t,this.collisionBoxArray=new Ko;const o=new qh(Object.keys(t.layers).sort()),a=new bp(this.tileID,this.promoteId);a.bucketLayerIDs=[];const s={},l=new Nh(256,256),u={featureIndex:a,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:l,availableImages:i},c=e.familiesBySource[this.source];for(const e in c){const n=t.layers[e];if(!n)continue;let r=!1,l=!1;for(const t of c[e])"symbol"===t[0].type?r=!0:l=!0;if(!0===this.isSymbolTile&&!r)continue;if(!1===this.isSymbolTile&&!l)continue;1===n.version&&E(`Vector tile source "${this.source}" layer "${e}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const h=o.encode(e),p=[];for(let t=0;t<n.length;t++){const i=n.feature(t),r=a.getId(i,e);p.push({feature:i,id:r,index:t,sourceLayerIndex:h})}for(const t of c[e]){const e=t[0];void 0!==this.isSymbolTile&&"symbol"===e.type!==this.isSymbolTile||e.minzoom&&this.zoom<Math.floor(e.minzoom)||e.maxzoom&&this.zoom>=e.maxzoom||"none"!==e.visibility&&(Ip(t,this.zoom,i),(s[e.id]=e.createBucket({index:a.bucketLayerIDs.length,layers:t,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:h,sourceID:this.source,enableTerrain:this.enableTerrain})).populate(p,u,this.tileID.canonical),a.bucketLayerIDs.push(t.map(t=>t.id)))}}let h,p,d,f;l.trim();const m={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},g=C(u.glyphDependencies,t=>Object.keys(t).map(Number));Object.keys(g).length?n.send("getGlyphs",{uid:this.uid,stacks:g},(t,e)=>{h||(h=t,p=e,x.call(this))},void 0,!1,m):p={};const y=Object.keys(u.iconDependencies);y.length?n.send("getImages",{icons:y,source:this.source,tileID:this.tileID,type:"icons"},(t,e)=>{h||(h=t,d=e,x.call(this))},void 0,!1,m):d={};const _=Object.keys(u.patternDependencies);function x(){if(h)return r(h);if(p&&d&&f){const t=new Tp(p),e=new ec(d,f);for(const n in s){const r=s[n];r instanceof ch?(Ip(r.layers,this.zoom,i),qc(r,p,t.positions,d,e.iconPositions,this.showCollisionBoxes,this.tileID.canonical,this.tileZoom)):r.hasPattern&&(r instanceof uu||r instanceof El||r instanceof Yl)&&(Ip(r.layers,this.zoom,i),r.addFeatures(u,this.tileID.canonical,e.patternPositions))}this.status="done",r(null,{buckets:v(s).filter(t=>!t.isEmpty()),featureIndex:a,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,lineAtlas:l,imageAtlas:e,glyphMap:this.returnDependencies?p:null,iconMap:this.returnDependencies?d:null,glyphPositions:this.returnDependencies?t.positions:null})}}_.length?n.send("getImages",{icons:_,source:this.source,tileID:this.tileID,type:"patterns"},(t,e)=>{h||(h=t,f=e,x.call(this))},void 0,!1,m):f={},x.call(this)}}function Ip(t,e,i){const n=new ao(e);for(const e of t)e.recalculate(n,i)}class Cp{constructor(t){this.entries={},this.scheduler=t}request(t,e,i,n){const r=this.entries[t]=this.entries[t]||{callbacks:[]};if(r.result){const[t,i]=r.result;return this.scheduler?this.scheduler.add(()=>{n(t,i)},e):n(t,i),()=>{}}return r.callbacks.push(n),r.cancel||(r.cancel=i((i,n)=>{r.result=[i,n];for(const t of r.callbacks)this.scheduler?this.scheduler.add(()=>{t(i,n)},e):t(i,n);setTimeout(()=>delete this.entries[t],3e3)})),()=>{r.result||(r.callbacks=r.callbacks.filter(t=>t!==n),r.callbacks.length||(r.cancel(),delete this.entries[t]))}}}function Ap(t,e,i){const n=JSON.stringify(t.request);return t.data&&(this.deduped.entries[n]={result:[null,t.data]}),this.deduped.request(n,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},e=>{const n=Mt(t.request,(t,n,r,o)=>{t?e(t):n&&e(null,{vectorTile:i?void 0:new Hl.VectorTile(new Du(n)),rawData:n,cacheControl:r,expires:o})});return()=>{n.cancel(),e()}},e)}t.ARRAY_TYPE=ds,t.AUTH_ERR_MSG=J,t.Actor=class{constructor(t,e,i){this.target=t,this.parent=e,this.mapId=i,this.callbacks={},this.cancelCallbacks={},M(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=z()?t:a,this.scheduler=new Gh}send(t,e,i,n,r=!1,o){const a=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=o,this.callbacks[a]=i);const s=V(this.globalScope)?void 0:[];return this.target.postMessage({id:a,type:t,hasCallback:!!i,targetMapId:n,mustQueue:r,sourceMapId:this.mapId,data:cr(e,s)},s),{cancel:()=>{i&&delete this.callbacks[a],this.target.postMessage({id:a,type:"<cancel>",targetMapId:n,sourceMapId:this.mapId})}}}receive(t){const e=t.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const t=this.cancelCallbacks[i];delete this.cancelCallbacks[i],t&&t.cancel()}else if(e.mustQueue||z()){const t=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,e),t&&t.metadata||{type:"message"})}else this.processTask(i,e)}processTask(t,e){if("<response>"===e.type){const i=this.callbacks[t];delete this.callbacks[t],i&&(e.error?i(hr(e.error)):i(null,hr(e.data)))}else{const i=V(this.globalScope)?void 0:[],n=e.hasCallback?(e,n)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:e?cr(e):null,data:cr(n,i)},i)}:t=>{},r=hr(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,r,n);else if(this.parent.getWorkerSource){const t=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,t[0],r.source)[t[1]](r,n)}else n(Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},t.CanonicalTileID=Wh,t.Color=ce,t.ColorMode=dp,t.CullFaceMode=gp,t.DEMData=lp,t.DataConstantProperty=go,t.DedupedRequest=Cp,t.DepthMode=cp,t.EXTENT=Ga,t.Elevation=class{getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,i=!0){null==e&&(e=null);const n=this._source();if(!n)return e;if(t.y<0||t.y>1)return e;const r=n.getSource().maxzoom,o=1<<r,a=Math.floor(t.x),s=t.x-a,l=new jh(r,a,r,Math.floor(s*o),Math.floor(t.y*o)),u=this.findDEMTileFor(l);if(!u||!u.dem)return e;const c=u.dem,h=1<<u.tileID.canonical.z,p=(s*h-u.tileID.canonical.x)*c.dim,d=(t.y*h-u.tileID.canonical.y)*c.dim,f=Math.floor(p),m=Math.floor(d);return(i?this.exaggeration():1)*ii(ii(c.get(f,m),c.get(f,m+1),d-m),ii(c.get(f+1,m),c.get(f+1,m+1),d-m),p-f)}getAtTileOffset(t,e,i){const n=1<<t.canonical.z;return this.getAtPointOrZero(new Bh(t.wrap+(t.canonical.x+e/Ga)/n,(t.canonical.y+i/Ga)/n))}getForTilePoints(t,e,i,n){const r=xp.create(this,t,n);return!!r&&(e.forEach(t=>{t[2]=this.exaggeration()*r.getElevationAt(t[0],t[1],i)}),!0)}getMinMaxForTile(t){const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const i=e.dem.tree,n=e.tileID,r=1<<t.canonical.z-n.canonical.z;let o=t.canonical.x/r-n.canonical.x,a=t.canonical.y/r-n.canonical.y,s=0;for(let e=0;e<t.canonical.z-n.canonical.z&&!i.leaves[s];e++){o*=2;const t=2*Math.floor(a*=2)+Math.floor(o);s=i.childOffsets[s]+t,o%=1,a%=1}return{min:this.exaggeration()*i.minimums[s],max:this.exaggeration()*i.maximums[s]}}getMinElevationBelowMSL(){throw Error("Pure virtual method called.")}raycast(t,e,i){throw Error("Pure virtual method called.")}pointCoordinate(t){throw Error("Pure virtual method called.")}_source(){throw Error("Pure virtual method called.")}exaggeration(){throw Error("Pure virtual method called.")}findDEMTileFor(t){throw Error("Pure virtual method called.")}get visibleDemTiles(){throw Error("Getter must be implemented in subclass.")}},t.ErrorEvent=Rt,t.EvaluationParameters=ao,t.Event=Ot,t.Evented=Bt,t.GlyphManager=Oc,t.ImagePosition=tc,t.LineAtlas=Nh,t.LngLat=kh,t.LngLatBounds=Ch,t.LocalGlyphMode=zc,t.MAX_SAFE_INTEGER=s,t.MercatorCoordinate=Bh,t.ONE_EM=xu,t.OverscaledTileID=jh,t.Properties=bo,t.RGBAImage=$s,t.RequestManager=class{constructor(t,e,i){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const t=function(){let t="";for(let e=0;e<10;e++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:"1"+K+t,tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!Q(t))return t;const i=it(t);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!Q(t))return t;const i=it(t);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeSourceURL(t,e){if(!Q(t))return t;const i=it(t);return i.path=`/v4/${i.authority}.json`,i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||e)}normalizeSpriteURL(t,e,i,n){const r=it(t);return Q(t)?(r.path=`/styles/v1${r.path}/sprite${e}${i}`,this._makeAPIURL(r,this._customAccessToken||n)):(r.path+=`${e}${i}`,nt(r))}normalizeTileURL(t,e,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Q(t))return t;const n=it(t);n.path=n.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||i&&"raster"!==n.authority&&512===i?"@2x":""}${H.supported?".webp":"$1"}`),"raster"===n.authority?n.path=`/${W.RASTER_URL_PREFIX}${n.path}`:(n.path=n.path.replace(/^.+\/v4\//,"/"),n.path=`/${W.TILE_URL_VERSION}${n.path}`);const r=this._customAccessToken||function(t){for(const e of t){const t=e.match(/^access_token=(.*)$/);if(t)return t[1]}return null}(n.params)||W.ACCESS_TOKEN;return W.REQUIRE_ACCESS_TOKEN&&r&&this._skuToken&&n.params.push(`sku=${this._skuToken}`),this._makeAPIURL(n,r)}canonicalizeTileURL(t,e){const i=it(t);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return t;let n="mapbox://";i.path.match(/^\/raster\/v1\//)?n+=`raster/${i.path.replace(`/${W.RASTER_URL_PREFIX}/`,"")}`:n+=`tiles/${i.path.replace(`/${W.TILE_URL_VERSION}/`,"")}`;let r=i.params;return e&&(r=r.filter(t=>!t.match(/^access_token=/))),r.length&&(n+=`?${r.join("&")}`),n}canonicalizeTileset(t,e){const i=!!e&&Q(e),n=[];for(const e of t.tiles||[])tt(e)?n.push(this.canonicalizeTileURL(e,i)):n.push(e);return n}_makeAPIURL(t,e){const i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",n=it(W.API_URL);if(t.protocol=n.protocol,t.authority=n.authority,"http"===t.protocol){const e=t.params.indexOf("secure");e>=0&&t.params.splice(e,1)}if("/"!==n.path&&(t.path=`${n.path}${t.path}`),!W.REQUIRE_ACCESS_TOKEN)return nt(t);if(e=e||W.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw Error(`An API access token is required to use Mapbox GL. ${i}`);if("s"===e[0])throw Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return t.params=t.params.filter(t=>-1===t.indexOf("access_token")),t.params.push(`access_token=${e||""}`),nt(t)}},t.ResourceType=bt,t.SegmentVector=Ua,t.SourceCache=yp,t.StencilMode=pp,t.StructArrayLayout1ui2=qo,t.StructArrayLayout2f1f2i16=Fo,t.StructArrayLayout2i4=Ao,t.StructArrayLayout2ui4=Zo,t.StructArrayLayout3f12=Oo,t.StructArrayLayout3ui6=Uo,t.StructArrayLayout4i8=ko,t.Texture=Ih,t.Tile=Kh,t.Transitionable=uo,t.Uniform1f=_a,t.Uniform1i=class extends va{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))}},t.Uniform2f=class extends va{constructor(t,e){super(t,e),this.current=[0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))}},t.Uniform3f=class extends va{constructor(t,e){super(t,e),this.current=[0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))}},t.Uniform4f=xa,t.UniformColor=ba,t.UniformMatrix3f=class extends va{constructor(t,e){super(t,e),this.current=Sa}set(t){for(let e=0;e<9;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix3fv(this.location,!1,t);break}}},t.UniformMatrix4f=class extends va{constructor(t,e){super(t,e),this.current=wa}set(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(let e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}}},t.UnwrappedTileID=Hh,t.ValidationError=Ft,t.VectorTileWorkerSource=class extends Bt{constructor(t,e,i,n,r){super(),this.actor=t,this.layerIndex=e,this.availableImages=i,this.loadVectorData=r||Ap,this.loading={},this.loaded={},this.deduped=new Cp(t.scheduler),this.isSpriteLoaded=n,this.scheduler=t.scheduler}loadTile(t,e){const i=t.uid,n=t&&t.request,r=n&&n.collectResourceTiming,o=this.loading[i]=new Mp(t);o.abort=this.loadVectorData(t,(a,s)=>{const l=!this.loading[i];if(delete this.loading[i],l||a||!s)return o.status="done",l||(this.loaded[i]=o),e(a);const u=s.rawData,c={};s.expires&&(c.expires=s.expires),s.cacheControl&&(c.cacheControl=s.cacheControl),o.vectorTile=s.vectorTile||new Hl.VectorTile(new Du(u));const h=()=>{o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,(t,i)=>{if(t||!i)return e(t);const o={};if(r){const t=Uh(n);t.length>0&&(o.resourceTiming=JSON.parse(JSON.stringify(t)))}e(null,_({rawTileData:u.slice(0)},i,c,o))})};this.isSpriteLoaded?h():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(h,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):h()}),this.loaded=this.loaded||{},this.loaded[i]=o})}reloadTile(t,e){const i=this.loaded,n=t.uid,r=this;if(i&&i[n]){const o=i[n];o.showCollisionBoxes=t.showCollisionBoxes,o.enableTerrain=!!t.enableTerrain;const a=(t,i)=>{const n=o.reloadCallback;n&&(delete o.reloadCallback,o.parse(o.vectorTile,r.layerIndex,this.availableImages,r.actor,n)),e(t,i)};"parsing"===o.status?o.reloadCallback=a:"done"===o.status&&(o.vectorTile?o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,a):a())}}abortTile(t,e){const i=t.uid,n=this.loading[i];n&&(n.abort&&n.abort(),delete this.loading[i]),e()}removeTile(t,e){const i=this.loaded,n=t.uid;i&&i[n]&&delete i[n],e()}},t.WritingMode=ic,t.ZoomHistory=pr,t.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t},t.addDynamicAttributes=ah,t.altitudeFromMercatorZ=Rh,t.asyncAll=y,t.bezier=d,t.bindAll=M,t.bufferConvexPolygon=function(t,e){const i=[];for(let n=0;n<t.length;n++){const r=g(n-1,-1,t.length-1),o=g(n+1,-1,t.length-1),a=t[n],s=t[o],l=t[r].sub(a).unit(),u=s.sub(a).unit(),c=u.angleWithSep(l.x,l.y),h=l.add(u).unit().mult(-1*e/Math.sin(c/2));i.push(a.add(h))}return i},t.cacheEntryPossiblyAdded=function(t){++xt>yt&&(t.getActor().send("enforceCacheSizeLimit",gt),xt=0)},t.clamp=m,t.clearTileCache=function(t){const e=a.caches.delete(dt);t&&e.catch(t).then(()=>t())},t.clipLine=Cc,t.clone=function(t){var e=new ds(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},t.clone$1=function(t){var e=new ds(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.clone$2=k,t.collisionCircleLayout=_u,t.config=W,t.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},t.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},t.create=vs,t.create$1=function(){var t=new ds(16);return ds!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},t.create$2=fs,t.createExpression=cn,t.createFilter=Tn,t.createLayout=Io,t.createStyleLayer=function(t){return"custom"===t.type?new yh(t):new xh[t.type](t)},t.cross=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=i[0],s=i[1],l=i[2];return t[0]=r*l-o*s,t[1]=o*a-n*l,t[2]=n*s-r*a,t},t.degToRad=c,t.div=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t},t.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},t.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},t.ease=f,t.easeCubicInOut=p,t.emitValidationErrors=er,t.endsWith=I,t.enforceCacheSizeLimit=function(t){vt(),ft&&ft.then(e=>{e.keys().then(i=>{for(let n=0;n<i.length-t;n++)e.delete(i[n])})})},t.evaluateSizeForFeature=Su,t.evaluateSizeForZoom=Tu,t.evaluateVariableOffset=Zc,t.evented=io,t.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},t.exactEquals$1=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},t.exported=G,t.exported$1=H,t.extend=_,t.filterObject=A,t.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},t.fromQuat=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=i+i,s=n+n,l=r+r,u=i*a,c=n*a,h=n*s,p=r*a,d=r*s,f=r*l,m=o*a,g=o*s,y=o*l;return t[0]=1-h-f,t[1]=c+y,t[2]=p-g,t[3]=0,t[4]=c-y,t[5]=1-u-f,t[6]=d+m,t[7]=0,t[8]=p+g,t[9]=d-m,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.fromRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=0,t[3]=-i,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},t.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},t.furthestTileCorner=function(t){const e=Math.round((t+45+360)%360/90)%4;return h[e]},t.getAABBPointSquareDist=function(t,e,i){let n=0;for(let r=0;r<2;++r){const o=i?i[r]:0;t[r]>o&&(n+=(t[r]-o)*(t[r]-o)),e[r]<o&&(n+=(o-e[r])*(o-e[r]))}return n},t.getAnchorAlignment=mc,t.getAnchorJustification=Xc,t.getBounds=function(t){let e=1/0,i=1/0,n=-1/0,o=-1/0;for(const r of t)e=Math.min(e,r.x),i=Math.min(i,r.y),n=Math.max(n,r.x),o=Math.max(o,r.y);return{min:new r(e,i),max:new r(n,o)}},t.getImage=Pt,t.getJSON=function(t,e){return Tt(_(t,{type:"json"}),e)},t.getMapSessionAPI=ht,t.getPerformanceMeasurement=Uh,t.getRTLTextPluginStatus=no,t.getReferrer=St,t.getVideo=function(t,e){const i=a.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let e=0;e<t.length;e++){const n=a.document.createElement("source");At(t[e])||(i.crossOrigin="Anonymous"),n.src=t[e],i.appendChild(n)}return{cancel:()=>{}}},t.identity=ms,t.identity$1=Ps,t.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],h=e[9],p=e[10],d=e[11],f=e[12],m=e[13],g=e[14],y=e[15],v=i*s-n*a,_=i*l-r*a,x=i*u-o*a,b=n*l-r*s,w=n*u-o*s,S=r*u-o*l,T=c*m-h*f,M=c*g-p*f,I=c*y-d*f,C=h*g-p*m,A=h*y-d*m,k=p*y-d*g,D=v*k-_*A+x*C+b*I-w*M+S*T;return D?(t[0]=(s*k-l*A+u*C)*(D=1/D),t[1]=(r*A-n*k-o*C)*D,t[2]=(m*S-g*w+y*b)*D,t[3]=(p*w-h*S-d*b)*D,t[4]=(l*I-a*k-u*M)*D,t[5]=(i*k-r*I+o*M)*D,t[6]=(g*x-f*S-y*_)*D,t[7]=(c*S-p*x+d*_)*D,t[8]=(a*A-s*I+u*T)*D,t[9]=(n*I-i*A-o*T)*D,t[10]=(f*w-m*x+y*v)*D,t[11]=(h*x-c*w-d*v)*D,t[12]=(s*M-a*C-l*T)*D,t[13]=(i*C-n*M+r*T)*D,t[14]=(m*_-f*b-g*v)*D,t[15]=(c*b-h*_+p*v)*D,t):null},t.isMapAuthenticated=function(t){return pt.has(t)},t.isMapboxURL=Q,t.latFromMercatorY=Oh,t.len=ks,t.length=_s,t.length$1=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},t.loadVectorTile=Ap,t.makeRequest=Tt,t.mercatorXfromLng=Ph,t.mercatorYfromLat=Lh,t.mercatorZfromAltitude=zh,t.mul=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t},t.mul$1=ys,t.mul$2=As,t.multiply=gs,t.multiply$1=ws,t.nextPowerOfTwo=S,t.normalize=Ts,t.normalize$1=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],a=i*i+n*n+r*r+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=i*a,t[1]=n*a,t[2]=r*a,t[3]=o*a,t},t.number=ii,t.ortho=function(t,e,i,n,r,o,a){var s=1/(e-i),l=1/(n-r),u=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+i)*s,t[13]=(r+n)*l,t[14]=(a+o)*u,t[15]=1,t},t.pbf=Du,t.perspective=function(t,e,i,n,r){var o,a=1/Math.tan(e/2);return t[0]=a/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(t[10]=(r+n)*(o=1/(n-r)),t[14]=2*r*n*o):(t[10]=-1,t[14]=-2*n),t},t.pick=function(t,e){const i={};for(let n=0;n<e.length;n++){const r=e[n];r in t&&(i[r]=t[r])}return i},t.plugin=oo,t.pointGeometry=r,t.polygonIntersectsBox=os,t.polygonIntersectsPolygon=Xa,t.polygonizeBounds=function(t,e,i=0,n=!0){const o=new r(i,i),a=t.sub(o),s=e.add(o),l=[a,new r(s.x,a.y),s,new r(a.x,s.y)];return n&&l.push(a),l},t.posAttributes=Yh,t.postMapLoadEvent=ut,t.postTurnstileEvent=st,t.potpack=Qu,t.prevPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},t.radToDeg=function(t){return t*u},t.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],t.registerForPluginStateChange=function(t){return t({pluginStatus:Jr,pluginURL:Qr}),io.on("pluginStateChange",t),t},t.removeAuthState=function(t){pt.delete(t)},t.renderColorRamp=Hs,t.rotateX=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+u*n,t[5]=a*r+c*n,t[6]=s*r+h*n,t[7]=l*r+p*n,t[8]=u*r-o*n,t[9]=c*r-a*n,t[10]=h*r-s*n,t[11]=p*r-l*n,t},t.rotateX$1=Ls,t.rotateY=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],a=e[1],s=e[2],l=e[3],u=e[8],c=e[9],h=e[10],p=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-u*n,t[1]=a*r-c*n,t[2]=s*r-h*n,t[3]=l*r-p*n,t[8]=o*n+u*r,t[9]=a*n+c*r,t[10]=s*n+h*r,t[11]=l*n+p*r,t},t.rotateZ=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],a=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+u*n,t[1]=a*r+c*n,t[2]=s*r+h*n,t[3]=l*r+p*n,t[4]=u*r-o*n,t[5]=c*r-a*n,t[6]=h*r-s*n,t[7]=p*r-l*n,t},t.rotateZ$1=function(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(i),l=Math.cos(i);return t[0]=n*l+r*s,t[1]=r*l-n*s,t[2]=o*l+a*s,t[3]=a*l-o*s,t},t.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},t.scale$1=function(t,e,i){var n=i[0],r=i[1],o=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},t.scale$2=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},t.scaleAndAdd=Ss,t.setCacheLimits=function(t,e){gt=t,yt=e},t.setRTLTextPlugin=function(t,e,i=!1){if(Jr===qr||Jr===Xr||Jr===Yr)throw Error("setRTLTextPlugin cannot be called multiple times.");Qr=G.resolveURL(t),Jr=qr,Kr=e,eo(),i||ro()},t.smoothstep=function(t,e,i){return(i=m((i-t)/(e-t),0,1))*i*(3-2*i)},t.spec=Nt,t.storeAuthState=function(t,e){e?pt.add(t):pt.delete(t)},t.sub=Cs,t.subtract=bs,t.symbolSize=Mu,t.transformMat3=function(t,e,i){var n=e[0],r=e[1],o=e[2];return t[0]=n*i[0]+r*i[3]+o*i[6],t[1]=n*i[1]+r*i[4]+o*i[7],t[2]=n*i[2]+r*i[5]+o*i[8],t},t.transformMat4=Ds,t.transformMat4$1=function(t,e,i){var n=e[0],r=e[1],o=e[2],a=i[3]*n+i[7]*r+i[11]*o+i[15];return t[0]=(i[0]*n+i[4]*r+i[8]*o+i[12])/(a=a||1),t[1]=(i[1]*n+i[5]*r+i[9]*o+i[13])/a,t[2]=(i[2]*n+i[6]*r+i[10]*o+i[14])/a,t},t.transformQuat=Ms,t.translate=function(t,e,i){var n,r,o,a,s,l,u,c,h,p,d,f,m=i[0],g=i[1],y=i[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*y+e[12],t[13]=e[1]*m+e[5]*g+e[9]*y+e[13],t[14]=e[2]*m+e[6]*g+e[10]*y+e[14],t[15]=e[3]*m+e[7]*g+e[11]*y+e[15]):(r=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],p=e[9],d=e[10],f=e[11],t[0]=n=e[0],t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=p,t[10]=d,t[11]=f,t[12]=n*m+s*g+h*y+e[12],t[13]=r*m+l*g+p*y+e[13],t[14]=o*m+u*g+d*y+e[14],t[15]=a*m+c*g+f*y+e[15]),t},t.triggerPluginCompletionEvent=to,t.uniqueId=b,t.validateCustomStyleLayer=function(t){const e=[],i=t.id;return void 0===i&&e.push({message:`layers.${i}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${i}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},t.validateFog=Jn,t.validateLight=Kn,t.validateStyle=Yn,t.values=v,t.vectorTile=Hl,t.version=e,t.warnOnce=E,t.window=a,t.wrap=g}),r(["./shared"],function(t){function e(t){const i=typeof t;if("number"===i||"boolean"===i||"string"===i||null==t)return JSON.stringify(t);if(Array.isArray(t)){let i="[";for(const n of t)i+=`${e(n)},`;return`${i}]`}const n=Object.keys(t).sort();let r="{";for(let i=0;i<n.length;i++)r+=`${JSON.stringify(n[i])}:${e(t[n[i]])},`;return`${r}}`}function i(i){let n="";for(const r of t.refProperties)n+=`/${e(i[r])}`;return n}class n{constructor(t){this.keyCache={},t&&this.replace(t)}replace(t){this._layerConfigs={},this._layers={},this.update(t,[])}update(e,n){for(const i of e){this._layerConfigs[i.id]=i;const e=this._layers[i.id]=t.createStyleLayer(i);e._featureFilter=t.createFilter(e.filter),this.keyCache[i.id]&&delete this.keyCache[i.id]}for(const t of n)delete this.keyCache[t],delete this._layerConfigs[t],delete this._layers[t];this.familiesBySource={};const r=function(t,e){const n={};for(let r=0;r<t.length;r++){const o=e&&e[t[r].id]||i(t[r]);e&&(e[t[r].id]=o);let a=n[o];a||(a=n[o]=[]),a.push(t[r])}const r=[];for(const t in n)r.push(n[t]);return r}(t.values(this._layerConfigs),this.keyCache);for(const t of r){const e=t.map(t=>this._layers[t.id]),i=e[0];if("none"===i.visibility)continue;const n=i.source||"";let r=this.familiesBySource[n];r||(r=this.familiesBySource[n]={});const o=i.sourceLayer||"_geojsonTileLayer";let a=r[o];a||(a=r[o]=[]),a.push(e)}}}const{ImageBitmap:r}=t.window;class o{loadTile(e,i){const{uid:n,encoding:o,rawImageData:a,padding:s,buildQuadTree:l}=e,u=r&&a instanceof r?this.getImageData(a,s):a;i(null,new t.DEMData(n,u,o,s<1,l))}getImageData(e,i){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);const n=this.offscreenCanvasContext.getImageData(-i,-i,e.width+2*i,e.height+2*i);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new t.RGBAImage({width:n.width,height:n.height},n.data)}}var a=function t(e,i){var n,r=e&&e.type;if("FeatureCollection"===r)for(n=0;n<e.features.length;n++)t(e.features[n],i);else if("GeometryCollection"===r)for(n=0;n<e.geometries.length;n++)t(e.geometries[n],i);else if("Feature"===r)t(e.geometry,i);else if("Polygon"===r)s(e.coordinates,i);else if("MultiPolygon"===r)for(n=0;n<e.coordinates.length;n++)s(e.coordinates[n],i);return e};function s(t,e){if(0!==t.length){l(t[0],e);for(var i=1;i<t.length;i++)l(t[i],!e)}}function l(t,e){for(var i=0,n=0,r=t.length,o=r-1;n<r;o=n++)i+=(t[n][0]-t[o][0])*(t[o][1]+t[n][1]);i>=0!=!!e&&t.reverse()}const u=t.vectorTile.VectorTileFeature.prototype.toGeoJSON;class c{constructor(e){this._feature=e,this.extent=t.EXTENT,this.type=e.type,this.properties=e.tags,"id"in e&&!isNaN(e.id)&&(this.id=parseInt(e.id,10))}loadGeometry(){if(1===this._feature.type){const e=[];for(const i of this._feature.geometry)e.push([new t.pointGeometry(i[0],i[1])]);return e}{const e=[];for(const i of this._feature.geometry){const n=[];for(const e of i)n.push(new t.pointGeometry(e[0],e[1]));e.push(n)}return e}}toGeoJSON(t,e,i){return u.call(this,t,e,i)}}class h{constructor(e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=t.EXTENT,this.length=e.length,this._features=e}feature(t){return new c(this._features[t])}}var p=t.vectorTile.VectorTileFeature,d=f;function f(t,e){this.options=e||{},this.features=t,this.length=t.length}function m(t,e){this.id="number"==typeof t.id?t.id:void 0,this.type=t.type,this.rawGeometry=1===t.type?[t.geometry]:t.geometry,this.properties=t.tags,this.extent=e||4096}f.prototype.feature=function(t){return new m(this.features[t],this.options.extent)},m.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var i=0;i<e.length;i++){for(var n=e[i],r=[],o=0;o<n.length;o++)r.push(new t.pointGeometry(n[o][0],n[o][1]));this.geometry.push(r)}return this.geometry},m.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var t=this.geometry,e=1/0,i=-1/0,n=1/0,r=-1/0,o=0;o<t.length;o++)for(var a=t[o],s=0;s<a.length;s++){var l=a[s];e=Math.min(e,l.x),i=Math.max(i,l.x),n=Math.min(n,l.y),r=Math.max(r,l.y)}return[e,n,i,r]},m.prototype.toGeoJSON=p.prototype.toGeoJSON;var g=v,y=d;function v(e){var i=new t.pbf;return function(t,e){for(var i in t.layers)e.writeMessage(3,_,t.layers[i])}(e,i),i.finish()}function _(t,e){var i;e.writeVarintField(15,t.version||1),e.writeStringField(1,t.name||""),e.writeVarintField(5,t.extent||4096);var n={keys:[],values:[],keycache:{},valuecache:{}};for(i=0;i<t.length;i++)n.feature=t.feature(i),e.writeMessage(2,x,n);var r=n.keys;for(i=0;i<r.length;i++)e.writeStringField(3,r[i]);var o=n.values;for(i=0;i<o.length;i++)e.writeMessage(4,M,o[i])}function x(t,e){var i=t.feature;void 0!==i.id&&e.writeVarintField(1,i.id),e.writeMessage(2,b,t),e.writeVarintField(3,i.type),e.writeMessage(4,T,i)}function b(t,e){var i=t.feature,n=t.keys,r=t.values,o=t.keycache,a=t.valuecache;for(var s in i.properties){var l=o[s];void 0===l&&(n.push(s),o[s]=l=n.length-1),e.writeVarint(l);var u=i.properties[s],c=typeof u;"string"!==c&&"boolean"!==c&&"number"!==c&&(u=JSON.stringify(u));var h=c+":"+u,p=a[h];void 0===p&&(r.push(u),a[h]=p=r.length-1),e.writeVarint(p)}}function w(t,e){return(e<<3)+(7&t)}function S(t){return t<<1^t>>31}function T(t,e){for(var i=t.loadGeometry(),n=t.type,r=0,o=0,a=i.length,s=0;s<a;s++){var l=i[s],u=1;1===n&&(u=l.length),e.writeVarint(w(1,u));for(var c=3===n?l.length-1:l.length,h=0;h<c;h++){1===h&&1!==n&&e.writeVarint(w(2,c-1));var p=l[h].x-r,d=l[h].y-o;e.writeVarint(S(p)),e.writeVarint(S(d)),r+=p,o+=d}3===n&&e.writeVarint(w(7,1))}}function M(t,e){var i=typeof t;"string"===i?e.writeStringField(1,t):"boolean"===i?e.writeBooleanField(7,t):"number"===i&&(t%1!=0?e.writeDoubleField(3,t):t<0?e.writeSVarintField(6,t):e.writeVarintField(5,t))}function I(t,e,i,n,r,o){if(r-n<=i)return;const a=n+r>>1;C(t,e,a,n,r,o%2),I(t,e,i,n,a-1,o+1),I(t,e,i,a+1,r,o+1)}function C(t,e,i,n,r,o){for(;r>n;){if(r-n>600){const a=r-n+1,s=i-n+1,l=Math.log(a),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(a-u)/a)*(s-a/2<0?-1:1);C(t,e,i,Math.max(n,Math.floor(i-s*u/a+c)),Math.min(r,Math.floor(i+(a-s)*u/a+c)),o)}const a=e[2*i+o];let s=n,l=r;for(A(t,e,n,i),e[2*r+o]>a&&A(t,e,n,r);s<l;){for(A(t,e,s,l),s++,l--;e[2*s+o]<a;)s++;for(;e[2*l+o]>a;)l--}e[2*n+o]===a?A(t,e,n,l):A(t,e,++l,r),l<=i&&(n=l+1),i<=l&&(r=l-1)}}function A(t,e,i,n){k(t,i,n),k(e,2*i,2*n),k(e,2*i+1,2*n+1)}function k(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}function D(t,e,i,n){const r=t-i,o=e-n;return r*r+o*o}g.fromVectorTileJs=v,g.fromGeojsonVt=function(t,e){e=e||{};var i={};for(var n in t)i[n]=new d(t[n].features,e),i[n].name=n,i[n].version=e.version,i[n].extent=e.extent;return v({layers:i})},g.GeoJSONWrapper=y;const E=t=>t[0],P=t=>t[1];class L{constructor(t,e=E,i=P,n=64,r=Float64Array){this.nodeSize=n,this.points=t;const o=t.length<65536?Uint16Array:Uint32Array,a=this.ids=new o(t.length),s=this.coords=new r(2*t.length);for(let n=0;n<t.length;n++)a[n]=n,s[2*n]=e(t[n]),s[2*n+1]=i(t[n]);I(a,s,n,0,a.length-1,0)}range(t,e,i,n){return function(t,e,i,n,r,o,a){const s=[0,t.length-1,0],l=[];let u,c;for(;s.length;){const h=s.pop(),p=s.pop(),d=s.pop();if(p-d<=a){for(let a=d;a<=p;a++)u=e[2*a],c=e[2*a+1],u>=i&&u<=r&&c>=n&&c<=o&&l.push(t[a]);continue}const f=Math.floor((d+p)/2);u=e[2*f],c=e[2*f+1],u>=i&&u<=r&&c>=n&&c<=o&&l.push(t[f]);const m=(h+1)%2;(0===h?i<=u:n<=c)&&(s.push(d),s.push(f-1),s.push(m)),(0===h?r>=u:o>=c)&&(s.push(f+1),s.push(p),s.push(m))}return l}(this.ids,this.coords,t,e,i,n,this.nodeSize)}within(t,e,i){return function(t,e,i,n,r,o){const a=[0,t.length-1,0],s=[],l=r*r;for(;a.length;){const u=a.pop(),c=a.pop(),h=a.pop();if(c-h<=o){for(let r=h;r<=c;r++)D(e[2*r],e[2*r+1],i,n)<=l&&s.push(t[r]);continue}const p=Math.floor((h+c)/2),d=e[2*p],f=e[2*p+1];D(d,f,i,n)<=l&&s.push(t[p]);const m=(u+1)%2;(0===u?i-r<=d:n-r<=f)&&(a.push(h),a.push(p-1),a.push(m)),(0===u?i+r>=d:n+r>=f)&&(a.push(p+1),a.push(c),a.push(m))}return s}(this.ids,this.coords,t,e,i,this.nodeSize)}}const z={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},O=Math.fround||(R=new Float32Array(1),t=>(R[0]=+t,R[0]));var R;class B{constructor(t){this.options=H(Object.create(z),t),this.trees=Array(this.options.maxZoom+1)}load(t){const{log:e,minZoom:i,maxZoom:n,nodeSize:r}=this.options;e&&console.time("total time");const o=`prepare ${t.length} points`;e&&console.time(o),this.points=t;let a=[];for(let e=0;e<t.length;e++)t[e].geometry&&a.push(F(t[e],e));this.trees[n+1]=new L(a,j,Z,r,Float32Array),e&&console.timeEnd(o);for(let t=n;t>=i;t--){const i=+Date.now();a=this._cluster(a,t),this.trees[t]=new L(a,j,Z,r,Float32Array),e&&console.log("z%d: %d clusters in %dms",t,a.length,+Date.now()-i)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let i=((t[0]+180)%360+360)%360-180;const n=Math.max(-90,Math.min(90,t[1]));let r=180===t[2]?180:((t[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)i=-180,r=180;else if(i>r){const t=this.getClusters([i,n,180,o],e),a=this.getClusters([-180,n,r,o],e);return t.concat(a)}const a=this.trees[this._limitZoom(e)],s=a.range(G(i),$(o),G(r),$(n)),l=[];for(const t of s){const e=a.points[t];l.push(e.numPoints?V(e):this.points[e.index])}return l}getChildren(t){const e=this._getOriginId(t),i=this._getOriginZoom(t),n="No cluster with the specified id.",r=this.trees[i];if(!r)throw Error(n);const o=r.points[e];if(!o)throw Error(n);const a=this.options.radius/(this.options.extent*Math.pow(2,i-1)),s=r.within(o.x,o.y,a),l=[];for(const e of s){const i=r.points[e];i.parentId===t&&l.push(i.numPoints?V(i):this.points[i.index])}if(0===l.length)throw Error(n);return l}getLeaves(t,e,i){const n=[];return this._appendLeaves(n,t,e=e||10,i=i||0,0),n}getTile(t,e,i){const n=this.trees[this._limitZoom(t)],r=Math.pow(2,t),{extent:o,radius:a}=this.options,s=a/o,l=(i-s)/r,u=(i+1+s)/r,c={features:[]};return this._addTileFeatures(n.range((e-s)/r,l,(e+1+s)/r,u),n.points,e,i,r,c),0===e&&this._addTileFeatures(n.range(1-s/r,l,1,u),n.points,r,i,r,c),e===r-1&&this._addTileFeatures(n.range(0,l,s/r,u),n.points,-1,i,r,c),c.features.length?c:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const i=this.getChildren(t);if(e++,1!==i.length)break;t=i[0].properties.cluster_id}return e}_appendLeaves(t,e,i,n,r){const o=this.getChildren(e);for(const e of o){const o=e.properties;if(o&&o.cluster?r+o.point_count<=n?r+=o.point_count:r=this._appendLeaves(t,o.cluster_id,i,n,r):r<n?r++:t.push(e),t.length===i)break}return r}_addTileFeatures(t,e,i,n,r,o){for(const a of t){const t=e[a],s=t.numPoints;let l,u,c;if(s)l=U(t),u=t.x,c=t.y;else{const e=this.points[t.index];l=e.properties,u=G(e.geometry.coordinates[0]),c=$(e.geometry.coordinates[1])}const h={type:1,geometry:[[Math.round(this.options.extent*(u*r-i)),Math.round(this.options.extent*(c*r-n))]],tags:l};let p;s?p=t.id:this.options.generateId?p=t.index:this.points[t.index].id&&(p=this.points[t.index].id),void 0!==p&&(h.id=p),o.features.push(h)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(+t,this.options.maxZoom+1))}_cluster(t,e){const i=[],{radius:n,extent:r,reduce:o,minPoints:a}=this.options,s=n/(r*Math.pow(2,e));for(let n=0;n<t.length;n++){const r=t[n];if(r.zoom<=e)continue;r.zoom=e;const l=this.trees[e+1],u=l.within(r.x,r.y,s),c=r.numPoints||1;let h=c;for(const t of u){const i=l.points[t];i.zoom>e&&(h+=i.numPoints||1)}if(h>=a){let t=r.x*c,a=r.y*c,s=o&&c>1?this._map(r,!0):null;const p=(n<<5)+(e+1)+this.points.length;for(const i of u){const n=l.points[i];if(n.zoom<=e)continue;n.zoom=e;const u=n.numPoints||1;t+=n.x*u,a+=n.y*u,n.parentId=p,o&&(s||(s=this._map(r,!0)),o(s,this._map(n)))}r.parentId=p,i.push(N(t/h,a/h,p,h,s))}else if(i.push(r),h>1)for(const t of u){const n=l.points[t];n.zoom<=e||(n.zoom=e,i.push(n))}}return i}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e){if(t.numPoints)return e?H({},t.properties):t.properties;const i=this.points[t.index].properties,n=this.options.map(i);return e&&n===i?H({},n):n}}function N(t,e,i,n,r){return{x:O(t),y:O(e),zoom:1/0,id:i,parentId:-1,numPoints:n,properties:r}}function F(t,e){const[i,n]=t.geometry.coordinates;return{x:O(G(i)),y:O($(n)),zoom:1/0,index:e,parentId:-1}}function V(t){return{type:"Feature",id:t.id,properties:U(t),geometry:{type:"Point",coordinates:[(e=t.x,360*(e-.5)),W(t.y)]}};var e}function U(t){const e=t.numPoints,i=e>=1e4?`${Math.round(e/1e3)}k`:e>=1e3?Math.round(e/100)/10+"k":e;return H(H({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:i})}function G(t){return t/360+.5}function $(t){const e=Math.sin(t*Math.PI/180),i=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return i<0?0:i>1?1:i}function W(t){const e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function H(t,e){for(const i in e)t[i]=e[i];return t}function j(t){return t.x}function Z(t){return t.y}function q(t,e,i,n){for(var r,o=n,a=i-e>>1,s=i-e,l=t[e],u=t[e+1],c=t[i],h=t[i+1],p=e+3;p<i;p+=3){var d=X(t[p],t[p+1],l,u,c,h);if(d>o)r=p,o=d;else if(d===o){var f=Math.abs(p-a);f<s&&(r=p,s=f)}}o>n&&(r-e>3&&q(t,e,r,n),t[r+2]=o,i-r>3&&q(t,r,i,n))}function X(t,e,i,n,r,o){var a=r-i,s=o-n;if(0!==a||0!==s){var l=((t-i)*a+(e-n)*s)/(a*a+s*s);l>1?(i=r,n=o):l>0&&(i+=a*l,n+=s*l)}return(a=t-i)*a+(s=e-n)*s}function Y(t,e,i,n){var r={id:void 0===t?null:t,type:e,geometry:i,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,i=t.type;if("Point"===i||"MultiPoint"===i||"LineString"===i)K(t,e);else if("Polygon"===i||"MultiLineString"===i)for(var n=0;n<e.length;n++)K(t,e[n]);else if("MultiPolygon"===i)for(n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)K(t,e[n][r])}(r),r}function K(t,e){for(var i=0;i<e.length;i+=3)t.minX=Math.min(t.minX,e[i]),t.minY=Math.min(t.minY,e[i+1]),t.maxX=Math.max(t.maxX,e[i]),t.maxY=Math.max(t.maxY,e[i+1])}function J(t,e,i,n){if(e.geometry){var r=e.geometry.coordinates,o=e.geometry.type,a=Math.pow(i.tolerance/((1<<i.maxZoom)*i.extent),2),s=[],l=e.id;if(i.promoteId?l=e.properties[i.promoteId]:i.generateId&&(l=n||0),"Point"===o)Q(r,s);else if("MultiPoint"===o)for(var u=0;u<r.length;u++)Q(r[u],s);else if("LineString"===o)tt(r,s,a,!1);else if("MultiLineString"===o){if(i.lineMetrics){for(u=0;u<r.length;u++)tt(r[u],s=[],a,!1),t.push(Y(l,"LineString",s,e.properties));return}et(r,s,a,!1)}else if("Polygon"===o)et(r,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(u=0;u<e.geometry.geometries.length;u++)J(t,{id:l,geometry:e.geometry.geometries[u],properties:e.properties},i,n);return}throw Error("Input data is not a valid GeoJSON object.")}for(u=0;u<r.length;u++){var c=[];et(r[u],c,a,!0),s.push(c)}}t.push(Y(l,o,s,e.properties))}}function Q(t,e){e.push(it(t[0])),e.push(nt(t[1])),e.push(0)}function tt(t,e,i,n){for(var r,o,a=0,s=0;s<t.length;s++){var l=it(t[s][0]),u=nt(t[s][1]);e.push(l),e.push(u),e.push(0),s>0&&(a+=n?(r*u-l*o)/2:Math.sqrt(Math.pow(l-r,2)+Math.pow(u-o,2))),r=l,o=u}var c=e.length-3;e[2]=1,q(e,0,c,i),e[c+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function et(t,e,i,n){for(var r=0;r<t.length;r++){var o=[];tt(t[r],o,i,n),e.push(o)}}function it(t){return t/360+.5}function nt(t){var e=Math.sin(t*Math.PI/180),i=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return i<0?0:i>1?1:i}function rt(t,e,i,n,r,o,a,s){if(n/=e,o>=(i/=e)&&a<n)return t;if(a<i||o>=n)return null;for(var l=[],u=0;u<t.length;u++){var c=t[u],h=c.geometry,p=c.type,d=0===r?c.minX:c.minY,f=0===r?c.maxX:c.maxY;if(d>=i&&f<n)l.push(c);else if(!(f<i||d>=n)){var m=[];if("Point"===p||"MultiPoint"===p)ot(h,m,i,n,r);else if("LineString"===p)at(h,m,i,n,r,!1,s.lineMetrics);else if("MultiLineString"===p)lt(h,m,i,n,r,!1);else if("Polygon"===p)lt(h,m,i,n,r,!0);else if("MultiPolygon"===p)for(var g=0;g<h.length;g++){var y=[];lt(h[g],y,i,n,r,!0),y.length&&m.push(y)}if(m.length){if(s.lineMetrics&&"LineString"===p){for(g=0;g<m.length;g++)l.push(Y(c.id,p,m[g],c.tags));continue}"LineString"!==p&&"MultiLineString"!==p||(1===m.length?(p="LineString",m=m[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===m.length?"Point":"MultiPoint"),l.push(Y(c.id,p,m,c.tags))}}}return l.length?l:null}function ot(t,e,i,n,r){for(var o=0;o<t.length;o+=3){var a=t[o+r];a>=i&&a<=n&&(e.push(t[o]),e.push(t[o+1]),e.push(t[o+2]))}}function at(t,e,i,n,r,o,a){for(var s,l,u=st(t),c=0===r?ct:ht,h=t.start,p=0;p<t.length-3;p+=3){var d=t[p],f=t[p+1],m=t[p+2],g=t[p+3],y=t[p+4],v=0===r?d:f,_=0===r?g:y,x=!1;a&&(s=Math.sqrt(Math.pow(d-g,2)+Math.pow(f-y,2))),v<i?_>i&&(l=c(u,d,f,g,y,i),a&&(u.start=h+s*l)):v>n?_<n&&(l=c(u,d,f,g,y,n),a&&(u.start=h+s*l)):ut(u,d,f,m),_<i&&v>=i&&(l=c(u,d,f,g,y,i),x=!0),_>n&&v<=n&&(l=c(u,d,f,g,y,n),x=!0),!o&&x&&(a&&(u.end=h+s*l),e.push(u),u=st(t)),a&&(h+=s)}var b=t.length-3;d=t[b],f=t[b+1],m=t[b+2],(v=0===r?d:f)>=i&&v<=n&&ut(u,d,f,m),b=u.length-3,o&&b>=3&&(u[b]!==u[0]||u[b+1]!==u[1])&&ut(u,u[0],u[1],u[2]),u.length&&e.push(u)}function st(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function lt(t,e,i,n,r,o){for(var a=0;a<t.length;a++)at(t[a],e,i,n,r,o,!1)}function ut(t,e,i,n){t.push(e),t.push(i),t.push(n)}function ct(t,e,i,n,r,o){var a=(o-e)/(n-e);return t.push(o),t.push(i+(r-i)*a),t.push(1),a}function ht(t,e,i,n,r,o){var a=(o-i)/(r-i);return t.push(e+(n-e)*a),t.push(o),t.push(1),a}function pt(t,e){for(var i=[],n=0;n<t.length;n++){var r,o=t[n],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)r=dt(o.geometry,e);else if("MultiLineString"===a||"Polygon"===a){r=[];for(var s=0;s<o.geometry.length;s++)r.push(dt(o.geometry[s],e))}else if("MultiPolygon"===a)for(r=[],s=0;s<o.geometry.length;s++){for(var l=[],u=0;u<o.geometry[s].length;u++)l.push(dt(o.geometry[s][u],e));r.push(l)}i.push(Y(o.id,a,r,o.tags))}return i}function dt(t,e){var i=[];i.size=t.size,void 0!==t.start&&(i.start=t.start,i.end=t.end);for(var n=0;n<t.length;n+=3)i.push(t[n]+e,t[n+1],t[n+2]);return i}function ft(t,e){if(t.transformed)return t;var i,n,r,o=1<<t.z,a=t.x,s=t.y;for(i=0;i<t.features.length;i++){var l=t.features[i],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(n=0;n<u.length;n+=2)l.geometry.push(mt(u[n],u[n+1],e,o,a,s));else for(n=0;n<u.length;n++){var h=[];for(r=0;r<u[n].length;r+=2)h.push(mt(u[n][r],u[n][r+1],e,o,a,s));l.geometry.push(h)}}return t.transformed=!0,t}function mt(t,e,i,n,r,o){return[Math.round(i*(t*n-r)),Math.round(i*(e*n-o))]}function gt(t,e,i,n,r){for(var o=e===r.maxZoom?0:r.tolerance/((1<<e)*r.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:n,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,yt(a,t[s],o,r);var l=t[s].minX,u=t[s].minY,c=t[s].maxX,h=t[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),h>a.maxY&&(a.maxY=h)}return a}function yt(t,e,i,n){var r=e.geometry,o=e.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<r.length;s+=3)a.push(r[s]),a.push(r[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===o)vt(a,r,t,i,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<r.length;s++)vt(a,r[s],t,i,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var l=0;l<r.length;l++){var u=r[l];for(s=0;s<u.length;s++)vt(a,u[s],t,i,!0,0===s)}if(a.length){var c=e.tags||null;if("LineString"===o&&n.lineMetrics){for(var h in c={},e.tags)c[h]=e.tags[h];c.mapbox_clip_start=r.start/r.size,c.mapbox_clip_end=r.end/r.size}var p={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:c};null!==e.id&&(p.id=e.id),t.features.push(p)}}function vt(t,e,i,n,r,o){var a=n*n;if(n>0&&e.size<(r?a:n))i.numPoints+=e.length/3;else{for(var s=[],l=0;l<e.length;l+=3)(0===n||e[l+2]>a)&&(i.numSimplified++,s.push(e[l]),s.push(e[l+1])),i.numPoints++;r&&function(t,e){for(var i=0,n=0,r=t.length,o=r-2;n<r;o=n,n+=2)i+=(t[n]-t[o])*(t[n+1]+t[o+1]);if(i>0===e)for(n=0,r=t.length;n<r/2;n+=2){var a=t[n],s=t[n+1];t[n]=t[r-2-n],t[n+1]=t[r-1-n],t[r-2-n]=a,t[r-1-n]=s}}(s,o),t.push(s)}}function _t(t,e){var i=(e=this.options=function(t,e){for(var i in e)t[i]=e[i];return t}(Object.create(this.options),e)).debug;if(i&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw Error("promoteId and generateId cannot be used together.");var n=function(t,e){var i=[];if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)J(i,t.features[n],e,n);else J(i,"Feature"===t.type?t:{geometry:t},e);return i}(t,e);this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=function(t,e){var i=e.buffer/e.extent,n=t,r=rt(t,1,-1-i,i,0,-1,2,e),o=rt(t,1,1-i,2+i,0,-1,2,e);return(r||o)&&(n=rt(t,1,-i,1+i,0,-1,2,e)||[],r&&(n=pt(r,1).concat(n)),o&&(n=n.concat(pt(o,-1)))),n}(n,e)).length&&this.splitTile(n,0,0,0),i&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function xt(t,e,i){return 32*((1<<t)*i+e)+t}function bt(t,e){const i=t.tileID.canonical;if(!this._geoJSONIndex)return e(null,null);const n=this._geoJSONIndex.getTile(i.z,i.x,i.y);if(!n)return e(null,null);const r=new h(n.features);let o=g(r);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),e(null,{vectorTile:r,rawData:o.buffer})}_t.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},_t.prototype.splitTile=function(t,e,i,n,r,o,a){for(var s=[t,e,i,n],l=this.options,u=l.debug;s.length;){n=s.pop(),i=s.pop(),e=s.pop(),t=s.pop();var c=1<<e,h=xt(e,i,n),p=this.tiles[h];if(!p&&(u>1&&console.time("creation"),p=this.tiles[h]=gt(t,e,i,n,l),this.tileCoords.push({z:e,x:i,y:n}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,i,n,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var d="z"+e;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(p.source=t,r){if(e===l.maxZoom||e===r)continue;var f=1<<r-e;if(i!==Math.floor(o/f)||n!==Math.floor(a/f))continue}else if(e===l.indexMaxZoom||p.numPoints<=l.indexMaxPoints)continue;if(p.source=null,0!==t.length){u>1&&console.time("clipping");var m,g,y,v,_,x,b=.5*l.buffer/l.extent,w=.5-b,S=.5+b,T=1+b;m=g=y=v=null,_=rt(t,c,i-b,i+S,0,p.minX,p.maxX,l),x=rt(t,c,i+w,i+T,0,p.minX,p.maxX,l),t=null,_&&(m=rt(_,c,n-b,n+S,1,p.minY,p.maxY,l),g=rt(_,c,n+w,n+T,1,p.minY,p.maxY,l),_=null),x&&(y=rt(x,c,n-b,n+S,1,p.minY,p.maxY,l),v=rt(x,c,n+w,n+T,1,p.minY,p.maxY,l),x=null),u>1&&console.timeEnd("clipping"),s.push(m||[],e+1,2*i,2*n),s.push(g||[],e+1,2*i,2*n+1),s.push(y||[],e+1,2*i+1,2*n),s.push(v||[],e+1,2*i+1,2*n+1)}}},_t.prototype.getTile=function(t,e,i){var n=this.options,r=n.extent,o=n.debug;if(t<0||t>24)return null;var a=1<<t,s=xt(t,e=(e%a+a)%a,i);if(this.tiles[s])return ft(this.tiles[s],r);o>1&&console.log("drilling down to z%d-%d-%d",t,e,i);for(var l,u=t,c=e,h=i;!l&&u>0;)u--,c=Math.floor(c/2),h=Math.floor(h/2),l=this.tiles[xt(u,c,h)];return l&&l.source?(o>1&&console.log("found parent tile z%d-%d-%d",u,c,h),o>1&&console.time("drilling down"),this.splitTile(l.source,u,c,h,t,e,i),o>1&&console.timeEnd("drilling down"),this.tiles[s]?ft(this.tiles[s],r):null):null};class wt extends t.VectorTileWorkerSource{constructor(t,e,i,n,r){super(t,e,i,n,bt),r&&(this.loadGeoJSON=r)}loadData(e,i){const n=e&&e.request,r=n&&n.collectResourceTiming;this.loadGeoJSON(e,(o,s)=>{if(o||!s)return i(o);if("object"!=typeof s)return i(Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`));{a(s,!0);try{if(e.filter){const i=t.createExpression(e.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===i.result)throw Error(i.value.map(t=>`${t.key}: ${t.message}`).join(", "));const n=s.features.filter(t=>i.value.evaluate({zoom:0},t));s={type:"FeatureCollection",features:n}}this._geoJSONIndex=e.cluster?new B(function({superclusterOptions:e,clusterProperties:i}){if(!i||!e)return e;const n={},r={},o={accumulated:null,zoom:0},a={properties:null},s=Object.keys(i);for(const e of s){const[o,a]=i[e],s=t.createExpression(a),l=t.createExpression("string"==typeof o?[o,["accumulated"],["get",e]]:o);n[e]=s.value,r[e]=l.value}return e.map=(t=>{a.properties=t;const e={};for(const t of s)e[t]=n[t].evaluate(o,a);return e}),e.reduce=((t,e)=>{a.properties=e;for(const e of s)o.accumulated=t[e],t[e]=r[e].evaluate(o,a)}),e}(e)).load(s.features):function(t,e){return new _t(t,e)}(s,e.geojsonVtOptions)}catch(o){return i(o)}this.loaded={};const l={};if(r){const i=t.getPerformanceMeasurement(n);i&&(l.resourceTiming={},l.resourceTiming[e.source]=JSON.parse(JSON.stringify(i)))}i(null,l)}})}reloadTile(t,e){const i=this.loaded;return i&&i[t.uid]?super.reloadTile(t,e):this.loadTile(t,e)}loadGeoJSON(e,i){if(e.request)t.getJSON(e.request,i);else{if("string"!=typeof e.data)return i(Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`));try{return i(null,JSON.parse(e.data))}catch(t){return i(Error(`Input data given to '${e.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(t,e){try{e(null,this._geoJSONIndex.getClusterExpansionZoom(t.clusterId))}catch(t){e(t)}}getClusterChildren(t,e){try{e(null,this._geoJSONIndex.getChildren(t.clusterId))}catch(t){e(t)}}getClusterLeaves(t,e){try{e(null,this._geoJSONIndex.getLeaves(t.clusterId,t.limit,t.offset))}catch(t){e(t)}}}class St{constructor(e){this.self=e,this.actor=new t.Actor(e,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded=!1,this.workerSourceTypes={vector:t.VectorTileWorkerSource,geojson:wt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=((t,e)=>{if(this.workerSourceTypes[t])throw Error(`Worker source with name "${t}" already registered.`);this.workerSourceTypes[t]=e}),this.self.registerRTLTextPlugin=(e=>{if(t.plugin.isParsed())throw Error("RTL text plugin already registered.");t.plugin.applyArabicShaping=e.applyArabicShaping,t.plugin.processBidirectionalText=e.processBidirectionalText,t.plugin.processStyledBidirectionalText=e.processStyledBidirectionalText})}checkIfReady(t,e,i){i()}setReferrer(t,e){this.referrer=e}spriteLoaded(e,i){this.isSpriteLoaded=i;for(const n in this.workerSources[e]){const r=this.workerSources[e][n];for(const e in r)r[e]instanceof t.VectorTileWorkerSource&&(r[e].isSpriteLoaded=i,r[e].fire(new t.Event("isSpriteLoaded")))}}setImages(t,e,i){this.availableImages[t]=e;for(const i in this.workerSources[t]){const n=this.workerSources[t][i];for(const t in n)n[t].availableImages=e}i()}enableTerrain(t,e,i){this.terrain=e,i()}setLayers(t,e,i){this.getLayerIndex(t).replace(e),i()}updateLayers(t,e,i){this.getLayerIndex(t).update(e.layers,e.removedIds),i()}loadTile(e,i,n){const r=this.enableTerrain?t.extend({enableTerrain:this.terrain},i):i;this.getWorkerSource(e,i.type,i.source).loadTile(r,n)}loadDEMTile(e,i,n){const r=this.enableTerrain?t.extend({buildQuadTree:this.terrain},i):i;this.getDEMWorkerSource(e,i.source).loadTile(r,n)}reloadTile(e,i,n){const r=this.enableTerrain?t.extend({enableTerrain:this.terrain},i):i;this.getWorkerSource(e,i.type,i.source).reloadTile(r,n)}abortTile(t,e,i){this.getWorkerSource(t,e.type,e.source).abortTile(e,i)}removeTile(t,e,i){this.getWorkerSource(t,e.type,e.source).removeTile(e,i)}removeSource(t,e,i){if(!this.workerSources[t]||!this.workerSources[t][e.type]||!this.workerSources[t][e.type][e.source])return;const n=this.workerSources[t][e.type][e.source];delete this.workerSources[t][e.type][e.source],void 0!==n.removeSource?n.removeSource(e,i):i()}loadWorkerSource(t,e,i){try{this.self.importScripts(e.url),i()}catch(t){i(t.toString())}}syncRTLPluginState(e,i,n){try{t.plugin.setState(i);const e=t.plugin.getPluginURL();if(t.plugin.isLoaded()&&!t.plugin.isParsed()&&null!=e){this.self.importScripts(e);const i=t.plugin.isParsed();n(i?void 0:Error(`RTL Text Plugin failed to import scripts from ${e}`),i)}}catch(t){n(t.toString())}}getAvailableImages(t){let e=this.availableImages[t];return e||(e=[]),e}getLayerIndex(t){let e=this.layerIndexes[t];return e||(e=this.layerIndexes[t]=new n),e}getWorkerSource(t,e,i){return this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][e]||(this.workerSources[t][e]={}),this.workerSources[t][e][i]||(this.workerSources[t][e][i]=new this.workerSourceTypes[e]({send:(e,i,n,r,o,a)=>{this.actor.send(e,i,n,t,o,a)},scheduler:this.actor.scheduler},this.getLayerIndex(t),this.getAvailableImages(t),this.isSpriteLoaded)),this.workerSources[t][e][i]}getDEMWorkerSource(t,e){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][e]||(this.demWorkerSources[t][e]=new o),this.demWorkerSources[t][e]}enforceCacheSizeLimit(e,i){t.enforceCacheSizeLimit(i)}getWorkerPerformanceMetrics(t,e,i){i(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new St(self)),St}),r(["./shared"],function(t){var e=i;function i(t){return!function(t){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var t,e,i=new Blob([""],{type:"text/javascript"}),n=URL.createObjectURL(i);try{e=new Worker(n),t=!0}catch(e){t=!1}return e&&e.terminate(),URL.revokeObjectURL(n),t}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var t=document.createElement("canvas");t.width=t.height=1;var e=t.getContext("2d");if(!e)return!1;var i=e.getImageData(0,0,1,1);return i&&i.width===t.width}()?(void 0===n[e=t&&t.failIfMajorPerformanceCaveat]&&(n[e]=function(t){var e,n=function(t){var e=document.createElement("canvas"),n=Object.create(i.webGLContextAttributes);return n.failIfMajorPerformanceCaveat=t,e.getContext("webgl",n)||e.getContext("experimental-webgl",n)}(t);if(!n)return!1;try{e=n.createShader(n.VERTEX_SHADER)}catch(t){return!1}return!(!e||n.isContextLost())&&(n.shaderSource(e,"void main() {}"),n.compileShader(e),!0===n.getShaderParameter(e,n.COMPILE_STATUS))}(e)),n[e]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var e}(t)}var n={};function r(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!r(t[i],e[i]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==e){if("object"!=typeof e)return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const i in t)if(!r(t[i],e[i]))return!1;return!0}return t===e}i.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const o={create:function(e,i,n){const r=t.window.document.createElement(e);return void 0!==i&&(r.className=i),n&&n.appendChild(r),r},createNS:function(e,i){return t.window.document.createElementNS(e,i)}},a=t.window.document&&t.window.document.documentElement.style,s=a&&void 0!==a.userSelect?"userSelect":"WebkitUserSelect";let l;o.disableDrag=function(){a&&s&&(l=a[s],a[s]="none")},o.enableDrag=function(){a&&s&&(a[s]=l)},o.setTransform=function(t,e){t.style.transform=e};let u=!1;try{const e=Object.defineProperty({},"passive",{get(){u=!0}});t.window.addEventListener("test",e,e),t.window.removeEventListener("test",e,e)}catch(t){u=!1}o.addEventListener=function(t,e,i,n={}){t.addEventListener(e,i,"passive"in n&&u?n:n.capture)},o.removeEventListener=function(t,e,i,n={}){t.removeEventListener(e,i,"passive"in n&&u?n:n.capture)};const c=function(e){e.preventDefault(),e.stopPropagation(),t.window.removeEventListener("click",c,!0)};function h(e,i,n){const r=e.offsetWidth===i.width?1:e.offsetWidth/i.width;return new t.pointGeometry((n.clientX-i.left)*r,(n.clientY-i.top)*r)}o.suppressClick=function(){t.window.addEventListener("click",c,!0),t.window.setTimeout(()=>{t.window.removeEventListener("click",c,!0)},0)},o.mousePos=function(t,e){const i=t.getBoundingClientRect();return h(t,i,e)},o.touchPos=function(t,e){const i=t.getBoundingClientRect(),n=[];for(let r=0;r<e.length;r++)n.push(h(t,i,e[r]));return n},o.mouseButton=function(e){return void 0!==t.window.InstallTrigger&&2===e.button&&e.ctrlKey&&t.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button},o.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)};class p{constructor(t,e){this.pos=t,this.dir=e}intersectsPlane(e,i,n){const r=t.dot(i,this.dir);if(Math.abs(r)<1e-6)return!1;const o=t.dot(t.sub(t.create(),e,this.pos),i)/r,a=t.scaleAndAdd(t.create(),this.pos,this.dir,o);return t.copy(n,a),!0}}class d{constructor(t,e){this.points=t,this.planes=e}static fromInvProjectionMatrix(e,i,n){const r=Math.pow(2,n),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(n=>{const o=t.transformMat4([],n,e),a=1/o[3]/i*r;return t.mul(o,o,[a,a,1/o[3],a])}),a=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(e=>{const i=t.sub([],o[e[0]],o[e[1]]),n=t.sub([],o[e[2]],o[e[1]]),r=t.normalize([],t.cross([],i,n)),a=-t.dot(r,o[e[1]]);return r.concat(a)});return new d(o,a)}}class f{constructor(e,i){this.min=e,this.max=i,this.center=t.scale([],t.add([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],n=t.clone(this.min),r=t.clone(this.max);for(let t=0;t<i.length;t++)n[t]=i[t]?this.min[t]:this.center[t],r[t]=i[t]?this.center[t]:this.max[t];return r[2]=this.max[2],new f(n,r)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}intersects(e){const i=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let n=!0;for(let r=0;r<e.planes.length;r++){const o=e.planes[r];let a=0;for(let e=0;e<i.length;e++)a+=t.dot$1(o,i[e])>=0;if(0===a)return 0;a!==i.length&&(n=!1)}if(n)return 2;for(let t=0;t<3;t++){let i=Number.MAX_VALUE,n=-Number.MAX_VALUE;for(let r=0;r<e.points.length;r++){const o=e.points[r][t]-this.min[t];i=Math.min(i,o),n=Math.max(n,o)}if(n<0||i>this.max[t]-this.min[t])return 0}return 1}}function m(t){const{userImage:e}=t;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class g extends t.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:t,callback:e}of this.requestors)this._notify(t,e);this.requestors=[]}}getImage(t){return this.images[t]}addImage(t,e){this._validate(t,e)&&(this.images[t]=e)}_validate(e,i){let n=!0;return this._validateStretch(i.stretchX,i.data&&i.data.width)||(this.fire(new t.ErrorEvent(Error(`Image "${e}" has invalid "stretchX" value`))),n=!1),this._validateStretch(i.stretchY,i.data&&i.data.height)||(this.fire(new t.ErrorEvent(Error(`Image "${e}" has invalid "stretchY" value`))),n=!1),this._validateContent(i.content,i)||(this.fire(new t.ErrorEvent(Error(`Image "${e}" has invalid "content" value`))),n=!1),n}_validateStretch(t,e){if(!t)return!0;let i=0;for(const n of t){if(n[0]<i||n[1]<n[0]||e<n[1])return!1;i=n[1]}return!0}_validateContent(t,e){return!(t&&(4!==t.length||t[0]<0||e.data.width<t[0]||t[1]<0||e.data.height<t[1]||t[2]<0||e.data.width<t[2]||t[3]<0||e.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,e){e.version=this.images[t].version+1,this.images[t]=e,this.updatedImages[t]=!0}removeImage(t){const e=this.images[t];delete this.images[t],delete this.patterns[t],e.userImage&&e.userImage.onRemove&&e.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,e){let i=!0;if(!this.isLoaded())for(const e of t)this.images[e]||(i=!1);this.isLoaded()||i?this._notify(t,e):this.requestors.push({ids:t,callback:e})}_notify(e,i){const n={};for(const i of e){this.images[i]||this.fire(new t.Event("styleimagemissing",{id:i}));const e=this.images[i];e?n[i]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,hasRenderCallback:!(!e.userImage||!e.userImage.render)}:t.warnOnce(`Image "${i}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}i(null,n)}getPixelSize(){const{width:t,height:e}=this.atlasImage;return{width:t,height:e}}getPattern(e){const i=this.patterns[e],n=this.getImage(e);if(!n)return null;if(i&&i.position.version===n.version)return i.position;if(i)i.position.version=n.version;else{const i={w:n.data.width+2,h:n.data.height+2,x:0,y:0},r=new t.ImagePosition(i,n);this.patterns[e]={bin:i,position:r}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const i=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new t.Texture(e,this.atlasImage,i.RGBA),this.atlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const t in this.patterns)e.push(this.patterns[t].bin);const{w:i,h:n}=t.potpack(e),r=this.atlasImage;r.resize({width:i||1,height:n||1});for(const e in this.patterns){const{bin:i}=this.patterns[e],n=i.x+1,o=i.y+1,a=this.images[e].data,s=a.width,l=a.height;t.RGBAImage.copy(a,r,{x:0,y:0},{x:n,y:o},{width:s,height:l}),t.RGBAImage.copy(a,r,{x:0,y:l-1},{x:n,y:o-1},{width:s,height:1}),t.RGBAImage.copy(a,r,{x:0,y:0},{x:n,y:o+l},{width:s,height:1}),t.RGBAImage.copy(a,r,{x:s-1,y:0},{x:n-1,y:o},{width:1,height:l}),t.RGBAImage.copy(a,r,{x:0,y:0},{x:n+s,y:o},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const e of t){if(this.callbackDispatchedThisFrame[e])continue;this.callbackDispatchedThisFrame[e]=!0;const t=this.images[e];m(t)&&this.updateImage(e,t)}}}const y=new t.Properties({anchor:new t.DataConstantProperty(t.spec.light.anchor),position:new class{constructor(){this.specification=t.spec.light.position}possiblyEvaluate(e,i){return function([e,i,n]){const r=t.degToRad(i+90),o=t.degToRad(n);return{x:e*Math.cos(r)*Math.sin(o),y:e*Math.sin(r)*Math.sin(o),z:e*Math.cos(o),azimuthal:i,polar:n}}(e.expression.evaluate(i))}interpolate(e,i,n){return{x:t.number(e.x,i.x,n),y:t.number(e.y,i.y,n),z:t.number(e.z,i.z,n),azimuthal:t.number(e.azimuthal,i.azimuthal,n),polar:t.number(e.polar,i.polar,n)}}},color:new t.DataConstantProperty(t.spec.light.color),intensity:new t.DataConstantProperty(t.spec.light.intensity)}),v="-transition";class _ extends t.Evented{constructor(e){super(),this._transitionable=new t.Transitionable(y),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,i={}){if(!this._validate(t.validateLight,e,i))for(const i in e){const n=e[i];t.endsWith(i,v)?this._transitionable.setTransition(i.slice(0,-v.length),n):this._transitionable.setValue(i,n)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(e,i,n){return(!n||!1!==n.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:i,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}const x=new t.Properties({source:new t.DataConstantProperty(t.spec.terrain.source),exaggeration:new t.DataConstantProperty(t.spec.terrain.exaggeration)}),b="-transition";class w extends t.Evented{constructor(e){super(),this._transitionable=new t.Transitionable(x),this.set(e),this._transitioning=this._transitionable.untransitioned()}get(){return this._transitionable.serialize()}set(e){for(const i in e){const n=e[i];t.endsWith(i,b)?this._transitionable.setTransition(i.slice(0,-b.length),n):this._transitionable.setValue(i,n)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}}function S(e,i,n,r){const o=t.smoothstep(45,65,n),[a,s]=T(e,r),l=t.length(i);let u=1-Math.min(1,Math.exp((l-a)/(s-a)*-6));return(u=Math.min(1,1.00747*(u*=u*u)))*o*e.alpha}function T(t,e){const i=.5/Math.tan(.5*e);return[t.range[0]+i,t.range[1]+i]}const M=new t.Properties({range:new t.DataConstantProperty(t.spec.fog.range),color:new t.DataConstantProperty(t.spec.fog.color),"horizon-blend":new t.DataConstantProperty(t.spec.fog["horizon-blend"])}),I="-transition";class C extends t.Evented{constructor(e){super(),this._transitionable=new t.Transitionable(M),this.set(e),this._transitioning=this._transitionable.untransitioned()}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(e){if(!this._validate(t.validateFog,e))for(const i in e){const n=e[i];t.endsWith(i,I)?this._transitionable.setTransition(i.slice(0,-I.length),n):this._transitionable.setValue(i,n)}}getOpacity(e){const i=this.properties&&this.properties.get("color")||1;return t.smoothstep(45,65,e)*i.a}getOpacityAtLatLng(e,i){return function(e,i,n){const r=t.MercatorCoordinate.fromLngLat(i),o=n.elevation?n.elevation.getAtPointOrZero(r):0,a=[r.x,r.y,o];return t.transformMat4$1(a,a,n.mercatorFogMatrix),S(e,a,n.pitch,n._fov)}(this.state,e,i)}getFovAdjustedRange(t){return T(this.state,t)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(e,i,n){return(!n||!1!==n.validate)&&t.emitValidationErrors(this,e.call(t.validateStyle,t.extend({value:i,style:{glyphs:!0,sprite:!0},styleSpec:t.spec})))}}class A{constructor(e,i){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=t.uniqueId();const n=this.workerPool.acquire(this.id);for(let t=0;t<n.length;t++){const e=new A.Actor(n[t],i,this.id);e.name=`Worker ${t}`,this.actors.push(e)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(e,i,n){t.asyncAll(this.actors,(t,n)=>{t.send(e,i,n)},n=n||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}function k(e,i,n){return i*(t.EXTENT/(e.tileSize*Math.pow(2,n-e.tileID.overscaledZ)))}A.Actor=t.Actor;class D{constructor(t,e,i,n){this.screenBounds=t,this.cameraPoint=e,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=i,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(t=>n.pointCoordinate3D(t)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(e,i){let n,r;if(e instanceof t.pointGeometry||"number"==typeof e[0]){const o=t.pointGeometry.convert(e);n=[t.pointGeometry.convert(e)],r=i.isPointAboveHorizon(o)}else{const o=t.pointGeometry.convert(e[0]),a=t.pointGeometry.convert(e[1]);n=[o,a],r=t.polygonizeBounds(o,a).every(t=>i.isPointAboveHorizon(t))}return new D(n,i.getCameraPoint(),r,i)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(e){return t.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],e)}bufferedCameraGeometry(e){const i=this.screenBounds[0],n=1===this.screenBounds.length?this.screenBounds[0].add(new t.pointGeometry(1,1)):this.screenBounds[1],r=t.polygonizeBounds(i,n,0,!1);return this.cameraPoint.y>n.y&&(this.cameraPoint.x>i.x&&this.cameraPoint.x<n.x?r.splice(3,0,this.cameraPoint):this.cameraPoint.x>=n.x?r[2]=this.cameraPoint:this.cameraPoint.x<=i.x&&(r[3]=this.cameraPoint)),t.bufferConvexPolygon(r,e)}containsTile(e,i,n){const r=e.queryPadding+1,o=n?this._bufferedCameraMercator(r,i).map(t=>e.tileID.getTilePoint(t)):this._bufferedScreenMercator(r,i).map(t=>e.tileID.getTilePoint(t)),a=this.screenGeometryMercator.map(t=>e.tileID.getTileVec3(t)),s=a.map(e=>new t.pointGeometry(e[0],e[1])),l=i.getFreeCameraOptions().position||new t.MercatorCoordinate(0,0,0),u=e.tileID.getTileVec3(l),c=a.map(e=>{const i=t.sub(e,e,u);return t.normalize(i,i),new p(u,i)}),h=k(e,1,i.zoom);if(t.polygonIntersectsBox(o,0,0,t.EXTENT,t.EXTENT))return{queryGeometry:this,tilespaceGeometry:s,tilespaceRays:c,bufferedTilespaceGeometry:o,bufferedTilespaceBounds:(d=t.getBounds(o),d.min.x=t.clamp(d.min.x,0,t.EXTENT),d.min.y=t.clamp(d.min.y,0,t.EXTENT),d.max.x=t.clamp(d.max.x,0,t.EXTENT),d.max.y=t.clamp(d.max.y,0,t.EXTENT),d),tile:e,tileID:e.tileID,pixelToTileUnitsFactor:h};var d}_bufferedScreenMercator(t,e){const i=E(t);if(this._screenRaycastCache[i])return this._screenRaycastCache[i];{const n=this.bufferedScreenGeometry(t).map(t=>e.pointCoordinate3D(t));return this._screenRaycastCache[i]=n,n}}_bufferedCameraMercator(t,e){const i=E(t);if(this._cameraRaycastCache[i])return this._cameraRaycastCache[i];{const n=this.bufferedCameraGeometry(t).map(t=>e.pointCoordinate3D(t));return this._cameraRaycastCache[i]=n,n}}}function E(t){return 100*t|0}function P(e,i,n){const r=function(r,o){if(r)return n(r);if(o){const r=t.pick(t.extend(o,e),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);o.vector_layers&&(r.vectorLayers=o.vector_layers,r.vectorLayerIds=r.vectorLayers.map(t=>t.id)),r.tiles=i.canonicalizeTileset(r,e.url),n(null,r)}};return e.url?t.getJSON(i.transformRequest(i.normalizeSourceURL(e.url),t.ResourceType.Source),r):t.exported.frame(()=>r(null,e))}class L{constructor(e,i,n){this.bounds=t.LngLatBounds.convert(this.validateBounds(e)),this.minzoom=i||0,this.maxzoom=n||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(e){const i=Math.pow(2,e.z),n=Math.floor(t.mercatorXfromLng(this.bounds.getWest())*i),r=Math.floor(t.mercatorYfromLat(this.bounds.getNorth())*i),o=Math.ceil(t.mercatorXfromLng(this.bounds.getEast())*i),a=Math.ceil(t.mercatorYfromLat(this.bounds.getSouth())*i);return e.x>=n&&e.x<o&&e.y>=r&&e.y<a}}class z{constructor(t,e,i){this.context=t;const n=t.gl;this.buffer=n.createBuffer(),this.dynamicDraw=!!i,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;this.context.unbindVAO(),this.bind(),e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const O={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class R{constructor(t,e,i,n){this.length=e.length,this.attributes=i,this.itemSize=e.bytesPerElement,this.dynamicDraw=n,this.context=t;const r=t.gl;this.buffer=r.createBuffer(),t.bindVertexBuffer.set(this.buffer),r.bufferData(r.ARRAY_BUFFER,e.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete e.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const e=this.context.gl;this.bind(),e.bufferSubData(e.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,e){for(let i=0;i<this.attributes.length;i++){const n=e.attributes[this.attributes[i].name];void 0!==n&&t.enableVertexAttribArray(n)}}setVertexAttribPointers(t,e,i){for(let n=0;n<this.attributes.length;n++){const r=this.attributes[n],o=e.attributes[r.name];void 0!==o&&t.vertexAttribPointer(o,r.components,t[O[r.type]],!1,this.itemSize,r.offset+this.itemSize*(i||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class B{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class N extends B{getDefault(){return t.Color.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class F extends B{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class V extends B{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class U extends B{getDefault(){return[!0,!0,!0,!0]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class G extends B{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class $ extends B{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class W extends B{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const e=this.current;(t.func!==e.func||t.ref!==e.ref||t.mask!==e.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class H extends B{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class j extends B{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.current=t,this.dirty=!1}}class Z extends B{getDefault(){return[0,1]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class q extends B{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.current=t,this.dirty=!1}}class X extends B{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Y extends B{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.BLEND):e.disable(e.BLEND),this.current=t,this.dirty=!1}}class K extends B{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class J extends B{getDefault(){return t.Color.transparent}set(t){const e=this.current;(t.r!==e.r||t.g!==e.g||t.b!==e.b||t.a!==e.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Q extends B{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class tt extends B{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this.current=t,this.dirty=!1}}class et extends B{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class it extends B{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class nt extends B{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class rt extends B{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class ot extends B{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const e=this.current;(t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[3]!==e[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class at extends B{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class st extends B{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindRenderbuffer(e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class lt extends B{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindTexture(e.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class ut extends B{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.bindBuffer(e.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ct extends B{getDefault(){return null}set(t){const e=this.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class ht extends B{constructor(t){super(t),this.vao=t.extVertexArrayObject}getDefault(){return null}set(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)}}class pt extends B{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class dt extends B{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class ft extends B{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const e=this.gl;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class mt extends B{constructor(t,e){super(t),this.context=t,this.parent=e}getDefault(){return null}}class gt extends mt{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class yt extends mt{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const e=this.gl;e.framebufferRenderbuffer(e.FRAMEBUFFER,this.attachment(),e.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class vt extends yt{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class _t{constructor(t,e,i,n){this.context=t,this.width=e,this.height=i;const r=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new gt(t,r),n&&(this.depthAttachment=new yt(t,r))}destroy(){const t=this.context.gl,e=this.colorAttachment.get();if(e&&t.deleteTexture(e),this.depthAttachment){const e=this.depthAttachment.get();e&&t.deleteRenderbuffer(e)}t.deleteFramebuffer(this.framebuffer)}}class xt{constructor(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new N(this),this.clearDepth=new F(this),this.clearStencil=new V(this),this.colorMask=new U(this),this.depthMask=new G(this),this.stencilMask=new $(this),this.stencilFunc=new W(this),this.stencilOp=new H(this),this.stencilTest=new j(this),this.depthRange=new Z(this),this.depthTest=new q(this),this.depthFunc=new X(this),this.blend=new Y(this),this.blendFunc=new K(this),this.blendColor=new J(this),this.blendEquation=new Q(this),this.cullFace=new tt(this),this.cullFaceSide=new et(this),this.frontFace=new it(this),this.program=new nt(this),this.activeTexture=new rt(this),this.viewport=new ot(this),this.bindFramebuffer=new at(this),this.bindRenderbuffer=new st(this),this.bindTexture=new lt(this),this.bindVertexBuffer=new ut(this),this.bindElementBuffer=new ct(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ht(this),this.pixelStoreUnpack=new pt(this),this.pixelStoreUnpackPremultiplyAlpha=new dt(this),this.pixelStoreUnpackFlipY=new ft(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,e){return new z(this,t,e)}createVertexBuffer(t,e,i){return new R(this,t,e,i)}createRenderbuffer(t,e,i){const n=this.gl,r=n.createRenderbuffer();return this.bindRenderbuffer.set(r),n.renderbufferStorage(n.RENDERBUFFER,t,e,i),this.bindRenderbuffer.set(null),r}createFramebuffer(t,e,i){return new _t(this,t,e,i)}clear({color:t,depth:e,stencil:i}){const n=this.gl;let r=0;t&&(r|=n.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==e&&(r|=n.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(e),this.depthMask.set(!0)),void 0!==i&&(r|=n.STENCIL_BUFFER_BIT,this.clearStencil.set(i),this.stencilMask.set(255)),n.clear(r)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(e){r(e.blendFunction,t.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class bt extends t.Evented{constructor(e,i,n,r){super(),this.id=e,this.dispatcher=n,this.setEventedParent(r),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.extend({type:"raster"},i),t.extend(this,t.pick(i,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=P(this._options,this.map._requestManager,(e,i)=>{this._tileJSONRequest=null,this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):i&&(t.extend(this,i),i.bounds&&(this.tileBounds=new L(i.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(i.tiles),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return t.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(e,i){const n=t.exported.devicePixelRatio>=2,r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),n,this.tileSize);e.request=t.getImage(this.map._requestManager.transformRequest(r,t.ResourceType.Tile),(n,r,o,a)=>{if(delete e.request,e.aborted)e.state="unloaded",i(null);else if(n)e.state="errored",i(n);else if(r){this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:o,expires:a});const n=this.map.painter.context,s=n.gl;e.texture=this.map.painter.getTileTexture(r.width),e.texture?e.texture.update(r,{useMipmap:!0}):(e.texture=new t.Texture(n,r,s.RGBA,{useMipmap:!0}),e.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),n.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax)),e.state="loaded",t.cacheEntryPossiblyAdded(this.dispatcher),i(null)}})}abortTile(t,e){t.request&&(t.request.cancel(),delete t.request),e()}unloadTile(t,e){t.texture&&this.map.painter.saveTileTexture(t.texture),e()}hasTransition(){return!1}}let wt;var St=t.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Tt extends t.Evented{constructor(t,e,i,n){super(),this.id=t,this.dispatcher=i,this.coordinates=e.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(n),this.options=e}load(e,i){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this.url=this.options.url,t.getImage(this.map._requestManager.transformRequest(this.url,t.ResourceType.Image),(n,r)=>{this._loaded=!0,n?this.fire(new t.ErrorEvent(n)):r&&(this.image=r,e&&(this.coordinates=e),i&&i(),this._finishLoading())})}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this.options.url=t.url,this.load(t.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}setCoordinates(e){this.coordinates=e;const i=e.map(t.MercatorCoordinate.fromLngLat);this.tileID=function(e){let i=1/0,n=1/0,r=-1/0,o=-1/0;for(const t of e)i=Math.min(i,t.x),n=Math.min(n,t.y),r=Math.max(r,t.x),o=Math.max(o,t.y);const a=Math.max(r-i,o-n),s=Math.max(0,Math.floor(-Math.log(a)/Math.LN2)),l=Math.pow(2,s);return new t.CanonicalTileID(s,Math.floor((i+r)/2*l),Math.floor((n+o)/2*l))}(i),this.minzoom=this.maxzoom=this.tileID.z;const n=i.map(t=>this.tileID.getTilePoint(t)._round());return this._boundsArray=new t.StructArrayLayout4i8,this._boundsArray.emplaceBack(n[0].x,n[0].y,0,0),this._boundsArray.emplaceBack(n[1].x,n[1].y,t.EXTENT,0),this._boundsArray.emplaceBack(n[3].x,n[3].y,0,t.EXTENT),this._boundsArray.emplaceBack(n[2].x,n[2].y,t.EXTENT,t.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const e=this.map.painter.context,i=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,St.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new t.Texture(e,this.image,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}loadTile(t,e){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[t.tileID.wrap+""]=t,t.buckets={},e(null)):(t.state="errored",e(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Mt={vector:class extends t.Evented{constructor(e,i,n,r){if(super(),this.id=e,this.dispatcher=n,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.extend(this,t.pick(i,["url","scheme","tileSize","promoteId"])),this._options=t.extend({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,512!==this.tileSize)throw Error("vector tile sources must have a tileSize of 512");this.setEventedParent(r),this._tileWorkers={},this._deduped=new t.DedupedRequest}load(){this._loaded=!1,this.fire(new t.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=P(this._options,this.map._requestManager,(e,i)=>{this._tileJSONRequest=null,this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):i&&(t.extend(this,i),i.bounds&&(this.tileBounds=new L(i.bounds,this.minzoom,this.maxzoom)),t.postTurnstileEvent(i.tiles,this.map._requestManager._customAccessToken),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t();const e=this.map.style._getSourceCaches(this.id);for(const t of e)t.clearTiles();this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return t.extend({},this._options)}loadTile(e,i){const n=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),r={request:this.map._requestManager.transformRequest(n,t.ResourceType.Tile),data:void 0,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:e.isSymbolTile};if(r.request.collectResourceTiming=this._collectResourceTiming,e.actor&&"expired"!==e.state)"loading"===e.state?e.reloadCallback=i:e.request=e.actor.send("reloadTile",r,o.bind(this));else if(e.actor=this._tileWorkers[n]=this._tileWorkers[n]||this.dispatcher.getActor(),this.dispatcher.ready)e.request=e.actor.send("loadTile",r,o.bind(this),void 0,!0);else{const i=t.loadVectorTile.call({deduped:this._deduped},r,(t,i)=>{t||!i?o.call(this,t):(r.data={cacheControl:i.cacheControl,expires:i.expires,rawData:i.rawData.slice(0)},e.actor&&e.actor.send("loadTile",r,o.bind(this),void 0,!0))},!0);e.request={cancel:i}}function o(n,r){return delete e.request,e.aborted?i(null):n&&404!==n.status?i(n):(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),this.map._refreshExpiredTiles&&r&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),t.cacheEntryPossiblyAdded(this.dispatcher),i(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id})}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:bt,"raster-dem":class extends bt{constructor(e,i,n,r){super(e,i,n,r),this.type="raster-dem",this.maxzoom=22,this._options=t.extend({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}loadTile(e,i){const n=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function r(t,n){t&&(e.state="errored",i(t)),n&&(e.dem=n,e.dem.onDeserialize(),e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0,e.state="loaded",i(null))}e.request=t.getImage(this.map._requestManager.transformRequest(n,t.ResourceType.Tile),function(n,o,a,s){if(delete e.request,e.aborted)e.state="unloaded",i(null);else if(n)e.state="errored",i(n);else if(o){this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:a,expires:s});const i=t.window.ImageBitmap&&o instanceof t.window.ImageBitmap&&(null==wt&&(wt=t.window.OffscreenCanvas&&new t.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof t.window.createImageBitmap),wt),n=1-(o.width-t.prevPowerOfTwo(o.width))/2;n<1||e.neighboringTiles||(e.neighboringTiles=this._getNeighboringTiles(e.tileID));const l=i?o:t.exported.getImageData(o,n),u={uid:e.uid,coord:e.tileID,source:this.id,rawImageData:l,encoding:this.encoding,padding:n};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",u,r.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(e){const i=e.canonical,n=Math.pow(2,i.z),r=(i.x-1+n)%n,o=0===i.x?e.wrap-1:e.wrap,a=(i.x+1+n)%n,s=i.x+1===n?e.wrap+1:e.wrap,l={};return l[new t.OverscaledTileID(e.overscaledZ,o,i.z,r,i.y).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,i.z,a,i.y).key]={backfilled:!1},i.y>0&&(l[new t.OverscaledTileID(e.overscaledZ,o,i.z,r,i.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,i.z,a,i.y-1).key]={backfilled:!1}),i.y+1<n&&(l[new t.OverscaledTileID(e.overscaledZ,o,i.z,r,i.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,e.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},l[new t.OverscaledTileID(e.overscaledZ,s,i.z,a,i.y+1).key]={backfilled:!1}),l}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded"}},geojson:class extends t.Evented{constructor(e,i,n,r){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=n.getActor(),this.setEventedParent(r),this._data=i.data,this._options=t.extend({},i),this._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const o=t.EXTENT/this.tileSize;this.workerOptions=t.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*o,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*o,extent:t.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:t.EXTENT,radius:(void 0!==i.clusterRadius?i.clusterRadius:50)*o,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions)}onAdd(t){this.map=t,this.setData(this._data)}setData(t){return this._data=t,this._updateWorkerData(),this}getClusterExpansionZoom(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},e),this}getClusterChildren(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},e),this}getClusterLeaves(t,e,i,n){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:e,offset:i},n),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new t.Event("dataloading",{dataType:"source"})),this._loaded=!1;const e=t.extend({},this.workerOptions),i=this._data;"string"==typeof i?(e.request=this.map._requestManager.transformRequest(t.exported.resolveURL(i),t.ResourceType.Source),e.request.collectResourceTiming=this._collectResourceTiming):e.data=JSON.stringify(i),this._pendingLoad=this.actor.send(`${this.type}.loadData`,e,(e,i)=>{if(this._loaded=!0,this._pendingLoad=null,e)this.fire(new t.ErrorEvent(e));else{const e={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&i&&i.resourceTiming&&i.resourceTiming[this.id]&&(e.resourceTiming=i.resourceTiming[this.id]),this.fire(new t.Event("data",e)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(e,i){const n=e.actor?"reloadTile":"loadTile";e.actor=this.actor,e.request=this.actor.send(n,{type:this.type,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:t.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(t,r)=>(delete e.request,e.unloadVectorData(),e.aborted?i(null):t?i(t):(e.loadVectorData(r,this.map.painter,"reloadTile"===n),i(null))),void 0,"loadTile"===n)}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return t.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Tt{constructor(t,e,i,n){super(t,e,i,n),this.roundZoom=!0,this.type="video",this.options=e}load(){this._loaded=!1;const e=this.options;this.urls=[];for(const i of e.urls)this.urls.push(this.map._requestManager.transformRequest(i,t.ResourceType.Source).url);t.getVideo(this.urls,(e,i)=>{this._loaded=!0,e?this.fire(new t.ErrorEvent(e)):i&&(this.video=i,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const i=this.video.seekable;e<i.start(0)||e>i.end(0)?this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,i=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,St.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new t.Texture(e,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Tt,canvas:class extends Tt{constructor(e,i,n,r){super(e,i,n,r),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some(t=>!Array.isArray(t)||2!==t.length||t.some(t=>"number"!=typeof t))||this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof t.window.HTMLCanvasElement||this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.ErrorEvent(new t.ValidationError(`sources.${e}`,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof t.window.HTMLCanvasElement?this.options.canvas:t.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.ErrorEvent(Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const i=this.map.painter.context,n=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,St.members)),this.boundsSegments||(this.boundsSegments=t.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new t.Texture(i,this.canvas,n.RGBA,{premultiply:!0});for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}},It=function(e,i,n,r){const o=new Mt[i.type](e,i,n,r);if(o.id!==e)throw Error(`Expected Source id to be ${e} instead of ${o.id}`);return t.bindAll(["load","abort","unload","serialize","prepare"],o),o};function Ct(e,i){const n=t.identity([]);return t.scale$1(n,n,[.5*e.width,.5*-e.height,1]),t.translate(n,n,[1,-1,0]),t.multiply(n,n,e.calculateProjMatrix(i.toUnwrapped()))}function At(t,e,i,n,r,o,a,s=!1){const l=t.tilesIn(n,a,s);l.sort(Dt);const u=[];for(const n of l)u.push({wrappedTileID:n.tile.tileID.wrapped().key,queryResults:n.tile.queryRenderedFeatures(e,i,t._state,n,r,o,Ct(t.transform,n.tile.tileID),s)});const c=function(t){const e={},i={};for(const n of t){const t=n.queryResults,r=n.wrappedTileID,o=i[r]=i[r]||{};for(const i in t){const n=t[i],r=o[i]=o[i]||{},a=e[i]=e[i]||[];for(const t of n)r[t.featureIndex]||(r[t.featureIndex]=!0,a.push(t))}}return e}(u);for(const e in c)c[e].forEach(e=>{const i=e.feature,n=t.getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=n});return c}function kt(t,e){const i=t.getRenderableIds().map(e=>t.getTileByID(e)),n=[],r={};for(let t=0;t<i.length;t++){const o=i[t],a=o.tileID.canonical.key;r[a]||(r[a]=!0,o.querySourceFeatures(n,e))}return n}function Dt(t,e){const i=t.tileID,n=e.tileID;return i.overscaledZ-n.overscaledZ||i.canonical.y-n.canonical.y||i.wrap-n.wrap||i.canonical.x-n.canonical.x}function Et(){return null!=jr.workerClass?new jr.workerClass:new t.window.Worker(jr.workerUrl)}const Pt="mapboxgl_preloaded_worker_pool";class Lt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Lt.workerCount;)this.workers.push(new Et);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach(t=>{t.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Pt]}numActive(){return Object.keys(this.active).length}}let zt;function Ot(){return zt||(zt=new Lt),zt}function Rt(e,i){const n={};for(const t in e)"ref"!==t&&(n[t]=e[t]);return t.refProperties.forEach(t=>{t in i&&(n[t]=i[t])}),n}function Bt(t){t=t.slice();const e=Object.create(null);for(let i=0;i<t.length;i++)e[t[i].id]=t[i];for(let i=0;i<t.length;i++)"ref"in t[i]&&(t[i]=Rt(t[i],e[t[i].ref]));return t}Lt.workerCount=2;const Nt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog"};function Ft(t,e,i){i.push({command:Nt.addSource,args:[t,e[t]]})}function Vt(t,e,i){e.push({command:Nt.removeSource,args:[t]}),i[t]=!0}function Ut(t,e,i,n){Vt(t,i,n),Ft(t,e,i)}function Gt(t,e,i){let n;for(n in t[i])if(t[i].hasOwnProperty(n)&&"data"!==n&&!r(t[i][n],e[i][n]))return!1;for(n in e[i])if(e[i].hasOwnProperty(n)&&"data"!==n&&!r(t[i][n],e[i][n]))return!1;return!0}function $t(t,e,i,n,o,a){let s;for(s in e=e||{},t=t||{})t.hasOwnProperty(s)&&(r(t[s],e[s])||i.push({command:a,args:[n,s,e[s],o]}));for(s in e)e.hasOwnProperty(s)&&!t.hasOwnProperty(s)&&(r(t[s],e[s])||i.push({command:a,args:[n,s,e[s],o]}))}function Wt(t){return t.id}function Ht(t,e){return t[e.id]=e,t}class jt{constructor(t,e){this.reset(t,e)}reset(t,e){this.points=t||[],this._distances=[0];for(let t=1;t<this.points.length;t++)this._distances[t]=this._distances[t-1]+this.points[t].dist(this.points[t-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(e||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(1===this.points.length)return this.points[0];e=t.clamp(e,0,1);let i=1,n=this._distances[i];const r=e*this.paddedLength+this.padding;for(;n<r&&i<this._distances.length;)n=this._distances[++i];const o=i-1,a=this._distances[o],s=n-a,l=s>0?(r-a)/s:0;return this.points[o].mult(1-l).add(this.points[i].mult(l))}}class Zt{constructor(t,e,i){const n=this.boxCells=[],r=this.circleCells=[];this.xCellCount=Math.ceil(t/i),this.yCellCount=Math.ceil(e/i);for(let t=0;t<this.xCellCount*this.yCellCount;t++)n.push([]),r.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=e,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/e,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,e,i,n,r){this._forEachCell(e,i,n,r,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(n),this.bboxes.push(r)}insertCircle(t,e,i,n){this._forEachCell(e-n,i-n,e+n,i+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(e),this.circles.push(i),this.circles.push(n)}_insertBoxCell(t,e,i,n,r,o){this.boxCells[r].push(o)}_insertCircleCell(t,e,i,n,r,o){this.circleCells[r].push(o)}_query(t,e,i,n,r,o){if(i<0||t>this.width||n<0||e>this.height)return!r&&[];const a=[];if(t<=0&&e<=0&&this.width<=i&&this.height<=n){if(r)return!0;for(let t=0;t<this.boxKeys.length;t++)a.push({key:this.boxKeys[t],x1:this.bboxes[4*t],y1:this.bboxes[4*t+1],x2:this.bboxes[4*t+2],y2:this.bboxes[4*t+3]});for(let t=0;t<this.circleKeys.length;t++){const e=this.circles[3*t],i=this.circles[3*t+1],n=this.circles[3*t+2];a.push({key:this.circleKeys[t],x1:e-n,y1:i-n,x2:e+n,y2:i+n})}return o?a.filter(o):a}return this._forEachCell(t,e,i,n,this._queryCell,a,{hitTest:r,seenUids:{box:{},circle:{}}},o),r?a.length>0:a}_queryCircle(t,e,i,n,r){const o=t-i,a=t+i,s=e-i,l=e+i;if(a<0||o>this.width||l<0||s>this.height)return!n&&[];const u=[];return this._forEachCell(o,s,a,l,this._queryCellCircle,u,{hitTest:n,circle:{x:t,y:e,radius:i},seenUids:{box:{},circle:{}}},r),n?u.length>0:u}query(t,e,i,n,r){return this._query(t,e,i,n,!1,r)}hitTest(t,e,i,n,r){return this._query(t,e,i,n,!0,r)}hitTestCircle(t,e,i,n){return this._queryCircle(t,e,i,!0,n)}_queryCell(t,e,i,n,r,o,a,s){const l=a.seenUids,u=this.boxCells[r];if(null!==u){const r=this.bboxes;for(const c of u)if(!l.box[c]){l.box[c]=!0;const u=4*c;if(t<=r[u+2]&&e<=r[u+3]&&i>=r[u+0]&&n>=r[u+1]&&(!s||s(this.boxKeys[c]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[c],x1:r[u],y1:r[u+1],x2:r[u+2],y2:r[u+3]})}}}const c=this.circleCells[r];if(null!==c){const r=this.circles;for(const u of c)if(!l.circle[u]){l.circle[u]=!0;const c=3*u;if(this._circleAndRectCollide(r[c],r[c+1],r[c+2],t,e,i,n)&&(!s||s(this.circleKeys[u]))){if(a.hitTest)return o.push(!0),!0;{const t=r[c],e=r[c+1],i=r[c+2];o.push({key:this.circleKeys[u],x1:t-i,y1:e-i,x2:t+i,y2:e+i})}}}}}_queryCellCircle(t,e,i,n,r,o,a,s){const l=a.circle,u=a.seenUids,c=this.boxCells[r];if(null!==c){const t=this.bboxes;for(const e of c)if(!u.box[e]){u.box[e]=!0;const i=4*e;if(this._circleAndRectCollide(l.x,l.y,l.radius,t[i+0],t[i+1],t[i+2],t[i+3])&&(!s||s(this.boxKeys[e])))return o.push(!0),!0}}const h=this.circleCells[r];if(null!==h){const t=this.circles;for(const e of h)if(!u.circle[e]){u.circle[e]=!0;const i=3*e;if(this._circlesCollide(t[i],t[i+1],t[i+2],l.x,l.y,l.radius)&&(!s||s(this.circleKeys[e])))return o.push(!0),!0}}}_forEachCell(t,e,i,n,r,o,a,s){const l=this._convertToXCellCoord(t),u=this._convertToYCellCoord(e),c=this._convertToXCellCoord(i),h=this._convertToYCellCoord(n);for(let p=l;p<=c;p++)for(let l=u;l<=h;l++)if(r.call(this,t,e,i,n,this.xCellCount*l+p,o,a,s))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,e,i,n,r,o){const a=n-t,s=r-e,l=i+o;return l*l>a*a+s*s}_circleAndRectCollide(t,e,i,n,r,o,a){const s=(o-n)/2,l=Math.abs(t-(n+s));if(l>s+i)return!1;const u=(a-r)/2,c=Math.abs(e-(r+u));if(c>u+i)return!1;if(l<=s||c<=u)return!0;const h=l-s,p=c-u;return h*h+p*p<=i*i}}function qt(e,i,n,r,o){const a=t.create$1();return i?(t.scale$1(a,a,[1/o,1/o,1]),n||t.rotateZ(a,a,r.angle)):t.multiply(a,r.labelPlaneMatrix,e),a}function Xt(e,i,n,r,o){if(i){const i=t.clone$1(e);return t.scale$1(i,i,[o,o,1]),n||t.rotateZ(i,i,-r.angle),i}return r.glCoordMatrix}function Yt(e,i,n=0){const r=[e.x,e.y,n,1];n?t.transformMat4(r,r,i):se(r,r,i);const o=r[3];return{point:new t.pointGeometry(r[0]/o,r[1]/o),signedDistanceFromCamera:o}}function Kt(t,e){return Math.min(.5+t/e*.5,1.5)}function Jt(t,e){const i=t[0]/t[3],n=t[1]/t[3];return i>=-e[0]&&i<=e[0]&&n>=-e[1]&&n<=e[1]}function Qt(e,i,n,r,o,a,s,l,u){const c=r?e.textSizeData:e.iconSizeData,h=t.evaluateSizeForZoom(c,n.transform.zoom),p=[256/n.width*2+1,256/n.height*2+1],d=r?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;d.clear();const f=e.lineVertexArray,m=r?e.text.placedSymbolArray:e.icon.placedSymbolArray,g=n.transform.width/n.transform.height;let y=!1;for(let r=0;r<m.length;r++){const v=m.get(r);if(v.hidden||v.writingMode===t.WritingMode.vertical&&!y){ae(v.numGlyphs,d);continue}y=!1;const _=u?u({x:v.anchorX,y:v.anchorY}):0,x=[v.anchorX,v.anchorY,_,1];if(t.transformMat4(x,x,i),!Jt(x,p)){ae(v.numGlyphs,d);continue}const b=Kt(n.transform.cameraToCenterDistance,x[3]),w=t.evaluateSizeForFeature(c,h,v),S=s?w/b:w*b,T=new t.pointGeometry(v.anchorX,v.anchorY),M=Yt(T,o,_);if(M.signedDistanceFromCamera<=0){ae(v.numGlyphs,d);continue}const I=M.point;let C={};const A=s?null:u,k=ie(v,S,!1,l,i,o,a,e.glyphOffsetArray,f,d,I,T,C,g,A);y=k.useVertical,A&&k.needsFlipping&&(C={}),(k.notEnoughRoom||y||k.needsFlipping&&ie(v,S,!0,l,i,o,a,e.glyphOffsetArray,f,d,I,T,C,g,A).notEnoughRoom)&&ae(v.numGlyphs,d)}r?e.text.dynamicLayoutVertexBuffer.updateData(d):e.icon.dynamicLayoutVertexBuffer.updateData(d)}function te(t,e,i,n,r,o,a,s,l,u,c,h,p){const d=s.glyphStartIndex+s.numGlyphs,f=s.lineStartIndex,m=s.lineStartIndex+s.lineLength,g=e.getoffsetX(s.glyphStartIndex),y=e.getoffsetX(d-1),v=re(t*g,i,n,r,o,a,s.segment,f,m,l,u,c,h,p,!0);if(!v)return null;const _=re(t*y,i,n,r,o,a,s.segment,f,m,l,u,c,h,p,!0);return _?{first:v,last:_}:null}function ee(e,i,n,r){return e===t.WritingMode.horizontal&&Math.abs(n.y-i.y)>Math.abs(n.x-i.x)*r?{useVertical:!0}:(e===t.WritingMode.vertical?i.y<n.y:i.x>n.x)?{needsFlipping:!0}:null}function ie(e,i,n,r,o,a,s,l,u,c,h,p,d,f,m){const g=i/24,y=e.lineOffsetX*g,v=e.lineOffsetY*g;let _;if(e.numGlyphs>1){const t=e.glyphStartIndex+e.numGlyphs,i=e.lineStartIndex,o=e.lineStartIndex+e.lineLength,c=te(g,l,y,v,n,h,p,e,u,a,d,m);if(!c)return{notEnoughRoom:!0};const x=Yt(c.first.point,s).point,b=Yt(c.last.point,s).point;if(r&&!n){const t=ee(e.writingMode,x,b,f);if(t)return t}_=[c.first];for(let r=e.glyphStartIndex+1;r<t-1;r++)_.push(re(g*l.getoffsetX(r),y,v,n,h,p,e.segment,i,o,u,a,d,m));_.push(c.last)}else{if(r&&!n){const i=Yt(p,o).point,n=e.lineStartIndex+e.segment+1,r=new t.pointGeometry(u.getx(n),u.gety(n)),a=Yt(r,o),s=a.signedDistanceFromCamera>0?a.point:ne(p,r,i,1,o),l=ee(e.writingMode,i,s,f);if(l)return l}const i=re(g*l.getoffsetX(e.glyphStartIndex),y,v,n,h,p,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,u,a,d,m);if(!i)return{notEnoughRoom:!0};_=[i]}for(const e of _)t.addDynamicAttributes(c,e.point,e.angle);return{}}function ne(t,e,i,n,r,o){const a=t.add(t.sub(e)._unit()),s=Yt(a,r,o?o(a):0).point,l=i.sub(s);return i.add(l._mult(n/l.mag()))}function re(e,i,n,r,o,a,s,l,u,c,h,p,d,f,m){const g=r?e-i:e+i;let y=g>0?1:-1,v=0;r&&(y*=-1,v=Math.PI),y<0&&(v+=Math.PI);let _=y>0?l+s:l+s+1,x=o,b=o,w=0,S=0;const T=Math.abs(g),M=[],I=[];let C=a;const A=()=>{const e=_-y;return 0===w?a:new t.pointGeometry(c.getx(e),c.gety(e))},k=()=>ne(A(),C,b,T-w+1,h,d);for(;w+S<=T;){if((_+=y)<l||_>=u)return null;if(b=x,M.push(x),f&&I.push(C||A()),void 0===(x=p[_])){const e=Yt(C=new t.pointGeometry(c.getx(_),c.gety(_)),h,d?d(C):0);x=e.signedDistanceFromCamera>0?p[_]=e.point:k()}else C=null;w+=S,S=b.dist(x)}m&&d&&(C=C||new t.pointGeometry(c.getx(_),c.gety(_)),p[_]=x=void 0===p[_]?x:k(),S=b.dist(x));const D=(T-w)/S,E=x.sub(b),P=E.mult(D)._add(b);n&&P._add(E._unit()._perp()._mult(n*y));const L=v+Math.atan2(x.y-b.y,x.x-b.x);return M.push(P),f&&(C=C||new t.pointGeometry(c.getx(_),c.gety(_)),I.push(function(e,i,n){const r=1-n;return new t.pointGeometry(e.x*r+i.x*n,e.y*r+i.y*n)}(I.length>0?I[I.length-1]:C,C,D))),{point:P,angle:L,path:M,tilePath:I}}const oe=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ae(t,e){for(let i=0;i<t;i++){const t=e.length;e.resize(t+4),e.float32.set(oe,3*t)}}function se(t,e,i){const n=e[0],r=e[1];return t[0]=i[0]*n+i[4]*r+i[12],t[1]=i[1]*n+i[5]*r+i[13],t[3]=i[3]*n+i[7]*r+i[15],t}const le=100;class ue{constructor(t,e,i=new Zt(t.width+200,t.height+200,25),n=new Zt(t.width+200,t.height+200,25)){this.transform=t,this.grid=i,this.ignoredGrid=n,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+le,this.screenBottomBoundary=t.height+le,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=e}placeCollisionBox(t,e,i,n,r,o,a){const s=this.projectAndGetPerspectiveRatio(o,e.anchorPointX,e.anchorPointY,e.elevation,e.tileID),l=r*s.perspectiveRatio,u=(e.x1*t+i.x-e.padding)*l+s.point.x,c=(e.y1*t+i.y-e.padding)*l+s.point.y,h=(e.x2*t+i.x+e.padding)*l+s.point.x,p=(e.y2*t+i.y+e.padding)*l+s.point.y,d=s.perspectiveRatio<=.55||s.aboveHorizon;return!this.isInsideGrid(u,c,h,p)||!n&&this.grid.hitTest(u,c,h,p,a)||d?{box:[],offscreen:!1}:{box:[u,c,h,p],offscreen:this.isOffscreen(u,c,h,p)}}placeCollisionCircles(e,i,n,r,o,a,s,l,u,c,h,p,d,f){const m=[],g=this.transform.elevation,y=g?t=>g.getAtTileOffset(f,t.x,t.y):t=>0,v=new t.pointGeometry(i.anchorX,i.anchorY),_=y(v),x=this.projectAndGetPerspectiveRatio(a,v.x,v.y,_,f),{perspectiveRatio:b}=x,w=(c?o/b:o*b)/t.ONE_EM,S=Yt(v,s,_).point,T=x.signedDistanceFromCamera>0?te(w,r,i.lineOffsetX*w,i.lineOffsetY*w,!1,S,v,i,n,s,{},g&&!c?y:null,c&&!!g):null;let M=!1,I=!1,C=!0;if(T&&!x.aboveHorizon){const i=.5*p*b+d,n=new t.pointGeometry(-100,-100),r=new t.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),o=new jt,a=T.first,s=T.last;let c=[];for(let t=a.path.length-1;t>=1;t--)c.push(a.path[t]);for(let t=1;t<s.path.length;t++)c.push(s.path[t]);const f=2.5*i;if(l){const t=c.map(g?(t,e)=>{const i=y(e<a.path.length-1?a.tilePath[a.path.length-1-e]:s.tilePath[e-a.path.length+2]);return Yt(t,l,i)}:t=>Yt(t,l));c=t.some(t=>t.signedDistanceFromCamera<=0)?[]:t.map(t=>t.point)}let v=[];if(c.length>0){const e=c[0].clone(),i=c[0].clone();for(let t=1;t<c.length;t++)e.x=Math.min(e.x,c[t].x),e.y=Math.min(e.y,c[t].y),i.x=Math.max(i.x,c[t].x),i.y=Math.max(i.y,c[t].y);v=e.x>=n.x&&i.x<=r.x&&e.y>=n.y&&i.y<=r.y?[c]:i.x<n.x||e.x>r.x||i.y<n.y||e.y>r.y?[]:t.clipLine([c],n.x,n.y,r.x,r.y)}for(const t of v){o.reset(t,.25*i);let n=0;n=o.length<=.5*i?1:Math.ceil(o.paddedLength/f)+1;for(let t=0;t<n;t++){const r=t/Math.max(n-1,1),a=o.lerp(r),s=a.x+le,l=a.y+le;m.push(s,l,i,0);const c=s-i,p=l-i,d=s+i,f=l+i;if(C=C&&this.isOffscreen(c,p,d,f),I=I||this.isInsideGrid(c,p,d,f),!e&&this.grid.hitTestCircle(s,l,i,h)&&(M=!0,!u))return{circles:[],offscreen:!1,collisionDetected:M}}}}return{circles:!u&&M||!I?[]:m,offscreen:C,collisionDetected:M}}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const i=[];let n=1/0,r=1/0,o=-1/0,a=-1/0;for(const s of e){const e=new t.pointGeometry(s.x+le,s.y+le);n=Math.min(n,e.x),r=Math.min(r,e.y),o=Math.max(o,e.x),a=Math.max(a,e.y),i.push(e)}const s=this.grid.query(n,r,o,a).concat(this.ignoredGrid.query(n,r,o,a)),l={},u={};for(const e of s){const n=e.key;if(void 0===l[n.bucketInstanceId]&&(l[n.bucketInstanceId]={}),l[n.bucketInstanceId][n.featureIndex])continue;const r=[new t.pointGeometry(e.x1,e.y1),new t.pointGeometry(e.x2,e.y1),new t.pointGeometry(e.x2,e.y2),new t.pointGeometry(e.x1,e.y2)];t.polygonIntersectsPolygon(i,r)&&(l[n.bucketInstanceId][n.featureIndex]=!0,void 0===u[n.bucketInstanceId]&&(u[n.bucketInstanceId]=[]),u[n.bucketInstanceId].push(n.featureIndex))}return u}insertCollisionBox(t,e,i,n,r){(e?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:n,collisionGroupID:r},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,e,i,n,r){const o=e?this.ignoredGrid:this.grid,a={bucketInstanceId:i,featureIndex:n,collisionGroupID:r};for(let e=0;e<t.length;e+=4)o.insertCircle(a,t[e],t[e+1],t[e+2])}projectAndGetPerspectiveRatio(e,i,n,r,o){const a=[i,n,r||0,1];let s=!1;if(r||this.transform.pitch>0){t.transformMat4(a,a,e);let l=!1;this.fogState&&o&&(l=function(e,i,n,r,o,a){const s=a.calculateFogTileMatrix(o),l=[i,n,r];return t.transformMat4$1(l,l,s),S(e,l,a.pitch,a._fov)}(this.fogState,i,n,r||0,o.toUnwrapped(),this.transform)>.9),s=a[2]>a[3]||l}else se(a,a,e);return{point:new t.pointGeometry((a[0]/a[3]+1)/2*this.transform.width+le,(-a[1]/a[3]+1)/2*this.transform.height+le),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/a[3]*.5,1.5),signedDistanceFromCamera:a[3],aboveHorizon:s}}isOffscreen(t,e,i,n){return i<le||t>=this.screenRightBoundary||n<le||e>this.screenBottomBoundary}isInsideGrid(t,e,i,n){return i>=0&&t<this.gridRightBoundary&&n>=0&&e<this.gridBottomBoundary}getViewportMatrix(){const e=t.identity([]);return t.translate(e,e,[-100,-100,0]),e}}class ce{constructor(t,e,i,n){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?e:-e))):n&&i?1:0,this.placed=i}isHidden(){return 0===this.opacity&&!this.placed}}class he{constructor(t,e,i,n,r){this.text=new ce(t?t.text:null,e,i,r),this.icon=new ce(t?t.icon:null,e,n,r)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class pe{constructor(t,e,i){this.text=t,this.icon=e,this.skipFade=i}}class de{constructor(){this.invProjMatrix=t.create$1(),this.viewportMatrix=t.create$1(),this.circles=[]}}class fe{constructor(t,e,i,n,r){this.bucketInstanceId=t,this.featureIndex=e,this.sourceLayerIndex=i,this.bucketIndex=n,this.tileID=r}}class me{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const e=++this.maxGroupID;this.collisionGroups[t]={ID:e,predicate:t=>t.collisionGroupID===e}}return this.collisionGroups[t]}}function ge(e,i,n,r,o){const{horizontalAlign:a,verticalAlign:s}=t.getAnchorAlignment(e),l=-(a-.5)*i,u=-(s-.5)*n,c=t.evaluateVariableOffset(e,r);return new t.pointGeometry(l+c[0]*o,u+c[1]*o)}function ye(e,i,n,r,o){const a=new t.pointGeometry(e,i);return n&&a._rotate(r?o:-o),a}class ve{constructor(t,e,i,n,r){this.transform=t.clone(),this.collisionIndex=new ue(this.transform,r),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=e,this.retainedQueryData={},this.collisionGroups=new me(i),this.collisionCircleArrays={},this.prevPlacement=n,n&&(n.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,i,n,r){const o=n.getBucket(i),a=n.latestFeatureIndex;if(!o||!a||i.id!==o.layerIds[0])return;const s=n.collisionBoxArray,l=o.layers[0].layout,u=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),c=n.tileSize/t.EXTENT,h=this.transform.calculateProjMatrix(n.tileID.toUnwrapped()),p="map"===l.get("text-pitch-alignment"),d="map"===l.get("text-rotation-alignment"),f=k(n,1,this.transform.zoom),m=qt(h,p,d,this.transform,f);let g=null;if(p){const e=Xt(h,p,d,this.transform,f);g=t.multiply([],this.transform.labelPlaneMatrix,e)}this.retainedQueryData[o.bucketInstanceId]=new fe(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,n.tileID);const y={bucket:o,layout:l,posMatrix:h,textLabelPlaneMatrix:m,labelToScreenMatrix:g,scale:u,textPixelRatio:c,holdingForFade:n.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:t.evaluateSizeForZoom(o.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:t.evaluateSizeForZoom(o.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(o.sourceID)};if(r)for(const t of o.sortKeyRanges){const{sortKey:i,symbolInstanceStart:n,symbolInstanceEnd:r}=t;e.push({sortKey:i,symbolInstanceStart:n,symbolInstanceEnd:r,parameters:y})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:o.symbolInstances.length,parameters:y})}attemptAnchorPlacement(t,e,i,n,r,o,a,s,l,u,c,h,p,d,f,m,g,y){const v=[h.textOffset0,h.textOffset1],_=ge(t,i,n,v,r),x=this.collisionIndex.placeCollisionBox(r,e,ye(_.x,_.y,o,a,this.transform.angle),c,s,l,u.predicate);if((!m||0!==this.collisionIndex.placeCollisionBox(d.getSymbolInstanceIconSize(y,this.transform.zoom,p),m,ye(_.x,_.y,o,a,this.transform.angle),c,s,l,u.predicate).box.length)&&x.box.length>0){let e;return this.prevPlacement&&this.prevPlacement.variableOffsets[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID].text&&(e=this.prevPlacement.variableOffsets[h.crossTileID].anchor),this.variableOffsets[h.crossTileID]={textOffset:v,width:i,height:n,anchor:t,textScale:r,prevAnchor:e},this.markUsedJustification(d,t,h,f),d.allowVerticalPlacement&&(this.markUsedOrientation(d,f,h),this.placedOrientations[h.crossTileID]=f),{shift:_,placedGlyphBoxes:x}}}placeLayerBucketPart(e,i,n){const{bucket:r,layout:o,posMatrix:a,textLabelPlaneMatrix:s,labelToScreenMatrix:l,textPixelRatio:u,holdingForFade:c,collisionBoxArray:h,partiallyEvaluatedTextSize:p,partiallyEvaluatedIconSize:d,collisionGroup:f}=e.parameters,m=o.get("text-optional"),g=o.get("icon-optional"),y=o.get("text-allow-overlap"),v=o.get("icon-allow-overlap"),_="map"===o.get("text-rotation-alignment"),x="map"===o.get("text-pitch-alignment"),b="none"!==o.get("icon-text-fit"),w="viewport-y"===o.get("symbol-z-order"),S=y&&(v||!r.hasIconData()||g),T=v&&(y||!r.hasTextData()||m);!r.collisionArrays&&h&&r.deserializeCollisionBoxes(h),n&&r.updateCollisionDebugBuffers(this.transform.zoom,h);const M=(e,h,w)=>{if(i[e.crossTileID])return;if(c)return void(this.placements[e.crossTileID]=new pe(!1,!1,!1));let M=!1,I=!1,C=!0,A=null,k={box:null,offscreen:null},D={box:null,offscreen:null},E=null,P=null,L=null,z=0,O=0,R=0;w.textFeatureIndex?z=w.textFeatureIndex:e.useRuntimeCollisionCircles&&(z=e.featureIndex),w.verticalTextFeatureIndex&&(O=w.verticalTextFeatureIndex);const B=t=>{t.tileID=this.retainedQueryData[r.bucketInstanceId].tileID,(this.transform.elevation||t.elevation)&&(t.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[r.bucketInstanceId].tileID,t.anchorPointX,t.anchorPointY):0)},N=w.textBox;if(N){B(N);const i=i=>{let n=t.WritingMode.horizontal;if(r.allowVerticalPlacement&&!i&&this.prevPlacement){const t=this.prevPlacement.placedOrientations[e.crossTileID];t&&(this.placedOrientations[e.crossTileID]=t,n=t,this.markUsedOrientation(r,n,e))}return n},n=(i,n)=>{if(r.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&w.verticalTextBox){for(const e of r.writingModes)if(e===t.WritingMode.vertical?(k=n(),D=k):k=i(),k&&k.box&&k.box.length)break}else k=i()};if(o.get("text-variable-anchor")){let s=o.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[e.crossTileID]){const t=this.prevPlacement.variableOffsets[e.crossTileID];s.indexOf(t.anchor)>0&&(s=s.filter(e=>e!==t.anchor)).unshift(t.anchor)}const l=(t,i,n)=>{const o=r.getSymbolInstanceTextSize(p,e,this.transform.zoom,h),l=(t.x2-t.x1)*o+2*t.padding,c=(t.y2-t.y1)*o+2*t.padding,m=b&&!v?i:null;m&&B(m);let g={box:[],offscreen:!1};const w=y?2*s.length:s.length;for(let i=0;i<w;++i){const y=this.attemptAnchorPlacement(s[i%s.length],t,l,c,o,_,x,u,a,f,i>=s.length,e,h,r,n,m,p,d);if(y&&((g=y.placedGlyphBoxes)&&g.box&&g.box.length)){M=!0,A=y.shift;break}}return g};n(()=>l(N,w.iconBox,t.WritingMode.horizontal),()=>{const i=w.verticalTextBox;return i&&B(i),r.allowVerticalPlacement&&!(k&&k.box&&k.box.length)&&e.numVerticalGlyphVertices>0&&i?l(i,w.verticalIconBox,t.WritingMode.vertical):{box:null,offscreen:null}}),k&&(M=k.box,C=k.offscreen);const c=i(k&&k.box);if(!M&&this.prevPlacement){const t=this.prevPlacement.variableOffsets[e.crossTileID];t&&(this.variableOffsets[e.crossTileID]=t,this.markUsedJustification(r,t.anchor,e,c))}}else{const o=(i,n)=>{const o=r.getSymbolInstanceTextSize(p,e,this.transform.zoom,h),s=this.collisionIndex.placeCollisionBox(o,i,new t.pointGeometry(0,0),y,u,a,f.predicate);return s&&s.box&&s.box.length&&(this.markUsedOrientation(r,n,e),this.placedOrientations[e.crossTileID]=n),s};n(()=>o(N,t.WritingMode.horizontal),()=>{const i=w.verticalTextBox;return r.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&i?(B(i),o(i,t.WritingMode.vertical)):{box:null,offscreen:null}}),i(k&&k.box&&k.box.length)}}if(M=(E=k)&&E.box&&E.box.length>0,C=E&&E.offscreen,e.useRuntimeCollisionCircles){const i=r.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),u=t.evaluateSizeForFeature(r.textSizeData,p,i),c=o.get("text-padding");P=this.collisionIndex.placeCollisionCircles(y,i,r.lineVertexArray,r.glyphOffsetArray,u,a,s,l,n,x,f.predicate,e.collisionCircleDiameter,c,this.retainedQueryData[r.bucketInstanceId].tileID),M=y||P.circles.length>0&&!P.collisionDetected,C=C&&P.offscreen}if(w.iconFeatureIndex&&(R=w.iconFeatureIndex),w.iconBox){const e=e=>{B(e);const i=b&&A?ye(A.x,A.y,_,x,this.transform.angle):new t.pointGeometry(0,0),n=r.getSymbolInstanceIconSize(d,this.transform.zoom,h);return this.collisionIndex.placeCollisionBox(n,e,i,v,u,a,f.predicate)};D&&D.box&&D.box.length&&w.verticalIconBox?I=(L=e(w.verticalIconBox)).box.length>0:I=(L=e(w.iconBox)).box.length>0,C=C&&L.offscreen}const F=m||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,V=g||0===e.numIconVertices;if(F||V?V?F||(I=I&&M):M=I&&M:I=M=I&&M,M&&E&&E.box&&this.collisionIndex.insertCollisionBox(E.box,o.get("text-ignore-placement"),r.bucketInstanceId,D&&D.box&&O?O:z,f.ID),I&&L&&this.collisionIndex.insertCollisionBox(L.box,o.get("icon-ignore-placement"),r.bucketInstanceId,R,f.ID),P&&(M&&this.collisionIndex.insertCollisionCircles(P.circles,o.get("text-ignore-placement"),r.bucketInstanceId,z,f.ID),n)){const t=r.bucketInstanceId;let e=this.collisionCircleArrays[t];void 0===e&&(e=this.collisionCircleArrays[t]=new de);for(let t=0;t<P.circles.length;t+=4)e.circles.push(P.circles[t+0]),e.circles.push(P.circles[t+1]),e.circles.push(P.circles[t+2]),e.circles.push(P.collisionDetected?1:0)}this.placements[e.crossTileID]=new pe(M||S,I||T,C||r.justReloaded),i[e.crossTileID]=!0};if(w){const t=r.getSortedSymbolIndexes(this.transform.angle);for(let e=t.length-1;e>=0;--e){const i=t[e];M(r.symbolInstances.get(i),i,r.collisionArrays[i])}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)M(r.symbolInstances.get(t),t,r.collisionArrays[t]);if(n&&r.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[r.bucketInstanceId];t.invert(e.invProjMatrix,a),e.viewportMatrix=this.collisionIndex.getViewportMatrix()}r.justReloaded=!1}markUsedJustification(e,i,n,r){let o;o=r===t.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[t.getAnchorJustification(i)];const a=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];for(const t of a)t>=0&&(e.text.placedSymbolArray.get(t).crossTileID=o>=0&&t!==o?0:n.crossTileID)}markUsedOrientation(e,i,n){const r=i===t.WritingMode.horizontal||i===t.WritingMode.horizontalOnly?i:0,o=i===t.WritingMode.vertical?i:0,a=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];for(const t of a)e.text.placedSymbolArray.get(t).placedOrientation=r;n.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=o)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const e=this.prevPlacement;let i=!1;this.prevZoomAdjustment=e?e.zoomAdjustment(this.transform.zoom):0;const n=e?e.symbolFadeChange(t):1,r=e?e.opacities:{},o=e?e.variableOffsets:{},a=e?e.placedOrientations:{};for(const t in this.placements){const e=this.placements[t],o=r[t];o?(this.opacities[t]=new he(o,n,e.text,e.icon),i=i||e.text!==o.text.placed||e.icon!==o.icon.placed):(this.opacities[t]=new he(null,n,e.text,e.icon,e.skipFade),i=i||e.text||e.icon)}for(const t in r){const e=r[t];if(!this.opacities[t]){const r=new he(e,n,!1,!1);r.isHidden()||(this.opacities[t]=r,i=i||e.text.placed||e.icon.placed)}}for(const t in o)this.variableOffsets[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.variableOffsets[t]=o[t]);for(const t in a)this.placedOrientations[t]||!this.opacities[t]||this.opacities[t].isHidden()||(this.placedOrientations[t]=a[t]);i?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)}updateLayerOpacities(t,e){const i={};for(const n of e){const e=n.getBucket(t);e&&n.latestFeatureIndex&&t.id===e.layerIds[0]&&this.updateBucketOpacities(e,i,n.collisionBoxArray)}}updateBucketOpacities(e,i,n){e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const r=e.layers[0].layout,o=new he(null,0,!1,!1,!0),a=r.get("text-allow-overlap"),s=r.get("icon-allow-overlap"),l=r.get("text-variable-anchor"),u="map"===r.get("text-rotation-alignment"),c="map"===r.get("text-pitch-alignment"),h="none"!==r.get("icon-text-fit"),p=new he(null,0,a&&(s||!e.hasIconData()||r.get("icon-optional")),s&&(a||!e.hasTextData()||r.get("text-optional")),!0);!e.collisionArrays&&n&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(n);const d=(t,e,i)=>{for(let n=0;n<e/4;n++)t.opacityVertexArray.emplaceBack(i)};for(let n=0;n<e.symbolInstances.length;n++){const r=e.symbolInstances.get(n),{numHorizontalGlyphVertices:a,numVerticalGlyphVertices:s,crossTileID:f}=r;let m=this.opacities[f];i[f]?m=o:m||(m=p,this.opacities[f]=m),i[f]=!0;const g=r.numIconVertices>0,y=this.placedOrientations[r.crossTileID],v=y===t.WritingMode.vertical,_=y===t.WritingMode.horizontal||y===t.WritingMode.horizontalOnly;if(a>0||s>0){const t=Ce(m.text);d(e.text,a,v?Ae:t),d(e.text,s,_?Ae:t);const i=m.text.isHidden();[r.rightJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.leftJustifiedTextSymbolIndex].forEach(t=>{t>=0&&(e.text.placedSymbolArray.get(t).hidden=i||v?1:0)}),r.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).hidden=i||_?1:0);const n=this.variableOffsets[r.crossTileID];n&&this.markUsedJustification(e,n.anchor,r,y);const o=this.placedOrientations[r.crossTileID];o&&(this.markUsedJustification(e,"left",r,o),this.markUsedOrientation(e,o,r))}if(g){const t=Ce(m.icon),i=!(h&&r.verticalPlacedIconSymbolIndex&&v);r.placedIconSymbolIndex>=0&&(d(e.icon,r.numIconVertices,i?t:Ae),e.icon.placedSymbolArray.get(r.placedIconSymbolIndex).hidden=m.icon.isHidden()),r.verticalPlacedIconSymbolIndex>=0&&(d(e.icon,r.numVerticalIconVertices,i?Ae:t),e.icon.placedSymbolArray.get(r.verticalPlacedIconSymbolIndex).hidden=m.icon.isHidden())}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const i=e.collisionArrays[n];if(i){let n=new t.pointGeometry(0,0);if(i.textBox||i.verticalTextBox){let t=!0;if(l){const e=this.variableOffsets[f];e?(n=ge(e.anchor,e.width,e.height,e.textOffset,e.textScale),u&&n._rotate(c?this.transform.angle:-this.transform.angle)):t=!1}i.textBox&&_e(e.textCollisionBox.collisionVertexArray,m.text.placed,!t||v,n.x,n.y),i.verticalTextBox&&_e(e.textCollisionBox.collisionVertexArray,m.text.placed,!t||_,n.x,n.y)}const r=!(_||!i.verticalIconBox);i.iconBox&&_e(e.iconCollisionBox.collisionVertexArray,m.icon.placed,r,h?n.x:0,h?n.y:0),i.verticalIconBox&&_e(e.iconCollisionBox.collisionVertexArray,m.icon.placed,!r,h?n.x:0,h?n.y:0)}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=t.invProjMatrix,e.placementViewportMatrix=t.viewportMatrix,e.collisionCircleArray=t.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,e){const i=this.zoomAtLastRecencyCheck===e?1-this.zoomAdjustment(e):1;return this.zoomAtLastRecencyCheck=e,this.commitTime+this.fadeDuration*i>t}setStale(){this.stale=!0}}function _e(t,e,i,n,r){t.emplaceBack(e?1:0,i?1:0,n||0,r||0),t.emplaceBack(e?1:0,i?1:0,n||0,r||0),t.emplaceBack(e?1:0,i?1:0,n||0,r||0),t.emplaceBack(e?1:0,i?1:0,n||0,r||0)}const xe=33554432,be=16777216,we=131072,Se=65536,Te=512,Me=256,Ie=2;function Ce(t){if(0===t.opacity&&!t.placed)return 0;if(1===t.opacity&&t.placed)return 4294967295;const e=t.placed?1:0,i=Math.floor(127*t.opacity);return i*xe+e*be+i*we+e*Se+i*Te+e*Me+i*Ie+e}const Ae=0;class ke{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,e,i,n,r){const o=this._bucketParts;for(;this._currentTileIndex<t.length;)if(e.getBucketParts(o,n,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,r())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort((t,e)=>t.sortKey-e.sortKey));this._currentPartIndex<o.length;)if(e.placeLayerBucketPart(o[this._currentPartIndex],this._seenCrossTileIDs,i),this._currentPartIndex++,r())return!0;return!1}}class De{constructor(t,e,i,n,r,o,a,s){this.placement=new ve(t,r,o,a,s),this._currentPlacementIndex=e.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=n,this._done=!1}isDone(){return this._done}continuePlacement(e,i,n){const r=t.exported.now(),o=()=>{const e=t.exported.now()-r;return!this._forceFullPlacement&&e>2};for(;this._currentPlacementIndex>=0;){const t=i[e[this._currentPlacementIndex]],r=this.placement.collisionIndex.transform.zoom;if("symbol"===t.type&&(!t.minzoom||t.minzoom<=r)&&(!t.maxzoom||t.maxzoom>r)){if(this._inProgressLayer||(this._inProgressLayer=new ke(t)),this._inProgressLayer.continuePlacement(n[t.source],this.placement,this._showCollisionBoxes,t,o))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Ee=512/t.EXTENT/2;class Pe{constructor(t,e,i){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=i;for(let i=0;i<e.length;i++){const n=e.get(i),r=n.key;this.indexedSymbolInstances[r]||(this.indexedSymbolInstances[r]=[]),this.indexedSymbolInstances[r].push({crossTileID:n.crossTileID,coord:this.getScaledCoordinates(n,t)})}}getScaledCoordinates(e,i){const n=Ee/Math.pow(2,i.canonical.z-this.tileID.canonical.z);return{x:Math.floor((i.canonical.x*t.EXTENT+e.anchorX)*n),y:Math.floor((i.canonical.y*t.EXTENT+e.anchorY)*n)}}findMatches(t,e,i){const n=this.tileID.canonical.z<e.canonical.z?1:Math.pow(2,this.tileID.canonical.z-e.canonical.z);for(let r=0;r<t.length;r++){const o=t.get(r);if(o.crossTileID)continue;const a=this.indexedSymbolInstances[o.key];if(!a)continue;const s=this.getScaledCoordinates(o,e);for(const t of a)if(Math.abs(t.coord.x-s.x)<=n&&Math.abs(t.coord.y-s.y)<=n&&!i[t.crossTileID]){i[t.crossTileID]=!0,o.crossTileID=t.crossTileID;break}}}}class Le{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ze{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const e=Math.round((t-this.lng)/360);if(0!==e)for(const t in this.indexes){const i=this.indexes[t],n={};for(const t in i){const r=i[t];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+e),n[r.tileID.key]=r}this.indexes[t]=n}this.lng=t}addBucket(t,e,i){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===e.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let t=0;t<e.symbolInstances.length;t++)e.symbolInstances.get(t).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const n=this.usedCrossTileIDs[t.overscaledZ];for(const i in this.indexes){const r=this.indexes[i];if(+i>t.overscaledZ)for(const i in r){const o=r[i];o.tileID.isChildOf(t)&&o.findMatches(e.symbolInstances,t,n)}else{const o=r[t.scaledTo(+i).key];o&&o.findMatches(e.symbolInstances,t,n)}}for(let t=0;t<e.symbolInstances.length;t++){const r=e.symbolInstances.get(t);r.crossTileID||(r.crossTileID=i.generate(),n[r.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Pe(t,e.symbolInstances,e.bucketInstanceId),!0}removeBucketCrossTileIDs(t,e){for(const i in e.indexedSymbolInstances)for(const n of e.indexedSymbolInstances[i])delete this.usedCrossTileIDs[t][n.crossTileID]}removeStaleBuckets(t){let e=!1;for(const i in this.indexes){const n=this.indexes[i];for(const r in n)t[n[r].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,n[r]),delete n[r],e=!0)}return e}}class Oe{constructor(){this.layerIndexes={},this.crossTileIDs=new Le,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,e,i){let n=this.layerIndexes[t.id];void 0===n&&(n=this.layerIndexes[t.id]=new ze);let r=!1;const o={};n.handleWrapJump(i);for(const i of e){const e=i.getBucket(t);e&&t.id===e.layerIds[0]&&(e.bucketInstanceId||(e.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(i.tileID,e,this.crossTileIDs)&&(r=!0),o[e.bucketInstanceId]=!0)}return n.removeStaleBuckets(o)&&(r=!0),r}pruneUnusedLayers(t){const e={};t.forEach(t=>{e[t]=!0});for(const t in this.layerIndexes)e[t]||delete this.layerIndexes[t]}}const Re=(e,i)=>t.emitValidationErrors(e,i&&i.filter(t=>"source.canvas"!==t.identifier)),Be=t.pick(Nt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog"]),Ne=t.pick(Nt,["setCenter","setZoom","setBearing","setPitch"]),Fe=function(){const e={},i=t.spec.$version;for(const n in t.spec.$root){const r=t.spec.$root[n];if(r.required){let t=null;null!=(t="version"===n?i:"array"===r.type?[]:{})&&(e[n]=t)}}return e}(),Ve={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Ue extends t.Evented{constructor(e,i={}){super(),this.map=e,this.dispatcher=new A(Ot(),this),this.imageManager=new g,this.imageManager.setEventedParent(this),this.glyphManager=new t.GlyphManager(e._requestManager,i.localFontFamily?t.LocalGlyphMode.all:i.localIdeographFontFamily?t.LocalGlyphMode.ideographs:t.LocalGlyphMode.none,i.localFontFamily||i.localIdeographFontFamily),this.lineAtlas=new t.LineAtlas(256,512),this.crossTileSymbolIndex=new Oe,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new t.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",t.getReferrer());const n=this;this._rtlTextPluginCallback=Ue.registerForPluginStateChange(e=>{n.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:e.pluginStatus,pluginURL:e.pluginURL},(e,i)=>{if(t.triggerPluginCompletionEvent(e),i&&i.every(t=>t))for(const t in n._sourceCaches){const e=n._sourceCaches[t],i=e.getSource().type;"vector"!==i&&"geojson"!==i||e.reload()}})}),this.on("data",t=>{if("source"!==t.dataType||"metadata"!==t.sourceDataType)return;const e=this.getSource(t.sourceId);if(e&&e.vectorLayerIds)for(const t in this._layers){const i=this._layers[t];i.source===e.id&&this._validateLayer(i)}})}loadURL(e,i={}){this.fire(new t.Event("dataloading",{dataType:"style"}));const n="boolean"==typeof i.validate?i.validate:!t.isMapboxURL(e);e=this.map._requestManager.normalizeStyleURL(e,i.accessToken);const r=this.map._requestManager.transformRequest(e,t.ResourceType.Style);this._request=t.getJSON(r,(e,i)=>{this._request=null,e?this.fire(new t.ErrorEvent(e)):i&&this._load(i,n)})}loadJSON(e,i={}){this.fire(new t.Event("dataloading",{dataType:"style"})),this._request=t.exported.frame(()=>{this._request=null,this._load(e,!1!==i.validate)})}loadEmpty(){this.fire(new t.Event("dataloading",{dataType:"style"})),this._load(Fe,!1)}_updateLayerCount(t,e){const i=e?1:-1;t.is3D()&&(this._num3DLayers+=i),"circle"===t.type&&(this._numCircleLayers+=i),"symbol"===t.type&&(this._numSymbolLayers+=i)}_load(e,i){if(i&&Re(this,t.validateStyle(e)))return;this._loaded=!0,this.stylesheet=e;for(const t in e.sources)this.addSource(t,e.sources[t],{validate:!1});this._changed=!1,e.sprite?this._loadSprite(e.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(e.glyphs);const n=Bt(this.stylesheet.layers);this._order=n.map(t=>t.id),this._layers={},this._serializedLayers={};for(let e of n)(e=t.createStyleLayer(e)).setEventedParent(this,{layer:{id:e.id}}),this._layers[e.id]=e,this._serializedLayers[e.id]=e.serialize(),this._updateLayerCount(e,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new _(this.stylesheet.light),this.stylesheet.terrain&&this._createTerrain(this.stylesheet.terrain),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new t.Event("data",{dataType:"style"})),this.fire(new t.Event("style.load"))}_loadSprite(e){this._spriteRequest=function(e,i,n){let r,o,a;const s=t.exported.devicePixelRatio>1?"@2x":"";let l=t.getJSON(i.transformRequest(i.normalizeSpriteURL(e,s,".json"),t.ResourceType.SpriteJSON),(t,e)=>{l=null,a||(a=t,r=e,c())}),u=t.getImage(i.transformRequest(i.normalizeSpriteURL(e,s,".png"),t.ResourceType.SpriteImage),(t,e)=>{u=null,a||(a=t,o=e,c())});function c(){if(a)n(a);else if(r&&o){const e=t.exported.getImageData(o),i={};for(const n in r){const{width:o,height:a,x:s,y:l,sdf:u,pixelRatio:c,stretchX:h,stretchY:p,content:d}=r[n],f=new t.RGBAImage({width:o,height:a});t.RGBAImage.copy(e,f,{x:s,y:l},{x:0,y:0},{width:o,height:a}),i[n]={data:f,pixelRatio:c,sdf:u,stretchX:h,stretchY:p,content:d}}n(null,i)}}return{cancel(){l&&(l.cancel(),l=null),u&&(u.cancel(),u=null)}}}(e,this.map._requestManager,(e,i)=>{if(this._spriteRequest=null,e)this.fire(new t.ErrorEvent(e));else if(i)for(const t in i)this.imageManager.addImage(t,i[t]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new t.Event("data",{dataType:"style"}))})}_validateLayer(e){const i=this.getSource(e.source);if(!i)return;const n=e.sourceLayer;n&&("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(n))&&this.fire(new t.ErrorEvent(Error(`Source layer "${n}" does not exist on source "${i.id}" as specified by style layer "${e.id}"`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(t){const e=[];for(const i of t){const t=this._layers[i];"custom"!==t.type&&e.push(t.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;if(this.fog&&this.fog.hasTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(t){return!!this.terrain&&Ve[t.type]}_checkLoaded(){if(!this._loaded)throw Error("Style is not done loading")}update(e){if(!this._loaded)return;const i=this._changed;if(this._changed){const t=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);(t.length||i.length)&&this._updateWorkerLayers(t,i);for(const t in this._updatedSources){const e=this._updatedSources[t];"reload"===e?this._reloadSource(t):"clear"===e&&this._clearSource(t)}this._updateTilesForChangedImages();for(const t in this._updatedPaintProps)this._layers[t].updateTransitions(e);this.light.updateTransitions(e),this.fog&&this.fog.updateTransitions(e),this._resetUpdates()}const n={};for(const t in this._sourceCaches){const e=this._sourceCaches[t];n[t]=e.used,e.used=!1}for(const t of this._order){const i=this._layers[t];if(i.recalculate(e,this._availableImages),!i.isHidden(e.zoom)){const t=this._getLayerSourceCache(i);t&&(t.used=!0)}const n=this.map.painter;if(n){const t=i.getProgramIds();if(!t)continue;const r=i.getProgramConfiguration(e.zoom);for(const e of t)n.useProgram(e,r)}}for(const e in n){const i=this._sourceCaches[e];n[e]!==i.used&&i.getSource().fire(new t.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:i.getSource().id}))}this.light.recalculate(e),this.terrain&&this.terrain.recalculate(e),this.fog&&this.fog.recalculate(e),this.z=e.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),i&&this.fire(new t.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const e in this._sourceCaches)this._sourceCaches[e].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateWorkerLayers(t,e){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:e})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(e){if(this._checkLoaded(),Re(this,t.validateStyle(e)))return!1;(e=t.clone$2(e)).layers=Bt(e.layers);const i=function(t,e){if(!t)return[{command:Nt.setStyle,args:[e]}];let i=[];try{if(!r(t.version,e.version))return[{command:Nt.setStyle,args:[e]}];r(t.center,e.center)||i.push({command:Nt.setCenter,args:[e.center]}),r(t.zoom,e.zoom)||i.push({command:Nt.setZoom,args:[e.zoom]}),r(t.bearing,e.bearing)||i.push({command:Nt.setBearing,args:[e.bearing]}),r(t.pitch,e.pitch)||i.push({command:Nt.setPitch,args:[e.pitch]}),r(t.sprite,e.sprite)||i.push({command:Nt.setSprite,args:[e.sprite]}),r(t.glyphs,e.glyphs)||i.push({command:Nt.setGlyphs,args:[e.glyphs]}),r(t.transition,e.transition)||i.push({command:Nt.setTransition,args:[e.transition]}),r(t.light,e.light)||i.push({command:Nt.setLight,args:[e.light]}),r(t.fog,e.fog)||i.push({command:Nt.setFog,args:[e.fog]});const n={},o=[];!function(t,e,i,n){let o;for(o in e=e||{},t=t||{})t.hasOwnProperty(o)&&(e.hasOwnProperty(o)||Vt(o,i,n));for(o in e)e.hasOwnProperty(o)&&(t.hasOwnProperty(o)?r(t[o],e[o])||("geojson"===t[o].type&&"geojson"===e[o].type&&Gt(t,e,o)?i.push({command:Nt.setGeoJSONSourceData,args:[o,e[o].data]}):Ut(o,e,i,n)):Ft(o,e,i))}(t.sources,e.sources,o,n);const a=[];t.layers&&t.layers.forEach(t=>{n[t.source]?i.push({command:Nt.removeLayer,args:[t.id]}):a.push(t)});let s=t.terrain;s&&n[s.source]&&(i.push({command:Nt.setTerrain,args:[void 0]}),s=void 0),i=i.concat(o),r(s,e.terrain)||i.push({command:Nt.setTerrain,args:[e.terrain]}),function(t,e,i){e=e||[];const n=(t=t||[]).map(Wt),o=e.map(Wt),a=t.reduce(Ht,{}),s=e.reduce(Ht,{}),l=n.slice(),u=Object.create(null);let c,h,p,d,f,m,g;for(c=0,h=0;c<n.length;c++)p=n[c],s.hasOwnProperty(p)?h++:(i.push({command:Nt.removeLayer,args:[p]}),l.splice(l.indexOf(p,h),1));for(c=0,h=0;c<o.length;c++)p=o[o.length-1-c],l[l.length-1-c]!==p&&(a.hasOwnProperty(p)?(i.push({command:Nt.removeLayer,args:[p]}),l.splice(l.lastIndexOf(p,l.length-h),1)):h++,m=l[l.length-c],i.push({command:Nt.addLayer,args:[s[p],m]}),l.splice(l.length-c,0,p),u[p]=!0);for(c=0;c<o.length;c++)if(d=a[p=o[c]],f=s[p],!u[p]&&!r(d,f))if(r(d.source,f.source)&&r(d["source-layer"],f["source-layer"])&&r(d.type,f.type)){for(g in $t(d.layout,f.layout,i,p,null,Nt.setLayoutProperty),$t(d.paint,f.paint,i,p,null,Nt.setPaintProperty),r(d.filter,f.filter)||i.push({command:Nt.setFilter,args:[p,f.filter]}),r(d.minzoom,f.minzoom)&&r(d.maxzoom,f.maxzoom)||i.push({command:Nt.setLayerZoomRange,args:[p,f.minzoom,f.maxzoom]}),d)d.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?$t(d[g],f[g],i,p,g.slice(6),Nt.setPaintProperty):r(d[g],f[g])||i.push({command:Nt.setLayerProperty,args:[p,g,f[g]]}));for(g in f)f.hasOwnProperty(g)&&!d.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?$t(d[g],f[g],i,p,g.slice(6),Nt.setPaintProperty):r(d[g],f[g])||i.push({command:Nt.setLayerProperty,args:[p,g,f[g]]}))}else i.push({command:Nt.removeLayer,args:[p]}),m=l[l.lastIndexOf(p)+1],i.push({command:Nt.addLayer,args:[f,m]})}(a,e.layers,i)}catch(t){console.warn("Unable to compute style diff:",t),i=[{command:Nt.setStyle,args:[e]}]}return i}(this.serialize(),e).filter(t=>!(t.command in Ne));if(0===i.length)return!1;const n=i.filter(t=>!(t.command in Be));if(n.length>0)throw Error(`Unimplemented: ${n.map(t=>t.command).join(", ")}.`);return i.forEach(t=>{"setTransition"!==t.command&&this[t.command].apply(this,t.args)}),this.stylesheet=e,!0}addImage(e,i){if(this.getImage(e))return this.fire(new t.ErrorEvent(Error("An image with this name already exists.")));this.imageManager.addImage(e,i),this._afterImageUpdated(e)}updateImage(t,e){this.imageManager.updateImage(t,e)}getImage(t){return this.imageManager.getImage(t)}removeImage(e){if(!this.getImage(e))return this.fire(new t.ErrorEvent(Error("No image with this name exists.")));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new t.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,i,n={}){if(this._checkLoaded(),void 0!==this.getSource(e))throw Error("There is already a source with this ID");if(!i.type)throw Error(`The type property must be defined, but only the following properties were given: ${Object.keys(i).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(i.type)>=0&&this._validate(t.validateStyle.source,`sources.${e}`,i,null,n))return;this.map&&this.map._collectResourceTiming&&(i.collectResourceTiming=!0);const r=It(e,i,this.dispatcher,this);r.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:r.serialize(),sourceId:e}));const o=i=>{const n=(i?"symbol:":"other:")+e,o=this._sourceCaches[n]=new t.SourceCache(n,r,i);(i?this._symbolSourceCaches:this._otherSourceCaches)[e]=o,o.style=this,o.onAdd(this.map)};o(!1),"vector"!==i.type&&"geojson"!==i.type||o(!0),r.onAdd&&r.onAdd(this.map),this._changed=!0}removeSource(e){this._checkLoaded();const i=this.getSource(e);if(void 0===i)throw Error("There is no source with this ID");for(const i in this._layers)if(this._layers[i].source===e)return this.fire(new t.ErrorEvent(Error(`Source "${e}" cannot be removed while layer "${i}" is using it.`)));if(this.terrain&&this.terrain.get().source===e)return this.fire(new t.ErrorEvent(Error(`Source "${e}" cannot be removed while terrain is using it.`)));const n=this._getSourceCaches(e);for(const e of n)delete this._sourceCaches[e.id],delete this._updatedSources[e.id],e.fire(new t.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:e.getSource().id})),e.setEventedParent(null),e.clearTiles();delete this._otherSourceCaches[e],delete this._symbolSourceCaches[e],i.setEventedParent(null),i.onRemove&&i.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,e){this._checkLoaded(),this.getSource(t).setData(e),this._changed=!0}getSource(t){const e=this._getSourceCache(t);return e&&e.getSource()}addLayer(e,i,n={}){this._checkLoaded();const r=e.id;if(this.getLayer(r))return void this.fire(new t.ErrorEvent(Error(`Layer with id "${r}" already exists on this map`)));let o;if("custom"===e.type){if(Re(this,t.validateCustomStyleLayer(e)))return;o=t.createStyleLayer(e)}else{if("object"==typeof e.source&&(this.addSource(r,e.source),e=t.clone$2(e),e=t.extend(e,{source:r})),this._validate(t.validateStyle.layer,`layers.${r}`,e,{arrayIndex:-1},n))return;o=t.createStyleLayer(e),this._validateLayer(o),o.setEventedParent(this,{layer:{id:r}}),this._serializedLayers[o.id]=o.serialize(),this._updateLayerCount(o,!0)}const a=i?this._order.indexOf(i):this._order.length;if(i&&-1===a)return void this.fire(new t.ErrorEvent(Error(`Layer with id "${i}" does not exist on this map.`)));this._order.splice(a,0,r),this._layerOrderChanged=!0,this._layers[r]=o;const s=this._getLayerSourceCache(o);if(this._removedLayers[r]&&o.source&&s&&"custom"!==o.type){const t=this._removedLayers[r];delete this._removedLayers[r],t.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",s.pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(e,i){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new t.ErrorEvent(Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===i)return;const n=this._order.indexOf(e);this._order.splice(n,1);const r=i?this._order.indexOf(i):this._order.length;i&&-1===r?this.fire(new t.ErrorEvent(Error(`Layer with id "${i}" does not exist on this map.`))):(this._order.splice(r,0,e),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(e){this._checkLoaded();const i=this._layers[e];if(!i)return void this.fire(new t.ErrorEvent(Error(`The layer '${e}' does not exist in the map's style and cannot be removed.`)));i.setEventedParent(null),this._updateLayerCount(i,!1);const n=this._order.indexOf(e);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=i,delete this._layers[e],delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],i.onRemove&&i.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}hasLayerType(t){for(const e in this._layers)if(this._layers[e].type===t)return!0;return!1}setLayerZoomRange(e,i,n){this._checkLoaded();const r=this.getLayer(e);r?r.minzoom===i&&r.maxzoom===n||(null!=i&&(r.minzoom=i),null!=n&&(r.maxzoom=n),this._updateLayer(r)):this.fire(new t.ErrorEvent(Error(`The layer '${e}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(e,i,n={}){this._checkLoaded();const o=this.getLayer(e);if(o){if(!r(o.filter,i))return null==i?(o.filter=void 0,void this._updateLayer(o)):void(this._validate(t.validateStyle.filter,`layers.${o.id}.filter`,i,null,n)||(o.filter=t.clone$2(i),this._updateLayer(o)))}else this.fire(new t.ErrorEvent(Error(`The layer '${e}' does not exist in the map's style and cannot be filtered.`)))}getFilter(e){return t.clone$2(this.getLayer(e).filter)}setLayoutProperty(e,i,n,o={}){this._checkLoaded();const a=this.getLayer(e);a?r(a.getLayoutProperty(i),n)||(a.setLayoutProperty(i,n,o),this._updateLayer(a)):this.fire(new t.ErrorEvent(Error(`The layer '${e}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(e,i){const n=this.getLayer(e);if(n)return n.getLayoutProperty(i);this.fire(new t.ErrorEvent(Error(`The layer '${e}' does not exist in the map's style.`)))}setPaintProperty(e,i,n,o={}){this._checkLoaded();const a=this.getLayer(e);a?r(a.getPaintProperty(i),n)||(a.setPaintProperty(i,n,o)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[e]=!0):this.fire(new t.ErrorEvent(Error(`The layer '${e}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(t,e){return this.getLayer(t).getPaintProperty(e)}setFeatureState(e,i){this._checkLoaded();const n=e.source,r=e.sourceLayer,o=this.getSource(n);if(void 0===o)return void this.fire(new t.ErrorEvent(Error(`The source '${n}' does not exist in the map's style.`)));const a=o.type;if("geojson"===a&&r)return void this.fire(new t.ErrorEvent(Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===a&&!r)return void this.fire(new t.ErrorEvent(Error("The sourceLayer parameter must be provided for vector source types.")));void 0===e.id&&this.fire(new t.ErrorEvent(Error("The feature id parameter must be provided.")));const s=this._getSourceCaches(n);for(const t of s)t.setFeatureState(r,e.id,i)}removeFeatureState(e,i){this._checkLoaded();const n=e.source,r=this.getSource(n);if(void 0===r)return void this.fire(new t.ErrorEvent(Error(`The source '${n}' does not exist in the map's style.`)));const o=r.type,a="vector"===o?e.sourceLayer:void 0;if("vector"===o&&!a)return void this.fire(new t.ErrorEvent(Error("The sourceLayer parameter must be provided for vector source types.")));if(i&&"string"!=typeof e.id&&"number"!=typeof e.id)return void this.fire(new t.ErrorEvent(Error("A feature id is required to remove its specific state property.")));const s=this._getSourceCaches(n);for(const t of s)t.removeFeatureState(a,e.id,i)}getFeatureState(e){this._checkLoaded();const i=e.source,n=e.sourceLayer,r=this.getSource(i);if(void 0!==r){if("vector"!==r.type||n)return void 0===e.id&&this.fire(new t.ErrorEvent(Error("The feature id parameter must be provided."))),this._getSourceCaches(i)[0].getFeatureState(n,e.id);this.fire(new t.ErrorEvent(Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new t.ErrorEvent(Error(`The source '${i}' does not exist in the map's style.`)))}getTransition(){return t.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const e={};for(const t in this._sourceCaches){const i=this._sourceCaches[t].getSource();e[i.id]||(e[i.id]=i.serialize())}return t.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e,layers:this._serializeLayers(this._order)},t=>void 0!==t)}_updateLayer(t){this._updatedLayers[t.id]=!0;const e=this._getLayerSourceCache(t);t.source&&!this._updatedSources[t.source]&&e&&"raster"!==e.getSource().type&&(this._updatedSources[t.source]="reload",e.pause()),this._changed=!0}_flattenAndSortRenderedFeatures(t){const e=t=>"fill-extrusion"===this._layers[t].type,i={},n=[];for(let r=this._order.length-1;r>=0;r--){const o=this._order[r];if(e(o)){i[o]=r;for(const e of t){const t=e[o];if(t)for(const e of t)n.push(e)}}}n.sort((t,e)=>e.intersectionZ-t.intersectionZ);const r=[];for(let o=this._order.length-1;o>=0;o--){const a=this._order[o];if(e(a))for(let t=n.length-1;t>=0;t--){const e=n[t].feature;if(i[e.layer.id]<o)break;r.push(e),n.pop()}else for(const e of t){const t=e[a];if(t)for(const e of t)r.push(e.feature)}}return r}queryRenderedFeatures(e,i,n){i&&i.filter&&this._validate(t.validateStyle.filter,"queryRenderedFeatures.filter",i.filter,null,i);const r={};if(i&&i.layers){if(!Array.isArray(i.layers))return this.fire(new t.ErrorEvent(Error("parameters.layers must be an Array."))),[];for(const e of i.layers){const i=this._layers[e];if(!i)return this.fire(new t.ErrorEvent(Error(`The layer '${e}' does not exist in the map's style and cannot be queried for features.`))),[];r[i.source]=!0}}const o=[];i.availableImages=this._availableImages;const a=i&&i.layers?i.layers.some(t=>{const e=this.getLayer(t);return e&&e.is3D()}):this.has3DLayers(),s=D.createFromScreenPoints(e,n);for(const t in this._sourceCaches){const e=this._sourceCaches[t].getSource().id;i.layers&&!r[e]||o.push(At(this._sourceCaches[t],this._layers,this._serializedLayers,s,i,n,a,!!this.map._showQueryGeometry))}return this.placement&&o.push(function(t,e,i,n,r,o,a){const s={},l=o.queryRenderedSymbols(n),u=[];for(const t of Object.keys(l).map(Number))u.push(a[t]);u.sort(Dt);for(const i of u){const n=i.featureIndex.lookupSymbolFeatures(l[i.bucketInstanceId],e,i.bucketIndex,i.sourceLayerIndex,r.filter,r.layers,r.availableImages,t);for(const t in n){const e=s[t]=s[t]||[],r=n[t];r.sort((t,e)=>{const n=i.featureSortOrder;if(n){const i=n.indexOf(t.featureIndex);return n.indexOf(e.featureIndex)-i}return e.featureIndex-t.featureIndex});for(const t of r)e.push(t)}}for(const e in s)s[e].forEach(n=>{const r=n.feature,o=i(t[e]).getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=o});return s}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),s.screenGeometry,i,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(o)}querySourceFeatures(e,i){i&&i.filter&&this._validate(t.validateStyle.filter,"querySourceFeatures.filter",i.filter,null,i);const n=this._getSourceCaches(e);let r=[];for(const t of n)r=r.concat(kt(t,i));return r}addSourceType(t,e,i){return Ue.getSourceType(t)?i(Error(`A source type called "${t}" already exists.`)):(Ue.setSourceType(t,e),e.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:e.workerSourceURL},i):i(null,null))}getLight(){return this.light.getLight()}setLight(e,i={}){this._checkLoaded();const n=this.light.getLight();let o=!1;for(const t in e)if(!r(e[t],n[t])){o=!0;break}if(!o)return;const a={now:t.exported.now(),transition:t.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,i),this.light.updateTransitions(a)}getTerrain(){return this.terrain?this.terrain.get():null}setTerrain(e){if(this._checkLoaded(),!e)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if("object"==typeof e.source){const i="terrain-dem-src";this.addSource(i,e.source),e=t.clone$2(e),e=t.extend(e,{source:i})}if(!this._validate(t.validateStyle.terrain,"terrain",e)){if(this.terrain){const i=this.terrain,n=i.get();for(const o in e)if(!r(e[o],n[o])){i.set(e),this.stylesheet.terrain=e;const n={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};i.updateTransitions(n);break}}else this._createTerrain(e);this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}}_createFog(e){const i=this.fog=new C(e);this.stylesheet.fog=e;const n={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};i.updateTransitions(n)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(e){if(this._checkLoaded(),!e)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const i=this.fog,n=i.get();for(const o in e)if(!r(e[o],n[o])){i.set(e),this.stylesheet.fog=e;const n={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};i.updateTransitions(n);break}}else this._createFog(e);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const t=this._order.filter(t=>this.isLayerDraped(this._layers[t])),e=this._order.filter(t=>!this.isLayerDraped(this._layers[t]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...e)}_createTerrain(e){const i=this.terrain=new w(e);this.stylesheet.terrain=e,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();const n={now:t.exported.now(),transition:t.extend({duration:0},this.stylesheet.transition)};i.updateTransitions(n)}_force3DLayerUpdate(){for(const t in this._layers){const e=this._layers[t];"fill-extrusion"===e.type&&this._updateLayer(e)}}_validate(e,i,n,r,o={}){return(!o||!1!==o.validate)&&Re(this,e.call(t.validateStyle,t.extend({key:i,style:this.serialize(),value:n,styleSpec:t.spec},r)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),t.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles(),this._sourceCaches[t].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(t){const e=this._getSourceCaches(t);for(const t of e)t.clearTiles()}_reloadSource(t){const e=this._getSourceCaches(t);for(const t of e)t.resume(),t.reload()}_updateSources(t){for(const e in this._sourceCaches)this._sourceCaches[e].update(t)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const e=this._sourceCaches[t];e.resume(),e.reload()}}_updatePlacement(e,i,n,r,o=!1){let a=!1,s=!1;const l={};for(const t of this._order){const i=this._layers[t];if("symbol"!==i.type)continue;if(!l[i.source]){const t=this._getLayerSourceCache(i);if(!t)continue;l[i.source]=t.getRenderableIds(!0).map(e=>t.getTileByID(e)).sort((t,e)=>e.tileID.overscaledZ-t.tileID.overscaledZ||(t.tileID.isLessThan(e.tileID)?-1:1))}const n=this.crossTileSymbolIndex.addLayer(i,l[i.source],e.center.lng);a=a||n}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),o=o||this._layerOrderChanged||0===n,this._layerOrderChanged&&this.fire(new t.Event("neworder")),(o||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(t.exported.now(),e.zoom))&&(this.pauseablePlacement=new De(e,this._order,o,i,n,r,this.placement,this.fog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(t.exported.now()),s=!0),a&&this.pauseablePlacement.placement.setStale()),s||a)for(const t of this._order){const e=this._layers[t];"symbol"===e.type&&this.placement.updateLayerOpacities(e,l[e.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(t.exported.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,e,i){this.imageManager.getImages(e.icons,i),this._updateTilesForChangedImages();const n=t=>{t&&t.setDependencies(e.tileID.key,e.type,e.icons)};n(this._otherSourceCaches[e.source]),n(this._symbolSourceCaches[e.source])}getGlyphs(t,e,i){this.glyphManager.getGlyphs(e.stacks,i)}getResource(e,i,n){return t.makeRequest(i,n)}_getSourceCache(t){return this._otherSourceCaches[t]}_getLayerSourceCache(t){return"symbol"===t.type?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}_getSourceCaches(t){const e=[];return this._otherSourceCaches[t]&&e.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&e.push(this._symbolSourceCaches[t]),e}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}}Ue.getSourceType=function(t){return Mt[t]},Ue.setSourceType=function(t,e){Mt[t]=e},Ue.registerForPluginStateChange=t.registerForPluginStateChange;var Ge="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}\n#endif",$e="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let We={},He={};We=Xe("","\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef TERRAIN\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);}float prevElevation(vec2 apos) {float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nfloat unpack_depth(vec4 rgba_depth)\n{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",!0),He=Xe("#ifdef FOG\nuniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif","#ifdef FOG\nuniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",!0);const je=Xe("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),Ze=Ge;var qe={background:Xe("uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Xe("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Xe("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);vec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Xe("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Xe("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\ngl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec3 pos=vec3(floor(a_pos*0.5)+extrude,elevation(floor(a_pos*0.5)));gl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Xe("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Xe("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=u_matrix*vec4(a_pos,elevation(a_pos),1.0);gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Xe("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Xe("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);}"),fill:Xe("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Xe("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Xe("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Xe("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Xe("varying vec4 v_color;void main() {vec4 color=v_color;\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;\n#ifdef TERRAIN\nvec2 centroid_pos=a_centroid_pos;bool flat_roof=centroid_pos.x !=0.0;float ele=elevation(pos_nx.xy);float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#else\nvec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);gl_Position=u_matrix*vec4(pos,1);\n#endif\nfloat colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Xe("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;\n#ifdef TERRAIN\nvec2 centroid_pos=a_centroid_pos;bool flat_roof=centroid_pos.x !=0.0;float ele=elevation(pos_nx.xy);float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);\n#else\nvec3 p=vec3(pos_nx.xy,z);gl_Position=u_matrix*vec4(p,1);\n#endif\nvec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Xe("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Xe("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Xe("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),lineGradient:Xe("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Xe("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),lineSDF:Xe("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dash_from\n#pragma mapbox: initialize mediump vec4 dash_to\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);vec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dash_from\n#pragma mapbox: initialize mediump vec4 dash_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nfloat tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float widthA=dash_from.z*fromScale;float widthB=dash_to.z*toScale;float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*(tileZoomRatio/widthA)/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*(tileZoomRatio/widthB)/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);v_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Xe("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Xe("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));}"),symbolSDF:Xe("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:Xe("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrainRaster:Xe("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef FOG\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n}"),terrainDepth:Xe("#ifdef GL_ES\nprecision highp float;\n#endif\nvec4 pack_depth(float ndc_z) {float depth=ndc_z*0.5+0.5;const vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Xe("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",$e),skyboxGradient:Xe("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform lowp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",$e),skyboxCapture:Xe("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}")};function Xe(t,e,i){const n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,o=e.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),a=t.match(r),s=e.match(r),l=Ge.match(r);let u=s?s.concat(a):a;i||(We.staticUniforms&&(u=We.staticUniforms.concat(u)),He.staticUniforms&&(u=He.staticUniforms.concat(u))),u&&(u=u.concat(l));const c={};return{fragmentSource:t=t.replace(n,(t,e,i,n,r)=>(c[r]=!0,"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nvarying ${i} ${n} ${r};\n#else\nuniform ${i} ${n} u_${r};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${r}\n    ${i} ${n} ${r} = u_${r};\n#endif\n`)),vertexSource:e=e.replace(n,(t,e,i,n,r)=>{const o="float"===n?"vec2":"vec4",a=r.match(/color/)?"color":o;return c[r]?"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nuniform lowp float u_${r}_t;\nattribute ${i} ${o} a_${r};\nvarying ${i} ${n} ${r};\n#else\nuniform ${i} ${n} u_${r};\n#endif\n`:"vec4"===a?`\n#ifndef HAS_UNIFORM_u_${r}\n    ${r} = a_${r};\n#else\n    ${i} ${n} ${r} = u_${r};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${r}\n    ${r} = unpack_mix_${a}(a_${r}, u_${r}_t);\n#else\n    ${i} ${n} ${r} = u_${r};\n#endif\n`:"define"===e?`\n#ifndef HAS_UNIFORM_u_${r}\nuniform lowp float u_${r}_t;\nattribute ${i} ${o} a_${r};\n#else\nuniform ${i} ${n} u_${r};\n#endif\n`:"vec4"===a?`\n#ifndef HAS_UNIFORM_u_${r}\n    ${i} ${n} ${r} = a_${r};\n#else\n    ${i} ${n} ${r} = u_${r};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${r}\n    ${i} ${n} ${r} = unpack_mix_${a}(a_${r}, u_${r}_t);\n#else\n    ${i} ${n} ${r} = u_${r};\n#endif\n`}),staticAttributes:o,staticUniforms:u}}class Ye{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,e,i,n,r,o,a,s){this.context=t;let l=this.boundPaintVertexBuffers.length!==n.length;for(let t=0;!l&&t<n.length;t++)this.boundPaintVertexBuffers[t]!==n[t]&&(l=!0);t.extVertexArrayObject&&this.vao&&this.boundProgram===e&&this.boundLayoutVertexBuffer===i&&!l&&this.boundIndexBuffer===r&&this.boundVertexOffset===o&&this.boundDynamicVertexBuffer===a&&this.boundDynamicVertexBuffer2===s?(t.bindVertexArrayOES.set(this.vao),a&&a.bind(),r&&r.dynamicDraw&&r.bind(),s&&s.bind()):this.freshBind(e,i,n,r,o,a,s)}freshBind(t,e,i,n,r,o,a){let s;const l=t.numAttributes,u=this.context,c=u.gl;if(u.extVertexArrayObject)this.vao&&this.destroy(),this.vao=u.extVertexArrayObject.createVertexArrayOES(),u.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=t,this.boundLayoutVertexBuffer=e,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=n,this.boundVertexOffset=r,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=a;else{s=u.currentNumAttributes||0;for(let t=l;t<s;t++)c.disableVertexAttribArray(t)}e.enableAttributes(c,t);for(const e of i)e.enableAttributes(c,t);o&&o.enableAttributes(c,t),a&&a.enableAttributes(c,t),e.bind(),e.setVertexAttribPointers(c,t,r);for(const e of i)e.bind(),e.setVertexAttribPointers(c,t,r);o&&(o.bind(),o.setVertexAttribPointers(c,t,r)),n&&n.bind(),a&&(a.bind(),a.setVertexAttribPointers(c,t,r)),u.currentNumAttributes=l}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Ke(e,i){const n=Math.pow(2,i.canonical.z),r=i.canonical.y;return[new t.MercatorCoordinate(0,r/n).toLngLat().lat,new t.MercatorCoordinate(0,(r+1)/n).toLngLat().lat]}function Je(e,i,n,r,o,a,s){const l=e.context,u=l.gl,c=n.fbo;if(!c)return;e.prepareDrawTile(i);const h=e.useProgram("hillshade");l.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,c.colorAttachment.get());const p=((t,e,i,n)=>{const r=i.paint.get("hillshade-shadow-color"),o=i.paint.get("hillshade-highlight-color"),a=i.paint.get("hillshade-accent-color");let s=i.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===i.paint.get("hillshade-illumination-anchor")&&(s-=t.transform.angle);const l=!t.options.moving;return{u_matrix:n||t.transform.calculateProjMatrix(e.tileID.toUnwrapped(),l),u_image:0,u_latrange:Ke(0,e.tileID),u_light:[i.paint.get("hillshade-exaggeration"),s],u_shadow:r,u_highlight:o,u_accent:a}})(e,n,r,e.terrain?i.projMatrix:null);e.prepareDrawProgram(l,h,i.toUnwrapped()),h.draw(l,u.TRIANGLES,o,a,s,t.CullFaceMode.disabled,p,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}function Qe(e,i,n){if(!i.needsDEMTextureUpload)return;const r=e.context,o=r.gl;r.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||e.getTileTexture(n.stride);const a=n.getPixels();i.demTexture?i.demTexture.update(a,{premultiply:!1}):i.demTexture=new t.Texture(r,a,o.RGBA,{premultiply:!1}),i.needsDEMTextureUpload=!1}function ti(e,i,n,r,o,a){const s=e.context,l=s.gl;if(!i.dem)return;const u=i.dem;if(s.activeTexture.set(l.TEXTURE1),Qe(e,i,u),!i.demTexture)return;i.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);const c=u.dim;s.activeTexture.set(l.TEXTURE0);let h=i.fbo;if(!h){const e=new t.Texture(s,{width:c,height:c,data:null},l.RGBA);e.bind(l.LINEAR,l.CLAMP_TO_EDGE),(h=i.fbo=s.createFramebuffer(c,c,!0)).colorAttachment.set(e.texture)}s.bindFramebuffer.set(h.framebuffer),s.viewport.set([0,0,c,c]),e.useProgram("hillshadePrepare").draw(s,l.TRIANGLES,r,o,a,t.CullFaceMode.disabled,((e,i)=>{const n=i.stride,r=t.create$1();return t.ortho(r,0,t.EXTENT,-t.EXTENT,0,0,1),t.translate(r,r,[0,-t.EXTENT,0]),{u_matrix:r,u_image:1,u_dimension:[n,n],u_zoom:e.overscaledZ,u_unpack:i.unpackVector}})(i.tileID,u),n.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),i.needsHillshadePrepare=!1}const ei=(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_image0:new t.Uniform1i(e,i.u_image0),u_skirt_height:new t.Uniform1f(e,i.u_skirt_height)}),ii=(t,e)=>({u_matrix:t,u_image0:0,u_skirt_height:e}),ni=new class{constructor(){this.operations={}}newMorphing(t,e,i,n,r){if(t in this.operations){const e=this.operations[t];e.to.tileID.key!==i.tileID.key&&(e.queued=i)}else this.operations[t]={startTime:n,phase:0,duration:r,from:e,to:i,queued:null}}getMorphValuesForProxy(t){if(!(t in this.operations))return null;const e=this.operations[t];return{from:e.from,to:e.to,phase:e.phase}}update(t){for(const e in this.operations){const i=this.operations[e];for(i.phase=(t-i.startTime)/i.duration;i.phase>=1||!this._validOp(i);)if(!this._nextOp(i,t)){delete this.operations[e];break}}}_nextOp(t,e){return!!t.queued&&(t.from=t.to,t.to=t.queued,t.queued=null,t.phase=0,t.startTime=e,!0)}_validOp(t){return t.from.hasData()&&t.to.hasData()}},ri={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function oi(e,i,n,r,o){const a=e.context,s=a.gl;let l,u;const c=e.options.showTerrainWireframe?2:0,h=(t,i)=>{if(u===t)return;const n=[ri[t]];i&&n.push(ri[c]),l=e.useProgram("terrainRaster",null,n),u=t},p=e.colorModeForRenderPass(),d=new t.DepthMode(s.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D);ni.update(o);const f=e.transform,m=6*Math.pow(1.5,22-f.zoom)*i.exaggeration();(c?[!1,!0]:[!1]).forEach(c=>{u=-1;const g=c?s.LINES:s.TRIANGLES,[y,v]=c?i.getWirefameBuffer():[i.gridIndexBuffer,i.gridSegments];for(const u of r){const r=n.getTile(u),b=t.StencilMode.disabled,w=i.prevTerrainTileForTile[u.key],S=i.terrainTileForTile[u.key];x=S,null!=(_=w)&&null!=x&&_.hasData()&&x.hasData()&&null!=_.demTexture&&null!=x.demTexture&&_.tileID.key!==x.tileID.key&&ni.newMorphing(u.key,w,S,o,250),a.activeTexture.set(s.TEXTURE0),r.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST);const T=ni.getMorphValuesForProxy(u.key),M=T?1:0;let I;T&&(I={morphing:{srcDemTile:T.from,dstDemTile:T.to,phase:t.easeCubicInOut(T.phase)}});const C=ii(u.projMatrix,ai(u.canonical,f.renderWorldCopies)?m/10:m);h(M,c),i.setupElevationDraw(r,l,I),e.prepareDrawProgram(a,l,u.toUnwrapped()),l.draw(a,g,d,b,p,t.CullFaceMode.backCCW,C,"terrain_raster",i.gridBuffer,y,v)}var _,x})}function ai(t,e){const i=1<<t.z;return!e&&(0===t.x||t.x===i-1)||0===t.y||t.y===i-1}const si=t=>({u_matrix:t});function li(e,i,n,r,o){if(o>0){const a=t.exported.now(),s=(a-e.timeAdded)/o,l=i?(a-i.timeAdded)/o:-1,u=n.getSource(),c=r.coveringZoomLevel({tileSize:u.tileSize,roundZoom:u.roundZoom}),h=!i||Math.abs(i.tileID.overscaledZ-c)>Math.abs(e.tileID.overscaledZ-c),p=h&&e.refreshedUponExpiration?1:t.clamp(h?s:1-l,0,1);return e.refreshedUponExpiration&&s>=1&&(e.refreshedUponExpiration=!1),i?{opacity:1,mix:1-p}:{opacity:p,mix:0}}return{opacity:1,mix:0}}class ui extends t.SourceCache{constructor(t){const e=It("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new A(Ot(),null),t.style);super("proxy",e,!1),e.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(e,i,n){if(e.freezeTileCoverage)return;this.transform=e;const r=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((i,n)=>{if(i[n.key]="",!this._tiles[n.key]){const i=new t.Tile(n,this._source.tileSize*n.overscaleFactor(),e.tileZoom);i.state="loaded",this._tiles[n.key]=i}return i},{});for(const t in this._tiles)t in r||(this.freeFBO(t),this._tiles[t].state="unloaded",delete this._tiles[t])}freeFBO(t){const e=this.proxyCachedFBO[t];if(void 0!==e){const i=Object.values(e);this.renderCachePool.push(...i),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class ci extends t.OverscaledTileID{constructor(t,e,i){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=e,this.projMatrix=i}}class hi extends t.Elevation{constructor(e,i){super(),this.painter=e,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[n,r,o]=function(e){const i=new t.StructArrayLayout4i8,n=new t.StructArrayLayout3ui6,r=131;i.reserve(17161),n.reserve(33800);const o=t.EXTENT/128,a=t.EXTENT+o/2,s=a+o;for(let e=-o;e<s;e+=o)for(let n=-o;n<s;n+=o){const r=n<0||n>a||e<0||e>a?24575:0,o=t.clamp(Math.round(n),0,t.EXTENT),s=t.clamp(Math.round(e),0,t.EXTENT);i.emplaceBack(o+r,s,o,s)}const l=(t,e)=>{const i=e*r+t;n.emplaceBack(i+1,i,i+r),n.emplaceBack(i+r,i+r+1,i+1)};for(let t=1;t<129;t++)for(let e=1;e<129;e++)l(e,t);return[0,129].forEach(t=>{for(let e=0;e<130;e++)l(e,t),l(t,e)}),[i,n,32768]}(),a=e.context;this.gridBuffer=a.createVertexBuffer(n,St.members),this.gridIndexBuffer=a.createIndexBuffer(r),this.gridSegments=t.SegmentVector.simpleSegment(0,0,n.length,r.length),this.gridNoSkirtSegments=t.SegmentVector.simpleSegment(0,0,n.length,o),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ui(i.map),this.orthoMatrix=t.create$1(),t.ortho(this.orthoMatrix,0,t.EXTENT,0,t.EXTENT,0,1);const s=a.gl;this._overlapStencilMode=new t.StencilMode({func:s.GEQUAL,mask:255},0,255,s.KEEP,s.KEEP,s.REPLACE),this._previousZoom=e.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=i,this._useVertexMorphing=!0,this._exaggeration=1}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),t.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=t,this._checkRenderCacheEfficiency()}update(e,i,n){if(e&&e.terrain){this._style!==e&&(this.style=e),this.enabled=!0;const r=e.terrain.properties;this.sourceCache=e._getSourceCache(r.get("source")),this._exaggeration=r.get("exaggeration");const o=()=>{this.sourceCache.used&&t.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const e=this.sourceCache.getSource().tileSize/128,n=this.proxySourceCache.getSource().tileSize;this.sourceCache.update(i,e*n,!0),this._findCoveringTileCache[this.sourceCache.id]={}};this.sourceCache.usedForTerrain||(this._findCoveringTileCache[this.sourceCache.id]={},this.sourceCache.usedForTerrain=!0,o(),this._initializing=!0),o(),i.updateElevation(!n),this._findCoveringTileCache[this.proxySourceCache.id]={},this.proxySourceCache.update(i),this._emptyDEMTextureDirty=!0}else this._disable()}_checkRenderCacheEfficiency(){const e=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==e.efficiency&&t.warnOnce(`Terrain render cache efficiency is not optimal (${e.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${e.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(t){t.coord&&"source"===t.dataType?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):"style"===t.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._sourceCaches)this._style._sourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(e){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const i=this.proxySourceCache,n=this.painter.transform;this._initializing&&(this._initializing=0===n._centerAltitude&&-1===this.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(n.center),-1),this._emptyDEMTextureDirty=!this._initializing);const r=this.proxyCoords=i.getIds().map(t=>{const e=i.getTileByID(t).tileID;return e.projMatrix=n.calculateProjMatrix(e.toUnwrapped()),e});!function(e,i){const n=i.transform.pointCoordinate(i.transform.getCameraPoint()),r=new t.pointGeometry(n.x,n.y);e.sort((e,i)=>{if(i.overscaledZ-e.overscaledZ)return i.overscaledZ-e.overscaledZ;const n=new t.pointGeometry(e.canonical.x+(1<<e.canonical.z)*e.wrap,e.canonical.y),o=new t.pointGeometry(i.canonical.x+(1<<i.canonical.z)*i.wrap,i.canonical.y),a=r.mult(1<<e.canonical.z);return a.x-=.5,a.y-=.5,a.distSqr(n)-a.distSqr(o)})}(r,this.painter),this._previousZoom=n.zoom;const o=this.proxyToSource||{};this.proxyToSource={},r.forEach(t=>{this.proxyToSource[t.key]={}}),this.terrainTileForTile={};const a=this._style._sourceCaches;for(const t in a){const i=a[t];if(!i.used)continue;if(i!==this.sourceCache&&(this._findCoveringTileCache[i.id]={}),this._setupProxiedCoordsForOrtho(i,e[t],o),i.usedForTerrain)continue;const n=e[t];i.getSource().reparseOverscaled&&this._assignTerrainTiles(n)}this.proxiedCoords[i.id]=r.map(t=>new ci(t,t.key,this.orthoMatrix)),this._assignTerrainTiles(r),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(o),this.renderingToTexture=!1,this._updateTimestamp=t.exported.now();const s={};this._visibleDemTiles=[];for(const t of this.proxyCoords){const e=this.terrainTileForTile[t.key];if(!e)continue;const i=e.tileID.key;i in s||(this._visibleDemTiles.push(e),s[i]=i)}}_assignTerrainTiles(t){this._initializing||t.forEach(t=>{if(this.terrainTileForTile[t.key])return;const e=this._findTileCoveringTileID(t,this.sourceCache);e&&(this.terrainTileForTile[t.key]=e)})}_prepareDEMTextures(){const t=this.painter.context,e=t.gl;for(const i in this.terrainTileForTile){const n=this.terrainTileForTile[i],r=n.dem;!r||n.demTexture&&!n.needsDEMTextureUpload||(t.activeTexture.set(e.TEXTURE1),Qe(this.painter,n,r))}}_prepareDemTileUniforms(t,e,i,n){if(!e||null==e.demTexture)return!1;const r=t.tileID.canonical,o=Math.pow(2,e.tileID.canonical.z-r.z),a=n||"";return i[`u_dem_tl${a}`]=[r.x*o%1,r.y*o%1],i[`u_dem_scale${a}`]=o,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){let t=0;const e=this._visibleDemTiles.reduce((e,i)=>{if(!i.dem)return e;const n=i.dem.tree.minimums[0];return n>0&&t++,e+n},0);return t?e/t:0}_updateEmptyDEMTexture(){const e=this.painter.context,i=e.gl;e.activeTexture.set(i.TEXTURE2);const n=this._getLoadedAreaMinimum(),r={width:1,height:1,data:new Uint8Array(t.DEMData.pack(n,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;let o=this._emptyDEMTexture;return o?o.update(r,{premultiply:!1}):o=this._emptyDEMTexture=new t.Texture(e,r,i.RGBA,{premultiply:!1}),o}setupElevationDraw(e,i,n){const r=this.painter.context,o=r.gl,a=(s=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:t.DEMData.getUnpackVector(s),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var s;a.u_dem_size=this.sourceCache.getSource().tileSize,a.u_exaggeration=this.exaggeration();let l=null,u=null,c=1;if(n&&n.morphing&&this._useVertexMorphing){const t=n.morphing.srcDemTile,i=n.morphing.dstDemTile;c=n.morphing.phase,t&&i&&(this._prepareDemTileUniforms(e,t,a,"_prev")&&(u=t),this._prepareDemTileUniforms(e,i,a)&&(l=i))}if(u&&l?(r.activeTexture.set(o.TEXTURE2),l.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),r.activeTexture.set(o.TEXTURE4),u.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),a.u_dem_lerp=c):(l=this.terrainTileForTile[e.tileID.key],r.activeTexture.set(o.TEXTURE2),(this._prepareDemTileUniforms(e,l,a)?l.demTexture:this.emptyDEMTexture).bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST)),n&&n.useDepthForOcclusion&&(r.activeTexture.set(o.TEXTURE3),this._depthTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),a.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]),n&&n.useMeterToDem&&l){const e=(1<<l.tileID.canonical.z)*t.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;a.u_meter_to_dem=e}n&&n.labelPlaneMatrixInv&&(a.u_label_plane_matrix_inv=n.labelPlaneMatrixInv),i.setTerrainUniformValues(r,a)}renderBatch(e){if(0===this._drapedRenderBatches.length)return e+1;this.renderingToTexture=!0;const i=this.painter,n=this.painter.context,r=this.proxySourceCache,o=this.proxiedCoords[r.id],a=()=>{n.bindFramebuffer.set(null),n.viewport.set([0,0,i.width,i.height]),this.renderingToTexture=!1},s=this._drapedRenderBatches.shift();let l=[];const u=i.style.order;let c=0;for(let h=0;h<o.length;h++){const p=o[h],d=r.getTileByID(p.proxyTileKey),f=r.proxyCachedFBO[p.key]?r.proxyCachedFBO[p.key][e]:void 0;let m,g;if(m=this.currentFBO=void 0!==f?r.renderCache[f]:this.pool[c++],d.texture=m.tex,void 0===f||m.dirty){n.bindFramebuffer.set(m.fb.framebuffer),this.renderedToTile=!1,m.dirty&&(n.clear({color:t.Color.transparent}),m.dirty=!1);for(let t=s.start;t<=s.end;++t){const e=i.style._layers[u[t]];if(e.isHidden(i.transform.zoom))continue;const r=i.style._getLayerSourceCache(e),o=r?this.proxyToSource[p.key][r.id]:[p];if(!o)continue;const a=o;n.viewport.set([0,0,m.fb.width,m.fb.height]),g!==(r?r.id:null)&&(this._setupStencil(o,e,r),g=r?r.id:null),i.renderLayer(i,r,e,a)}m.dirty=this.renderedToTile,this.renderedToTile&&l.push(d.tileID),5===c&&(c=0,l.length>0&&(a(),oi(i,this,r,l,this._updateTimestamp),this.renderingToTexture=!0,l=[]))}else l.push(d.tileID)}return a(),l.length>0&&oi(i,this,r,l,this._updateTimestamp),s.end+1}postRender(){}renderCacheEfficiency(t){const e=t.order.length;if(0===e)return{efficiency:100};let i,n=0,r=0,o=!1;for(let a=0;a<e;++a){const e=t._layers[t.order[a]];this._style.isLayerDraped(e)?(o&&++n,++r):o||(o=!0,i=e.id)}return 0===r?{efficiency:100}:{efficiency:100*(1-n/r),firstUndrapedLayer:i}}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(t=>t.dem).forEach(e=>{t=Math.min(t,e.dem.tree.minimums[0])}),0===t?t:(t-30)*this._exaggeration}raycast(t,e,i){if(!this._visibleDemTiles)return null;const n=this._visibleDemTiles.filter(t=>t.dem).map(n=>{const r=n.tileID,o=Math.pow(2,r.overscaledZ),{x:a,y:s}=r.canonical,l=a/o,u=(a+1)/o,c=s/o,h=(s+1)/o;return{minx:l,miny:c,maxx:u,maxy:h,t:n.dem.tree.raycastRoot(l,c,u,h,t,e,i),tile:n}});n.sort((t,e)=>(null!==t.t?t.t:Number.MAX_VALUE)-(null!==e.t?e.t:Number.MAX_VALUE));for(const r of n){if(null==r.t)return null;const n=r.tile.dem.tree.raycast(r.minx,r.miny,r.maxx,r.maxy,t,e,i);if(null!=n)return n}return null}_createFBO(){const e=this.painter.context,i=e.gl,n=this.drapeBufferSize;e.activeTexture.set(i.TEXTURE0);const r=new t.Texture(e,{width:n[0],height:n[1],data:null},i.RGBA);r.bind(i.LINEAR,i.CLAMP_TO_EDGE);const o=e.createFramebuffer(n[0],n[1],!1);return o.colorAttachment.set(r.texture),o.depthAttachment=new vt(e,o.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=e.createRenderbuffer(e.gl.DEPTH_STENCIL,n[0],n[1]),this._stencilRef=0,o.depthAttachment.set(this._sharedDepthStencil),e.clear({stencil:0})):o.depthAttachment.set(this._sharedDepthStencil),e.extTextureFilterAnisotropic&&!e.extTextureFilterAnisotropicForceOff&&i.texParameterf(i.TEXTURE_2D,e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.extTextureFilterAnisotropicMax),{fb:o,tex:r,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const t in this._style._sourceCaches)if(this._style._sourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const e=this._style._layers[t],i=e.isHidden(this.painter.transform.zoom),n=e.getCrossfadeParameters(),r=!!n&&1!==n.t,o=e.hasTransition();return"custom"!==e.type&&!i&&(r||o)})}_clearRasterFadeFromRenderCache(){let t=!1;for(const e in this._style._sourceCaches)if(this._style._sourceCaches[e]._source instanceof bt){t=!0;break}if(t)for(let t=0;t<this._style.order.length;++t){const e=this._style._layers[this._style.order[t]],i=e.isHidden(this.painter.transform.zoom),n=this._style._getLayerSourceCache(e);if("raster"!==e.type||i||!n)continue;const r=e.paint.get("raster-fade-duration");for(const t of this.proxyCoords){const e=this.proxyToSource[t.key][n.id];if(e)for(const t of e){const e=li(n.getTile(t),n.findLoadedParent(t,0),n,this.painter.transform,r);(1!==e.opacity||0!==e.mix)&&this._clearRenderCacheForTile(n.id,t)}}}}_setupDrapedRenderBatches(){const t=this._style.order,e=t.length;if(0===e)return;const i=[];let n,r=0,o=this._style._layers[t[r]];for(;!this._style.isLayerDraped(o)&&o.isHidden(this.painter.transform.zoom)&&++r<e;)o=this._style._layers[t[r]];for(;r<e;++r){const e=this._style._layers[t[r]];e.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(e)?void 0===n&&(n=r):void 0!==n&&(i.push({start:n,end:r-1}),n=void 0))}void 0!==n&&i.push({start:n,end:r-1}),this._drapedRenderBatches=i}_setupRenderCache(t){const e=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,e.renderCache.length>e.renderCachePool.length){const t=Object.values(e.proxyCachedFBO);e.proxyCachedFBO={};for(let i=0;i<t.length;++i){const n=Object.values(t[i]);e.renderCachePool.push(...n)}}return}this._clearRasterFadeFromRenderCache();const i=this.proxyCoords,n=this._tilesDirty;for(let r=i.length-1;r>=0;r--){const o=i[r];if(e.getTileByID(o.key),void 0!==e.proxyCachedFBO[o.key]){const i=t[o.key],r=this.proxyToSource[o.key];let a=0;for(const t in r){const e=r[t],o=i[t];if(!o||o.length!==e.length||e.some((e,i)=>e!==o[i]||n[t]&&n[t].hasOwnProperty(e.key))){a=-1;break}++a}for(const t in e.proxyCachedFBO[o.key])e.renderCache[e.proxyCachedFBO[o.key][t]].dirty=a<0||a!==Object.values(i).length}else for(let t=0;t<this._drapedRenderBatches.length;++t){const i=this._drapedRenderBatches[t];let n=e.renderCachePool.pop();void 0===n&&e.renderCache.length<50&&(n=e.renderCache.length,e.renderCache.push(this._createFBO())),void 0!==n&&(void 0===e.proxyCachedFBO[o.key]&&(e.proxyCachedFBO[o.key]={}),e.proxyCachedFBO[o.key][i.start]=n,e.renderCache[n].dirty=!0)}}this._tilesDirty={}}_setupStencil(t,e,i){if(!i||!this._sourceTilesOverlap[i.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const n=this.painter.context,r=n.gl;if(t.length<=1)return void(this._overlapStencilType=!1);let o;if(e.isTileClipped())o=t.length,this._overlapStencilMode.test={func:r.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(t[0].overscaledZ>t[t.length-1].overscaledZ))return void(this._overlapStencilType=!1);o=1,this._overlapStencilMode.test={func:r.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+o>255&&(n.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=o,this._overlapStencilMode.ref=this._stencilRef,e.isTileClipped()&&this._renderTileClippingMasks(t,this._overlapStencilMode.ref)}stencilModeForRTTOverlap(e){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[e.key]),this._overlapStencilMode):t.StencilMode.disabled}_renderTileClippingMasks(e,i){const n=this.painter,r=this.painter.context,o=r.gl;n._tileClippingMaskIDs={},r.setColorMode(t.ColorMode.disabled),r.setDepthMode(t.DepthMode.disabled);const a=n.useProgram("clippingMask");for(const s of e){const e=n._tileClippingMaskIDs[s.key]=--i;a.draw(r,o.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:o.ALWAYS,mask:0},e,255,o.KEEP,o.KEEP,o.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,si(s.projMatrix),"$clipping",n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}pointCoordinate(e){const i=this.painter.transform;if(e.x<0||e.x>i.width||e.y<0||e.y>i.height)return null;const n=[e.x,e.y,1,1];t.transformMat4(n,n,i.pixelMatrixInverse),t.scale$2(n,n,1/n[3]),n[0]/=i.worldSize,n[1]/=i.worldSize;const r=i._camera.position,o=t.mercatorZfromAltitude(1,i.center.lat),a=[r[0],r[1],r[2]/o,0],s=t.subtract([],n.slice(0,3),a);t.normalize(s,s);const l=this.raycast(a,s,this._exaggeration);return null!==l&&l?(t.scaleAndAdd(a,a,s,l),a[3]=a[2],a[2]*=o,a):null}drawDepth(){const e=this.painter,i=e.context,n=this.proxySourceCache,r=Math.ceil(e.width),o=Math.ceil(e.height);if(!this._depthFBO||this._depthFBO.width===r&&this._depthFBO.height===o||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){const e=i.gl,n=i.createFramebuffer(r,o,!0);i.activeTexture.set(e.TEXTURE0);const a=new t.Texture(i,{width:r,height:o,data:null},e.RGBA);a.bind(e.NEAREST,e.CLAMP_TO_EDGE),n.colorAttachment.set(a.texture);const s=i.createRenderbuffer(i.gl.DEPTH_COMPONENT16,r,o);n.depthAttachment.set(s),this._depthFBO=n,this._depthTexture=a}i.bindFramebuffer.set(this._depthFBO.framebuffer),i.viewport.set([0,0,r,o]),function(e,i,n,r){const o=e.context,a=o.gl;o.clear({depth:1});const s=e.useProgram("terrainDepth"),l=new t.DepthMode(a.LESS,t.DepthMode.ReadWrite,e.depthRangeFor3D);for(const e of r){const r=n.getTile(e),u=ii(e.projMatrix,0);i.setupElevationDraw(r,s),s.draw(o,a.TRIANGLES,l,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.backCCW,u,"terrain_depth",i.gridBuffer,i.gridIndexBuffer,i.gridNoSkirtSegments)}}(e,this,n,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,e,i){if(t.getSource()instanceof Tt)return this._setupProxiedCoordsForImageSource(t,e,i);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const n=this.proxiedCoords[t.id]=[],r=this.proxyCoords;for(let e=0;e<r.length;e++){const o=r[e],a=this._findTileCoveringTileID(o,t);if(a){const e=this._createProxiedId(o,a,i[o.key]&&i[o.key][t.id]);n.push(e),this.proxyToSource[o.key][t.id]=[e]}}let o=!1;for(let r=0;r<e.length;r++){const a=t.getTile(e[r]);if(!a||!a.hasData())continue;const s=this._findTileCoveringTileID(a.tileID,this.proxySourceCache);if(s&&s.tileID.canonical.z!==a.tileID.canonical.z){const e=this.proxyToSource[s.tileID.key][t.id],r=this._createProxiedId(s.tileID,a,i[s.tileID.key]&&i[s.tileID.key][t.id]);e?e.splice(e.length-1,0,r):this.proxyToSource[s.tileID.key][t.id]=[r],n.push(r),o=!0}}this._sourceTilesOverlap[t.id]=o}_setupProxiedCoordsForImageSource(e,i,n){if(!e.getSource().loaded())return;const r=this.proxiedCoords[e.id]=[],o=this.proxyCoords,a=e.getSource(),s=new t.pointGeometry(a.tileID.x,a.tileID.y)._div(1<<a.tileID.z),l=a.coordinates.map(t.MercatorCoordinate.fromLngLat).reduce((t,e)=>(t.min.x=Math.min(t.min.x,e.x-s.x),t.min.y=Math.min(t.min.y,e.y-s.y),t.max.x=Math.max(t.max.x,e.x-s.x),t.max.y=Math.max(t.max.y,e.y-s.y),t),{min:new t.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new t.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),u=(e,i)=>{const n=e.wrap+e.canonical.x/(1<<e.canonical.z),r=e.canonical.y/(1<<e.canonical.z),o=t.EXTENT/(1<<e.canonical.z),a=i.wrap+i.canonical.x/(1<<i.canonical.z),s=i.canonical.y/(1<<i.canonical.z);return n+o<a+l.min.x||n>a+l.max.x||r+o<s+l.min.y||r>s+l.max.y};for(let t=0;t<o.length;t++){const a=o[t];for(let t=0;t<i.length;t++){const o=e.getTile(i[t]);if(!o||!o.hasData())continue;if(u(a,o.tileID))continue;const s=this._createProxiedId(a,o,n[a.key]&&n[a.key][e.id]),l=this.proxyToSource[a.key][e.id];l?l.push(s):this.proxyToSource[a.key][e.id]=[s],r.push(s)}}}_createProxiedId(e,i,n){let r=this.orthoMatrix;if(n){const t=n.find(t=>t.key===i.tileID.key);if(t)return t}if(i.tileID.key!==e.key){const n=e.canonical.z-i.tileID.canonical.z;let o,a,s;r=t.create$1();const l=i.tileID.wrap-e.wrap<<e.overscaledZ;n>0?(a=(o=t.EXTENT>>n)*((i.tileID.canonical.x<<n)-e.canonical.x+l),s=o*((i.tileID.canonical.y<<n)-e.canonical.y)):(o=t.EXTENT<<-n,a=t.EXTENT*(i.tileID.canonical.x-(e.canonical.x+l<<-n)),s=t.EXTENT*(i.tileID.canonical.y-(e.canonical.y<<-n))),t.ortho(r,0,o,0,o,0,1),t.translate(r,r,[a,s,0])}return new ci(i.tileID,e.key,r)}_findTileCoveringTileID(e,i){let n=i.getTile(e);if(n&&n.hasData())return n;const r=this._findCoveringTileCache[i.id],o=r[e.key];if((n=o?i.getTileByID(o):null)&&n.hasData()||null===o)return n;let a=n?n.tileID:e,s=a.overscaledZ;const l=i.getSource().minzoom,u=[];if(!o){const r=i.getSource().maxzoom;if(e.canonical.z>=r){const n=e.canonical.z-r;i.getSource().reparseOverscaled?(s=Math.max(e.canonical.z+2,i.transform.tileZoom),a=new t.OverscaledTileID(s,e.wrap,r,e.canonical.x>>n,e.canonical.y>>n)):0!==n&&(s=r,a=new t.OverscaledTileID(s,e.wrap,r,e.canonical.x>>n,e.canonical.y>>n))}a.key!==e.key&&(u.push(a.key),n=i.getTile(a))}const c=t=>{u.forEach(e=>{r[e]=t}),u.length=0};for(s-=1;s>=l&&(!n||!n.hasData());s--){n&&c(n.tileID.key);const t=a.calculateScaledKey(s);if((n=i.getTileByID(t))&&n.hasData())break;const e=r[t];if(null===e)break;void 0===e?u.push(t):n=i.getTileByID(e)}return c(n?n.tileID.key:null),n&&n.hasData()?n:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(t){this.renderedToTile||(this.renderedToTile=!0)}_clearRenderCacheForTile(t,e){let i=this._tilesDirty[t];i||(i=this._tilesDirty[t]={}),i[e.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const e=function(e){let i,n,r;const o=new t.StructArrayLayout2ui4,a=131;for(n=1;n<129;n++){for(i=1;i<129;i++)r=n*a+i,o.emplaceBack(r,r+1),o.emplaceBack(r,r+a),o.emplaceBack(r+1,r+a),128===n&&o.emplaceBack(r+a,r+a+1);o.emplaceBack(r+1,r+1+a)}return o}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(e),this.wireframeSegments=t.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,e.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function pi(t){const e=[];for(let i=0;i<t.length;i++){if(null===t[i])continue;const n=t[i].split(" ");e.push(n.pop())}return e}class di{static cacheKey(t,e,i){let n=`${t}${i?i.cacheKey:""}`;for(const t of e)n+=`/${t}`;return n}constructor(e,i,n,r,o,a){const s=e.gl;this.program=s.createProgram();const l=pi(n.staticAttributes),u=r?r.getBinderAttributes():[],c=l.concat(u),h=n.staticUniforms?pi(n.staticUniforms):[],p=r?r.getBinderUniforms():[],d=h.concat(p),f=[];for(const t of d)f.indexOf(t)<0&&f.push(t);let m=r?r.defines():[];const g=(m=m.concat(a.map(t=>`#define ${t}`))).concat(je.fragmentSource,Ze,He.fragmentSource,n.fragmentSource).join("\n"),y=m.concat(je.vertexSource,Ze,He.vertexSource,We.vertexSource,n.vertexSource).join("\n"),v=s.createShader(s.FRAGMENT_SHADER);if(s.isContextLost())return void(this.failedToCreate=!0);s.shaderSource(v,g),s.compileShader(v),s.attachShader(this.program,v);const _=s.createShader(s.VERTEX_SHADER);if(s.isContextLost())return void(this.failedToCreate=!0);s.shaderSource(_,y),s.compileShader(_),s.attachShader(this.program,_),this.attributes={};const x={};this.numAttributes=c.length;for(let t=0;t<this.numAttributes;t++)c[t]&&(s.bindAttribLocation(this.program,t,c[t]),this.attributes[c[t]]=t);s.linkProgram(this.program),s.deleteShader(_),s.deleteShader(v);for(let t=0;t<f.length;t++){const e=f[t];if(e&&!x[e]){const t=s.getUniformLocation(this.program,e);t&&(x[e]=t)}}this.fixedUniforms=o(e,x),this.binderUniforms=r?r.getUniforms(e,x):[],-1!==a.indexOf("TERRAIN")&&(this.terrainUniforms=((e,i)=>({u_dem:new t.Uniform1i(e,i.u_dem),u_dem_prev:new t.Uniform1i(e,i.u_dem_prev),u_dem_unpack:new t.Uniform4f(e,i.u_dem_unpack),u_dem_tl:new t.Uniform2f(e,i.u_dem_tl),u_dem_scale:new t.Uniform1f(e,i.u_dem_scale),u_dem_tl_prev:new t.Uniform2f(e,i.u_dem_tl_prev),u_dem_scale_prev:new t.Uniform1f(e,i.u_dem_scale_prev),u_dem_size:new t.Uniform1f(e,i.u_dem_size),u_dem_lerp:new t.Uniform1f(e,i.u_dem_lerp),u_exaggeration:new t.Uniform1f(e,i.u_exaggeration),u_depth:new t.Uniform1i(e,i.u_depth),u_depth_size_inv:new t.Uniform2f(e,i.u_depth_size_inv),u_meter_to_dem:new t.Uniform1f(e,i.u_meter_to_dem),u_label_plane_matrix_inv:new t.UniformMatrix4f(e,i.u_label_plane_matrix_inv)}))(e,x)),-1!==a.indexOf("FOG")&&(this.fogUniforms=((e,i)=>({u_fog_matrix:new t.UniformMatrix4f(e,i.u_fog_matrix),u_fog_range:new t.Uniform2f(e,i.u_fog_range),u_fog_color:new t.Uniform4f(e,i.u_fog_color),u_fog_horizon_blend:new t.Uniform1f(e,i.u_fog_horizon_blend),u_fog_temporal_offset:new t.Uniform1f(e,i.u_fog_temporal_offset)}))(e,x))}setTerrainUniformValues(t,e){if(!this.terrainUniforms)return;const i=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)i[t].set(e[t])}}setFogUniformValues(t,e){if(!this.fogUniforms)return;const i=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const t in e)i[t].location&&i[t].set(e[t])}}draw(t,e,i,n,r,o,a,s,l,u,c,h,p,d,f,m){const g=t.gl;if(this.failedToCreate)return;t.program.set(this.program),t.setDepthMode(i),t.setStencilMode(n),t.setColorMode(r),t.setCullFace(o);for(const t in this.fixedUniforms)this.fixedUniforms[t].set(a[t]);d&&d.setUniforms(t,this.binderUniforms,h,{zoom:p});const y={[g.LINES]:2,[g.TRIANGLES]:3,[g.LINE_STRIP]:1}[e];for(const i of c.get()){const n=i.vaos||(i.vaos={});(n[s]||(n[s]=new Ye)).bind(t,this,l,d?d.getPaintVertexBuffers():[],u,i.vertexOffset,f,m),g.drawElements(e,i.primitiveLength*y,g.UNSIGNED_SHORT,i.primitiveOffset*y*2)}}}function fi(t,e,i){const n=1/k(i,1,e.transform.tileZoom),r=Math.pow(2,i.tileID.overscaledZ),o=i.tileSize*Math.pow(2,e.transform.tileZoom)/r,a=o*(i.tileID.canonical.x+i.tileID.wrap*r),s=o*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_scale:[n,t.fromScale,t.toScale],u_fade:t.t,u_pixel_coord_upper:[a>>16,s>>16],u_pixel_coord_lower:[65535&a,65535&s]}}const mi=(e,i,n,r)=>{const o=i.style.light,a=o.properties.get("position"),s=[a.x,a.y,a.z],l=t.create$2();"viewport"===o.properties.get("anchor")&&(t.fromRotation(l,-i.transform.angle),t.transformMat3(s,s,l));const u=o.properties.get("color");return{u_matrix:e,u_lightpos:s,u_lightintensity:o.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+n,u_opacity:r}},gi=(e,i,n,r,o,a,s)=>t.extend(mi(e,i,n,r),fi(a,i,s),{u_height_factor:-Math.pow(2,o.overscaledZ)/s.tileSize/8}),yi=t=>({u_matrix:t}),vi=(e,i,n,r)=>t.extend(yi(e),fi(n,i,r)),_i=(t,e)=>({u_matrix:t,u_world:e}),xi=(e,i,n,r,o)=>t.extend(vi(e,i,n,r),{u_world:o}),bi=(e,i,n,r)=>{const o=e.transform;let a;if("map"===r.paint.get("circle-pitch-alignment")){const t=k(n,1,o.zoom);a=[t,t]}else a=o.pixelsToGLUnits;return{u_camera_to_center_distance:o.cameraToCenterDistance,u_matrix:e.translatePosMatrix(i.projMatrix,n,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_device_pixel_ratio:t.exported.devicePixelRatio,u_extrude_scale:a}},wi=t=>{const e=[];return"map"===t.paint.get("circle-pitch-alignment")&&e.push("PITCH_WITH_MAP"),"map"===t.paint.get("circle-pitch-scale")&&e.push("SCALE_WITH_MAP"),e},Si=(e,i,n)=>{const r=t.EXTENT/n.tileSize;return{u_matrix:e,u_camera_to_center_distance:i.cameraToCenterDistance,u_extrude_scale:[i.pixelsToGLUnits[0]/r,i.pixelsToGLUnits[1]/r]}},Ti=(t,e,i=1)=>({u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:i}),Mi=(t,e,i,n)=>({u_matrix:t,u_extrude_scale:k(e,1,i),u_intensity:n}),Ii=(e,i,n,r)=>{const o=e.transform;return{u_matrix:Ei(e,i,n,r),u_ratio:1/k(i,1,o.zoom),u_device_pixel_ratio:t.exported.devicePixelRatio,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},Ci=(e,i,n,r,o)=>t.extend(Ii(e,i,n,r),{u_image:0,u_image_height:o}),Ai=(e,i,n,r,o)=>{const a=e.transform,s=Di(i,a);return{u_matrix:Ei(e,i,n,o),u_texsize:i.imageAtlasTexture.size,u_ratio:1/k(i,1,a.zoom),u_device_pixel_ratio:t.exported.devicePixelRatio,u_image:0,u_scale:[s,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},ki=(e,i,n,r,o)=>{const a=Di(i,e.transform);return t.extend(Ii(e,i,n,o),{u_texsize:i.lineAtlasTexture.size,u_scale:[a,r.fromScale,r.toScale],u_image:0,u_mix:r.t})};function Di(t,e){return 1/k(t,1,e.tileZoom)}function Ei(t,e,i,n){return t.translatePosMatrix(n||e.tileID.projMatrix,e,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const Pi=(t,e,i,n,r)=>{return{u_matrix:t,u_tl_parent:e,u_scale_parent:i,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*r.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:r.paint.get("raster-brightness-min"),u_brightness_high:r.paint.get("raster-brightness-max"),u_saturation_factor:(a=r.paint.get("raster-saturation"),a>0?1-1/(1.001-a):-a),u_contrast_factor:(o=r.paint.get("raster-contrast"),o>0?1/(1-o):1+o),u_spin_weights:Li(r.paint.get("raster-hue-rotate"))};var o,a};function Li(t){const e=Math.sin(t*=Math.PI/180),i=Math.cos(t);return[(2*i+1)/3,(-Math.sqrt(3)*e-i+1)/3,(Math.sqrt(3)*e-i+1)/3]}const zi=(t,e,i,n,r,o,a,s,l,u)=>{const c=r.transform;return{u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+i,u_aspect_ratio:c.width/c.height,u_fade_change:r.options.fadeDuration?r.symbolFadeChange:1,u_matrix:o,u_label_plane_matrix:a,u_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+n,u_texsize:u,u_texture:0}},Oi=(e,i,n,r,o,a,s,l,u,c,h)=>{const{cameraToCenterDistance:p,_pitch:d}=o.transform;return t.extend(zi(e,i,n,r,o,a,s,l,u,c),{u_gamma_scale:r?p*Math.cos(o.terrain?0:d):1,u_device_pixel_ratio:t.exported.devicePixelRatio,u_is_halo:+h})},Ri=(e,i,n,r,o,a,s,l,u,c)=>t.extend(Oi(e,i,n,r,o,a,s,l,!0,u,!0),{u_texsize_icon:c,u_texture_icon:1}),Bi=(t,e,i)=>({u_matrix:t,u_opacity:e,u_color:i}),Ni=(e,i,n,r,o,a)=>t.extend(function(t,e,i,n){const r=i.imageManager.getPattern(t.from.toString()),o=i.imageManager.getPattern(t.to.toString()),{width:a,height:s}=i.imageManager.getPixelSize(),l=Math.pow(2,n.tileID.overscaledZ),u=n.tileSize*Math.pow(2,i.transform.tileZoom)/l,c=u*(n.tileID.canonical.x+n.tileID.wrap*l),h=u*n.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:r.tl,u_pattern_br_a:r.br,u_pattern_tl_b:o.tl,u_pattern_br_b:o.br,u_texsize:[a,s],u_mix:e.t,u_pattern_size_a:r.displaySize,u_pattern_size_b:o.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/k(n,1,i.transform.tileZoom),u_pixel_coord_upper:[c>>16,h>>16],u_pixel_coord_lower:[65535&c,65535&h]}}(r,a,n,o),{u_matrix:e,u_opacity:i}),Fi={fillExtrusion:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_lightpos:new t.Uniform3f(e,i.u_lightpos),u_lightintensity:new t.Uniform1f(e,i.u_lightintensity),u_lightcolor:new t.Uniform3f(e,i.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,i.u_vertical_gradient),u_opacity:new t.Uniform1f(e,i.u_opacity)}),fillExtrusionPattern:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_lightpos:new t.Uniform3f(e,i.u_lightpos),u_lightintensity:new t.Uniform1f(e,i.u_lightintensity),u_lightcolor:new t.Uniform3f(e,i.u_lightcolor),u_vertical_gradient:new t.Uniform1f(e,i.u_vertical_gradient),u_height_factor:new t.Uniform1f(e,i.u_height_factor),u_image:new t.Uniform1i(e,i.u_image),u_texsize:new t.Uniform2f(e,i.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,i.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,i.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,i.u_scale),u_fade:new t.Uniform1f(e,i.u_fade),u_opacity:new t.Uniform1f(e,i.u_opacity)}),fill:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix)}),fillPattern:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_image:new t.Uniform1i(e,i.u_image),u_texsize:new t.Uniform2f(e,i.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,i.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,i.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,i.u_scale),u_fade:new t.Uniform1f(e,i.u_fade)}),fillOutline:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_world:new t.Uniform2f(e,i.u_world)}),fillOutlinePattern:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_world:new t.Uniform2f(e,i.u_world),u_image:new t.Uniform1i(e,i.u_image),u_texsize:new t.Uniform2f(e,i.u_texsize),u_pixel_coord_upper:new t.Uniform2f(e,i.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,i.u_pixel_coord_lower),u_scale:new t.Uniform3f(e,i.u_scale),u_fade:new t.Uniform1f(e,i.u_fade)}),circle:(e,i)=>({u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_extrude_scale:new t.Uniform2f(e,i.u_extrude_scale),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_matrix:new t.UniformMatrix4f(e,i.u_matrix)}),collisionBox:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_extrude_scale:new t.Uniform2f(e,i.u_extrude_scale)}),collisionCircle:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_inv_matrix:new t.UniformMatrix4f(e,i.u_inv_matrix),u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_viewport_size:new t.Uniform2f(e,i.u_viewport_size)}),debug:(e,i)=>({u_color:new t.UniformColor(e,i.u_color),u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_overlay:new t.Uniform1i(e,i.u_overlay),u_overlay_scale:new t.Uniform1f(e,i.u_overlay_scale)}),clippingMask:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix)}),heatmap:(e,i)=>({u_extrude_scale:new t.Uniform1f(e,i.u_extrude_scale),u_intensity:new t.Uniform1f(e,i.u_intensity),u_matrix:new t.UniformMatrix4f(e,i.u_matrix)}),heatmapTexture:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_world:new t.Uniform2f(e,i.u_world),u_image:new t.Uniform1i(e,i.u_image),u_color_ramp:new t.Uniform1i(e,i.u_color_ramp),u_opacity:new t.Uniform1f(e,i.u_opacity)}),hillshade:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_image:new t.Uniform1i(e,i.u_image),u_latrange:new t.Uniform2f(e,i.u_latrange),u_light:new t.Uniform2f(e,i.u_light),u_shadow:new t.UniformColor(e,i.u_shadow),u_highlight:new t.UniformColor(e,i.u_highlight),u_accent:new t.UniformColor(e,i.u_accent)}),hillshadePrepare:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_image:new t.Uniform1i(e,i.u_image),u_dimension:new t.Uniform2f(e,i.u_dimension),u_zoom:new t.Uniform1f(e,i.u_zoom),u_unpack:new t.Uniform4f(e,i.u_unpack)}),line:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_ratio:new t.Uniform1f(e,i.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,i.u_units_to_pixels)}),lineGradient:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_ratio:new t.Uniform1f(e,i.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,i.u_units_to_pixels),u_image:new t.Uniform1i(e,i.u_image),u_image_height:new t.Uniform1f(e,i.u_image_height)}),linePattern:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_texsize:new t.Uniform2f(e,i.u_texsize),u_ratio:new t.Uniform1f(e,i.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_image:new t.Uniform1i(e,i.u_image),u_units_to_pixels:new t.Uniform2f(e,i.u_units_to_pixels),u_scale:new t.Uniform3f(e,i.u_scale),u_fade:new t.Uniform1f(e,i.u_fade)}),lineSDF:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_texsize:new t.Uniform2f(e,i.u_texsize),u_ratio:new t.Uniform1f(e,i.u_ratio),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_units_to_pixels:new t.Uniform2f(e,i.u_units_to_pixels),u_image:new t.Uniform1i(e,i.u_image),u_scale:new t.Uniform3f(e,i.u_scale),u_mix:new t.Uniform1f(e,i.u_mix)}),raster:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_tl_parent:new t.Uniform2f(e,i.u_tl_parent),u_scale_parent:new t.Uniform1f(e,i.u_scale_parent),u_buffer_scale:new t.Uniform1f(e,i.u_buffer_scale),u_fade_t:new t.Uniform1f(e,i.u_fade_t),u_opacity:new t.Uniform1f(e,i.u_opacity),u_image0:new t.Uniform1i(e,i.u_image0),u_image1:new t.Uniform1i(e,i.u_image1),u_brightness_low:new t.Uniform1f(e,i.u_brightness_low),u_brightness_high:new t.Uniform1f(e,i.u_brightness_high),u_saturation_factor:new t.Uniform1f(e,i.u_saturation_factor),u_contrast_factor:new t.Uniform1f(e,i.u_contrast_factor),u_spin_weights:new t.Uniform3f(e,i.u_spin_weights)}),symbolIcon:(e,i)=>({u_is_size_zoom_constant:new t.Uniform1i(e,i.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,i.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,i.u_size_t),u_size:new t.Uniform1f(e,i.u_size),u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,i.u_pitch),u_rotate_symbol:new t.Uniform1i(e,i.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,i.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,i.u_fade_change),u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,i.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,i.u_coord_matrix),u_is_text:new t.Uniform1i(e,i.u_is_text),u_pitch_with_map:new t.Uniform1i(e,i.u_pitch_with_map),u_texsize:new t.Uniform2f(e,i.u_texsize),u_texture:new t.Uniform1i(e,i.u_texture)}),symbolSDF:(e,i)=>({u_is_size_zoom_constant:new t.Uniform1i(e,i.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,i.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,i.u_size_t),u_size:new t.Uniform1f(e,i.u_size),u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,i.u_pitch),u_rotate_symbol:new t.Uniform1i(e,i.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,i.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,i.u_fade_change),u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,i.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,i.u_coord_matrix),u_is_text:new t.Uniform1i(e,i.u_is_text),u_pitch_with_map:new t.Uniform1i(e,i.u_pitch_with_map),u_texsize:new t.Uniform2f(e,i.u_texsize),u_texture:new t.Uniform1i(e,i.u_texture),u_gamma_scale:new t.Uniform1f(e,i.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,i.u_is_halo)}),symbolTextAndIcon:(e,i)=>({u_is_size_zoom_constant:new t.Uniform1i(e,i.u_is_size_zoom_constant),u_is_size_feature_constant:new t.Uniform1i(e,i.u_is_size_feature_constant),u_size_t:new t.Uniform1f(e,i.u_size_t),u_size:new t.Uniform1f(e,i.u_size),u_camera_to_center_distance:new t.Uniform1f(e,i.u_camera_to_center_distance),u_pitch:new t.Uniform1f(e,i.u_pitch),u_rotate_symbol:new t.Uniform1i(e,i.u_rotate_symbol),u_aspect_ratio:new t.Uniform1f(e,i.u_aspect_ratio),u_fade_change:new t.Uniform1f(e,i.u_fade_change),u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_label_plane_matrix:new t.UniformMatrix4f(e,i.u_label_plane_matrix),u_coord_matrix:new t.UniformMatrix4f(e,i.u_coord_matrix),u_is_text:new t.Uniform1i(e,i.u_is_text),u_pitch_with_map:new t.Uniform1i(e,i.u_pitch_with_map),u_texsize:new t.Uniform2f(e,i.u_texsize),u_texsize_icon:new t.Uniform2f(e,i.u_texsize_icon),u_texture:new t.Uniform1i(e,i.u_texture),u_texture_icon:new t.Uniform1i(e,i.u_texture_icon),u_gamma_scale:new t.Uniform1f(e,i.u_gamma_scale),u_device_pixel_ratio:new t.Uniform1f(e,i.u_device_pixel_ratio),u_is_halo:new t.Uniform1i(e,i.u_is_halo)}),background:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_opacity:new t.Uniform1f(e,i.u_opacity),u_color:new t.UniformColor(e,i.u_color)}),backgroundPattern:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_opacity:new t.Uniform1f(e,i.u_opacity),u_image:new t.Uniform1i(e,i.u_image),u_pattern_tl_a:new t.Uniform2f(e,i.u_pattern_tl_a),u_pattern_br_a:new t.Uniform2f(e,i.u_pattern_br_a),u_pattern_tl_b:new t.Uniform2f(e,i.u_pattern_tl_b),u_pattern_br_b:new t.Uniform2f(e,i.u_pattern_br_b),u_texsize:new t.Uniform2f(e,i.u_texsize),u_mix:new t.Uniform1f(e,i.u_mix),u_pattern_size_a:new t.Uniform2f(e,i.u_pattern_size_a),u_pattern_size_b:new t.Uniform2f(e,i.u_pattern_size_b),u_scale_a:new t.Uniform1f(e,i.u_scale_a),u_scale_b:new t.Uniform1f(e,i.u_scale_b),u_pixel_coord_upper:new t.Uniform2f(e,i.u_pixel_coord_upper),u_pixel_coord_lower:new t.Uniform2f(e,i.u_pixel_coord_lower),u_tile_units_to_pixels:new t.Uniform1f(e,i.u_tile_units_to_pixels)}),terrainRaster:ei,terrainDepth:ei,skybox:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_sun_direction:new t.Uniform3f(e,i.u_sun_direction),u_cubemap:new t.Uniform1i(e,i.u_cubemap),u_opacity:new t.Uniform1f(e,i.u_opacity),u_temporal_offset:new t.Uniform1f(e,i.u_temporal_offset)}),skyboxGradient:(e,i)=>({u_matrix:new t.UniformMatrix4f(e,i.u_matrix),u_color_ramp:new t.Uniform1i(e,i.u_color_ramp),u_center_direction:new t.Uniform3f(e,i.u_center_direction),u_radius:new t.Uniform1f(e,i.u_radius),u_opacity:new t.Uniform1f(e,i.u_opacity),u_temporal_offset:new t.Uniform1f(e,i.u_temporal_offset)}),skyboxCapture:(e,i)=>({u_matrix_3f:new t.UniformMatrix3f(e,i.u_matrix_3f),u_sun_direction:new t.Uniform3f(e,i.u_sun_direction),u_sun_intensity:new t.Uniform1f(e,i.u_sun_intensity),u_color_tint_r:new t.Uniform4f(e,i.u_color_tint_r),u_color_tint_m:new t.Uniform4f(e,i.u_color_tint_m),u_luminance:new t.Uniform1f(e,i.u_luminance)})};let Vi;function Ui(e,i,n,r,o,a,s){const l=e.context,u=l.gl,c=e.useProgram("collisionBox"),h=[];let p=0,d=0;for(let f=0;f<r.length;f++){const m=r[f],g=i.getTile(m),y=g.getBucket(n);if(!y)continue;let v=m.projMatrix;0===o[0]&&0===o[1]||(v=e.translatePosMatrix(m.projMatrix,g,o,a));const _=s?y.textCollisionBox:y.iconCollisionBox,x=y.collisionCircleArray;if(x.length>0){const i=t.create$1(),n=v;t.mul$1(i,y.placementInvProjMatrix,e.transform.glCoordMatrix),t.mul$1(i,i,y.placementViewportMatrix),h.push({circleArray:x,circleOffset:d,transform:n,invTransform:i}),d=p+=x.length/4}_&&(e.terrain&&e.terrain.setupElevationDraw(g,c),c.draw(l,u.LINES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,Si(v,e.transform,g),n.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,null,e.transform.zoom,null,_.collisionVertexBuffer,_.collisionVertexBufferExt))}if(!s||!h.length)return;const f=e.useProgram("collisionCircle"),m=new t.StructArrayLayout2f1f2i16;m.resize(4*p),m._trim();let g=0;for(const t of h)for(let e=0;e<t.circleArray.length/4;e++){const i=4*e,n=t.circleArray[i+0],r=t.circleArray[i+1],o=t.circleArray[i+2],a=t.circleArray[i+3];m.emplace(g++,n,r,o,a,0),m.emplace(g++,n,r,o,a,1),m.emplace(g++,n,r,o,a,2),m.emplace(g++,n,r,o,a,3)}(!Vi||Vi.length<2*p)&&(Vi=function(e){const i=2*e,n=new t.StructArrayLayout3ui6;n.resize(i),n._trim();for(let t=0;t<i;t++){const e=6*t;n.uint16[e+0]=4*t+0,n.uint16[e+1]=4*t+1,n.uint16[e+2]=4*t+2,n.uint16[e+3]=4*t+2,n.uint16[e+4]=4*t+3,n.uint16[e+5]=4*t+0}return n}(p));const y=l.createIndexBuffer(Vi,!0),v=l.createVertexBuffer(m,t.collisionCircleLayout.members,!0);for(const i of h){const r={u_matrix:i.transform,u_inv_matrix:i.invTransform,u_camera_to_center_distance:(_=e.transform).cameraToCenterDistance,u_viewport_size:[_.width,_.height]};f.draw(l,u.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,r,n.id,v,y,t.SegmentVector.simpleSegment(0,2*i.circleOffset,i.circleArray.length,i.circleArray.length/2),null,e.transform.zoom,null,null,null)}var _;v.destroy(),y.destroy()}const Gi=t.identity(new Float32Array(16));function $i(e,i,n,r,o,a){const{horizontalAlign:s,verticalAlign:l}=t.getAnchorAlignment(e),u=-(s-.5)*i,c=-(l-.5)*n,h=t.evaluateVariableOffset(e,r);return new t.pointGeometry((u/o+h[0])*a,(c/o+h[1])*a)}function Wi(e,i,n,r,o,a,s,l,u,c,h,p){const d=e.text.placedSymbolArray,f=e.text.dynamicLayoutVertexArray,m=e.icon.dynamicLayoutVertexArray,g={};f.clear();for(let m=0;m<d.length;m++){const y=d.get(m),v=e.allowVerticalPlacement&&!y.placedOrientation,_=y.hidden||!y.crossTileID||v?null:r[y.crossTileID];if(_){const r=new t.pointGeometry(y.anchorX,y.anchorY),d=p(r),m=Yt(r,n?l:s,d),v=Kt(a.cameraToCenterDistance,m.signedDistanceFromCamera);let x=o.evaluateSizeForFeature(e.textSizeData,c,y)*v/t.ONE_EM;n&&(x*=e.tilePixelRatio/u);const{width:b,height:w,anchor:S,textOffset:T,textScale:M}=_,I=$i(S,b,w,T,M,x),C=n?Yt(r.add(I),s,d).point:m.point.add(i?I.rotate(-a.angle):I),A=e.allowVerticalPlacement&&y.placedOrientation===t.WritingMode.vertical?Math.PI/2:0;for(let e=0;e<y.numGlyphs;e++)t.addDynamicAttributes(f,C,A);h&&y.associatedIconIndex>=0&&(g[y.associatedIconIndex]={shiftedAnchor:C,angle:A})}else ae(y.numGlyphs,f)}if(h){m.clear();const i=e.icon.placedSymbolArray;for(let e=0;e<i.length;e++){const n=i.get(e);if(n.hidden)ae(n.numGlyphs,m);else{const i=g[e];if(i)for(let e=0;e<n.numGlyphs;e++)t.addDynamicAttributes(m,i.shiftedAnchor,i.angle);else ae(n.numGlyphs,m)}}e.icon.dynamicLayoutVertexBuffer.updateData(m)}e.text.dynamicLayoutVertexBuffer.updateData(f)}function Hi(t,e,i){return i.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function ji(e,i,n,r,o,a,s,l,u,c,h,p){const d=e.context,f=d.gl,m=e.transform,g="map"===l,y="map"===u,v=g&&"point"!==n.layout.get("symbol-placement"),_=g&&!y&&!v,x=void 0!==n.layout.get("symbol-sort-key").constantOr(1);let b=!1;const w=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),S=n.layout.get("text-variable-anchor"),T=[],M=e.terrain&&y?["PITCH_WITH_MAP_TERRAIN"]:null;for(const l of r){const r=i.getTile(l),u=r.getBucket(n);if(!u)continue;const h=o?u.text:u.icon;if(!h||!h.segments.get().length)continue;const p=h.programConfigurations.get(n.id),d=o||u.sdfIcons,w=o?u.textSizeData:u.iconSizeData,I=y||0!==m.pitch,C=e.useProgram(Hi(d,o,u),p,M),A=t.evaluateSizeForZoom(w,m.zoom);let D,E,P,L,z=[0,0],O=null;if(o){if(E=r.glyphAtlasTexture,P=f.LINEAR,D=r.glyphAtlasTexture.size,u.iconsInText){z=r.imageAtlasTexture.size,O=r.imageAtlasTexture;const t="composite"===w.kind||"camera"===w.kind;L=I||e.options.rotating||e.options.zooming||t?f.LINEAR:f.NEAREST}}else{const t=1!==n.layout.get("icon-size").constantOr(0)||u.iconsNeedLinear;E=r.imageAtlasTexture,P=d||e.options.rotating||e.options.zooming||t||I?f.LINEAR:f.NEAREST,D=r.imageAtlasTexture.size}const R=k(r,1,e.transform.zoom),B=qt(l.projMatrix,y,g,e.transform,R),N=e.terrain&&y&&v?t.invert(new Float32Array(16),B):Gi,F=Xt(l.projMatrix,y,g,e.transform,R),V=S&&u.hasTextData(),U="none"!==n.layout.get("icon-text-fit")&&V&&u.hasIconData();if(v){const t=m.elevation;Qt(u,l.projMatrix,e,o,B,F,y,c,t?e=>t.getAtTileOffset(l,e.x,e.y):null)}const G=e.translatePosMatrix(l.projMatrix,r,a,s),$=v||o&&S||U?Gi:B,W=e.translatePosMatrix(F,r,a,s,!0),H=d&&0!==n.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1);let j;const Z={program:C,buffers:h,uniformValues:j=d?u.iconsInText?Ri(w.kind,A,_,y,e,G,$,W,D,z):Oi(w.kind,A,_,y,e,G,$,W,o,D,!0):zi(w.kind,A,_,y,e,G,$,W,o,D),atlasTexture:E,atlasTextureIcon:O,atlasInterpolation:P,atlasInterpolationIcon:L,isSDF:d,hasHalo:H,tile:r,labelPlaneMatrixInv:N};if(x&&u.canOverlap){b=!0;const e=h.segments.get();for(const i of e)T.push({segments:new t.SegmentVector([i]),sortKey:i.sortKey,state:Z})}else T.push({segments:h.segments,sortKey:0,state:Z})}b&&T.sort((t,e)=>t.sortKey-e.sortKey);for(const t of T){const i=t.state;if(e.terrain&&e.terrain.setupElevationDraw(i.tile,i.program,{useDepthForOcclusion:!0,labelPlaneMatrixInv:i.labelPlaneMatrixInv}),d.activeTexture.set(f.TEXTURE0),i.atlasTexture.bind(i.atlasInterpolation,f.CLAMP_TO_EDGE),i.atlasTextureIcon&&(d.activeTexture.set(f.TEXTURE1),i.atlasTextureIcon&&i.atlasTextureIcon.bind(i.atlasInterpolationIcon,f.CLAMP_TO_EDGE)),i.isSDF){const r=i.uniformValues;i.hasHalo&&(r.u_is_halo=1,Zi(i.buffers,t.segments,n,e,i.program,w,h,p,r)),r.u_is_halo=0}Zi(i.buffers,t.segments,n,e,i.program,w,h,p,i.uniformValues)}}function Zi(e,i,n,r,o,a,s,l,u){const c=r.context;o.draw(c,c.gl.TRIANGLES,a,s,l,t.CullFaceMode.disabled,u,n.id,e.layoutVertexBuffer,e.indexBuffer,i,n.paint,r.transform.zoom,e.programConfigurations.get(n.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function qi(e,i,n,r,o,a,s){const l=e.context.gl,u=n.paint.get("fill-pattern"),c=u&&u.constantOr(1),h=n.getCrossfadeParameters();let p,d,f,m,g;s?(d=c&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",p=l.LINES):(d=c?"fillPattern":"fill",p=l.TRIANGLES);for(const y of r){const r=i.getTile(y);if(c&&!r.patternsLoaded())continue;const v=r.getBucket(n);if(!v)continue;e.prepareDrawTile(y);const _=v.programConfigurations.get(n.id),x=e.useProgram(d,_);c&&(e.context.activeTexture.set(l.TEXTURE0),r.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),_.updatePaintBuffers(h));const b=u.constantOr(null);if(b&&r.imageAtlas){const t=r.imageAtlas,e=t.patternPositions[b.to.toString()],i=t.patternPositions[b.from.toString()];e&&i&&_.setConstantPatternPositions(e,i)}const w=e.translatePosMatrix(y.projMatrix,r,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(s){m=v.indexBuffer2,g=v.segments2;const t=e.terrain&&e.terrain.renderingToTexture?e.terrain.drapeBufferSize:[l.drawingBufferWidth,l.drawingBufferHeight];f="fillOutlinePattern"===d&&c?xi(w,e,h,r,t):_i(w,t)}else m=v.indexBuffer,g=v.segments,f=c?vi(w,e,h,r):yi(w);e.prepareDrawProgram(e.context,x,y.toUnwrapped()),x.draw(e.context,p,o,e.stencilModeForClipping(y),a,t.CullFaceMode.disabled,f,n.id,v.layoutVertexBuffer,m,g,n.paint,e.transform.zoom,_)}}function Xi(e,i,n,r,o,a,s){const l=e.context,u=l.gl,c=n.paint.get("fill-extrusion-pattern"),h=c.constantOr(1),p=n.getCrossfadeParameters(),d=n.paint.get("fill-extrusion-opacity");for(const f of r){const r=i.getTile(f),m=r.getBucket(n);if(!m)continue;const g=m.programConfigurations.get(n.id),y=e.useProgram(h?"fillExtrusionPattern":"fillExtrusion",g);if(e.terrain){const t=e.terrain;if(!m.enableTerrain)continue;if(t.setupElevationDraw(r,y,{useMeterToDem:!0}),Yi(l,i,f,m,n,t),!m.centroidVertexBuffer){const t=y.attributes.a_centroid_pos;void 0!==t&&u.vertexAttrib2f(t,0,0)}}h&&(e.context.activeTexture.set(u.TEXTURE0),r.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),g.updatePaintBuffers(p));const v=c.constantOr(null);if(v&&r.imageAtlas){const t=r.imageAtlas,e=t.patternPositions[v.to.toString()],i=t.patternPositions[v.from.toString()];e&&i&&g.setConstantPatternPositions(e,i)}const _=e.translatePosMatrix(f.projMatrix,r,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),x=n.paint.get("fill-extrusion-vertical-gradient"),b=h?gi(_,e,x,d,f,p,r):mi(_,e,x,d);e.prepareDrawProgram(l,y,f.toUnwrapped()),y.draw(l,l.gl.TRIANGLES,o,a,s,t.CullFaceMode.backCCW,b,n.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,n.paint,e.transform.zoom,g,e.terrain?m.centroidVertexBuffer:null)}}function Yi(e,i,n,r,o,a){const s=[e=>{let i=e.canonical.x-1,n=e.wrap;return i<0&&(i=(1<<e.canonical.z)-1,n--),new t.OverscaledTileID(e.overscaledZ,n,e.canonical.z,i,e.canonical.y)},e=>{let i=e.canonical.x+1,n=e.wrap;return i===1<<e.canonical.z&&(i=0,n++),new t.OverscaledTileID(e.overscaledZ,n,e.canonical.z,i,e.canonical.y)},e=>new t.OverscaledTileID(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,(0===e.canonical.y?1<<e.canonical.z:e.canonical.y)-1),e=>new t.OverscaledTileID(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y===(1<<e.canonical.z)-1?0:e.canonical.y+1)],l=t=>{const e=i.getSource().maxzoom,n=t=>{const e=i.getTileByID(t);if(e&&e.hasData())return e.getBucket(o)};let r,a,s;return(t.overscaledZ===t.canonical.z||t.overscaledZ>=e)&&(r=n(t.key)),t.overscaledZ>=e&&(a=n(t.calculateScaledKey(t.overscaledZ+1))),t.overscaledZ>e&&(s=n(t.calculateScaledKey(t.overscaledZ-1))),r||a||s},u=[0,0,0],c=(e,i)=>(u[0]=Math.min(e.min.y,i.min.y),u[1]=Math.max(e.max.y,i.max.y),u[2]=t.EXTENT-i.min.x>e.max.x?i.min.x-t.EXTENT:e.max.x,u),h=(e,i)=>(u[0]=Math.min(e.min.x,i.min.x),u[1]=Math.max(e.max.x,i.max.x),u[2]=t.EXTENT-i.min.y>e.max.y?i.min.y-t.EXTENT:e.max.y,u),p=[(t,e)=>c(t,e),(t,e)=>c(e,t),(t,e)=>h(t,e),(t,e)=>h(e,t)],d=new t.pointGeometry(0,0);let f,m,g;const y=(e,i,r,o,s)=>{const l=[[o?r:e,o?e:r,0],[o?r:i,o?i:r,0]],u=s<0?t.EXTENT+s:s,c=[o?u:(e+i)/2,o?(e+i)/2:u,0];return 0===r&&s<0||0!==r&&s>0?a.getForTilePoints(g,[c],!0,m):l.push(c),a.getForTilePoints(n,l,!0,f),Math.max(l[0][2],l[1][2],c[2])/a.exaggeration()};for(let e=0;e<4;e++){const i=r.borders[e];if(0===i.length&&(r.borderDone[e]=!0),r.borderDone[e])continue;const o=g=s[e](n),u=l(o);if(!u||!u.enableTerrain)continue;if(!(m=a.findDEMTileFor(o))||!m.dem)continue;if(!f){const t=a.findDEMTileFor(n);if(!t||!t.dem)return;f=t}const c=(e<2?1:5)-e,h=u.borders[c];let v=0;for(let n=0;n<i.length;n++){const o=r.featuresOnBorder[i[n]],a=o.borders[e];let s;for(;v<h.length&&!((s=u.featuresOnBorder[h[v]]).borders[c][1]>a[0]+3);)u.borderDone[c]||u.encodeCentroid(void 0,s,!1),v++;if(s&&v<h.length){const i=v;let n=0;for(;!(s.borders[c][0]>a[1]-3)&&(n++,++v!==h.length);)s=u.featuresOnBorder[h[v]];if(s=u.featuresOnBorder[h[i]],o.intersectsCount()>1||s.intersectsCount()>1||1!==n){1!==n&&(v=i),r.encodeCentroid(void 0,o,!1),u.borderDone[c]||u.encodeCentroid(void 0,s,!1);continue}const l=p[e](o,s),f=e%2?t.EXTENT-1:0;d.x=y(l[0],Math.min(t.EXTENT-1,l[1]),f,e<2,l[2]),d.y=0,r.encodeCentroid(d,o,!1),u.borderDone[c]||u.encodeCentroid(d,s,!1)}else r.encodeCentroid(void 0,o,!1)}r.borderDone[e]=r.needsCentroidUpdate=!0,u.borderDone[c]||(u.borderDone[c]=u.needsCentroidUpdate=!0)}(r.needsCentroidUpdate||!r.centroidVertexBuffer&&0!==r.centroidVertexArray.length)&&r.uploadCentroid(e)}const Ki=new t.Color(1,0,0,1),Ji=new t.Color(0,1,0,1),Qi=new t.Color(0,0,1,1),tn=new t.Color(1,0,1,1),en=new t.Color(0,1,1,1);function nn(t,e,i,n){on(t,0,e+i/2,t.transform.width,i,n)}function rn(t,e,i,n){on(t,e-i/2,0,i,t.transform.height,n)}function on(e,i,n,r,o,a){const s=e.context,l=s.gl;l.enable(l.SCISSOR_TEST),l.scissor(i*t.exported.devicePixelRatio,n*t.exported.devicePixelRatio,r*t.exported.devicePixelRatio,o*t.exported.devicePixelRatio),s.clear({color:a}),l.disable(l.SCISSOR_TEST)}function an(e,i,n){const r=e.context,o=r.gl,a=n.projMatrix,s=e.useProgram("debug"),l=i.getTileByID(n.key);e.terrain&&e.terrain.setupElevationDraw(l,s);const u=t.DepthMode.disabled,c=t.StencilMode.disabled,h=e.colorModeForRenderPass(),p="$debug";r.activeTexture.set(o.TEXTURE0),e.emptyTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE),s.draw(r,o.LINE_STRIP,u,c,h,t.CullFaceMode.disabled,Ti(a,t.Color.red),p,e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments);const d=l.latestRawTileData,f=Math.floor((d&&d.byteLength||0)/1024),m=i.getTile(n).tileSize,g=512/Math.min(m,512)*(n.overscaledZ/e.transform.zoom)*.5;let y=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(y+=` => ${n.overscaledZ}`),function(t,e){t.initDebugOverlayCanvas();const i=t.debugOverlayCanvas,n=t.context.gl,r=t.debugOverlayCanvas.getContext("2d");r.clearRect(0,0,i.width,i.height),r.shadowColor="white",r.shadowBlur=2,r.lineWidth=1.5,r.strokeStyle="white",r.textBaseline="top",r.font="bold 36px Open Sans, sans-serif",r.fillText(e,5,5),r.strokeText(e,5,5),t.debugOverlayTexture.update(i),t.debugOverlayTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}(e,`${y} ${f}kb`),s.draw(r,o.TRIANGLES,u,c,t.ColorMode.alphaBlended,t.CullFaceMode.disabled,Ti(a,t.Color.transparent,g),p,e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments)}const sn=t.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:ln}=sn;function un(t,e,i,n){t.emplaceBack(e,i,n)}class cn{constructor(e){this.vertexArray=new t.StructArrayLayout3f12,this.indices=new t.StructArrayLayout3ui6,un(this.vertexArray,-1,-1,1),un(this.vertexArray,1,-1,1),un(this.vertexArray,-1,1,1),un(this.vertexArray,1,1,1),un(this.vertexArray,-1,-1,-1),un(this.vertexArray,1,-1,-1),un(this.vertexArray,-1,1,-1),un(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=e.createVertexBuffer(this.vertexArray,ln),this.indexBuffer=e.createIndexBuffer(this.indices),this.segment=t.SegmentVector.simpleSegment(0,0,36,12)}}function hn(e,i,n,r,o,a){const s=e.gl,l=i.paint.get("sky-atmosphere-color"),u=i.paint.get("sky-atmosphere-halo-color"),c=i.paint.get("sky-atmosphere-sun-intensity"),h=((t,e,i,n,r)=>({u_matrix_3f:t,u_sun_direction:e,u_sun_intensity:i,u_color_tint_r:[n.r,n.g,n.b,n.a],u_color_tint_m:[r.r,r.g,r.b,r.a],u_luminance:5e-5}))(t.fromMat4([],r),o,c,l,u);s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+a,i.skyboxTexture,0),n.draw(e,s.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,t.ColorMode.unblended,t.CullFaceMode.frontCW,h,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}const pn={symbol:function(e,i,n,r,o){if("translucent"!==e.renderPass)return;const a=t.StencilMode.disabled,s=e.colorModeForRenderPass();n.layout.get("text-variable-anchor")&&function(e,i,n,r,o,a,s){const l=i.transform,u="map"===o,c="map"===a;for(const o of e){const e=r.getTile(o),a=e.getBucket(n);if(!a||!a.text||!a.text.segments.get().length)continue;const h=t.evaluateSizeForZoom(a.textSizeData,l.zoom),p=k(e,1,i.transform.zoom),d=qt(o.projMatrix,c,u,i.transform,p),f="none"!==n.layout.get("icon-text-fit")&&a.hasIconData();if(h){const i=Math.pow(2,l.zoom-e.tileID.overscaledZ),n=l.elevation;Wi(a,u,c,s,t.symbolSize,l,d,o.projMatrix,i,h,f,n?t=>n.getAtTileOffset(o,t.x,t.y):t=>0)}}}(r,e,n,i,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),o),0!==n.paint.get("icon-opacity").constantOr(1)&&ji(e,i,n,r,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),a,s),0!==n.paint.get("text-opacity").constantOr(1)&&ji(e,i,n,r,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),a,s),i.map.showCollisionBoxes&&(Ui(e,i,n,r,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),!0),Ui(e,i,n,r,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),!1))},circle:function(e,i,n,r){if("translucent"!==e.renderPass)return;const o=n.paint.get("circle-opacity"),a=n.paint.get("circle-stroke-width"),s=n.paint.get("circle-stroke-opacity"),l=void 0!==n.layout.get("circle-sort-key").constantOr(1);if(0===o.constantOr(1)&&(0===a.constantOr(1)||0===s.constantOr(1)))return;const u=e.context,c=u.gl,h=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),p=t.StencilMode.disabled,d=e.colorModeForRenderPass(),f=[];for(let o=0;o<r.length;o++){const a=r[o],s=i.getTile(a),u=s.getBucket(n);if(!u)continue;const c=u.programConfigurations.get(n.id),h=wi(n),p={programConfiguration:c,program:e.useProgram("circle",c,h),layoutVertexBuffer:u.layoutVertexBuffer,indexBuffer:u.indexBuffer,uniformValues:bi(e,a,s,n),tile:s};if(l){const e=u.segments.get();for(const i of e)f.push({segments:new t.SegmentVector([i]),sortKey:i.sortKey,state:p})}else f.push({segments:u.segments,sortKey:0,state:p})}l&&f.sort((t,e)=>t.sortKey-e.sortKey);for(const i of f){const{programConfiguration:r,program:o,layoutVertexBuffer:a,indexBuffer:s,uniformValues:l,tile:f}=i.state,m=i.segments;e.terrain&&e.terrain.setupElevationDraw(f,o,{useDepthForOcclusion:!0}),e.prepareDrawProgram(u,o,f.tileID.toUnwrapped()),o.draw(u,c.TRIANGLES,h,p,d,t.CullFaceMode.disabled,l,n.id,a,s,m,n.paint,e.transform.zoom,r)}},heatmap:function(e,i,n,r){if(0!==n.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){const o=e.context,a=o.gl,s=t.StencilMode.disabled,l=new t.ColorMode([a.ONE,a.ONE],t.Color.transparent,[!0,!0,!0,!0]);!function(t,e,i){const n=t.gl;t.activeTexture.set(n.TEXTURE1),t.viewport.set([0,0,e.width/4,e.height/4]);let r=i.heatmapFbo;if(r)n.bindTexture(n.TEXTURE_2D,r.colorAttachment.get()),t.bindFramebuffer.set(r.framebuffer);else{const o=n.createTexture();n.bindTexture(n.TEXTURE_2D,o),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),r=i.heatmapFbo=t.createFramebuffer(e.width/4,e.height/4,!1),function(t,e,i,n){const r=t.gl;r.texImage2D(r.TEXTURE_2D,0,r.RGBA,e.width/4,e.height/4,0,r.RGBA,t.extRenderToTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:r.UNSIGNED_BYTE,null),n.colorAttachment.set(i)}(t,e,o,r)}}(o,e,n),o.clear({color:t.Color.transparent});for(let u=0;u<r.length;u++){const c=r[u];if(i.hasRenderableParent(c))continue;const h=i.getTile(c),p=h.getBucket(n);if(!p)continue;const d=p.programConfigurations.get(n.id),f=e.useProgram("heatmap",d),{zoom:m}=e.transform;e.terrain&&e.terrain.setupElevationDraw(h,f),e.prepareDrawProgram(o,f,c.toUnwrapped()),f.draw(o,a.TRIANGLES,t.DepthMode.disabled,s,l,t.CullFaceMode.disabled,Mi(c.projMatrix,h,m,n.paint.get("heatmap-intensity")),n.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,n.paint,e.transform.zoom,d)}o.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(e,i){const n=e.context,r=n.gl,o=i.heatmapFbo;if(!o)return;n.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,o.colorAttachment.get()),n.activeTexture.set(r.TEXTURE1);let a=i.colorRampTexture;a||(a=i.colorRampTexture=new t.Texture(n,i.colorRamp,r.RGBA)),a.bind(r.LINEAR,r.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(n,r.TRIANGLES,t.DepthMode.disabled,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.disabled,((e,i,n,r)=>{const o=t.create$1();t.ortho(o,0,e.width,e.height,0,0,1);const a=e.context.gl;return{u_matrix:o,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:i.paint.get("heatmap-opacity")}})(e,i),i.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,i.paint,e.transform.zoom)}(e,n))},line:function(e,i,n,r){if("translucent"!==e.renderPass)return;const o=n.paint.get("line-opacity"),a=n.paint.get("line-width");if(0===o.constantOr(1)||0===a.constantOr(1))return;const s=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),l=e.colorModeForRenderPass(),u=n.paint.get("line-dasharray"),c=u.constantOr(1),h=n.layout.get("line-cap"),p=n.paint.get("line-pattern"),d=p.constantOr(1),f=n.paint.get("line-gradient"),m=n.getCrossfadeParameters(),g=d?"linePattern":c?"lineSDF":f?"lineGradient":"line",y=e.context,v=y.gl;for(const o of r){const r=i.getTile(o);if(d&&!r.patternsLoaded())continue;const a=r.getBucket(n);if(!a)continue;e.prepareDrawTile(o);const _=a.programConfigurations.get(n.id),x=e.useProgram(g,_),b=p.constantOr(null);if(b&&r.imageAtlas){const t=r.imageAtlas,e=t.patternPositions[b.to.toString()],i=t.patternPositions[b.from.toString()];e&&i&&_.setConstantPatternPositions(e,i)}const w=u.constantOr(null),S=h.constantOr(null);if(!d&&w&&S&&r.lineAtlas){const t=r.lineAtlas,e=t.getDash(w.to,S),i=t.getDash(w.from,S);e&&i&&_.setConstantPatternPositions(e,i)}const T=e.terrain?o.projMatrix:null,M=d?Ai(e,r,n,m,T):c?ki(e,r,n,m,T):f?Ci(e,r,n,T,a.lineClipsArray.length):Ii(e,r,n,T);if(d)y.activeTexture.set(v.TEXTURE0),r.imageAtlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),_.updatePaintBuffers(m);else if(c)y.activeTexture.set(v.TEXTURE0),r.lineAtlasTexture.bind(v.LINEAR,v.REPEAT),_.updatePaintBuffers(m);else if(f){const r=a.gradients[n.id];let s=r.texture;if(n.gradientVersion!==r.version){let l=256;if(n.stepInterpolant){const n=i.getSource().maxzoom,r=o.canonical.z===n?Math.ceil(1<<e.transform.maxZoom-o.canonical.z):1;l=t.clamp(t.nextPowerOfTwo(a.maxLineLength/t.EXTENT*1024*r),256,y.maxTextureSize)}r.gradient=t.renderColorRamp({expression:n.gradientExpression(),evaluationKey:"lineProgress",resolution:l,image:r.gradient||void 0,clips:a.lineClipsArray}),r.texture?r.texture.update(r.gradient):r.texture=new t.Texture(y,r.gradient,v.RGBA),r.version=n.gradientVersion,s=r.texture}y.activeTexture.set(v.TEXTURE0),s.bind(n.stepInterpolant?v.NEAREST:v.LINEAR,v.CLAMP_TO_EDGE)}e.prepareDrawProgram(y,x,o.toUnwrapped()),x.draw(y,v.TRIANGLES,s,e.stencilModeForClipping(o),l,t.CullFaceMode.disabled,M,n.id,a.layoutVertexBuffer,a.indexBuffer,a.segments,n.paint,e.transform.zoom,_,a.layoutVertexBuffer2)}},fill:function(e,i,n,r){const o=n.paint.get("fill-color"),a=n.paint.get("fill-opacity");if(0===a.constantOr(1))return;const s=e.colorModeForRenderPass(),l=n.paint.get("fill-pattern"),u=e.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===o.constantOr(t.Color.transparent).a&&1===a.constantOr(0)?"opaque":"translucent";if(e.renderPass===u){const o=e.depthModeForSublayer(1,"opaque"===e.renderPass?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly);qi(e,i,n,r,o,s,!1)}if("translucent"===e.renderPass&&n.paint.get("fill-antialias")){const o=e.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,t.DepthMode.ReadOnly);qi(e,i,n,r,o,s,!0)}},"fill-extrusion":function(e,i,n,r){const o=n.paint.get("fill-extrusion-opacity");if(0!==o&&"translucent"===e.renderPass){const a=new t.DepthMode(e.context.gl.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D);if(1!==o||n.paint.get("fill-extrusion-pattern").constantOr(1))Xi(e,i,n,r,a,t.StencilMode.disabled,t.ColorMode.disabled),Xi(e,i,n,r,a,e.stencilModeFor3D(),e.colorModeForRenderPass());else{const o=e.colorModeForRenderPass();Xi(e,i,n,r,a,t.StencilMode.disabled,o)}}},hillshade:function(e,i,n,r){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;const o=e.context,a=e.depthModeForSublayer(0,t.DepthMode.ReadOnly),s=e.colorModeForRenderPass(),l=e.terrain&&e.terrain.renderingToTexture,[u,c]="translucent"!==e.renderPass||l?[{},r]:e.stencilConfigForOverlap(r);for(const r of c){const o=i.getTile(r);if(o.needsHillshadePrepare&&"offscreen"===e.renderPass)ti(e,o,n,a,t.StencilMode.disabled,s);else if("translucent"===e.renderPass){const t=l&&e.terrain?e.terrain.stencilModeForRTTOverlap(r):u[r.overscaledZ];Je(e,r,o,n,a,t,s)}}o.viewport.set([0,0,e.width,e.height])},raster:function(e,i,n,r,o,a){if("translucent"!==e.renderPass)return;if(0===n.paint.get("raster-opacity"))return;if(!r.length)return;const s=e.context,l=s.gl,u=i.getSource(),c=e.useProgram("raster"),h=e.colorModeForRenderPass(),p=e.terrain&&e.terrain.renderingToTexture,[d,f]=u instanceof Tt||p?[{},r]:e.stencilConfigForOverlap(r),m=f[f.length-1].overscaledZ,g=!e.options.moving;for(const r of f){const o=p?t.DepthMode.disabled:e.depthModeForSublayer(r.overscaledZ-m,1===n.paint.get("raster-opacity")?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly,l.LESS),f=r.toUnwrapped(),y=i.getTile(r);if(p&&(!y||!y.hasData()))continue;const v=p?r.projMatrix:e.transform.calculateProjMatrix(f,g),_=e.terrain&&p?e.terrain.stencilModeForRTTOverlap(r):d[r.overscaledZ],x=a?0:n.paint.get("raster-fade-duration");y.registerFadeDuration(x);const b=i.findLoadedParent(r,0),w=li(y,b,i,e.transform,x);let S,T;e.terrain&&e.terrain.prepareDrawTile(r);const M="nearest"===n.paint.get("raster-resampling")?l.NEAREST:l.LINEAR;s.activeTexture.set(l.TEXTURE0),y.texture.bind(M,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),s.activeTexture.set(l.TEXTURE1),b?(b.texture.bind(M,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),S=Math.pow(2,b.tileID.overscaledZ-y.tileID.overscaledZ),T=[y.tileID.canonical.x*S%1,y.tileID.canonical.y*S%1]):y.texture.bind(M,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST);const I=Pi(v,T||[0,0],S||1,w,n);e.prepareDrawProgram(s,c,f),u instanceof Tt?c.draw(s,l.TRIANGLES,o,t.StencilMode.disabled,h,t.CullFaceMode.disabled,I,n.id,u.boundsBuffer,e.quadTriangleIndexBuffer,u.boundsSegments):c.draw(s,l.TRIANGLES,o,_,h,t.CullFaceMode.disabled,I,n.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}},background:function(e,i,n,r){const o=n.paint.get("background-color"),a=n.paint.get("background-opacity");if(0===a)return;const s=e.context,l=s.gl,u=e.transform,c=u.tileSize,h=n.paint.get("background-pattern");if(e.isPatternMissing(h))return;const p=!h&&1===o.a&&1===a&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==p)return;const d=t.StencilMode.disabled,f=e.depthModeForSublayer(0,"opaque"===p?t.DepthMode.ReadWrite:t.DepthMode.ReadOnly),m=e.colorModeForRenderPass(),g=e.useProgram(h?"backgroundPattern":"background"),y=r||u.coveringTiles({tileSize:c});h&&(s.activeTexture.set(l.TEXTURE0),e.imageManager.bind(e.context));const v=n.getCrossfadeParameters();for(const i of y){const u=i.toUnwrapped(),p=r?i.projMatrix:e.transform.calculateProjMatrix(u);e.prepareDrawTile(i);const y=h?Ni(p,a,e,h,{tileID:i,tileSize:c},v):Bi(p,a,o);e.prepareDrawProgram(s,g,u),g.draw(s,l.TRIANGLES,f,d,m,t.CullFaceMode.disabled,y,n.id,e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments)}},sky:function(e,i,n){const r=n.paint.get("sky-opacity");if(0===r)return;const o=e.context,a=n.paint.get("sky-type"),s=new t.DepthMode(o.gl.LEQUAL,t.DepthMode.ReadOnly,[0,1]),l=e.frameCounter/1e3%1;"atmosphere"===a?"offscreen"===e.renderPass?n.needsSkyboxCapture(e)&&(function(e,i,n,r){const o=e.context,a=o.gl;let s=i.skyboxFbo;if(!s){s=i.skyboxFbo=o.createFramebuffer(32,32,!1),i.skyboxGeometry=new cn(o),i.skyboxTexture=o.gl.createTexture(),a.bindTexture(a.TEXTURE_CUBE_MAP,i.skyboxTexture),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR);for(let t=0;t<6;++t)a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,a.RGBA,32,32,0,a.RGBA,a.UNSIGNED_BYTE,null)}o.bindFramebuffer.set(s.framebuffer),o.viewport.set([0,0,32,32]);const l=i.getCenter(e,!0),u=e.useProgram("skyboxCapture"),c=new Float64Array(16);t.identity(c),t.rotateY(c,c,.5*-Math.PI),hn(o,i,u,c,l,0),t.identity(c),t.rotateY(c,c,.5*Math.PI),hn(o,i,u,c,l,1),t.identity(c),t.rotateX(c,c,.5*-Math.PI),hn(o,i,u,c,l,2),t.identity(c),t.rotateX(c,c,.5*Math.PI),hn(o,i,u,c,l,3),t.identity(c),hn(o,i,u,c,l,4),t.identity(c),t.rotateY(c,c,Math.PI),hn(o,i,u,c,l,5),o.viewport.set([0,0,e.width,e.height])}(e,n),n.markSkyboxValid(e)):"sky"===e.renderPass&&function(e,i,n,r,o){const a=e.context,s=a.gl,l=e.transform,u=e.useProgram("skybox");a.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_CUBE_MAP,i.skyboxTexture);const c=((t,e,i,n,r)=>({u_matrix:t,u_sun_direction:e,u_cubemap:0,u_opacity:n,u_temporal_offset:r}))(l.skyboxMatrix,i.getCenter(e,!1),0,r,o);e.prepareDrawProgram(a,u),u.draw(a,s.TRIANGLES,n,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.backCW,c,"skybox",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}(e,n,s,r,l):"gradient"===a&&"sky"===e.renderPass&&function(e,i,n,r,o){const a=e.context,s=a.gl,l=e.transform,u=e.useProgram("skyboxGradient");i.skyboxGeometry||(i.skyboxGeometry=new cn(a)),a.activeTexture.set(s.TEXTURE0);let c=i.colorRampTexture;c||(c=i.colorRampTexture=new t.Texture(a,i.colorRamp,s.RGBA)),c.bind(s.LINEAR,s.CLAMP_TO_EDGE);const h=((e,i,n,r,o)=>({u_matrix:e,u_color_ramp:0,u_center_direction:i,u_radius:t.degToRad(n),u_opacity:r,u_temporal_offset:o}))(l.skyboxMatrix,i.getCenter(e,!1),i.paint.get("sky-gradient-radius"),r,o);e.prepareDrawProgram(a,u),u.draw(a,s.TRIANGLES,n,t.StencilMode.disabled,e.colorModeForRenderPass(),t.CullFaceMode.backCW,h,"skyboxGradient",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}(e,n,s,r,l)},debug:function(t,e,i){for(let n=0;n<i.length;n++)an(t,e,i[n])},custom:function(e,i,n){const r=e.context,o=n.implementation;if("offscreen"===e.renderPass){const t=o.prerender;t&&(e.setCustomLayerDefaults(),r.setColorMode(e.colorModeForRenderPass()),t.call(o,r.gl,e.transform.customLayerMatrix()),r.setDirty(),e.setBaseState())}else if("translucent"===e.renderPass){e.setCustomLayerDefaults(),r.setColorMode(e.colorModeForRenderPass()),r.setStencilMode(t.StencilMode.disabled);const i="3d"===o.renderingMode?new t.DepthMode(e.context.gl.LEQUAL,t.DepthMode.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,t.DepthMode.ReadOnly);r.setDepthMode(i),o.render(r.gl,e.transform.customLayerMatrix()),r.setDirty(),e.setBaseState(),r.bindFramebuffer.set(null)}}};class dn{constructor(e,i){this.context=new xt(e),this.transform=i,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=t.SourceCache.maxUnderzooming+t.SourceCache.maxOverzooming+1,this.depthEpsilon=1/65536,this.crossTileSymbolIndex=new Oe,this.gpuTimers={},this.frameCounter=0}updateTerrain(t,e){const i=!!t&&!!t.terrain;if(!(i||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new hi(this,t));const n=this._terrain;this.transform.elevation=i?n:null,n.update(t,this.transform,e)}_updateFog(t){const e=t.fog;if(!e||e.getOpacity(this.transform.pitch)<1||e.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[i,n]=e.getFovAdjustedRange(this.transform._fov);if(i>n)return void(this.transform.fogCullDistSq=null);const r=i+.78*(n-i);this.transform.fogCullDistSq=r*r}get terrain(){return this._terrain&&this._terrain.enabled?this._terrain:null}resize(e,i){if(this.width=e*t.exported.devicePixelRatio,this.height=i*t.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const t of this.style.order)this.style._layers[t].resize()}setup(){const e=this.context,i=new t.StructArrayLayout2i4;i.emplaceBack(0,0),i.emplaceBack(t.EXTENT,0),i.emplaceBack(0,t.EXTENT),i.emplaceBack(t.EXTENT,t.EXTENT),this.tileExtentBuffer=e.createVertexBuffer(i,t.posAttributes.members),this.tileExtentSegments=t.SegmentVector.simpleSegment(0,0,4,2);const n=new t.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(t.EXTENT,0),n.emplaceBack(0,t.EXTENT),n.emplaceBack(t.EXTENT,t.EXTENT),this.debugBuffer=e.createVertexBuffer(n,t.posAttributes.members),this.debugSegments=t.SegmentVector.simpleSegment(0,0,4,5);const r=new t.StructArrayLayout4i8;r.emplaceBack(0,0,0,0),r.emplaceBack(t.EXTENT,0,t.EXTENT,0),r.emplaceBack(0,t.EXTENT,0,t.EXTENT),r.emplaceBack(t.EXTENT,t.EXTENT,t.EXTENT,t.EXTENT),this.rasterBoundsBuffer=e.createVertexBuffer(r,St.members),this.rasterBoundsSegments=t.SegmentVector.simpleSegment(0,0,4,2);const o=new t.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(1,0),o.emplaceBack(0,1),o.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(o,t.posAttributes.members),this.viewportSegments=t.SegmentVector.simpleSegment(0,0,4,2);const a=new t.StructArrayLayout1ui2;a.emplaceBack(0),a.emplaceBack(1),a.emplaceBack(3),a.emplaceBack(2),a.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(a);const s=new t.StructArrayLayout3ui6;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s),this.emptyTexture=new t.Texture(e,{width:1,height:1,data:new Uint8Array([0,0,0,0])},e.gl.RGBA),this.identityMat=t.create$1();const l=this.context.gl;this.stencilClearMode=new t.StencilMode({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO),this.loadTimeStamps.push(t.window.performance.now())}clearStencil(){const e=this.context,i=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const n=t.create$1();t.ortho(n,0,this.width,this.height,0,0,1),t.scale$1(n,n,[i.drawingBufferWidth,i.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,i.TRIANGLES,t.DepthMode.disabled,this.stencilClearMode,t.ColorMode.disabled,t.CullFaceMode.disabled,si(n),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,i,n){if(!(i&&this.currentStencilSource!==i.id&&e.isTileClipped()&&n&&n.length))return;this.currentStencilSource=i.id;const r=this.context,o=r.gl;this.nextStencilID+n.length>256&&this.clearStencil(),r.setColorMode(t.ColorMode.disabled),r.setDepthMode(t.DepthMode.disabled);const a=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const e of n){const i=this._tileClippingMaskIDs[e.key]=this.nextStencilID++;a.draw(r,o.TRIANGLES,t.DepthMode.disabled,new t.StencilMode({func:o.ALWAYS,mask:0},i,255,o.KEEP,o.KEEP,o.REPLACE),t.ColorMode.disabled,t.CullFaceMode.disabled,si(e.projMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,i=this.context.gl;return new t.StencilMode({func:i.NOTEQUAL,mask:255},e,255,i.KEEP,i.KEEP,i.REPLACE)}stencilModeForClipping(e){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(e);const i=this.context.gl;return new t.StencilMode({func:i.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,i.KEEP,i.KEEP,i.REPLACE)}stencilConfigForOverlap(e){const i=this.context.gl,n=e.sort((t,e)=>e.overscaledZ-t.overscaledZ),r=n[n.length-1].overscaledZ,o=n[0].overscaledZ-r+1;if(o>1){this.currentStencilSource=void 0,this.nextStencilID+o>256&&this.clearStencil();const e={};for(let n=0;n<o;n++)e[n+r]=new t.StencilMode({func:i.GEQUAL,mask:255},n+this.nextStencilID,255,i.KEEP,i.KEEP,i.REPLACE);return this.nextStencilID+=o,[e,n]}return[{[r]:t.StencilMode.disabled},n]}colorModeForRenderPass(){const e=this.context.gl;if(this._showOverdrawInspector){const i=1/8;return new t.ColorMode([e.CONSTANT_COLOR,e.ONE],new t.Color(i,i,i,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?t.ColorMode.unblended:t.ColorMode.alphaBlended}depthModeForSublayer(e,i,n){if(!this.opaquePassEnabledForLayer())return t.DepthMode.disabled;const r=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new t.DepthMode(n||this.context.gl.LEQUAL,i,[r,r])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,i){this.style=e,this.options=i,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(t.exported.now()),this.imageManager.beginFrame();const n=this.style.order,r=this.style._sourceCaches;for(const t in r){const e=r[t];e.used&&e.prepare(this.context)}const o={},a={},s={};for(const t in r){const e=r[t];o[t]=e.getVisibleCoordinates(),a[t]=o[t].slice().reverse(),s[t]=e.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let t=0;t<n.length;t++)if(this.style._layers[n[t]].is3D()){this.opaquePassCutoff=t;break}if(this.terrain&&(this.terrain.updateTileBinding(s),this.opaquePassCutoff=0),!t.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const t of n){const i=this.style._layers[t],n=e._getLayerSourceCache(i);if(!i.hasOffscreenPass()||i.isHidden(this.transform.zoom))continue;const r=n?a[n.id]:void 0;("custom"===i.type||i.isSky()||r&&r.length)&&this.renderLayer(this,n,i,r)}this.depthRangeFor3D=[0,1-(e.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let l=t.Color.transparent;if(this.style.fog&&(l=this.style.fog.properties.get("color")),this.context.clear({color:i.showOverdrawInspector?t.Color.black:l,depth:1}),this.clearStencil(),this._showOverdrawInspector=i.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=n.length-1;this.currentLayer>=0;this.currentLayer--){const t=this.style._layers[n[this.currentLayer]],i=e._getLayerSourceCache(t);if(t.isSky())continue;const r=i?a[i.id]:void 0;this._renderTileClippingMasks(t,i,r),this.renderLayer(this,i,t,r)}if(this.renderPass="sky",this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<n.length;this.currentLayer++){const t=this.style._layers[n[this.currentLayer]],i=e._getLayerSourceCache(t);t.isSky()&&this.renderLayer(this,i,t,i?a[i.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<n.length;){const t=this.style._layers[n[this.currentLayer]],i=e._getLayerSourceCache(t);if(t.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(t)){if(t.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const r=i?("symbol"===t.type?s:a)[i.id]:void 0;this._renderTileClippingMasks(t,i,i?o[i.id]:void 0),this.renderLayer(this,i,t,r),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let i=null;t.values(this.style._layers).forEach(t=>{const n=e._getLayerSourceCache(t);n&&!t.isHidden(this.transform.zoom)&&(!i||i.getSource().maxzoom<n.getSource().maxzoom)&&(i=n)}),i&&this.options.showTileBoundaries&&pn.debug(this,i,i.getVisibleCoordinates())}this.options.showPadding&&function(t){const e=t.transform.padding;nn(t,t.transform.height-(e.top||0),3,Ki),nn(t,e.bottom||0,3,Ji),rn(t,e.left||0,3,Qi),rn(t,t.transform.width-(e.right||0),3,tn);const i=t.transform.centerPoint;!function(t,e,i,n){on(t,e-1,i-10,2,20,n),on(t,e-10,i-1,20,2,n)}(t,i.x,t.transform.height-i.y,en)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%t.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(t.window.performance.now()),this.saveCanvasCopy())}renderLayer(t,e,i,n){i.isHidden(this.transform.zoom)||("background"===i.type||"sky"===i.type||"custom"===i.type||n&&n.length)&&(this.id=i.id,this.gpuTimingStart(i),pn[i.type](t,e,i,n,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const e=this.context.extTimerQuery;let i=this.gpuTimers[t.id];i||(i=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:e.createQueryEXT()}),i.calls++,e.beginQueryEXT(e.TIME_ELAPSED_EXT,i.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}queryGpuTimers(t){const e={};for(const i in t){const n=t[i],r=this.context.extTimerQuery,o=r.getQueryObjectEXT(n.query,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(n.query),e[i]=o}return e}translatePosMatrix(e,i,n,r,o){if(!n[0]&&!n[1])return e;const a=o?"map"===r?this.transform.angle:0:"viewport"===r?-this.transform.angle:0;if(a){const t=Math.sin(a),e=Math.cos(a);n=[n[0]*e-n[1]*t,n[0]*t+n[1]*e]}const s=[o?n[0]:k(i,n[0],this.transform.zoom),o?n[1]:k(i,n[1],this.transform.zoom),0],l=new Float32Array(16);return t.translate(l,e,s),l}saveTileTexture(t){const e=this._tileTextures[t.size[0]];e?e.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const e=this._tileTextures[t];return e&&e.length>0?e.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const e=this.imageManager.getPattern(t.from.toString()),i=this.imageManager.getPattern(t.to.toString());return!e||!i}currentGlobalDefines(){const t=this.terrain&&this.terrain.renderingToTexture,e=this.style&&this.style.fog,i=[];return this.terrain&&!this.terrain.renderingToTexture&&i.push("TERRAIN"),e&&!t&&0!==e.getOpacity(this.transform.pitch)&&i.push("FOG"),t&&i.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&i.push("OVERDRAW_INSPECTOR"),i}useProgram(t,e,i){this.cache=this.cache||{};const n=i||[],r=this.currentGlobalDefines().concat(n),o=di.cacheKey(t,r,e);return this.cache[o]||(this.cache[o]=new di(this.context,t,qe[t],e,Fi[t],r)),this.cache[o]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=t.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new t.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(t){this.terrain&&this.terrain.prepareDrawTile(t)}prepareDrawProgram(t,e,i){if(this.terrain&&this.terrain.renderingToTexture)return;const n=this.style.fog;if(n){const r=n.getOpacity(this.transform.pitch);0!==r&&e.setFogUniformValues(t,((t,e,i,n)=>{const r=e.properties.get("color"),o=t.frameCounter/1e3%1,a=[r.r/r.a,r.g/r.a,r.b/r.a,n];return{u_fog_matrix:i?t.transform.calculateFogTileMatrix(i):t.identityMat,u_fog_range:e.getFovAdjustedRange(t.transform._fov),u_fog_color:a,u_fog_horizon_blend:e.properties.get("horizon-blend"),u_fog_temporal_offset:o}})(this,n,i,r))}}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const t=this.context.gl,e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),e}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&0!==t.getOpacity(this.transform.pitch)}}class fn{constructor(t=0,e=0,i=0,n=0){if(isNaN(t)||t<0||isNaN(e)||e<0||isNaN(i)||i<0||isNaN(n)||n<0)throw Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=e,this.left=i,this.right=n}interpolate(e,i,n){return null!=i.top&&null!=e.top&&(this.top=t.number(e.top,i.top,n)),null!=i.bottom&&null!=e.bottom&&(this.bottom=t.number(e.bottom,i.bottom,n)),null!=i.left&&null!=e.left&&(this.left=t.number(e.left,i.left,n)),null!=i.right&&null!=e.right&&(this.right=t.number(e.right,i.right,n)),this}getCenter(e,i){const n=t.clamp((this.left+e-this.right)/2,0,e),r=t.clamp((this.top+i-this.bottom)/2,0,i);return new t.pointGeometry(n,r)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new fn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function mn(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}function gn(t,e,i){t[4*e+0]=i[0],t[4*e+1]=i[1],t[4*e+2]=i[2],t[4*e+3]=i[3]}function yn(e,i){const n=mn(e,3);t.fromQuat(e,i),gn(e,3,n)}function vn(t,e){gn(t,3,[e[0],e[1],e[2],1])}function _n(e,i){const n=t.identity$1([]);return t.rotateZ$1(n,n,-i),t.rotateX$1(n,n,-e),n}function xn(e,i){const n=[e[0],e[1],0],r=[i[0],i[1],0];if(t.length(n)>=1e-15){const e=t.normalize([],n);t.scale(r,e,t.dot(r,e)),i[0]=r[0],i[1]=r[1]}const o=t.cross([],i,e);if(t.len(o)<1e-15)return null;const a=Math.atan2(-o[1],o[0]);return _n(Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2]),a)}class bn{constructor(t,e){this.position=t,this.orientation=e}get position(){return this._position}set position(e){this._position=this._renderWorldCopies?function(e){if(!e)return;const i=Array.isArray(e)?new t.MercatorCoordinate(e[0],e[1],e[2]):e;return i.x=t.wrap(i.x,0,1),i}(e):e}lookAtPoint(e,i){if(this.orientation=null,!this.position)return;const n=this._elevation?this._elevation.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(e)):0,r=this.position,o=t.MercatorCoordinate.fromLngLat(e,n),a=[o.x-r.x,o.y-r.y,o.z-r.z];i||(i=[0,0,1]),i[2]=Math.abs(i[2]),this.orientation=xn(a,i)}setPitchBearing(e,i){this.orientation=_n(t.degToRad(e),t.degToRad(-i))}}class wn{constructor(e,i){this._transform=t.identity([]),this._orientation=t.identity$1([]),i&&(this._orientation=i,yn(this._transform,this._orientation)),e&&vn(this._transform,e)}get mercatorPosition(){const e=this.position;return new t.MercatorCoordinate(e[0],e[1],e[2])}get position(){const t=mn(this._transform,3);return[t[0],t[1],t[2]]}set position(t){vn(this._transform,t)}get orientation(){return this._orientation}set orientation(t){this._orientation=t,yn(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),e=this.right();return{bearing:Math.atan2(-e[1],e[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,e){this._orientation=_n(t,e),yn(this._transform,this._orientation)}forward(){const t=mn(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=mn(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=mn(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(e,i){const n=new Float64Array(16);return t.invert(n,this.getWorldToCamera(e,i)),n}getWorldToCameraPosition(e,i,n){const r=this.position;t.scale(r,r,-e);const o=new Float64Array(16);return t.fromScaling(o,[n,n,n]),t.translate(o,o,r),o[10]*=i,o}getWorldToCamera(e,i){const n=new Float64Array(16),r=new Float64Array(4),o=this.position;return t.conjugate(r,this._orientation),t.scale(o,o,-e),t.fromQuat(n,r),t.translate(n,n,o),n[1]*=-1,n[5]*=-1,n[9]*=-1,n[13]*=-1,n[8]*=i,n[9]*=i,n[10]*=i,n[11]*=i,n}getCameraToClipPerspective(e,i,n,r){const o=new Float64Array(16);return t.perspective(o,e,i,n,r),o}getDistanceToElevation(e){const i=0===e?0:t.mercatorZfromAltitude(e,this.position[1]),n=this.forward();return(i-this.position[2])/n[2]}clone(){return new wn([...this.position],[...this.orientation])}}class Sn{constructor(e,i,n,r,o){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===o||o,this._minZoom=e||0,this._maxZoom=i||22,this._minPitch=null==n?0:n,this._maxPitch=null==r?60:r,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new fn,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._camera=new wn,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._horizonShift=.1}clone(){const t=new Sn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t.tileSize=this.tileSize,t.latRange=this.latRange,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._cameraZoom=this._cameraZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._averageElevation=this._averageElevation,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,t?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices())}updateElevation(t){this._terrainEnabled()&&null==this._cameraZoom&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),t&&this._constrainCameraAltitude(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return t.mercatorZfromAltitude(1,this.center.lat)*this.worldSize}get cameraPixelsPerMeter(){return t.mercatorZfromAltitude(1,this.center.lat)*this.cameraWorldSize}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){const i=-t.wrap(e,-180,180)*Math.PI/180;var n;this.angle!==i&&(this._unmodified=!1,this.angle=i,this._calcMatrices(),this.rotationMatrix=(n=new t.ARRAY_TYPE(4),t.ARRAY_TYPE!=Float32Array&&(n[1]=0,n[2]=0),n[0]=1,n[3]=1,n),function(t,e,i){var n=e[0],r=e[1],o=e[2],a=e[3],s=Math.sin(i),l=Math.cos(i);t[0]=n*l+o*s,t[1]=r*l+a*s,t[2]=n*-s+o*l,t[3]=r*-s+a*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const i=t.clamp(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==i&&(this._unmodified=!1,this._pitch=i,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices()}get zoom(){return this._zoom}set zoom(t){const e=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==e&&(this._unmodified=!1,this._setZoom(e),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCenterElevation(){if(!this._elevation)return!1;const e=this._elevation.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(this.center),-1);return-1===e?(this._cameraZoom=null,!1):(this._centerAltitude=e,!0)}_updateCameraOnTerrain(){const e=this.cameraToCenterDistance/this.worldSize,i=t.mercatorZfromAltitude(this._centerAltitude,this.center.lat);this._cameraZoom=this._zoomFromMercatorZ(i+e)}sampleAverageElevation(){if(!this._elevation)return 0;const e=this._elevation,i=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],n=this.horizonLineFromTop();let r=0,o=0;for(let a=0;a<5;a++){const s=new t.pointGeometry(i[a][0]*this.width,n+i[a][1]*(this.height-n)),l=e.pointCoordinate(s);if(!l)continue;const u=1/Math.hypot(l[0]-this._camera.position[0],l[1]-this._camera.position[1]);r+=l[3]*u,o+=u}return 0===o?NaN:r/o}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._cameraZoom||!this._elevation)return;const e=this._cameraZoom,i=this._elevation.getAtPointOrZero(t.MercatorCoordinate.fromLngLat(this.center)),n=t.mercatorZfromAltitude(i,this.center.lat),r=this._mercatorZfromZoom(e),o=this._mercatorZfromZoom(this._maxZoom),a=Math.max(r-n,o);this._setZoom(this._zoomFromMercatorZ(a))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(e){const i=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,e.toAltitude()));let n;n=e.z<this._camera.position[2]?[i.x,i.y,i.z]:[e.x,e.y,e.z];const r=t.length(t.sub([],this._camera.position,n));return t.clamp(this._zoomFromMercatorZ(r),this._minZoom,this._maxZoom)}setFreeCameraOptions(e){if(!this.height)return;if(!e.position&&!e.orientation)return;this._updateCameraState();let i=!1;if(e.orientation&&!t.exactEquals(e.orientation,this._camera.orientation)&&(i=this._setCameraOrientation(e.orientation)),e.position){const n=[e.position.x,e.position.y,e.position.z];t.exactEquals$1(n,this._camera.position)||(this._setCameraPosition(n),i=!0)}i&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const e=this._camera.position,i=new bn;return i.position=new t.MercatorCoordinate(e[0],e[1],e[2]),i.orientation=this._camera.orientation,i._elevation=this.elevation,i._renderWorldCopies=this._renderWorldCopies,i}_setCameraOrientation(e){if(!t.length$1(e))return!1;t.normalize$1(e,e);const i=t.transformQuat([],[0,0,-1],e),n=t.transformQuat([],[0,-1,0],e);if(n[2]<0)return!1;const r=xn(i,n);return!!r&&(this._camera.orientation=r,!0)}_setCameraPosition(e){const i=this.zoomScale(this.minZoom)*this.tileSize,n=this.zoomScale(this.maxZoom)*this.tileSize,r=this.cameraToCenterDistance;e[2]=t.clamp(e[2],r/n,r/i),this._camera.position=e}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,e,i){this._unmodified=!1,this._edgeInsets.interpolate(t,e,i),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const e=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,e)}getVisibleUnwrappedCoordinates(e){const i=[new t.UnwrappedTileID(0,e)];if(this._renderWorldCopies){const n=this.pointCoordinate(new t.pointGeometry(0,0)),r=this.pointCoordinate(new t.pointGeometry(this.width,0)),o=this.pointCoordinate(new t.pointGeometry(this.width,this.height)),a=this.pointCoordinate(new t.pointGeometry(0,this.height)),s=Math.floor(Math.min(n.x,r.x,o.x,a.x)),l=Math.floor(Math.max(n.x,r.x,o.x,a.x)),u=1;for(let n=s-u;n<=l+u;n++)0!==n&&i.push(new t.UnwrappedTileID(n,e))}return i}coveringTiles(e){let i=this.coveringZoomLevel(e);const n=i,r=this.elevation&&!e.isTerrainDEM;if(void 0!==e.minzoom&&i<e.minzoom)return[];void 0!==e.maxzoom&&i>e.maxzoom&&(i=e.maxzoom);const o=t.MercatorCoordinate.fromLngLat(this.center),a=1<<i,s=[a*o.x,a*o.y,0],l=d.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i),u=this.pointCoordinate(this.getCameraPoint()),c=a*t.mercatorZfromAltitude(1,this.center.lat),h=this._camera.position[2]/t.mercatorZfromAltitude(1,this.center.lat),p=[a*u.x,a*u.y,h],m=this.cameraToCenterDistance/e.tileSize*(e.roundZoom?1:.502),g=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation?i:0,y=e.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,v=e.isTerrainDEM?-y:this._elevation?this._elevation.getMinElevationBelowMSL():0,_=t=>({aabb:new f([t*a,0,v],[(t+1)*a,a,y]),zoom:0,x:0,y:0,wrap:t,fullyVisible:!1}),x=[],b=[],w=i,S=e.reparseOverscaled?n:i,T=t=>{if(!this._elevation||!t.tileID)return;const e=this._elevation.getMinMaxForTile(t.tileID),i=t.aabb;e?(i.min[2]=e.min,i.max[2]=e.max,i.center[2]=(i.min[2]+i.max[2])/2):(t.shouldSplit=C(t),t.shouldSplit||(i.min[2]=i.max[2]=i.center[2]=this._centerAltitude))},M=t=>t*t,I=M((h-this._centerAltitude)*c),C=t=>{if(t.zoom<g)return!0;if(t.zoom===w)return!1;if(null!=t.shouldSplit)return t.shouldSplit;const e=t.aabb.distanceX(p),i=t.aabb.distanceY(p);let n=I;r&&(n=M(t.aabb.distanceZ(p)*c));const o=e*e+i*i+n;return o<M((1<<w-t.zoom)*m*((t,e)=>{if(e*M(.707)<t)return 1;const i=Math.sqrt(e/t);return i/(1.4144271570014144+(Math.pow(1.1,i-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(n,I),o))};if(this._renderWorldCopies)for(let t=1;t<=3;t++)x.push(_(-t)),x.push(_(t));for(x.push(_(0));x.length>0;){const n=x.pop(),o=n.x,a=n.y;let u=n.fullyVisible;if(!u){const t=n.aabb.intersects(l);if(0===t)continue;u=2===t}if(n.zoom!==w&&C(n))for(let e=0;e<4;e++){const i=(o<<1)+e%2,s=(a<<1)+(e>>1),l={aabb:n.aabb.quadrant(e),zoom:n.zoom+1,x:i,y:s,wrap:n.wrap,fullyVisible:u,tileID:void 0,shouldSplit:void 0};r&&(l.tileID=new t.OverscaledTileID(n.zoom+1===w?S:n.zoom+1,n.wrap,n.zoom+1,i,s),T(l)),x.push(l)}else{const r=n.zoom===w?S:n.zoom;if(e.minzoom&&e.minzoom>r)continue;const l=s[0]-(.5+o+(n.wrap<<n.zoom))*(1<<i-n.zoom),u=s[1]-.5-a,c=n.tileID?n.tileID:new t.OverscaledTileID(r,n.wrap,n.zoom,o,a);b.push({tileID:c,distanceSq:l*l+u*u})}}if(this.fogCullDistSq){const e=this.fogCullDistSq;b.splice(0,b.length,...b.filter(i=>{const n=[0,0,0,1],o=[t.EXTENT,t.EXTENT,0,1],a=this.calculateFogTileMatrix(i.tileID.toUnwrapped());t.transformMat4(n,n,a),t.transformMat4(o,o,a);const s=t.getAABBPointSquareDist(n,o);if(0===s)return!0;let l=!1;const u=this.horizonLineFromTop();if(s>e&&0!==u){const e=this.calculateProjMatrix(i.tileID.toUnwrapped());let n;r&&this._elevation&&(n=this._elevation.getMinMaxForTile(i.tileID)),n||(n={min:v,max:y});const o=t.furthestTileCorner(this.bearing),a=[o[0]*t.EXTENT,o[1]*t.EXTENT,n.max];t.transformMat4$1(a,a,e),l=(1-a[1])*this.height*.5<u}return s<e||l}))}return b.sort((t,e)=>t.distanceSq-e.distanceSq).map(t=>t.tileID)}resize(t,e){this.width=t,this.height=e,this.pixelsToGLUnits=[2/t,-2/e],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(e){const i=t.clamp(e.lat,-this.maxValidLatitude,this.maxValidLatitude);return new t.pointGeometry(t.mercatorXfromLng(e.lng)*this.worldSize,t.mercatorYfromLat(i)*this.worldSize)}unproject(e){return new t.MercatorCoordinate(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}setLocationAtPoint(e,i){const n=this.pointCoordinate(i),r=this.pointCoordinate(this.centerPoint),o=this.locationCoordinate(e),a=new t.MercatorCoordinate(o.x-(n.x-r.x),o.y-(n.y-r.y));this.center=this.coordinateLocation(a),this._renderWorldCopies&&(this.center=this.center.wrap())}setLocation(t){this.center=this.coordinateLocation(t),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t){return this._coordinatePoint(this.locationCoordinate(t),!1)}locationPoint3D(t){return this._coordinatePoint(this.locationCoordinate(t),!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(e){return t.MercatorCoordinate.fromLngLat(e)}coordinateLocation(t){return t.toLngLat()}pointRayIntersection(e,i){const n=null!=i?i:this._centerAltitude,r=[e.x,e.y,0,1],o=[e.x,e.y,1,1];t.transformMat4(r,r,this.pixelMatrixInverse),t.transformMat4(o,o,this.pixelMatrixInverse);const a=o[3];t.scale$2(r,r,1/r[3]),t.scale$2(o,o,1/a);const s=r[2],l=o[2];return{p0:r,p1:o,t:s===l?0:(n-s)/(l-s)}}screenPointToMercatorRay(e){const i=[e.x,e.y,0,1],n=[e.x,e.y,1,1];return t.transformMat4(i,i,this.pixelMatrixInverse),t.transformMat4(n,n,this.pixelMatrixInverse),t.scale$2(i,i,1/i[3]),t.scale$2(n,n,1/n[3]),i[2]=t.mercatorZfromAltitude(i[2],this._center.lat)*this.worldSize,n[2]=t.mercatorZfromAltitude(n[2],this._center.lat)*this.worldSize,t.scale$2(i,i,1/this.worldSize),t.scale$2(n,n,1/this.worldSize),new p([i[0],i[1],i[2]],t.normalize([],t.sub([],n,i)))}rayIntersectionCoordinate(e){const{p0:i,p1:n,t:r}=e,o=t.mercatorZfromAltitude(i[2],this._center.lat),a=t.mercatorZfromAltitude(n[2],this._center.lat);return new t.MercatorCoordinate(t.number(i[0],n[0],r)/this.worldSize,t.number(i[1],n[1],r)/this.worldSize,t.number(o,a,r))}pointCoordinate(e){const i=this.horizonLineFromTop(!1),n=new t.pointGeometry(e.x,Math.max(i,e.y));return this.rayIntersectionCoordinate(this.pointRayIntersection(n))}pointCoordinate3D(e){if(!this.elevation)return this.pointCoordinate(e);const i=this.elevation;let n=this.elevation.pointCoordinate(e);if(n)return new t.MercatorCoordinate(n[0],n[1],n[2]);let r=0,o=this.horizonLineFromTop();if(e.y>o)return this.pointCoordinate(e);const a=.02*o,s=e.clone();for(let e=0;e<10&&o-r>a;e++){s.y=t.number(r,o,.66);const e=i.pointCoordinate(s);e?(o=s.y,n=e):r=s.y}return n?new t.MercatorCoordinate(n[0],n[1],n[2]):this.pointCoordinate(e)}isPointAboveHorizon(t){if(this.elevation)return!this.elevation.pointCoordinate(t);{const e=this.horizonLineFromTop();return t.y<e}}_coordinatePoint(e,i){const n=i&&this.elevation?this.elevation.getAtPointOrZero(e,this._centerAltitude):this._centerAltitude,r=[e.x*this.worldSize,e.y*this.worldSize,n+e.toAltitude(),1];return t.transformMat4(r,r,this.pixelMatrix),r[3]>0?new t.pointGeometry(r[0]/r[3],r[1]/r[3]):new t.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}getBounds(){return this._terrainEnabled()?this._getBounds3D():(new t.LngLatBounds).extend(this.pointLocation(new t.pointGeometry(this._edgeInsets.left,this._edgeInsets.top))).extend(this.pointLocation(new t.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top))).extend(this.pointLocation(new t.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom))).extend(this.pointLocation(new t.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom)))}_getBounds3D(){const e=this.elevation,i=e.visibleDemTiles.reduce((t,e)=>{if(e.dem){const i=e.dem.tree;t.min=Math.min(t.min,i.minimums[0]),t.max=Math.max(t.max,i.maximums[0])}return t},{min:Number.MAX_VALUE,max:0});i.min*=e.exaggeration(),i.max*=e.exaggeration();const n=this.horizonLineFromTop();return[new t.pointGeometry(0,n),new t.pointGeometry(this.width,n),new t.pointGeometry(this.width,this.height),new t.pointGeometry(0,this.height)].reduce((t,e)=>t.extend(this.coordinateLocation(this.rayIntersectionCoordinate(this.pointRayIntersection(e,i.min)))).extend(this.coordinateLocation(this.rayIntersectionCoordinate(this.pointRayIntersection(e,i.max)))),new t.LngLatBounds)}horizonLineFromTop(t=!0){const e=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,i=this.height/2-.97*e;return t?Math.max(0,i):i}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new t.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(e,i){const n=e.canonical,r=i/this.zoomScale(n.z),o=n.x+Math.pow(2,n.z)*e.wrap,a=t.identity(new Float64Array(16));return t.translate(a,a,[o*r,n.y*r,0]),t.scale$1(a,a,[r/t.EXTENT,r/t.EXTENT,1]),a}calculateFogTileMatrix(e){const i=e.key,n=this._fogTileMatrixCache;if(n[i])return n[i];const r=this.calculatePosMatrix(e,this.cameraWorldSize);return t.multiply(r,this.worldToFogMatrix,r),n[i]=new Float32Array(r),n[i]}calculateProjMatrix(e,i=!1){const n=e.key,r=i?this._alignedProjMatrixCache:this._projMatrixCache;if(r[n])return r[n];const o=this.calculatePosMatrix(e,this.worldSize);return t.multiply(o,i?this.alignedProjMatrix:this.projMatrix,o),r[n]=new Float32Array(o),r[n]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const e=this._elevation;this._updateCameraState();const i=this._camera.position,n=this._camera.forward();if(i[2]<=0||n[2]>=0)return;const r=t.mercatorZfromAltitude(1,this._center.lat);i[2]/=r,n[2]/=r,t.normalize(n,n);const o=e.raycast(i,n,e.exaggeration());if(o){const e=t.scaleAndAdd([],i,n,o),r=new t.MercatorCoordinate(e[0],e[1],t.mercatorZfromAltitude(e[2],t.latFromMercatorY(e[1]))),a=this._camera.position,s=r.z+t.length([r.x-a[0],r.y-a[1],r.z-a[2]]);this._cameraZoom=this._zoomFromMercatorZ(s),this._centerAltitude=r.toAltitude(),this._center=r.toLngLat(),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const e=this._elevation;this._updateCameraState();const i=e.getAtPointOrZero(this._camera.mercatorPosition),n=this._minimumHeightOverTerrain()*Math.cos(t.degToRad(this._maxPitch)),r=t.mercatorZfromAltitude(i,this._center.lat),o=this._camera.position[2]-r;if(o<n){const e=t.MercatorCoordinate.fromLngLat(this._center,this._centerAltitude),i=this._camera.mercatorPosition,r=[e.x-i.x,e.y-i.y,e.z-i.z],a=t.length(r);r[2]-=n-o;const s=t.length(r);if(0===s)return;t.scale(r,r,a/s),this._camera.position=[e.x-r[0],e.y-r[1],e.z-r[2]],this._camera.orientation=xn(r,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let e,i,n,r,o=-90,a=90,s=-180,l=180;const u=this.size,c=this._unmodified;if(this.latRange){const i=this.latRange;o=t.mercatorYfromLat(i[1])*this.worldSize,e=(a=t.mercatorYfromLat(i[0])*this.worldSize)-o<u.y?u.y/(a-o):0}if(this.lngRange){const e=this.lngRange;s=t.mercatorXfromLng(e[0])*this.worldSize,i=(l=t.mercatorXfromLng(e[1])*this.worldSize)-s<u.x?u.x/(l-s):0}const h=this.point,p=Math.max(i||0,e||0);if(p)return this.center=this.unproject(new t.pointGeometry(i?(l+s)/2:h.x,e?(a+o)/2:h.y)),this.zoom+=this.scaleZoom(p),this._unmodified=c,void(this._constraining=!1);if(this.latRange){const t=h.y,e=u.y/2;t-e<o&&(r=o+e),t+e>a&&(r=a-e)}if(this.lngRange){const t=h.x,e=u.x/2;t-e<s&&(n=s+e),t+e>l&&(n=l-e)}void 0===n&&void 0===r||(this.center=this.unproject(new t.pointGeometry(void 0!==n?n:h.x,void 0!==r?r:h.y))),this._constrainCameraAltitude(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){const e=(t,e)=>Math.log2(t/(this.tileSize*Math.abs(e[1]-e[0])));let i=0;if(this.latRange){const n=this.latRange;i=e(this.height,[t.mercatorYfromLat(n[0]),t.mercatorYfromLat(n[1])])}let n=0;if(this.lngRange){const i=this.lngRange;n=e(this.width,[t.mercatorXfromLng(i[0]),t.mercatorXfromLng(i[1])])}return Math.max(i,n)}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const e=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const i=this.pixelsPerMeter;this._updateCameraState();const n=Math.PI/2+this._pitch,r=this.fovAboveCenter,o=this.elevation?this.elevation.getMinElevationBelowMSL()*i:0,a=(this._camera.position[2]*this.worldSize-o)/Math.cos(this._pitch),s=Math.sin(r)*a/Math.sin(t.clamp(Math.PI-n-r,.01,Math.PI-.01)),l=this.point,u=l.x,c=l.y,h=Math.cos(Math.PI/2-this._pitch)*s+a,p=Math.min(1.01*h,a*(1/this._horizonShift)),d=this.height/50,f=this._camera.getWorldToCamera(this.worldSize,i),m=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,d,p);m[8]=2*-e.x/this.width,m[9]=2*e.y/this.height;let g=t.mul$1([],m,f);this.mercatorMatrix=t.scale$1([],g,[this.worldSize,this.worldSize,this.worldSize/i]),this.projMatrix=g,this.invProjMatrix=t.invert(new Float64Array(16),this.projMatrix);const y=new Float32Array(16);t.identity(y),t.scale$1(y,y,[1,-1,1]),t.rotateX(y,y,this._pitch),t.rotateZ(y,y,this.angle);const v=t.perspective(new Float32Array(16),this._fov,this.width/this.height,d,p),_=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;v[8]=2*-e.x/this.width,v[9]=2*(e.y+_)/this.height,this.skyboxMatrix=t.multiply(y,v,y);const x=this.width%2/2,b=this.height%2/2,w=Math.cos(this.angle),S=Math.sin(this.angle),T=u-Math.round(u)+w*x+S*b,M=c-Math.round(c)+w*b+S*x,I=new Float64Array(g);if(t.translate(I,I,[T>.5?T-1:T,M>.5?M-1:M,0]),this.alignedProjMatrix=I,g=t.create$1(),t.scale$1(g,g,[this.width/2,-this.height/2,1]),t.translate(g,g,[1,-1,0]),this.labelPlaneMatrix=g,g=t.create$1(),t.scale$1(g,g,[1,-1,1]),t.translate(g,g,[-1,-1,0]),t.scale$1(g,g,[2/this.width,2/this.height,1]),this.glCoordMatrix=g,this.pixelMatrix=t.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),!(g=t.invert(new Float64Array(16),this.pixelMatrix)))throw Error("failed to invert matrix");this.pixelMatrixInverse=g,this._projMatrixCache={},this._alignedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const e=this.cameraWorldSize,i=this.cameraPixelsPerMeter,n=this._camera.position,r=1/this.height,o=[e,e,i];t.scale(o,o,r),t.scale(n,n,-1),t.multiply$1(n,n,o);const a=t.create$1();t.translate(a,a,n),t.scale$1(a,a,o),this.mercatorFogMatrix=a,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(e,i,r)}_updateCameraState(){if(!this.height)return;this._camera.setPitchBearing(this._pitch,this.angle);const e=this._camera.forward(),i=this.cameraToCenterDistance,n=this.point,r=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)-t.mercatorZfromAltitude(this._centerAltitude,this.center.lat),o=this.cameraToCenterDistance/r;this._camera.position=[n.x/this.worldSize-e[0]*i/o,n.y/this.worldSize-e[1]*i/o,t.mercatorZfromAltitude(this._centerAltitude,this._center.lat)+-e[2]*i/o]}_translateCameraConstrained(e){const i=this._maxCameraBoundsDistance()*Math.cos(this._pitch),n=e[2];let r=1;n>0&&(r=Math.min((i-this._camera.position[2])/n,1)),this._camera.position=t.scaleAndAdd([],this._camera.position,e,r),this._updateStateFromCamera()}_updateStateFromCamera(){const e=this._camera.position,i=this._camera.forward(),{pitch:n,bearing:r}=this._camera.getPitchBearing(),o=t.mercatorZfromAltitude(this._centerAltitude,this.center.lat),a=this._mercatorZfromZoom(this._maxZoom)*Math.cos(t.degToRad(this._maxPitch)),s=Math.max((e[2]-o)/Math.cos(n),a),l=this._zoomFromMercatorZ(s);t.scaleAndAdd(e,e,i,s),this._pitch=t.clamp(n,t.degToRad(this.minPitch),t.degToRad(this.maxPitch)),this.angle=t.wrap(r,-Math.PI,Math.PI),this._setZoom(t.clamp(l,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=new t.MercatorCoordinate(e[0],e[1],e[2]).toLngLat(),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((null!=this._cameraZoom?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}_terrainEnabled(){return!!this._elevation}isHorizonVisibleForPoints(e,i){const n=Math.min(e.x,i.x),r=Math.max(e.x,i.x),o=Math.min(e.y,i.y),a=Math.max(e.y,i.y),s=[new t.pointGeometry(n,o),new t.pointGeometry(r,a),new t.pointGeometry(n,a),new t.pointGeometry(r,o)],l=this._renderWorldCopies?-3:0,u=this._renderWorldCopies?4:1;for(const t of s){const e=this.pointRayIntersection(t);if(e.t<0)return!0;const i=this.rayIntersectionCoordinate(e);if(i.x<l||i.y<0||i.x>u||i.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+t.radToDeg(this.fovAboveCenter)>88||this.isHorizonVisibleForPoints(new t.pointGeometry(0,0),new t.pointGeometry(this.width,this.height))}zoomDeltaToMovement(e,i){const n=t.length(t.sub([],this._camera.position,e)),r=this._zoomFromMercatorZ(n)+i;return n-this._mercatorZfromZoom(r)}getCameraPoint(){const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.pointGeometry(0,e))}}class Tn{constructor(e){this._hashName=e&&encodeURIComponent(e),t.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(t,e){let i=!1,n=null;const r=()=>{n=null,i&&(t(),n=setTimeout(r,300),i=!1)};return()=>(i=!0,n||r(),n)}(this._updateHashUnthrottled.bind(this))}addTo(e){return this._map=e,t.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return t.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(e){const i=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,r=Math.ceil((n*Math.LN2+1.0453677741492975)/Math.LN10),o=Math.pow(10,r),a=Math.round(i.lng*o)/o,s=Math.round(i.lat*o)/o,l=this._map.getBearing(),u=this._map.getPitch();let c="";if(c+=e?`/${a}/${s}/${n}`:`${n}/${s}/${a}`,(l||u)&&(c+="/"+Math.round(10*l)/10),u&&(c+=`/${Math.round(u)}`),this._hashName){const e=this._hashName;let i=!1;const n=t.window.location.hash.slice(1).split("&").map(t=>{const n=t.split("=")[0];return n===e?(i=!0,`${n}=${c}`):t}).filter(t=>t);return i||n.push(`${e}=${c}`),`#${n.join("&")}`}return`#${c}`}_getCurrentHash(){const e=t.window.location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map(t=>t.split("=")).forEach(e=>{e[0]===this._hashName&&(t=e)}),(t&&t[1]||"").split("/")}return e.split("/")}_onHashChange(){const t=this._getCurrentHash();if(t.length>=3&&!t.some(t=>isNaN(t))){const e=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:e,pitch:+(t[4]||0)}),!0}return!1}_updateHashUnthrottled(){const e=t.window.location.href.replace(/(#.+)?$/,this.getHashString());t.window.history.replaceState(t.window.history.state,null,e)}}const Mn={linearity:.3,easing:t.bezier(0,0,.3,1)},In=t.extend({deceleration:2500,maxSpeed:1400},Mn),Cn=t.extend({deceleration:20,maxSpeed:1400},Mn),An=t.extend({deceleration:1e3,maxSpeed:360},Mn),kn=t.extend({deceleration:1e3,maxSpeed:90},Mn);class Dn{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:t.exported.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,i=t.exported.now();for(;e.length>0&&i-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const i={zoom:0,bearing:0,pitch:0,pan:new t.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)i.zoom+=t.zoomDelta||0,i.bearing+=t.bearingDelta||0,i.pitch+=t.pitchDelta||0,t.panDelta&&i.pan._add(t.panDelta),t.around&&(i.around=t.around),t.pinchAround&&(i.pinchAround=t.pinchAround);const n=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,r={};if(i.pan.mag()){const o=Pn(i.pan.mag(),n,t.extend({},In,e||{}));r.offset=i.pan.mult(o.amount/i.pan.mag()),r.center=this._map.transform.center,En(r,o)}if(i.zoom){const t=Pn(i.zoom,n,Cn);r.zoom=this._map.transform.zoom+t.amount,En(r,t)}if(i.bearing){const e=Pn(i.bearing,n,An);r.bearing=this._map.transform.bearing+t.clamp(e.amount,-179,179),En(r,e)}if(i.pitch){const t=Pn(i.pitch,n,kn);r.pitch=this._map.transform.pitch+t.amount,En(r,t)}if(r.zoom||r.bearing){const t=void 0===i.pinchAround?i.around:i.pinchAround;r.around=t?this._map.unproject(t):this._map.getCenter()}return this.clear(),t.extend(r,{noMoveStart:!0})}}function En(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function Pn(e,i,n){const{maxSpeed:r,linearity:o,deceleration:a}=n,s=t.clamp(e*o/(i/1e3),-r,r),l=Math.abs(s)/(a*o);return{easing:n.easing,duration:1e3*l,amount:s*(l/2)}}class Ln extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,n,r={}){const a=o.mousePos(i.getCanvasContainer(),n),s=i.unproject(a);super(e,t.extend({point:a,lngLat:s,originalEvent:n},r)),this._defaultPrevented=!1,this.target=i}}class zn extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,i,n){const r="touchend"===e?n.changedTouches:n.touches,a=o.touchPos(i.getCanvasContainer(),r),s=a.map(t=>i.unproject(t)),l=a.reduce((t,e,i,n)=>t.add(e.div(n.length)),new t.pointGeometry(0,0));super(e,{points:a,point:l,lngLats:s,lngLat:i.unproject(l),originalEvent:n}),this._defaultPrevented=!1}}class On extends t.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,e,i){super(t,{originalEvent:i}),this._defaultPrevented=!1}}class Rn{constructor(t,e){this._map=t,this._clickTolerance=e.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new On(t.type,this._map,t))}mousedown(t,e){return this._mousedownPos=e,this._firePreventable(new Ln(t.type,this._map,t))}mouseup(t){this._map.fire(new Ln(t.type,this._map,t))}click(t,e){this._mousedownPos&&this._mousedownPos.dist(e)>=this._clickTolerance||this._map.fire(new Ln(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Ln(t.type,this._map,t))}mouseover(t){this._map.fire(new Ln(t.type,this._map,t))}mouseout(t){this._map.fire(new Ln(t.type,this._map,t))}touchstart(t){return this._firePreventable(new zn(t.type,this._map,t))}touchmove(t){this._map.fire(new zn(t.type,this._map,t))}touchend(t){this._map.fire(new zn(t.type,this._map,t))}touchcancel(t){this._map.fire(new zn(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Bn{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Ln(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ln("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new Ln(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Nn{constructor(t,e){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=e.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,e){this.isEnabled()&&t.shiftKey&&0===t.button&&(o.disableDrag(),this._startPos=this._lastPos=e,this._active=!0)}mousemoveWindow(t,e){if(!this._active)return;const i=e;if(this._lastPos.equals(i)||!this._box&&i.dist(this._startPos)<this._clickTolerance)return;const n=this._startPos;this._lastPos=i,this._box||(this._box=o.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const r=Math.min(n.x,i.x),a=Math.max(n.x,i.x),s=Math.min(n.y,i.y),l=Math.max(n.y,i.y);this._map._requestDomTask(()=>{this._box&&(o.setTransform(this._box,`translate(${r}px,${s}px)`),this._box.style.width=a-r+"px",this._box.style.height=l-s+"px")})}mouseupWindow(e,i){if(!this._active)return;if(0!==e.button)return;const n=this._startPos,r=i;if(this.reset(),o.suppressClick(),n.x!==r.x||n.y!==r.y)return this._map.fire(new t.Event("boxzoomend",{originalEvent:e})),{cameraAnimation:t=>t.fitScreenCoordinates(n,r,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",e)}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(o.remove(this._box),this._box=null),o.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,i){return this._map.fire(new t.Event(e,{originalEvent:i}))}}function Fn(t,e){const i={};for(let n=0;n<t.length;n++)i[t[n].identifier]=e[n];return i}class Vn{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,i,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),n.length===this.numTouches&&(this.centroid=function(e){const i=new t.pointGeometry(0,0);for(const t of e)i._add(t);return i.div(e.length)}(i),this.touches=Fn(n,i)))}touchmove(t,e,i){if(this.aborted||!this.centroid)return;const n=Fn(i,e);for(const t in this.touches){const e=this.touches[t],i=n[t];(!i||i.dist(e)>30)&&(this.aborted=!0)}}touchend(t,e,i){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===i.length){const t=!this.aborted&&this.centroid;if(this.reset(),t)return t}}}class Un{constructor(t){this.singleTap=new Vn(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,e,i){this.singleTap.touchstart(t,e,i)}touchmove(t,e,i){this.singleTap.touchmove(t,e,i)}touchend(t,e,i){const n=this.singleTap.touchend(t,e,i);if(n){const e=t.timeStamp-this.lastTime<500,i=!this.lastTap||this.lastTap.dist(n)<30;if(e&&i||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}}}class Gn{constructor(){this._zoomIn=new Un({numTouches:1,numTaps:2}),this._zoomOut=new Un({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,e,i){this._zoomIn.touchstart(t,e,i),this._zoomOut.touchstart(t,e,i)}touchmove(t,e,i){this._zoomIn.touchmove(t,e,i),this._zoomOut.touchmove(t,e,i)}touchend(t,e,i){const n=this._zoomIn.touchend(t,e,i),r=this._zoomOut.touchend(t,e,i);return n?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()+1,around:e.unproject(n)},{originalEvent:t})}):r?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:e=>e.easeTo({duration:300,zoom:e.getZoom()-1,around:e.unproject(r)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const $n={0:1,2:2};class Wn{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(t,e){return!1}_move(t,e){return{}}mousedown(t,e){if(this._lastPoint)return;const i=o.mouseButton(t);this._correctButton(t,i)&&(this._lastPoint=e,this._eventButton=i)}mousemoveWindow(t,e){const i=this._lastPoint;if(i)if(t.preventDefault(),function(t,e){const i=$n[e];return void 0===t.buttons||(t.buttons&i)!==i}(t,this._eventButton))this.reset();else if(this._moved||!(e.dist(i)<this._clickTolerance))return this._moved=!0,this._lastPoint=e,this._move(i,e)}mouseupWindow(t){this._lastPoint&&o.mouseButton(t)===this._eventButton&&(this._moved&&o.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hn extends Wn{mousedown(t,e){super.mousedown(t,e),this._lastPoint&&(this._active=!0)}_correctButton(t,e){return 0===e&&!t.ctrlKey}_move(t,e){return{around:e,panDelta:e.sub(t)}}}class jn extends Wn{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const i=.8*(e.x-t.x);if(i)return this._active=!0,{bearingDelta:i}}contextmenu(t){t.preventDefault()}}class Zn extends Wn{_correctButton(t,e){return 0===e&&t.ctrlKey||2===e}_move(t,e){const i=-.5*(e.y-t.y);if(i)return this._active=!0,{pitchDelta:i}}contextmenu(t){t.preventDefault()}}class qn{constructor(t){this._minTouches=1,this._clickTolerance=t.clickTolerance||1,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new t.pointGeometry(0,0)}touchstart(t,e,i){return this._calculateTransform(t,e,i)}touchmove(t,e,i){if(this._active&&!(i.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,e,i)}touchend(t,e,i){this._calculateTransform(t,e,i),this._active&&i.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,i,n){n.length>0&&(this._active=!0);const r=Fn(n,i),o=new t.pointGeometry(0,0),a=new t.pointGeometry(0,0);let s=0;for(const t in r){const e=r[t],i=this._touches[t];i&&(o._add(e),a._add(e.sub(i)),s++,r[t]=e)}if(this._touches=r,s<this._minTouches||!a.mag())return;const l=a.div(s);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:o.div(s),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xn{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(t){}_move(t,e,i){return{}}touchstart(t,e,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([e[0],e[1]]))}touchmove(t,e,i){if(!this._firstTwoTouches)return;t.preventDefault();const[n,r]=this._firstTwoTouches,o=Yn(i,e,n),a=Yn(i,e,r);if(!o||!a)return;const s=this._aroundCenter?null:o.add(a).div(2);return this._move([o,a],s,t)}touchend(t,e,i){if(!this._firstTwoTouches)return;const[n,r]=this._firstTwoTouches,a=Yn(i,e,n),s=Yn(i,e,r);a&&s||(this._active&&o.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Yn(t,e,i){for(let n=0;n<t.length;n++)if(t[n].identifier===i)return e[n]}function Kn(t,e){return Math.log(t/e)/Math.LN2}class Jn extends Xn{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,e){const i=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Kn(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Kn(this._distance,i),pinchAround:e}}}function Qn(t,e){return 180*t.angleWith(e)/Math.PI}class tr extends Xn{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,e){const i=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Qn(this._vector,i),pinchAround:e}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const e=25/(Math.PI*this._minDiameter)*360,i=Qn(t,this._startVector);return Math.abs(i)<e}}function er(t){return Math.abs(t.y)>Math.abs(t.x)}class ir extends Xn{reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(t){this._lastPoints=t,er(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,e,i){const n=t[0].sub(this._lastPoints[0]),r=t[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(n,r,i.timeStamp),this._valid)return this._lastPoints=t,this._active=!0,{pitchDelta:(n.y+r.y)/2*-.5}}gestureBeginsVertically(t,e,i){if(void 0!==this._valid)return this._valid;const n=t.mag()>=2,r=e.mag()>=2;if(!n&&!r)return;if(!n||!r)return void 0===this._firstMove&&(this._firstMove=i),i-this._firstMove<100&&void 0;const o=t.y>0==e.y>0;return er(t)&&er(e)&&o}}const nr={panStep:100,bearingStep:15,pitchStep:10};class rr{constructor(){const t=nr;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let e=0,i=0,n=0,r=0,o=0;switch(t.keyCode){case 61:case 107:case 171:case 187:e=1;break;case 189:case 109:case 173:e=-1;break;case 37:t.shiftKey?i=-1:(t.preventDefault(),r=-1);break;case 39:t.shiftKey?i=1:(t.preventDefault(),r=1);break;case 38:t.shiftKey?n=1:(t.preventDefault(),o=-1);break;case 40:t.shiftKey?n=-1:(t.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(i=0,n=0),{cameraAnimation:a=>{const s=a.getZoom();a.easeTo({duration:300,easeId:"keyboardHandler",easing:or,zoom:e?Math.round(s)+e*(t.shiftKey?2:1):s,bearing:a.getBearing()+i*this._bearingStep,pitch:a.getPitch()+n*this._pitchStep,offset:[-r*this._panStep,-o*this._panStep],center:a.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function or(t){return t*(2-t)}const ar=4.000244140625;class sr{constructor(e,i){this._map=e,this._el=e.getCanvasContainer(),this._handler=i,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,t.bindAll(["_onTimeout"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&"center"===t.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(e){if(!this.isEnabled())return;let i=e.deltaMode===t.window.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const n=t.exported.now(),r=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==i&&i%ar==0?this._type="wheel":0!==i&&Math.abs(i)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=i,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(r*i)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,i+=this._lastValue)),e.shiftKey&&i&&(i/=4),this._type&&(this._lastWheelEvent=e,this._delta-=i,this._active||this._start(e)),e.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const e=o.mousePos(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:e,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const e=this._map.transform,i=()=>e._terrainEnabled()?e.computeZoomRelativeTo(this._aroundCoord):e.zoom;if(0!==this._delta){const t="wheel"===this._type&&Math.abs(this._delta)>ar?this._wheelZoomRate:this._defaultZoomRate;let n=2/(1+Math.exp(-Math.abs(this._delta*t)));this._delta<0&&0!==n&&(n=1/n);const r=i(),o=Math.pow(2,r),a="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):o;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(a*n))),"wheel"===this._type&&(this._startZoom=i(),this._easing=this._smoothOutEasing(200)),this._delta=0}const n="number"==typeof this._targetZoom?this._targetZoom:i(),r=this._startZoom,o=this._easing;let a,s=!1;if("wheel"===this._type&&r&&o){const e=Math.min((t.exported.now()-this._lastWheelEventTime)/200,1),i=o(e);a=t.number(r,n,i),e<1?this._frameId||(this._frameId=!0):s=!0}else a=n,s=!0;return this._active=!0,s&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!s,zoomDelta:a-i(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let i=t.ease;if(this._prevEase){const e=this._prevEase,n=(t.exported.now()-e.start)/e.duration,r=e.easing(n+.01)-e.easing(n),o=.27/Math.sqrt(r*r+1e-4)*.01,a=Math.sqrt(.0729-o*o);i=t.bezier(o,a,.25,1)}return this._prevEase={start:t.exported.now(),duration:e,easing:i},i}reset(){this._active=!1}}class lr{constructor(t,e){this._clickZoom=t,this._tapZoom=e}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ur{constructor(){this.reset()}reset(){this._active=!1}dblclick(t,e){return t.preventDefault(),{cameraAnimation:i=>{i.easeTo({duration:300,zoom:i.getZoom()+(t.shiftKey?-1:1),around:i.unproject(e)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class cr{constructor(){this._tap=new Un({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(t,e,i){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?i.length>0&&(this._swipePoint=e[0],this._swipeTouch=i[0].identifier):this._tap.touchstart(t,e,i))}touchmove(t,e,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;const n=e[0],r=n.y-this._swipePoint.y;return this._swipePoint=n,t.preventDefault(),this._active=!0,{zoomDelta:r/128}}}else this._tap.touchmove(t,e,i)}touchend(t,e,i){this._tapTime?this._swipePoint&&0===i.length&&this.reset():this._tap.touchend(t,e,i)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hr{constructor(t,e,i){this._el=t,this._mousePan=e,this._touchPan=i}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class pr{constructor(t,e,i){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=e,this._mousePitch=i}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class dr{constructor(t,e,i,n){this._el=t,this._touchZoom=e,this._touchRotate=i,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const fr=t=>t.zoom||t.drag||t.pitch||t.rotate;class mr extends t.Event{}class gr{constructor(){this.constants=[1,1,.01],this.radius=0}setup(e,i){const n=t.sub([],i,e);this.radius=t.length(n[2]<0?t.div([],n,this.constants):[n[0],n[1],0])}projectRay(e){t.div(e,e,this.constants),t.normalize(e,e),t.mul$2(e,e,this.constants);const i=t.scale([],e,this.radius);if(i[2]>0){const e=t.scale([],[0,0,1],t.dot(i,[0,0,1])),n=t.scale([],t.normalize([],[i[0],i[1],0]),this.radius),r=t.add([],i,t.scale([],t.sub([],t.add([],n,e),i),2));i[0]=r[0],i[1]=r[1]}return i}}function yr(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}class vr{constructor(e,i){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Dn(e),this._bearingSnap=i.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new gr,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(i),t.bindAll(["handleEvent","handleWindowEvent"],this);const n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[t.window.document,"mousemove",{capture:!0}],[t.window.document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[t.window,"blur",void 0]];for(const[e,i,n]of this._listeners)o.addEventListener(e,i,e===t.window.document?this.handleWindowEvent:this.handleEvent,n)}destroy(){for(const[e,i,n]of this._listeners)o.removeEventListener(e,i,e===t.window.document?this.handleWindowEvent:this.handleEvent,n)}_addDefaultHandlers(t){const e=this._map,i=e.getCanvasContainer();this._add("mapEvent",new Rn(e,t));const n=e.boxZoom=new Nn(e,t);this._add("boxZoom",n);const r=new Gn,o=new ur;e.doubleClickZoom=new lr(o,r),this._add("tapZoom",r),this._add("clickZoom",o);const a=new cr;this._add("tapDragZoom",a);const s=e.touchPitch=new ir;this._add("touchPitch",s);const l=new jn(t),u=new Zn(t);e.dragRotate=new pr(t,l,u),this._add("mouseRotate",l,["mousePitch"]),this._add("mousePitch",u,["mouseRotate"]);const c=new Hn(t),h=new qn(t);e.dragPan=new hr(i,c,h),this._add("mousePan",c),this._add("touchPan",h,["touchZoom","touchRotate"]);const p=new tr,d=new Jn;e.touchZoomRotate=new dr(i,d,p,a),this._add("touchRotate",p,["touchPan","touchZoom"]),this._add("touchZoom",d,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Bn(e));const f=e.scrollZoom=new sr(e,this);this._add("scrollZoom",f,["mousePan"]);const m=e.keyboard=new rr;this._add("keyboard",m);for(const i of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[i]&&e[i].enable(t[i])}_add(t,e,i){this._handlers.push({handlerName:t,handler:e,allowed:i}),this._handlersById[t]=e}stop(t){if(!this._updatingCamera){for(const{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!fr(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,e,i){for(const n in t)if(n!==i&&(!e||e.indexOf(n)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const e=[];for(const i of t)this._el.contains(i.target)&&e.push(i);return e}handleEvent(t,e){if("blur"===t.type)return void this.stop(!0);this._updatingCamera=!0;const i="renderFrame"===t.type,n=i?void 0:t,r={needsRenderFrame:!1},a={},s={},l=t.touches?this._getMapTouches(t.touches):void 0,u=l?o.touchPos(this._el,l):i?void 0:o.mousePos(this._el,t);for(const{handlerName:i,handler:o,allowed:c}of this._handlers){if(!o.isEnabled())continue;let h;this._blockedByActive(s,c,i)?o.reset():o[e||t.type]&&(h=o[e||t.type](t,u,l),this.mergeHandlerResult(r,a,h,i,n),h&&h.needsRenderFrame&&this._triggerRenderFrame()),(h||o.isActive())&&(s[i]=o)}const c={};for(const t in this._previousActiveHandlers)s[t]||(c[t]=n);this._previousActiveHandlers=s,(Object.keys(c).length||yr(r))&&(this._changes.push([r,a,c]),this._triggerRenderFrame()),(Object.keys(s).length||yr(r))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:h}=r;h&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],h(this._map))}mergeHandlerResult(e,i,n,r,o){if(!n)return;t.extend(e,n);const a={handlerName:r,originalEvent:n.originalEvent||o};void 0!==n.zoomDelta&&(i.zoom=a),void 0!==n.panDelta&&(i.drag=a),void 0!==n.pitchDelta&&(i.pitch=a),void 0!==n.bearingDelta&&(i.rotate=a)}_applyChanges(){const e={},i={},n={};for(const[r,o,a]of this._changes)r.panDelta&&(e.panDelta=(e.panDelta||new t.pointGeometry(0,0))._add(r.panDelta)),r.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+r.zoomDelta),r.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+r.bearingDelta),r.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+r.pitchDelta),void 0!==r.around&&(e.around=r.around),void 0!==r.aroundCoord&&(e.aroundCoord=r.aroundCoord),void 0!==r.pinchAround&&(e.pinchAround=r.pinchAround),r.noInertia&&(e.noInertia=r.noInertia),t.extend(i,o),t.extend(n,a);this._updateMapTransform(e,i,n),this._changes=[]}_updateMapTransform(e,i,n){const r=this._map,o=r.transform,a=t=>[t.x,t.y,t.z];if((t=>{const e=this._eventsInProgress.drag;return e&&!this._handlersById[e.handlerName].isActive()})()&&!yr(e)){const t=o.zoom;o.cameraElevationReference="sea",o.recenterOnTerrain(),o.cameraElevationReference="ground",t!==o.zoom&&this._map._update(!0)}if(!yr(e))return this._fireEvents(i,n,!0);let{panDelta:s,zoomDelta:l,bearingDelta:u,pitchDelta:c,around:h,aroundCoord:p,pinchAround:d}=e;void 0!==d&&(h=d),(t=>i.drag&&!this._eventsInProgress.drag)()&&h&&(this._dragOrigin=a(o.pointCoordinate3D(h)),this._trackingEllipsoid.setup(o._camera.position,this._dragOrigin)),o.cameraElevationReference="sea",r._stop(!0),h=h||r.transform.centerPoint,u&&(o.bearing+=u),c&&(o.pitch+=c),o._updateCameraState();const f=[0,0,0];if(s){const t=o.screenPointToMercatorRay(h),e=o.screenPointToMercatorRay(h.sub(s)),i=this._trackingEllipsoid.projectRay(t.dir),n=this._trackingEllipsoid.projectRay(e.dir);f[0]=n[0]-i[0],f[1]=n[1]-i[1]}const m=o.zoom,g=[0,0,0];if(l){const e=a(p||o.pointCoordinate3D(h)),i={dir:t.normalize([],t.sub([],e,o._camera.position))},n=o.screenPointToMercatorRay(o.centerPoint);if(i.dir[2]<0){const r=t.altitudeFromMercatorZ(e[2],e[1]),s=o.rayIntersectionCoordinate(o.pointRayIntersection(o.centerPoint,r)),u=o.zoomDeltaToMovement(a(s),l)*(n.dir[2]/i.dir[2]);t.scale(g,i.dir,u)}else if(o._terrainEnabled()){const n=o.zoomDeltaToMovement(e,l);t.scale(g,i.dir,n)}}const y=t.add(f,f,g);o._translateCameraConstrained(y),l&&Math.abs(o.zoom-m)>1e-4&&o.recenterOnTerrain(),o.cameraElevationReference="ground",this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(i,n,!0)}_fireEvents(e,i,n){const r=fr(this._eventsInProgress),o=fr(e),a={};for(const t in e){const{originalEvent:i}=e[t];this._eventsInProgress[t]||(a[`${t}start`]=i),this._eventsInProgress[t]=e[t]}!r&&o&&this._fireEvent("movestart",o.originalEvent);for(const t in a)this._fireEvent(t,a[t]);o&&this._fireEvent("move",o.originalEvent);for(const t in e){const{originalEvent:i}=e[t];this._fireEvent(t,i)}const s={};let l;for(const t in this._eventsInProgress){const{handlerName:e,originalEvent:n}=this._eventsInProgress[t];this._handlersById[e].isActive()||(delete this._eventsInProgress[t],l=i[e]||n,s[`${t}end`]=l)}for(const t in s)this._fireEvent(t,s[t]);const u=fr(this._eventsInProgress);if(n&&(r||o)&&!u){this._updatingCamera=!0;const e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),i=t=>0!==t&&-this._bearingSnap<t&&t<this._bearingSnap;e?(i(e.bearing||this._map.getBearing())&&(e.bearing=0),this._map.easeTo(e,{originalEvent:l})):(this._map.fire(new t.Event("moveend",{originalEvent:l})),i(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,i){this._map.fire(new t.Event(e,i?{originalEvent:i}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new mr("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class _r extends t.Evented{constructor(e,i){super(),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=i.bearingSnap,t.bindAll(["_renderFrameCallback"],this)}getCenter(){return new t.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,e){return this.jumpTo({center:t},e)}panBy(e,i,n){return e=t.pointGeometry.convert(e).mult(-1),this.panTo(this.transform.center,t.extend({offset:e},i),n)}panTo(e,i,n){return this.easeTo(t.extend({center:e},i),n)}getZoom(){return this.transform.zoom}setZoom(t,e){return this.jumpTo({zoom:t},e),this}zoomTo(e,i,n){return this.easeTo(t.extend({zoom:e},i),n)}zoomIn(t,e){return this.zoomTo(this.getZoom()+1,t,e),this}zoomOut(t,e){return this.zoomTo(this.getZoom()-1,t,e),this}getBearing(){return this.transform.bearing}setBearing(t,e){return this.jumpTo({bearing:t},e),this}getPadding(){return this.transform.padding}setPadding(t,e){return this.jumpTo({padding:t},e),this}rotateTo(e,i,n){return this.easeTo(t.extend({bearing:e},i),n)}resetNorth(e,i){return this.rotateTo(0,t.extend({duration:1e3},e),i),this}resetNorthPitch(e,i){return this.easeTo(t.extend({bearing:0,pitch:0,duration:1e3},e),i),this}snapToNorth(t,e){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,e):this}getPitch(){return this.transform.pitch}setPitch(t,e){return this.jumpTo({pitch:t},e),this}cameraForBounds(e,i){e=t.LngLatBounds.convert(e);const n=i&&i.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),n,i)}_extendCameraOptions(e){const i={top:0,bottom:0,right:0,left:0};if("number"==typeof(e=t.extend({padding:i,offset:[0,0],maxZoom:this.transform.maxZoom},e)).padding){const t=e.padding;e.padding={top:t,bottom:t,right:t,left:t}}return e.padding=t.extend(i,e.padding),e}_cameraForBoxAndBearing(e,i,n,r){const o=this._extendCameraOptions(r),a=this.transform,s=a.padding,l=a.project(t.LngLat.convert(e)),u=a.project(t.LngLat.convert(i)),c=l.rotate(-t.degToRad(n)),h=u.rotate(-t.degToRad(n)),p=new t.pointGeometry(Math.max(c.x,h.x),Math.max(c.y,h.y)),d=new t.pointGeometry(Math.min(c.x,h.x),Math.min(c.y,h.y)),f=p.sub(d),m=(a.width-(s.left+s.right+o.padding.left+o.padding.right))/f.x,g=(a.height-(s.top+s.bottom+o.padding.top+o.padding.bottom))/f.y;if(g<0||m<0)return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const y=Math.min(a.scaleZoom(a.scale*Math.min(m,g)),o.maxZoom),v="number"==typeof o.offset.x?new t.pointGeometry(o.offset.x,o.offset.y):t.pointGeometry.convert(o.offset),_=new t.pointGeometry((o.padding.left-o.padding.right)/2,(o.padding.top-o.padding.bottom)/2).rotate(n*Math.PI/180),x=v.add(_).mult(a.scale/a.zoomScale(y));return{center:a.unproject(l.add(u).div(2).sub(x)),zoom:y,bearing:n}}_cameraForBox(e,i,n,r,o){const a=this._extendCameraOptions(o);n=n||0,r=r||0,e=t.LngLat.convert(e),i=t.LngLat.convert(i);const s=this.transform.clone();s.padding=a.padding;const l=this.getFreeCameraOptions(),u=new t.LngLat(.5*(e.lng+i.lng),.5*(e.lat+i.lat)),c=.5*(n+r);if(s._camera.position[2]<t.mercatorZfromAltitude(c,u.lat))return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");l.lookAtPoint(u),s.setFreeCameraOptions(l);const h=t.MercatorCoordinate.fromLngLat(e),p=t.MercatorCoordinate.fromLngLat(i),m=s.pointRayIntersection(s.centerPoint,c),g=[(y=s.rayIntersectionCoordinate(m)).x,y.y,y.z];var y;const v=s.screenPointToMercatorRay(s.centerPoint);let _,x=0;do{const i=Math.floor(s.zoom),o=1<<i,a=Math.min(o*h.x,o*p.x),l=Math.min(o*h.y,o*p.y),u=Math.max(o*h.x,o*p.x),c=Math.max(o*h.y,o*p.y),m=new f([a,l,n],[u,c,r]),y=d.fromInvProjectionMatrix(s.invProjMatrix,s.worldSize,i);if(2!==m.intersects(y)){_&&(s._camera.position=t.scaleAndAdd([],s._camera.position,v.dir,-_),s._updateStateFromCamera());break}const x=t.sub([],s._camera.position,g);_=.5*t.length(x),s._camera.position=t.scaleAndAdd([],s._camera.position,v.dir,_);try{s._updateStateFromCamera()}catch(e){return void t.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++x<10);return{center:s.center,zoom:s.zoom,bearing:s.bearing,pitch:s.pitch}}fitBounds(t,e,i){return this._fitInternal(this.cameraForBounds(t,e),e,i)}_raycastElevationBox(e,i){const n=this.transform.elevation;if(!n)return;const r=new t.pointGeometry(e.x,i.y),o=new t.pointGeometry(i.x,e.y),a=n.pointCoordinate(e);if(!a)return;const s=n.pointCoordinate(i);if(!s)return;const l=n.pointCoordinate(r);if(!l)return;const u=n.pointCoordinate(o);if(!u)return;const c=new t.MercatorCoordinate(a[0],a[1]).toLngLat(),h=new t.MercatorCoordinate(s[0],s[1]).toLngLat(),p=new t.MercatorCoordinate(l[0],l[1]).toLngLat(),d=new t.MercatorCoordinate(u[0],u[1]).toLngLat(),f=Math.min(c.lng,Math.min(h.lng,Math.min(p.lng,d.lng))),m=Math.min(c.lat,Math.min(h.lat,Math.min(p.lat,d.lat))),g=Math.max(c.lng,Math.max(h.lng,Math.max(p.lng,d.lng))),y=Math.max(c.lat,Math.max(h.lat,Math.max(p.lat,d.lat))),v=Math.min(a[3],Math.min(s[3],Math.min(l[3],u[3]))),_=Math.max(a[3],Math.max(s[3],Math.max(l[3],u[3])));return{minLngLat:new t.LngLat(f,m),maxLngLat:new t.LngLat(g,y),minAltitude:v,maxAltitude:_}}fitScreenCoordinates(e,i,n,r,o){let a,s,l,u;const c=t.pointGeometry.convert(e),h=t.pointGeometry.convert(i),p=this._raycastElevationBox(c,h);if(p)a=p.minLngLat,s=p.maxLngLat,l=p.minAltitude,u=p.maxAltitude;else{if(this.transform.isHorizonVisibleForPoints(c,h))return this;a=this.transform.pointLocation(c),s=this.transform.pointLocation(h)}return this._fitInternal(0===this.transform.pitch?this._cameraForBoxAndBearing(this.transform.pointLocation(t.pointGeometry.convert(e)),this.transform.pointLocation(t.pointGeometry.convert(i)),n,r):this._cameraForBox(a,s,l,u,r),r,o)}_fitInternal(e,i,n){return e?(delete(i=t.extend(e,i)).padding,i.linear?this.easeTo(i,n):this.flyTo(i,n)):this}jumpTo(e,i){this.stop();const n=this.transform;let r=!1,o=!1,a=!1;return"zoom"in e&&n.zoom!==+e.zoom&&(r=!0,n.zoom=+e.zoom),void 0!==e.center&&(n.center=t.LngLat.convert(e.center)),"bearing"in e&&n.bearing!==+e.bearing&&(o=!0,n.bearing=+e.bearing),"pitch"in e&&n.pitch!==+e.pitch&&(a=!0,n.pitch=+e.pitch),null==e.padding||n.isPaddingEqual(e.padding)||(n.padding=e.padding),this.fire(new t.Event("movestart",i)).fire(new t.Event("move",i)),r&&this.fire(new t.Event("zoomstart",i)).fire(new t.Event("zoom",i)).fire(new t.Event("zoomend",i)),o&&this.fire(new t.Event("rotatestart",i)).fire(new t.Event("rotate",i)).fire(new t.Event("rotateend",i)),a&&this.fire(new t.Event("pitchstart",i)).fire(new t.Event("pitch",i)).fire(new t.Event("pitchend",i)),this.fire(new t.Event("moveend",i))}getFreeCameraOptions(){return this.transform.getFreeCameraOptions()}setFreeCameraOptions(e,i){this.stop();const n=this.transform,r=n.zoom,o=n.pitch,a=n.bearing;n.setFreeCameraOptions(e);const s=r!==n.zoom,l=o!==n.pitch,u=a!==n.bearing;return this.fire(new t.Event("movestart",i)).fire(new t.Event("move",i)),s&&this.fire(new t.Event("zoomstart",i)).fire(new t.Event("zoom",i)).fire(new t.Event("zoomend",i)),u&&this.fire(new t.Event("rotatestart",i)).fire(new t.Event("rotate",i)).fire(new t.Event("rotateend",i)),l&&this.fire(new t.Event("pitchstart",i)).fire(new t.Event("pitch",i)).fire(new t.Event("pitchend",i)),this.fire(new t.Event("moveend",i)),this}easeTo(e,i){this._stop(!1,e.easeId),(!1===(e=t.extend({offset:[0,0],duration:500,easing:t.ease},e)).animate||!e.essential&&t.exported.prefersReducedMotion)&&(e.duration=0);const n=this.transform,r=this.getZoom(),o=this.getBearing(),a=this.getPitch(),s=this.getPadding(),l="zoom"in e?+e.zoom:r,u="bearing"in e?this._normalizeBearing(e.bearing,o):o,c="pitch"in e?+e.pitch:a,h="padding"in e?e.padding:n.padding,p=t.pointGeometry.convert(e.offset);let d=n.centerPoint.add(p);const f=n.pointLocation(d),m=t.LngLat.convert(e.center||f);this._normalizeCenter(m);const g=n.project(f),y=n.project(m).sub(g),v=n.zoomScale(l-r);let _,x;e.around&&(_=t.LngLat.convert(e.around),x=n.locationPoint(_));const b={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||l!==r,this._rotating=this._rotating||o!==u,this._pitching=this._pitching||c!==a,this._padding=!n.isPaddingEqual(h),this._easeId=e.easeId,this._prepareEase(i,e.noMoveStart,b),this._ease(e=>{if(this._zooming&&(n.zoom=t.number(r,l,e)),this._rotating&&(n.bearing=t.number(o,u,e)),this._pitching&&(n.pitch=t.number(a,c,e)),this._padding&&(n.interpolatePadding(s,h,e),d=n.centerPoint.add(p)),_)n.setLocationAtPoint(_,x);else{const t=n.zoomScale(n.zoom-r),i=l>r?Math.min(2,v):Math.max(.5,v),o=Math.pow(i,1-e),a=n.unproject(g.add(y.mult(e*o)).mult(t));n.setLocationAtPoint(n.renderWorldCopies?a.wrap():a,d)}this._fireMoveEvents(i)},t=>{n.recenterOnTerrain(),this._afterEase(i,t)},e),this}_prepareEase(e,i,n={}){this._moving=!0,this.transform.cameraElevationReference="sea",i||n.moving||this.fire(new t.Event("movestart",e)),this._zooming&&!n.zooming&&this.fire(new t.Event("zoomstart",e)),this._rotating&&!n.rotating&&this.fire(new t.Event("rotatestart",e)),this._pitching&&!n.pitching&&this.fire(new t.Event("pitchstart",e))}_fireMoveEvents(e){this.fire(new t.Event("move",e)),this._zooming&&this.fire(new t.Event("zoom",e)),this._rotating&&this.fire(new t.Event("rotate",e)),this._pitching&&this.fire(new t.Event("pitch",e))}_afterEase(e,i){if(this._easeId&&i&&this._easeId===i)return;delete this._easeId,this.transform.cameraElevationReference="ground";const n=this._zooming,r=this._rotating,o=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,n&&this.fire(new t.Event("zoomend",e)),r&&this.fire(new t.Event("rotateend",e)),o&&this.fire(new t.Event("pitchend",e)),this.fire(new t.Event("moveend",e))}flyTo(e,i){if(!e.essential&&t.exported.prefersReducedMotion){const n=t.pick(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(n,i)}this.stop(),e=t.extend({offset:[0,0],speed:1.2,curve:1.42,easing:t.ease},e);const n=this.transform,r=this.getZoom(),o=this.getBearing(),a=this.getPitch(),s=this.getPadding(),l="zoom"in e?t.clamp(+e.zoom,n.minZoom,n.maxZoom):r,u="bearing"in e?this._normalizeBearing(e.bearing,o):o,c="pitch"in e?+e.pitch:a,h="padding"in e?e.padding:n.padding,p=n.zoomScale(l-r),d=t.pointGeometry.convert(e.offset);let f=n.centerPoint.add(d);const m=n.pointLocation(f),g=t.LngLat.convert(e.center||m);this._normalizeCenter(g);const y=n.project(m),v=n.project(g).sub(y);let _=e.curve;const x=Math.max(n.width,n.height),b=x/p,w=v.mag();if("minZoom"in e){const i=t.clamp(Math.min(e.minZoom,r,l),n.minZoom,n.maxZoom),o=x/n.zoomScale(i-r);_=Math.sqrt(o/w*2)}const S=_*_;function T(t){const e=(b*b-x*x+(t?-1:1)*S*S*w*w)/(2*(t?b:x)*S*w);return Math.log(Math.sqrt(e*e+1)-e)}function M(t){return(Math.exp(t)-Math.exp(-t))/2}function I(t){return(Math.exp(t)+Math.exp(-t))/2}const C=T(0);let A=function(t){return I(C)/I(C+_*t)},k=function(t){return x*((I(C)*(M(e=C+_*t)/I(e))-M(C))/S)/w;var e},D=(T(1)-C)/_;if(Math.abs(w)<1e-6||!isFinite(D)){if(Math.abs(x-b)<1e-6)return this.easeTo(e,i);const t=b<x?-1:1;D=Math.abs(Math.log(b/x))/_,k=function(){return 0},A=function(e){return Math.exp(t*_*e)}}return e.duration="duration"in e?+e.duration:1e3*D/("screenSpeed"in e?+e.screenSpeed/_:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=o!==u,this._pitching=c!==a,this._padding=!n.isPaddingEqual(h),this._prepareEase(i,!1),this._ease(e=>{const p=e*D,m=1/A(p);n.zoom=1===e?l:r+n.scaleZoom(m),this._rotating&&(n.bearing=t.number(o,u,e)),this._pitching&&(n.pitch=t.number(a,c,e)),this._padding&&(n.interpolatePadding(s,h,e),f=n.centerPoint.add(d));const _=1===e?g:n.unproject(y.add(v.mult(k(p))).mult(m));n.setLocationAtPoint(n.renderWorldCopies?_.wrap():_,f),n._updateCenterElevation(),this._fireMoveEvents(i)},()=>this._afterEase(i),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,e){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const t=this._onEaseEnd;delete this._onEaseEnd,t.call(this,e)}if(!t){const t=this.handlers;t&&t.stop(!1)}return this}_ease(e,i,n){!1===n.animate||0===n.duration?(e(1),i()):(this._easeStart=t.exported.now(),this._easeOptions=n,this._onEaseFrame=e,this._onEaseEnd=i,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const e=Math.min((t.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(e,i){e=t.wrap(e,-180,180);const n=Math.abs(e-i);return Math.abs(e-360-i)<n&&(e-=360),Math.abs(e+360-i)<n&&(e+=360),e}_normalizeCenter(t){const e=this.transform;if(!e.renderWorldCopies||e.lngRange)return;const i=t.lng-e.center.lng;t.lng+=i>180?-360:i<-180?360:0}}class xr{constructor(e={}){this.options=e,t.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const e=this.options&&this.options.compact;return this._map=t,this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=o.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=o.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),e&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===e&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){o.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,e){const i=this._map._getUIString(`AttributionControl.${e}`);t.title=i,t.setAttribute("aria-label",i)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))}_updateEditLink(){let e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));const i=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||t.config.ACCESS_TOKEN}];if(e){const n=i.reduce((t,e,n)=>(e.value&&(t+=`${e.key}=${e.value}${n<i.length-1?"&":""}`),t),"?");e.href=`${t.config.FEEDBACK_URL}/${n}${this._map._hash?this._map._hash.getHashString(!0):""}`,e.rel="noopener nofollow",this._setElementTitle(e,"MapFeedback")}}_updateData(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(t=>"string"!=typeof t?"":t)):"string"==typeof this.options.customAttribution&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}const e=this._map.style._sourceCaches;for(const i in e){const n=e[i];if(n.used){const e=n.getSource();e.attribution&&t.indexOf(e.attribution)<0&&t.push(e.attribution)}}t.sort((t,e)=>t.length-e.length);const i=(t=t.filter((e,i)=>{for(let n=i+1;n<t.length;n++)if(t[n].indexOf(e)>=0)return!1;return!0})).join(" | ");i!==this._attribHTML&&(this._attribHTML=i,t.length?(this._innerContainer.innerHTML=i,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class br{constructor(){t.bindAll(["_updateLogo"],this),t.bindAll(["_updateCompact"],this)}onAdd(t){this._map=t,this._container=o.create("div","mapboxgl-ctrl");const e=o.create("a","mapboxgl-ctrl-logo");return e.target="_blank",e.rel="noopener nofollow",e.href="https://www.mapbox.com/",e.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),e.setAttribute("rel","noopener nofollow"),this._container.appendChild(e),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){o.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(0===Object.entries(t).length)return!0;for(const e in t){const i=t[e].getSource();if(i.hasOwnProperty("mapbox_logo")&&!i.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const e=t[0];this._map.getCanvasContainer().offsetWidth<250?e.classList.add("mapboxgl-compact"):e.classList.remove("mapboxgl-compact")}}}class wr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e}remove(t){const e=this._currentlyRunning,i=e?this._queue.concat(e):this._queue;for(const e of i)if(e.id===t)return void(e.cancelled=!0)}run(t=0){const e=this._currentlyRunning=this._queue;this._queue=[];for(const i of e)if(!i.cancelled&&(i.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Sr(e,i,n){if(e=new t.LngLat(e.lng,e.lat),i){const r=new t.LngLat(e.lng-360,e.lat),o=new t.LngLat(e.lng+360,e.lat),a=360*Math.ceil(Math.abs(e.lng-n.center.lng)/360),s=n.locationPoint(e).distSqr(i),l=i.x<0||i.y<0||i.x>n.width||i.y>n.height;n.locationPoint(r).distSqr(i)<s&&(l||Math.abs(r.lng-n.center.lng)<a)?e=r:n.locationPoint(o).distSqr(i)<s&&(l||Math.abs(o.lng-n.center.lng)<a)&&(e=o)}for(;Math.abs(e.lng-n.center.lng)>180;){const t=n.locationPoint(e);if(t.x>=0&&t.y>=0&&t.x<=n.width&&t.y<=n.height)break;e.lng>n.center.lng?e.lng-=360:e.lng+=360}return e}const Tr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Mr(t,e,i){const n=t.classList;for(const t in Tr)n.remove(`mapboxgl-${i}-anchor-${t}`);n.add(`mapboxgl-${i}-anchor-${e}`)}class Ir extends t.Evented{constructor(e,i){if(super(),(e instanceof t.window.HTMLElement||i)&&(e=t.extend({element:e},i)),t.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&"auto"!==e.pitchAlignment?e.pitchAlignment:this._rotationAlignment,e&&e.element)this._element=e.element,this._offset=t.pointGeometry.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=o.create("div"),this._element.setAttribute("aria-label","Map marker");const i=o.createNS("http://www.w3.org/2000/svg","svg"),n=41,r=27;i.setAttributeNS(null,"display","block"),i.setAttributeNS(null,"height",`${n}px`),i.setAttributeNS(null,"width",`${r}px`),i.setAttributeNS(null,"viewBox",`0 0 ${r} ${n}`);const a=o.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");const s=o.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");const l=o.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");const u=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const t of u){const e=o.createNS("http://www.w3.org/2000/svg","ellipse");e.setAttributeNS(null,"opacity","0.04"),e.setAttributeNS(null,"cx","10.5"),e.setAttributeNS(null,"cy","5.80029008"),e.setAttributeNS(null,"rx",t.rx),e.setAttributeNS(null,"ry",t.ry),l.appendChild(e)}const c=o.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"fill",this._color);const h=o.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),c.appendChild(h);const p=o.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"opacity","0.25"),p.setAttributeNS(null,"fill","#000000");const d=o.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),p.appendChild(d);const f=o.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"transform","translate(6.0, 7.0)"),f.setAttributeNS(null,"fill","#FFFFFF");const m=o.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(8.0, 8.0)");const g=o.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");const y=o.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#FFFFFF"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962"),m.appendChild(g),m.appendChild(y),s.appendChild(l),s.appendChild(c),s.appendChild(p),s.appendChild(f),s.appendChild(m),i.appendChild(s),i.setAttributeNS(null,"height",n*this._scale+"px"),i.setAttributeNS(null,"width",r*this._scale+"px"),this._element.appendChild(i),this._offset=t.pointGeometry.convert(e&&e.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",t=>{t.preventDefault()}),this._element.addEventListener("mousedown",t=>{t.preventDefault()}),Mr(this._element,this._anchor,"marker"),this._popup=null}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._map.off("remove",this._clearFadeTimer),this._map._removeMarker(this),delete this._map),this._clearFadeTimer(),o.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const e=38.1,i=13.5,n=Math.sqrt(Math.pow(i,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-e],"bottom-left":[n,-1*(e-i+n)],"bottom-right":[-n,-1*(e-i+n)],left:[i,-1*(e-i)],right:[-i,-1*(e-i)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(t){const e=t.code,i=t.charCode||t.keyCode;"Space"!==e&&"Enter"!==e&&32!==i&&13!==i||this.togglePopup()}_onMapClick(t){const e=t.originalEvent.target,i=this._element;this._popup&&(e===i||i.contains(e))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this}_evaluateOpacity(){const t=this._pos?this._pos.sub(this._transformedOffset()):null;if(!this._withinScreenBounds(t))return void this._clearFadeTimer();const e=this._map.unproject(t);let i=!1;if(this._map.getTerrain()){const t=this._map.getFreeCameraOptions();if(t.position){const n=t.position.toLngLat();i=n.distanceTo(e)<.9*n.distanceTo(this._lngLat)}}const n=(1-this._map._queryFogOpacity(e))*(i?.2:1);this._element.style.opacity=`${n}`,this._popup&&this._popup._setOpacity(`${n}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_withinScreenBounds(t){const e=this._map.transform;return!!t&&t.x>=0&&t.x<e.width&&t.y>=0&&t.y<e.height}_update(t){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Sr(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset());let e="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?e=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(e=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let i="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?i="rotateX(0deg)":"map"===this._pitchAlignment&&(i=`rotateX(${this._map.getPitch()}deg)`),t&&"moveend"!==t.type||(this._pos=this._pos.round()),this._map._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&o.setTransform(this._element,`${Tr[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${i} ${e}`),!this._map.getTerrain()&&!this._map.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})}_transformedOffset(){if(!this._defaultMarker)return this._offset;const t=this._map.transform,e=this._offset.mult(this._scale);return"map"===this._rotationAlignment&&e._rotate(t.angle),"map"===this._pitchAlignment&&(e.y*=Math.cos(t._pitch)),e}getOffset(){return this._offset}setOffset(e){return this._offset=t.pointGeometry.convert(e),this._update(),this}_onMove(e){if(!this._isDragging){const t=this._clickTolerance||this._map._clickTolerance;this._isDragging=e.point.dist(this._pointerdownPos)>=t}this._isDragging&&(this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.Event("dragstart"))),this.fire(new t.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.Event("dragend")),this._state="inactive"}_addDragHandler(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&"auto"!==t?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class Cr{constructor(t){this.jumpTo(t)}getValue(e){if(e<=this._startTime)return this._start;if(e>=this._endTime)return this._end;const i=t.easeCubicInOut((e-this._startTime)/(this._endTime-this._startTime));return this._start*(1-i)+this._end*i}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,e,i){this._start=this.getValue(e),this._end=t,this._startTime=e,this._endTime=e+i}}const Ar={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},{HTMLImageElement:kr,HTMLElement:Dr,ImageBitmap:Er}=t.window,Pr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function Lr(t){t.parentNode&&t.parentNode.removeChild(t)}const zr={showCompass:!0,showZoom:!0,visualizePitch:!1};class Or{constructor(e,i,n=!1){this._clickTolerance=10,this.element=i,this.mouseRotate=new jn({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,n&&(this.mousePitch=new Zn({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),t.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),o.addEventListener(i,"mousedown",this.mousedown),o.addEventListener(i,"touchstart",this.touchstart,{passive:!1}),o.addEventListener(i,"touchmove",this.touchmove),o.addEventListener(i,"touchend",this.touchend),o.addEventListener(i,"touchcancel",this.reset)}down(t,e){this.mouseRotate.mousedown(t,e),this.mousePitch&&this.mousePitch.mousedown(t,e),o.disableDrag()}move(t,e){const i=this.map,n=this.mouseRotate.mousemoveWindow(t,e);if(n&&n.bearingDelta&&i.setBearing(i.getBearing()+n.bearingDelta),this.mousePitch){const n=this.mousePitch.mousemoveWindow(t,e);n&&n.pitchDelta&&i.setPitch(i.getPitch()+n.pitchDelta)}}off(){const t=this.element;o.removeEventListener(t,"mousedown",this.mousedown),o.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),o.removeEventListener(t,"touchmove",this.touchmove),o.removeEventListener(t,"touchend",this.touchend),o.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){o.enableDrag(),o.removeEventListener(t.window,"mousemove",this.mousemove),o.removeEventListener(t.window,"mouseup",this.mouseup)}mousedown(e){this.down(t.extend({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),o.mousePos(this.element,e)),o.addEventListener(t.window,"mousemove",this.mousemove),o.addEventListener(t.window,"mouseup",this.mouseup)}mousemove(t){this.move(t,o.mousePos(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=o.touchPos(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){1!==t.targetTouches.length?this.reset():(this._lastPos=o.touchPos(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Rr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Br,Nr=0,Fr=!1;const Vr={maxWidth:100,unit:"metric"};function Ur(t,e,i){const n=i&&i.maxWidth||100,r=t._container.clientHeight/2,o=t.unproject([0,r]),a=t.unproject([n,r]),s=o.distanceTo(a);if(i&&"imperial"===i.unit){const i=3.2808*s;i>5280?Gr(e,n,i/5280,t._getUIString("ScaleControl.Miles"),t):Gr(e,n,i,t._getUIString("ScaleControl.Feet"),t)}else i&&"nautical"===i.unit?Gr(e,n,s/1852,t._getUIString("ScaleControl.NauticalMiles"),t):s>=1e3?Gr(e,n,s/1e3,t._getUIString("ScaleControl.Kilometers"),t):Gr(e,n,s,t._getUIString("ScaleControl.Meters"),t)}function Gr(t,e,i,n,r){const o=function(t){const e=Math.pow(10,`${Math.floor(t)}`.length-1);let i=t/e;return e*(i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:i>=1?1:function(t){const e=Math.pow(10,Math.ceil(-Math.log(t)/Math.LN10));return Math.round(t*e)/e}(i))}(i),a=o/i;r._requestDomTask(()=>{t.style.width=e*a+"px",t.innerHTML=`${o}&nbsp;${n}`})}const $r={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Wr="a[href], [tabindex]:not([tabindex='-1']), [contenteditable]:not([contenteditable='false']), button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled])";function Hr(e){if(e){if("number"==typeof e){const i=Math.round(Math.sqrt(.5*Math.pow(e,2)));return{center:new t.pointGeometry(0,0),top:new t.pointGeometry(0,e),"top-left":new t.pointGeometry(i,i),"top-right":new t.pointGeometry(-i,i),bottom:new t.pointGeometry(0,-e),"bottom-left":new t.pointGeometry(i,-i),"bottom-right":new t.pointGeometry(-i,-i),left:new t.pointGeometry(e,0),right:new t.pointGeometry(-e,0)}}if(e instanceof t.pointGeometry||Array.isArray(e)){const i=t.pointGeometry.convert(e);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:t.pointGeometry.convert(e.center||[0,0]),top:t.pointGeometry.convert(e.top||[0,0]),"top-left":t.pointGeometry.convert(e["top-left"]||[0,0]),"top-right":t.pointGeometry.convert(e["top-right"]||[0,0]),bottom:t.pointGeometry.convert(e.bottom||[0,0]),"bottom-left":t.pointGeometry.convert(e["bottom-left"]||[0,0]),"bottom-right":t.pointGeometry.convert(e["bottom-right"]||[0,0]),left:t.pointGeometry.convert(e.left||[0,0]),right:t.pointGeometry.convert(e.right||[0,0])}}return Hr(new t.pointGeometry(0,0))}const jr={version:t.version,supported:e,setRTLTextPlugin:t.setRTLTextPlugin,getRTLTextPluginStatus:t.getRTLTextPluginStatus,Map:class extends _r{constructor(e){if(null!=(e=t.extend({},Pr,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>85)throw Error("maxPitch must be less than or equal to 85");if(super(new Sn(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),e),this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._optimizeForTerrain=e.optimizeForTerrain,this._renderTaskQueue=new wr,this._domRenderTaskQueue=new wr,this._controls=[],this._markers=[],this._mapId=t.uniqueId(),this._locale=t.extend({},Ar,e.locale),this._clickTolerance=e.clickTolerance,this._averageElevationLastSampledAt=-1/0,this._averageElevation=new Cr(0),this._requestManager=new t.RequestManager(e.transformRequest,e.accessToken,e.testMode),this._silenceAuthErrors=!!e.testMode,"string"==typeof e.container){if(this._container=t.window.document.getElementById(e.container),!this._container)throw Error(`Container '${e.container}' not found.`)}else{if(!(e.container instanceof Dr))throw Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),t.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==t.window&&(t.window.addEventListener("online",this._onWindowOnline,!1),t.window.addEventListener("resize",this._onWindowResize,!1),t.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new vr(this,e),this._hash=e.hash&&new Tn("string"==typeof e.hash&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,t.extend({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localFontFamily=e.localFontFamily,this._localIdeographFontFamily=e.localIdeographFontFamily,e.style&&this.setStyle(e.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),e.attributionControl&&this.addControl(new xr({customAttribution:e.customAttribution})),this._logoControl=new br,this.addControl(this._logoControl,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",e=>{this._update("style"===e.dataType),this.fire(new t.Event(`${e.dataType}data`,e))}),this.on("dataloading",e=>{this.fire(new t.Event(`${e.dataType}dataloading`,e))})}_getMapId(){return this._mapId}addControl(e,i){if(void 0===i&&(i=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.ErrorEvent(Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=e.onAdd(this);this._controls.push(e);const r=this._controlPositions[i];return-1!==i.indexOf("bottom")?r.insertBefore(n,r.firstChild):r.appendChild(n),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new t.ErrorEvent(Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(e);return i>-1&&this._controls.splice(i,1),e.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}resize(e){const i=this._containerDimensions(),n=i[0],r=i[1];this._resizeCanvas(n,r),this.transform.resize(n,r),this.painter.resize(n,r);const o=!this._moving;return o&&(this.stop(),this.fire(new t.Event("movestart",e)).fire(new t.Event("move",e))),this.fire(new t.Event("resize",e)),o&&this.fire(new t.Event("moveend",e)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(t.LngLatBounds.convert(e)),this._update()}setMinZoom(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t&&this.setZoom(t),this;throw Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t&&this.setZoom(t),this;throw Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=null==t?0:t)<0)throw Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t&&this.setPitch(t),this;throw Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=null==t?85:t)>85)throw Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t&&this.setPitch(t),this;throw Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.renderWorldCopies=t,this._update()}project(e){return this.transform.locationPoint3D(t.LngLat.convert(e))}unproject(e){return this.transform.pointLocation3D(t.pointGeometry.convert(e))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()}_createDelegatedListener(t,e,i){if("mouseenter"===t||"mouseover"===t){let n=!1;const r=r=>{const o=this.getLayer(e)?this.queryRenderedFeatures(r.point,{layers:[e]}):[];o.length?n||(n=!0,i.call(this,new Ln(t,this,r.originalEvent,{features:o}))):n=!1};return{layer:e,listener:i,delegates:{mousemove:r,mouseout:()=>{n=!1}}}}if("mouseleave"===t||"mouseout"===t){let n=!1;const r=r=>{(this.getLayer(e)?this.queryRenderedFeatures(r.point,{layers:[e]}):[]).length?n=!0:n&&(n=!1,i.call(this,new Ln(t,this,r.originalEvent)))},o=e=>{n&&(n=!1,i.call(this,new Ln(t,this,e.originalEvent)))};return{layer:e,listener:i,delegates:{mousemove:r,mouseout:o}}}{const n=t=>{const n=this.getLayer(e)?this.queryRenderedFeatures(t.point,{layers:[e]}):[];n.length&&(t.features=n,i.call(this,t),delete t.features)};return{layer:e,listener:i,delegates:{[t]:n}}}}on(t,e,i){if(void 0===i)return super.on(t,e);const n=this._createDelegatedListener(t,e,i);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(n);for(const t in n.delegates)this.on(t,n.delegates[t]);return this}once(t,e,i){if(void 0===i)return super.once(t,e);const n=this._createDelegatedListener(t,e,i);for(const t in n.delegates)this.once(t,n.delegates[t]);return this}off(t,e,i){return void 0===i?super.off(t,e):(this._delegatedListeners&&this._delegatedListeners[t]&&(n=>{const r=this._delegatedListeners[t];for(let t=0;t<r.length;t++){const n=r[t];if(n.layer===e&&n.listener===i){for(const t in n.delegates)this.off(t,n.delegates[t]);return r.splice(t,1),this}}})(),this)}queryRenderedFeatures(e,i){return this.style?(void 0!==i||void 0===e||e instanceof t.pointGeometry||Array.isArray(e)||(i=e,e=void 0),this.style.queryRenderedFeatures(e=e||[[0,0],[this.transform.width,this.transform.height]],i=i||{},this.transform)):[]}querySourceFeatures(t,e){return this.style.querySourceFeatures(t,e)}setStyle(e,i){return!1!==(i=t.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&i.localFontFamily===this._localFontFamily&&this.style&&e?(this._diffStyle(e,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(e,i))}_getUIString(t){const e=this._locale[t];if(null==e)throw Error(`Missing UI string '${t}'`);return e}_updateStyle(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),t&&(this.style=new Ue(this,e||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ue(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,i){if("string"==typeof e){const n=this._requestManager.normalizeStyleURL(e),r=this._requestManager.transformRequest(n,t.ResourceType.Style);t.getJSON(r,(e,n)=>{e?this.fire(new t.ErrorEvent(e)):n&&this._updateDiff(n,i)})}else"object"==typeof e&&this._updateDiff(e,i)}_updateDiff(e,i){try{this.style.setState(e)&&this._update(!0)}catch(n){t.warnOnce(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(e,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():t.warnOnce("There is no style added to the map.")}addSource(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)}isSourceLoaded(e){const i=this.style&&this.style._getSourceCaches(e);if(0!==i.length)return i.every(t=>t.loaded());this.fire(new t.ErrorEvent(Error(`There is no source with ID '${e}'`)))}areTilesLoaded(){const t=this.style&&this.style._sourceCaches;for(const e in t){const i=t[e]._tiles;for(const t in i){const e=i[t];if("loaded"!==e.state&&"errored"!==e.state)return!1}}return!0}addSourceType(t,e,i){return this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,i)}removeSource(t){return this.style.removeSource(t),this._updateTerrain(),this._update(!0)}getSource(t){return this.style.getSource(t)}addImage(e,i,{pixelRatio:n=1,sdf:r=!1,stretchX:o,stretchY:a,content:s}={}){if(this._lazyInitEmptyStyle(),i instanceof kr||Er&&i instanceof Er){const{width:l,height:u,data:c}=t.exported.getImageData(i);this.style.addImage(e,{data:new t.RGBAImage({width:l,height:u},c),pixelRatio:n,stretchX:o,stretchY:a,content:s,sdf:r,version:0})}else{if(void 0===i.width||void 0===i.height)return this.fire(new t.ErrorEvent(Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:l,height:u,data:c}=i,h=i;this.style.addImage(e,{data:new t.RGBAImage({width:l,height:u},new Uint8Array(c)),pixelRatio:n,stretchX:o,stretchY:a,content:s,sdf:r,version:0,userImage:h}),h.onAdd&&h.onAdd(this,e)}}}updateImage(e,i){const n=this.style.getImage(e);if(!n)return this.fire(new t.ErrorEvent(Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const r=i instanceof kr||Er&&i instanceof Er?t.exported.getImageData(i):i,{width:o,height:a,data:s}=r;return void 0===o||void 0===a?this.fire(new t.ErrorEvent(Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):o!==n.data.width||a!==n.data.height?this.fire(new t.ErrorEvent(Error("The width and height of the updated image must be that same as the previous version of the image"))):(n.data.replace(s,!(i instanceof kr||Er&&i instanceof Er)),void this.style.updateImage(e,n))}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new t.ErrorEvent(Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t)}loadImage(e,i){t.getImage(this._requestManager.transformRequest(e,t.ResourceType.Image),(e,n)=>{i(e,n instanceof kr?t.exported.getImageData(n):n)})}listImages(){return this.style.listImages()}addLayer(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)}moveLayer(t,e){return this.style.moveLayer(t,e),this._update(!0)}removeLayer(t){return this.style.removeLayer(t),this._update(!0)}getLayer(t){return this.style.getLayer(t)}setLayerZoomRange(t,e,i){return this.style.setLayerZoomRange(t,e,i),this._update(!0)}setFilter(t,e,i={}){return this.style.setFilter(t,e,i),this._update(!0)}getFilter(t){return this.style.getFilter(t)}setPaintProperty(t,e,i,n={}){return this.style.setPaintProperty(t,e,i,n),this._update(!0)}getPaintProperty(t,e){return this.style.getPaintProperty(t,e)}setLayoutProperty(t,e,i,n={}){return this.style.setLayoutProperty(t,e,i,n),this._update(!0)}getLayoutProperty(t,e){return this.style.getLayoutProperty(t,e)}setLight(t,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(t,e),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(t){return this._lazyInitEmptyStyle(),this.style.setTerrain(t),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(t){return this._lazyInitEmptyStyle(),this.style.setFog(t),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(e){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(t.LngLat.convert(e),this.transform):0}queryTerrainElevation(e,i){const n=this.transform.elevation;return n?(i=t.extend({},{exaggerated:!0},i),n.getAtPoint(t.MercatorCoordinate.fromLngLat(e),null,i.exaggerated)):null}setFeatureState(t,e){return this.style.setFeatureState(t,e),this._update()}removeFeatureState(t,e){return this.style.removeFeatureState(t,e),this._update()}getFeatureState(t){return this.style.getFeatureState(t)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let t=0,e=0;return this._container&&(t=this._container.clientWidth||400,e=this._container.clientHeight||300),[t,e]}_detectMissingCSS(){"rgb(250, 128, 114)"!==t.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&t.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=o.create("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();const e=this._canvasContainer=o.create("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=o.create("canvas","mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const i=this._containerDimensions();this._resizeCanvas(i[0],i[1]);const n=this._controlContainer=o.create("div","mapboxgl-control-container",t),r=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(t=>{r[t]=o.create("div",`mapboxgl-ctrl-${t}`,n)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,i){const n=t.exported.devicePixelRatio||1;this._canvas.width=n*e,this._canvas.height=n*i,this._canvas.style.width=`${e}px`,this._canvas.style.height=`${i}px`}_addMarker(t){this._markers.push(t)}_removeMarker(t){const e=this._markers.indexOf(t);-1!==e&&this._markers.splice(e,1)}_setupPainter(){const i=t.extend({},e.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl",i)||this._canvas.getContext("experimental-webgl",i);n?(t.storeAuthState(n,!0),this.painter=new dn(n,this.transform),this.on("data",t=>{"source"===t.dataType&&this.painter.setTileLoadedFlag(!0)}),t.exported$1.testSupport(n)):this.fire(new t.ErrorEvent(Error("Failed to initialize WebGL")))}_contextLost(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new t.Event("webglcontextlost",{originalEvent:e}))}_contextRestored(e){this._setupPainter(),this.resize(),this._update(),this.fire(new t.Event("webglcontextrestored",{originalEvent:e}))}_onMapScroll(t){if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_requestDomTask(t){!this.isMoving()&&this.loaded()?t():this._domRenderTaskQueue.add(t)}_render(e){let i;const n=this.painter.context.extTimerQuery,r=t.exported.now();this.listens("gpu-timing-frame")&&(i=n.createQueryEXT(),n.beginQueryEXT(n.TIME_ELAPSED_EXT,i));let o=this._updateAverageElevation(r);if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._domRenderTaskQueue.run(e),this._removed)return;let a=!1;const s=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const e=this.transform.zoom,i=t.exported.now();this.style.zoomHistory.update(e,i);const n=new t.EvaluationParameters(e,{now:i,fadeDuration:s,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),r=n.crossFadingFactor();1===r&&r===this._crossFadingFactor||(a=!0,this._crossFadingFactor=r),this.style.update(n)}if(this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,s,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:s,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new t.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new t.Event("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const e=t.exported.now()-r;n.endQueryEXT(n.TIME_ELAPSED_EXT,i),setTimeout(()=>{const r=n.getQueryObjectEXT(i,n.QUERY_RESULT_EXT)/1e6;n.deleteQueryEXT(i),this.fire(new t.Event("gpu-timing-frame",{cpuTime:e,gpuTime:r}))},50)}if(this.listens("gpu-timing-layer")){const e=this.painter.collectGpuTimers();setTimeout(()=>{const i=this.painter.queryGpuTimers(e);this.fire(new t.Event("gpu-timing-layer",{layerTimes:i}))},50)}const l=this._sourcesDirty||this._styleDirty||this._placementDirty||o;if(l||this._repaint)this.triggerRepaint();else{const e=!this.isMoving()&&this.loaded();if(e&&(o=this._updateAverageElevation(r,!0)),o)this.triggerRepaint();else if(this._triggerFrame(!1),e&&(this.fire(new t.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const e=this._calculateSpeedIndex();this.fire(new t.Event("speedindexcompleted",{speedIndex:e})),this.speedIndexTiming=!1}}return!this._loaded||this._fullyLoaded||l||(this._fullyLoaded=!0,this._authenticate()),this}_updateAverageElevation(t,e=!1){const i=t=>(this.transform.averageElevation=t,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&i(0);if((e||t-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(t)){const e=this.transform.averageElevation;let n=this.transform.sampleAverageElevation();isNaN(n)?n=0:this._averageElevationLastSampledAt=t;const r=Math.abs(e-n);if(r>1)this._averageElevation.easeTo(n,t,300);else if(r>1e-4)return this._averageElevation.jumpTo(n),i(n)}return!!this._averageElevation.isEasing(t)&&i(this._averageElevation.getValue(t))}_authenticate(){t.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,e=>{if(e&&(e.message===t.AUTH_ERR_MSG||401===e.status)){const e=this.painter.context.gl;t.storeAuthState(e,!1),this._logoControl instanceof br&&this._logoControl._updateLogo(),e&&e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT|e.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new t.ErrorEvent(Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),t.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const t=this.painter.canvasCopy(),e=this.painter.getCanvasCopiesAndTimestamps();e.timeStamps.push(performance.now());const i=this.painter.context.gl,n=i.createFramebuffer();function r(t){i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,t,0);const e=new Uint8Array(i.drawingBufferWidth*i.drawingBufferHeight*4);return i.readPixels(0,0,i.drawingBufferWidth,i.drawingBufferHeight,i.RGBA,i.UNSIGNED_BYTE,e),e}return i.bindFramebuffer(i.FRAMEBUFFER,n),this._canvasPixelComparison(r(t),e.canvasCopies.map(r),e.timeStamps)}_canvasPixelComparison(t,e,i){let n=i[1]-i[0];const r=t.length/4;for(let o=0;o<e.length;o++){const a=e[o];let s=0;for(let e=0;e<a.length;e+=4)a[e]===t[e]&&a[e+1]===t[e+1]&&a[e+2]===t[e+2]&&a[e+3]===t[e+3]&&(s+=1);n+=(i[o+2]-i[o+1])*(1-s/r)}return n}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==t.window&&(t.window.removeEventListener("resize",this._onWindowResize,!1),t.window.removeEventListener("orientationchange",this._onWindowResize,!1),t.window.removeEventListener("online",this._onWindowOnline,!1));const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),Lr(this._canvasContainer),Lr(this._controlContainer),Lr(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),t.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new t.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(e){this._renderNextFrame=this._renderNextFrame||e,this.style&&!this._frame&&(this._frame=t.exported.frame(t=>{const e=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,e&&this._render(t)}))}_onWindowOnline(){this._update()}_onWindowResize(t){this._trackResize&&this.resize({originalEvent:t})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(t){this._showTerrainWireframe!==t&&(this._showTerrainWireframe=t,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(t){this._speedIndexTiming!==t&&(this._speedIndexTiming=t,this._update())}get showPadding(){return!!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())}get repaint(){return!!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(t){this._vertices=t,this._update()}_setCacheLimits(e,i){t.setCacheLimits(e,i)}get version(){return t.version}},NavigationControl:class{constructor(e){this.options=t.extend({},zr,e),this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(t.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),o.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),o.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(t.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=o.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}_updateZoomButtons(){const t=this._map.getZoom(),e=t===this._map.getMaxZoom(),i=t===this._map.getMinZoom();this._zoomInButton.disabled=e,this._zoomOutButton.disabled=i,this._zoomInButton.setAttribute("aria-disabled",e.toString()),this._zoomOutButton.setAttribute("aria-disabled",i.toString())}_rotateCompassArrow(){const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._map._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Or(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){o.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(t,e){const i=o.create("button",t,this._container);return i.type="button",i.addEventListener("click",e),i}_setButtonTitle(t,e){const i=this._map._getUIString(`NavigationControl.${e}`);t.title=i,t.setAttribute("aria-label",i)}},GeolocateControl:class extends t.Evented{constructor(e){super(),this.options=t.extend({},Rr,e),t.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(e){var i;return this._map=e,this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),i=this._setupUI,void 0!==Br?i(Br):void 0!==t.window.navigator.permissions?t.window.navigator.permissions.query({name:"geolocation"}).then(t=>{Br="denied"!==t.state,i(Br)}):(Br=!!t.window.navigator.geolocation,i(Br)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),o.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Nr=0,Fr=!1}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),i=t.coords;return e&&(i.longitude<e.getWest()||i.longitude>e.getEast()||i.latitude<e.getSouth()||i.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.Event("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("geolocate",e)),this._finish()}}_updateCamera(e){const i=new t.LngLat(e.coords.longitude,e.coords.latitude),n=e.coords.accuracy,r=this._map.getBearing(),o=t.extend({bearing:r},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(n),o,{geolocateSource:!0})}_updateMarker(e){if(e){const i=new t.LngLat(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const t=this._map._container.clientHeight/2,e=this._map.unproject([0,t]),i=this._map.unproject([100,t]),n=e.distanceTo(i)/100,r=Math.ceil(2*this._accuracy/n);this._circleElement.style.width=`${r}px`,this._circleElement.style.height=`${r}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&Fr)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new t.Event("error",e)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(e){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=o.create("button","mapboxgl-ctrl-geolocate",this._container),o.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===e){t.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=o.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Ir(this._dotElement),this._circleElement=o.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ir({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",e=>{e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new t.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return t.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Nr--,Fr=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new t.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Nr>1?(e={maximumAge:6e5,timeout:0},Fr=!0):(e=this.options.positionOptions,Fr=!1),this._geolocationWatchID=t.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else t.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){t.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:xr,ScaleControl:class{constructor(e){this.options=t.extend({},Vr,e),t.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Ur(this._map,this._container,this.options)}onAdd(t){return this._map=t,this._container=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){o.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(t){this.options.unit=t,Ur(this._map,this._container,this.options)}},FullscreenControl:class{constructor(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof t.window.HTMLElement?this._container=e.container:t.warnOnce("Full screen control 'container' must be a DOM element.")),t.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in t.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in t.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=o.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",t.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){o.remove(this._controlContainer),this._map=null,t.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!t.window.document.fullscreenEnabled&&!t.window.document.webkitFullscreenEnabled)}_setupUI(){const e=this._fullscreenButton=o.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);o.create("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden",!0),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),t.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.title=t}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(t.window.document.fullscreenElement||t.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?t.window.document.exitFullscreen?t.window.document.exitFullscreen():t.window.document.webkitCancelFullScreen&&t.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends t.Evented{constructor(e){super(),this.options=t.extend(Object.create($r),e),t.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new t.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&o.remove(this._content),this._container&&(o.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new t.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.LngLat.convert(e),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(t.window.document.createTextNode(e))}setHTML(e){const i=t.window.document.createDocumentFragment(),n=t.window.document.createElement("body");let r;for(n.innerHTML=e;r=n.firstChild;)i.appendChild(r);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=o.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(t),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(t){this._container&&this._container.classList.add(t)}removeClassName(t){this._container&&this._container.classList.remove(t)}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){if(this._container)return this._container.classList.toggle(t)}_createCloseButton(){this.options.closeButton&&(this._closeButton=o.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(t){this._update(t.point)}_onMouseMove(t){this._update(t.point)}_onDrag(t){this._update(t.point)}_update(t){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(this._container||(this._container=o.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=o.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(t=>this._container.classList.add(t)),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Sr(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!t)return;const e=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);let i=this.options.anchor;const n=Hr(this.options.offset);if(!i){const t=this._container.offsetWidth,r=this._container.offsetHeight;let o;o=e.y+n.bottom.y<r?["top"]:e.y>this._map.transform.height-r?["bottom"]:[],e.x<t/2?o.push("left"):e.x>this._map.transform.width-t/2&&o.push("right"),i=0===o.length?"bottom":o.join("-")}const r=e.add(n[i]).round();this._map._requestDomTask(()=>{this._container&&i&&(o.setTransform(this._container,`${Tr[i]} translate(${r.x}px,${r.y}px)`),Mr(this._container,i,"popup"))})}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector(Wr);t&&t.focus()}_onClose(){this.remove()}_setOpacity(t){this._content&&(this._content.style.opacity=t),this._tip&&(this._tip.style.opacity=t)}},Marker:Ir,Style:Ue,LngLat:t.LngLat,LngLatBounds:t.LngLatBounds,Point:t.pointGeometry,MercatorCoordinate:t.MercatorCoordinate,FreeCameraOptions:bn,Evented:t.Evented,config:t.config,prewarm:function(){Ot().acquire(Pt)},clearPrewarmedResources:function(){const t=zt;t&&(t.isPreloaded()&&1===t.numActive()?(t.release(Pt),zt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return t.config.ACCESS_TOKEN},set accessToken(e){t.config.ACCESS_TOKEN=e},get baseApiUrl(){return t.config.API_URL},set baseApiUrl(e){t.config.API_URL=e},get workerCount(){return Lt.workerCount},set workerCount(t){Lt.workerCount=t},get maxParallelImageRequests(){return t.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){t.config.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage(e){t.clearTileCache(e)},workerUrl:"",workerClass:null,setNow:t.exported.setNow,restoreNow:t.exported.restoreNow};return jr}),i}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("echarts/lib/echarts"),require("echarts/lib/component/tooltip"),require("echarts/lib/component/legend"),require("echarts/lib/chart/bar"),require("echarts/lib/chart/line"),require("echarts/lib/chart/pie"),require("echarts/lib/chart/funnel"),require("echarts/lib/chart/radar"),require("echarts/lib/chart/map"),require("echarts/extension/bmap/bmap"),require("echarts-amap"),require("echarts/lib/chart/sankey"),require("echarts/lib/chart/heatmap"),require("echarts/lib/component/visualMap"),require("echarts/lib/chart/scatter"),require("echarts/lib/chart/candlestick"),require("echarts/lib/component/dataZoom"),require("echarts/lib/chart/gauge"),require("echarts/lib/chart/tree"),require("echarts-liquidfill"),require("echarts-wordcloud")):"function"==typeof define&&define.amd?define(["echarts/lib/echarts","echarts/lib/component/tooltip","echarts/lib/component/legend","echarts/lib/chart/bar","echarts/lib/chart/line","echarts/lib/chart/pie","echarts/lib/chart/funnel","echarts/lib/chart/radar","echarts/lib/chart/map","echarts/extension/bmap/bmap","echarts-amap","echarts/lib/chart/sankey","echarts/lib/chart/heatmap","echarts/lib/component/visualMap","echarts/lib/chart/scatter","echarts/lib/chart/candlestick","echarts/lib/component/dataZoom","echarts/lib/chart/gauge","echarts/lib/chart/tree","echarts-liquidfill","echarts-wordcloud"],e):t.VeIndex=e(t.echarts)}(this,function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var e={categoryAxis:{axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}},valueAxis:{axisLine:{show:!1}},line:{smooth:!0},grid:{containLabel:!0,left:10,right:10}},i=["#19d4ae","#5ab1ef","#fa6e86","#ffb980","#0067a6","#c4b4e4","#d87a80","#9cbbff","#d9d0c7","#87a997","#d49ea2","#5b4947","#7ba3a8"],n=["#313695","#4575b4","#74add1","#abd9e9","#e0f3f8","#ffffbf","#fee090","#fdae61","#f46d43","#d73027","#a50026"],r=["blue","blue","green","yellow","red"],o=function(t){return'<span style="background-color:'+t+";"+'display: inline-block;width: 10px;height: 10px;border-radius: 50%;margin-right:2px;"></span>'},a=["initOptions","loading","dataEmpty","judgeWidth","widthChangeDelay"],s=["grid","dataZoom","visualMap","toolbox","title","legend","xAxis","yAxis","radar","tooltip","axisPointer","brush","geo","timeline","graphic","series","backgroundColor","textStyle"],l={th:3,mi:6,bi:9,tr:12},u={zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0,abbrLabel:{th:"k",mi:"m",bi:"b",tr:"t"}},c=1e12,h=1e9,p=1e6,d=1e3;function f(t,e,i,n){var r=t.toString().split("."),o=e-(n||0),a=2===r.length?Math.min(Math.max(r[1].length,o),e):o,s=Math.pow(10,a),l=(i(t+"e+"+a)/s).toFixed(a);if(n>e-a){var u=RegExp("\\.?0{1,"+(n-(e-a))+"}$");l=l.replace(u,"")}return l}function m(t,e,i,n){var r=Math.abs(e),o=!1,a=!1,s="",u="",m=!1,g=void 0,y=void 0;e=e||0,~(i=i||"").indexOf("(")?(o=!0,i=i.replace(/[(|)]/g,"")):(~i.indexOf("+")||~i.indexOf("-"))&&(y=~i.indexOf("+")?i.indexOf("+"):e<0?i.indexOf("-"):-1,i=i.replace(/[+|-]/g,"")),~i.indexOf("a")&&(g=!!(g=i.match(/a(k|m|b|t)?/))&&g[1],~i.indexOf(" a")&&(s=" "),i=i.replace(RegExp(s+"a[kmbt]?"),""),r>=c&&!g||"t"===g?(s+=t.abbrLabel.tr,e/=c):r<c&&r>=h&&!g||"b"===g?(s+=t.abbrLabel.bi,e/=h):r<h&&r>=p&&!g||"m"===g?(s+=t.abbrLabel.mi,e/=p):(r<p&&r>=d&&!g||"k"===g)&&(s+=t.abbrLabel.th,e/=d)),~i.indexOf("[.]")&&(a=!0,i=i.replace("[.]","."));var v=e.toString().split(".")[0],_=i.split(".")[1],x=i.indexOf(","),b=(i.split(".")[0].split(",")[0].match(/0/g)||[]).length;if(_?(v=(u=~_.indexOf("[")?f(e,(_=(_=_.replace("]","")).split("["))[0].length+_[1].length,n,_[1].length):f(e,_.length,n)).split(".")[0],u=~u.indexOf(".")?"."+u.split(".")[1]:"",a&&0==+u.slice(1)&&(u="")):v=f(e,0,n),s&&!g&&+v>=1e3&&s!==l.trillion&&(v=""+ +v/1e3,s=l.million),~v.indexOf("-")&&(v=v.slice(1),m=!0),v.length<b)for(var w=b-v.length;w>0;w--)v="0"+v;x>-1&&(v=v.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")),i.indexOf(".")||(v="");var S=v+u+(s||"");return o?S=(o&&m?"(":"")+S+(o&&m?")":""):y>=0?S=0===y?(m?"-":"+")+S:S+(m?"-":"+"):m&&(S="-"+S),S}function g(t,e){Object.keys(e).forEach(function(i){t[i]=e[i]})}var y={},v={};function _(t,e,i){return function(t,e,i){e=e||y.defaultFormat,i=i||Math.round;var n=void 0,r=void 0;if(0===t&&null!==y.zeroFormat)n=y.zeroFormat;else if(null===t&&null!==y.nullFormat)n=y.nullFormat;else{for(var o in v)if(v[o]&&e.match(v[o].regexp)){r=v[o].format;break}n=(r=r||m.bind(null,y))(t,e,i,_)}return n}(0===t||void 0===t?0:null===t||function(t){return"number"==typeof t&&isNaN(t)}(t)?null:"string"==typeof t?y.zeroFormat&&t===y.zeroFormat?0:y.nullFormat&&t===y.nullFormat||!t.replace(/[^0-9]+/g,"").length?null:+t:+t||null,e,i)}g(y,u),_.options=y,_._numberToFormat=m.bind(null,y),_.register=function(t,e){v[t]=e},_.unregister=function(t){v[t]=null},_.setOptions=function(t){g(y,t)},_.reset=function(){g(y,u)},_.register("percentage",{regexp:/%/,format:function(t,e,i,n){var r=~e.indexOf(" %")?" ":"",o=void 0;return n.options.scalePercentBy100&&(t*=100),e=e.replace(/\s?%/,""),~(o=n._numberToFormat(t,e,i)).indexOf(")")?((o=o.split("")).splice(-1,0,r+"%"),o=o.join("")):o=o+r+"%",o}});var x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b=function(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t},w=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},S=function(t){return Array.isArray(t)?t:Array.from(t)};function T(t,e){var i=null;return function(){var n=this,r=arguments;clearTimeout(i),i=setTimeout(function(){t.apply(n,r)},e)}}function M(t,e,i){if(e){var n=t,r=e.split(".");r.forEach(function(t,e){e===r.length-1?n[t]=i:(n[t]||(n[t]={}),n=n[t])})}}var I="function"==typeof Symbol&&"symbol"===x(Symbol.iterator)?function(t){return void 0===t?"undefined":x(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":x(t)};function C(t){return Object.prototype.toString.call(t)}function A(t){return void 0===t?"undefined":I(t)}function k(t){return"[object Object]"===C(t)}function D(t){return"[object Array]"===C(t)}function E(t){return JSON.parse(JSON.stringify(t))}function P(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var L=function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"-";if(isNaN(t))return n;if(!e)return t;if("[object Function]"===C(e))return e(t,_);i=isNaN(i)?0:++i;var r=".["+Array(i).join(0)+"]",o=e;switch(e){case"KMB":o=i?"0,0"+r+"a":"0,0a";break;case"normal":o=i?"0,0"+r:"0,0";break;case"percent":o=i?"0,0"+r+"%":"0,0.[00]%"}return _(t,o)},z=function(t){var e={};return Object.keys(t).forEach(function(i){t[i].forEach(function(t){e[t]=i})}),e},O={},R=function(t){var e,i=t.position,n=t.positionJsonLink,r=t.beforeRegisterMapOnce,o=t.mapURLProfix,a=n||""+o+i+".json";return O[a]||(O[a]=(e=a,new Promise(function(t,i){var n=new XMLHttpRequest;n.open("GET",e),n.send(null),n.onload=function(){t(JSON.parse(n.responseText))},n.onerror=function(){i(JSON.parse(n.responseText))}})).then(function(t){return r&&(t=r(t)),t})),O[a]},B=null,N=null,F=function(t,e){return B||(B=new Promise(function(i,n){var r="bmap"+Date.now();window[r]=i;var o=document.createElement("script");o.src=["https://api.map.baidu.com/api?v="+(e||"2.0"),"ak="+t,"callback="+r].join("&"),document.body.appendChild(o)})),B},V=function(t,e){return N||(N=new Promise(function(i,n){var r="amap"+Date.now();window[r]=i;var o=document.createElement("script");o.src=["https://webapi.amap.com/maps?v="+(e||"1.4.3"),"key="+t,"callback="+r].join("&"),document.body.appendChild(o)})),N};function U(t,e,i){void 0!==t[e]?t[e].push(i):t[e]=[i]}var G=.5;function $(t){var e=t.innerRows,i=t.dimAxisName,n=t.dimension,r=t.axisVisible,o=t.dimAxisType,a=t.dims;return n.map(function(t){return{type:"category",name:i,nameLocation:"middle",nameGap:22,data:"value"===o?function(t){for(var e=Math.max.apply(null,t),i=[],n=Math.min.apply(null,t);n<=e;n++)i.push(n);return i}(a):e.map(function(e){return e[t]}),axisLabel:{formatter:function(t){return t+""}},show:r}})}function W(t){for(var e=t.meaAxisName,i=t.meaAxisType,n=t.axisVisible,r=t.digit,o=t.scale,a=t.min,s=t.max,l={type:"value",axisTick:{show:!1},show:n},u=[],c=function(t){i[t]?u[t]=w({},l,{axisLabel:{formatter:function(e){return L(e,i[t],r)}}}):u[t]=w({},l),u[t].name=e[t]||"",u[t].scale=o[t]||!1,u[t].min=a[t]||null,u[t].max=s[t]||null},h=0;h<2;h++)c(h);return u}function H(t){var e=t.axisSite,i=t.isHistogram,n=t.meaAxisType,r=t.digit,a=t.labelMap,s=i?e.right||[]:e.top||[];return a&&(s=s.map(function(t){return void 0===a[t]?t:a[t]})),{trigger:"axis",formatter:function(t){var e=[];return e.push(t[0].name+"<br>"),t.forEach(function(t){var i=t.seriesName,a=~s.indexOf(i)?n[1]:n[0];e.push(o(t.color)),e.push(i+": "),e.push(L(t.value,a,r)),e.push("<br>")}),e.join("")}}}function j(t){var e,i=t.innerRows,n=t.metrics,r=t.stack,o=t.axisSite,a=t.isHistogram,s=t.labelMap,l=t.itemStyle,u=t.label,c=t.showLine,h=void 0===c?[]:c,p=t.dimAxisType,d=t.barGap,f=t.opacity,m=t.dims,g={},y=a?o.right||[]:o.top||[],v=a?"yAxisIndex":"xAxisIndex",_=r&&z(r);return n.forEach(function(t){g[t]=[]}),i.forEach(function(t){n.forEach(function(e){g[e].push(t[e])})}),!!(e=Object.keys(g).map(function(t,e){var i="value"===p?function(t,e){for(var i=Math.max.apply(null,e),n=[],r=Math.min.apply(null,e);r<=i;r++){var o=e.indexOf(r);~o?n.push(t[o]):n.push(null)}return n}(g[t],m):g[t],n=b({name:null!=s[t]?s[t]:t,type:~h.indexOf(t)?"line":"bar",data:i},v,~y.indexOf(t)?"1":"0");r&&_[t]&&(n.stack=_[t]),u&&(n.label=u),l&&(n.itemStyle=l);var o=f||function(t,e,i){var n=t;return e.split(".").some(function(t,e){if(void 0===n[t])return n=i,!0;n=n[t]}),n}(n,"itemStyle.normal.opacity");return"value"===p&&(n.barGap=d,n.barCategoryGap="1%",null==o&&(o=G)),null!=o&&M(n,"itemStyle.normal.opacity",o),n})).length&&e}function Z(t){var e=t.metrics,i=t.labelMap,n=t.legendName;return n||i?{data:i?e.map(function(t){return null==i[t]?t:i[t]}):e,formatter:function(t){return null!=n[t]?n[t]:t}}:{data:e}}function q(t,e){return t.map(function(t){return t[e[0]]})}var X=function(t,e,i,n){var r=E(e),o=i.axisSite,a=void 0===o?{}:o,s=i.dimension,l=void 0===s?[t[0]]:s,u=i.stack,c=void 0===u?{}:u,h=i.axisVisible,p=void 0===h||h,d=i.digit,f=void 0===d?2:d,m=i.dataOrder,g=void 0!==m&&m,y=i.scale,v=void 0===y?[!1,!1]:y,_=i.min,x=void 0===_?[null,null]:_,b=i.max,w=void 0===b?[null,null]:b,S=i.legendName,T=void 0===S?{}:S,M=i.labelMap,I=void 0===M?{}:M,C=i.label,A=i.itemStyle,k=i.showLine,D=i.barGap,P=void 0===D?"-100%":D,L=i.opacity,z=n.tooltipVisible,O=n.legendVisible,R=t.slice();a.top&&a.bottom?R=a.top.concat(a.bottom):a.bottom&&!a.right?R=a.bottom:i.metrics?R=i.metrics:R.splice(t.indexOf(l[0]),1);var B=i.xAxisType||["normal","normal"],N=i.yAxisType||"category",F=i.xAxisName||[],V=i.yAxisName||"";if(g){var U=g.label,G=g.order;U&&G?r.sort(function(t,e){return"desc"===G?t[U]-e[U]:e[U]-t[U]}):console.warn("Need to provide name and order parameters")}var X=q(r,l),Y=O&&Z({metrics:R,labelMap:I,legendName:T}),K=$({innerRows:r,dimAxisName:V,dimension:l,axisVisible:p,dimAxisType:N,dims:X}),J=W({meaAxisName:F,meaAxisType:B,axisVisible:p,digit:f,scale:v,min:x,max:w});return{legend:Y,yAxis:K,series:j({innerRows:r,metrics:R,stack:c,axisSite:a,isHistogram:!1,labelMap:I,itemStyle:A,label:C,showLine:k,dimAxisType:N,dimension:l,barGap:P,opacity:L,dims:X}),xAxis:J,tooltip:z&&H({axisSite:a,isHistogram:!1,meaAxisType:B,digit:f,labelMap:I})}},Y=function(t,e,i,n){var r=E(e),o=i.axisSite,a=void 0===o?{}:o,s=i.dimension,l=void 0===s?[t[0]]:s,u=i.stack,c=void 0===u?{}:u,h=i.axisVisible,p=void 0===h||h,d=i.digit,f=void 0===d?2:d,m=i.dataOrder,g=void 0!==m&&m,y=i.scale,v=void 0===y?[!1,!1]:y,_=i.min,x=void 0===_?[null,null]:_,b=i.max,w=void 0===b?[null,null]:b,S=i.labelMap,T=void 0===S?{}:S,M=i.legendName,I=void 0===M?{}:M,C=i.label,A=i.itemStyle,k=i.showLine,D=i.barGap,P=void 0===D?"-100%":D,L=i.opacity;if(g){var z=g.label,O=g.order;z&&O?r.sort(function(t,e){return"desc"===O?t[z]-e[z]:e[z]-t[z]}):console.warn("Need to provide name and order parameters")}var R=n.tooltipVisible,B=n.legendVisible,N=t.slice();a.left&&a.right?N=a.left.concat(a.right):a.left&&!a.right?N=a.left:i.metrics?N=i.metrics:N.splice(t.indexOf(l[0]),1);var F=i.yAxisType||["normal","normal"],V=i.xAxisType||"category",U=i.yAxisName||[],G=i.xAxisName||"",X=q(r,l),Y=B&&Z({metrics:N,labelMap:T,legendName:I}),K=$({innerRows:r,dimAxisName:G,dimension:l,axisVisible:p,dimAxisType:V,dims:X});return{legend:Y,yAxis:W({meaAxisName:U,meaAxisType:F,axisVisible:p,digit:f,scale:v,min:x,max:w}),series:j({innerRows:r,metrics:N,stack:c,axisSite:a,isHistogram:!0,labelMap:T,itemStyle:A,label:C,showLine:k,dimAxisType:V,dimension:l,barGap:P,opacity:L,dims:X}),xAxis:K,tooltip:R&&H({axisSite:a,isHistogram:!0,meaAxisType:F,digit:f,labelMap:T})}},K={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"v-charts-component-loading"},[e("div",{staticClass:"loader"},[e("div",{staticClass:"loading-spinner"},[e("svg",{staticClass:"circular",attrs:{viewBox:"25 25 50 50"}},[e("circle",{staticClass:"path",attrs:{cx:"50",cy:"50",r:"20",fill:"none"}})])])])])},staticRenderFns:[]},J={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"v-charts-data-empty"},[this._v(" 暂无数据 ")])},staticRenderFns:[]};function Q(t,e){Object.keys(e).forEach(function(i){e[i]&&(t[i]=e[i])})}var tt={render:function(t){return t("div",{class:[(e=this.$options.name||this.$options._componentTag,e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase())],style:this.canvasStyle},[t("div",{style:this.canvasStyle,class:{"v-charts-mask-status":this.dataEmpty||this.loading},ref:"canvas"}),t(J,{style:{display:this.dataEmpty?"":"none"}}),t(K,{style:{display:this.loading?"":"none"}}),this.$slots.default]);var e},props:{data:{type:[Object,Array],default:function(){return{}}},settings:{type:Object,default:function(){return{}}},width:{type:String,default:"auto"},height:{type:String,default:"400px"},beforeConfig:{type:Function},afterConfig:{type:Function},afterSetOption:{type:Function},afterSetOptionOnce:{type:Function},events:{type:Object},grid:{type:[Object,Array]},colors:{type:Array},tooltipVisible:{type:Boolean,default:!0},legendVisible:{type:Boolean,default:!0},legendPosition:{type:String},markLine:{type:Object},markArea:{type:Object},markPoint:{type:Object},visualMap:{type:[Object,Array]},dataZoom:{type:[Object,Array]},toolbox:{type:[Object,Array]},initOptions:{type:Object,default:function(){return{}}},title:[Object,Array],legend:[Object,Array],xAxis:[Object,Array],yAxis:[Object,Array],radar:Object,tooltip:Object,axisPointer:[Object,Array],brush:[Object,Array],geo:[Object,Array],timeline:[Object,Array],graphic:[Object,Array],series:[Object,Array],backgroundColor:[Object,String],textStyle:[Object,Array],animation:Object,theme:Object,themeName:String,loading:Boolean,dataEmpty:Boolean,extend:Object,judgeWidth:{type:Boolean,default:!1},widthChangeDelay:{type:Number,default:300},tooltipFormatter:{type:Function},resizeable:{type:Boolean,default:!0},resizeDelay:{type:Number,default:200},changeDelay:{type:Number,default:0},setOptionOpts:{type:[Boolean,Object],default:!0},cancelResizeCheck:Boolean,notSetUnchange:Array,log:Boolean},watch:{data:{deep:!0,handler:function(t){t&&this.changeHandler()}},settings:{deep:!0,handler:function(t){t.type&&this.chartLib&&(this.chartHandler=this.chartLib[t.type]),this.changeHandler()}},width:"nextTickResize",height:"nextTickResize",events:{deep:!0,handler:"createEventProxy"},theme:{deep:!0,handler:"themeChange"},themeName:"themeChange",resizeable:"resizeableHandler"},computed:{canvasStyle:function(){return{width:this.width,height:this.height,position:"relative"}},chartColor:function(){return this.colors||this.theme&&this.theme.color||i}},methods:{dataHandler:function(){if(this.chartHandler){var t=this.data,e=t,i=e.columns,n=void 0===i?[]:i,r=e.rows,o=void 0===r?[]:r,a={tooltipVisible:this.tooltipVisible,legendVisible:this.legendVisible,echarts:this.echarts,color:this.chartColor,tooltipFormatter:this.tooltipFormatter,_once:this._once};this.beforeConfig&&(t=this.beforeConfig(t));var s=this.chartHandler(n,o,this.settings,a);s&&("function"==typeof s.then?s.then(this.optionsHandler):this.optionsHandler(s))}},nextTickResize:function(){this.$nextTick(this.resize)},resize:function(){this.cancelResizeCheck?this.echartsResize():this.$el&&this.$el.clientWidth&&this.$el.clientHeight&&this.echartsResize()},echartsResize:function(){this.echarts&&this.echarts.resize()},optionsHandler:function(e){var i=this;if(this.legendPosition&&e.legend&&(e.legend[this.legendPosition]=10,~["left","right"].indexOf(this.legendPosition)&&(e.legend.top="middle",e.legend.orient="vertical")),e.color=this.chartColor,s.forEach(function(t){i[t]&&(e[t]=i[t])}),this.animation&&function(t,e){Object.keys(e).forEach(function(i){t[i]=e[i]})}(e,this.animation),this.markArea||this.markLine||this.markPoint){var n={markArea:this.markArea,markLine:this.markLine,markPoint:this.markPoint},r=e.series;D(r)?r.forEach(function(t){Q(t,n)}):k(r)&&Q(r,n)}this.extend&&function(t,e){Object.keys(e).forEach(function(i){var n=e[i];~i.indexOf(".")?M(t,i,n):"function"==typeof n?t[i]=n(t[i]):D(t[i])&&k(t[i][0])?t[i].forEach(function(e,r){t[i][r]=w({},e,n)}):k(t[i])?t[i]=w({},t[i],n):t[i]=n})}(e,this.extend),this.afterConfig&&(e=this.afterConfig(e));var o=this.setOptionOpts;!this.settings.bmap&&!this.settings.amap||k(o)||(o=!1),this.notSetUnchange&&this.notSetUnchange.length&&(this.notSetUnchange.forEach(function(t){var n=e[t];n&&(function t(e,i){if(e===i)return!0;if(null===e||null===i||"object"!==A(e)||"object"!==A(i))return e===i;for(var n in e)if(P(e,n)){var r=e[n],o=i[n],a=A(r);if("undefined"===A(o))return!1;if("object"===a){if(!t(r,o))return!1}else if(r!==o)return!1}for(var s in i)if(P(i,s)&&"undefined"===A(e)[s])return!1;return!0}(n,i._store[t])?e[t]=void 0:i._store[t]=E(n))}),k(o)?o.notMerge=!1:o=!1),this._isDestroyed||(this.log&&console.log(e),this.echarts.setOption(e,o),this.$emit("ready",this.echarts,e,t),this._once["ready-once"]||(this._once["ready-once"]=!0,this.$emit("ready-once",this.echarts,e,t)),this.judgeWidth&&this.judgeWidthHandler(e),this.afterSetOption&&this.afterSetOption(this.echarts,e,t),this.afterSetOptionOnce&&!this._once.afterSetOptionOnce&&(this._once.afterSetOptionOnce=!0,this.afterSetOptionOnce(this.echarts,e,t)))},judgeWidthHandler:function(t){var e=this,i=this.widthChangeDelay,n=this.resize;this.$el.clientWidth||this.$el.clientHeight?n():this.$nextTick(function(t){e.$el.clientWidth||e.$el.clientHeight?n():setTimeout(function(t){n(),e.$el.clientWidth&&e.$el.clientHeight||console.warn(" Can't get dom width or height ")},i)})},resizeableHandler:function(t){t&&!this._once.onresize&&this.addResizeListener(),!t&&this._once.onresize&&this.removeResizeListener()},init:function(){if(!this.echarts){var i=this.themeName||this.theme||e;this.echarts=t.init(this.$refs.canvas,i,this.initOptions),this.data&&this.changeHandler(),this.createEventProxy(),this.resizeable&&this.addResizeListener()}},addResizeListener:function(){window.addEventListener("resize",this.resizeHandler),this._once.onresize=!0},removeResizeListener:function(){window.removeEventListener("resize",this.resizeHandler),this._once.onresize=!1},addWatchToProps:function(){var t=this,e=this._watchers.map(function(t){return t.expression});Object.keys(this.$props).forEach(function(i){if(!~e.indexOf(i)&&!~a.indexOf(i)){var n={};~["[object Object]","[object Array]"].indexOf(C(t.$props[i]))&&(n.deep=!0),t.$watch(i,function(){t.changeHandler()},n)}})},createEventProxy:function(){var t=this,e=this,i=Object.keys(this.events||{});i.length&&i.forEach(function(i){-1===t.registeredEvents.indexOf(i)&&(t.registeredEvents.push(i),t.echarts.on(i,function(t){return function(){if(t in e.events){for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];e.events[t].apply(null,n)}}}(i)))})},themeChange:function(t){this.clean(),this.echarts=null,this.init()},clean:function(){this.resizeable&&this.removeResizeListener(),this.echarts.dispose()}},created:function(){this.echarts=null,this.registeredEvents=[],this._once={},this._store={},this.resizeHandler=T(this.resize,this.resizeDelay),this.changeHandler=T(this.dataHandler,this.changeDelay),this.addWatchToProps()},mounted:function(){this.init()},beforeDestroy:function(){this.clean()},_numerify:_},et=w({},tt,{name:"VeBar",data:function(){return this.chartHandler=X,{}}}),it=w({},tt,{name:"VeHistogram",data:function(){return this.chartHandler=Y,{}}}),nt=function(t,e,i,n){e=D(e)?e:[],t=D(t)?t:[];var r=i.axisSite,o=void 0===r?{}:r,a=i.yAxisType,s=void 0===a?["normal","normal"]:a,l=i.xAxisType,u=void 0===l?"category":l,c=i.yAxisName,h=void 0===c?[]:c,p=i.dimension,d=void 0===p?[t[0]]:p,f=i.xAxisName,m=void 0===f?[]:f,g=i.axisVisible,y=void 0===g||g,v=i.area,_=i.stack,x=i.scale,b=void 0===x?[!1,!1]:x,S=i.min,T=void 0===S?[null,null]:S,M=i.max,I=void 0===M?[null,null]:M,C=i.nullAddZero,A=void 0!==C&&C,k=i.digit,E=void 0===k?2:k,P=i.legendName,O=void 0===P?{}:P,R=i.labelMap,B=void 0===R?{}:R,N=i.label,F=i.itemStyle,V=i.lineStyle,U=i.areaStyle,G=n.tooltipVisible,$=n.legendVisible,W=n.tooltipFormatter,H=t.slice();o.left&&o.right?H=o.left.concat(o.right):o.left&&!o.right?H=o.left:i.metrics?H=i.metrics:H.splice(t.indexOf(d[0]),1);var j=$&&function(t){var e=t.metrics,i=t.legendName,n=t.labelMap;return i||n?{data:n?e.map(function(t){return null==n[t]?t:n[t]}):e,formatter:function(t){return null!=i[t]?i[t]:t}}:{data:e}}({metrics:H,legendName:O,labelMap:B}),Z=G&&function(t){var e,i=t.yAxisType,n=t.digit,r=t.labelMap,o=t.tooltipFormatter,a=t.axisSite.right||[],s=r?a.map(function(t){return void 0===r[t]?t:r[t]}):a;return{trigger:"axis",formatter:function(t){if(o)return o.apply(null,arguments);var e=[],r=t[0],a=r.name,l=r.axisValueLabel,u=a||l;return e.push(u+"<br>"),t.forEach(function(t){var r,o=t.seriesName,a=t.data,l=t.marker,u=~s.indexOf(o)?i[1]:i[0],c=D(a)?a[1]:a;r=L(c,u,n),e.push(l),e.push(o+": "+r),e.push("<br>")}),e.join("")}}}({axisSite:o,yAxisType:s,digit:E,labelMap:B,xAxisType:u,tooltipFormatter:W}),q=function(t){var e,i=t.rows,n=t.xAxisName,r=t.axisVisible,o=t.xAxisType;return t.dimension.map(function(t,e){return{type:o,nameLocation:"middle",nameGap:22,name:n[e]||"",axisTick:{show:!0,lineStyle:{color:"#eee"}},data:i.map(function(e){return e[t]}),show:r}})}({dimension:d,rows:e,xAxisName:m,axisVisible:y,xAxisType:u}),X=function(t){for(var e=t.yAxisName,i=t.yAxisType,n,r=t.scale,o=t.min,a=t.max,s=t.digit,l={type:"value",axisTick:{show:!1},show:t.axisVisible},u=[],c=function(t){i[t]?u[t]=w({},l,{axisLabel:{formatter:function(e){return L(e,i[t],s)}}}):u[t]=w({},l),u[t].name=e[t]||"",u[t].scale=r[t]||!1,u[t].min=o[t]||null,u[t].max=a[t]||null},h=0;h<2;h++)c(h);return u}({yAxisName:h,yAxisType:s,axisVisible:y,scale:b,min:T,max:I,digit:E});return{legend:j,xAxis:q,series:function(t){var e=t.rows,i=t.axisSite,n=t.metrics,r=t.area,o=t.stack,a=t.nullAddZero,s=t.labelMap,l=t.label,u=t.itemStyle,c=t.lineStyle,h=t.areaStyle,p=t.dimension,d=[],f={},m=o&&z(o);return n.forEach(function(t){f[t]=[]}),e.forEach(function(t){n.forEach(function(e){var i=null;null!=t[e]?i=t[e]:a&&(i=0),f[e].push([t[p[0]],i])})}),n.forEach(function(t){var e={name:null!=s[t]?s[t]:t,type:"line",data:f[t]};r&&(e.areaStyle={normal:{}}),i.right&&(e.yAxisIndex=~i.right.indexOf(t)?1:0),o&&m[t]&&(e.stack=m[t]),l&&(e.label=l),u&&(e.itemStyle=u),c&&(e.lineStyle=c),h&&(e.areaStyle=h),d.push(e)}),d}({rows:e,axisSite:o,metrics:H,area:v,stack:_,nullAddZero:A,labelMap:B,label:N,itemStyle:F,lineStyle:V,areaStyle:U,xAxisType:u,dimension:d}),yAxis:X,tooltip:Z}},rt=w({},tt,{name:"VeLine",data:function(){return this.chartHandler=nt,{}}}),ot=[80,100],at=[20,100],st=function(t,e,i,n,r){var a=E(e),s=i.dataType,l=void 0===s?"normal":s,u=i.percentShow,c=i.dimension,h=void 0===c?t[0]:c,p=i.metrics,d=void 0===p?t[1]:p,f=i.roseType,m=void 0!==f&&f,g=i.radius,y=void 0===g?r?m?at:ot:100:g,v=i.offsetY,_=void 0===v?200:v,x=i.legendLimit,b=void 0===x?30:x,S=i.selectedMode,T=void 0!==S&&S,M=i.hoverAnimation,I=void 0===M||M,C=i.digit,A=void 0===C?2:C,k=i.legendName,D=void 0===k?{}:k,P=i.label,z=void 0!==P&&P,O=i.level,R=void 0!==O&&O,B=i.limitShowNum,N=void 0===B?0:B,F=i.labelLine,V=i.itemStyle,G=n.tooltipVisible,$=n.legendVisible;return N&&a.sort(function(t,e){return e[d]-t[d]}),{series:function(t){var e=t.innerRows,i=t.dataType,n=t.percentShow,r=t.dimension,o=t.metrics,a=t.radius,s=t.offsetY,l=t.selectedMode,u=t.hoverAnimation,c=t.digit,h=t.roseType,p=t.label,d=t.level,f=t.limitShowNum,m=t.isRing,g=t.labelLine,y=t.itemStyle,v=[],_={},x=[];d?(d.forEach(function(t,e){t.forEach(function(t){U(_,t,e)})}),e.forEach(function(t){var e=_[t[r]];e&&e.length&&e.forEach(function(e){U(x,e,t)})})):x.push(e);var b={type:"pie",selectedMode:l,hoverAnimation:u,roseType:h,center:["50%",s]},S=x.length;if(x.forEach(function(t,e){var s=w({data:[]},b),l=a/S;if(e){var u=l+a/(2*S)*(2*e-1),h=u+a/(2*S);s.radius=[u,h]}else s.radius=m?a:l;S>1&&0===e&&(s.label={normal:{position:"inner"}}),p&&(s.label=p),g&&(s.labelLine=g),y&&(s.itemStyle=y),n&&(s.label={normal:{show:!0,position:S>1&&0===e?"inner":"outside",formatter:function(t){var e=[];return e.push(t.name+":"),e.push(L(t.value,i,c)),e.push("("+t.percent+"%)"),e.join(" ")}}}),s.data=t.map(function(t){return{name:t[r],value:t[o]}}),v.push(s)}),f&&f<v[0].data.length){var T=v[0].data,M=0;T.slice(f,T.length).forEach(function(t){M+=t.value}),v[0].data=T.slice(0,f),v[0].data.push({name:"其他",value:M})}return v}({innerRows:a,dataType:l,percentShow:u,dimension:h,metrics:d,radius:y,offsetY:_,selectedMode:T,hoverAnimation:I,digit:A,roseType:m,label:z,level:R,legendName:D,limitShowNum:N,isRing:r,labelLine:F,itemStyle:V}),legend:$&&function(t){var e=t.innerRows,i=t.dimension,n=t.legendLimit,r=t.legendName,o=t.level,a=t.limitShowNum,s=[],l=[];if(o)o.forEach(function(t){t.forEach(function(t){l.push(t)})}),s=l;else if(a&&a<e.length){for(var u=0;u<a;u++)s.push(e[u][i]);s.push("其他")}else s=e.map(function(t){return t[i]});return!!s.length&&{data:s,show:s.length<n,formatter:function(t){return null!=r[t]?r[t]:t}}}({innerRows:a,dimension:h,legendLimit:b,legendName:D,level:R,limitShowNum:N}),tooltip:G&&function(t){var e=t.dataType,i=t.innerRows,n=t.limitShowNum,r=t.digit,a=t.metrics,s=t.dimension,l=0,u=i.map(function(t){return l+=t[a],{name:t[s],value:t[a]}}).slice(n,i.length);return{formatter:function(t){var i=[];return i.push(o(t.color)),n&&"其他"===t.name?(i.push("其他:"),u.forEach(function(t){var n=t.name,o=t.value,a=L(o/l,"percent");i.push("<br>"+n+":"),i.push(L(o,e,r)),i.push("("+a+")")})):(i.push(t.name+":"),i.push(L(t.value,e,r)),i.push("("+t.percent+"%)")),i.join(" ")}}}({dataType:l,innerRows:a,limitShowNum:N,digit:A,metrics:d,dimension:h})}},lt=function(t,e,i,n){return st(t,e,i,n,!0)},ut=w({},tt,{name:"VePie",data:function(){return this.chartHandler=st,{}}}),ct=w({},tt,{name:"VeRing",data:function(){return this.chartHandler=lt,{}}}),ht=function(t,e,i,n){var r=i.dataType,o=void 0===r?"normal":r,a=i.dimension,s=void 0===a?t[0]:a,l=i.totalName,u=void 0===l?"总计":l,c=i.totalNum,h=i.remainName,p=void 0===h?"其他":h,d=i.xAxisName,f=void 0===d?s:d,m=i.labelMap,g=void 0===m?{}:m,y=i.axisVisible,v=void 0===y||y,_=i.digit,x=void 0===_?2:_,b=n.tooltipVisible,S=t.slice();S.splice(S.indexOf(s),1);var T=S[0],M=T,I=b&&function(t,e){return{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(i){var n=i[1];return n.name+"<br/>"+n.seriesName+" :"+L(n.value,t,e)}}}(o,x),C=parseFloat(e.reduce(function(t,e){return t+ +e[T]},0).toFixed(x)),A=function(t,e){return e?e>t?"have-remain":"none-remain":"not-total"}(C,c);return{tooltip:I,xAxis:function(t){var e=t.dimension,i,n=t.remainStatus,r,o=t.remainName,a=t.labelMap,s=t.xAxisName,l=t.axisVisible,u=[t.totalName].concat(t.rows.map(function(t){return t[e]}));return"have-remain"===n&&(u=u.concat([o])),{type:"category",name:a&&a[s]||s,splitLine:{show:!1},data:u,show:l}}({dimension:s,rows:e,remainStatus:A,totalName:u,remainName:p,xAxisName:f,labelMap:g,axisVisible:v}),yAxis:function(t){var e=t.dataType,i=t.yAxisName,n=t.axisVisible,r=t.digit,o=t.labelMap;return{type:"value",name:null!=o[i]?o[i]:i,axisTick:{show:!1},axisLabel:{formatter:function(t){return L(t,e,r)}},show:n}}({dataType:o,yAxisName:M,axisVisible:v,digit:x,labelMap:g}),series:function(t){var e=t.dataType,i=t.rows,n=t.metrics,r=t.totalNum,o=t.remainStatus,a=t.dataSum,s=t.digit,l={type:"bar",stack:"总量"},u=a,c=r,h=void 0,p=void 0,d=i.map(function(t){return t[n]});"have-remain"===o?(h=[0].concat(i.map(function(t){return c-=t[n]})).concat([0]),p=[r].concat(d).concat([r-a])):(h=[0].concat(i.map(function(t){return u-=t[n]})),p=[a].concat(d));var f=[];return f.push(w({name:"辅助",itemStyle:{normal:{opacity:0},emphasis:{opacity:0}},data:h},l)),f.push(w({name:"数值",label:{normal:{show:!0,position:"top",formatter:function(t){return L(t.value,e,s)}}},data:p},l)),f}({dataType:o,rows:e,dimension:s,metrics:T,totalNum:c,remainStatus:A,dataSum:C,digit:x})}},pt=w({},tt,{name:"VeWaterfall",data:function(){return this.chartHandler=ht,{}}}),dt=function(t,e,i,n){var r=t.slice(),a=e.slice(),s=i.dataType,l=void 0===s?"normal":s,u=i.dimension,c=void 0===u?r[0]:u,h=i.sequence,p=void 0===h?a.map(function(t){return t[c]}):h,d=i.digit,f=void 0===d?2:d,m=i.ascending,g=i.label,y=i.labelLine,v=i.legendName,_=void 0===v?{}:v,x=i.itemStyle,b=i.filterZero,w=i.useDefaultOrder,S=n.tooltipVisible,T=n.legendVisible,M=void 0;if(i.metrics)M=i.metrics;else{var I=r.slice();I.splice(r.indexOf(c),1),M=I[0]}return{tooltip:S&&function(t,e){return{trigger:"item",formatter:function(i){var n=[];return n.push(o(i.color)),n.push(i.name+": "+L(i.data.realValue,t,e)),n.join("")}}}(l,f),legend:T&&function(t){var e,i=t.legendName;return{data:t.data,formatter:function(t){return null!=i[t]?i[t]:t}}}({data:p,legendName:_}),series:function(t){var e=t.dimension,i=t.metrics,n,r=t.sequence,o=t.ascending,a=t.label,s=t.labelLine,l=t.itemStyle,u=t.filterZero,c=t.useDefaultOrder,h={type:"funnel"},p=t.rows.sort(function(t,i){return r.indexOf(t[e])-r.indexOf(i[e])});u&&(p=p.filter(function(t){return t[i]}));var d=!1;p.some(function(t,e){if(e&&t[i]>p[e-1][i])return d=!0,!0});var f=100/p.length;return h.data=d&&!c?p.slice().reverse().map(function(t,n){return{name:t[e],value:(n+1)*f,realValue:t[i]}}):p.map(function(t){return{name:t[e],value:t[i],realValue:t[i]}}),o&&(h.sort="ascending"),a&&(h.label=a),s&&(h.labelLine=s),l&&(h.itemStyle=l),h}({dimension:c,metrics:M,rows:a,sequence:p,ascending:m,label:g,labelLine:y,itemStyle:x,filterZero:b,useDefaultOrder:w})}},ft=w({},tt,{name:"VeFunnel",data:function(){return this.chartHandler=dt,{}}}),mt=function(t,e,i,n){var r=i.dataType,a=void 0===r?{}:r,s=i.legendName,l=void 0===s?{}:s,u=i.labelMap,c=void 0===u?{}:u,h=i.dimension,p=void 0===h?t[0]:h,d=i.digit,f=void 0===d?2:d,m=i.label,g=i.itemStyle,y=i.lineStyle,v=i.areaStyle,_=n.tooltipVisible,x=n.legendVisible,b=t.slice();i.metrics?b=i.metrics:b.splice(t.indexOf(p),1);var w=x&&function(t,e,i){return{data:t.map(function(t){return t[e]}),formatter:function(t){return null!=i[t]?i[t]:t}}}(e,p,l),S=function(t,e,i){var n={indicator:[],shape:"circle",splitNumber:5},r={};return t.forEach(function(t){e.forEach(function(e){var n=null!=i[e]?i[e]:e;r[n]?r[n].push(t[e]):r[n]=[t[e]]})}),n.indicator=Object.keys(r).map(function(t){return{name:t,max:Math.max.apply(null,r[t])}}),n}(e,b,c);return{legend:w,tooltip:_&&function(t,e,i){var n=[],r=[];return e.indicator.map(function(e,i){n[i]=t[e.name],r[i]=e.name}),{formatter:function(t){var e=[];return e.push(o(t.color)),e.push(t.name+"<br />"),t.data.value.forEach(function(t,o){e.push(r[o]+": "),e.push(L(t,n[o],i)+"<br />")}),e.join("")}}}(a,S,f),radar:S,series:function(t){var e=t.rows,i=t.dimension,n=t.metrics,r,o=t.label,a=t.itemStyle,s=t.lineStyle,l=t.labelMap,u=t.areaStyle,c={};t.radar.indicator.forEach(function(t,e){var i=t.name;c[i]=e});var h=e.map(function(t){var e={value:[],name:t[i]};return Object.keys(t).forEach(function(i){if(~n.indexOf(i)){var r=null!=l[i]?c[l[i]]:c[i];e.value[r]=t[i]}}),e}),p={name:i,type:"radar",data:h};return o&&(p.label=o),a&&(p.itemStyle=a),s&&(p.lineStyle=s),u&&(p.areaStyle=u),[p]}({rows:e,dimension:p,metrics:b,radar:S,label:m,itemStyle:g,lineStyle:y,labelMap:c,areaStyle:v})}},gt=w({},tt,{name:"VeRadar",data:function(){return this.chartHandler=mt,{}}}),yt=w({},tt,{name:"VeChart",data:function(){return this.chartLib={bar:X,histogram:Y,line:nt,pie:st,ring:lt,funnel:dt,radar:mt,waterfall:ht},this.chartHandler=this.chartLib[this.settings.type],{}}});function vt(t,e,i){"object"===(void 0===t?"undefined":x(t))?e[i]=t:t&&(e[i]={normal:{show:!0},emphasis:{show:!0}})}function _t(e,i){var n=e._once,r=e.registerSign,o=e.beforeRegisterMap,a=e.beforeRegisterMapOnce,s=e.registerSignOnce,l=e.position,u=e.specialAreas;n[r]||(o&&(i=o(i)),a&&!n[s]&&(n[s]=!0,i=a(i)),n[r]=!0,t.registerMap(l,i,u))}var xt=function(t,e,i,n){var r=i.position,a=void 0===r?"china":r,s=i.selectData,l=void 0!==s&&s,u=i.selectedMode,c=i.label,h=void 0===c||c,p=i.dataType,d=void 0===p?{}:p,f=i.digit,m=void 0===f?2:f,g=i.dimension,y=void 0===g?t[0]:g,v=i.roam,_=i.center,x=i.aspectScale,b=i.boundingCoords,S=i.zoom,T=i.scaleLimit,M=i.legendName,I=void 0===M?{}:M,C=i.labelMap,A=void 0===C?{}:C,k=i.mapGrid,D=i.itemStyle,E=i.positionJsonLink,P=i.beforeRegisterMap,z=i.beforeRegisterMapOnce,O=i.mapURLProfix,B=void 0===O?"https://unpkg.com/echarts@3.6.2/map/json/":O,N=i.specialAreas,F=void 0===N?{}:N,V=i.mapOrigin,U=t.slice();i.metrics?U=i.metrics:U.splice(t.indexOf(y),1);var G=n.tooltipVisible,$=n.legendVisible,W=n.color,H=n._once,j={};e.forEach(function(t){j[t[y]]=t});var Z=G&&function(t,e,i,n,r,a){return{formatter:function(s){var l=[];return s.name?(l.push(s.name+"<br>"),n.forEach(function(n,u){var c=null!=a[n]?a[n]:n;l.push(o(r[u])+" "+c+" : "),i[s.name]?l.push(L(i[s.name][n],t[n],e)):l.push("-"),l.push("<br>")}),l.join(" ")):""}}}(d,m,j,U,W,A),q=$&&function(t){var e=t.metrics,i=t.legendName,n=t.labelMap;return i||n?{data:n?e.map(function(t){return null==n[t]?t:n[t]}):e,formatter:function(t){return null!=i[t]?i[t]:t}}:{data:e}}({metrics:U,legendName:I,labelMap:A}),X=function(t){var e,i=t.selectData,n=t.dimension,r,o=t.rows,a=t.label,s=t.itemStyle,l=t.selectedMode,u=t.roam,c=t.center,h=t.aspectScale,p=t.boundingCoords,d=t.zoom,f=t.labelMap,m=t.scaleLimit,g=t.mapGrid,y=[],v={type:"map",mapType:t.position};return t.metrics.forEach(function(t){var e=w({name:null!=f[t]?f[t]:t,data:[],selectedMode:l,roam:u,center:c,aspectScale:h,boundingCoords:p,zoom:d,scaleLimit:m},v);g&&Object.keys(g).forEach(function(t){e[t]=g[t]}),vt(s,e,"itemStyle"),vt(a,e,"label"),o.forEach(function(r){e.data.push({name:r[n],value:r[t],selected:i})}),y.push(e)}),y}({position:a,selectData:l,label:h,itemStyle:D,dimension:y,metrics:U,rows:e,selectedMode:u,roam:v,center:_,aspectScale:x,boundingCoords:b,zoom:S,labelMap:A,scaleLimit:T,mapGrid:k}),Y={_once:H,beforeRegisterMap:P,beforeRegisterMapOnce:z,registerSign:"MAP_REGISTER_"+a,registerSignOnce:"ONCE_MAP_REGISTER_"+a,position:a,specialAreas:F};return V?(_t(Y,V),{series:X,tooltip:Z,legend:q}):R({position:a,positionJsonLink:E,beforeRegisterMapOnce:z,mapURLProfix:B}).then(function(t){return _t(Y,t),{series:X,tooltip:Z,legend:q}})},bt=w({},tt,{name:"VeMap",data:function(){return this.chartHandler=xt,{}}}),wt=function(t,e,i,n){var r=i.key,o=i.v,a=i.bmap,s=i.useOuterMap,l=n._once;return r||s||console.warn("settings.key must be a string."),l.bmap_register?{}:(l.bmap_register=!0,s?{bmap:a}:F(r,o).then(function(t){return{bmap:a}}))},St=w({},tt,{name:"VeBmap",data:function(){return this.chartHandler=wt,{}}}),Tt=function(t,e,i,n){var r=i.key,o=i.v,a=i.amap,s=i.useOuterMap,l=n._once;return r||s||console.warn("settings.key must be a string."),l.amap_register?{}:(l.amap_register=!0,s?{amap:a}:V(r,o).then(function(t){return{amap:a}}))},Mt=w({},tt,{name:"VeAmap",data:function(){return this.chartHandler=Tt,{}}}),It=function(t,e,i,n){var r=i.links,a=i.dimension,s=void 0===a?t[0]:a,l=i.metrics,u=void 0===l?t[1]:l,c=i.dataType,h=void 0===c?["normal","normal"]:c,p=i.digit,d=void 0===p?2:p,f=i.valueFull,m=void 0!==f&&f,g=i.useDataValue,y=void 0!==g&&g,v=i.label,_=i.itemStyle,x=i.lineStyle;if(r)return{tooltip:function(t){var e=t.itemDataType,i=t.linksDataType,n=t.digit;return{trigger:"item",formatter:function(t){var r=[],a=t.name,s=t.data,l=t.value,u=t.color;return r.push(o(u)),r.push(a+" : "),s&&s.source?r.push(L(l,i,n)+"<br />"):r.push(L(l,e,n)+"<br />"),r.join("")}}}({itemDataType:h[0],linksDataType:h[1],digit:d}),series:function(t){var e,i=t.dimension,n=t.metrics,r=t.links,o=t.valueFull,a=t.useDataValue,s=t.label,l=t.itemStyle,u=t.lineStyle,c={},h={type:"sankey",data:t.rows.map(function(t){return c[t[i]]=t[n],{name:t[i],value:t[n]}}),links:a?r.map(function(t){return w({},t,{value:c[t.target]})}):o?r:r.map(function(t){return null==t.value?w({},t,{value:c[t.target]}):t})};return s&&(h.label=s),l&&(h.itemStyle=l),u&&(h.lineStyle=u),[h]}({rows:e,dimension:s,metrics:u,links:r,valueFull:m,useDataValue:y,label:v,itemStyle:_,lineStyle:x})};console.warn("links is needed in settings!")},Ct=w({},tt,{name:"VeSankey",data:function(){return this.chartHandler=It,{}}});function At(t,e){var i=[];return t.forEach(function(t){~i.indexOf(t[e])||i.push(t[e])}),i}function kt(t){var e=t.rows,i=t.innerXAxisList,n=t.innerYAxisList,r=t.xDim,o=t.yDim,a=t.metrics,s=t.type,l=t.extraMetrics;return"cartesian"===s?e.map(function(t){var e=i.indexOf(t[r]),s=n.indexOf(t[o]),u=a?t[a]:1,c=l.map(function(e){return t[e]||"-"});return{value:[e,s,u].concat(c)}}):e.map(function(t){var e=a?t[a]:1;return{value:[t[r],t[o],e]}})}function Dt(t,e){return{type:"category",data:t,name:e,nameLocation:"end",splitArea:{show:!0}}}var Et=function(e,i,a,s){var l=a.type,u=void 0===l?"cartesian":l,c=a.xAxisList,h=a.yAxisList,p=a.dimension,d=void 0===p?[e[0],e[1]]:p,f=a.metrics,m=void 0===f?e[2]:f,g=a.dataType,y=void 0===g?"normal":g,v=a.min,_=a.max,x=a.digit,b=a.bmap,T=a.amap,M=a.geo,I=a.key,C=a.v,A=void 0===C?"2.0":C,k=a.position,D=a.positionJsonLink,E=a.beforeRegisterMap,P=a.pointSize,z=void 0===P?10:P,O=a.blurSize,B=void 0===O?5:O,N=a.heatColor,U=a.yAxisName,G=a.xAxisName,$=a.beforeRegisterMapOnce,W=a.mapURLProfix,H=void 0===W?"https://unpkg.com/echarts@3.6.2/map/json/":W,j=a.specialAreas,Z=void 0===j?{}:j,q=s.tooltipVisible,X=c,Y=h,K=[],J=[],Q=d.concat([m]);e.forEach(function(t){~Q.indexOf(t)||J.push(t)}),"cartesian"===u?(X&&X.length||(X=At(i,d[0])),Y&&Y.length||(Y=At(i,d[1])),K=kt({rows:i,innerXAxisList:X,innerYAxisList:Y,xDim:d[0],yDim:d[1],metrics:m,type:u,extraMetrics:J})):K=kt({rows:i,xDim:d[0],yDim:d[1],metrics:m,type:u,extraMetrics:J});var tt=m?i.map(function(t){return t[m]}):[0,5];tt.length||(tt=[0]);var et=v||Math.min.apply(null,tt),it=_||Math.max.apply(null,tt),nt=Dt(X,G),rt=Dt(Y,U),ot=[{type:"heatmap",data:{chartData:K}.chartData}],at=function(t){var e,i,o=t.type,a=t.heatColor,s,l={min:t.innerMin,max:t.innerMax,calculable:!0},u=null;return"map"===o?(u={orient:"vertical",left:0,bottom:0,inRange:{color:a||n}},t.series[0].data.length||(u.show=!1)):u="bmap"===o||"amap"===o?{show:!1,orient:"vertical",left:0,bottom:0,inRange:{color:a||r}}:{orient:"horizontal",left:"center",bottom:10,dimension:2,inRange:a&&{color:a}},w(l,u)}({innerMin:et,innerMax:it,type:u,heatColor:N,series:ot}),st=q&&function(t){var e=t.dataType,i=t.innerXAxisList,n=t.innerYAxisList,r=t.digit,a=t.extraMetrics,s=t.metrics;return{trigger:"item",formatter:function(t){var l=t.color,u=S(t.data.value),c=u[0],h=u[1],p=u[2],d=u.slice(3),f=[];return f.push(i[c]+" ~ "+n[h]+"<br>"),a.forEach(function(t,e){f.push(t+": "+d[e]+"<br>")}),f.push(o(l)+" "+s+": "+L(p,e,r)+"<br>"),f.join("")}}}({dataType:y,innerXAxisList:X,innerYAxisList:Y,digit:x,extraMetrics:J,metrics:m}),lt={visualMap:at,series:ot};return"bmap"===u?(w(lt.series[0],{coordinateSystem:"bmap",pointSize:z,blurSize:B}),F(I,A).then(function(t){return w({bmap:b},lt)})):"map"===u?(lt.series[0].coordinateSystem="geo",R({position:k,positionJsonLink:D,beforeRegisterMapOnce:$,mapURLProfix:H}).then(function(e){var i=w({map:k},M);return E&&(e=E(e)),t.registerMap(k,e,Z),w({geo:i},lt)})):"amap"===u?(w(lt.series[0],{coordinateSystem:"amap",pointSize:z,blurSize:B}),V(I,A).then(function(t){return w({amap:T},lt)})):w({xAxis:nt,yAxis:rt,tooltip:st},lt)},Pt=w({},tt,{name:"VeHeatmap",data:function(){return this.chartHandler=Et,{}}});function Lt(t,e){var i=e.labelMap,n=e.columns,r=e.dataType,a=e.digit,s=[],l=t.color,u=t.seriesName,c=t.data.value;return s.push(o(l)+" "+u+"<br>"),c.forEach(function(t,e){var o=i[n[e]]||n[e],l=isNaN(t)?t:L(t,r[n[e]],a);s.push(o+": "+l+"<br>")}),s.join("")}var zt=function(t,e,i,n){var r=i.dimension,o=void 0===r?t[0]:r,a=i.metrics,s=void 0===a?[t[1],t[2]]:a,l=i.dataType,u=void 0===l?{}:l,c=i.xAxisType,h=void 0===c?"category":c,p=i.xAxisName,d=i.yAxisName,f=i.digit,m=void 0===f?2:f,g=i.legendName,y=void 0===g?{}:g,v=i.labelMap,_=void 0===v?{}:v,x=i.tooltipTrigger,b=void 0===x?"item":x,S=i.axisVisible,T=void 0===S||S,M=i.symbolSizeMax,I=void 0===M?50:M,C=i.symbol,A=i.symbolSize,k=i.symbolRotate,E=i.symbolOffset,P=i.cursor,z=i.min,O=i.max,R=i.scale,B=i.label,N=i.itemStyle;if(D(e)){var F=w({},i,{xAxisName:p?[p]:void 0,yAxisName:d?[d]:void 0,scale:R?[R]:void 0,min:z?[z]:void 0,max:O?[O]:void 0,dimension:o?[o]:void 0}),V=nt(t,e,F,n);return V&&V.series?(V.series.forEach(function(t){w(t,{type:"scatter",symbol:C,symbolSize:A||10,symbolRotate:k,symbolOffset:E,cursor:P,label:B,itemStyle:N})}),V):{}}var U,G=n.tooltipVisible,$=n.legendVisible,W=Object.keys(e);return{legend:$&&function(t,e){return{data:t,formatter:function(t){return null!=e[t]?e[t]:t}}}(W,y),tooltip:G&&{trigger:(U={tooltipTrigger:b,labelMap:_,columns:t,dataType:u,digit:m}).tooltipTrigger,formatter:function(t){return D(t)?t.map(function(t){return Lt(t,U)}).join(""):Lt(t,U)}},xAxis:function(t){var e=t.xAxisName,i=t.axisVisible,n=t.xAxisType,r=t.rows,o,a=t.dimension,s=[];return t.dataLabels.forEach(function(t){r[t].forEach(function(t){var e=t[a];e&&!~s.indexOf(e)&&s.push(e)})}),[{type:n,show:i,name:e,data:s}]}({xAxisName:p,axisVisible:T,xAxisType:h,dataLabels:W,dimension:o,rows:e}),yAxis:function(t){var e,i,n,r,o=t.dataType,a=t.metrics,s=t.digit;return{type:"value",show:t.axisVisible,scale:t.scale,min:t.min,max:t.max,axisTick:{show:!1},name:t.yAxisName,axisLabel:{formatter:function(t){return L(t,o[a[0]],s)}}}}({min:z,max:O,scale:R,yAxisName:d,dataType:u,metrics:s,digit:m,axisVisible:T}),series:function(t){var e=t.rows,i=t.dataLabels,n,r=t.metrics,o=t.dimension,a=t.label,s=t.itemStyle,l=t.symbol,u=t.symbolSizeMax,c=t.symbolSize,h=t.symbolRotate,p=t.symbolOffset,d=t.cursor,f=t.columns.filter(function(t){return!~r.indexOf(t)&&t!==o}),m=[];i.forEach(function(t){e[t].forEach(function(t){m.push(t[r[1]])})});var g=Math.max.apply(null,m),y=[];return i.forEach(function(t){var i=[];e[t].forEach(function(t){var e={value:[]};e.value.push(t[o],t[r[0]],t[r[1]]),f.forEach(function(i){e.value.push(t[i])}),e.symbolSize=c||t[r[1]]/g*u,i.push(e)}),y.push({type:"scatter",data:i,name:t,label:a,itemStyle:s,symbol:l,symbolRotate:h,symbolOffset:p,cursor:d})}),y}({rows:e,dataLabels:W,columns:t,metrics:s,dimension:o,label:B,itemStyle:N,symbol:C,symbolSizeMax:I,symbolSize:A,symbolRotate:k,symbolOffset:E,cursor:P})}},Ot=w({},tt,{name:"VeScatter",data:function(){return this.chartHandler=zt,{}}}),Rt=[5,10,20,30],Bt="日K",Nt={show:!1},Ft=function(t,e,i,n){var r=i.dimension,a=void 0===r?t[0]:r,s=i.metrics,l=void 0===s?t.slice(1,6):s,u=i.digit,c=void 0===u?2:u,h=i.itemStyle,p=i.labelMap,d=void 0===p?{}:p,f=i.legendName,m=void 0===f?{}:f,g=i.MA,y=void 0===g?Rt:g,v=i.showMA,_=void 0!==v&&v,x=i.showVol,b=void 0!==x&&x,w=i.showDataZoom,S=void 0!==w&&w,T=i.downColor,M=void 0===T?"#ec0000":T,I=i.upColor,C=void 0===I?"#00da3c":I,A=i.start,k=void 0===A?50:A,E=i.end,P=void 0===E?100:E,z=i.dataType,O=n.tooltipVisible,R=n.legendVisible,B=D(e[0]),N=[],F=[],V=[],U=l.slice(0,4),G=l[4];B?e.forEach(function(e){var i=[];N.push(e[t.indexOf(a)]),U.forEach(function(n){i.push(e[t.indexOf(n)])}),F.push(i),G&&V.push(e[t.indexOf(G)])}):e.forEach(function(t,e){var i=[];if(N.push(t[a]),U.forEach(function(e){i.push(t[e])}),F.push(i),G){var n=t[l[0]]>t[l[1]]?1:-1;V.push([e,t[G],n])}});var $=R&&function(t){var e,i=t.MA,n=t.legendName,r=t.labelMap,o=[Bt];return t.showMA&&(o=o.concat(i.map(function(t){return"MA"+t}))),r&&(o=o.map(function(t){return null==r[t]?t:r[t]})),{data:o,formatter:function(t){return null!=n[t]?n[t]:t}}}({showMA:_,MA:y,legendName:m,labelMap:d}),W=O&&function(t){var e=t.metrics,i=t.dataType,n=t.digit,r=t.labelMap;return{trigger:"axis",axisPointer:{type:"cross"},position:function(t,e,i,n,r){var o={top:10};return o[t[0]<r.viewSize[0]/2?"right":"left"]=60,o},formatter:function(t){var a=[];return a.push(t[0].axisValue+"<br>"),t.forEach(function(t){var s=t.data,l=t.seriesName,u=t.componentSubType,c=t.color,h=null==r[l]?l:r[l];if(a.push(o(c)+" "+h+": "),"candlestick"===u)a.push("<br>"),e.slice(0,4).forEach(function(t,e){var o=null!=r[t]?r[t]:t,l=L(s[e+1],i,n);a.push("- "+o+": "+l+"<br>")});else if("line"===u){var p=L(s,i,n);a.push(p+"<br>")}else if("bar"===u){var d=L(s[1],i,n);a.push(d+"<br>")}}),a.join("")}}}({metrics:l,dataType:z,digit:c,labelMap:d}),H=b&&function(t){var e=t.downColor,i=t.upColor,n;return{show:!1,seriesIndex:t.showMA?1+t.MA.length:1,dimension:2,pieces:[{value:1,color:e},{value:-1,color:i}]}}({downColor:M,upColor:C,MA:y,showMA:_}),j=S&&function(t){var e=t.start,i=t.end;return[{type:"inside",xAxisIndex:[0,1],start:e,end:i},{show:!0,xAxisIndex:[0,1],type:"slider",top:"85%",start:e,end:i}]}({start:k,end:P});return{legend:$,tooltip:W,visualMap:H,grid:[{left:"10%",right:"8%",top:"10%",height:b?"50%":"65%",containLabel:!1},{left:"10%",right:"8%",top:"65%",height:"16%",containLabel:!1}],xAxis:function(t){var e=t.dims,i={onZero:!1};return[{type:"category",data:e,scale:!0,boundaryGap:!1,axisLine:i,splitLine:Nt,min:"dataMin",max:"dataMax"},{type:"category",gridIndex:1,data:e,scale:!0,boundaryGap:!1,axisLine:i,axisTick:Nt,splitLine:Nt,axisLabel:Nt,min:"dataMin",max:"dataMax"}]}({dims:N}),yAxis:function(t){var e=t.dataType,i=t.digit;return[{scale:!0,axisTick:Nt,axisLabel:{formatter:function(t){return L(t,e,i)}}},{scale:!0,gridIndex:1,splitNumber:2,axisLine:Nt,axisTick:Nt,splitLine:Nt,axisLabel:Nt}]}({dataType:z,digit:c}),dataZoom:j,series:function(t){var e=t.values,i=t.volumes,n,r,o=t.showMA,a=t.MA,s=t.showVol,l=t.labelMap,u=t.digit,c=t.itemStyle||{normal:{color:t.upColor,color0:t.downColor,borderColor:null,borderColor0:null}},h={normal:{opacity:.5}},p=[{name:null==l[Bt]?Bt:l[Bt],type:"candlestick",data:e,itemStyle:c}];return o&&a.forEach(function(t){var i="MA"+t;p.push({name:null==l[i]?i:l[i],data:function(t,e,i){var n=[];return e.forEach(function(r,o){if(o<t)n.push("-");else{for(var a=0,s=0;s<t;s++)a+=e[o-s][1];n.push(+(a/t).toFixed(i))}}),n}(t,e,u),type:"line",lineStyle:h,smooth:!0})}),s&&p.push({name:"Volume",type:"bar",xAxisIndex:1,yAxisIndex:1,data:i}),p}({values:F,volumes:V,upColor:C,downColor:M,showMA:_,MA:y,showVol:b,labelMap:d,digit:c,itemStyle:h}),axisPointer:{link:{xAxisIndex:"all"}}}},Vt=w({},tt,{name:"VeCandle",data:function(){return this.chartHandler=Ft,{}}}),Ut=function(t,e,i,n){var r=i.dimension,o=void 0===r?t[0]:r,a=i.metrics,s=void 0===a?t[1]:a,l=i.digit,u=void 0===l?2:l,c=i.dataType,h=void 0===c?{}:c,p=i.labelMap,d=void 0===p?{}:p,f=i.seriesMap,m=void 0===f?{}:f,g=i.dataName,y=void 0===g?{}:g,v=n.tooltipFormatter;return{tooltip:n.tooltipVisible&&function(t){var e=t.tooltipFormatter,i=t.dataType,n=t.digit;return{formatter:function(t){var r=t.seriesName,o=t.data,a=o.value,s=o.name;if(e)return e.apply(null,arguments);var l=[];return l.push(r+": "),l.push(L(a,i[r],n)+" "+s),l.join("")}}}({tooltipFormatter:v,dataType:h}),series:function(t){var e,i=t.dimension,n=t.metrics,r=t.digit,o=t.dataType,a=t.labelMap,s=t.seriesMap,l=t.dataName;return t.rows.map(function(t){var e=t[i],u=s[e],c={type:"gauge",name:null!=a[e]?a[e]:e,data:[{name:l[e]||"",value:t[n]}],detail:{formatter:function(t){return L(t,o[e],r)}},axisLabel:{formatter:function(t){return L(t,o[e],r)}}};return u&&Object.keys(u).forEach(function(t){k(c[t])?w(c[t],u[t]):c[t]=u[t]}),c})}({rows:e,dimension:o,metrics:s,digit:u,dataType:h,labelMap:d,seriesMap:m,dataName:y})}},Gt=w({},tt,{name:"VeGauge",data:function(){return this.chartHandler=Ut,{}}}),$t=function(t,e,i,n){var r=i.dimension,o=void 0===r?t[0]:r,a=i.metrics,s=void 0===a?t[1]:a,l=i.seriesMap,u=void 0===l?{}:l,c=n.legendVisible,h=n.tooltipFormatter,p=n.tooltipVisible;return{series:function(t){var e=t.dimension,i=t.metrics,n,r=t.seriesMap,o=[];return t.rows.forEach(function(t){var n=t[e],a=r[n],s={type:"tree",name:t[e],data:t[i]};r[t[e]]&&Object.keys(a).forEach(function(t){k(s[t])?w(s[t],a[t]):s[t]=a[t]}),o.push(s)}),o}({dimension:o,metrics:s,rows:e,seriesMap:u}),legend:c&&e.length>1&&function(t){var e=t.dimension;return{data:t.rows.map(function(t){return t[e]})}}({dimension:o,rows:e}),tooltip:p&&{trigger:"item",triggerOn:"mousemove",formatter:h}}},Wt=w({},tt,{name:"VeTree",data:function(){return this.chartHandler=$t,{}}}),Ht=function(t,e,i,n){var r=i.dimension,o=void 0===r?t[0]:r,a=i.metrics,s=void 0===a?t[1]:a,l=i.seriesMap,u=void 0===l?{}:l,c=i.dataType,h=void 0===c?"percent":c,p=i.digit,d=void 0===p?2:p,f=i.wave,m=void 0===f?[]:f,g=n.tooltipVisible,y=n.tooltipFormatter;return{tooltip:g&&function(t){var e=t.tooltipFormatter,i=t.dataType,n=t.digit;return{show:!0,formatter:function(t){var r=t.seriesName,o=t.value;return e?e.apply(null,arguments):r+": "+L(o,i,n)}}}({tooltipFormatter:y,dataType:h,digit:d}),series:function(t){var e=t.dimension,i=t.metrics,n=t.seriesMap,r=t.rows,o=t.wave,a=o,s=D(n)?n.length:0;return r.slice().map(function(t,r){var l=[],u={type:"liquidFill"},c=t[e],h=+t[i],p={};return D(n)?p=n[r]?n[r]:n[s-1]:k(n[c])&&(p=n[c]),D(o)&&D(o[0])&&(a=D(o[r])?o[r]:o[o.length-1]),l.push({value:h}),a&&a.length&&(l=l.concat(a.map(function(t){return{value:t}}))),w(u,{data:l,name:c},p)})}({rows:e,columns:t,dimension:o,metrics:s,seriesMap:u,wave:m})}},jt=w({},tt,{name:"VeLiquidfill",data:function(){return this.chartHandler=Ht,{}}}),Zt=function(t,e,i,n){var r=i.dimension,o=void 0===r?t[0]:r,a=i.metrics,s=void 0===a?t[1]:a,l=i.color,u=void 0===l?"":l,c=i.sizeMax,h=void 0===c?60:c,p=i.sizeMin,d=void 0===p?12:p,f=i.shape,m=void 0===f?"circle":f,g=n.tooltipVisible,y=n.tooltipFormatter;return{series:function(t){var e=t.dimension,i=t.metrics,n=t.rows,r=t.color,o=t.sizeMax,a=t.sizeMin,s=t.shape,l={type:"wordCloud",textStyle:{normal:{color:!D(r)&&r?r:function(){return"rgb("+[Math.round(160*Math.random()),Math.round(160*Math.random()),Math.round(160*Math.random())].join(",")+")"}}},shape:s,sizeRange:[a,o]},u=D(r)?r.length:0,c=n.slice().map(function(t){var n={name:t[e],value:t[i]};return u>0&&(n.textStyle={normal:{color:r[Math.floor(Math.random()*u)]}}),n});return l.data=c,[l]}({dimension:o,metrics:s,rows:e,color:u,sizeMax:h,sizeMin:d,shape:m}),tooltip:g&&function(t){var e=t.tooltipFormatter;return{show:!0,formatter:function(t){var i=t.data,n=i.name,r=i.value;return e?e.apply(null,t):n+": "+r}}}({tooltipFormatter:y})}},qt=w({},tt,{name:"VeWordcloud",data:function(){return this.chartHandler=Zt,{}}}),Xt=[et,it,rt,ut,ct,pt,ft,gt,yt,bt,St,Mt,Ct,Pt,Ot,Vt,Gt,Wt,jt,qt];function Yt(t,e){Xt.forEach(function(e){t.component(e.name,e)})}return"undefined"!=typeof window&&window.Vue&&Yt(window.Vue),{VeBar:et,VeHistogram:it,VeRing:ct,VeLine:rt,VePie:ut,VeWaterfall:pt,VeFunnel:ft,VeRadar:gt,VeChart:yt,VeMap:bt,VeBmap:St,VeAmap:Mt,VeSankey:Ct,VeScatter:Ot,VeCandle:Vt,VeGauge:Gt,VeTree:Wt,VeLiquidfill:jt,VeWordcloud:qt,install:Yt}}),t=this,e=function(){"use strict";var t=["compactDisplay","currency","currencyDisplay","currencySign","localeMatcher","notation","numberingSystem","signDisplay","style","unit","unitDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function e(t,e){void 0!==console&&(console.warn("[vue-i18n] "+t),e&&console.warn(e.stack))}var i=Array.isArray;function n(t){return null!==t&&"object"==typeof t}function r(t){return"string"==typeof t}var o=Object.prototype.toString,a="[object Object]";function s(t){return o.call(t)===a}function l(t){return null==t}function u(t){return"function"==typeof t}function c(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var r=null,o=null;return 1===t.length?n(t[0])||i(t[0])?o=t[0]:"string"==typeof t[0]&&(r=t[0]):2===t.length&&("string"==typeof t[0]&&(r=t[0]),(n(t[1])||i(t[1]))&&(o=t[1])),{locale:r,params:o}}function h(t){return JSON.parse(JSON.stringify(t))}function p(t,e){return!!~t.indexOf(e)}var d=Object.prototype.hasOwnProperty;function f(t,e){return d.call(t,e)}function m(t){for(var e=arguments,i=Object(t),r=1;r<arguments.length;r++){var o=e[r];if(null!=o){var a=void 0;for(a in o)f(o,a)&&(n(o[a])?i[a]=m(i[a],o[a]):i[a]=o[a])}}return i}function g(t,e){if(t===e)return!0;var r=n(t),o=n(e);if(!r||!o)return!r&&!o&&t+""==e+"";try{var a=i(t),s=i(e);if(a&&s)return t.length===e.length&&t.every(function(t,i){return g(t,e[i])});if(a||s)return!1;var l=Object.keys(t),u=Object.keys(e);return l.length===u.length&&l.every(function(i){return g(t[i],e[i])})}catch(t){return!1}}var y={name:"i18n",functional:!0,props:{tag:{type:[String,Boolean,Object],default:"span"},path:{type:String,required:!0},locale:{type:String},places:{type:[Array,Object]}},render:function(t,e){var i=e.data,n=e.parent,r=e.props,o=e.slots,a=n.$i18n;if(a){var s=r.path,l=r.locale,u=r.places,c=o(),h=a.i(s,l,function(t){var e;for(e in t)if("default"!==e)return!1;return!!e}(c)||u?function(t,e){var i=e?function(t){return Array.isArray(t)?t.reduce(_,{}):Object.assign({},t)}(e):{};if(!t)return i;var n=(t=t.filter(function(t){return t.tag||""!==t.text.trim()})).every(x);return t.reduce(n?v:_,i)}(c.default,u):c),p=r.tag&&!0!==r.tag||!1===r.tag?r.tag:"span";return p?t(p,i,h):h}}};function v(t,e){return e.data&&e.data.attrs&&e.data.attrs.place&&(t[e.data.attrs.place]=e),t}function _(t,e,i){return t[i]=e,t}function x(t){return!!(t.data&&t.data.attrs&&t.data.attrs.place)}var b,w={name:"i18n-n",functional:!0,props:{tag:{type:[String,Boolean,Object],default:"span"},value:{type:Number,required:!0},format:{type:[String,Object]},locale:{type:String}},render:function(e,i){var o=i.props,a=i.parent,s=i.data,l=a.$i18n;if(!l)return null;var u=null,c=null;r(o.format)?u=o.format:n(o.format)&&(o.format.key&&(u=o.format.key),c=Object.keys(o.format).reduce(function(e,i){var n;return p(t,i)?Object.assign({},e,((n={})[i]=o.format[i],n)):e},null));var h=o.locale||l.locale,d=l._ntp(o.value,h,u,c),f=d.map(function(t,e){var i,n=s.scopedSlots&&s.scopedSlots[t.type];return n?n(((i={})[t.type]=t.value,i.index=e,i.parts=d,i)):t.value}),m=o.tag&&!0!==o.tag||!1===o.tag?o.tag:"span";return m?e(m,{attrs:s.attrs,class:s.class,staticClass:s.staticClass},f):f}};function S(t,e,i){I(t,i)&&C(t,e,i)}function T(t,e,i,n){if(I(t,i)){var r=i.context.$i18n;(function(t,e){var i=e.context;return t._locale===i.$i18n.locale})(t,i)&&g(e.value,e.oldValue)&&g(t._localeMessage,r.getLocaleMessage(r.locale))||C(t,e,i)}}function M(t,i,n,r){if(n.context){var o=n.context.$i18n||{};i.modifiers.preserve||o.preserveDirectiveContent||(t.textContent=""),t._vt=void 0,delete t._vt,t._locale=void 0,delete t._locale,t._localeMessage=void 0,delete t._localeMessage}else e("Vue instance does not exists in VNode context")}function I(t,i){var n=i.context;return n?!!n.$i18n||(e("VueI18n instance does not exists in Vue instance"),!1):(e("Vue instance does not exists in VNode context"),!1)}function C(t,i,n){var o,a,l=function(t){var e,i,n,o;return r(t)?e=t:s(t)&&(e=t.path,i=t.locale,n=t.args,o=t.choice),{path:e,locale:i,args:n,choice:o}}(i.value),u=l.path,c=l.locale,h=l.args,p=l.choice;if(u||c||h)if(u){var d=n.context;t._vt=t.textContent=null!=p?(o=d.$i18n).tc.apply(o,[u,p].concat(A(c,h))):(a=d.$i18n).t.apply(a,[u].concat(A(c,h))),t._locale=d.$i18n.locale,t._localeMessage=d.$i18n.getLocaleMessage(d.$i18n.locale)}else e("`path` is required in v-t directive");else e("value type not supported")}function A(t,e){var i=[];return t&&i.push(t),e&&(Array.isArray(e)||s(e))&&i.push(e),i}function k(t,e){void 0===e&&(e={bridge:!1}),k.installed=!0,(b=t).version&&b.version.split(".")[0],function(t){t.prototype.hasOwnProperty("$i18n")||Object.defineProperty(t.prototype,"$i18n",{get:function(){return this._i18n}}),t.prototype.$t=function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];var n=this.$i18n;return n._t.apply(n,[t,n.locale,n._getMessages(),this].concat(e))},t.prototype.$tc=function(t,e){for(var i=[],n=arguments.length-2;n-- >0;)i[n]=arguments[n+2];var r=this.$i18n;return r._tc.apply(r,[t,r.locale,r._getMessages(),this,e].concat(i))},t.prototype.$te=function(t,e){var i=this.$i18n;return i._te(t,i.locale,i._getMessages(),e)},t.prototype.$d=function(t){for(var e,i=[],n=arguments.length-1;n-- >0;)i[n]=arguments[n+1];return(e=this.$i18n).d.apply(e,[t].concat(i))},t.prototype.$n=function(t){for(var e,i=[],n=arguments.length-1;n-- >0;)i[n]=arguments[n+1];return(e=this.$i18n).n.apply(e,[t].concat(i))}}(b),b.mixin(function(t){function e(){this!==this.$root&&this.$options.__INTLIFY_META__&&this.$el&&this.$el.setAttribute("data-intlify",this.$options.__INTLIFY_META__)}return void 0===t&&(t=!1),t?{mounted:e}:{beforeCreate:function(){var t=this.$options;if(t.i18n=t.i18n||(t.__i18nBridge||t.__i18n?{}:null),t.i18n){if(t.i18n instanceof et){if(t.__i18nBridge||t.__i18n)try{var e=t.i18n&&t.i18n.messages?t.i18n.messages:{};(t.__i18nBridge||t.__i18n).forEach(function(t){e=m(e,JSON.parse(t))}),Object.keys(e).forEach(function(i){t.i18n.mergeLocaleMessage(i,e[i])})}catch(t){}this._i18n=t.i18n,this._i18nWatcher=this._i18n.watchI18nData()}else if(s(t.i18n)){var i=this.$root&&this.$root.$i18n&&this.$root.$i18n instanceof et?this.$root.$i18n:null;if(i&&(t.i18n.root=this.$root,t.i18n.formatter=i.formatter,t.i18n.fallbackLocale=i.fallbackLocale,t.i18n.formatFallbackMessages=i.formatFallbackMessages,t.i18n.silentTranslationWarn=i.silentTranslationWarn,t.i18n.silentFallbackWarn=i.silentFallbackWarn,t.i18n.pluralizationRules=i.pluralizationRules,t.i18n.preserveDirectiveContent=i.preserveDirectiveContent),t.__i18nBridge||t.__i18n)try{var n=t.i18n&&t.i18n.messages?t.i18n.messages:{};(t.__i18nBridge||t.__i18n).forEach(function(t){n=m(n,JSON.parse(t))}),t.i18n.messages=n}catch(t){}var r=t.i18n.sharedMessages;r&&s(r)&&(t.i18n.messages=m(t.i18n.messages,r)),this._i18n=new et(t.i18n),this._i18nWatcher=this._i18n.watchI18nData(),(void 0===t.i18n.sync||t.i18n.sync)&&(this._localeWatcher=this.$i18n.watchLocale()),i&&i.onComponentInstanceCreated(this._i18n)}}else this.$root&&this.$root.$i18n&&this.$root.$i18n instanceof et?this._i18n=this.$root.$i18n:t.parent&&t.parent.$i18n&&t.parent.$i18n instanceof et&&(this._i18n=t.parent.$i18n)},beforeMount:function(){var t=this.$options;t.i18n=t.i18n||(t.__i18nBridge||t.__i18n?{}:null),t.i18n?t.i18n instanceof et?(this._i18n.subscribeDataChanging(this),this._subscribing=!0):s(t.i18n)&&(this._i18n.subscribeDataChanging(this),this._subscribing=!0):this.$root&&this.$root.$i18n&&this.$root.$i18n instanceof et?(this._i18n.subscribeDataChanging(this),this._subscribing=!0):t.parent&&t.parent.$i18n&&t.parent.$i18n instanceof et&&(this._i18n.subscribeDataChanging(this),this._subscribing=!0)},mounted:e,beforeDestroy:function(){if(this._i18n){var t=this;this.$nextTick(function(){t._subscribing&&(t._i18n.unsubscribeDataChanging(t),delete t._subscribing),t._i18nWatcher&&(t._i18nWatcher(),t._i18n.destroyVM(),delete t._i18nWatcher),t._localeWatcher&&(t._localeWatcher(),delete t._localeWatcher)})}}}}(e.bridge)),b.directive("t",{bind:S,update:T,unbind:M}),b.component(y.name,y),b.component(w.name,w),b.config.optionMergeStrategies.i18n=function(t,e){return void 0===e?t:e}}var D=function(){this._caches=Object.create(null)};D.prototype.interpolate=function(t,e){if(!e)return[t];var i=this._caches[t];return i||(i=function(t){for(var e=[],i=0,n="";i<t.length;){var r=t[i++];if("{"===r){n&&e.push({type:"text",value:n}),n="";var o="";for(r=t[i++];void 0!==r&&"}"!==r;)o+=r,r=t[i++];var a="}"===r,s=E.test(o)?"list":a&&P.test(o)?"named":"unknown";e.push({value:o,type:s})}else"%"===r?"{"!==t[i]&&(n+=r):n+=r}return n&&e.push({type:"text",value:n}),e}(t),this._caches[t]=i),function(t,e){var i=[],r=0,o=Array.isArray(e)?"list":n(e)?"named":"unknown";if("unknown"===o)return i;for(;r<t.length;){var a=t[r];switch(a.type){case"text":i.push(a.value);break;case"list":i.push(e[parseInt(a.value,10)]);break;case"named":"named"===o&&i.push(e[a.value])}r++}return i}(i,e)};var E=/^(?:\d)+/,P=/^(?:\w)+/,L=0,z=1,O=2,R=3,B=0,N=4,F=5,V=6,U=7,G=8,$=[];$[0]={ws:[0],ident:[3,L],"[":[4],eof:[7]},$[1]={ws:[1],".":[2],"[":[4],eof:[7]},$[2]={ws:[2],ident:[3,L],0:[3,L],number:[3,L]},$[3]={ident:[3,L],0:[3,L],number:[3,L],ws:[1,1],".":[2,1],"[":[4,1],eof:[7,1]},$[4]={"'":[F,L],'"':[V,L],"[":[4,2],"]":[1,3],eof:8,else:[4,L]},$[F]={"'":[4,L],eof:8,else:[F,L]},$[V]={'"':[4,L],eof:8,else:[V,L]};var W=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function H(t){if(null==t)return"eof";switch(t.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return t;case 95:case 36:case 45:return"ident";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"ws"}return"ident"}function j(t){var e,i,n,r=t.trim();return("0"!==t.charAt(0)||!isNaN(t))&&(n=r,W.test(n)?(i=(e=r).charCodeAt(0))!==e.charCodeAt(e.length-1)||34!==i&&39!==i?e:e.slice(1,-1):"*"+r)}var Z=function(){this._cache=Object.create(null)};Z.prototype.parsePath=function(t){var e=this._cache[t];return e||(e=function(t){var e,i,n,r,o,a,s,l=[],u=-1,c=0,h=0,p=[];function d(){var e=t[u+1];if(c===F&&"'"===e||c===V&&'"'===e)return u++,n="\\"+e,p[L](),!0}for(p[1]=function(){void 0!==i&&(l.push(i),i=void 0)},p[L]=function(){void 0===i?i=n:i+=n},p[2]=function(){p[L](),h++},p[3]=function(){if(h>0)h--,c=4,p[L]();else{if(h=0,void 0===i)return!1;if(!1===(i=j(i)))return!1;p[1]()}};null!==c;)if("\\"!==(e=t[++u])||!d()){if(r=H(e),8===(o=(s=$[c])[r]||s.else||8))return;if(c=o[0],(a=p[o[1]])&&(n=void 0===(n=o[2])?e:n,!1===a()))return;if(7===c)return l}}(t))&&(this._cache[t]=e),e||[]},Z.prototype.getPathValue=function(t,e){if(!n(t))return null;var i=this.parsePath(e);if(0===i.length)return null;for(var r=i.length,o=t,a=0;a<r;){var s=o[i[a]];if(null==s)return null;o=s,a++}return o};var q,X=/<\/?[\w\s="/.':;#-\/]+>/,Y=/(?:@(?:\.[a-z]+)?:(?:[\w\-_|./]+|\([\w\-_|./]+\)))/g,K=/^@(?:\.([a-z]+))?:/,J=/[()]/g,Q={upper:function(t){return t.toLocaleUpperCase()},lower:function(t){return t.toLocaleLowerCase()},capitalize:function(t){return""+t.charAt(0).toLocaleUpperCase()+t.substr(1)}},tt=new D,et=function(t){var e=this;void 0===t&&(t={}),!b&&"undefined"!=typeof window&&window.Vue&&k(window.Vue);var i=t.locale||"en-US",n=!1!==t.fallbackLocale&&(t.fallbackLocale||"en-US"),r=t.messages||{},o=t.dateTimeFormats||t.datetimeFormats||{},a=t.numberFormats||{};this._vm=null,this._formatter=t.formatter||tt,this._modifiers=t.modifiers||{},this._missing=t.missing||null,this._root=t.root||null,this._sync=void 0===t.sync||!!t.sync,this._fallbackRoot=void 0===t.fallbackRoot||!!t.fallbackRoot,this._formatFallbackMessages=void 0!==t.formatFallbackMessages&&!!t.formatFallbackMessages,this._silentTranslationWarn=void 0!==t.silentTranslationWarn&&t.silentTranslationWarn,this._silentFallbackWarn=void 0!==t.silentFallbackWarn&&!!t.silentFallbackWarn,this._dateTimeFormatters={},this._numberFormatters={},this._path=new Z,this._dataListeners=new Set,this._componentInstanceCreatedListener=t.componentInstanceCreatedListener||null,this._preserveDirectiveContent=void 0!==t.preserveDirectiveContent&&!!t.preserveDirectiveContent,this.pluralizationRules=t.pluralizationRules||{},this._warnHtmlInMessage=t.warnHtmlInMessage||"off",this._postTranslation=t.postTranslation||null,this._escapeParameterHtml=t.escapeParameterHtml||!1,"__VUE_I18N_BRIDGE__"in t&&(this.__VUE_I18N_BRIDGE__=t.__VUE_I18N_BRIDGE__),this.getChoiceIndex=function(t,i){var n=Object.getPrototypeOf(e),r,o;return n&&n.getChoiceIndex?n.getChoiceIndex.call(e,t,i):e.locale in e.pluralizationRules?e.pluralizationRules[e.locale].call(e,t,i):(o=i,r=Math.abs(r=t),2===o?r?r>1?1:0:1:r?Math.min(r,2):0)},this._exist=function(t,i){return!(!t||!i||l(e._path.getPathValue(t,i))&&!t[i])},"warn"!==this._warnHtmlInMessage&&"error"!==this._warnHtmlInMessage||Object.keys(r).forEach(function(t){e._checkLocaleMessage(t,e._warnHtmlInMessage,r[t])}),this._initVM({locale:i,fallbackLocale:n,messages:r,dateTimeFormats:o,numberFormats:a})},it={vm:{configurable:!0},messages:{configurable:!0},dateTimeFormats:{configurable:!0},numberFormats:{configurable:!0},availableLocales:{configurable:!0},locale:{configurable:!0},fallbackLocale:{configurable:!0},formatFallbackMessages:{configurable:!0},missing:{configurable:!0},formatter:{configurable:!0},silentTranslationWarn:{configurable:!0},silentFallbackWarn:{configurable:!0},preserveDirectiveContent:{configurable:!0},warnHtmlInMessage:{configurable:!0},postTranslation:{configurable:!0},sync:{configurable:!0}};return et.prototype._checkLocaleMessage=function(t,n,o){var a=function(t,n,o,l){if(s(o))Object.keys(o).forEach(function(e){var i=o[e];s(i)?(l.push(e),l.push("."),a(t,n,i,l),l.pop(),l.pop()):(l.push(e),a(t,n,i,l),l.pop())});else if(i(o))o.forEach(function(e,i){s(e)?(l.push("["+i+"]"),l.push("."),a(t,n,e,l),l.pop(),l.pop()):(l.push("["+i+"]"),a(t,n,e,l),l.pop())});else if(r(o)&&X.test(o)){var u="Detected HTML in message '"+o+"' of keypath '"+l.join("")+"' at '"+n+"'. Consider component interpolation with '<i18n>' to avoid XSS. See https://bit.ly/2ZqJzkp";"warn"===t?e(u):"error"===t&&function(t,e){void 0!==console&&console.error("[vue-i18n] "+t)}(u)}};a(n,t,o,[])},et.prototype._initVM=function(t){var e=b.config.silent;b.config.silent=!0,this._vm=new b({data:t,__VUE18N__INSTANCE__:!0}),b.config.silent=e},et.prototype.destroyVM=function(){this._vm.$destroy()},et.prototype.subscribeDataChanging=function(t){this._dataListeners.add(t)},et.prototype.unsubscribeDataChanging=function(t){!function(t,e){t.delete(e)}(this._dataListeners,t)},et.prototype.watchI18nData=function(){var t=this;return this._vm.$watch("$data",function(){for(var e,i,n=(e=t._dataListeners,i=[],e.forEach(function(t){return i.push(t)}),i),r=n.length;r--;)b.nextTick(function(){n[r]&&n[r].$forceUpdate()})},{deep:!0})},et.prototype.watchLocale=function(t){if(t){if(!this.__VUE_I18N_BRIDGE__)return null;var e=this,i=this._vm;return this.vm.$watch("locale",function(n){i.$set(i,"locale",n),e.__VUE_I18N_BRIDGE__&&t&&(t.locale.value=n),i.$forceUpdate()},{immediate:!0})}if(!this._sync||!this._root)return null;var n=this._vm;return this._root.$i18n.vm.$watch("locale",function(t){n.$set(n,"locale",t),n.$forceUpdate()},{immediate:!0})},et.prototype.onComponentInstanceCreated=function(t){this._componentInstanceCreatedListener&&this._componentInstanceCreatedListener(t,this)},it.vm.get=function(){return this._vm},it.messages.get=function(){return h(this._getMessages())},it.dateTimeFormats.get=function(){return h(this._getDateTimeFormats())},it.numberFormats.get=function(){return h(this._getNumberFormats())},it.availableLocales.get=function(){return Object.keys(this.messages).sort()},it.locale.get=function(){return this._vm.locale},it.locale.set=function(t){this._vm.$set(this._vm,"locale",t)},it.fallbackLocale.get=function(){return this._vm.fallbackLocale},it.fallbackLocale.set=function(t){this._localeChainCache={},this._vm.$set(this._vm,"fallbackLocale",t)},it.formatFallbackMessages.get=function(){return this._formatFallbackMessages},it.formatFallbackMessages.set=function(t){this._formatFallbackMessages=t},it.missing.get=function(){return this._missing},it.missing.set=function(t){this._missing=t},it.formatter.get=function(){return this._formatter},it.formatter.set=function(t){this._formatter=t},it.silentTranslationWarn.get=function(){return this._silentTranslationWarn},it.silentTranslationWarn.set=function(t){this._silentTranslationWarn=t},it.silentFallbackWarn.get=function(){return this._silentFallbackWarn},it.silentFallbackWarn.set=function(t){this._silentFallbackWarn=t},it.preserveDirectiveContent.get=function(){return this._preserveDirectiveContent},it.preserveDirectiveContent.set=function(t){this._preserveDirectiveContent=t},it.warnHtmlInMessage.get=function(){return this._warnHtmlInMessage},it.warnHtmlInMessage.set=function(t){var e=this,i=this._warnHtmlInMessage;if(this._warnHtmlInMessage=t,i!==t&&("warn"===t||"error"===t)){var n=this._getMessages();Object.keys(n).forEach(function(t){e._checkLocaleMessage(t,e._warnHtmlInMessage,n[t])})}},it.postTranslation.get=function(){return this._postTranslation},it.postTranslation.set=function(t){this._postTranslation=t},it.sync.get=function(){return this._sync},it.sync.set=function(t){this._sync=t},et.prototype._getMessages=function(){return this._vm.messages},et.prototype._getDateTimeFormats=function(){return this._vm.dateTimeFormats},et.prototype._getNumberFormats=function(){return this._vm.numberFormats},et.prototype._warnDefault=function(t,e,i,n,o,a){if(!l(i))return i;if(this._missing){var s=this._missing.call(null,t,e,n,o);if(r(s))return s}if(this._formatFallbackMessages){var u=c.apply(void 0,o);return this._render(e,a,u.params,e)}return e},et.prototype._isFallbackRoot=function(t){return!t&&!l(this._root)&&this._fallbackRoot},et.prototype._isSilentFallbackWarn=function(t){return this._silentFallbackWarn instanceof RegExp?this._silentFallbackWarn.test(t):this._silentFallbackWarn},et.prototype._isSilentFallback=function(t,e){return this._isSilentFallbackWarn(e)&&(this._isFallbackRoot()||t!==this.fallbackLocale)},et.prototype._isSilentTranslationWarn=function(t){return this._silentTranslationWarn instanceof RegExp?this._silentTranslationWarn.test(t):this._silentTranslationWarn},et.prototype._interpolate=function(t,e,n,o,a,c,h){if(!e)return null;var p,d=this._path.getPathValue(e,n);if(i(d)||s(d))return d;if(l(d)){if(!s(e))return null;if(!r(p=e[n])&&!u(p))return null}else{if(!r(d)&&!u(d))return null;p=d}return r(p)&&(p.indexOf("@:")>=0||p.indexOf("@.")>=0)&&(p=this._link(t,e,p,o,"raw",c,h)),this._render(p,a,c,n)},et.prototype._link=function(t,e,n,r,o,a,s){var l=n,u=l.match(Y);for(var c in u)if(u.hasOwnProperty(c)){var h=u[c],d=h.match(K),f=d[0],m=d[1],g=h.replace(f,"").replace(J,"");if(p(s,g))return l;s.push(g);var y=this._interpolate(t,e,g,r,"raw"===o?"string":o,"raw"===o?void 0:a,s);if(this._isFallbackRoot(y)){if(!this._root)throw Error("unexpected error");var v=this._root.$i18n;y=v._translate(v._getMessages(),v.locale,v.fallbackLocale,g,r,o,a)}y=this._warnDefault(t,g,y,r,i(a)?a:[a],o),this._modifiers.hasOwnProperty(m)?y=this._modifiers[m](y):Q.hasOwnProperty(m)&&(y=Q[m](y)),s.pop(),l=y?l.replace(h,y):l}return l},et.prototype._createMessageContext=function(t,e,r,o){var a=this,s=i(t)?t:[],l=n(t)?t:{},u=this._getMessages(),c=this.locale;return{list:function(t){return s[t]},named:function(t){return l[t]},values:t,formatter:e,path:r,messages:u,locale:c,linked:function(t){return a._interpolate(c,u[c]||{},t,null,o,void 0,[t])}}},et.prototype._render=function(t,e,i,n){if(u(t))return t(this._createMessageContext(i,this._formatter||tt,n,e));var o=this._formatter.interpolate(t,i,n);return o||(o=tt.interpolate(t,i,n)),"string"!==e||r(o)?o:o.join("")},et.prototype._appendItemToChain=function(t,e,i){var n=!1;return p(t,e)||(n=!0,e&&(n="!"!==e[e.length-1],e=e.replace(/!/g,""),t.push(e),i&&i[e]&&(n=i[e]))),n},et.prototype._appendLocaleToChain=function(t,e,i){var n,r=e.split("-");do{var o=r.join("-");n=this._appendItemToChain(t,o,i),r.splice(-1,1)}while(r.length&&!0===n);return n},et.prototype._appendBlockToChain=function(t,e,i){for(var n=!0,o=0;o<e.length&&"boolean"==typeof n;o++){var a=e[o];r(a)&&(n=this._appendLocaleToChain(t,a,i))}return n},et.prototype._getLocaleChain=function(t,e){if(""===t)return[];this._localeChainCache||(this._localeChainCache={});var o=this._localeChainCache[t];if(!o){e||(e=this.fallbackLocale),o=[];for(var a,s=[t];i(s);)s=this._appendBlockToChain(o,s,e);(s=r(a=i(e)?e:n(e)?e.default?e.default:null:e)?[a]:a)&&this._appendBlockToChain(o,s,null),this._localeChainCache[t]=o}return o},et.prototype._translate=function(t,e,i,n,r,o,a){for(var s,u=this._getLocaleChain(e,i),c=0;c<u.length;c++){var h=u[c];if(!l(s=this._interpolate(h,t[h],n,r,o,a,[n])))return s}return null},et.prototype._t=function(t,e,i,n){for(var r,o=[],a=arguments.length-4;a-- >0;)o[a]=arguments[a+4];if(!t)return"";var s,l=c.apply(void 0,o);this._escapeParameterHtml&&(l.params=(null!=(s=l.params)&&Object.keys(s).forEach(function(t){"string"==typeof s[t]&&(s[t]=s[t].replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"))}),s));var u=l.locale||e,h=this._translate(i,u,this.fallbackLocale,t,n,"string",l.params);if(this._isFallbackRoot(h)){if(!this._root)throw Error("unexpected error");return(r=this._root).$t.apply(r,[t].concat(o))}return h=this._warnDefault(u,t,h,n,o,"string"),this._postTranslation&&null!=h&&(h=this._postTranslation(h,t)),h},et.prototype.t=function(t){for(var e,i=[],n=arguments.length-1;n-- >0;)i[n]=arguments[n+1];return(e=this)._t.apply(e,[t,this.locale,this._getMessages(),null].concat(i))},et.prototype._i=function(t,e,i,n,r){var o=this._translate(i,e,this.fallbackLocale,t,n,"raw",r);if(this._isFallbackRoot(o)){if(!this._root)throw Error("unexpected error");return this._root.$i18n.i(t,e,r)}return this._warnDefault(e,t,o,n,[r],"raw")},et.prototype.i=function(t,e,i){return t?(r(e)||(e=this.locale),this._i(t,e,this._getMessages(),null,i)):""},et.prototype._tc=function(t,e,i,n,r){for(var o,a=[],s=arguments.length-5;s-- >0;)a[s]=arguments[s+5];if(!t)return"";void 0===r&&(r=1);var l={count:r,n:r},u=c.apply(void 0,a);return u.params=Object.assign(l,u.params),a=null===u.locale?[u.params]:[u.locale,u.params],this.fetchChoice((o=this)._t.apply(o,[t,e,i,n].concat(a)),r)},et.prototype.fetchChoice=function(t,e){if(!t||!r(t))return null;var i=t.split("|");return i[e=this.getChoiceIndex(e,i.length)]?i[e].trim():t},et.prototype.tc=function(t,e){for(var i,n=[],r=arguments.length-2;r-- >0;)n[r]=arguments[r+2];return(i=this)._tc.apply(i,[t,this.locale,this._getMessages(),null,e].concat(n))},et.prototype._te=function(t,e,i){for(var n=[],r=arguments.length-3;r-- >0;)n[r]=arguments[r+3];var o=c.apply(void 0,n).locale||e;return this._exist(i[o],t)},et.prototype.te=function(t,e){return this._te(t,this.locale,this._getMessages(),e)},et.prototype.getLocaleMessage=function(t){return h(this._vm.messages[t]||{})},et.prototype.setLocaleMessage=function(t,e){"warn"!==this._warnHtmlInMessage&&"error"!==this._warnHtmlInMessage||this._checkLocaleMessage(t,this._warnHtmlInMessage,e),this._vm.$set(this._vm.messages,t,e)},et.prototype.mergeLocaleMessage=function(t,e){"warn"!==this._warnHtmlInMessage&&"error"!==this._warnHtmlInMessage||this._checkLocaleMessage(t,this._warnHtmlInMessage,e),this._vm.$set(this._vm.messages,t,m(void 0!==this._vm.messages[t]&&Object.keys(this._vm.messages[t]).length?Object.assign({},this._vm.messages[t]):{},e))},et.prototype.getDateTimeFormat=function(t){return h(this._vm.dateTimeFormats[t]||{})},et.prototype.setDateTimeFormat=function(t,e){this._vm.$set(this._vm.dateTimeFormats,t,e),this._clearDateTimeFormat(t,e)},et.prototype.mergeDateTimeFormat=function(t,e){this._vm.$set(this._vm.dateTimeFormats,t,m(this._vm.dateTimeFormats[t]||{},e)),this._clearDateTimeFormat(t,e)},et.prototype._clearDateTimeFormat=function(t,e){for(var i in e){var n=t+"__"+i;this._dateTimeFormatters.hasOwnProperty(n)&&delete this._dateTimeFormatters[n]}},et.prototype._localizeDateTime=function(t,e,i,n,r){for(var o=e,a=n[o],s=this._getLocaleChain(e,i),u=0;u<s.length;u++){var c=s[u];if(o=c,!l(a=n[c])&&!l(a[r]))break}if(l(a)||l(a[r]))return null;var h=a[r],p=o+"__"+r,d=this._dateTimeFormatters[p];return d||(d=this._dateTimeFormatters[p]=new Intl.DateTimeFormat(o,h)),d.format(t)},et.prototype._d=function(t,e,i){if(!i)return new Intl.DateTimeFormat(e).format(t);var n=this._localizeDateTime(t,e,this.fallbackLocale,this._getDateTimeFormats(),i);if(this._isFallbackRoot(n)){if(!this._root)throw Error("unexpected error");return this._root.$i18n.d(t,i,e)}return n||""},et.prototype.d=function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];var o=this.locale,a=null;return 1===e.length?r(e[0])?a=e[0]:n(e[0])&&(e[0].locale&&(o=e[0].locale),e[0].key&&(a=e[0].key)):2===e.length&&(r(e[0])&&(a=e[0]),r(e[1])&&(o=e[1])),this._d(t,o,a)},et.prototype.getNumberFormat=function(t){return h(this._vm.numberFormats[t]||{})},et.prototype.setNumberFormat=function(t,e){this._vm.$set(this._vm.numberFormats,t,e),this._clearNumberFormat(t,e)},et.prototype.mergeNumberFormat=function(t,e){this._vm.$set(this._vm.numberFormats,t,m(this._vm.numberFormats[t]||{},e)),this._clearNumberFormat(t,e)},et.prototype._clearNumberFormat=function(t,e){for(var i in e){var n=t+"__"+i;this._numberFormatters.hasOwnProperty(n)&&delete this._numberFormatters[n]}},et.prototype._getNumberFormatter=function(t,e,i,n,r,o){for(var a=e,s=n[a],u=this._getLocaleChain(e,i),c=0;c<u.length;c++){var h=u[c];if(a=h,!l(s=n[h])&&!l(s[r]))break}if(l(s)||l(s[r]))return null;var p,d=s[r];if(o)p=new Intl.NumberFormat(a,Object.assign({},d,o));else{var f=a+"__"+r;(p=this._numberFormatters[f])||(p=this._numberFormatters[f]=new Intl.NumberFormat(a,d))}return p},et.prototype._n=function(t,e,i,n){if(!et.availabilities.numberFormat)return"";if(!i)return(n?new Intl.NumberFormat(e,n):new Intl.NumberFormat(e)).format(t);var r=this._getNumberFormatter(t,e,this.fallbackLocale,this._getNumberFormats(),i,n),o=r&&r.format(t);if(this._isFallbackRoot(o)){if(!this._root)throw Error("unexpected error");return this._root.$i18n.n(t,Object.assign({},{key:i,locale:e},n))}return o||""},et.prototype.n=function(e){for(var i=[],o=arguments.length-1;o-- >0;)i[o]=arguments[o+1];var a=this.locale,s=null,l=null;return 1===i.length?r(i[0])?s=i[0]:n(i[0])&&(i[0].locale&&(a=i[0].locale),i[0].key&&(s=i[0].key),l=Object.keys(i[0]).reduce(function(e,n){var r;return p(t,n)?Object.assign({},e,((r={})[n]=i[0][n],r)):e},null)):2===i.length&&(r(i[0])&&(s=i[0]),r(i[1])&&(a=i[1])),this._n(e,a,s,l)},et.prototype._ntp=function(t,e,i,n){if(!et.availabilities.numberFormat)return[];if(!i)return(n?new Intl.NumberFormat(e,n):new Intl.NumberFormat(e)).formatToParts(t);var r=this._getNumberFormatter(t,e,this.fallbackLocale,this._getNumberFormats(),i,n),o=r&&r.formatToParts(t);if(this._isFallbackRoot(o)){if(!this._root)throw Error("unexpected error");return this._root.$i18n._ntp(t,e,i,n)}return o||[]},Object.defineProperties(et.prototype,it),Object.defineProperty(et,"availabilities",{get:function(){if(!q){var t="undefined"!=typeof Intl;q={dateTimeFormat:t&&void 0!==Intl.DateTimeFormat,numberFormat:t&&void 0!==Intl.NumberFormat}}return q}}),et.install=k,et.version="8.26.7",et},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.VueI18n=e();
const messages={en:{card11:{span:"Interactive",h11:"TSMC:",h12:"How a Taiwanese Chipmaker Silently Built Its Tech Empire",p:'<p>In the past two years, TSMC has become the world’s target due to a high demand for chips globally. In the meantime, Taiwan has been called "the most dangerous place in the world" by The Economist because of a possible war with China.</p><p>While the U.S., Japan, Germany and China are all fighting for chips, currently regarded as important strategic assets, they have invited TSMC to set up its plants within their borders to ensure that chip manufacturing is not affected by the global pandemic or conflicts.</p><p>There is no doubt that the chips have become the oil of the 21st century. Starting its business in "the age of globalization", TSMC becomes a star in "the age of anti-globalization," with everyone paying close attention to where it will set up its factories to manufacture chips in the future.</p>'},card12:{p:"<p>In 1987, three years prior to the fall of the Berlin Wall, TSMC was founded in Hsinchu. TSMC's foundry manufacturing business model was founded amid the collapse of the Cold War and the onset of globalization, with customers, shareholders and market profits as the guiding principles.</p><p>At this critical moment, as we look back on TSMC's journey of globalization and expansion, we can better understand the challenges it faces today. These challenges do not only belong to one company, but also affect the future of the world's chip industry and are often the precursor of geopolitical tensions.</p>"},card2:{h2:'What is a "chip"?',h61:"Integrated Circuit",p1:"An integrated circuit is formed by millions of transistors and other electronic components on a chip that is about half a centimeter in length and width.",h62:"Transistor",p2:"A component of a semiconductor, which acts like a faucet that controls the flow of water. A transistor controls electric current."},card3:{h2:"How to produce a chip？",h31:"IC Design",p1:"Engineers start by designing the IC and planning chip functions.",h32:"Manufacturing",p2:'Upstream silicon wafer manufacturers purify the silicon, pull out the "silicon pillars," and slice the pillars into thin slices like a ham to form "wafers". Then, after a series of complicated procedures in a manufacturing plant like TSMC, the circuit design is transferred onto the wafer through a mask.',h33:"Packaging",p3:"Next the wafers are sent to the packaging plant to be cut into chips and tested.",tag:"TSMC’s position"},card4:{h2:'"Eight Inch Wafer", "Five Nanometer Process" - What do These Numbers Mean?',p1:'<p>Terms such as "eight inch wafers" or "twelve inch wafers" are often seen in Taiwanese media reports. These numbers refer to the diameter of the silicon wafers used. <b>Using larger wafers means that more chips can be produced from a single wafer, lowering the unit cost of manufacturing a single chip while simultaneously adopting more modern production requirements.</b></p><p>Currently, <b>TSMC\'s most modern manufacturing processes are all based on twelve inch wafers, while eight inch wafers are used for manufacturing older chips.</b> In the past couple years, the demand for even older manufacturing processes in products such as touchscreens and power supplies in the global market has exceeded expectations, causing even eight inch wafers to be in short supply.</p>',p2:"<p>The nanometer value, which is in the billionths of a meter, refers roughly to the smallest unit that can be manufactured inside the circuitry of a chip.</p><p>Semiconductor manufacturing companies compete by lowering this number, <b>because smaller processes mean that more circuitry can be manufactured in the same amount of space, preventing chip sizes from increasing as chips become more advanced. Smaller processes also allow chips to be lighter, more energy efficient, and have better performance.</b></p>"},card5:{h2:'TSMC’s "pure-foundry" model',p1:"<p>TSMC has adopted a rather innovative <strong>pure-play foundry business model</strong> in the history of the world’s semiconductor industry. TSMC’s founder Morris Chang recalled that most of the world's semiconductor companies have chosen to implement the Integrated Design and Manufacture (IDM) mode instead, which means that the three sections of the semiconductor industry, IC design, IC foundry, and IC marketing, are all integrated in one company. TSMC's innovation is <strong>to focus solely on \"IC foundry.\"</strong> TSMC also promised their clients that it would never compete with them, therefore winning over most of the global clients.</p>",p2:'<p>Why did Chang adopt this strategy?</p> <p><strong>He pointed out that in the 1980s, Taiwan did not have the design and marketing capabilities to establish a vertically integrated company.  Although Taiwan’s semiconductor technology was falling behind at the time, "the wafer yield was so good that it could compete with other world-class companies."</strong> Therefore, the strategy proposed by Chang was tailor-made for Taiwan back then.</p>'},pedia1:{p1:'<p>In 1994, after TSMC\'s stock went public, the company began to expand aggressively and entered a critical period as it started to plan its mega-fab, known as <strong>"GIGAFAB"</strong>, which set a new pattern for TSMC.</p>',p2:"<p>In addition to the innovative GIGAFAB, TSMC completed the merger of TASMC and WSMC (which were named as TSMC's Fab 7 and Fab 8 respectively), and established a wafer fab in the Tainan Science Park, the second science park in Taiwan.</p> <p>In its global efforts, TSMC reinvested Wafertech in Washington, the United States, as its Fab 12, and also signed a joint venture with Philips to establish SSMC in Singapore.</p> <p style='line-height: 15px;'><small>Note: GIGAFAB is usually a combination of several fabs, much larger than a typical wafer fab, and is coordinated by an advanced \"centralized fab manufacturing management system known as the super manufacturing platform\". The photo on the left shows TSMC's Fab 12, which is TSMC’s first GIGAFAB in Hsinchu.</small></p>"},pedia2:{p1:"<p>However, TSMC's plans to set up overseas fabs are not without controversies. One of the most prolonged projects was the 8-inch wafer fab (Fab 10) in Shanghai, China. </p><p>TSMC's aggressive expansion coincided <b>with the period of a large number of Taiwanese businesses migrating to China and a heated debate in Taiwan about the pros and cons of investing and setting up factories in China.</b></p><hr>",p2:'<p class="m-0"><strong>1996</strong></p> <p>Taiwanese President Lee Teng-hui proposed a policy to suspend Taiwanese companies from investing in China, including projects with investments of more than US$50 million, high-tech industries, or any investments related to infrastructure. As a result, TSMC\'s plan to establish its Fab 10 in Shanghai, China was delayed.</p>',p3:"<hr><p><b>In 2000, after the first democratic power transition in Taiwan and the rise of President Chen Shui-bian, the situation improved.</b></p>",p4:"<p class=\"m-0\"><strong>2002</strong></p> <p>Taiwan's Ministry of Economic Affairs issued regulations <b>that allowed Taiwanese companies to set up semiconductor plants in China.</b> TSMC's plan to set up a plant in Songjiang, Shanghai, was finally approved by the government in February, 2001.</p>"},pedia3:{p1:"<p>In 2010, after the financial crisis, TSMC boldly increased its capital expenditures. From US$2.671 billion the year before, TSMC doubled its capital expenditures to US$5.936 billion.</p>",p2:"<hr> <p>In the 28nm process, which was in high demand, TSMC was able to increase the advantage over its competitors (Samsung, GlobalFoundries, UMC). In 2012, Chang called TSMC's 28nm \"a roaring success,\" taking nearly 100% of the foundry market share.</p> <p>Following the success of 28nm, TSMC rode the wave of smartphones.</p> <p>In 2014, TSMC was responsible for the A8 processor foundry order for Apple’s iPhone 6 with the 20nm process technology for the first time. For Apple’s iPhone 6s, TSMC and its competitor Samsung both won the A9 processor order, but TSMC used its 16nm process technology to beat Samsung's 14nm process technology.</p> <p>Since then, from iPhone 7 to iPhone 12, TSMC has been Apple’s exclusive contract manufacturer for processors, making Apple one of TSMC's biggest growth drivers in recent years.</p> <hr>",brand1:"TI 132 nm ",brand2:"TI 90 nm",brand3:"Samsung 65 nm",tips3:"iPhone 1 to iPhone 5: Samsung-made processors",brand4:"Samsung 14 nm and TSMC 16nm",brand5:"TSMC 16nm",tips5:"iPhon 7 to iPhone 13: TSMC-made processors"},pedia4:{p1:"<p>In the second quarter of 2018, TSMC's 7nm chips went into volume production. In this competition, TSMC had another advantage over its rival Samsung.</p>",p2:'<p>In October 2019, TSMC showed the world why the company is in its "golden era" by increasing its capital expenditures on 7nm and 5nm.</p>',p3:"<hr> <p><b>The expansion of capital expenditure is crucial because it is a capital race that all the players are competing.</b></p> <p>In order to remain competitive in the world of advanced manufacturing processes, from R&D costs to equipment spending, tens of billions of dollars of investment were poured into the field, and only TSMC of Taiwan, Samsung of South Korea and Intel of the United States are left with strong capital to compete in the race.</p><p>For example, when these three companies want to move to more advanced process technologies below 7nm, they must use extreme ultraviolet (EUV) lithography machines from the Dutch equipment manufacturer ASML, and these machines, which cost more than US$100 million each, are one of the factors that make TSMC's capital expenditure so high.</p><p>In April 2021, TSMC announced that it expects to invest about US$100 billion through the next 3 years to increase its capacity, to support the manufacturing and R&D of leading-edge and specialty technologies. Increased capacity is expected to improve supply certainty for their customers and help strengthen confidence in global supply chains that rely on semiconductors.</p>"},final:{figcaption:"The future is uncertain, but as we look back on TSMC's globalization journey, perhaps we can better understand the challenges it faces today, challenges that affect not only one company but also the future of the world's chip industry.",p1:"<p>TSMC's success is highly related to globalization. Globalization allows capital and components to move across borders and secures a high degree of global division of labor. Therefore, TSMC can use Taiwan as its production base and sell its products to various countries.</p><p>TSMC plays an important role in the semiconductor industry, but in the past, its importance was underrated. For a long time, Taiwanese people felt that their industry needed to be upgraded and that being a brand was more important than being a foundry. Therefore, TSMC's value was slightly underestimated.</p><p>Since 2018, it has been different. The U.S.-China trade war is getting more and more intense: the U.S. is sanctioning Huawei, which forced supply chain to restructure while increasing trade barriers.  The new Cold War is starting to become a hot topic.</p><p>The covid-19 pandemic caused a chip shortage that put TSMC and the semiconductor industry in the world's spotlight, increasing its stock price and market capitalization significantly.</p>",h61:"Chips, like the one I have here — these chips, these wafers, are batteries, broadband; it's all infrastructure. This is infrastructure.",span1:"Joe Biden, U.S. President (2021)",p2:"<p>Following US President Biden's announcement that the U.S. should strengthen its infrastructure and develop its semiconductor industry,  some other major countries have followed-suit, starting to consider semiconductors as a strategic industry. TSMC's new plant in Phoenix, U.S.A. has already started construction. The company has also made an announcement to build a plant in Kumamoto, Japan. \n\t\t\tIn the wave of deglobalization, TSMC is looking to potentially setting up bases in more and more locations - although this may not be to their liking.\n\t\t\t</p><p>TSMC's former Chairman Chang and current Chairman Mark Liu have repeatedly expressed concern about the localization of wafer manufacturing. In their view, the localization of wafer manufacturing is highly impractical as it is an attempt to \"turn back the clock\". Cost will go up and technology advancement may be slowed.</p>",h62:"There will be a localization of semiconductor manufacturing, but I think it is a relatively partial development because the global semiconductor supply chain is closely connected to maximize consumer benefits, such as smartphones, etc. I think it is unlikely to localize these.",span2:"Mark Liu, Chairman of TSMC (2021)",h63:"It would be highly impractical to try to turn back the clock. If it is tried, cost will go up and technology advance may slow.",span3:"Morris Chang, Founder of TSMC (2021)",p3:'<p>Although TSMC has had overseas plants in the past, they have only been in China and the United States, which are two countries where TSMC\'s major customers are located. The most advanced processes and R&D bases have always remained in Taiwan.</p> <p>It seems that this strategy has not changed much: despite the constant calls for overseas manufacturing, TSMC\'s most advanced 2nm process will still be located in Hsinchu, Taiwan.</p> <p>TSMC was established in the era of globalization more than 30 years ago, and now it is the target of a "counter-globalization" trend and the global demand for chips.</p><p>How will TSMC move forward in the tide of geopolitics? Perhaps, as many experts suggest, TSMC may prefer to keep a low profile. But as a company that has been called Taiwan\'s "protector of the nation," TSMC is likely to be the focus of attention not just for investors and industry experts, but for the world.</p>'},credit:{h6:"Credits",table:"<tbody><tr><th>Writing</th> <td>Wen-Yee Lee, Yi-An Lee, Hsin-Chieh Ho, Ting-Wei Lin</td></tr> <tr><th>Design</th> <td>Athena Kuo</td></tr> <tr><th>Illustration</th> <td>Alice Tse</td></tr> <tr><th>Develop</th> <td>Elk Leung</td></tr></tbody>"},dashboard:{price:"Stock Price（NT$）",capex:"CapEx（bn US$）",tech:"Technology"},timeline:{p1:"Initial stage",p2:"Growth stage",p3:"Expanding stage",p4:"Expansion to China",p5:"Accelerating Stage",p6:"US-China Trade War",p7:"Global expansion"},datas:[{tech:"3µm",text:"<p>TSMC was initially a spin-off company of the government-backed Industrial Technology Research Institute (ITRI), and its first fab was rented from ITRI and located in ITRI's Chung Hsing Campus (later known as Fab 1), reflecting the government's role in promoting the development of Taiwan's semiconductor industry in the early stages. The plant was returned to ITRI in 2002.</p><small>There is no public data on capital expenditure before and including 1996.</small>",marker:"Fab1"},{tech:"1µm",text:"<p>TSMC's first fab that was wholly built and owned by itself (labeled as Fab 2) began volume production in the Hsinchu Science Park.</p><small>There is no public data on capital expenditure before and including 1996.</small>",marker:"Fab2"},{tech:"0.5µm",text:"<p>TSMC stock was listed.</p><small>There is no public data on capital expenditure before and including 1996.</small>"},{text:"<p>TSMC's Fab 3, its first 8-inch wafer fab, was in volume production. The fab is located at the Hsinchu Science Park’s second phase expansion area.</p><small>There is no public data on capital expenditure before and including 1996.</small>",marker:"Fab3"},{capex:"0.838",tech:"0.25µm",text:"<p>TSMC's Wafertech fab in Washington State, U.S.A. was  in volume production and is numbered as Fab 11.</p>",marker:"Fab11"},{capex:"2.551",tech:"0.13µm volume production",text:"<p>TSMC's Fab 6 in the Tainan Science Park was in volume production; TSMC completed the merger of TASMC and WSMC, turning them into Fab 7 and 8; and SSMC, a joint venture with Philips in Singapore, went into volume production.</p>",marker:"Fab6"},{capex:"2.551",tech:"0.13µm volume production",text:"<p>TSMC's Fab 6 in the Tainan Science Park was in volume production; TSMC completed the merger of TASMC and WSMC, turning them into Fab 7 and 8; and SSMC, a joint venture with Philips in Singapore, went into volume production.</p>",marker:"Fab7"},{capex:"2.551",tech:"0.13µm volume production",text:"<p>TSMC's Fab 6 in the Tainan Science Park was in volume production; TSMC completed the merger of TASMC and WSMC, turning them into Fab 7 and 8; and SSMC, a joint venture with Philips in Singapore, went into volume production.</p>",marker:"Fab8"},{capex:"2.551",tech:"0.13µm volume production",text:"<p>TSMC's Fab 6 in the Tainan Science Park was in volume production; TSMC completed the merger of TASMC and WSMC, turning them into Fab 7 and 8; and SSMC, a joint venture with Philips in Singapore, went into volume production.</p>",marker:"SSMC"},{capex:"2.012",text:"<p>TSMC's Fab 12 (Hsinchu), which was TSMC's first GIGAFAB and the first 12-inch wafer fab, is still TSMC’s global headquarter.</p>",marker:"Fab12"},{capex:"1.082",text:"<p>TSMC's self-developed 0.13-micron low-k, copper system-on-chip (SoC) technology went into volume production, giving TSMC a significant lead over Taiwan’s UMC.</p>"},{capex:"2.277",tech:"90nm volume production",text:"<p>TSMC's first plant in China, Fab 10, is located in Songjiang, Shanghai. Fab 14 (Tainan) went into volume production.</p><small>Capital expenditures before and including 2004  are based on TSMC's unconsolidated financial statements. The capital expenditures after and including 2005  are based on consolidated financial statements.</small>",marker:"Fab10"},{capex:"2.277",tech:"90nm volume production",text:"<p>TSMC's first plant in China, Fab 10, is located in Songjiang, Shanghai. Fab 14 (Tainan) went into volume production.</p><small>Capital expenditures before and including 2004  are based on TSMC's unconsolidated financial statements. The capital expenditures after and including 2005  are based on consolidated financial statements.</small>",marker:"Fab14"},{capex:"7.286",tech:"28nm volume production",text:"<p>In 2007, the initiation of the Taiwan High Speed Rail (THSR) enabled TSMC engineers in Hsinchu, Tainan (and later Taichung) to go back and forth in a day to provide frequent cross-fab support.</p><p>TSMC's first fab in Taichung, Fab 15, went into volume production and became the key 28nm manufacturing base.</p>",marker:"Fab15"},{capex:"9.522",tech:"20nm volume production",text:"<p>For the first time, TSMC was responsible for the A8 processor order for iPhone 6, using a 20nm process.</p>"},{capex:"10.463",tech:"7nm volume production",text:"<p>TSMC's 7nm process technology went into volume production. The Fab 16 in Nanjing is TSMC's second wafer fab in China.</p>",marker:"Fab16"},{capex:"14.903",tech:"7nm volume production",text:"<p>TSMC’s 7nm EUV process technology went into volume production.</p>"},{capex:"17.235",tech:"5nm volume production",text:"<p>TSMC’s Fab 18 (Tainan) went into volume production; the company announced its plan to set up a factory in Phoenix, USA.</p>",marker:"Fab18"},{capex:"17.235",tech:"5nm volume production",text:"<p>TSMC’s Fab 18 (Tainan) went into volume production; the company announced its plan to set up a factory in Phoenix, USA.</p>",marker:"Manufacturing Site"},{capex:"30(full year estimate)",text:"<p>Fab 12 P8 and P9 in Hsinchu are expected to be completed. Fab 20 is expected to be built in the second phase of Hsinchu's Baoshan project after it passed the Environmental Impact Assessments.TSMC announces its plan to set up a factory with Sony in Japan. Meanwhile, the company also announces a plan to build a new facility for 7nm and 28nm chips in Kaohsiung, Taiwan.</p><small>The stock price is at its all-time high on January 20. Meanwhile, the company also announces to build a new facility for 7nm and 28nm chips in Kaohsiung, Taiwan.</small>",marker:"Fab12P8,P9"},{capex:"30(full year estimate)",text:"<p>Fab 12 P8 and P9 in Hsinchu are expected to be completed. Fab 20 is expected to be built in the second phase of Hsinchu's Baoshan project after it passed the Environmental Impact Assessments.TSMC announces its plan to set up a factory with Sony in Japan. Meanwhile, the company also announces a plan to build a new facility for 7nm and 28nm chips in Kaohsiung, Taiwan.</p><small>The stock price is at its all-time high on January 20.</small>",marker:"Fab20"}]},zh:{card11:{span:"地圖頁面",h11:"台積電擴廠史",h12:"全球化晶圓代工的昨日、今日與未來",p:"<p>2021年9月，台積電可能在台灣高雄設7奈米廠的消息，廣受矚目。</p><p>畢竟，近兩年來，全球晶片需求高升，台積電成了全球兵家必爭之地；但台灣又因台海戰爭的陰影升高，而被《經濟學人》稱為「世界上最危險的地方」。美、日、德、中都在爭取晶片這個重要的戰略物資，希望留在自己國家境內設廠，確保它不受到疫情、戰爭的影響。</p><p>換句話說，在這「逆全球化」的年代，從「全球化時代」走來的台積電，未來設廠何處、在哪裡製造這「二十一世紀的石油」，動見觀瞻。</p>"},card12:{p:"<p>1987年，柏林圍牆倒塌的前三年，台積電在新竹起家；其採取的晶圓代工製造路線，奠基在舊冷戰瓦解、全球化浪潮來臨的年代，以客戶、股東與市場利潤為導向，以台灣為生產基地，向全球客戶供貨；但隨著中美對抗的世界大局逐漸成形，養育台積電的土壤，也起了根本性的變化。</p><p>在這關鍵時刻，當我們回顧台積電全球化、擴廠的旅程，將更能明白它今日面臨的挑戰，這些挑戰不只屬於一家企業，也牽動世界晶片／芯片產業的未來，甚至往往是地緣政治角力的先兆。</p>"},card2:{h2:"在回顧台積電的全球化旅程之前首先回頭認識：何謂「晶片」？",h61:"積體電路",p1:"將成千上億的電晶體與其他電子元件，全塞在一長寬約半公分的晶片上，這晶片即是積體電路。",h62:"電晶體",p2:"半導體的一個元件，就像水龍頭可以控制水流一樣，電晶體是電流的控制器。"},card3:{h2:"半導體晶片如何製作？",h31:"IC 設計",p1:"工程師會先畫出IC電路設計圖，規劃晶片功能。",h32:"晶圓製造",p2:"上游的矽晶圓廠將矽純化、拉出「矽晶柱」，並像切火腿一般將晶柱切成薄片，形成「晶圓」（Wafer）。接著，經過台積電這類製造廠的一連串複雜程序，電路設計圖透過光罩被轉印在晶圓上。",h33:"封裝測試",p3:"接著，晶圓被送到封裝廠切割成晶片，並做最後測試。",tag:"台積電所在位置"},card4:{h2:"「8吋晶圓」、「5奈米製程」這些數字代表什麼？",p1:"<p>台灣媒體上常見的「8吋晶圓」、「12吋晶圓」，指的是晶圓的直徑。<b>晶圓越大、可生產的晶片量就越多，可降低每單位晶片成本，也可隨設備技術演進滿足更先進製程</b>。</p><p>當前，<b>台積電最先進製程的晶片都是在12吋晶圓廠生產，8吋晶圓廠以生產成熟製程晶片為主。</b>過去一兩年，全球市場對成熟製程需求超過預期，用來生產觸控控制晶片、電源管理晶片的8吋晶圓廠產能供不應求。</p>",p2:"<p>1奈米是1公分的一千萬分之一，「5奈米製程」指在晶片中，最小可以做到接近5奈米的尺寸。</p><p>各家廠商之所以追求更細小奈米製程，是為了<b>在更小的晶片中塞入更多的電晶體，讓晶片不會因技術提升而變得更大，滿足現代對電子用品輕薄、省電、高效能的需求</b>。</p>"},card5:{h2:"台積電的「專業代工」模式",p1:"<p>台積電在世界半導體產業史上，採取的是相當創新的<strong>「專業晶圓代工」</strong>模式。台積電創辦人張忠謀後來曾回憶，世界上多數的半導體公司都採取「垂直整合」（IDM) 模式，也就是將半導體產業當中的IC設計、晶圓製造、IC行銷，三者集結在一個公司內完成。而台積電的創新之處，<strong>便是僅專注做「晶圓製造」</strong>一項，靠著永遠不與客戶競爭的承諾，讓它贏取了大量的半導體公司客戶。</p>",p2:"<p>張忠謀為何採取這樣的策略？</p> <p>他說，<strong>1980年代的台灣，沒有設計、行銷的能力，不可能做垂直整合公司，晶圓製造技術雖然落後，「但是在良率方面倒是滿好的，可以跟別的世界級公司的製造部門競爭」</strong>，也因此張忠謀提出的戰略，可說是為了當年的台灣「量身訂做」。</p> <p>在全球化的年代，台積電開始了它不斷擴張的旅程。</p>"},pedia1:{p1:"<p>台積電於 1994 年股票上市之後，開始積極擴張，進入關鍵的轉捩階段，除了在台灣、海外積極擴張之外，亦開始規劃超大型廠房<strong>「GIGAFAB」（超大晶圓廠）</strong>，奠定此後台積電在台灣興建廠房的新模式。</p>",p2:'<p>除了創新的廠房模式之外，台積電在台灣境內，則先後併購了「德碁」和「世大」兩間公司位於竹科的廠房（分別編為台積電的 7 廠和 8 廠），並在台灣的第二個科學園區──南部科學園區設立晶圓廠；</p> <p>至於海外，台積電則在美國華盛頓州轉投資 Wafertech（11廠），並與飛利浦合資於新加坡成立 SSMC。</p> <p style="line-height: 15px;"><small>註：GIGAFAB 通常由幾座廠房組合而成，規模比一般晶圓廠大很多，由先進的「集中式晶圓廠製造管理系統超級製造平台」協調運作。左圖即台積電新竹12廠，該廠為台積電的第一座GIGAFAB --新竹的12廠。</small></p>'},pedia2:{p1:"<p>不過台積電在海外設廠的計畫，也並非全無爭議；其中卡關最久的，當屬位於上海松江的八寸晶圓廠（10廠）。</p><p>台積電開始積極擴張時，正好是<b>李登輝執政時期，也是台商大舉赴陸、台灣社會激烈討論西進利弊的時間點</b>。</p><hr>",p2:'<p class="m-0"><strong>1996年</strong></p> <p>李登輝提出「戒急用忍」概念，決定暫緩投資金額高於 5000 萬美元、屬於高科技產業，或和基礎建設有關的對陸投資案。</p> <p>導致台積電在美國的11廠、在新加坡的SSMC都落成量產了，在上海松江的10廠都仍然沒有著落。</p>',p3:"<hr><p><b>台灣實現首次政黨輪替、陳水扁上台之後，情況才有了變化。</b></p>",p4:'<p class="m-0"><strong>2002年</strong></p> <p>台灣經濟部發布<b>《在大陸地區投資晶圓鑄造廠審查及監督作業要點》</b>，為台商赴陸設置半導體廠提供了審查依據。</p> <p>台積電在上海松江的設廠計畫，亦在隔年 2 月終於獲台灣經濟部同意。</p>'},pedia3:{p1:"<p>2010年，世界剛剛經歷金融海嘯，台積電卻大膽地將資本支出，從前一年的26.71億美元，翻倍為59.36億美元。</p>",p2:"<hr> <p>在這個客戶需求量非常大的製程，台積電拉開和其他競爭者（三星、GlobalFoundries、聯電）的距離。張忠謀在2012年稱台積電的28奈米是「徹底的成功」，拿下接近100%的晶圓代工市佔率。</p> <p>順著28奈米的成功，台積電搭上智慧型手機的浪潮。</p> <p>2014年，台積電以20奈米製程技術首度為蘋果iPhone 6 代工其A8處理器。在下一支蘋果iPhone 6s，台積電和競爭者三星雖同時拿下A9處理器訂單，台積電卻用其16奈米製程技術完勝三星的14奈米。</p> <p>自此之後，從iPhone 7 到今天的iPhone 12，蘋果的A系列處理器全找台積電代工，蘋果成為近幾年台積電的最大成長動能之一。</p> <hr>",brand1:"德州儀器 (132奈米)",brand2:"德州儀器 (90奈米)",brand3:"三星 (65奈米)",tips3:"從首代到iPhone 5，蘋果用的是三星代工的處理器",brand4:"使用三星 (14奈米)和台積電 (16奈米)",brand5:"台積電 (16奈米)",tips5:"從7開始至今，蘋果處理器皆找台積電代工"},pedia4:{p1:"<p>2018年第二季，台積電的7奈米晶片量產，在7奈米的這一役，台積電領先了對手三星。</p>",p2:"<p>2019年10月，台積電趁勝追擊加大資本支出，加強對7奈米和5奈米的投資，台積電再一次讓世界看到屬於它的「黃金年代」。</p>",p3:"<hr> <p><b>擴大資本支出之所以關鍵，因為各國現在正在比拚的，正是一場資本競賽。</b></p> <p>要想在先進製程的世界裡競爭，從研發成本到設備支出，動輒數百億美元的投資，全世界只剩下資本雄厚的台灣的台積電、南韓的三星和美國的英特爾玩得起。</p> <p>舉例來說，當這三家公司要往7奈米以下更先進的製程技術發展，就必須運用到荷蘭設備商艾斯摩爾（ASML）的EUV（極紫外光）機台，而這每台高達1億美元以上的機器，也是台積電資本支出超高的因素之一。</p> <p>為了因應市場需求、保持技術領先，2021年4月，台積電宣告將在未來三年投入1000億美元的資本支出。</p>"},final:{figcaption:"未來雖不可知，但當我們回顧台積電全球化的旅程，或許也更能明白它今日面臨的挑戰，這些挑戰不只屬於一家企業，亦牽動世界晶片／芯片產業的未來。",p1:"<p>台積電起初的崛起，可以說和「全球化」脫不了關係──正是資本、零組件的跨國流動，以及全球產業鏈的分工，讓台積電得以將台灣當作晶圓的生產基地，銷售各國。然而儘管扮演重要角色，台積電過往卻經常被視為「代工廠」，不只蟄伏在世界舞台的幕後，就連希望「發展品牌」、「追求產業升級」的台灣人，有時也未必看得見台積電「專業代工」的價值。</p><p>有趣的是，讓台積電開始被世界看見的原因，卻是另一股看似完全相反的動力：自從2018年美中貿易戰愈演愈烈，以及美國制裁華為、重組供應鏈之後，世界貿易便壁壘再起，頗有「新冷戰」的態勢；而 COVID-19 疫情造成的晶片短缺，則進一步加深了台積電、以及整個半導體產業的重要性──台積電近兩年大幅竄升的股價和市值，都反映了這些動態。</p>",h61:"晶片呢，就像我手裡的這個一樣，這些晶片、這些晶圓呢，就是電池，就是寬頻網路，那都是基礎設施。晶片，就是基礎設施。",span1:"美國總統拜登（Biden），2021",p2:"<p>隨著拜登對美國追趕基礎設施、發展半導體的呼籲，各個大國，也開始將半導體視為「戰略產業」；除了在美國鳳凰城的新廠已經開工之外，台積電也傳出可能會在日本、德國落地設廠：在這波「逆全球化」的浪潮中，台積電的設廠地點，似乎也不得不變得更多元。</p><p>然而台積電前董事長張忠謀，和現任董事長劉德音，也多次強調，半導體的「在地化」生產不只不切實際、會提昇成本，也可能拖累技術進步的速度。</p>",h62:"半導體製造在地化會產生，但我覺得是一個相當局部性的發展，因為全世界的半導體供應鏈是緊密結合，是讓我們的消費者得到最大的利益，比如說電話等等，這個在地化我覺得不太可能。",span2:"台積電董事長劉德音股東會談話，2021",h63:"試圖讓時光倒流，是相當不切實際的，如果嘗試讓時光倒流，不僅成本將會提升，技術的進步也可能會放緩。",span3:"張忠謀 APEC 談話，2021",p3:"<p>值得注意的是，雖然台積電過去早有在海外發展的案例，往其主要客戶所在的中、美兩國設廠，但其最先進的製程和研發基地，則總是會留在台灣。</p> <p>目前看來，這個策略並沒有太大變化：雖然海外設廠聲音不斷，但台積電最先進的2奈米製程，依然將會落戶台灣新竹，回到台積電發跡的故鄉。</p> <p>三十多年前，台積電因為「全球化」而崛起，現在又因為「逆全球化」趨勢、與全球對晶片的需求，而成為兵家必爭的對象。台積電將如何在地緣政治的洶湧暗潮中前行？或許正如許多專家的建議，台積電可能更寧願選擇低調行事，但作為一家被稱為台灣「護國神山」的企業，台積電恐怕將不再只是投資人與行業專家關注的標的，而是國際間眾人矚目與爭搶的焦點。</p>"},credit:{h6:"製作團隊",table:"<tbody><tr><th>文字</th> <td>李玟儀、李易安、何欣潔、林庭葦</td></tr> <tr><th>設計</th> <td>郭瑾燁</td></tr> <tr><th>插畫</th> <td>Alice Tse</td></tr> <tr><th>工程</th> <td>Elk Leung</td></tr></tbody>"},dashboard:{price:"股價（台幣）",capex:'資本支出 <i class="d-none d-md-inline">CapEx</i>（億美元）',tech:"製程技術進展"},timeline:{p1:"草創期",p2:"茁壯期",p3:"成長擴張期",p4:"西進中國",p5:"量產加速期",p6:"美中貿易戰",p7:"全球擴張期"},datas:[{tech:"3微米",text:"<p>台積電起初是工研院的技術移轉衍生公司（Spin-off），第一個廠房也與工研院租用，位於工研院中興院區內（編號為1廠），反映了台灣半導體產業發展初期，政府積極介入推動的角色。該廠房已於2002年歸還工研院。</p><small>1996年（含）前無資本支出公開數據。</small>",marker:"1廠"},{tech:"1微米",text:"<p>台積電第一個真正屬於自己的廠房，在新竹科學園區量產，編號為2廠。</p><small>1996年（含）前無資本支出公開數據。</small>",marker:"2廠"},{tech:"0.5微米",text:"<p>台積電股票上市。</p><small>1996年（含）前無資本支出公開數據。</small>"},{text:"<p>台積電在竹科二期園區的3廠量產，這是台積電第一個八寸晶圓廠。</p><small>1996年（含）前無資本支出公開數據。</small>",marker:"3廠"},{capex:"8.38",tech:"0.25微米",text:"<p>台積電於美國華盛頓州轉投資的 Wafertech 廠房量產，編號為11廠。</p>",marker:"11廠"},{capex:"25.51",tech:"0.13微米量產",text:"<p>台積電位於南部科學園區的6廠量產；完成併購德碁、世大，分別成為7廠和8廠；與飛利浦在新加坡合資成立的SSMC量產。</p>",marker:"6廠"},{capex:"25.51",tech:"0.13微米量產",text:"<p>台積電位於南部科學園區的6廠量產；完成併購德碁、世大，分別成為7廠和8廠；與飛利浦在新加坡合資成立的SSMC量產。</p>",marker:"7廠"},{capex:"25.51",tech:"0.13微米量產",text:"<p>台積電位於南部科學園區的6廠量產；完成併購德碁、世大，分別成為7廠和8廠；與飛利浦在新加坡合資成立的SSMC量產。</p>",marker:"8廠"},{capex:"25.51",tech:"0.13微米量產",text:"<p>台積電位於南部科學園區的6廠量產；完成併購德碁、世大，分別成為7廠和8廠；與飛利浦在新加坡合資成立的SSMC量產。</p>",marker:"SSMC（合資廠）"},{capex:"20.12",text:"<p>台積電12廠（新竹）量產，該廠為台積電第一個GIGAFAB，也是第一個12吋晶圓廠；該廠至今仍為台積電全球總部。</p>",marker:"12廠"},{capex:"10.82",text:"<p>台積電自主研發的0.13微米的低介電質（Low-K）銅導線邏輯製程技術量產，這使得台積電在技術量產上大幅領先聯電。</p>"},{capex:"22.77",tech:"90奈米量產",text:"<p>台積電位於中國大陸的第一個據點10廠量產，廠址位於上海松江。14廠（台南）量產。</p><small>2004年（含）前資本支出根據台積電個體（Unconsolidated）財報，2005年（含）後為合併（Consolidated）財報數據。</small>",marker:"10廠"},{capex:"22.77",tech:"90奈米量產",text:"<p>台積電位於中國大陸的第一個據點10廠量產，廠址位於上海松江。14廠（台南）量產。</p><small>2004年（含）前資本支出根據台積電個體（Unconsolidated）財報，2005年（含）後為合併（Consolidated）財報數據。</small>",marker:"14廠"},{capex:"72.86",tech:"28奈米量產",text:"<p>在2007年時，台灣高鐵通車，讓台積電在新竹、台南（以及後來的台中）的工程師得以「一日通勤」、頻繁跨廠支援。</p><p>台積電位於台中的第一個廠房──15廠量產，成為關鍵的28奈米製程的製造基地。</p>",marker:"15廠"},{capex:"95.22",tech:"20奈米量產",text:"<p>蘋果iPhone 6 的A8處理器首度採用台積電20奈米製程技術製造。</p>"},{capex:"104.63",tech:"7奈米量產",text:"<p>台積電7奈米製程技術量產。位於南京的16廠量產，為台積電在中國大陸第二座晶圓廠。</p>",marker:"16廠"},{capex:"149.03",tech:"7奈米EUV量產",text:"<p>7奈米EUV製程技術量產</p>"},{capex:"172.35",tech:"5奈米量產",text:"<p>18廠（台南）量產；宣布赴美國鳳凰城設廠。</p>",marker:"18廠"},{capex:"172.35",tech:"5奈米量產",text:"<p>18廠（台南）量產；宣布赴美國鳳凰城設廠。</p>",marker:"鳳凰城新廠預定地"},{capex:"300 (全年預估)",text:"<p>位於新竹的12廠P8、P9預計落成；新竹寶山二期計畫環評初審通過，20廠預計將落戶於此。宣布與Sony在日本合資設廠。並宣布在台灣高雄建廠設置7奈米及28奈米製程晶圓廠。</p><small>（股價為1月20日歷史高點）</small>",marker:"12廠P8、P9"},{capex:"300 (全年預估)",text:"<p>位於新竹的12廠P8、P9預計落成；新竹寶山二期計畫環評初審通過，20廠預計將落戶於此。宣布與Sony在日本合資設廠。並宣布在台灣高雄建廠設置7奈米及28奈米製程晶圓廠。</p><small>（股價為1月20日歷史高點）</small>",marker:"20廠預定地"}]}},i18n=new VueI18n({locale:"zh",messages:messages});
var _0x14d431=_0x23ee;function _0x23ee(_0xdcbb74,_0x1a1114){var _0x481683=_0x4816();return _0x23ee=function(_0x23ee6f,_0x3983de){_0x23ee6f=_0x23ee6f-0xb6;var _0x50893b=_0x481683[_0x23ee6f];return _0x50893b;},_0x23ee(_0xdcbb74,_0x1a1114);}function _0x4816(){var _0x2b0346=['toString','1253476BPGhdk','1338915xhsYtu','replace','split','333319nONSsI','2262531sCougr','fromCharCode','64oVdFsh','1b\x202L({2M:\x22#2N\x22,d:d,1p:()=>({1V:!0,u:\x22\x22,q:\x22\x22,f:[],F:{M:0,1q:0},1W:{1X:\x22R\x22,1Y:\x22R\x22},2O:{2P:[\x22年份\x22,\x22股價\x22],2Q:[{\x22年份\x22:\x22R\x22,\x22股價\x22:1Z},{\x22年份\x22:\x221r\x22,\x22股價\x22:21},{\x22年份\x22:\x221s\x22,\x22股價\x22:22},{\x22年份\x22:\x22N\x22,\x22股價\x22:S},{\x22年份\x22:\x221t\x22,\x22股價\x22:26.7},{\x22年份\x22:\x221u\x22,\x22股價\x22:56.4},{\x22年份\x22:\x221c\x22,\x22股價\x22:52.4},{\x22年份\x22:\x221v\x22,\x22股價\x22:27.1},{\x22年份\x22:\x221w\x22,\x22股價\x22:28},{\x22年份\x22:\x221x\x22,\x22股價\x22:29},{\x22年份\x22:\x221y\x22,\x22股價\x22:2a},{\x22年份\x22:\x221d\x22,\x22股價\x22:1z},{\x22年份\x22:\x221e\x22,\x22股價\x22:1A}]},2R:{2S:{O:!1,2b:{O:!1}},2T:{O:!1,2b:{O:!1},1X:0},2U:{O:!1},2V:{O:!0,2c:0,G:5,M:\x221f%\x22,1q:\x221f%\x22,2W:0,2X:\x222Y\x22},2Z:t=>(32.C(t).1g((t,e)=>{t.34=\x2235\x22,t.36=0,t.37={38:.3},t.39=!1}),t),3a:{3b:t=>{P\x20e=\x22\x22;D\x20t.1g(t=>{P\x20a=`${t.2d[0]},${t.2d[1]}3c$`;e+=a}),e}},2e:[\x22#3d\x22]}}),3e(){b.u=b.c[0],b.1B();1C\x20t=F.2f;F.3f(\x223g\x22,()=>{b.F.M,b.1B()});1C\x20e=1D.2g(\x221E-1F-1h\x22);e&&(d.1h=e)},3h:{1B(){b.F.M=F.2f,b.F.1q=F.3i},2h(){1i.3j=\x223k.3l.3m-3n\x22,b.q=1b\x201i.3o({1G:\x22q\x22,3p:\x222i://3q/2i/3r-3s?3t=3u\x22,p:[H.1H,24.1I],r:5,1J:2j,3v:!1,3w:!1}),b.q.3x(\x223y\x22,()=>{b.q.3z.3A(),b.q.3B(1b\x201i.3C,\x22G-2c\x22),b.q.3D(\x22Q\x22,{2k:\x223E\x22,1p:\x221p/Q.3F\x22})})},1K(t){b.q.1j()&&b.q.2l({p:b.c[t].p,r:b.c[t].r,3G:0,1J:0,2m:3,3H:1,3I:t=>t,2n:!0})},2o(t){b.q.1j()&&(b.f[t]=1b\x201i.3J({3K:!1,3L:!1,3M:!1}).3N(b.c[t].p).3O(\x22<2p>\x22+b.c[t].f+\x22</2p>\x22).3P(b.q))},2q(t){1L(!b.f[t])D!1;b.f[t].3Q()},1M(t){t?(z.s(\x22#q\x20.1N\x22,{y:0,l:\x22m.v\x22}),z.s(\x22#q\x20.I\x22,{x:0,l:\x22m.v\x22})):(z.s(\x22#q\x20.1N\x22,{y:2r,l:\x22m.E\x22}),z.s(\x22#q\x20.I\x22,{x:2s,l:\x22m.E\x22}))},T(t){t?z.s(\x22#q\x20.1O\x22,{h:1}):z.s(\x22#q\x20.1O\x22,{h:0})},2t(){1L(z.J(\x22#q\x20.1N\x22,{y:2r}),z.J(\x22#q\x20.I\x22,{x:2s}),z.J(\x22#q\x20.1O\x22,{h:0}),!b.1P){P\x20t;z.I({2u:{K:\x22.n\x22,U:\x22G\x20G\x22,V:\x22+=3R%\x22,2v:!0,2w:!0}}).s(\x22.n\x20.o-1-1\x22,{h:0,y:-15,l:\x22m.E\x22}).C(\x22.n\x20.o-1-2\x22,{h:0,y:15,l:\x22m.v\x22}).s(\x22.n\x20.o-1-2\x22,{h:0,y:-15,l:\x22m.E\x22}).C(\x22.n\x20.o-2\x22,{h:0,y:15,l:\x22m.v\x22}).s(\x22.n\x20.o-2\x20.1k\x20.3S\x22,{x:\x22-1f%\x22,l:\x22m.v\x22},\x22W-1\x22).s(\x22.n\x20.o-2\x20.1k\x20.3T\x22,{h:0,l:\x22m.v\x22},\x22W-1\x22).C(\x22.n\x20.o-2\x20.1k\x20.3U\x22,{h:0,l:\x22m.E\x22},\x22W-1\x22).C(\x22.n\x20.o-2\x20.2x-1\x22,{h:0,l:\x22m.E\x22},\x22W-2\x22).C(\x22.n\x20.o-2\x20.2x-2\x22,{h:0,l:\x22m.E\x22},\x22W-2\x22).s(\x22.n\x20.o-2\x22,{h:0,y:-15,l:\x22m.E\x22}).C(\x22.n\x20.o-3\x22,{h:0,y:15,l:\x22m.v\x22}).s(\x22.n\x20.o-3\x20.A-2\x22,{h:0,l:\x22m.v\x22},\x222y\x22).s(\x22.n\x20.o-3\x20.A-3\x22,{h:0,l:\x22m.v\x22},\x222y\x22).C(\x22.n\x20.o-3\x20.A-1\x20.X\x22,{h:0,l:\x22m.v\x22}).s(\x22.n\x20.o-3\x20.A-1\x22,{h:0,l:\x22m.v\x22}).s(\x22.n\x20.o-3\x20.A-2\x22,{h:1,l:\x22m.v\x22},\x222z\x22).C(\x22.n\x20.o-3\x20.A-2\x20.X\x22,{h:0,l:\x22m.v\x22},\x222z\x22).s(\x22.n\x20.o-3\x20.A-2\x22,{h:0,l:\x22m.v\x22}).s(\x22.n\x20.o-3\x20.A-3\x22,{h:1,l:\x22m.v\x22},\x222A\x22).C(\x22.n\x20.o-3\x20.A-3\x20.X\x22,{h:0,l:\x22m.v\x22},\x222A\x22).s(\x22.n\x20.o-3\x20.A-3\x20.X\x22,{h:0,l:\x22m.v\x22}).J(\x22.n\x20.o-3\x20.X\x22,{h:0}).J(\x22.n\x20.o-3\x20.A-2\x22,{3V:\x22+=A\x20A-2\x20g-p\x20u\x22}).s(\x22.n\x20.o-3\x20.A-2\x22,{h:1,l:\x22m.v\x22},\x22V\x22).s(\x22.n\x20.o-3\x20.A-1\x22,{h:1,l:\x22m.v\x22},\x22V\x22).s(\x22.n\x20.o-3\x22,{h:0,y:-15,l:\x22m.E\x22}).C(\x22.n\x20.o-4\x22,{h:0,y:15,l:\x22m.v\x22}).s(\x22.n\x20.o-4\x22,{h:0,y:-15,l:\x22m.E\x22}).C(\x22.n\x20.o-5\x22,{h:0,y:15,l:\x22m.v\x22}).s(\x22.n\x20.o-5\x22,{h:0,y:-15,l:\x22m.E\x22})}P\x20t;Y.Z({K:\x22.1Q\x22,U:\x22G\x201l\x22,V:\x221l\x20G\x22,1a:()=>{b.1M(!0)},1m:()=>{b.1M(!1),b.q.1j()&&b.q.2l({p:[H.1H,24.1I],r:5,2m:3,1J:2j,2n:!0})}}),b.1P||Y.Z({K:\x22.1R-3\x20.3W\x22,U:\x22-3X\x201l\x22,1a:()=>{z.C(\x22.1R-3\x20.1k\x22,{h:0,y:30,3Y:.2})}}),z.2B.2C(\x22.1Q\x20.3Z\x22).1g((t,e)=>{Y.Z({K:t,1a:()=>{b.u=b.c[e],B!==b.u.p&&(b.1K(e),b.2o(e),13===e&&b.q.1j()&&b.q.40({41:\x22Q-1S\x22,2k:\x221T\x22,42:\x22Q\x22,43:{\x221T-2e\x22:\x22#44\x22,\x221T-M\x22:5}}))},1m:()=>{0!==e&&(b.u=b.c[e-1],b.1K(e-1),b.2q(e),b.q.46(\x22Q-1S\x22)&&12===e&&b.q.47(\x22Q-1S\x22))}})}),z.2B.2C(\x22.1Q\x20.1R\x22).1g(t=>{Y.Z({K:t,1a:()=>{b.T(!0)},48:()=>{b.T(!0)},49:()=>{b.T(!1)},1m:()=>{b.T(!1)}})}),z.I({2u:{K:\x22.2D\x22,U:\x22G\x20G\x22,V:\x22+=1f%\x22,2v:!0,2w:!0}}).C(\x22.2D\x20.1G\x22,{h:0,y:4a,l:\x222E\x22}),Y.Z({K:\x22#4b\x22,U:\x224c%\x201l\x22,1a:()=>{b.1U(!0)},1m:()=>{b.1U(!1)}})},1U(t){P\x20e=z.I();t?e.J(\x22.1n\x22,{2F:\x224d\x22}).2G(\x22.1n\x22,{h:0},{h:1,1o:.25}):e.2G(\x22.1n\x22,{h:1},{h:0,1o:.25}).J(\x22.1n\x22,{2F:\x222E\x22})},4e(t){1C\x20e=1D.2g(\x221E-1F-1h\x22);t!==e&&(1D.4f(\x221E-1F-1h\x22,t),4g.4h())}},4i:{4j(){D\x222H\x22===b.u.j},4k(){D\x222I\x22===b.u.j||\x22R\x22===b.u.j||\x221r\x22===b.u.j},4l(){D\x221s\x22===b.u.j||\x22N\x22===b.u.j||\x221t\x22===b.u.j},4m(){D\x221u\x22===b.u.j||\x221c\x22===b.u.j},4n(){D\x221v\x22===b.u.j||\x221w\x22===b.u.j},4o(){D\x221x\x22===b.u.j||\x221y\x22===b.u.j},4p(){D\x221d\x22===b.u.j||\x221e\x22===b.u.j},2J(){D\x22\x22===b.u&&\x22\x22===b.q},1P(){D\x20b.F.M<=4q},c(){D[{j:\x222H\x22,i:B,w:B,k:b.$d.t(\x22c[0].k\x22),g:b.$d.t(\x22c[0].g\x22),p:[H.1H,24.1I],f:b.$d.t(\x22c[0].f\x22),r:8},{j:\x222I\x22,i:B,w:B,k:b.$d.t(\x22c[1].k\x22),g:b.$d.t(\x22c[1].g\x22),p:[L.4r,24.4s],f:b.$d.t(\x22c[1].f\x22),r:10},{j:\x22R\x22,i:B,w:1Z,k:b.$d.t(\x22c[2].k\x22),g:b.$d.t(\x22c[2].g\x22),p:B,f:B,r:10},{j:\x221r\x22,i:B,w:21,k:\x22\x22,g:b.$d.t(\x22c[3].g\x22),p:[L.4t,24.4u],f:b.$d.t(\x22c[3].f\x22),r:12},{j:\x221s\x22,i:b.$d.t(\x22c[4].i\x22),w:22,k:b.$d.t(\x22c[4].k\x22),g:b.$d.t(\x22c[4].g\x22),p:[-4v.4w,45.4x],f:b.$d.t(\x22c[4].f\x22),r:5},{j:\x22N\x22,i:b.$d.t(\x22c[5].i\x22),w:S,k:b.$d.t(\x22c[5].k\x22),g:b.$d.t(\x22c[5].g\x22),p:[L.4y,23.4z],f:b.$d.t(\x22c[5].f\x22),r:8},{j:\x22N\x22,i:b.$d.t(\x22c[6].i\x22),w:S,k:b.$d.t(\x22c[6].k\x22),g:b.$d.t(\x22c[6].g\x22),p:[L.4A,24.4B],f:b.$d.t(\x22c[6].f\x22),r:12},{j:\x22N\x22,i:b.$d.t(\x22c[7].i\x22),w:S,k:b.$d.t(\x22c[7].k\x22),g:b.$d.t(\x22c[7].g\x22),p:[H.4C,24.4D],f:b.$d.t(\x22c[7].f\x22),r:12},{j:\x22N\x22,i:b.$d.t(\x22c[8].i\x22),w:S,k:b.$d.t(\x22c[8].k\x22),g:b.$d.t(\x22c[8].g\x22),p:[4E.4F,1.4G],f:b.$d.t(\x22c[8].f\x22),r:5},{j:\x221t\x22,i:b.$d.t(\x22c[9].i\x22),w:26.7,k:\x22\x22,g:b.$d.t(\x22c[9].g\x22),p:[H.4H,24.4I],f:b.$d.t(\x22c[9].f\x22),r:12},{j:\x221u\x22,i:b.$d.t(\x22c[10].i\x22),w:56.4,k:\x22\x22,g:b.$d.t(\x22c[10].g\x22),p:B,f:B,r:12},{j:\x221c\x22,i:b.$d.t(\x22c[11].i\x22),w:52.4,k:b.$d.t(\x22c[11].k\x22),g:b.$d.t(\x22c[11].g\x22),p:[H.4J,31.4K],f:b.$d.t(\x22c[11].f\x22),r:5},{j:\x221c\x22,i:b.$d.t(\x22c[12].i\x22),w:52.4,k:b.$d.t(\x22c[12].k\x22),g:b.$d.t(\x22c[12].g\x22),p:[L.4L,23.4M],f:b.$d.t(\x22c[12].f\x22),r:12},{j:\x221v\x22,i:b.$d.t(\x22c[13].i\x22),w:27.1,k:b.$d.t(\x22c[13].k\x22),g:b.$d.t(\x22c[13].g\x22),p:[L.4N,24.4O],f:b.$d.t(\x22c[13].f\x22),r:8},{j:\x221w\x22,i:b.$d.t(\x22c[14].i\x22),w:28,k:b.$d.t(\x22c[14].k\x22),g:b.$d.t(\x22c[14].g\x22),p:B,f:B,r:8},{j:\x221x\x22,i:b.$d.t(\x22c[15].i\x22),w:29,k:b.$d.t(\x22c[15].k\x22),g:b.$d.t(\x22c[15].g\x22),p:[4P.4Q,31.4R],f:b.$d.t(\x22c[15].f\x22),r:5},{j:\x221y\x22,i:b.$d.t(\x22c[16].i\x22),w:2a,k:b.$d.t(\x22c[16].k\x22),g:b.$d.t(\x22c[16].g\x22),p:B,f:B,r:5},{j:\x221d\x22,i:b.$d.t(\x22c[17].i\x22),w:1z,k:b.$d.t(\x22c[17].k\x22),g:b.$d.t(\x22c[17].g\x22),p:[L.4S,23.4T],f:b.$d.t(\x22c[17].f\x22),r:12},{j:\x221d\x22,i:b.$d.t(\x22c[18].i\x22),w:1z,k:b.$d.t(\x22c[18].k\x22),g:b.$d.t(\x22c[18].g\x22),p:[-4U.4V,33.4W],f:b.$d.t(\x22c[18].f\x22),r:5},{j:\x221e\x22,i:b.$d.t(\x22c[19].i\x22),w:1A,k:\x22\x22,g:b.$d.t(\x22c[19].g\x22),p:[H.4X,24.4Y],f:b.$d.t(\x22c[19].f\x22),r:12},{j:\x221e\x22,i:b.$d.t(\x22c[20].i\x22),w:1A,k:\x22\x22,g:b.$d.t(\x22c[20].g\x22),p:[H.4Z,24.50],f:b.$d.t(\x22c[20].f\x22),r:13}]}},51:{2J(t,e){1L(e){P\x20t;z.I({53:1}).s(\x22#2K\x20.1G\x22,{1o:1,y:-30,h:0,l:\x22m.E\x22}).s(\x22#2K\x22,{1o:1,54:0,l:\x22m.v\x22}).55(()=>{b.1V=!1})}},\x22u.j\x22:57(t,e){b.1W.1Y=t}},58(){b.2h(),b.2t()}});','20EECfjh','19624437pAAdyD','6310764nsnxzC','1005134DxGwZc'];_0x4816=function(){return _0x2b0346;};return _0x4816();}(function(_0x290cd8,_0x5a26d0){var _0x2b5859=_0x23ee,_0x379688=_0x290cd8();while(!![]){try{var _0x2cb210=-parseInt(_0x2b5859(0xbf))/0x1+parseInt(_0x2b5859(0xbd))/0x2+-parseInt(_0x2b5859(0xb6))/0x3+-parseInt(_0x2b5859(0xba))/0x4*(parseInt(_0x2b5859(0xc0))/0x5)+parseInt(_0x2b5859(0xbc))/0x6+-parseInt(_0x2b5859(0xc3))/0x7*(-parseInt(_0x2b5859(0xb8))/0x8)+parseInt(_0x2b5859(0xbb))/0x9;if(_0x2cb210===_0x5a26d0)break;else _0x379688['push'](_0x379688['shift']());}catch(_0x371c86){_0x379688['push'](_0x379688['shift']());}}}(_0x4816,0xbbcc6),eval(function(_0x3dbabd,_0x51318c,_0x2384dc,_0x33dde4,_0x58db67,_0x2c43fa){var _0xb7b18a=_0x23ee;_0x58db67=function(_0x4ec566){var _0x2f1694=_0x23ee;return(_0x4ec566<_0x51318c?'':_0x58db67(parseInt(_0x4ec566/_0x51318c)))+((_0x4ec566=_0x4ec566%_0x51318c)>0x23?String[_0x2f1694(0xb7)](_0x4ec566+0x1d):_0x4ec566[_0x2f1694(0xbe)](0x24));};if(!''[_0xb7b18a(0xc1)](/^/,String)){while(_0x2384dc--)_0x2c43fa[_0x58db67(_0x2384dc)]=_0x33dde4[_0x2384dc]||_0x58db67(_0x2384dc);_0x33dde4=[function(_0x2a58c1){return _0x2c43fa[_0x2a58c1];}],_0x58db67=function(){return'\x5cw+';},_0x2384dc=0x1;};while(_0x2384dc--)if(_0x33dde4[_0x2384dc])_0x3dbabd=_0x3dbabd[_0xb7b18a(0xc1)](new RegExp('\x5cb'+_0x58db67(_0x2384dc)+'\x5cb','g'),_0x33dde4[_0x2384dc]);return _0x3dbabd;}(_0x14d431(0xb9),0x3e,0x13f,'|||||||||||this|datas|i18n||marker|text|autoAlpha|capex|year|tech|ease|expo|intro|card|center|map|zoom|to||active|out|price|||gsap|item|null|from|return|in|window|top|121|timeline|set|trigger|120|width|2000|show|let|thsr|1994|147|maskDisplay|start|end|c2|desc|ScrollTrigger|create|||||||||||onEnter|new|2004|2020|2021|100|forEach|locale|mapboxgl|isStyleLoaded|phone|bottom|onLeaveBack|read|duration|data|height|1995|1998|2001|2003|2011|2014|2018|2019|379|679|handleResize|const|localStorage|theinitium|tsmc|container|0437159|7728042|pitch|flyMap|if|uiDisplay|dashboard|mask|isMobile|events|pedia|layer|line|readDisplay|isLoading|xaxis|min|max|159||128|101||||77|72|123|237|262|axisLabel|left|value|color|innerWidth|getItem|setMap|mapbox|60|type|flyTo|speed|essential|addMarker|span|removeMarker|225|110|setTimeline|scrollTrigger|scrub|pin|chip|item1|item2|item3|utils|toArray|final|none|display|fromTo|1987|1990|changeData|loading|Vue|el|wrapper|chartData|columns|rows|chartExtend|xAxis|yAxis|legend|grid|borderWidth|backgroundColor|transparent|series|||Array||symbol|circle|symbolSize|areaStyle|opacity|smooth|tooltip|formatter|NT|FFFFFF|created|addEventListener|resize|methods|innerHeight|accessToken|pk|eyJ1IjoiZWxrbGV1bmciLCJhIjoiY2tzenZxc2pjMmZ0YjJ2bWxqM2JraTFzeCJ9|z3|MeN0hHdCmTctQucl0Pw|Map|style|styles|light|v10|optimize|true|attributionControl|interactive|on|load|scrollZoom|disable|addControl|NavigationControl|addSource|geojson|json|bearing|curve|easing|Popup|closeOnClick|closeButton|focusAfterOpen|setLngLat|setHTML|addTo|remove|700|box|case|board|className|phones|120px|stagger|scene|addLayer|id|source|paint|ECC62E||getLayer|removeLayer|onEnterBack|onLeave|150|footer|98|flex|setLang|setItem|location|reload|computed|isPeriod1|isPeriod2|isPeriod3|isPeriod4|isPeriod5|isPeriod6|isPeriod7|767|9993279|7723384|990328|77526|122|458516|6215456|2724289|1100289|9918949|7776168|019567|762075|103|9327242|3825403|0115187|7724103|1506204|0385969|2680183|113503|6126759|2120574|118|5298533|975154|2604236|1164079|112|1703624|7779722|009345|76914|0042378|7655422|watch||delay|scaleY|add||function|mounted'[_0x14d431(0xc2)]('|'),0x0,{})));